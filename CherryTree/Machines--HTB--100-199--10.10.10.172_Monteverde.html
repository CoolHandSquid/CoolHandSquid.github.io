<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.172 Monteverde</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.172 Monteverde</h1><br/>nmap showed an assload of ports open<br />ldap showed that the fqdn and domain name were megabank.local<br />dns confirmed and they were added to /etc/hosts<br />ldap also gave me a user list. I used that userlist to make a user.txt and pass.txt<br />I made a smbloop.py tool to pass user.txt and pass.txt while trying to run a credentialed smbmap<br />It worked!!<br />got the creds SABatchJobs:SABatchJobs<br /><br />smbmap with the new creds and I see that I can connect to users$<br />I mget the whole directory and see that under mhope is azure.xml<br />CREDS!<br />mhope:4n0therD4y@n0th3r$<br />evil-winrm in... user.txt<br /><br />whoami /groups shows that I am in the Azure admins group (bloodhound was useless here)<br />After many moons of googling I find this github projuct<br /><a href="https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Azure-ADConnect.ps1">https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Azure-ADConnect.ps1</a><br />view raw and nano into a file named Azure-ADConnect.ps1<br />upload Azure-ADConnect.ps1 to the target with evil-winrm<br />&lt;load .\Azure-ADConnect.ps1 into memory&gt;<br />import-module .\Azure-ADConnect.ps1<br />&lt;execute&gt;<br />Azure-ADConnect -server 10.10.10.172 -db ADSync<br />&lt;enjoy your creds&gt;<br /><br />[+] Domain:  MEGABANK.LOCAL<br />[+] Username: administrator<br />[+]Password: d0m@in4dminyeah!<br /><br />evil-winrm in as administrator<br />root.txt<br /><br /><br /></div></body></html>