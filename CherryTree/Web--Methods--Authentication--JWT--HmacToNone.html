<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>HmacToNone</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>HmacToNone</h1><br/>Sessions can be hijacked via Json Web Tokens.<br />Use Burp.<br />If you see JWT at the bottom of the header on a login, you may be able to enumerate, and login as other users.<br />JWT&#39;s are broken into three parts seperated by &quot;.&quot;.<br />base64 decode the first piece and replace the alg value (probaly &quot;HS256&quot;) with &quot;NONE&quot;. Base64 encode that. Now you have your first section.<br />	---NOTE---For this to work, it seems like the the line being encoded needs to be on one line---NOTE---<br />base64 decode the second piece and iterate through &quot;identity&quot; values (0 is often admin). base64 encode that now you have your second section.<br />	---NOTE---The one line rule still applies---NOTE---<br />	---NOTE---Add a traling &quot;.&quot; You do not need the third piece.<br />	<br />Example:<br />eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE2MTcwMzM3NjMsImlhdCI6MTYxNzAzMzQ2MywibmJmIjoxNjE3MDMzNDYzLCJpZGVudGl0eSI6MX0.SHClIHyJ5M13tg-yYbiy39Wz6gsdMNs-itRR286_3-E<br />can turn into<br />ewogInR5cCI6ICJKV1QiLAogImFsZyI6ICJOT05FIn0K.eyJleHAiOiAxNjE3MDMzNzYzLCJpYXQiOiAxNjE3MDMzNDYzLCJuYmYiOiAxNjE3MDMzNDYzLCJpZGVudGl0eSI6IDB9.<br /><br /><br /><br />Helpful tools are jwt.io, Joseph(burp),json web tokens(burp), firefox cookie handler and cyberchef.<br />BUT THE BEST TOOL IS: <a href="https://github.com/Goron/TokenBreaker">https://github.com/Goron/TokenBreaker</a><br /><a href=""><img src="images/1586-1.png" alt="images/1586-1.png" /></a></div></body></html>