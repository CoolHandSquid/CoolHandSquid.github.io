<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>ca</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>ca</h1><br/>Psermon from Ghandi    <br />As we have the root user’s principal, we can generate SSH keys and sign them with root’s principal. Doing so will allow us to login through SSH as root. Now we know we can run ssh-keygen to generate SSH keys but first, we need a certificate to sign the SSH key. We enumerate the machine to find a certificate and find one inside /home/userca directory.<br />-------------<br />-You are looking for a ca and ca.pub file<br />--------------<br /><br />First, we generate SSH keys and move them into the /tmp directory. Then we sign the keys as userca to read the certificate inside /home/userca/ca.<br />----------------<br />ssh-keygen<br />mv .ssh/id_rsa* /tmp/<br />doas -u userca /usr/bin/ssh-keygen -s /home/userca/ca -n 3m3rgencyB4ckd00r -I root /tmp/id_rsa.pub<br />                                                        ^location of ca file    ^principal               ^username to principal^location<br />-----------------<br /><br />After signing the RSA keys, we use the RSA key to login through SSH as the root user. After logging in we find a file called “root.txt”. We take a look inside the content of the file and find the final flag.<br /><br />ssh -i /tmp/id_rsa root@localhost<br /><br /><a href="https://www.hackingarticles.in/hack-the-box-ypuffy-walkthrough/">https://www.hackingarticles.in/hack-the-box-ypuffy-walkthrough/</a><br /><br /><br />In my own words<br />you can sign in with a password (pulic key auth), <br />private key (other side of public key auth) or a <br />signed private key with a “public key cert” and “public key” in the same dir. </div></body></html>