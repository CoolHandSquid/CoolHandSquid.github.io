<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>SA</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>SA</h1><br/>• --Check selinux logs<br />sudo stat /var/log/audit/audit.log<br />sudo cat /var/log/audit/audit.log |tail<br /><br />--NMAP scan remote target(s)<br />proxychains nmap -sT -Pn -T3 -v -p &lt;port(s)&gt; 192.168.0.0/24<br /><br />--Banner grab via netcat<br />proxychains nc -nv 192.168.0.x &lt;port&gt;<br /><br />--Display Windows Logs<br />wevtutil qe &lt;System/Security/Application&gt; /c:20 /f:text<br /><br />--WIN software enumeration<br />reg query hklm\software<br /><br />--WIN software locations<br />HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall<br />##HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall &lt;alt of above&gt;<br />HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall<br />HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall<br /><br />--Windows Defender version info<br />reg query &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Defender\Signature Updates&quot;<br /><br />--SCP with spaces in path<br />scp -vvv -o ControlPath=/tmp/T5 -P 5005 -r student5@127.1:&#39;&quot;C:\Program Files\Common Files\system\ado\*.dll&quot;&#39; ~/McCoy/Desktop/<br /><br />--Shortened windows path (SCP)<br />c:\PROGRA~1\COMMON~1\system\ado<br /><br />--Find hash in WINDOWS<br />certutil -hashfile &quot;file.png&quot; MD5<br />powershell, get-filehash -algorithm -path... -recurse<br /><br />--Generate hashes for multiple files in directory<br />for %F in (*) do @certutil -hashfile &quot;%F&quot; MD5<br /><br />--Find total file size in directory (LINUX)<br />du -ch /directory<br /><br />--Find total file size in directory (WIN)<br />dir /a /s  <br /><br />--Find PPID in windows<br />wmic process list full<br /><br />--WMIC - verify winmgmt is running prior to using <br />sc query winmgmt<br /><br />--Process info<br />wmic process where processid=&lt;PID&gt; get processid, parentprocessid, executablepath<br /><br />--Check if IPTABLES enabled<br />cat /proc/sys/net/ipv4/ip_forward (1 = enabled)<br /><br />--Enable IPTABLES Forwarding:<br />sudo sysctl -w net.ipv4.ip_forward=1<br /><br />--Check for iptables rules<br />sudo iptables -L / sudo iptables -t nat -L -nv<br /><br />--Replacement for LS<br />vdir -lisa<br /><br />--Find Linux Program Versions<br />● rpm -qa|grep &lt;programName&gt;<br />● apt-cache show &lt;programName&gt;<br />● apt policy &lt;programName&gt;<br /><br />--Find Windows Program Versions<br />Look in AppData, Program files, ETC<br />---E.g. Kaspersky 20.1.2 folder<br /><br />Remove Dynamic Port Forward from T#:<br />ssh -S /tmp/05_T# -Nf dummy@dummy -O cancel -D 9050<br /><br />Add Dynamic or Local Port Forward to T#:<br />ssh -S /tmp/05_T# -Nf dummy@dummy -O forward -D 9050<br /><br />Example:<br />ssh -S /tmp/05_T2 -Nf dummy@dummy -O cancel -L 5005:10.145.117.16:22013<br />ssh -S /tmp/05_T2 -Nf dummy@dummy -O forward -L 5005:10.145.117.16:22012<br /><br />--IF TARGET HUNG (CREATE SLAVE CONNECTION)<br />ssh -S /tmp/T5 dummy@dummy<br /><br /><br /><br /><br /><br />• <br />--SCP Commands:<br /><br />scp -o ControlPath=/tmp/T5 -P 5005 -T student5@127.1:&quot;/etc/file4.txt&quot; T5_file4.txt<br /><br />Multiple of one type of file:<br />scp -vvv -o ControlPath=/tmp/T5 -P 5005 -r student5@127.1:&#39;&quot;C:\Program Files\Common Files\system\ado\*.dll&quot;&#39; ~/McCoy/MM8_T5<br /><br />All files in a directory:<br />scp -o ControlPath=/tmp/T4 -P 5004 -r student5@127.1:&quot;C:\Windows\Prefetch&quot; ~/McCoy/MM6<br /><br />ssh -S /tmp/T5  -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -p 5005 dummy@dummy &quot;sudo cat /root/file2.txt&quot; &gt; T5_file2.txt<br /><br /><br /><br /></div></body></html>