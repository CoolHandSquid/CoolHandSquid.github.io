<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>HostEnumScript</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>HostEnumScript</h1><br/><br /><br /><div class="codebox"><div class="codebox">#sa<br />#Get-WmiObject&nbsp;win32_OperatingSystem&nbsp;|&nbsp;Format-List&nbsp;#PSComputerName&nbsp;###Hostname<br />#Get-WmiObject&nbsp;-Class&nbsp;Win32_NetworkAdapterConfiguration&nbsp;|&nbsp;where-object&nbsp;{&nbsp;$_.IPAddress&nbsp;}&nbsp;|&nbsp;Format-Table&nbsp;&nbsp;&nbsp;###ipconfig<br />#$PID&nbsp;&nbsp;&nbsp;&nbsp;###get&nbsp;pid<br />#Get-PSHostProcessInfo&nbsp;&nbsp;&nbsp;&nbsp;###get&nbsp;process<br />#([Security.Principal.WindowsIdentity]::GetCurrent()).Name&nbsp;&nbsp;&nbsp;&nbsp;###Get&nbsp;Username<br />#Write-Output&nbsp;&quot;Currently&nbsp;have&nbsp;administrative&nbsp;rights:&quot;;&nbsp;([Security.Principal.WindowsPrincipal]&nbsp;[Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]&nbsp;&quot;Administrator&quot;)&nbsp;&nbsp;&nbsp;###Check&nbsp;if&nbsp;shell&nbsp;has&nbsp;admin&nbsp;rights<br /><br />#Security<br />#Get-Process<br />#get-service&nbsp;|&nbsp;where-object&nbsp;{&nbsp;$_.Status&nbsp;-eq&nbsp;&#39;running&#39;}&nbsp;&nbsp;&nbsp;###Loog&nbsp;for&nbsp;antivirus<br />#get-childitem&nbsp;HKLM:\SOFTWARE\&nbsp;&nbsp;&nbsp;###Find&nbsp;major&nbsp;version&nbsp;of&nbsp;antivirus<br />#get-itemproperty&nbsp;HKLM:\SOFTWARE\yeet\cannon&nbsp;&nbsp;&nbsp;###find&nbsp;minor&nbsp;version&nbsp;of&nbsp;antivirus<br /><br />#logging<br />#get-logproperties&nbsp;security&nbsp;|&nbsp;format-list&nbsp;enabled&nbsp;&nbsp;&nbsp;###is&nbsp;auditing&nbsp;enabled<br />#auditpol&nbsp;/get&nbsp;/category:*&nbsp;&nbsp;&nbsp;###check&nbsp;eventlog&nbsp;(need&nbsp;admin,&nbsp;uses&nbsp;external&nbsp;binary)<br />#get-eventlog&nbsp;security&nbsp;-Newest&nbsp;20&nbsp;&nbsp;&nbsp;###view&nbsp;security&nbsp;event&nbsp;logs<br /><br />#OS&nbsp;and&nbsp;hardware<br />#Get-ComputerInfo&nbsp;&nbsp;&nbsp;###Lots&nbsp;o&nbsp;shit<br />#$psversiontable&nbsp;&nbsp;&nbsp;&nbsp;###version&nbsp;of&nbsp;powershell<br />#Get-WmiObject&nbsp;-class&nbsp;Win32_LogicalDisk&nbsp;-Filter&nbsp;&#39;DriveType=3&#39;&nbsp;|&nbsp;Format-Table&nbsp;DeviceID,&nbsp;Size,&nbsp;FreeSpace&nbsp;&nbsp;&nbsp;###Drive&nbsp;info<br />#Get-WmiObject&nbsp;-Class&nbsp;Win32_processor&nbsp;|&nbsp;select-object&nbsp;name,&nbsp;Loadpercentage&nbsp;&nbsp;&nbsp;###Processor&nbsp;info&nbsp;including&nbsp;load&nbsp;info<br />#Get-WmiObject&nbsp;-class&nbsp;win32_operatingsystem&nbsp;|&nbsp;Foreach-object&nbsp;{&quot;{0:N2}%&quot;&nbsp;-f&nbsp;((($_.TotalVisibleMemorySize&nbsp;-&nbsp;$_.FreePhysicalMemory)*100)/$_.TotalVisibleMemorySize)}&nbsp;&nbsp;&nbsp;###&nbsp;%&nbsp;of&nbsp;ram&nbsp;used<br />#netstat&nbsp;-ano&nbsp;&nbsp;&nbsp;###netstat<br />#netstat&nbsp;-anob&nbsp;&nbsp;&nbsp;###netstat<br /><br />#Persistance&nbsp;Check<br />#Get-ItemProperty&nbsp;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run&nbsp;&nbsp;&nbsp;###Check&nbsp;for&nbsp;unusal&nbsp;run&nbsp;key&nbsp;entry<br />#Get-ItemProperty&nbsp;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Runonce&nbsp;&nbsp;&nbsp;###Check&nbsp;for&nbsp;unusal&nbsp;run&nbsp;key&nbsp;entry<br />#Get-ItemProperty&nbsp;HKcu:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run&nbsp;&nbsp;&nbsp;###Check&nbsp;for&nbsp;unusal&nbsp;run&nbsp;key&nbsp;entry<br />#Get-ItemProperty&nbsp;HKcu:\SOFTWARE\Microsoft\Windows\CurrentVersion\Runonce&nbsp;&nbsp;&nbsp;###Check&nbsp;for&nbsp;unusal&nbsp;run&nbsp;key&nbsp;entry<br />#Get-ItemProperty&nbsp;&quot;HKLM:\SOFTWARE\Microsoft\Windows&nbsp;nt\CurrentVersion\Winlogon&quot;&nbsp;&nbsp;&nbsp;###Unusual&nbsp;run&nbsp;key&nbsp;entry<br />#Get-ItemProperty&nbsp;&quot;HKcu:\SOFTWARE\Microsoft\Windows&nbsp;nt\CurrentVersion\Winlogon&quot;&nbsp;&nbsp;&nbsp;###Unusual&nbsp;run&nbsp;key&nbsp;entry<br />#at&nbsp;&nbsp;&nbsp;###schtasks&nbsp;check<br />#schtasks&nbsp;/query&nbsp;/V&nbsp;/FO&nbsp;list&nbsp;|&nbsp;more&nbsp;&nbsp;&nbsp;###schtasks&nbsp;check<br />#Get-ChildItem&nbsp;&#39;C:\programdata\Microsoft\Windows\Start&nbsp;menu\programs\startup&#39;&nbsp;&nbsp;&nbsp;###Check&nbsp;startup&nbsp;Folder<br /><br />###check&nbsp;each&nbsp;users&nbsp;startup&nbsp;folder<br />&quot;&quot;&quot;<br />$names&nbsp;=&nbsp;Get-ChildItem&nbsp;C:\users&nbsp;|&nbsp;where-object&nbsp;{&nbsp;$_.Name&nbsp;-ne&nbsp;&#39;Public&#39;&nbsp;-and&nbsp;$_.Name&nbsp;-ne&nbsp;&#39;default&#39;&nbsp;}&nbsp;|&nbsp;select&nbsp;{&nbsp;$_.Name}<br />foreach&nbsp;($name&nbsp;in&nbsp;$names){<br />&nbsp;&nbsp;&nbsp;&nbsp;$test&nbsp;=&nbsp;Get-ChildItem&nbsp;(&#39;C:\users\&#39;&nbsp;+&nbsp;($name.&#39;&nbsp;$_.Name&nbsp;&#39;)&nbsp;+&nbsp;&#39;\Appdata\Roaming\microsoft\Windows\Start&nbsp;Menu\Programs\Startup&#39;)&nbsp;-ErrorAction&nbsp;SilentlyContinue<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($test-ne&nbsp;$null){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get-ChildItem&nbsp;(&#39;C:\users\&#39;&nbsp;+&nbsp;($name.&#39;&nbsp;$_.Name&nbsp;&#39;)&nbsp;+&nbsp;&#39;\Appdata\Roaming\Microsoft\Windows\Start&nbsp;Menu\Programs\Startup&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}}<br />&quot;&quot;&quot;<br />#Get-WmiObject&nbsp;win32_service&nbsp;|&nbsp;where-object&nbsp;{&nbsp;$_.StartMode&nbsp;-eq&nbsp;&#39;Auto&#39;&nbsp;}&nbsp;|&nbsp;format-list&nbsp;Name,&nbsp;DisplayName,&nbsp;PathName&nbsp;&nbsp;&nbsp;###services<br />#get-childitem&nbsp;-path&nbsp;C:\&nbsp;-recurse&nbsp;|&nbsp;Where-Object&nbsp;{&nbsp;$_.LastWriteTime&nbsp;-ge&nbsp;(Get-Date).AddMinutes(-60)&nbsp;}&nbsp;###Loffing&nbsp;Check<br /></div></div></div></body></html>