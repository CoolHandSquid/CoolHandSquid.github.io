<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Powershell SA</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Powershell SA</h1><br/><div class="codebox"><div class="codebox">function&nbsp;Invoke-SituationalAwareness<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Declared&nbsp;the&nbsp;situational&nbsp;awareness&nbsp;section&nbsp;has&nbsp;begun&nbsp;executing<br />&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Beginning&nbsp;Situational&nbsp;awareness&nbsp;check.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;current&nbsp;date&nbsp;&amp;&nbsp;time<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-Date<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;hostname<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-WmiObject&nbsp;win32_OperatingSystem&nbsp;|&nbsp;fl&nbsp;PSComputerName<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;IP/MAC&nbsp;address<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-WmiObject&nbsp;–Class&nbsp;Win32_NetworkAdapterConfiguration&nbsp;|&nbsp;where-object&nbsp;{&nbsp;$_.IPAddress}&nbsp;|&nbsp;Format-Table<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;current&nbsp;process<br />&nbsp;&nbsp;&nbsp;&nbsp;$PID<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-PSHostProcessInfo<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;user&nbsp;context<br />&nbsp;&nbsp;&nbsp;&nbsp;([Security.Principal.WindowsIdentity]::GetCurrent()).Name<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Determine&nbsp;if&nbsp;running&nbsp;with&nbsp;administrative&nbsp;privileges<br />&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Currently&nbsp;have&nbsp;administrative&nbsp;rights:&quot;;&nbsp;([Security.Principal.WindowsPrincipal]&nbsp;[Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]&nbsp;“Administrator”)<br />}<br /><br />function&nbsp;Invoke-SecurityCheck<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Declared&nbsp;the&nbsp;security&nbsp;section&nbsp;has&nbsp;begun&nbsp;executing<br />&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Beginning&nbsp;security&nbsp;check.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;list&nbsp;of&nbsp;running&nbsp;processes<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-Process<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;list&nbsp;of&nbsp;running&nbsp;services<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-Service&nbsp;|&nbsp;where-object&nbsp;{&nbsp;$_.Status&nbsp;–eq&nbsp;‘running’&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Verifies&nbsp;security&nbsp;auditing&nbsp;is&nbsp;enabled<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-LogProperties&nbsp;Security&nbsp;|&nbsp;Format-List&nbsp;enabled<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Displays&nbsp;the&nbsp;audit&nbsp;categories&nbsp;&amp;&nbsp;settings<br />&nbsp;&nbsp;&nbsp;&nbsp;auditpol.exe&nbsp;/get&nbsp;/category:*<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;20&nbsp;most&nbsp;recent&nbsp;entries<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-EventLog&nbsp;Security&nbsp;–Newest&nbsp;21<br />}<br /><br />function&nbsp;Invoke-HostInfo<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Declared&nbsp;the&nbsp;Host&nbsp;info&nbsp;section&nbsp;has&nbsp;begun&nbsp;executing<br />&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Beginning&nbsp;Host&nbsp;Info&nbsp;check.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;general&nbsp;computer&nbsp;information<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ComputerInfo<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;hard&nbsp;drive&nbsp;information<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-WmiObject&nbsp;–Class&nbsp;Win32_LogicalDisk&nbsp;&nbsp;-Filter&nbsp;‘DriveType=3’|&nbsp;Format-Table&nbsp;DeviceID,&nbsp;Size,&nbsp;FreeSpace<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;processor&nbsp;load<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-WmiObject&nbsp;–Class&nbsp;Win32_Processor&nbsp;|&nbsp;Select-Object&nbsp;name,&nbsp;LoadPercentage<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;memory&nbsp;load<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-WmiObject&nbsp;–Class&nbsp;Win32_OperatingSystem&nbsp;|&nbsp;ForEach-Object&nbsp;{“{0:N2}%”&nbsp;–f&nbsp;((($_.TotalVisibleMemorySize&nbsp;-&nbsp;$_.FreePhysicalMemory)*100)/&nbsp;$_.TotalVisibleMemorySize)}<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;network&nbsp;connections&nbsp;&amp;&nbsp;sockets<br />&nbsp;&nbsp;&nbsp;&nbsp;netstat&nbsp;-ano<br />}<br /><br />function&nbsp;Invoke-PersistenceCheck<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Declared&nbsp;the&nbsp;persistence&nbsp;section&nbsp;has&nbsp;begun&nbsp;executing<br />&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Beginning&nbsp;persistence&nbsp;check.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;HKLM&nbsp;Run&nbsp;key<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ItemProperty&nbsp;HKLM:\Software\Microsoft\Windows\CurrentVersion\Run<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;HKLM&nbsp;RunOnce&nbsp;key<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ItemProperty&nbsp;HKLM:\Software\Microsoft\Windows\CurrentVersion\RunOnce<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;HKLM&nbsp;Winlogon&nbsp;key<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ItemProperty&nbsp;“HKLM:\Software\Microsoft\Windows&nbsp;NT\CurrentVersion\Winlogon”<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;HKCU&nbsp;Run&nbsp;key<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ItemProperty&nbsp;HKCU:\Software\Microsoft\Windows\CurrentVersion\Run<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;HKCU&nbsp;RunOnce&nbsp;key<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ItemProperty&nbsp;HKCU:\Software\Microsoft\Windows\CurrentVersion\RunOnce<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;the&nbsp;HKCU&nbsp;Winlogon&nbsp;key<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ItemProperty&nbsp;“HKCU:\Software\Microsoft\Windows&nbsp;NT\CurrentVersion\Winlogon”<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;all&nbsp;at&nbsp;jobs<br />&nbsp;&nbsp;&nbsp;&nbsp;at<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;all&nbsp;scheduled&nbsp;tasks<br />&nbsp;&nbsp;&nbsp;&nbsp;schtasks&nbsp;/query&nbsp;&nbsp;/V&nbsp;/FO&nbsp;list<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;host&nbsp;startup&nbsp;folder<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ChildItem&nbsp;‘C:\ProgramData\Microsoft\Windows\Start&nbsp;Menu\Programs\Startup’<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;startup&nbsp;folder&nbsp;for&nbsp;each&nbsp;user<br />&nbsp;&nbsp;&nbsp;&nbsp;$names&nbsp;=&nbsp;Get-ChildItem&nbsp;C:\Users&nbsp;|&nbsp;where&nbsp;{&nbsp;$_.Name&nbsp;-ne&nbsp;&quot;Public&quot;&nbsp;-and&nbsp;$_.Name&nbsp;-ne&nbsp;&quot;installer&quot;&nbsp;}&nbsp;|&nbsp;select&nbsp;{&nbsp;$_.Name&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($name&nbsp;in&nbsp;$names)&nbsp;{&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$test&nbsp;=&nbsp;Get-ChildItem&nbsp;(&#39;c:\Users\&#39;&nbsp;+&nbsp;($name.&#39;&nbsp;$_.Name&nbsp;&#39;)&nbsp;+&nbsp;&#39;\Appdata\Roaming\Microsoft\Windows\Start&nbsp;Menu\Programs\Startup&#39;)&nbsp;-ErrorAction&nbsp;SilentlyContinue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($test&nbsp;-ne&nbsp;$null)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get-ChildItem&nbsp;(&#39;c:\Users\&#39;&nbsp;+&nbsp;($name.&#39;&nbsp;$_.Name&nbsp;&#39;)&nbsp;+&nbsp;&#39;\Appdata\Roaming\Microsoft\Windows\Start&nbsp;Menu\Programs\Startup&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;all&nbsp;autostart&nbsp;services<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-wmiobject&nbsp;win32_service&nbsp;|&nbsp;where-object&nbsp;{&nbsp;$_.StartMode&nbsp;–eq&nbsp;‘Auto’&nbsp;}&nbsp;|&nbsp;format-list&nbsp;Name,&nbsp;DisplayName,&nbsp;PathName<br />}<br /><br />function&nbsp;Invoke-LogCheck<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Declared&nbsp;the&nbsp;logging&nbsp;check&nbsp;section&nbsp;has&nbsp;begun&nbsp;executing<br />&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Beginning&nbsp;Log&nbsp;check.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pulls&nbsp;every&nbsp;file&nbsp;which&nbsp;has&nbsp;updated&nbsp;in&nbsp;the&nbsp;last&nbsp;hour<br />&nbsp;&nbsp;&nbsp;&nbsp;Get-ChildItem&nbsp;–Path&nbsp;C:\&nbsp;-recurse&nbsp;-ErrorAction&nbsp;SilentlyContinue&nbsp;|&nbsp;Where-Object&nbsp;{&nbsp;$_.LastWriteTime&nbsp;–ge&nbsp;(Get-Date).AddMinutes(-60)&nbsp;}<br />}<br /><br /><br />&lt;#<br />.Synopsis<br />&nbsp;&nbsp;&nbsp;Short&nbsp;description<br />.DESCRIPTION<br />&nbsp;&nbsp;&nbsp;Long&nbsp;description<br />.EXAMPLE<br />&nbsp;&nbsp;&nbsp;Example&nbsp;of&nbsp;how&nbsp;to&nbsp;use&nbsp;this&nbsp;cmdlet<br />.EXAMPLE<br />&nbsp;&nbsp;&nbsp;Another&nbsp;example&nbsp;of&nbsp;how&nbsp;to&nbsp;use&nbsp;this&nbsp;cmdlet<br />#&gt;<br />function&nbsp;Invoke-HostSurvey<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;[CmdletBinding()]<br />&nbsp;&nbsp;&nbsp;&nbsp;Param<br />&nbsp;&nbsp;&nbsp;&nbsp;(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;A&nbsp;switch&nbsp;to&nbsp;run&nbsp;through&nbsp;all&nbsp;functions&nbsp;without&nbsp;breakpoints<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Switch]$Noninteractive<br />&nbsp;&nbsp;&nbsp;&nbsp;)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;Begin<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;Process<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;An&nbsp;If&nbsp;statement&nbsp;that&nbsp;determines&nbsp;behvior&nbsp;if&nbsp;the&nbsp;-noninteractive&nbsp;switch&nbsp;was&nbsp;used<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If($noninteractive)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-SituationalAwareness<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-SecurityCheck<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-HostInfo<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-PersistenceCheck<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-LogCheck<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Else&nbsp;-&nbsp;default&nbsp;behavior,&nbsp;including&nbsp;breakpoints<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Runs&nbsp;the&nbsp;Situational&nbsp;awareness&nbsp;function<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-SituationalAwareness<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;A&nbsp;breakpoint&nbsp;to&nbsp;determine&nbsp;if&nbsp;the&nbsp;user&nbsp;wishes&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bp1&nbsp;=&nbsp;Read-Host&nbsp;&quot;Do&nbsp;you&nbsp;wish&nbsp;to&nbsp;continue?&nbsp;(Y&nbsp;or&nbsp;N)&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;statement&nbsp;to&nbsp;determine&nbsp;if&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($bp1&nbsp;-eq&nbsp;&#39;Y&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Runs&nbsp;the&nbsp;security&nbsp;check&nbsp;function<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-SecurityCheck<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;A&nbsp;breakpoint&nbsp;to&nbsp;determine&nbsp;if&nbsp;the&nbsp;user&nbsp;wishes&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bp2&nbsp;=&nbsp;Read-Host&nbsp;&quot;Do&nbsp;you&nbsp;wish&nbsp;to&nbsp;continue?&nbsp;(Y&nbsp;or&nbsp;N)&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;statement&nbsp;to&nbsp;determine&nbsp;if&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($bp2&nbsp;-eq&nbsp;&#39;Y&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Runs&nbsp;the&nbsp;host&nbsp;info&nbsp;function<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-HostInfo<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;A&nbsp;breakpoint&nbsp;to&nbsp;determine&nbsp;if&nbsp;the&nbsp;user&nbsp;wishes&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bp3&nbsp;=&nbsp;Read-Host&nbsp;&quot;Do&nbsp;you&nbsp;wish&nbsp;to&nbsp;continue?&nbsp;(Y&nbsp;or&nbsp;N)&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;statement&nbsp;to&nbsp;determine&nbsp;if&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($bp3&nbsp;-eq&nbsp;&#39;Y&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Runs&nbsp;the&nbsp;persistence&nbsp;function<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-PersistenceCheck<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;A&nbsp;breakpoint&nbsp;to&nbsp;determine&nbsp;if&nbsp;the&nbsp;user&nbsp;wishes&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bp4&nbsp;=&nbsp;Read-Host&nbsp;&quot;Do&nbsp;you&nbsp;wish&nbsp;to&nbsp;continue?&nbsp;(Y&nbsp;or&nbsp;N)&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;statement&nbsp;to&nbsp;determine&nbsp;if&nbsp;to&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($bp4&nbsp;-eq&nbsp;&#39;Y&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Runs&nbsp;the&nbsp;log&nbsp;check&nbsp;function<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoke-LogCheck<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Survey&nbsp;terminated&nbsp;by&nbsp;operator.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Survey&nbsp;terminated&nbsp;by&nbsp;operator.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write-Output&nbsp;&quot;Survey&nbsp;terminated&nbsp;by&nbsp;operator.&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;End<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></div></div></div></body></html>