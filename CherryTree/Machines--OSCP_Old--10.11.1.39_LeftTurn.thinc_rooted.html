<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.11.1.39 LeftTurn.thinc rooted</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.11.1.39 LeftTurn.thinc rooted</h1><br/>An nmap scan showed that ports 22, 80, and 3306 were open.<br />Upon enumeration of the webserver when navigating to robots.txt you were forwarded to bat.txt.<br />Changeing the useragent to Googlebot-News allowed us to view robots.txt which showed us the existince of the otrs directory.<br />Directory brute forceing showed that there were four abailable pages.<br />Because there was no other obvious way of entry, the tester used cewl to create a wordlist from the four pages and crafted a hydra command to brute force against the default username root@localhost.<br />hydra -l root@localhost -P yee.txt 10.11.1.39 http-post-form -e nsr &quot;/otrs/index.pl:Action=Login&amp;RequestedURL=Action%3DAdmin&amp;Lang=en&amp;TimeOffset=240&amp;User=^USER^&amp;Password=^PASS^:F=Login failed?&quot;<br />The creds root@localhost:otrs were displayed and functioned.<br />The known vulnerability for otrs5 involving changeing the function of PGP and then executing gave the tester a reverse shell on the machine as apache.<br /><a href="https://www.exploit-db.com/exploits/43853">https://www.exploit-db.com/exploits/43853</a><br />Once with a reverse shell the tester noticed that he could write to /etc/passwd.<br />On his local machine he was able to create a new /etc/passwd file, but with credentials he knew for root, then replace the old /etc/passwd with the new one.<br />He then logged on via ssh as root with the new credetials.<br /><br />1dcca23355272056f04fe8bf20edfce0</div></body></html>