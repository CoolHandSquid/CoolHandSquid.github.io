<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Token Impersonation</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Token Impersonation</h1><br/>If you have either of these tokens (whoami /groups) you may be able to use a potato exploit (most common in service accounts).<br />	SeImpersonatePrivilege          &gt; Rotten potato or Juicy potato<br />	SeAssignPrimaryPrivilege        &gt; Juicy potato<br />	Newer Than Win10 1809		 &gt; Rogue potato or PrintSpoofer.exe<br />	SeBackupPrivilege					 &gt; Read access to all files on the system (sam + system = PTH attack)<br />	SeRestorePrivilege					 &gt; Write access to all objects on the system (Modify both reg keys to allow <a href="Web_Notes--PrivEsc--Windows_PrivEsc--Methods--Registry--AlwaysInstallElivated.html">AlwaysInstallElivated</a>)<br />	SeTakeOwnershipPrivilege		 &gt; Lets you take ownership over all objects on the system. (WRITE_OWNER permission) Own an object, give yourself write access, do the thing (Modify both reg keys to allow <a href="Web_Notes--PrivEsc--Windows_PrivEsc--Methods--Registry--AlwaysInstallElivated.html">AlwaysInstallElivated</a>)<br />	SeDebug								 &gt; mimikatz/kiwi<br /><br />Tater: less chance of success but easier to use.<br />	put Tater.ps1 on the target.<br />	powershell.exe -nop -ep bypass -c import-module .\Tater.ps1; Invoke-Tater -Trigger 1 -Command &quot;net localgroup administrators squid /add&quot;<br /><br /><a href="https://jlajara.gitlab.io/others/2020/11/22/Potatoes_Windows_Privesc.html">https://jlajara.gitlab.io/others/2020/11/22/Potatoes_Windows_Privesc.html</a><br /><a href="https://github.com/hatRiot/token-priv/blob/master/abusing_token_eop_1.0.txt">https://github.com/hatRiot/token-priv/blob/master/abusing_token_eop_1.0.txt</a><br /><br /><br /><br /></div></body></html>