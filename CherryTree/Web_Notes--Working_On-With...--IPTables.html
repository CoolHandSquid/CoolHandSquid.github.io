<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>IPTables</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>IPTables</h1><br/><div class="codebox"><div class="codebox">#&nbsp;BASIC&nbsp;RULES<br />sudo&nbsp;iptables&nbsp;-A&nbsp;INPUT&nbsp;-i&nbsp;lo&nbsp;-j&nbsp;ACCEPT<br />sudo&nbsp;iptables&nbsp;-A&nbsp;INPUT&nbsp;-m&nbsp;conntrack&nbsp;--ctstate&nbsp;RELATED,ESTABLISHED&nbsp;-j&nbsp;ACCEPT<br />sudo&nbsp;iptables&nbsp;-A&nbsp;INPUT&nbsp;-m&nbsp;state&nbsp;--state&nbsp;RELATED,ESTABLISHED&nbsp;-j&nbsp;ACCEPT<br />sudo&nbsp;iptables&nbsp;-A&nbsp;INPUT&nbsp;-p&nbsp;tcp&nbsp;-m&nbsp;tcp&nbsp;--dport&nbsp;22&nbsp;-j&nbsp;ACCEPT<br /><br />sudo&nbsp;iptables&nbsp;-P&nbsp;INPUT&nbsp;DROP<br />sudo&nbsp;iptables&nbsp;-P&nbsp;FORWARD&nbsp;DROP<br />sudo&nbsp;iptables&nbsp;-P&nbsp;OUTPUT&nbsp;ACCEPT<br /><br /><br />#&nbsp;save&nbsp;iptables<br />sudo&nbsp;apt-get&nbsp;-y&nbsp;install&nbsp;debconf-utils<br />echo&nbsp;iptables-persistent&nbsp;iptables-persistent/autosave_v4&nbsp;boolean&nbsp;true&nbsp;|&nbsp;sudo&nbsp;debconf-set-selections<br />echo&nbsp;iptables-persistent&nbsp;iptables-persistent/autosave_v6&nbsp;boolean&nbsp;true&nbsp;|&nbsp;sudo&nbsp;debconf-set-selections<br />sudo&nbsp;apt-get&nbsp;-y&nbsp;install&nbsp;iptables-persistent<br />sudo&nbsp;service&nbsp;iptables-persistent&nbsp;save<br /><br /><br />#&nbsp;CHEAT&nbsp;SHEET<br />##&nbsp;Display&nbsp;rules<br />iptables&nbsp;-S<br />iptables&nbsp;-L&nbsp;--line-numbers<br /><br />##&nbsp;Insert&nbsp;in&nbsp;line&nbsp;number&nbsp;6<br />iptables&nbsp;-I&nbsp;INPUT&nbsp;6&nbsp;-p&nbsp;tcp&nbsp;-m&nbsp;tcp&nbsp;--dport&nbsp;80&nbsp;-j&nbsp;ACCEPT<br /><br />##&nbsp;Add&nbsp;comments<br />iptables&nbsp;-A&nbsp;INPUT&nbsp;-s&nbsp;192.168.1.1/32&nbsp;-p&nbsp;tcp&nbsp;-m&nbsp;tcp&nbsp;--dport&nbsp;80&nbsp;-m&nbsp;comment&nbsp;--comment&nbsp;&quot;office&quot;&nbsp;-j&nbsp;ACCEPT<br /><br />##&nbsp;bulk&nbsp;change<br />PORTS=&quot;3306&quot;<br />for&nbsp;PORT&nbsp;in&nbsp;$PORTS;<br />do<br />&nbsp;&nbsp;#echo&nbsp;$PORT<br />&nbsp;&nbsp;sudo&nbsp;iptables&nbsp;-A&nbsp;INPUT&nbsp;-p&nbsp;tcp&nbsp;-m&nbsp;tcp&nbsp;--dport&nbsp;$PORT&nbsp;-j&nbsp;ACCEPT<br />done&nbsp;</div></div></div></body></html>