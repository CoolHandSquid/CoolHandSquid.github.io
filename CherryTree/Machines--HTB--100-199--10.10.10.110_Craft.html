<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.110 Craft</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.110 Craft</h1><br/>quick nmap showed that 443 and 22 were open<br />There were two links on the main page that would not go anywhere<br /><a href="https://api.craft.htb/api/">https://api.craft.htb/api/</a><br /><a href="https://gogs.craft.htb/">https://gogs.craft.htb/</a><br />add api.craft.htb and gogs.craft.htb to /etc/hosts and Boom routable!<br />dirsearch showed <a href="https://gogs.craft.htb/Craft">https://gogs.craft.htb/Craft</a><br />in the comments of “issues” we saw a curl request to the database, it failed so the token must be expired<br />    <code>curl -H &#39;X-Craft-API-Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoidXNlciIsImV4cCI6MTU0OTM4NTI0Mn0.-wW1aJkLQDOE-GP5pQd3z_BJTe2Uo0jJ_mQ238P5Dqw&#39; -H &quot;Content-Type: application/json&quot; -k -X POST https://api.craft.htb/api/brew/ --data &#39;{&quot;name&quot;:&quot;bullshit&quot;,&quot;brewer&quot;:&quot;bullshit&quot;, &quot;style&quot;: &quot;bullshit&quot;, &quot;abv&quot;: &quot;15.0&quot;)}&#39;</code><br /><br />Now we need to find creds to make a new token<br />(Looking back I don&#39;t know where I found them, but they were in the open somewhere)<br />Bryan found a sweet script to generate a new webtoken and then get a reverse shell<br /><a href="https://github.com/Kucharskov/HTB-Scripts">https://github.com/Kucharskov/HTB-Scripts</a><br /><br />root!!! ... but not really, we are some super limited doker entity<br /><br />but there is a script used to query mysql_database<br />sql = “SELECT * FROM `user`”      and change &quot;fetchone&quot; to &quot;fetchall&quot;<br />boom! we have web logins for all the guys!!<br /> <br />gilfoyle has a hidden repository!<br />we see he has his ssh public and private key here, we steal the private key,<br />ssh -i /root/id_rsa gilfoyle@10.10.10.110<br />we are in!<br /><br />now also in this private repository we saw the vault was running, used to make one time passwords for root logins<br />after much fuckery with the syntax<br />vault ssh -role root_otp -mode otp root@10.10.10.110<br />boom! we are given the OTP<br />throw it in there...<br /><h1>ROOTED</h1></div></body></html>