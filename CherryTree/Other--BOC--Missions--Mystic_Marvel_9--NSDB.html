<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>NSDB</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>NSDB</h1><br/>== T#1 -- IP == 192.168.0.99<br />{=========================<br />2021/04/28 - 11:02<br /><br />Selinux = enabled 2021/04/28 - 11:12<br />10  *  *  *  * root echo -e &#39;\n\n&#39; + Mon Apr 19 17:23:42 UTC 2021 + &#39;\n&#39; &gt;&gt; /root/linux-malware-detect/report.txt &amp;&amp; /usr/local/sbin/maldet -a /bin &gt;&gt; /root/linux-malware-detect/report.txt 2021/04/28 - 11:12<br /><strong>Security Products</strong><br />1. Name and version of the product: Linux Malware Detect v1.6.4<br />2. Primary registry key: /etc/sysconfig/maldet<br />3. Installation folder: /usr/local/maldetect/maldet<br />4. Directory location of associated logs: /root/linux-malware-detect/report.txt<br />5. Timestamp of all associated log files: Apr 28 15:10<br />6. Cloud based?; yes or no: No. The .txt file does not appear to be programmatically being forwarded.<br />7. Can we read the logs?; yes or no: as Root yes. No as student14.<br />• If Yes, put the most recent 5 lines of logs in your NSDB File<br />•   <br />maldet(23494): {scan} signatures loaded: 17256 (14434 MD5 | 2039 HEX | 783 YARA | 0 USER)<br />maldet(23494): {scan} building file list for /bin, this might take awhile...<br />maldet(23494): {scan} setting nice scheduler priorities for all operations: cpunice 19 , ionice 6<br />maldet(23494): {scan} scan returned empty file list; check that path exists and contains files in scope of configuration.<br /><br />• If No, why?: N/A<br /><br /><strong><span style="color:#ff8c00;">Reporting Security Product Template</span></strong><br />*****Security Product Report*****<br />Target: &lt;T#1 and IP 192.168.0.99 &gt;<br />Name - &lt;Linux Malware Detect&gt;<br />Version - &lt;v1.6.4&gt;<br />Primary registry key/etc file - &lt;/etc/sysconfig/maldet&gt;<br />*****End of Report*****<br />2021/04/28 - 11:19<br /><br /><strong>Abnormal Logging</strong><br />1. Provide process name/options, PID, Parent ID, user: 10722, 1, root<br />2. Provide location of configuration file and it&#39;s abnormal or irregular contents: /etc/rsyslog.d/, abnormal contets=[student14@frankcastle ~]$ cat /etc/rsyslog.d/00-my_iptables.conf <br />:msg, contains, &quot;I SEE YOU&quot;     /var/log/iptables.log<br />&amp; stop<br />3. Provide hostname or IP of where logs are being sent: localhost<br />4. Provide any network connections opened/established by abnormal logging: Listening on 514 (rsyslog server)<br />5. Provide brief description of the abnormal, irregular or remote logging: This machine appears to be an rsyslog server.<br /><br /><strong><span style="color:#ff8c00;">Reporting Abnormal Logging Template</span></strong><br />*****Abnormal Logging Report*****<br />Target: &lt;T#1 and IP192.168.0.99 &gt;<br />Name - &lt;frankcastle&gt;<br />PID - &lt;10722&gt;<br />PPID - &lt;1&gt;<br />User - &lt;root&gt;<br />Location of config file - &lt;/etc/rsyslogd/*&gt;<br />Remote hostname or IP - &lt;localhost&gt;<br />Network connections - &lt;514 (listening)&gt;<br />Description - &lt;This machine appears to be an rsyslog server.&gt;<br />*****End of Report*****<br /> <br /> 1. Provide process name/options, PID, Parent ID, user, and hash: N/A, N/A, student14 (dir) 6267cfab85ab90b394da85ecaacb472b<br />2. Provide file type of malware binary and supporting files: nc<br />3. Provide any associated logs generated by malware: n/a<br />4. Provide location and lines of any persistence mechanisms: n/a<br />5. Provide full path of malware files or support files: /home/useraccounts/student14/nc<br />6. Provide any network connections opened/established by malware: n/a<br />7. Provide any identifiable text: n/a<br />8. Provide any/all modules loaded by malware: n/a<br />9. Provide brief description of malware purpose/actions and capabilities: nc is often an admin tool but can be used for RCE.<br /><br /><strong><span style="color:#ff8c00;">Reporting Malware Template</span></strong><br />*****Malware Report*****<br />Target: &lt;T#1 and IP 192.168.0.99 &gt;<br />Name - &lt;frankcastle&gt;<br />Hash - &lt;6267cfab85ab90b394da85ecaacb472b&gt;<br />PID - &lt;N/a&gt;<br />PPID - &lt;N/a&gt;<br />User - &lt;student14 (dir)&gt;<br />File type - &lt;elfx64&gt;<br />Supporting files - &lt;n/a&gt;<br />Associated Logs - &lt;n/a&gt;<br />Persistence - &lt;n/a&gt;<br />Description - &lt;nc is often an admin tool but can be used for RCE.&gt;<br />*****End of Report*****<br /><br /> =========================}<br /> == T#2 -- IP == 192.168.0.10<br />{=========================<br /> 2021/04/28 - 12:05<br /> <br /> <strong>Malware</strong><br />1. Provide process name/options, PID, Parent ID, user, and hash: nc -nlvp 31337, 629, 1, root, e64c8abed7922d527786523a908215a2<br />2. Provide file type of malware binary and supporting files: elfx64<br />3. Provide any associated logs generated by malware: N/a<br />4. Provide location and lines of any persistence mechanisms: n/a<br />5. Provide full path of malware files or support files: <a href="file:///bin/nc.traditional">/bin/nc.traditional</a><br />6. Provide any network connections opened/established by malware: Listening 31337 (all ports)<br />7. Provide any identifiable text: n/a<br />8. Provide any/all modules loaded by malware: n/a<br />9. Provide brief description of malware purpose/actions and capabilities: nc is often an admin tool but can be used for RCE.<br /><br /><strong><span style="color:#ff8c00;">Reporting Malware Template</span></strong><br />*****Malware Report*****<br />Target: &lt;T#2 and IP 192.168.0.10 &gt;<br />Name - &lt;TonyStark&gt;<br />Hash - &lt;e64c8abed7922d527786523a908215a2&gt;<br />PID - &lt;629&gt;<br />PPID - &lt;1&gt;<br />User - &lt;root&gt;<br />File type - &lt;elfx64&gt;<br />Supporting files - &lt;n/a&gt;<br />Associated Logs - &lt;n/a&gt;<br />Persistence - &lt;n/a&gt;<br />Description - &lt;nc is often an admin tool but can be used for RCE. In this case it appears to be listening on 31337.&gt;<br />*****End of Report*****<br /> <br /> =========================}<br /> == T#3 -- IP == 192.168.0.23<br />{=========================<br /> <strong>Security Products</strong><br />1. Name and version of the product: Selinux 31<br />2. Primary registry key: /etc/selinux<br />3. Installation folder:/sys/fs/selinux<br />4. Directory location of associated logs: /var/<strong>log</strong>/audit/audit.log<br />5. Timestamp of all associated log files: Apr 19 17:20<br />6. Cloud based?; yes or no: NO<br />7. Can we read the logs?; yes or no: Yes<br />• If Yes, put the most recent 5 lines of logs in your NSDB File:<br />• If No, why?:<br />[student14@peterparker ~]$ sudo tail -n 5 /var/log/audit/audit.log<br />type=CRED_DISP msg=audit(1619630115.969:2948): pid=23847 uid=0 auid=1014 ses=227 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:setcred grantors=pam_env,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/1 res=success&#39;<br />type=USER_ACCT msg=audit(1619630121.608:2949): pid=23850 uid=1014 auid=1014 ses=227 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:accounting grantors=pam_unix,pam_localuser acct=&quot;student14&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/1 res=success&#39;<br />type=USER_CMD msg=audit(1619630121.608:2950): pid=23850 uid=1014 auid=1014 ses=227 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;cwd=&quot;/home/useraccounts/student14&quot; cmd=7461696C202D6E2035202F7661722F6C6F672F61756469742F61756469742E6C6F67 terminal=pts/1 res=success&#39;<br />type=CRED_REFR msg=audit(1619630121.608:2951): pid=23850 uid=0 auid=1014 ses=227 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:setcred grantors=pam_env,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/1 res=success&#39;<br />type=USER_START msg=audit(1619630121.610:2952): pid=23850 uid=0 auid=1014 ses=227 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:session_open grantors=pam_keyinit,pam_limits,pam_keyinit,pam_limits,pam_systemd,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/1 res=success&#39;<br /><br /><strong><span style="color:#ff8c00;">Reporting Security Product Template</span></strong><br />*****Security Product Report*****<br />Target: &lt;T3 and IP 192.168.0.23 &gt;<br />Name - &lt;peterparker&gt;<br />Version - &lt;31&gt;<br />Primary registry key/etc file - &lt;/etc/selinux&gt;<br />*****End of Report*****<br /> <br /> =========================}<br /> == T#4 -- IP == 192.168.0.12<br />{=========================<br />2021/04/28 - 13:45<br /> 1. *****Privileged User Report*****<br />2. Target:#4<br />3. Username: administrator<br />4. Access Method: console<br />5. Access Time: 4/19/2021 6:13 PM<br />6. Activity:sshd, cmd, powershell<br />7. Network Connections: sshd listening<br />8. Description: Admin appears to be doing normal admin things.<br />9. *****End of Report*****<br /><br />1. Provide process name/options, PID, Parent ID, user, and hash: sfk, na, na, na, 97 e2 1a 02 71 dd 97 b2 8a b9 2a 36 0a e8 88 e7<br />2. Provide file type of malware binary and supporting files: exe<br />3. Provide any associated logs generated by malware: na<br />4. Provide location and lines of any persistence mechanisms: run key<br />5. Provide full path of malware files or support files: c:/sfk.exe<br />6. Provide any network connections opened/established by malware: n/a<br />7. Provide any identifiable text: na<br />8. Provide any/all modules loaded by malware: na<br />9. Provide brief description of malware purpose/actions and capabilities: sFK is an admin tool, that could be used for filecarving maliciously.<br /><br />2021/04/28 - 13:45<br /><strong><span style="color:#ff8c00;">Reporting Malware Template</span></strong><br />*****Malware Report*****<br />Target: &lt;T#4 and IP 192.168.0.12&gt;<br />Name - &lt;sfk.exe&gt;<br />Hash - &lt;97 e2 1a 02 71 dd 97 b2 8a b9 2a 36 0a e8 88 e7&gt;<br />PID - &lt;N/a&gt;<br />PPID - &lt;N/a&gt;<br />User - &lt;n/a&gt;<br />File type - &lt;executable&gt;<br />Supporting files - &lt;n/a&gt;<br />Associated Logs - &lt;n/a&gt;<br />Persistence - &lt;run key&gt;<br />Description - &lt;SFK is an admin tool, that could be used for filecarving maliciously.&gt;<br />*****End of Report*****<br /> <br /> =========================}<br /> == T#5 -- IP == 192.168.0.9<br />{=========================<br /> 1. *****Privileged User Report*****<br />2. Target:#5<br />3. Username: administrator<br />4. Access Method: console<br />5. Access Time: 4/27/2021 1:20 PM<br />6. Activity: Edge, Skype, powershell, photos, nc64.exe<br />7. Network Connections: ssh into 192.168.0.12<br />8. Description: Admin appears to be doing admin thngs.<br />9. *****End of Report*****<br /> <br /> <strong>Malware</strong><br />1. Provide process name/options, PID, Parent ID, user, and hash: beacon.ps1 (nc64.exe), na, na, na, <br />student14@DESKTOP-81CJFAR C:\Users\student14&gt;certutil -hashfile &quot;C:\tools\beacon.ps1&quot; MD5<br />MD5 hash of C:\tools\beacon.ps1:<br />31eac99b69c4e52c0baa2ccd6b6482bc<br />CertUtil: -hashfile command completed successfully.<br /><br />student14@DESKTOP-81CJFAR C:\Users\student14&gt;certutil -hashfile &quot;C:\tools\netcat\nc64.exe&quot; MD5<br />MD5 hash of C:\tools\netcat\nc64.exe:<br />523613a7b9dfa398cbd5ebd2dd0f4f38<br />CertUtil: -hashfile command completed successfully.<br /><br />3. Provide file type of malware binary and supporting files: powershell script and executable<br />4. Provide any associated logs generated by malware: na<br />5. Provide location and lines of any persistence mechanisms: na<br />6. Provide full path of malware files or support files: C:/tools/*<br />7. Provide any network connections opened/established by malware: nc64.exe will call out to 192.168.0.13 on 12301<br />8. Provide any identifiable text: Congrats! You are an 31337 H4x0r!<br />9. Provide any/all modules loaded by malware: na<br />10. Provide brief description of malware purpose/actions and capabilities: Appears to have no malicious intent.<br /><br /><strong><span style="color:#ff8c00;">Reporting Malware Template</span></strong><br />*****Malware Report*****<br />Target: &lt;T#5 and IP 192.168.0.9&gt;<br />Name - &lt;beacon.ps1&gt;<br />Hash - &lt;31eac99b69c4e52c0baa2ccd6b6482bc&gt;<br />PID - &lt;na&gt;<br />PPID - &lt;na&gt;<br />User - &lt;depends who logs in&gt;<br />File type - &lt;ps1, exe&gt;<br />Supporting files - &lt;beacon.ps1, nc64.exe&gt;<br />Associated Logs - &lt;na&gt;<br />Persistence - &lt;hklm\software\microsoft\windows\currentversion\run&gt;<br />Description - &lt;Appears to have no malicious intent.&gt;<br />*****End of Report*****<br /><br /><br /><br /> =========================}<br />  == T#6 -- IP == 192.168.0.13<br />{=========================<br /><strong>Malware</strong><br />1. Provide process name/options, PID, Parent ID, user, and hash: Reptils, na, na, na ,na. (<a href="https://github.com/f0rb1dd3n/Reptile">https://github.com/f0rb1dd3n/Reptile</a>)<br />2. Provide file type of malware binary and supporting files: Rootkit<br />3. Provide any associated logs generated by malware: na<br />4. Provide location and lines of any persistence mechanisms: na<br />5. Provide full path of malware files or support files:/Reptile<br />6. Provide any network connections opened/established by malware: na<br />7. Provide any identifiable text: na<br />8. Provide any/all modules loaded by malware: na<br />9. Provide brief description of malware purpose/actions and capabilities: This malware, although not installed to my knowledge, is for a rootkit.<br /><br /><strong><span style="color:#ff8c00;">Reporting Malware Template</span></strong><br />*****Malware Report*****<br />Target: &lt;T#6 and IP 192.168.0.13&gt;<br />Name - &lt;Reptile&gt;<br />Hash - &lt;na&gt;<br />PID - &lt;na&gt;<br />PPID - &lt;na&gt;<br />User - &lt;na&gt;<br />File type - &lt;Git Project&gt;<br />Supporting files - &lt;/Reptile&gt;<br />Associated Logs - &lt;na&gt;<br />Persistence - &lt;na&gt;<br />Description - &lt;This malware, although not installed to my knowledge, is for a rootkit.&gt;<br />*****End of Report*****<br /> <br /> <br /> =========================}<br />  == T#7 -- IP == 192.168.0.27<br />{=========================<br /> <strong>Security Products</strong>2021/04/28 - 15:54<br />1. Name and version of the product: selinux<br />2. Primary registry key: /etc/selinux<br />3. Installation folder: /sys/fs/selinux<br />4. Directory location of associated logs: /var/<strong>log</strong>/audit/audit.log<br />5. Timestamp of all associated log files:Apr 28 19:52<br />6. Cloud based?; yes or no: no<br />7. Can we read the logs?; yes or no: yes<br />• If Yes, put the most recent 5 lines of logs in your NSDB File:<br />• If No, why?:<br />type=CRED_DISP msg=audit(1619639570.257:1600): pid=11331 uid=0 auid=1014 ses=19 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:setcred grantors=pam_env,pam_localuser,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/2 res=success&#39;UID=&quot;root&quot; AUID=&quot;student14&quot;<br />type=USER_ACCT msg=audit(1619639611.487:1601): pid=11334 uid=1014 auid=1014 ses=19 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:accounting grantors=pam_unix,pam_localuser acct=&quot;student14&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/2 res=success&#39;UID=&quot;student14&quot; AUID=&quot;student14&quot;<br />type=USER_CMD msg=audit(1619639611.488:1602): pid=11334 uid=1014 auid=1014 ses=19 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;cwd=&quot;/home/useraccounts/student14&quot; cmd=636174202F7661722F6C6F672F61756469742F61756469742E6C6F67 terminal=pts/2 res=success&#39;UID=&quot;student14&quot; AUID=&quot;student14&quot;<br />type=CRED_REFR msg=audit(1619639611.488:1603): pid=11334 uid=0 auid=1014 ses=19 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:setcred grantors=pam_env,pam_localuser,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/2 res=success&#39;UID=&quot;root&quot; AUID=&quot;student14&quot;<br />type=USER_START msg=audit(1619639611.491:1604): pid=11334 uid=0 auid=1014 ses=19 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg=&#39;op=PAM:session_open grantors=pam_keyinit,pam_limits,pam_keyinit,pam_limits,pam_systemd,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/2 res=success&#39;UID=&quot;root&quot; AUID=&quot;student14&quot;<br /><br /><strong><span style="color:#ff8c00;">Reporting Security Product Template</span></strong><br />*****Security Product Report*****<br />Target: &lt;T#7 and IP 192.168.0.27&gt;<br />Name - &lt;selinux&gt;<br />Version - &lt;31&gt;<br />Primary registry key/etc file - &lt;/etc/selinux&gt;<br />*****End of Report*****<br /> <br /> =========================}<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> </div></body></html>